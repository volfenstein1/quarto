The Steenrod problem for closed orientable manifolds was solved completely by Thom.
Following this approach, we solve the Steenrod problem for closed orientable orbifolds, proving that the rational homology groups of a closed orientable orbifold have a basis consisting of classes represented by suborbifolds whose normal bundles have fiberwise trivial isotropy action.

Polyfold theory, as developed by Hofer, Wysocki, and Zehnder, has yielded a well-defined Gromov--Witten invariant via the regularization of moduli spaces.
As an application, we demonstrate that the polyfold Gromov--Witten invariants, originally defined via branched integrals, may equivalently be defined as intersection numbers against a basis of representing suborbifolds.

\section{Introduction}

\subsection{The {S}teenrod problem}

The Steenrod problem was first presented in \cite{eilenberg1949problems} and asked the following question:
\textit{Can any homology class of a finite polyhedron be represented as an image of the fundamental class of some manifold?}
In \cite{thom1954quelques},\footnote{The reader should be advised that the commonly available English translation of this paper introduces a few errors which are not present in the original version.} Thom conclusively answered this problem, completely solving it for closed orientable manifolds.

\begin{theorem}[(\cite{thom1954quelques}*{Thm.~II.1})]
	The rational homology groups of a closed orientable manifold have a basis consisting of classes represented by closed embedded submanifolds.
\end{theorem}

A key insight into the problem was the multiplication theorem \cite{thom1954quelques}*{Thm.~II.25} which demonstrated a cohomological relationship between two different types of classifying spaces---the Eilenberg--MacLane spaces and the universal bundles.
For solving this problem, and for his related work inventing cobordism theory, Thom was awarded the Fields medal in 1958.


In order to solve the Steenrod problem for orbifolds, for the most part we are able to follow the same approach as Thom.
Following this approach requires updating and reformulating analogs of a few classical results of the differential topological study of manifolds into the modern language of ep-groupoids.

\begin{theorem}[(The {S}teenrod problem for closed orientable orbifolds)]\label{thm:intro-steenrod-problem}
	The rational homology groups of a closed orientable orbifold have a basis consisting of classes represented by closed embedded full suborbifolds whose normal bundles have fiberwise trivial isotropy action.
\end{theorem}

Embedded full suborbifolds whose normal bundles have fiberwise trivial isotropy action are well-suited for general intersection theories.
Given such a suborbifold, the underlying topological space of the normal bundle is a vector bundle over the underlying topological space of the suborbifold.
In contrast, the underlying topological space of an arbitrary orbifold bundle will generally not be a vector bundle.
This means it is possible to use single valued sections (as opposed to multisections) for arguments involving perturbations.

We consider the Steenrod problem for orbifolds and give a self-contained introduction to some basic orbifold theory in \S\ref{sec:steenrod-problem}.
In \S\ref{subsec:orbifolds-ep-groupoids} we describe orbifolds using the modern language of ep-groupoids, prove a Whitney approximation theorem, and define the full embedded suborbifolds.
In \S\ref{subsec:elementary-orbifold-alg-top} we compare cohomology theories on orbifolds, and discuss Poincar\'e duality.
In \S\ref{subsec:elementary-orbifold-transversality} we provide some relevant transversality results.
In \S\ref{subsec:solving-the-steenrod-problem} we solve the Steenrod problem for orbifolds.
The proof of Theorem~\ref{thm:intro-steenrod-problem} follows immediately from the more complete and technical Theorem~\ref{thm:steenrod-problem}.


\subsection{Polyfold invariants}

A foundational problem in symplectic geometry is obtaining well-defined invariants via the compactified moduli spaces that arise in the study of $J$-holomorphic curves.
To do this, we would like to think of a compactified moduli space as a space which possesses structure similar to that of a manifold, structure such as:  possession of a ``fundamental class'', or the ability to integrate differential forms, or the ability to define notions of transversal intersection and intersection number.
However, for general symplectic manifolds, compactified moduli spaces will only have the structure of metrizable compact topological spaces---and this is insufficient for obtaining invariants.

Polyfold theory, developed by Hofer, Wysocki, and Zehnder, is a relatively new approach to solving this problem, and has been successful in proving the following regularization theorem.
\begin{theorem}[(Polyfold regularization theorem, \cite{HWZbook}*{Thm.~15.3.7, Cor.~15.3.10})]
	Consider a compact topological space $\CM$ which is equal to the zero set of a $\ssc$-smooth Fredholm section $\delbar$ of a strong polyfold bundle $\cW \to \cZ$, i.e., $\CM= \delbarinv (0) \subset \cZ$.

	There exist a class of ``abstract perturbations'' $p$ such that the perturbed zero set $(\delbar + p)^{-1}(0)$ has the structure of a compact oriented ``weighted branched orbifold''.

	Furthermore, different choices of abstract perturbations result in perturbed zero sets which are cobordant:
	given abstract perturbations $p_1$, $p_2$ there exists a compact oriented weighted branched orbifold $\cB$ with boundary:
	\[
		\partial \cB = -(\delbar+p_1)^{-1}(0) \sqcup (\delbar+p_2)^{-1}(0).
	\]
\end{theorem}

A {manifold} is locally homeomorphic to an open subset of $\R^n$, while an {orbifold} is locally homeomorphic to the quotient of an open subset of $\R^n$ by a finite group action.
Similarly, a {branched orbifold} is locally homeomorphic to the quotient of a finite union of open subsets of $\R^n$ by a finite group action.
The term ``branched orbifold'' refers to the smooth structures of the underlying topological space, while the ``weighted'' adjective refers to additional data used to define invariants such as the branched integral.
Crucially, weighted branched orbifolds possess enough structure to define the ``branched integration'' of differential forms.

\begin{theorem}[(Polyfold invariants as branched integrals, \cite{HWZbook}*{Cor.~15.4.4})]
	Consider a $\ssc$-smooth map
	$f:\cZ \to \cO$
	from a polyfold $\cZ$ to an orbifold $\cO$.
	We may define the \textbf{polyfold invariant} as the homomorphism obtained by pulling back a de Rahm cohomology class from the orbifold and taking the branched integral over a perturbed zero set:
	\[
		H^*_{\dR} (\cO) \to \R,	\qquad \ww \mapsto \int_{\cS(p)} f^*\ww.
	\]
	By a version of Stokes' theorem~\ref{thm:stokes} for weighted branched orbifolds, this homomorphism does not depend on the choice of abstract perturbation used to obtain the weighted branched orbifold $\cS(p)$.
\end{theorem}


We prove that the polyfold invariants may equivalently be defined as intersection numbers.
Polyfold invariants take as input (co)homological data coming from a closed orientable orbifold.
The Steenrod problem for closed orientable orbifolds demonstrates how to take this homological data and realize it as the fundamental class of a full embedded suborbifold---which is suitable data for defining the polyfold invariants as intersection numbers.

Consider a weighted branched suborbifold $\cS$, an orbifold $\cO$, an embedded full suborbifold $\cX\subset \cO$ whose normal bundle has fiberwise trivial isotropy action, and a smooth map $f :\cS \to \cO$:
\[
	\begin{tikzcd}[row sep=tiny]
		\cS \arrow[r,"f"] & \cO \arrow[d,phantom,"\cup"] \\
		& \cX.
	\end{tikzcd}
\]
Weighted branched orbifolds possess oriented tangent spaces, and hence it is possible to formulate a notion of transversal intersection of the map $f$ with the suborbifold $\cX$.
Furthermore, transversal intersection is generic, and may be obtained via either of the following approaches:
\begin{itemize}
	\item through perturbation of the suborbifold $\cX$ (see Proposition~\ref{prop:transversality-perturbation-full-suborbifold}),
	\item through construction of an abstract perturbation (see Proposition~\ref{prop:transversality-regular-perturbation}).
\end{itemize}
(The second approach requires the additional hypothesis that the map $f$ extended to the ambient polyfold is a submersion.)

\begin{theorem}[(Polyfold invariants as intersection numbers)]\label{thm:intro-polyfold-invariants-intersection}
	Consider a compact oriented weighted branched suborbifold $\cS$, an oriented orbifold $\cO$, a closed embedded full suborbifold $\cX\subset \cO$ whose normal bundle has fiberwise trivial isotropy action, and a smooth map $f :\cS \to \cO$.

	Without loss of generality, we may assume that $f$ is transverse to $\cX$.
	There exists a well-defined \textbf{intersection number}:
	\[
		f|_{\cS} \cdot \cX.
	\]

	The Steenrod problem for orbifolds \ref{thm:steenrod-problem} guarantees the existence of a basis $\{[\cX_i]\}$ of $H_*(\cO;\Q)$ which consists of the fundamental classes of closed embedded full suborbifolds whose normal bundles have fiberwise trivial isotropy action.
	We may define the \textbf{polyfold invariant} as the homomorphism obtained by evaluating the intersection number on this basis of representing suborbifolds and linear extension:
	\[
		H_*(\cO;\Q) \to \Q, \qquad	\sum_i k_i[\cX_i] \mapsto \sum_i k_i \left( f|_{\cS} \cdot \cX_i \right).
	\]
\end{theorem}

When $\dim \cS + \dim \cX = \dim \cO$, the intersection number is given by the signed weighted count of a finite number of points of intersection (see Definition~\ref{def:intersection-number}).

Provided with a well-defined branched integral and a well-defined intersection number, a proof of the equality of the invariants involves little more than using Poincar\'e duality for orbifolds and a local comparison of these invariants at the finite points of intersection.
We use this equality to justify the assertion that the intersection number is an invariant, and does not depend on the choice of abstract perturbation, nor on the choice of basis of representing suborbifolds (see Remark~\ref{rmk:invariance-intersection-number}).

\begin{theorem}[(Equivalence of the polyfold invariants)]\label{thm:equality-polyfold-invariants}
	Let $\cS$ be a compact oriented weight-ed branched suborbifold. Let $\cO$ be a closed oriented orbifold and let $\cX \subset \cO$ be a closed oriented embedded full suborbifold whose normal bundle has fiberwise trivial isotropy action.
	Consider a smooth map $f: \cS \to \cO$ and assume without loss of generality that $f$ is transverse to $\cX$.

	The branched integral and the intersection number are related by the following equation:
	\[
		\int_{\cS} f^* \PD ([\cX]) = f|_{\cS} \cdot \cX.
	\]
\end{theorem}

We show how the Steenrod problem for orbifolds may be used to define the polyfold invariants in terms of intersection numbers in \S\ref{sec:defining-polyfold-invariants}.
In \S\ref{subsec:weighted-branched-suborbifolds} we discuss the structure of the weighted branched suborbifolds which arise as perturbed solution spaces in polyfold theory.
In \S\ref{subsec:branched-integrals} we review details regarding the branched integral and the associated polyfold invariants.
In \S\ref{subsec:intersection-numbers} we show that transversality is generic and define the polyfold invariants as intersection numbers.
In \S\ref{subsec:equality-polyfold-invariants} we prove Theorem~\ref{thm:equality-polyfold-invariants}, showing that the polyfold invariants are equivalent and establish that the intersection number is an invariant.


\subsection[Application: The polyfold Gromov--Witten invariants]{Application: The polyfold {G}romov--{W}itten invariants}

The earliest interpretations of the Gromov--Witten invariants present in the literature were given in terms of counting a finite number of curves \cites{mcduffsalamon2012jholomorphic, ruan1994symplectic, ruan1996topological}.
For example, Ruan described the Gromov--Witten invariants as a finite sum, counted with multiplicity, of nonmultiple cover $J$-spheres in $\cM^*_{(A,J)}$ which intersect representatives of given cycles in the symplectic manifold \cite{ruan1996topological}*{Thm.~A}.

However, such definitions have previously been restricted to genus-zero Gromov--Witten invariants in semipositive symplectic manifolds.
In addition to technical issues regarding the regularization of the Gromov--Witten moduli spaces for general symplectic manifolds and arbitrary genus, we remark that in the genus-zero case the Grothendieck--Knudsen spaces $\dmlog_{0,k}$ are finite-dimensional manifolds.
In contrast, if genus $g >0$ the general Deligne--Mumford spaces $\dmlog_{g,k}$ are orbifolds.
Therefore, in the genus-zero case extant methods---such as representing a homology class as a pseudocycle in a manifold \cite{zinger2008pseudocycles}  or, indeed, the Steenrod problem for manifolds---were sufficient to interpret the Gromov--Witten invariants via intersection theory.

Polyfold theory has been successful in giving a well-defined Gromov--Witten invariant for $J$-holomorphic curves of arbitrary genus, and for all closed symplectic manifolds \cite{HWZGW}. As opposed to defining these invariants via intersection theory, the invariants are defined by pulling back de Rahm cohomology classes and branched integration. We now describe this precisely.

Let $(M,\ww)$ be a closed symplectic manifold, and fix a homology class $A \in H_2 (M;\Z)$ and integers $g, k\geq 0$ such that $2g+k\geq 3$.
Consider the following diagram of smooth maps between the perturbed Gromov--Witten moduli space $\cS_{A,g,k}(p)$, the $k$-fold product manifold $M^k$, and the Deligne--Mumford orbifold $\dmlog_{g,k}$:
\[
	\begin{tikzcd}[column sep=12ex]
		\cS_{A,g,k}(p) \arrow{r}{ev_1\times\cdots\times ev_k} \arrow{d}{\pi} & M^k\\
		\dmlog_{g,k}.
	\end{tikzcd}
\]
Here $ev_i$ is evaluation at the $i$th-marked point, and $\pi$ is the projection map to the Deligne--Mumford space which forgets the stable map solution and stabilizes the resulting nodal Riemann surface by contracting unstable components.

Consider homology classes $\alpha_1,\ldots, \alpha_k \in H_* (M;\Q)$ and $\beta\in H_* (\dmlog_{g,k};\Q)$.
We can represent the Poincar\'e duals of the $\alpha_i$ and $\beta$ by closed differential forms in the de Rahm cohomology groups, $\PD(\alpha_i)\in H^*_{\dR} (M)$ and $\PD(\beta)\in H^*_{\dR}(\dmlog_{g,k})$.
By pulling back via the evaluation and projection maps, we obtain a closed $\ssc$-smooth differential form
\[
	ev_1^* \PD (\alpha_1) \wedge \cdots \wedge ev_k^* \PD(\alpha_k) \wedge\pi^* \PD (\beta) \in H^*_{\dR} (\cZ_{A,g,k}).
\]
The \textbf{polyfold Gromov--Witten invariant} is the homomorphism
\[
	\GW^M_{A,g,k} : H_* (M;\Q)^{\otimes k} \otimes H_* (\dmlog_{g,k}; \Q) \to \R
\]
defined in \cite{HWZGW}*{Thm.~1.12} via the branched integral
\[
	\GW^M_{A,g,k} (\alpha_1,\ldots,\alpha_k;\beta) : = \int_{\cS_{A,g,k}(p)} ev_1^* \PD (\alpha_1) \wedge \cdots \wedge ev_k^* \PD(\alpha_k) \wedge\pi^* \PD (\beta).
\]

Via Theorems~\ref{thm:intro-polyfold-invariants-intersection} and \ref{thm:equality-polyfold-invariants}, we immediately obtain the following equivalent description of the polyfold Gromov--Witten invariants as an intersection number.

\begin{corollary}[(Polyfold Gromov--Witten invariants as intersection numbers)]
	The polyfold Gromov--Witten invariant may equivalently be defined as the intersection number evaluated on a basis of representing submanifolds $\cX \subset M$ and representing suborbifolds $\cB \subset \cO$:
	\[
		\GW^M_{A,g,k} ([\cX_1],\ldots,[\cX_k];[\cB]) :=
		\left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
	\]
	The invariant does not depend on the choice of abstract perturbation, nor on the choice of representing basis.
\end{corollary}

This definition aligns with the traditional geometric interpretation of the Gromov--Witten
invariants as a count of curves which at the $i$th-marked point passes through $\cX_i$ and such
that the image under the projection $\pi$ lies in $\cB$:
\[
	\begin{tikzcd}[column sep= huge, row sep=tiny]
		\cS_{A,g,k}(p) \arrow[r,"ev_1\times \cdots \times ev_k \times \pi"] & M^k \times \dmlog_{g,k} \arrow[d,phantom,"\cup\quad"] \\
		& \cX_1\times \cdots \times \cX_k \times \cB.
	\end{tikzcd}
\]

\begin{remark}
	As we will show in subsequent work, the projection to the Deligne--Mum\-ford orbifold,
	\[
		\pi: \cZ_{A,g,k} \to \dmlog_{g,k},
	\]
	is not a submersion. It follows that the map
	\[
		ev_1\times \cdots \times ev_k \times \pi : \cZ_{A,g,k} \to M\times \cdots \times M \times \dmlog_{g,k}
	\]
	does not satisfy the hypotheses of Proposition~\ref{prop:transversality-regular-perturbation}.  Hence transversality of the map $ev_1\times \cdots \times ev_k \times \pi$ with a representing suborbifold $\cX_1\times \cdots \times \cX_k \times \cB$ may only be obtained via perturbation of the suborbifold as in Proposition~\ref{prop:transversality-perturbation-full-suborbifold}.
\end{remark}


\section[The Steenrod problem for orbifolds]{The {S}teenrod problem for orbifolds}\label{sec:steenrod-problem}

We begin this section with a self-contained introduction to some of the basic theory for orbifolds.
Along the way, we take advantage of the opportunity to collect a handful of elementary observations and results regarding orbifolds, which are either undocumented or scattered throughout the literature.
This ultimately culminates in a proof of the Steenrod problem for orbifolds.

\subsection{Orbifolds and ep-groupoids}\label{subsec:orbifolds-ep-groupoids}

The notion of orbifold was first introduced by Satake \cites{satake1956generalization}, with further descriptions in terms of groupoids and categories by Haefliger \cites{haefliger1971homotopy, haefliger1984groupoide, haefliger2001groupoids}, and Moerdijk \cites{moerdijk2002orbifolds, moerdijk2003introduction}.

Recently, Hofer, Wysocki, and Zehnder have utilized the language of ep-groupoids in the development polyfold theory.
In the present context we do not need the full strength of this theory; however the polyfold literature (in particular, \cite{HWZbook}) provides a large body of basic definitions and results on orbifolds and ep-groupoids.

\begin{definition}[(\cite{HWZbook}*{Defs.~7.1.1,~7.1.3})]
	A \textbf{groupoid} $(O,\bm{O})$ is a small category consisting of a set of objects $O$, a set of morphisms $\bm{Z}$ which are all invertible, and the five structure maps $(s,t,m,u,i)$ (the source, target, multiplication, unit, and inverse maps).
	An  \textbf{ep-groupoid} is a groupoid $(O,\bm{O})$ whose object set $O$ and morphism set $\bm{O}$ both have the structure of finite-dimensional manifolds,
	and such that all the structure maps are smooth maps and which satisfy the following properties.
	\begin{itemize}
		\item \textbf{(\'etale).}  The source and target maps
		      $s:\bm{O}\to O$ and $t:\bm{O}\to O$ are surjective local diffeomorphisms.
		\item \textbf{(proper).}  For every point $x\in O$, there exists an
		      open neighborhood $V$ of $x$ such that the map
		      $t:s^{-1}(\overline{V})\rightarrow O$ is a proper mapping.
	\end{itemize}
\end{definition}

For a fixed object $x\in O$ we denote the \textbf{isotropy group of $x$} by
\[
	\bm{G}(x) := \{	\phi \in \bm{O} \mid s(\phi)=t(\phi = x)	\}.
\]
The properness condition ensures that this is a finite group.
The \textbf{orbit space} of an ep-groupoid $(O,\bm{O})$,
\[
	\abs{O} := O / \sim,
\]
is the quotient of the set of objects $O$ by the equivalence relation $x\sim x'$ if there exists a morphism $\phi\in \bm{O}$ such that $s(\phi)=x$ and $t(\phi)=x'$.  It is equipped with the quotient topology defined via the map $\pi: O\to\abs{O}, x\mapsto \abs{x}$.

\begin{definition}
	Let $\cO$ be a second-countable, paracompact, Hausdorff topological space.  An \textbf{orbifold structure} on $\cO$ consists of an ep-groupoid $(O,\bm{O})$ and a homeomorphism $\abs{O}\simeq \cO$ (compare with \cite{HWZbook}*{Def.~16.1.1}).
\end{definition}

An \textbf{orientation} of an orbifold structure consists of a choice of orientation on the object space and on the morphism space, such that the source and target maps are orientation preserving local diffeomorphisms.

Defining an ep-groupoid involves making a choice of local structures.  Taking an equivalence class of ep-groupoids makes our differentiable structure choice independent.  The appropriate notion of equivalence in this category-theoretic context is a ``Morita equivalence class'' (see \cite{HWZbook}*{Def.~16.1.2}).

\begin{definition}
	An \textbf{orbifold} consists of a second-countable, paracompact, Hausdorff topological space $\cO$ together with a Morita equivalence class of orbifold structures $[(O,\bm{O})]$ on $\cO$ (compare with \cite{HWZbook}*{Def.~16.1.3}).
\end{definition}

Taking a Morita equivalence class of a given orbifold structure is analogous to taking a maximal atlas for a given atlas in the usual definition of a manifold.

We say that that $\cO$ is \textbf{closed} if the underlying topological space is compact, and if the object and morphism spaces are boundaryless.
The orbifold $\cO$ is \textbf{orientable} if a representative orbifold structure $(O,\bm{O})$ can be given an orientation.

\begin{definition}\label{def:manifold-as-trivial-orbifold}
	Consider a manifold $\cM$. We may define a \textbf{trivial orbifold structure} on $\cM$ as follows:
	\begin{itemize}
		\item define the object set by $M:=\cM$,
		\item define the morphism set by $\bm{M} := \{ \id_x : x\to x \mid x\in \cM\}$.
	\end{itemize}
	It is obvious this defines an orbifold structure on the underlying topological space $\cM$.
\end{definition}

\begin{notation}
	It is common to denote both an ep-groupoid $(O,\bm{O})$, and its object set $O$, by the same letter ``$O$''.
	We will refer to the underlying set, the underlying topological space, or the orbifold by the letter ``$\cO$''.
	Furthermore, we will write objects as ``$x\in O$'', morphisms as ``$\phi \in \bm{O}$'', and points as ``$[x]\in \cO$'' (due to the identification $\abs{O} \simeq \cO$).
\end{notation}

The following proposition shows the relationship between the more classically familiar definition of an orbifold (defined in terms of the local topology), and our abstract formulation of an orbifold in terms of ep-groupoids.

\begin{proposition}[(Natural representation of $\bm{G}(x)$, \cite{HWZbook}*{Thm.~7.1.13})]\label{prop:natural-representation}
	Consider an ep-groupoid $(O,\bm{O})$.  Let $x\in O$ with isotropy group $\bm{G}(x)$.  Then for every open neighborhood $V$ of $x$ there exists an open neighborhood $U\subset V$ of $x$, a group homomorphism $\Phi : \bm{G}(x)\rightarrow \text{Diff}(U)$, $g\mapsto  \Phi (g)$,  and a smooth map
	$\Gamma: \bm{G}(x)\times U\rightarrow \bm{O}$ such that the following holds.
	\begin{enumerate}
		\item $\Gamma(g,x)=g$.
		\item $s(\Gamma(g,y))=y$ and $t(\Gamma(g,y))=\Phi (g)(y)$ for all $y\in U$ and $g\in \bm{G}(x)$.
		\item If $h: y\rightarrow z$ is a morphism between points in $U$, then there exists a unique element $g\in \bm{G}(x)$ satisfying $\Gamma(g,y)=h$, i.e.,
		      \[
			      \Gamma: \bm{G}(x)\times U\rightarrow \{\phi\in \bm{O} \mid   \text{$s(\phi)$ and $t(\phi)\in U$}\}
		      \]
		      is a bijection.
	\end{enumerate}
	The data $(\Phi,\Gamma)$ is called the \textbf{natural representation} of $\bm{G}(x)$.
	The open neighborhood $U$ is called a \textbf{local uniformizer} centered at $x$.
\end{proposition}
The \textbf{non-effective part} of the isotropy group $\bm{G}(x)$ is the subgroup which acts trivially on a local uniformizer, i.e.,
\[
	\bm{G}^\text{non-eff}(x) := \{	\phi \in \bm{G}(x)	\mid	\phi (U) = U	\},
\]
while the \textbf{effective isotropy group} is the quotient group
\[
	\bm{G}^\text{eff}(x) := \bm{G}(x) / \bm{G}^\text{non-eff}(x).
\]

Having given an abstract definition of an orbifold we now define maps between them.

\begin{definition}
	A \textbf{$C^k$ functor} between two ep-groupoids
	\[
		\hat{f}:(O,\bm{O}) \to (P,\bm{P})
	\]
	is a functor on groupoidal categories which moreover is an $C^k$ map when considered on the object and morphism sets.
\end{definition}

An $C^k$ functor between two orbifold structures $(O,\bm{O})$, $(P,\bm{P})$ with underlying topological spaces $\cO$, $\cP$ induces a continuous map on the orbit spaces $\abs{\hat{f}}:\abs{O} \to \abs{P}$, and hence also induces a continuous map $f : \cO \to \cP$, as illustrated in the following commutative diagram.
\[
	\begin{tikzcd}[row sep=small]
		\abs{O} \arrow[d,dash,"\begin{sideways}$\sim$\end{sideways}"] \arrow[r,"\abs{\hat{f}}"] & \abs{P} \arrow[d,dash,"\begin{sideways}$\sim$\end{sideways}"] \\
		\cO \arrow[r,"f"] & \cP
	\end{tikzcd}
\]

\begin{definition}
	Consider two topological spaces  $\cO$, $\cP$ with orbifold structures $(O,\bm{O})$, $(P,\bm{P})$. We define a \textbf{$C^k$ map between orbifolds} as a continuous map
	\[
		f: \cO \to \cP
	\]
	between the underlying topological spaces of the orbifolds, for which there exists an associated $C^k$ functor
	\[
		\hat{f}: (O,\bm{O}) \to (P,\bm{P}).
	\]
	such that $\abs{\hat{f}}$ induces $f$.
\end{definition}

From an abstract point of view a stronger notion of map is needed.   This leads to the definition of \textit{generalized maps} between orbifold structures, following a category-theoretic localization procedure \cite{HWZ3}*{\S2.3}.  Following this, a precise notion of map between two orbifolds is defined using an appropriate equivalence class of a given generalized map between two given orbifold structures \cite{HWZbook}*{Def.~16.1.6}.
With this in mind, taking an appropriate equivalence class of a given $C^k$ functor between two given orbifold structures is sufficient for defining a map between two orbifolds.

While a generalized map between orbifold structures necessarily induces a continuous map between the underlying topological spaces, in general the converse is not true: given a continuous map between the underlying topological spaces of two orbifolds, in general there does exist an associated generalized map which induces it.
Consider two football orbifolds defined by the action of $\Z_p$ on $S^2$ and $\Z_q$ on $S^2$; we will abuse notation and denote the orbifold structures by $S^2 / \Z_p$ and $S^2 / \Z_q$.
The underlying topological space of both these orbifolds is $S^2$.
The identity map $\id: S^2 \to S^2$ has a lift to functor $S^2 / \Z_p \to S^2 / \Z_q$ if and only if $p$ divides $q$.

However, if we consider a continuous map between the underlying topological space of an orbifold and with target space a manifold, the following theorem gives a remarkable converse to the previous paragraph: not only does there correspond a $C^0$ generalized map between the orbifold and manifold structures, but we may approximate it smoothly.

\begin{theorem}[(Whitney approximation for a continuous map between an orbifold and a manifold)]\label{thm:whitney-approximation}
	Let $\cO$ be a topological space with orbifold structure $(O,\bm{O})$, and let $\cM$ be a manifold with trivial orbifold structure $(M,\bm{M})$. Consider a continuous map between the underlying topological spaces,
	$
		f: \cO \to \cM.
	$
	Then there exists a smooth functor
	$
		\hat{h} : (O,\bm{O}) \to (M,\bm{M})
	$
	such that the induced continuous map $h=\abs{\hat{h}} : \cO \to \cM$ is homotopic to $f$.
	Furthermore, if $f$ is proper, we may assume that $h$ is also proper.
\end{theorem}
\begin{proof}
	We break the proof into four steps.

	\begin{step1}
		Associated to a continuous map between the underlying topological spaces $f: \cO \to \cM$ there exists a continuous functor $\hat{f}: (O,\bm{O}) \to (M,\bm{M})$ such that $f = \abs{\hat{f}}$.
	\end{step1}
	Construct the continuous functor
	$
		\hat{f}: (O,\bm{O}) \to (M,\bm{M})
	$
	as follows:
	\begin{itemize}
		\item on objects, define $O \to M$ by the composition $O \to \abs{O} \xrightarrow{f} \abs{M}\simeq M$,
		\item on morphisms, define $\bm{O} \to \bm{M}$ by $\bm{O}\xrightarrow{s} O \to \abs{O} \xrightarrow{f} \abs{M}\simeq\bm{M}$.
	\end{itemize}
	In both cases, the definition of the trivial orbifold structure $(M,\bm{M})$ gives the identifications $M\simeq\abs{M}\simeq \bm{M}$.
	From this definition it is clear that the induced continuous map $\abs{\hat{f}}$ is the same as the original map $f$.

	Following step 1, the proof is nearly identical to the modern proof for smooth manifolds (see \cite{lee2012introduction}*{Thms.~6.21,~6.26}). The main new ingredient is the existence of morphism invariant smooth partitions of unity (see \cite{HWZbook}*{Def.~7.5.5, Thm.~7.5.7} for this existence).

	\begin{step2}
		Let $\delta: \cO \to \R^+$ be a positive continuous function. Let $\hat{f}: (O,\bm{O}) \to \R^N$ be a continuous functor (where $\R^N$ has the trivial orbifold structure). Then there exists a smooth functor $\hat{g}:(O,\bm{O}) \to \R^N$ such that
		\[
			\norm{ f([x]) - g([x]) } < \delta([x]), \qquad \text{for all } [x]\in \cO.
		\]
	\end{step2}
	For any point $[x_0] \in \cO$, choose a local uniformizer $U(x_0)$ centered at a representative $x_0 \in O$.
	By continuity of the composition $\delta\circ \pi : O \to \R^+$, and continuity of $\hat{f}$, there exists an open neighborhood $V(x_0)$ of $x_0$ such that
	\[
		\norm{\hat{f}(x) - \hat{f}(x_0)} < \delta([x]), \qquad \text{for all } x\in V(x_0).
	\]
	By the $\bm{G}(x_0)$-invariance of $\hat{f}$, we may moreover assume the neighborhood $V(x_0)$ is $\bm{G}(x_0)$-invariant. Since the projection $\pi: O \to \cO, x\mapsto [x]$ is an open map, $\abs{V(x_0)}$ is an open neighborhood of $[x_0]\in \cO$.
	Repeating this for any point $[x_i] \in \cO$ we obtain an open cover $\{\abs{V_i}\}_{i\in I}$ of $\cO$.
	Denote by $V^*_i := \pi^{-1} (\pi(V_i))$ the saturation of each open set $V_i$; the collection $\{V^*_i\}_{i\in I}$ is a saturated open cover of the object space $O$.
	Moreover, observe via the morphism invariance of $\hat{f}$ that
	\begin{equation}\label{eq:norm}
		\norm{\hat{f}(y)- f([x_i])}=\norm{\hat{f}(y) - \hat{f}(x_i)} < \delta([y]), \qquad \text{for all } y\in V^*_i.
	\end{equation}

	Let $\beta_i : O \to [0,1], i\in I$ be a morphism invariant smooth partition of unity subordinate to the cover
	$\{V^*_i\}_{i\in I}$. Define
	\begin{align*}
		\hat{g}: O & \to \R^k                                    \\
		y          & \mapsto \sum_{i\in I} \beta_i (y) f([x_i]).
	\end{align*}
	Then $\hat{g}$ is a smooth function. Moreover, $\hat{g}$ is morphism invariant since each $\beta_i$ is morphism invariant. By sending all morphisms $\phi \in \bm{O}$ to the appropriate identity morphism (that is, $\hat{g}(\phi) := \id_{\hat{g} (s(\phi))}$) we see that $\hat{g}$ defines a smooth functor.

	For any object $y\in O$, since $\sum_{i\in I} \beta_i \equiv 1$ we have
	\begin{align*}
		\norm{ \hat{f}(y) - \hat{g}(y)	}
		 & = \norm{\left(	\sum_{i\in I} \beta_i(y)	\right) \hat{f}(y) - \sum_{i\in I} \beta_i (y) f([x_i])} \\
		 & = \sum_{i\in I} \beta_i(y) \norm{	\hat{f}(y) - f([x_i])	}                                        \\
		 & \leq \delta([y]),
	\end{align*}
	where the final inequality comes from equation \eqref{eq:norm} and the fact that $y \in \supp \beta_i$ only if $y \in V^*_i$.

	\begin{step3}
		We define the smooth functor approximating $f$, following \cite{lee2012introduction}*{Thm.~6.26} closely.
	\end{step3}
	By the Whitney embedding theorem \cite{lee2012introduction}*{Thm.~6.15}, we may assume $\cM$ is a properly embedded submanifold of $\R^N$.
	By \cite{lee2012introduction}*{Prop.~6.25}, there exists a tubular neighborhood $U$ of $\cM$ in $\R^N$ and a smooth retraction $r: U \to \cM$.

	Define $\delta' : \cM \to \R^+$ by
	\[
		\delta'(x) := \sup \{\ep\leq 1 \mid B_\ep (x)\subset U\},
	\]
	as in \cite{lee2012introduction}*{Thm.~6.26}, this function is continuous. Define a continuous function $\delta: \cO \to \R^+$ by the composition $\delta := \delta' \circ f$.

	By step 2, there exists a smooth functor $\hat{g} : (O,\bm{O}) \to \R^N$ such that
	\[
		\norm{f([x])-g([x])} \leq \delta([x]) \qquad \text{for all } [x] \in \cO.
	\]
	Let $H: \cO \times [0,1] \to \cM$ be the composition of $r$ with the straight line homotopy between $f([x])$ and $g([x])$:
	\[
		H([x],t) : = r\left(	(1-t) f([x]) + t g([x])	\right)
	\]
	Note that $	(1-t) f([x]) + t g([x]) \in U$; by construction, $\norm{f([x])-g([x])} \leq \delta([x])= \delta'(f([x]))$ hence $g([x]) \in B_{\delta'([x])} (f([x])) \subset U$, and then use convexity of the ball.

	Thus, $H$ is a homotopy between the maps $H(\cdot,0) = f$ and the map $H(\cdot,1) = r\circ g$.
	Moreover, the composition $h:= r\circ g : \cO \to \cM$ has an associated smooth functor given by the composition
	\[
		\hat{h}: (O,\bm{O}) \xrightarrow{\hat{g}} (U,\bm{U}) \xrightarrow{\hat{r}} (M,\bm{M}).
	\]
	where $\hat{r}: (U,\bm{U}) \to (M,\bm{M})$ is the trivial functor associated to the trivial orbifold structures on $U$ and $\cM$.

	\begin{step4}
		If $f:\cO \to \cM$ is proper, so is $h:\cO \to \cM$.
	\end{step4}
	The reasoning is identical to the analogous statement for smooth manifolds.

	We show that the function $g:\cO \to \R^N$ is proper. Let $K \subset \R^N$ be a compact set, and let $L \subset \R^N$ be all points in $\R^N$ of distance at most $1$ from $K$. Then $L$ and the intersection $L \cap \cM$ are also compact. We may observe that
	\[
		g^{-1}(K) \subset f^{-1}(L\cap \cM);
	\]
	this follows from $\norm{ f([x]) - g([x]) } < \delta([x]) \leq 1$. Since $f$ is proper, $f^{-1}(L\cap\cM)$ is compact, and thus $g^{-1}(K)$ is a closed subset of a compact set and also compact.

	Without loss of generality we may assume that the fibers of the tubular neighborhood $U$ of $\cM$ in $\R^N$ are compact with non-empty interior; it follows that the smooth retraction $r : U \to \cM$ is proper and the conclusions of step 3 still hold.

	Therefore $h = r \circ g$ is a composition of proper maps, and is also proper.
\end{proof}

We now explain the appropriate definition of an orbifold bundle.
Let $(O,\bm{O})$ be an ep-groupoid, and consider a vector bundle over the object space, $P:E\to O$.
The source map $s:\bm{O}\to O$ is a local diffeomorphism, and hence we may consider the fiber product
\[
	\bm{O} _s\times_P E = \{(\phi,e)\in \bm{O}\times E	\mid	s(\phi)=P(e)	\}.
\]
We may also view as $\bm{O} _s\times_P E$ as the pullback bundle via $s$ over the morphism space $\bm{O}$,
\begin{equation*}
	\begin{tikzcd}
		\bm{O} _s\times_P E \arrow[r] \arrow[d] & E \arrow[d] \\
		\bm{O} \arrow[r, "s"] & O.
	\end{tikzcd}
\end{equation*}

\begin{definition}[(\cite{HWZbook}*{Def.~8.3.1})]\label{def:orbifold-bundle}
	A \textbf{bundle over an ep-groupoid} consists of a vector bundle over the object space $P:E\to O$ together with a bundle map
	\[
		\mu : \bm{O} _s\times_P E \to E
	\]
	which covers the target map $t:\bm{O} \to O$, such that the diagram
	\begin{equation*}
		\begin{tikzcd}
			\bm{O} _s\times_P E \arrow[r, "\mu"] \arrow[d] & E \arrow[d] \\
			\bm{O} \arrow[r, "t"] & O
		\end{tikzcd}
	\end{equation*}
	commutes.
	Furthermore we require the following:
	\begin{enumerate}
		\item $\mu$ is a surjective local diffeomorphism and linear on fibers,
		\item $\mu(\id_x,e)= e$ for all $x\in O$ and $e\in E_x$,
		\item $\mu(\phi \circ \g ,e)= \mu (\phi,\mu(\g,e))$ for all $\phi,\g\in\bm{O}$ and $e\in E$ which satisfy
		      \[
			      s(\g) = P(e),\qquad t(\g) = s(\phi) = P(\mu(\g,e)).
		      \]
	\end{enumerate}
\end{definition}

Given a bundle over an ep-groupoid we may obtain an ep-groupoid $(E,\bm{E})$ as follows: take the original vector bundle $E$ as object set, and take $\bm{E} := \bm{O} _s\times_P E$ as morphism set.  Moreover, we have source and target maps $s,t :\bm{E} \to E$ defined as follows:
\[
	s(\phi,e) := e, \qquad t(\phi,e) := \mu(\phi,e).
\]
There is a natural smooth projection functor $\hat{P}: (E,\bm{E}) \to (O,\bm{O})$.

Given an ep-groupoid $(O,\bm{O})$ we can define \textbf{tangent bundle over an ep-groupoid} by taking the tangent bundle over the object space $P:TO\to O$ and by defining
\[
	\mu : 	\bm{O} _s\times_P TO \to TO, \qquad	(\phi, e) \mapsto T\phi (e).
\]

We now introduce what will become the central objects resulting from the proof of the Steenrod problem for orbifolds.

\begin{definition}\label{def:embedded-full-suborbifold}
	Let $(O,\bm{O})$ be an orbifold structure of dimension $n$.
	An \textbf{embedded full suborbifold structure} of dimension $k$ consists of a subgroupoid $(X,\bm{X}) \subset (O,\bm{O})$, whose objects and morphisms are given the subspace topology, and which satisfies the following conditions:
	\begin{enumerate}
		\item\label{def:suborbifold-condition-1} The subcategory $(X,\bm{X})$ is full and the object set is saturated, i.e.,
		      \begin{itemize}
			      \item for all objects $x,y\in X$, $\text{mor}_X (x,y) = \text{mor}_O (x,y)$,
			      \item $X=\pi^{-1}(\pi(X))$, where $\pi: O \to \abs{O}, x\mapsto [x]$.
		      \end{itemize}
		\item\label{def:suborbifold-condition-2} At any object $x\in O$ there exists a $\bm{G}(x)$-invariant neighborhood $U\subset O$ and a chart $\phi: U\to \R^n$; it follows that $X\cap U$ is also $\bm{G}(x)$-invariant. We then require that $\phi(X\cap U)$ is the intersection of a $k$-dimensional plane of $\R^n$ with $\phi(U)$.
	\end{enumerate}
	We then say that $\cX\simeq \abs{X}$ with the Morita equivalence class $[(X,\bm{X})]$ is an \textbf{embedded full suborbifold} of the orbifold $\cO\sim \abs{O}$ with Morita equivalence class $[(O,\bm{O})]$.
\end{definition}

With this definition $(X,\bm{X})$ is naturally a $k$-dimensional orbifold structure in its own right.
The object set $X$ has the structure of a $k$-dimensional submanifold of the object set $O$, considered with respect to the manifold structure on $O$. Charts are given by the restrictions $\phi|_{X\cap U} : X\cap U \to \R^k$ and smoothness of the transition maps is then inherited from the smoothness of the transition maps for $O$. In a similar way, one can give the morphism set $\bm{X}$ the structure of a $k$-dimensional submanifold, and check that the \'etale property for $(X,\bm{X})$ is induced from the \'etale property of $(O,\bm{O})$.
One can see properness using the following fact: if a map $f:X\to Y$ is proper, then for any subset $V\subset Y$ the restriction $f|_{f^{-1}(V)}: f^{-1}(V)\to V$ is proper.

With these orbifold structures, the inclusion functor
$\hat{i}: (X,\bm{X}) \hookrightarrow (O,\bm{O})$
is a smooth embedding on both objects and morphisms.

Since the subcategory $(X,\bm{X})$ is full, observe that for an object $x\in X$ the isotropy groups, considered with respect to $X$ and with respect to $O$, are identical, i.e.,
\[
	\{ \phi \in \bm{X} \mid s(\phi)=t(\phi) = x	\} = \{	\phi \in \bm{O} \mid s(\phi)=t(\phi) = x\}.
\]
We may therefore denote both isotropy groups as $\bm{G}(x)$ without ambiguity.

\begin{remark}
	For a somewhat more general definition of suborbifold we refer to \cite{adem2007orbifolds}*{Def.~2.4}, see also \cite{cho2013orbifold}*{Def.~3.1}.
	In contrast to the above definition of a full suborbifold, the isotropy groups for a general suborbifold $\cX$ of an orbifold $\cO$ will not be identical. Instead, at an object $x\in X\subset O$ there exists a $\bm{G}_\cO(x)$-invariant neighborhood $U\subset O$ and a chart $\phi: U\to \R^n$, such that $\phi(X\cap U)$ consists of a {union} of precisely $\sharp \bm{G}^\text{eff}_\cO (x) / \sharp \bm{G}^\text{eff}_\cX(x)$-many
	$k$-dimensional planes intersected with $\phi(U)$.
\end{remark}

There exist definitions of Riemannian metrics and normal bundles for orbifolds; in particular, we may consider the normal bundle of an embedded full suborbifold (see \cite{chen2001orbifoldgromovwitten}*{Appx.}).

\begin{definition}
	Let $\cX$ be an embedded full suborbifold of an orbifold $\cO$, and consider the normal bundle $N\cX$.
	We say that $N\cX$ has \textbf{fiberwise trivial isotropy action} if for every object $x\in X$ the isotropy group $\bm{G}(x)$ acts trivially on the normal space $N_x X$ at $x$.
\end{definition}

In terms of Definition~\ref{def:orbifold-bundle}, $N\cX$ has fiberwise trivial isotropy action if $\mu(\phi,e) = e$ for any isotropy morphism $\phi\in\bm{G}(x)$.

We can formulate a tubular neighborhood theorem as follows.
For a sufficiently small open neighborhood $N_\ep\cX$ of the zero section $\cX \to N\cX$ there exists a well-defined map between orbifolds
\[i: N_\ep\cX \to \cO\]
which is a homeomorphism onto its image when considered with respect to the underlying topological spaces, and which is a local diffeomorphism when considered with respect to the orbifold structures.

\begin{remark}\label{rmk:orbit-space-normal-bundle}
	It follows from the definition that the underlying topological space $N\cX$ of a normal bundle with fiberwise trivial isotropy action is in fact a vector bundle over the underlying topological space $\cX$.
	This is in contrast to the orbit space of an arbitrary orbifold bundle---in general, the quotient of a fiber by a nontrivial isotropy action will no longer be a vector space.
\end{remark}

\subsection{Elementary orbifold algebraic topology}\label{subsec:elementary-orbifold-alg-top}

From the beginning, Satake gave definitions for the natural analog of de Rahm cohomology for orbifolds, and recognized that closed oriented orbifolds satisfy Poincar\'e duality with respect to this cohomology \cite{satake1956generalization}.
Given an orbifold $\cO$ with an orbifold structure $(O,\bm{O})$ the \textbf{de Rahm complex} is be defined as the space of differential forms on the object space $O$ which are morphism invariant:
\[
	\Omega_{ep}^* (O) := \{	\ww\in \Omega^*(O) \mid T\phi^* \ww_y = \ww_x \text{ for every morphism } \phi:x\to y	\}.
\]
The exterior derivative preserves morphism invariance, and hence we can consider the \textbf{de Rahm cohomology}
$
	H^*_{\dR} (\cO) := H^*(\Omega_{ep}^* (O), d)
$
of an orbifold.

\begin{theorem}[(Comparison of orbifold cohomology theories)]
	Consider an orbifold $\cO$.
	In addition to the de Rahm cohomology, we may consider the \v{C}ech cohomology (with real coefficients) of the underlying topological space, denoted $\check{H}^*(\cO; \R)$; and the singular cohomology (with real coefficients) of the underlying topological space, denoted $H^*(\cO; \R)$. These cohomology theories are naturally isomorphic:
	\[
		H^*_{\dR} (\cO) \simeq \check{H}^*(\cO; \R) \simeq H^*(\cO; \R).
	\]
\end{theorem}
\begin{proof}
	The first isomorphism $H^*_{\dR} (\cO) \simeq \check{H}^*(\cO; \R)$ was proved by Satake \cite{satake1956generalization}*{Thm.~1}. The second isomorphism $\check{H}^*(\cO; \R) \simeq H^*(\cO; \R)$ follows from the fact that orbifolds admit a triangulation (see \cite{moerdijk1999simplicial}*{Prop.~1.2.1}) and from the fact that \v{C}ech and singular homology coincide for triangulable spaces (see \cite{eilenberg1952foundations}*{Ch.~IX Thm.~9.3}).
\end{proof}

\begin{theorem}[(\cite{satake1956generalization}*{Thm.~3})]
	Let $\cO$ be a closed oriented orbifold of dimension $n$.
	With respect to the real \v{C}ech (co)homology of $\cO$ (and hence also real singular (co)homology) there exists a natural Poincar\'e duality isomorphism
	\[
		\check{H}^*(\cO;\R) \simeq \check{H}_{n-*}(\cO;\R).
	\]
\end{theorem}

Via the isomorphisms $H^*(\cO;\Q)\otimes \R \simeq H^*(\cO;\R)$, $H_*(\cO;\Q)\otimes \R \simeq H_*(\cO;\R)$, observe compact orbifolds satisfy Poincar\'e duality for \v{C}ech and singular cohomology with rational coefficients.
Orbifolds can moreover be considered as \textit{rational homology manifolds}, in the sense that for any $[x]\in\cO$,
\[
	H_* (\cO, \cO \setminus \{[x]\}; \Q) =
	\begin{cases}
		\Q & *=0,\ \dim \cO \\
		0  & \text{else}.
	\end{cases}
\]

\begin{remark}[(Failure of Poincar\'e duality for general coefficients)]
	In spite of the above fact that compact orbifolds satisfy Poincar\'e duality for rational coefficients, for general coefficients Poincar\'e duality fails. In a recent paper by Lange, a classification theorem establishes that the underlying space of an orbifold is a topological manifold if and only if all local isotropy groups are of a specific form \cite{lange2015underlying}*{Thm.~A}.
	Hence, any global quotient orbifold of the form $S^n / G$ for a group $G$ which is not of this specific form will fail to satisfy Poincar\'e duality for general choice of coefficients.
\end{remark}

\begin{remark}[(Alternative orbifold cohomology theories)]
	The cohomology theories we have considered thus far depend only on the topology of the underlying topological space of an orbifold.
	In \cite{chen2004newcohomology} an exotic cohomology theory (called \textit{Chen--Ruan cohomology}) of orbifolds is defined by formulating an appropriate generalization of quantum cohomology to orbifolds, and then restricting to the degree-zero portion of this cohomology to recover a new cohomology theory.
	In contrast to the above cohomology theories, this cohomology theory incorporates additional data about the local isotropy groups.
\end{remark}

\subsubsection[Relationship between the Thom class and the Poincar\'e dual of a suborbifold]{Relationship between the {T}hom class and the {P}oincar\'e dual of a suborbifold}

Recall the defining properties of the Thom class in topological terms. Consider an oriented rank $k$ vector bundle $\pi: E\to B$ over a paracompact topological space.	Then there exists a unique cohomology class with compact vertical support $u_B \in H^k_{cv} (E;\Z)$ called the \textbf{Thom class}, and which is characterized by the following properties.
\begin{itemize}
	\item For every $x\in B$ the restriction of $u_B$ to $H^k_{cv}(E_x;\Z)\simeq\Z$ is the generator determined by the orientation of $E$.
	\item The map
	      \begin{align*}
		      H^*(B;\Z) & \to H^{*+k}_{cv}(E;\Z)       \\
		      \alpha    & \mapsto \pi^*\alpha \cup u_B
	      \end{align*}
	      is an isomorphism.
\end{itemize}

In the current situation of orbifolds, we can rephrase these properties in terms of de Rahm classes.  This can be used to give an explicit description of the Poincar\'e dual of an embedded full suborbifold.

Let $\cX$ be a closed embedded full suborbifold of an orbifold $\cO$.
Consider the normal bundle $N\cX$ of rank $k:=\dim \cO - \dim \cX$, and suppose that it is oriented and has fiberwise trivial isotropy action.
In terms of de Rahm cohomology, the Thom class is the unique cohomology class $\tau\in H^k_{\dR,cv} (N\cX)$, i.e., a de Rahm form with compact vertical support,
and which is characterized by the following properties.
\begin{itemize}
	\item For every $[x]\in \cX$ the restriction of $\tau$ to $H_{\dR,c}^k (N_{[x]} \cX)$ is the generator determined by the orientation of $N\cX$. Here $H_{\dR,c}^*$ denotes the space of de Rahm forms with compact support.
	\item The map
	      \begin{align*}
		      H_{\dR}^* (\cX) & \to H_{\dR,cv}^{*+k} (N\cX)  \\
		      \ww             & \mapsto \pi^*\ww \wedge \tau
	      \end{align*}
	      is an isomorphism.
\end{itemize}

These two definitions of the Thom class coincide, in the sense that the integral Thom class $u_{\cX}$ maps to the de Rahm class $\tau$ under the map
\[H^*_{cv} (N\cX;\Z) \xrightarrow{\otimes\R} H^*_{cv} (N\cX;\R) \simeq H^*_{\dR,cv} (N\cX).\]
Moreover, when $\cX$ is compact the cohomology of the normal bundle $N\cX$ with compact vertical support is the same as the cohomology with compact support; therefore, when $\cX$ is compact its Thom class has compact support.

\begin{proposition}\label{prop:thom-class-poincare-dual}
	Consider the well-defined pushforward $i_* : H^*_{\dR,cv} (N_\ep \cX) \allowbreak \to \allowbreak H^*_{\dR}(\cO)$, defined for $\ep$ sufficiently small.
	If $\cO$ is closed and oriented this map has the following significance: the Poincar\'e dual of $\cX$ can be represented by the pushforward of the Thom class by this map, i.e., \[\PD ([\cX]) = i_* \tau.\]
\end{proposition}

\subsection{Elementary orbifold transversality results}\label{subsec:elementary-orbifold-transversality}

When considering transversality of maps between orbifolds, it is often necessary to use modern techniques such as multisections.
However, when the target space of such a map is a manifold, transversality is easily achievable without such techniques.

\begin{definition}
	Let $\cO$ be an orbifold.  Let $\cM$ be a manifold, and let $\cY \subset \cM$ be a closed embedded submanifold.
	Consider a smooth map $f: \cO \to \cM$ with an associated smooth functor
	$\hat{f} : (O,\bm{O}) \to (M,\bm{M})$.
	We say that $f$ is \textbf{transverse} to $\cY$, written symbolically as $f\pitchfork \cY$, if for every object $x\in \hat{f}^{-1}(Y)\subset O$
	\[
		D\hat{f}_x (T_x O) \oplus T_{\hat{f}(x)} Y = T_{\hat{f}(x)} M.
	\]
\end{definition}

\begin{theorem}\label{thm:perturb-submanifold}
	Consider the above situation of an orbifold $\cO$, a manifold $\cM$, a compact embedded submanifold $\cY \subset \cM$, and a smooth map $f:\cO \to \cM$.

	We may perturb $\cY$ so that $f\pitchfork \cY$.  Stated formally, the inclusion map $i: \cY \hookrightarrow \cM$ is homotopic to a smooth inclusion map $i': \cY \hookrightarrow \cM$ such that $f \pitchfork i'(\cY)$.
	In addition, if we assume that $f^{-1}(i(\cY))$ is compact then we may assume that $f^{-1}(i'(\cY))$ is also compact.
\end{theorem}
\begin{proof}
	Choose a cover of the underlying topological space $\cO$ by countably many open sets $\abs{U_k}$ where $U_k \subset O$ are local uniformizers.
	Observe that the property $f\pitchfork \cY$ is equivalent to the property that the collection of smooth maps
	\[\hat{f}|_{U_k} \times i : U_k \times \cY \to \cM\times \cM\]
	are transverse to the diagonal $\Delta \subset \cM \times \cM$.

	There exists a smooth family of maps $I: \cY \times B^N  \to \cM$ for some $N$, which is a submersion and such that $I(\cdot,0) = i(\cdot)$. It then follows that the collection of smooth maps
	\[
		\hat{f}|_{U_k} \times I : U_k \times \cY \times B^N \to \cM \times \cM
	\]
	are transverse to the diagonal $\Delta$. So, choose a regular $s\in B^N$ and define $i'(\cdot) := I(\cdot,s)$.
\end{proof}

\begin{theorem}\label{thm:transverse-implies-suborbifold}
	When $f\pitchfork \cY$ the underlying set $f^{-1}(\cY)\subset \cM$ naturally has the structure of an embedded full suborbifold of codimension
	\[
		\codim f^{-1} (\cY) = \codim \cY.
	\]
	Moreover, the normal bundle of $f^{-1}(\cY)$ has fiberwise trivial isotropy action.
\end{theorem}
\begin{proof}
	We check the conditions of Definition~\ref{def:embedded-full-suborbifold}.
	Define a subcategory of $(O,\bm{O})$ as follows:
	\begin{itemize}
		\item define the object set by $X := \hat{f}^{-1}(Y)$,
		\item define the morphism set by $\bm{X} := \hat{f}^{-1}(\bm{Y})$.
	\end{itemize}
	It is immediate that $(X,\bm{X})$ is a full subcategory with saturated object set, hence condition \ref{def:suborbifold-condition-1} is satisfied.
	On the other hand, condition \ref{def:suborbifold-condition-2} follows from the assumption $f\pitchfork \cY$.

	Next, observe that the linearization of $\hat{f}$ induces a functor between the tangent bundles
	$
		D\hat{f}: (TO, \bm{TO}) \to (TM, \bm{TM}),
	$
	and moreover, this functor has a well-defined restriction to the normal bundle $(NX,\bm{NX})$ over the suborbifold $(X,\bm{X})$, such that the following diagram commutes:
	\begin{equation*}
		\begin{tikzcd}[column sep = large]
			(NX,\bm{NX}) \arrow[r, "D\hat{f}|_{(NX,\bm{NX})}"] \arrow[d]	& (TM|_Y, \bm{TM}|_{\bm{Y}}) \arrow[r, "\pr_{NY}"] \arrow[d]			& (NY, \bm{NY}) \arrow[d]\\
			(X,\bm{X})	\arrow[r, "\hat{f}|_{(X,\bm{X})}"] 					& (Y, \bm{Y}) \arrow[r,"\id"] & (Y, \bm{Y}).
		\end{tikzcd}
	\end{equation*}
	The transversality assumption implies that $\pr_{N_{\hat{f}(x)}Y} \circ D\hat{f}_x : N_x X \to N_{\hat{f}(x)} Y$ is an isomorphism. However, $N_{\hat{f}(x)} Y$ has trivial isotropy action, hence $N_x X$ must also necessarily have trivial isotropy action.
\end{proof}

\begin{remark}
	Similar observations to the previous theorem were made in \cite{borzellino2012elementary}.
	In our language, they consider a smooth map between orbifolds, $f: \cO \to \cP$
	and prove that the preimage $f^{-1}([y])$ of a regular value $[y] \in \cP$ has the structure of an embedded full suborbifold whose normal bundle has fiberwise trivial isotropy action.
\end{remark}

\subsection[Solving the Steenrod problem for orbifolds]{Solving the {S}teenrod problem for orbifolds}\label{subsec:solving-the-steenrod-problem}

Consider the classifying space $B_k$ with associated universal bundle $E_k$ which together are characterized by the following property: any oriented rank $k$ vector bundle $V$ over a CW-complex $A$ can be obtained as the pullback of $E_k$ via a continuous map to $B_k$, i.e., there exists a continuous map $f: A \to B_k$ such that $f^* E_k = V$.

If we restrict to CW-complexes of dimension less than $n$, we may assume that $B_k$ is the Grassmannian $\hat{G}_k (\R^m)$ for $m$ sufficiently large. The Grassmannian $\hat{G}_k (\R^m)$ consists of oriented real $k$-planes in $\R^m$.
We may then assume that $E_k$ is the universal quotient bundle $Q$ over $\hat{G}_k(\R^m)$.
Finally recall that $\hat{G}_k (\R^m)$ is a finite-dimensional closed oriented manifold and $Q$ is a rank $k$ oriented vector bundle.

\begin{definition}
	Give $E_k$ a metric, and denote by $D_\ep \subset E_k$ the open $\ep$-disk bundle over $B_k$, consisting of vectors of length $< \ep$. The \textbf{Thom space} $Th(k)$ is defined as the one-point compactification of $D_\ep$, hence the Thom space has underlying set
	\[
		Th(k) := D_\ep \sqcup \{\infty\}.
	\]
\end{definition}

For $*>0$, the pushforward of the inclusion map, $j_*:H^*_c(D_\ep;\Z) \to H^* (Th(k);\Z)$ is an isomorphism \cite{thom1954quelques}*{p.~29}.
Without loss of generality we may assume the support of the Thom class of $B_k$ is contained in this $\ep$-disk bundle, i.e., $\supp u_{B_k} \subset D_\ep$. We denote its image under the pushforward of the inclusion by
\[U:= j_* u_{B_k}.\]

Via obstruction theory, it is possible to define maps from ($q$-cell approximations of) the Eilenberg--MacLane spaces to the Thom spaces such that the pullback of the class $U$ is a nonzero integer multiple of the distinguished element of an Eilenberg--MacLane space.
Using these techniques, the Thom spaces can be treated as classifying spaces with respect to homology, as the following theorem demonstrates.

\begin{theorem}[(\cite{thom1954quelques}*{Thm.~II.25})]\label{thm:thom-em-space}
	Let $A$ be a CW-complex of finite dimension $n$, and consider a cohomology class $x\in H^k(A;\Z)$.
	There exists a positive nonzero integer $N$ (depending only on $k$ and $n$) such that the following holds.
	There exists a continuous map
	\[f: A \to Th(k)\]
	such that the pullback $f^*: H^*(Th(k);\Z) \to H^*(A;\Z)$ satisfies the following:
	\[f^*U = N \cdot x.\]
\end{theorem}

We are now able to solve the Steenrod problem for closed orientable orbifolds. Our approach is due to Thom, with modifications made as necessary to deal with the more general nature of orbifolds as opposed to manifolds.

\begin{theorem}\label{thm:steenrod-problem}
	Let $\cO$ be a closed oriented orbifold of dimension $n$.
	\begin{enumerate}[label = \Roman*.]
		\item\label{thm:steenrod-i} Suppose that $\cX\subset \cO$ is a closed oriented embedded full suborbifold of codimension $k$ whose normal bundle $N\cX$ has fiberwise trivial isotropy action. Let $[\cX]\in H_{n-k}(\cO;\Q)$ denote its rational fundamental class.
		      Then there exists a continuous map
		      \[\tilde{F}: \cO \to Th(k)\]
		      such that
		      \[\tilde{F}^*U = \PD ([\cX]).\]
		\item\label{thm:steenrod-ii} Consider a rational homology class $x\in H_{n-k}(\cO;\Q)$. Then there exists a positive nonzero integer $N$ such that $N\cdot x$ is the rational fundamental class of a closed oriented embedded full suborbifold $\cX \subset \cO$ of codimension $k$, i.e.,
		      \[
			      [\cX] = N \cdot x,
		      \]
		      and moreover, such that the normal bundle $N\cX$ has fiberwise trivial isotropy action.
	\end{enumerate}
\end{theorem}
\begin{proof}[Proof of \ref{thm:steenrod-i}\nopunct]
	In Remark~\ref{rmk:orbit-space-normal-bundle} we observed that underlying topological space $N\cX$ is a vector bundle over the (paracompact) topological space $\cX$.
	Moreover, given orientations on $\cO$ and $\cX$ the bundle $N\cX$ carries an induced orientation.
	Hence, there exists a continuous map to the classifying space, $f: \cX \to B_k$, such that $f^*E_k = N\cX$.  We have the following pullback diagram,
	\begin{equation*}
		\begin{tikzcd}
			N\cX \arrow[r, "F"] \arrow[d] & E_k \arrow[d] \\
			\cX \arrow[r, "f"] & B_k,
		\end{tikzcd}
	\end{equation*}
	and furthermore, the Thom classes
	\[u_\cX \in H^k_c(N\cX;\Z), \qquad u_{B_k} \in H^k_c(E_k;\Z) \]
	are related by pullback, $F^* u_{B_k} = u_\cX$.

	We now replace $E_k$ with the open $\ep$-disk bundle $D_\ep$.
	Consider the open set $N_\ep \cX :=F^{-1}(D_\ep)\subset N\cX$. We may assume that $\supp u_\cX \subset N_\ep \cX$ and $\supp u_{B_k} \subset D_\ep$. For $\ep$ sufficiently small we have inclusion maps
	$i: N_\ep \cX \hookrightarrow \cO$, $j: D_\ep \hookrightarrow Th(k)$ and pushforwards
	\begin{align*}
		i_*: & H^k_c(N_\ep \cX;\Z) \to H^k(\cO;\Z), \\
		j_*: & H^k_c(D_\ep ;\Z) \to H^k(Th(k);\Z).
	\end{align*}
	We may extend the restricted map $F: N_\ep \cX \to D_\ep$ to a continuous map $\tilde{F}: \cO \to Th(k)$ as follows:
	\begin{itemize}
		\item on $N_\ep \cX$, define $\tilde{F}$ by $F : N_\ep \cX \to D_\ep$,
		\item map all points in $\cO \setminus N_\ep \cX$ to $\{\infty\} \in Th(k)$.
	\end{itemize}
	We therefore have the following commutative diagram:
	\begin{equation*}
		\begin{tikzcd}
			H^k(\cO; \Z) & H^k (Th(k); \Z) \arrow[l, "\tilde{F}^*"] \\
			H^k_c (N_\ep \cX; \Z) \arrow[u, "i_*"] & H^k_c(D_\ep; \Z) \arrow[u, "j_*"] \arrow[l, "F^*"].
		\end{tikzcd}
	\end{equation*}
	It follows that $\tilde{F}^* U = \tilde{F}^* j_* u_{B_k} = i_* F^* u_{B_k} = i_* u_\cX$.
	Switching to de Rahm cohomology, by Proposition~\ref{prop:thom-class-poincare-dual} we see that the Poincar\'e dual of a closed embedded full suborbifold equals the pushforward of the Thom class of its normal bundle, i.e., $\PD([\cX]) = i_* u_\cX$ and therefore
	\[
		\tilde{F}^* U = \PD ([\cX]).
	\]
	The statement for rational coefficients follows from the isomorphism $H_*(\cO;\Q) \allowbreak \otimes \R \simeq H_*(\cO;\R)$.
\end{proof}

\begin{proof}[Proof of \ref{thm:steenrod-ii}\nopunct]
	By Theorem~\ref{thm:thom-em-space}, there exists a positive nonzero integer $N$ (depending on only $k=\deg \PD(x)$ and $n= \dim \cO$) such that there exists a continuous map
	\[f: \cO \to Th(k)\]
	such that
	\[f^*U = N \cdot \PD (x).\]

	Note that $f^{-1} (B_k) \subset \cO$ is a compact subset (it is a closed subset of the compact topological space $\cO$).
	Let $\cO' := \cO \setminus f^{-1} (\infty) $; it is an open subset of $\cO$ and hence carries an induced orbifold structure $(O',\bm{O'})$.

	Consider the continuous restricted map
	\[
		f|_{\cO'} : \cO'  \to D_\ep.
	\]
	Observe that since $f$ is proper, the restriction $f|_{\cO'}$ is also proper.
	By our Whitney approximation theorem~\ref{thm:whitney-approximation} there exists a smooth functor
	\[
		\hat{g} : (O', \bm{O'}) \to (D_\ep, \bm{D}_\ep)
	\]
	such that the induced continuous map $g = \abs{\hat{g}}: \cO' \to D_\ep$ is homotopic to $f|_{\cO'}$, and moreover, such that $g$ is proper.

	By Theorem~\ref{thm:perturb-submanifold}, we may perturb the submanifold $B_k\subset D_\ep$ so that it is transverse to this smooth functor, hence without loss of generality we may assume that $g \pitchfork B_k$.
	By Theorem~\ref{thm:transverse-implies-suborbifold}, the set
	\[
		\cX : = g^{-1} (B_k) \subset \cO'
	\]
	has the structure of a closed embedded full suborbifold $(X, \bm{X})$ of codimension $k$ whose normal bundle has fiberwise trivial isotropy action.

	Observe that the Thom classes
	\[
		u_\cX \in H^k_c(\cO';\Z), \qquad u_{B_k} \in H^k_c(D_\ep;\Z)
	\]
	are related by pullback, $u_\cX = g^* u_{B_k}$. Since $g$ and $f|_{\cO'}$ are homotopic, we have the following commutative diagram
	\begin{equation*}
		\begin{tikzcd}
			H^k(\cO; \Z)	& H^k (Th(k) ;\Z) \arrow[l, "f^*"]	\\
			H^k_c(\cO'; \Z) \arrow[u, "i_*"]	& H^k_c( D_\ep ; \Z ) \arrow[l,"g^*"] \arrow[u, "j_*"]
		\end{tikzcd}
	\end{equation*}
	and therefore
	\[
		\PD ([\cX]) = i_* (u_\cX) = i_* g^* (u_{B_k}) = f^*j_*(u_{B_k}) = f^* U = N \cdot \PD(x).
	\]
	Hence $[\cX] = N \cdot x$, as desired.
\end{proof}


\section{Defining polyfold invariants}\label{sec:defining-polyfold-invariants}

Over the past two decades, Hofer, Wysocki, and Zehnder have developed a new approach to
resolving transversality issues that arise in the study of $J$-holomorphic curves in symplectic
geometry called polyfold theory \cites{HWZ1, HWZ2, HWZ3, HWZint, HWZsc, HWZbook}. This approach has been successful in constructing a well-defined Gromov--Witten invariant \cite{HWZGW}.
For a survey of some of the core ideas of polyfold theory, we refer to \cite{ffgw2016polyfoldsfirstandsecondlook}.

\subsection{Polyfolds and weighted branched suborbifolds}\label{subsec:weighted-branched-suborbifolds}

In broad terms, a ``polyfold'' may be viewed as a generalization of an (usually infinite-dimensional) orbifold.
According to the previous mantra, considered as a topological space a {polyfold} is locally homeomorphic to the quotient of an open set of an ``$\ssc$-retract'' by a finite group action.  In formal terms, we offer the following definition.

\begin{definition}[(\cite{HWZbook}*{Defs.~16.1.1,~16.1.3})]
	A \textbf{polyfold structure} on a second countable, paracompact, Hausdorff topological space $\cZ$ consists of:
	\begin{itemize}
		\item an ep-groupoid $(Z,\bm{Z})$, whose object and morphism spaces are both M-polyfolds and where the \'etale condition now requires that the source and target morphisms are surjective local $\ssc$-diffeomorphisms,
		\item a homeomorphism $\abs{Z} \simeq \cZ$.
	\end{itemize}
	A \textbf{polyfold} consists of a second countable, paracompact, Hausdorff topological space $\cZ$ together with a Morita equivalence class of polyfold structures $[(Z,\bm{Z})]$ on $\cZ$.
\end{definition}

We will always assume that polyfolds admit $\ssc$-smooth partitions of unity (see \cite{HWZbook}*{\S7.6.2} for further details on this assumption). This assumption is necessary for the proof of Stokes' theorem~\ref{thm:stokes}.

In the present context we will not discuss polyfolds in depth, but instead treat them as ambient topological spaces in which the current objects of study---the weighted branched suborbifolds---sit as subsets.

View $\Q^+:= \Q \cap [0,\infty)$ as an ep-groupoid, having only the identities as morphisms.
Consider a polyfold, consisting of a polyfold structure $(Z,\bm{Z})$ and an underlying topological space $\cZ$.
Consider a functor $\hat{\theta}: (Z,\bm{Z}) \to \Q^+$ which induces the function $\theta:=\abs{\hat{\theta}} :\cZ \to \Q^+$.
Observe that $\hat{\theta}$ defines a subgroupoid $(S,\bm{S})\subset (Z,\bm{Z})$ with object set
\[
	S:= \supp (\hat{\theta}) = \{x\in Z\mid \hat{\theta}(x)>0 \}
\]
and with underlying topological space
\[
	\cS := \supp (\theta) = \{[x]\in \cZ \mid \theta([x])>0\}.
\]
Moreover, $(S,\bm{S})$ is a full subcategory of $(Z,\bm{Z})$ whose object set is saturated, i.e., $S= \pi^{-1} (\pi(S))$ where $\pi : Z \to \abs{Z}, x\mapsto [x]$.

\begin{definition}[(\cite{HWZbook}*{Def.~9.1.2})]\label{def:weighed-branched-suborbifold}
	A \textbf{weighted branched suborbifold structure} consists of a subgroupoid $(S,\bm{S}) \subset (Z,\bm{Z})$ defined by a functor $\hat{\theta} : (Z,\bm{Z}) \to \Q^+$ as above which satisfies the following properties.
	\begin{enumerate}
		\item $\cS \subset \cZ_\infty$.
		\item Given an object $x\in S$, there exists an open neighborhood $U\subset Z$ of $x$ and a finite collection $M_i$, $i\in I$ of finite-dimensional submanifolds of $Z$ (in the sense of \cite{HWZ2}*{Def.~4.19}) such that
		      \[
			      S \cap U= \bigcup_{i \in I}M_i.
		      \]
		      We require that the submanifolds $M_i$ all have the same dimension.
		      The submanifolds $M_i$ are called \textbf{local branches} in $U$.\label{def:local-branches}
		\item There exist positive rational numbers $w_i$, $i\in I$, (called \textbf{weights}) such that if $y\in S \cap U$, then
		      \[\hat{\theta}(y)=\sum_{\{i \in I \mid   y\in M_i\}} w_i.\]
		\item The inclusion maps $\phi_i: M_i\to U$ are proper.
	\end{enumerate}
	We call ${(M_i)}_{i\in I}$ and ${(w_i)}_{i\in I}$ a \textbf{local branching structure}.
\end{definition}

By shrinking the open set $U$ we may assume that the local branches $M_i$ (equipped with the subspace topology induced from $U$) are homeomorphic to open subsets of $\R^n$.  Hence we may assume that a local branch is given by a subset $M_i\subset\R^n$ and an inclusion map $\phi_i : M_i\to U$ where $\phi_i$ is proper and a homeomorphism onto its image.

\begin{definition}\label{def:local-orientation}
	Let $(S,\bm{S})$ be a weighted branched suborbifold structure. Consider an object $x\in S$ and a local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$ at $x$.
	Suppose moreover that each local branch has an {orientation}, denoted as $(M_i,o_i)$

	We define a \textbf{local orientation} at $x$ %
	as the following finite formal sum of weighted oriented tangent planes:
	\[
		\sum_{\{i\in I \mid x\in M_i\}} w_i \cdot T_x (M_i,o_i).
	\]
	We require that this sum is independent of the choice of local branching structure.

	An \textbf{orientation} on $(S,\bm{S})$ is defined as a morphism invariant choice of local orientation at every object $x \in S$.
	Explicitly, given a morphism $\phi : x \to y$ there exists a well-defined tangent map $T\phi : T_xZ \to T_yZ$.
	The image of a finite formal sum of weighted oriented tangent planes under this map is again a finite formal sum of weighted oriented tangent planes, and hence we require invariance of the local orientations in the following sense:
	\[
		\sum_{\{j\in I' \mid y\in M'_j\}} w'_j \cdot T_y (M'_j,o'_j) = \sum_{\{i\in I \mid x\in M_i\}} w_i \cdot T\phi_* (T_x (M_i,o_i)).
	\]
\end{definition}

A \textbf{weighted branched suborbifold structure with boundary} consists of a subgroupoid $(S,\bm{S})\subset (Z,\bm{Z})$ defined identically to Definition~\ref{def:weighed-branched-suborbifold} except we allow the possibility that the local branches are manifolds with boundary.
A \textbf{local orientation} at an object $x\in S$ is again defined as in Definition~\ref{def:local-orientation} as a finite formal sum determined by orientations of the local branches, and likewise an \textbf{orientation} is a morphism invariant choice of local orientations.

\subsection{Polyfold invariants as branched integrals}\label{subsec:branched-integrals}

We recall the branched integration theory on compact oriented weighted branched suborbifolds, as originally developed in \cite{HWZint}.

\begin{definition}[(\cite{HWZbook}*{Def.~4.4.1})]
	Let $\cZ$ be a polyfold with an associated polyfold structure $(Z,\bm{Z})$.
	The vector space $\Omega^k (Z)$ consisting of \textbf{$\ssc$-differential $k$-forms}
	\[
		\ww:\bigoplus^k_{n=1} TZ\rightarrow \R.
	\]
	is the set of $\ssc$-smooth maps defined on the Whitney sum of the tangent of the object space, which are linear in each argument and skew-symmetric.
	Moreover, we require that the maps $\ww$ are morphism invariant in the following sense: for every morphism $\phi: x\to y$ in $\bm{Z}_1$ with tangent map $T\phi:T_xZ\rightarrow T_yZ$ we require that
	\[
		(T\phi)^*\ww_y=\ww_x.
	\]
\end{definition}

Recall the definition of $\cZ^i$ as the shifted polyfold with shifted polyfold structure $(Z^i,\bm{Z}^i)$ (see \cite{HWZbook}*{p.~37}).
Via the inclusion maps $\cZ^i \hookrightarrow \cZ$ we may pullback a $\ssc$-differential $k$-form $\ww$ in $\Omega^k(Z)$ to $\Omega^k(Z^i)$, obtaining a directed system
\[
	\Omega^k(Z) \to \cdots \to \Omega^k(Z^i) \to \Omega^k(Z^{i+1}) \to \cdots,
\]
we denote by $\Omega^k_\infty (Z)$ the direct limit of this system.
As defined in \cite{HWZbook}*{pp.~196--198} there exists an \textbf{exterior derivative}
\[
	d:\Omega^*(Z^{i+1}) \to \Omega^{* +1}(Z^i)
\]
such that the composition $d\circ d = 0$.
The exterior derivative commutes with the inclusion maps $Z^i \hookrightarrow Z^{i+1}$ and hence induces a map
\[
	d:\Omega^*_\infty(Z) \to \Omega^{* +1}_\infty(Z)
\]
which also satisfies $d\circ d =0$.

\begin{theorem}[(\cite{HWZbook}*{Thm.~9.5.4})]\label{def:branched-integral}
	Let $\cZ$ be a polyfold with polyfold structure $(Z,\bm{Z})$.
	Given a $\ssc$-smooth differential form $\ww\in \Omega^n_\infty (Z)$ and an $n$-dimensional compact oriented weighted branched suborbifold $\cS\subset \cZ$.

	Then there exists a well-defined \textbf{branched integral}, denoted as
	$\int_{\cS} \ww$,
	which is partially characterized by the following property.
	Consider a point $[x]\in \cS$ and a representative $x\in S$ with isotropy group $\bm{G}(x)$. Let $(M_i)_{i\in I}$, $(w_i)_{i\in I}$, $(o_i)_{i\in I}$ be an oriented local branching structure at $x$ contained in a $\bm{G}(x)$-invariant open neighborhood $U\subset Z$ of $x$.
	Consider a $\ssc$-smooth differential form $\ww\in \Omega^n_\infty (Z)$ and suppose that $\abs{\supp \ww} \subset \abs{U}$.
	Then
	\[
		\int_{\cS} \ww = \frac{1}{\sharp \bm{G}^\text{eff}(x)} \sum_{i\in I} w_i \int_{(M_i,o_i)} \ww,
	\]
	where $\sharp \bm{G}^\text{eff}(x)$ is the order of the effective isotropy group and $\int_{(M_i,o_i)} \ww$ is the usual integration of the differential $n$-form $\ww$ on the oriented $n$-dimensional manifold $M_i$.
\end{theorem}

\begin{remark}[(Computation of the branched integral)]
	The proof of \cite{HWZbook}*{Thm.~9.5.17} shows how to compute the branched integral, relying on the assumption that the polyfold $\cZ$ admits $\ssc$-smooth partitions of unity.

	Cover the underlying compact topological space $\cS$ with finitely many open sets $\abs{U_{x_j}}\subset \cZ$, $j\in \{1,\ldots,k\}$, where $U_{x_j}\subset Z$ are $\bm{G}(x_j)$-invariant local uniformizers.  Moreover, suppose that $S\cap U_{x_j} = \cup_{i\in I_j} M_i$ where $(M_i,o_i)$ are oriented local branches with associated weights $w_i$.
	Denote by $U_{x_j}^*$ the saturations of the sets $U_{x_j}$ in $Z$, i.e., $U_{x_j}^* = \pi^{-1}(\pi(U_{x_j}))$.
	We may find a saturated open set $U^*_0$ such that
	\[Z= U^*_0 \cup U^*_{x_1} \cup \cdots \cup U^*_{x_k}, \qquad
		\cS \subset \bigcup_{j=1}^k	\abs{U^*_{x_j}\setminus \overline{U^*_0}}.\]
	The polyfold $\cZ$ admits $\ssc$-smooth partitions of unity, hence there exist morphism invariant $\ssc$-smooth functions $\beta_0,\beta_1,\ldots,\beta_k :Z \to [0,1]$ which satisfy $\supp \beta_0 \subset U^*_0$, $\supp \beta_j\subset U^*_{x_j}$.  It follows that $\sum_{j=1}^k \beta_j =1$ on $S$ and $\abs{\supp \beta_j} \subset \abs{U^*_{x_j}}$.%

	We may now write
	\[
		\int_{\cS} \ww
		= \sum_{j=0}^k \int_{\cS} \beta_j \cdot \ww
		= \sum_{j=1}^k \frac{1}{\sharp \bm{G}^\text{eff}(x_j)} \sum_{i\in I_j} w_i \int_{(M_i,o_i)} \beta_j \cdot \ww
	\]
	(we drop the term $j=0$ in the second equality since $\abs{\supp \beta_0} \cap \cS = \emptyset$).
\end{remark}

\begin{theorem}[(Stokes' theorem, \cite{HWZbook}*{Thm.~9.5.17})]\label{thm:stokes}
	Let $\cZ$ be a polyfold with polyfold structure $(Z,\bm{Z})$ which admits $\ssc$-smooth partitions of unity.
	Let $\cS$ be an $n$-dimensional compact oriented weighted branched suborbifold, and let $\partial \cS$ be its boundary with induced weights and orientation.  Consider a $\ssc$-differential form $\omega\in \Omega^{n-1}_\infty (Z)$.
	Then
	\[
		\int_{\cS} d\omega   = \int_{\partial \cS} \omega.
	\]
\end{theorem}

As discussed in the introduction, given a $\ssc$-smooth map
$
	f:\cZ \to \cO
$
from a polyfold $\cZ$ to an orbifold $\cO$, the \textbf{polyfold invariant} is the homomorphism obtained by pulling back a de Rahm cohomology class from the orbifold and taking the branched integral over a perturbed zero set:
\[
	H^*_{\dR} (\cO) \to \R,	\qquad \ww \mapsto \int_{\cS(p)} f^*\ww.
\]
Using Stokes' theorem~\ref{thm:stokes}, we see that this homomorphism does not depend on the choice of abstract perturbation used to obtain the compact oriented weighted branched orbifold $\cS(p)$.

\subsection{Polyfold invariants as intersection numbers}\label{subsec:intersection-numbers}

Compact oriented weighted branched suborbifolds possess suitable notions smooth maps and of oriented tangent spaces; as such, we can generalize appropriate notions of transversal intersection and intersection number.

Let $\cS$ be a compact oriented weighted branched suborbifold.
Let $\cO$ be an oriented orbifold, and let $\cX$ be a closed embedded full suborbifold whose normal bundle has fiberwise trivial isotropy action.
Consider a smooth map $f:\cS\to\cO$ with an associated smooth functor $\hat{f}: (S,\bm{S}) \to (O,\bm{O})$.

\begin{definition}
	We say that $f$ is \textbf{transverse} to $\cX$, written symbolically as $f\pitchfork \cX$, if for every object $x\in \hat{f}^{-1}(X)$
	\[
		D\hat{f}_x (T_x M_i) \oplus T_{\hat{f}(x)} X = T_{\hat{f}(x)} O
	\]
	for every local branch $M_i$ of a given local branching structure $(M_i)_{i\in I}$ at $x$.
\end{definition}

\subsubsection{Achieving transversality}
Transversal intersection is a generic property, and may be obtained via either of the following two propositions.

\begin{proposition}[(Transversality through perturbation of the embedded full suborbifold)]\label{prop:transversality-perturbation-full-suborbifold}
	We may perturb $\cX$ so that $f \pitchfork \cX$. Stated formally, the inclusion map $i : \cX \hookrightarrow \cO$ is homotopic to a smooth inclusion map $i' : \cX \hookrightarrow \cO$ such that $f \pitchfork i'(\cX)$.
\end{proposition}
\begin{proof}
	Consider the normal bundle $N\cX$ and let $k := \text{rank } N\cX$.
	There exists a finite collection of local uniformizers $U_i \subset X$ centered at objects $x_i$ such that the open sets $\abs{U_i}$ cover the underlying topological space $\cS$.
	We may furthermore assume that these local uniformizers also give local trivializations of the normal bundle $P:N\cX\to \cX$, i.e.,
	\[
		\hat{P}^{-1}(U_i) \simeq U_i \times \R^k.
	\]

	We claim that there exists a smooth map between orbifolds
	\[
		F : \cX \times B_\ep^N \to N\cX
	\]
	which is a submersion and such that $F(\cdot, 0)$ is the zero section.
	Here we consider the open disc $B_\ep^N = \{x\in \R^N \mid \abs{x}<\ep\}$ as a manifold with the trivial orbifold structure (see Definition~\ref{def:manifold-as-trivial-orbifold}).
	This functor may be constructed by taking the zero section plus a finite sum of parametrized sections which span the fiber of the normal bundle at every point. This is not normally possible without using multisections---however we note that the assumption that $N\cX$ has fiberwise trivial isotropy action implies that $\bm{G}(x)$ acts trivially on the second factor of $U_i \times \R^k$.
	Therefore, we may locally define parametrized sections which are invariant under the $\bm{G}(x)$-action as follows:
	\[
		U_i \times B^k_\ep \to \R^k,\qquad (y,t_1,\ldots,t_k) \mapsto \beta(y)  \sum_{j=1}^{k} t_j e_j
	\]
	where $e_j\in \R^k$ are a basis of the unit vectors and where $\beta: U_i \to [0,1]$ is a $\bm{G}(x)$-invariant bump function. This locally defined expression may then be extended to a globally defined, morphism invariant, parametrized section of the bundle $NX \to X$ which induces a smooth parametrized section of $N\cX \to \cX$.

	For $\ep$ sufficiently small, there exists a sufficiently small open neighborhood $N_\ep\cX$ of the zero section $\cX \to N_\ep \cX$ such that there is a well-defined map between orbifolds
	$i : N_\ep \cX \to \cO$
	which is a homeomorphism onto its image when considered with respect to the underlying topological spaces, and which is a local diffeomorphism when considered with respect to the orbifold structures.  It therefore follows that for sufficiently small $\ep' \leq \ep$ we have a well-defined smooth submersion given by the composition
	\[
		I:= i\circ F : \cX \times B_{\ep'}^N \to N_{\ep'}\cX \to \cO.
	\]

	Consider the map $f \times I: \cS \times \cX \times B_{\ep'}^N \to \cO \times \cO$, and observe that this map is necessarily transverse to the diagonal of the object space $O$, i.e., $\Delta \subset O\times O$. Hence for any object $(x,y,s) \in \hat{f}^{-1}(\Delta)$
	\[
		D\hat{f}_x (T_x M_i) \oplus D\hat{I}_{(y,s)} (T_y X \times \R^N)  = T_{(\hat{f}(x),\hat{I}(y,s))} \Delta
	\]
	where $(M_i)_{i\in I}$ is a local branching structure at the object $x\in S$.
	Choose a finite cover of the underlying topological space $\cS$ by open sets of the form $\abs{\cup M_i}$.
	It follows that the finite collection of smooth maps
	\[
		\hat{f}|_{M_i} \times \hat{I}|_{U_j\times B_{\ep'}^N} : M_i \times U_j \times B_{\ep'}^N \to O\times O
	\]
	are all transverse to the diagonal $\Delta \subset O\times O$.
	Choose a common regular value $s\in B_{\ep'}^N$ and define the smooth inclusion map $i'(\cdot) := I(\cdot,s) : \cX \hookrightarrow \cO$; it follows that the collection of smooth maps
	\[
		\hat{f}|_{M_i} \times \hat{i'}|_{U_j} : M_i \times U_j \to O\times O
	\]
	are transverse to the diagonal.
	This implies that $f\pitchfork i' (\cX)$, as desired.
\end{proof}

In some situations, it is undesirable to perturb the full suborbifold.
For example, the full suborbifold might represent fixed constraints we wish to impose on the perturbed solution set.
In these situations, we wish to achieve transversality by choice of a suitable generic abstract perturbation.
The following proposition requires familiarity with some of the abstract machinery of polyfold theory, specifically of the construction of regular $\ssc^+$-multisections in \cite{HWZbook}*{Ch.~15}.

\begin{proposition}[(Transversality through construction of a regular perturbation)]\label{prop:transversality-regular-perturbation}
	Consider a \textit{polyfold Fredholm problem} consisting of a strong polyfold bundle $\cW$ over a polyfold $\cZ$ together with a $\ssc$-smooth proper Fredholm section $\delbar$:
	\[
		\begin{tikzcd}
			\cW \arrow[r,"P"'] & \cZ. \arrow[l, bend right, swap, "\delbar"]
		\end{tikzcd}
	\]
	Let $\cO$ be an oriented orbifold, and let $\cX$ be a closed embedded full suborbifold whose normal bundle has fiberwise trivial isotropy action.
	Consider a $\ssc$-smooth map $f:\cZ\to\cO$ with an associated $\ssc$-smooth functor $\hat{f}: (Z,\bm{Z}) \to (O,\bm{O})$.
	Suppose moreover that $f$ is a \textit{submersion} on $\cZ_\infty \subset \cZ$, i.e., for any object $x \in Z_\infty$ we have $D\hat{f}_x (T_x Z) = T_{\hat{f}(x)} O$.

	Then there exists a choice of regular perturbation such that the map $f$ restricted to the perturbed solution set defined by this perturbation is transverse to the embedded full suborbifold $\cX \subset \cO$.

	Restated formally, there exists a choice of regular $\ssc^+$-multisection
	$p: \cW \to \Q^+$
	whose perturbed solution set
	$\cS(p)= \{	[x]\in \cZ \mid p(\delbar([x]))>0	\}$
	has the structure of a compact oriented weighted branched suborbifold, and such that $f$ restricted to $\cS(p)$ is transverse to $\cX$,
	\[f|_{\cS(p)} \pitchfork \cX.\]

	Furthermore, the subset $\cS(p)\cap f^{-1}(\cX)$ also has the the structure of a compact oriented weighted branched suborbifold.
\end{proposition}
\begin{proof}
	Our proof follows the general position argument of \cite{HWZbook}*{Thm.~15.3.7}.
	The basic idea is that, in addition to filling in the cokernel of the linearization of $\hdelbar$ via parametrized $\ssc^+$-sections, we use the fact that $f$ is a submersion to fill in additional vectors in order to obtain a transversal perturbation of $\delbar \times f$.

	Denote the unperturbed zero set by $\cS(\delbar) := \{	[x]\in \cZ \mid \delbar([x])=0	\}$; it has an associated subgroupoid $(S(\hdelbar),\bm{S}(\hdelbar))$. Moreover, recall that $\cS(\delbar)\subset \cZ_\infty$ and that $\cS(\delbar)$ is compact.
	As additional data, fix a pair $(N,\cU)$ which controls the compactness of $\delbar$ (see \cite{HWZbook}*{Def.~15.3.1}).

	\begin{step1} At every point, we may construct a local parametrized $\ssc^+$-multisections such that the projection to the fiber is surjective.
	\end{step1}
	Consider a point $[x_0]\in \cS(\delbar)$ and let $x_0\in S(\hdelbar)$ be a representative with isotropy group $\bm{G}(x_0)$. Let $U\subset Z$ be a $\bm{G}(x_0)$-invariant open neighborhood of $x_0$, and moreover let $V\subset U$ be a $\bm{G}(x_0)$-invariant open neighborhood of $x_0$ such that $\overline{V} \subset U$.

	We may choose smooth vectors $v_1,\ldots, v_m \in W_{x_0}$ such that
	\[
		\text{span}\{v_1,\ldots,v_m\} \oplus D \hdelbar_{x_0} (T_{x_0} Z) = W_{x_0}.
	\]
	By assumption we may also choose vectors $a_1,\ldots, a_n \in T_{x_0} Z$ such that
	\[
		\text{span} \{D\hat{f}_{x_0} (a_1), \ldots,D\hat{f}_{x_0} (a_n)\}  = T_{\hat{f}(x_0)} O.
	\]
	Without loss of generality we may assume that these vectors are smooth;
	to see this, observe that smooth vectors are dense in $T_{x_0} Z$ and $D\hat{f}_{x_0}$ is continuous, hence a small perturbation $a'_1,\ldots, a'_n$ will yield a spanning set $\{D\hat{f}_{x_0} (a'_1), \ldots,D\hat{f}_{x_0} (a'_n)\}$ of the finite-dimensional vector space $T_{\hat{f}(x_0)} O$.

	Let $v_{m+i} : = D \hdelbar_{x_0}(a_i) \in W_{x_0}$.
	For each smooth vector $v_1,\ldots, v_{m+n}$ we may use \cite{HWZbook}*{Lem.~5.3.3} to define $\ssc^+$-sections $s_i : U \to W$ such that
	\begin{itemize}
		\item $s_i= 0$ on $U\setminus V$,
		\item $s_i(x_0) = v_i$.
	\end{itemize}
	Furthermore, to ensure that the resulting multisection is controlled by the pair $(N,\cU)$ we require that
	\begin{itemize}
		\item $N[s_i] \leq 1$,
		\item $\text{supp}(s_i)\subset \cU$.
	\end{itemize}
	Define a parametrized $\ssc^+$-section as follows:
	\[
		s_{x_0}:	U \times B_\ep^{m+n}	\to 		W,
		\qquad (x,t) \mapsto	\sum_{i=1}^{m+n} t_i s_i (x).
	\]
	Now observe that the function defined by
	\[
		U \times B_\ep^{m+n} 	\to W \times O,
		\qquad (x, t) \mapsto (\hdelbar (x) - s_{x_0} (x,t), \hat{f}(x))
	\]
	is $\ssc$-Fredholm and its linearization, projected to the fiber $W_{x_0} \times T_{\hat{f}(x_0)} O$, is surjective in a neighborhood of $x_0$ by construction. (This projection is well-defined in a neighborhood of $x_0$ in local $\ssc$-coordinates.)

	For every element $g$ of the isotropy group $\bm{G}(x_0)$ we define a $\ssc^+$-section $g * s_{x_0} : U \times B_\ep^{m+n} \to W$ by the following equation:
	\[
		\left(g * s_{x_0} \right) (x,t) := \mu (\Gamma (g, g^{-1}*x), s_{x_0} (g^{-1}* x,t))
	\]
	where $\Gamma$ is the natural representation of $\bm{G}(x_0)$ on $U$.
	Note that due to the morphism invariance of $\hdelbar$ and $\hat{f}$ the linearization of the function
	\begin{align*}
		U \times B_\ep^{m+n} & \to W \times O                                        \\
		(x, t)               & \mapsto (\hdelbar (x) - g*s_{x_0} (x,t), \hat{f}(x)),
	\end{align*}
	projected to the fiber $W_{x_0} \times T_{\hat{f}(x_0)} O$ is surjective in a neighborhood of $x_0$.

	The collection of parametrized $\ssc^+$-sections $\{g * s_{x_0}\}_{g\in \bm{G}(x_0)}$ is $\bm{G}(x_0)$-in\-vari\-ant under the obvious action; the collection $\{g * s_{x_0}\}_{g\in \bm{G}(x_0)}$ with associated weights ${1}/{\sharp \bm{G}(x_0)}$ together give the local section structure for a globally defined $\ssc^+$-multi\-section functor
	\[
		\hat{\Lambda}_0 : W \times B_\ep^{m+n} \to \Q^+.
	\]

	\begin{step2}
		We may construct a global parametrized $\ssc^+$-multisection whose projection to the fiber is surjective.
	\end{step2}
	Using the above construction, at any point $[x_0]\in \cS(\delbar)$ we have defined a parametrized $\ssc^+$-multisection functor $\hat{\Lambda}_0$ which satisfies the following.
	There exists an open neighborhood $[x_0] \in \cU \subset \cZ$ such that: for any point $[x]\in \cU$ and for any parametrized local section structure $\{s_i\}_{i\in I}$ of $\hat{\Lambda}_0$ defined on an open neighborhood $V$ of a representative $x$, the linearization of the function
	\begin{align*}
		V \times B_\ep^{n+m} & \to W \times O                                \\
		(x, t)               & \mapsto (\hdelbar (x) - s_i(x,t), \hat{f}(x))
	\end{align*}
	projected to the fiber $W_{x_0} \times T_{\hat{f}(x_0)} O$, is surjective.

	We may cover the compact topological space $\cS(\delbar)$ by a finite collection of such sets $\cU_j$; it follows that the finite sum of $\ssc^+$-multisections
	\[
		\Lambda:= \bigoplus_j \Lambda_j : \cW \times B_\ep^N \to \Q^+
	\]
	has the property that for any point $[x] \in \cZ$ with $\Lambda \circ \delbar ([x])>0$ and for any parametrized local section structure $\{s_i\}_{i\in I}$ of $\Lambda$ defined on an open neighborhood $V$ of a representative $x$, the linearization of the function
	\begin{align*}
		V \times B_\ep^N & \to W \times O                                \\
		(x, t)           & \mapsto (\hdelbar (x) - s_i(x,t), \hat{f}(x))
	\end{align*}
	projected to the fiber $W_{x} \times T_{\hat{f}(x)} O$, is surjective.
	In the terminology of \cite{HWZbook}*{Def.~15.2.1}, this we say that the $\ssc^+$-multisection $\Lambda$ is a ``transversal perturbation'' of the map $\delbar \times f : \cZ \to \cW \times \cO$.

	Furthermore for $\ep$ sufficiently small, for any fixed $t_0 \in B_\ep^N$ the $\ssc^+$-multisection $\Lambda (\cdot, t_0)$ is controlled by the pair $(N,\cU)$, i.e.,
	\begin{itemize}
		\item $N[\Lambda(\cdot,t_0)] \leq 1$,
		\item $\text{dom-supp}(\Lambda(\cdot,t_0)) \subset \cU$.
	\end{itemize}

	\begin{step3}
		We apply Sard's theorem to find a common regular value of the projection of the thickened solution set without and with constraints to the parametrizing factor.
	\end{step3}
	The polyfold implicit function theorem \cite{HWZbook}*{Thm.~3.6.10} implies that the thickened solution set without constraints,
	\[
		\cS (\Lambda; B_\ep^N): = \{	([x],t) \in \cZ \times B_\ep^N \mid \Lambda(\delbar([x]),t)>0\},
	\]
	has the structure of a weighted branched suborbifold (see \cite{HWZbook}*{Thm.~15.2.2} for further details).
	Furthermore, the thickened solution set with constraints,
	\[
		\cS (\Lambda; B_\ep^N)\cap f^{-1}(\cX) = \{	([x],t) \in \cZ \times B_\ep^N \mid \Lambda(\delbar([x]),t)>0, f([x])\in \cX	\},
	\]
	also has the structure of a weighted branched suborbifold; this follows from the same argument, with the polyfold implicit function theorem applied to a local coordinate representation of the transversal perturbation of the map $\delbar \times f : \cZ \to \cW \times \cO$.

	By Sard's theorem, we can find a common regular value $t_0 \in B_\ep^N$ of the projections $\cS (\Lambda; B_\ep^N) \to B_\ep^N$ and $\cS (\Lambda; B_\ep^N) \cap f^{-1}(\cX) \to B_\ep^N$;
	the perturbed solution set without constraints
	$\cS (\Lambda(\cdot, t_0)): = \{	[x] \in \cZ \mid \Lambda(\delbar([x]),t_0)>0\}$
	and the perturbed solution set with constraints
	$\cS (\Lambda(\cdot,t_0))\cap f^{-1}(\cX) = \{	[x] \in \cZ \mid \Lambda(\delbar([x]),t_0)>0, f([x])\in \cX	\}$,
	both have the structure of weighted branched suborbifolds.
	We may moreover assume that $\Lambda(\cdot,t_0)$ is controlled by the pair $(N,\cU)$, and hence by \cite{HWZ3}*{Lem.~4.16} the underlying topological space $\cS (\Lambda(\cdot, t_0))$ is compact.  This implies $\cS (\Lambda(\cdot,t_0))\cap f^{-1}(\cX)$ is also compact (as it is a closed subset of $\cS (\Lambda(\cdot, t_0))$).

	\begin{step4}
		For a common regular value $t_0$, the $\ssc^+$-multisection $\Lambda(\cdot,t_0)$ is the desired regular perturbation and satisfies the claims of the proposition.
	\end{step4}
	All that remains to complete the proof of the theorem is to demonstrate that $f|_{\cS(\Lambda (\cdot, t_0))} \pitchfork \cX$.
	By definition, this is satisfied if for every point $[x]\in \cS (\Lambda(\cdot,t_0))\cap f^{-1}(\cX) \subset \cS(\Lambda (\cdot, t_0))$ and for any local branch $M_i$ of a local branching structure $(M_i)_{i\in I}$ at a representative $x$ (with respect to the weighted branched suborbifold $\cS(\Lambda (\cdot, t_0))$) we have:
	\[
		D\hat{f}_x(T_x M_i) \oplus T_{\hat{f}(x)} X = T_{\hat{f}(x)} O.
	\]
	To see that this is true, consider a local section structure $(s_i)_{i\in I}$ of $\hat{\Lambda}(\cdot,t_0)$ at $x$ which defines this local branching structure; hence
	\[
		M_i = (\hdelbar - s_i)^{-1}(0)
	\]
	and moreover
	\begin{equation}\label{eq:tangent-TM}
		T_x M_i = \ker \pr_{W_x} D (\hdelbar - s_i)_x.
	\end{equation}
	The local branching structure at $x$ for $\cS (\Lambda(\cdot,t_0))\cap f^{-1}(\cX)$ is then given by $M_i':= (M_i \cap \hat{f}^{-1}(X))$; moreover
	\begin{equation}\label{eq:tangent-TM-prime}
		T_x M_i' = \ker \pr_{W_x} D (\hdelbar - s_i)_x \cap \ker \pr_{N_{\hat{f}(x)}X} D\hat{f}_x.
	\end{equation}
	We may decompose $T_x Z$ as
	\[
		T_xZ = E \oplus \underbrace{F \oplus T_x M_i'.}_{= T_x M_i}
	\]
	Since $\pr_{W_x} D (\hdelbar - s_i)_x : T_xZ \to W_x$ is surjective, it follows from \eqref{eq:tangent-TM} that its restriction to $E$ is an isomorphism.
	Since $\pr_{W_x} D (\hdelbar - s_i)_x \times \pr_{N_{\hat{f}(x)}X} D\hat{f}_x : T_x Z \to W_x \times N_{\hat{f}(x)}X$ is surjective, it follows from \eqref{eq:tangent-TM-prime} that its restriction to $E\oplus F$ is an isomorphism.
	From these two observations it necessarily follows that $\pr_{N_{\hat{f}(x)}X} D\hat{f}_x |_F : F \to N_{\hat{f}(x)}X$ is also an isomorphism.
	Since $N_{\hat{f}(x)}X$ and $T_{\hat{f}(x)} X$ together span $T_{\hat{f}(x)} O$ we see that $D\hat{f}_x(T_x M_i) \oplus T_{\hat{f}(x)} X = T_{\hat{f}(x)} O$ as desired.
\end{proof}

Consider again the setup described at the start of the section, \S\ref{subsec:intersection-numbers}.

\begin{lemma}\label{lem:neighborhood}
	Given an open neighborhood $\cU \subset \cS$ of $f^{-1}(\cX)$ there exists an open neighborhood $\cV \subset \cO$ of $\cX$ such that
	$
		f^{-1} (\cV) \subset \cU.
	$
\end{lemma}
\begin{proof}
	This follows from basic point-set topology.
	The set $\cS \setminus \cU$ is closed, hence compact; it follows that $f(\cS \setminus \cU)$ is also compact.
	Observe that $f(\cS \setminus \cU) \cap \cX = \emptyset$.

	The underlying topological space $\cO$ is by definition paracompact and Hausdorff; this implies that it is a normal topological space.  We may therefore separate the disjoint closed sets $f(\cS \setminus \cU)$ and $\cX$, which implies we can find an open neighborhood $\cV$ of $\cX$ such that $f(\cS \setminus \cU) \cap \cV = \emptyset$. The claim then follows from the fact that $(\cS \setminus \cU) \cap f^{-1} (\cV) = \emptyset$.
\end{proof}

\begin{lemma}\label{lem:transverse-intersection}
	Without loss of generality, we may assume that $f\pitchfork \cX$. Suppose that $\dim \cS + \dim \cX = \dim \cO$.
	\begin{enumerate}
		\item\label{lem:1} The set $f^{-1}(\cX) \subset \cS$ consists of isolated points. By compactness of $\cS$, it follows that $f^{-1}(\cX)$ is a finite set of points.
		\item\label{lem:2} Consider a point $[x] \in f^{-1}(\cX)$. Consider a local branching structure $(M_i)_{i\in I}$ (with respect to $\cS$) at a representative $x\in S$, contained in a $\bm{G}(x)$-invariant open neighborhood $U$.
		      Then a given local branch $M_i$ is fixed only by the identity $\id \in \bm{G}^\text{eff}(x)$, i.e.,
		      \[
			      g * M_i \neq M_i \qquad \text{for all } g\in \bm{G}^\text{eff}(x), g\neq \id.
		      \]
		      Moreover, this implies that $\sharp \bm{G}^\text{eff}(x)$ divides $\sharp I$.
	\end{enumerate}
\end{lemma}
\begin{proof}[Proof of (\ref{lem:1})]
	Consider a point $[x] \in f^{-1}(\cX) \subset \cS$ and consider a local branching structure $(M_i)_{i\in I}$ (with respect to $\cS$) at a representative $x$.
	For every given local branch $M_i$, the dimension assumption and the fact that
	\[
		D\hat{f}_x(T_x M_i) \oplus T_{\hat{f}(x)} X = T_{\hat{f}(x)} O
	\]
	together imply that $x \in M_i \cap \hat{f}^{-1}(X)$ is isolated, i.e., we can find open neighborhoods $x \in U_i \subset M_i$ such that $U_i \cap \hat{f}^{-1}(X) = \{x\}$.
	Since the topology on each branch $M_i$ is the same as the subspace topology induced from $Z$, we can find a $\bm{G}(x)$-invariant open set $U\subset Z$ such that $U\cap M_i \subset U_i$ for all $i\in I$, and which has the property that $U \cap (\cup M_i) \cap \hat{f}^{-1}(X) = \{x\}$.
	The set $U\cap (\cup M_i)$ is an open subset of the space $S$; since $\pi : S \to \cS, x \mapsto [x]$ is an open map it follows that $\abs{U\cap (\cup M_i) } \subset \cS$ is an open set.

	We claim that $\abs{U\cap (\cup M_i) } \cap f^{-1}(\cX) = \{[x]\}$.  To see this, suppose there were a point $[y] \in \abs{U\cap (\cup M_i) } \cap f^{-1}(\cX)$, $[y]\neq [x]$; we could then find objects $y_1 \in U\cap (\cup M_i)$, $y_1 \mapsto [y]$ and $y_2 \in \pi^{-1} (f^{-1}(\cX)) = \hat{f}^{-1}(X)$, $y_2 \mapsto [y]$. But since $\hat{f}^{-1}(X)$ is saturated it follows that $y_1 \in \hat{f}^{-1}(X)$, which contradicts the fact that $U \cap (\cup M_i) \cap \hat{f}^{-1}(X) = \{x\}$.

	We have shown that the point $[x] \in f^{-1}(\cX)$ is isolated; since $[x]$ was arbitrary, the proof is complete.
\end{proof}
\begin{proof}[Proof of (\ref{lem:2})]
	Let $y := \hat{f}(x)\in O$, and let $U(y)\subset O$ be a $\bm{G}(y)$-invariant open neighborhood. The functor $\hat{f}$ induces a group homomorphism between the isotropy groups, $\hat{f}: \bm{G}(x) \to \bm{G}(y)$ and an equivariant map
	\[
		\hat{f} : \cup_{i\in I} M_i \to U(y)
	\]
	with respect to these isotropy groups.
	The tangent planes $\cup_{i\in I} T_{x} M_i$ and $T_{y} O$ carry an induced action by the isotropy groups; the linearization
	\[
		D\hat{f}_{x} : \cup_{i\in I} T_{x} M_i \to T_{y} O
	\]
	is equivariant with respect to this action.  The projection to the normal bundle
	$
		\pr_{N_{y}X} : T_{y} O \to N_{y}X
	$
	is also equivariant.  Recall that by assumption on the suborbifold $\cX$, the isotropy group $\bm{G}(y)$ acts trivially on the fiber $N_{y}X$.

	The composition
	\[
		\pr_{N_{y}X} \circ D\hat{f}_{x} : \cup_{i\in I} T_{x} M_i \to N_{y}X
	\]
	is equivariant.  The fact that $\dim M_i = \rank NX$ together with the transversality assumption implies that the map
	\begin{equation}\label{eq:equivariant-map}
		\pr_{N_{y}X} \circ D\hat{f}_{x} |_{T_x M_i} : T_{x} M_i \to N_{y}X
	\end{equation}
	is an isomorphism. Consider the induced action on the tangent plan $T_x M_i$ by any $g\in \bm{G}^\text{eff} (x)$, $g\neq \id$ with $g\ast M_i = M_i$; the map \eqref{eq:equivariant-map} must be equivariant with respect to this action. However, since $\bm{G}(y)$ acts trivially on the fiber $N_{y}X$ this contradicts the fact that \eqref{eq:equivariant-map} is an isomorphism. Hence no such $g\in \bm{G}^\text{eff} (x)$, $g\neq \id$ exists, and the claim is proven.
\end{proof}

\begin{definition}\label{def:intersection-number}
	If $\dim \cS + \dim \cX = \dim \cO$ we define the \textbf{intersection number}
	$f|_{\cS} \cdot \cX$ by the equation
	\[
		f|_{\cS} \cdot \cX := \sum_{[x]\in f^{-1}(\cX)} \left(\frac{1}{\sharp \bm{G}^\text{eff}(x)} \sum_{\{ i\in I \mid x\in M_i \}} \sign (x;i) w_i \right)
	\]
	where $x$ is a representative of $[x]$, and $(M_i)_{i\in I}$ are local branches at $x$ with weights $(w_i)_{i\in I}$ and orientations $(o_i)_{i\in I}$. The sign $\sign(x;i)=\pm 1$ is positive if $D\hat{f}_x (T_x M_i) \oplus T_{\hat{f}(x)} X$ has the same orientation as $T_{\hat{f}(x)} O$ and negative if the orientations are opposite.

	If $\dim \cS + \dim \cX \neq \dim \cO$ we define the intersection number to be zero,
	\[f|_{\cS} \cdot \cX := 0.\]
\end{definition}

By the Steenrod problem for orbifolds \ref{thm:intro-steenrod-problem}, there exists a basis $\{[\cX_i]\}$ of $H_*(\cO;\Q)$ consisting of the fundamental classes of embedded full suborbifolds $\cX_i \subset \cO$ whose normal bundles have fiberwise trivial isotropy action.

\begin{definition}\label{def:polyfold-invariant-intersection-number}
	Fix such a basis $\{[\cX_i]\}$ of $H_*(\cO;\Q)$.
	We define the \textbf{polyfold invariant} as the homomorphism
	\[
		H_*(\cO; \Q) \to \Q,\qquad	\sum_i k_i [\cX_i] \mapsto \sum_i k_i \left( f|_{\cS} \cdot \cX_i \right)
	\]
	uniquely determined by evaluating the intersection number on the representing suborbifolds $\cX_i$ and linear extension.
\end{definition}

\subsection{Equivalence of the polyfold invariants}\label{subsec:equality-polyfold-invariants}

We now show that the polyfold invariants defined by the branched integral and by the intersection number are equivalent.
We also discuss the invariance of the intersection number.

\begin{proof}[Proof of Theorem~\ref{thm:equality-polyfold-invariants}]

	We need to show that the branched integral the intersection number are related by the equation
	\[\int_{\cS} f^* \PD ([\cX]) = f|_{\cS} \cdot \cX.\]

	When $\dim \cS + \dim \cX \neq \dim \cO$ the claim is clear, as both the intersection number and the branched integral are equal to zero.

	Suppose that $\dim \cS + \dim \cX = \dim \cO$.
	Let $n:= \dim \cS$.  By our assumptions, Lemma~\ref{lem:transverse-intersection} (\ref{lem:1}) implies that $f^{-1}(\cX)$ consists of a finite set of points, $\{[x_1],\ldots,[x_k]\}$.
	For each point choose a representative $x_j \in S$ and let $U_j\subset Z$ be a $\bm{G}(x_j)$-invariant open neighborhood of $x_j$; it follows that $\cup_{j=1}^k \abs{U_j \cap S}$ is an open neighborhood of the points $\{[x_1],\ldots,[x_k]\}$.

	By Proposition~\ref{prop:thom-class-poincare-dual} we may represent the de Rahm class $\PD([\cX]) \in H_{\dR}^n(\cO)$ as the Thom class of $\cX$.
	We may assume that $\supp \PD([\cX]) \subset \cO$ is contained in an arbitrarily small neighborhood of $\cX$; hence by Lemma~\ref{lem:neighborhood} we may assume $\supp f^* \PD([\cX]) = \abs{\supp \hat{f}^* \PD ([\cX])} \subset \cup_{j=1}^k \abs{U_j \cap S}$.

	By the definition of the branched integral, we may now write:
	\begin{align*}
		\int_{\cS} f^* \PD ([\cX])
		 & = \sum_{j=1}^k \int_{\abs{U_j \cap S}} f^* \PD ([\cX])                                                                          \\
		 & = \sum_{j=1}^k \left(\frac{1}{\sharp \bm{G}^\text{eff}(x_j)} \sum_{i\in I_j} w_i \int_{(M_i,o_i)} \hat{f}^* \PD ([\cX]) \right) \\
		 & = \sum_{j=1}^k \left(\frac{1}{\sharp \bm{G}^\text{eff}(x_j)} \sum_{\{i\in I_j\mid x_j \in M_i \}} \sign (x_j; i) w_i \right)    \\
		 & = f|_{\cS} \cdot \cX.
	\end{align*}
	The third equality follows by integrating the pullback of the Thom class on each branch, using the transversality assumption and the fact that $\PD([\cX])$ restricts to a generator of $H^n_{\dR,c}(N_{\hat{f}(x_j)} X)$ determined by the orientation of $NX$.
\end{proof}

\begin{remark}[(Invariance of the intersection number)]\label{rmk:invariance-intersection-number}
	We discuss the invariance of Definition~\ref{def:polyfold-invariant-intersection-number} from the choice of perturbation $p$ used to define a weighted branched suborbifold $\cS(p)$.

	To this end, consider a compact oriented weighted branched suborbifold $\cB$ with boundary $\partial \cB$.
	As usual, let $\cO$ be an oriented orbifold, let $\cX\subset \cO$ be a closed embedded full suborbifold whose normal bundle has fiberwise trivial isotropy action, and consider a smooth map $f: \cB \to \cO$.
	The arguments of Proposition~\ref{prop:transversality-perturbation-full-suborbifold} or Proposition~\ref{prop:transversality-regular-perturbation} show that without loss of generality we may assume
	\[
		f|_{\cB} \pitchfork \cX, \qquad f|_{\partial \cB} \pitchfork \cX.
	\]

	Suppose that $\dim \cB + \dim \cX = \dim \cO +1$. It can be shown that $f^{-1}(\cX)\subset \cB$ has the structure of a one-dimensional compact oriented weighted branched suborbifold with boundary $f^{-1}(\cX) \cap \partial \cB$.
	With this viewpoint, one necessarily expects the intersection number of $f$ restricted to the boundary to be zero,
	\[
		f|_{\partial \cB} \cdot \cX =0.
	\]
	Intuitively, this is because one should expect that a one-dimensional compact oriented weighted branched suborbifold can be decomposed into a (not necessarily disjoint) union of oriented weighted intervals $[0,1]$ and circles $S^1$.
	From there, one would argue that the intersection number is equal to the signed weighted count of the boundary points of the intervals, and argue that this count is zero.

	We do not pursue this approach, however.
	Instead, using Theorem~\ref{thm:equality-polyfold-invariants} we may observe that the homomorphism defined via the branched integral,
	\[
		H_*(\cO; \Q) \to \R,
		\qquad \sum_i \alpha_i [\cX_i] \mapsto \sum_i \alpha_i \int_{\cS(p)} \hat{f}^* \PD([\cX_i]),
	\]
	and the homomorphism defined via the intersection number,
	\[
		H_*(\cO; \Q) \to \R,
		\qquad \sum_i \alpha_i [\cX_i] \mapsto \sum_i \alpha_i \left(	f|_{\cS(p)} \cdot \cX_i	\right),
	\]
	are identical.
	Since the first homomorphism does not depend on the choice of abstract perturbation nor on a choice of basis for $H_*(\cO;\Q)$, the same is true for the second homomorphism.
\end{remark}

We make a final note that the second homomorphism defined via the intersection number is rationally valued. Hence the branched integral is also rationally valued when evaluated on rational cohomology classes.
This verifies a claim made in \cite{HWZGW}*{p.~12}.
\begin{corollary}
	The polyfold Gromov--Witten invariant defined in \cite{HWZGW}*{Thm.~1.12} via the branched integral is rationally valued when evaluated on rational cohomology classes, i.e.,
	\[
		\GW^M_{A,g,k} : H_* (M;\Q)^{\otimes k} \otimes H_* (\dmlog_{g,k}; \Q) \to \Q.
	\]
\end{corollary}

\section*{Acknowledgment}
This work is indebted to Katrin Wehrheim for their aid and insight in understanding the intricate machineries and untold depths of polyfold theory.
It is possible to construct distinct polyfolds which model a given moduli space problem in subtly different ways.
These distinct polyfolds yield invariants which, a priori, we cannot assume are equivalent.
We provide a general framework for proving that polyfold invariants are \emph{natural}, in the sense that under a mild hypothesis the polyfold invariants for such different models will be equal.
As an application, we show that the polyfold Gromov--Witten invariants are independent of all choices made in the construction of the Gromov--Witten polyfolds.

In addition, we consider the following problem.
Given a map between polyfolds, we cannot naively consider the restriction of this map to the respective perturbed solution spaces.
Under a mild topological hypothesis on the map, we show how to pullback abstract perturbations which then allows us to obtain a well-defined map between the perturbed solution spaces.
As an application, we show that there exists a well-defined permutation map between the perturbed Gromov--Witten moduli spaces.

\section{Introduction}

\subsection{Polyfold regularization}

Consider a compactified moduli space arising from the study of $J$-holomorphic curves in symplectic geometry.
A foundational problem is finding some way to give this moduli space enough structure to define invariants.
Polyfold theory, as developed by Hofer, Wysocki, and Zehnder, has been successful in providing a general abstract framework in which it is possible to ``regularize'' such a moduli space, yielding a perturbed moduli space which has sufficient additional structure.

\begin{theorem}[Polyfold regularization theorem, {\cite{HWZbook}*{Thm.~15.4, Cor.~15.1}}]
	In some established cases, we can construct a polyfold $\cZ$ such that the compactified moduli space $\CM$ is equal to the zero set of a $\ssc$-smooth Fredholm section $\delbar$ of a strong polyfold bundle $\cW \to \cZ$, i.e., $\CM = \delbarinv (0) \subset \cZ$.

	We may then ``regularize'' the moduli space $\CM$ by means of an ``abstract perturbation''.
	The perturbed moduli space $\CM(p):=(\delbar+p)^{-1}(0)$ then has the structure of a compact oriented ``weighted branched orbifold''.
\end{theorem}

In the boundaryless case, such an approach has been successful in regularizing the Gromov--Witten moduli spaces (see \cite{HWZGW}).
A specialized approach has yielded a proof of the Arnold conjecture (see \cite{filippenko2018arnold}).
This approach is also being used in the pursuit of a well-defined symplectic field theory (see \cite{fish2018sft}).

For a suitably constructed abstract perturbation, the perturbed moduli space $\CM(p)$ has the structure of a compact oriented weighted branched orbifold, and therefore possesses sufficient structure to define the branched integration of differential forms.

\begin{theorem}[Polyfold invariants, {\cite[Cor.~15.2]{HWZbook}}]
	Let $\cO$ be an orbifold and consider a $\ssc$-smooth map $f: \cZ \to \cO$.
	We may define the \textbf{polyfold invariant} as the homomorphism obtained by pulling back a de Rahm cohomology class from the orbifold and taking the branched integral over a perturbed moduli space:
	\[
		H^*_{\dR} (\cO) \to \R, \qquad 	\ww 			\mapsto \int_{\CM(p)} f^*\ww.
	\]
	This homomorphism does not depend on the choice of abstract perturbation.
\end{theorem}

In particular, this is precisely the form for the polyfold Gromov--Witten invariants defined in \cite[Thm.~1.12]{HWZbook}.

\subsection{Naturality of polyfold invariants}

Given a compactified moduli space $\CM$, it is possible to model $\CM$ in subtly different ways.
That is, it is possible to construct distinct polyfolds $\cZ$ and $\cZ'$ which contain $\CM$ as a compact subset, $\CM \subset \cZ$ and $\CM \subset \cZ'$.
After regularization of the moduli space $\CM$ we obtain perturbed moduli spaces $\CM(p) \subset \cZ$ and $\CM(p') \subset \cZ'$ which have the structure of compact oriented weighted branched suborbifolds.
We obtain distinct polyfold invariants by taking the branched integral over these perturbed moduli spaces.
Thus, we find ourselves in the following situation: given a moduli space $\CM$ we can define polyfold invariants associated to the distinct polyfolds $\cZ$ and $\cZ'$ and which, a priori, we cannot assume are equivalent.
\emph{Therefore the polyfold invariants, which aspire to be agnostic of all possible choices, may depend on the subtle choices made in modeling a given moduli space.}

In this paper, we provide a general framework for studying and resolving this problem.
The first step is to construct a third polyfold $\cY$ which models $\CM$ and which refines the different structures or choices made, in the sense that there are inclusion maps
\[
	\cX' \hookleftarrow \cY \hookrightarrow \cX.
\]
The problem then reduces to showing that given an inclusion of polyfolds $\cY \hookrightarrow \cX$, the polyfold invariants for $\cY$ and $\cX$ are equal.
We consider a commutative diagram of inclusion maps between polyfolds and between strong polyfold bundles of the form:
\[\begin{tikzcd}
		\cV \arrow[r, hook] \arrow[d, "\delbar_\cY \quad"'] & \cW \arrow[d, "\quad \delbar_\cZ"] &  \\
		\cY \arrow[r, hook] \arrow[u, bend left] & \cZ \arrow[u, bend right] &
	\end{tikzcd}\]
in addition to a commutative diagram with target space the orbifold $\cO$:
\[\begin{tikzcd}
		&  & \cO \\
		\cY \arrow[r, hook] \arrow[rru, "f_\cY"] & \cZ \arrow[ru, "f_\cZ"'] &
	\end{tikzcd}
\]
As outlined at the start of \S\ref{subsec:intermediary-subbundles-naturality}, we will assume that these inclusion maps satisfy a number of properties.
Although these hypothesis are somewhat lengthy at a glance, they will be natural from the point of view of our applications, and moreover reflect some commonalities of the practical construction of distinct polyfolds which model the same moduli space.
In these applications, we furthermore note that the bundle $\cV$ is not the same as the pullback bundle of $\cW$, hence we may not use the methods of pulling back abstract perturbations of Theorem~\ref{thm:pullback-regular-perturbation}.

The most substantial property we require is the existence of an ``intermediary subbundle'', a subset of the target strong polyfold bundle $\cR\subset \cW$ whose object space is fiberwise a (not necessarily complete) vector space and which satisfies some additional properties (see Definition~\ref{def:intermediate-subbundle}).

\begin{theorem}[Naturality of polyfold invariants]\label{thm:naturality-polyfold-invariants}
	Consider a compactified moduli space $\CM$ which is modeled by two polyfolds $\cY$ and $\cZ$, i.e., $\CM \subset \cY$ and $\CM \subset \cZ$.
	Suppose there is an inclusion map $\cY \hookrightarrow \cZ$.
	Moreover, assume we satisfy the hypothesis of the general framework described in \S\ref{subsec:intermediary-subbundles-naturality}.

	Suppose there exists an intermediary subbundle $\cR \subset \cW$. Then the polyfold invariants for $\cY$ and $\cZ$ defined via the branched integral are equal.
	This means that, given a de Rahm cohomology class $\ww\in H^*_{\dR} (\cO)$ the branched integrals over the perturbed moduli spaces are equal,
	\[
		\int_{\CM(p)} f_\cY^* \ww = \int_{\CM(p')} f_\cZ^* \ww,
	\]
	for any regular abstract perturbations.
\end{theorem}

The proof ends up being somewhat involved as we encounter some substantial technical difficulties, which we now sketch briefly.
Roughly, the existence of an intermediary subbundle allows the construction of abstract perturbations $p'$ of the strong polyfold bundle $\cW \to \cZ$ whose restrictions induce a well-defined abstract perturbation $p$ of the strong polyfold bundle $\cV \to \cY$.
This allows us to consider a well-defined restriction between perturbed moduli spaces,
\[\CM(p) \hookrightarrow \CM(p').\]
On the level of topological spaces, this restriction is a continuous bijection.
While we can achieve transversality for both perturbations, the abstract polyfold machinery is only able to ``control the compactness'' of the target perturbed moduli space, hence via usual methods we can only assume that $\CM(p')$ is a compact topological space.

Using only knowledge of the underlying topologies of both of these spaces, it is impossible to say anything more.
The key to resolving this problem is understanding the additional structure that these spaces possess---the branched orbifold structure---and using this structure to prove an \textit{invariance of domain} result for weighted branched orbifolds (see Lemma~\ref{lem:invariance-of-domain-branched-orbifolds}).
This result will allow us to assert that the above map is a homeomorphism---and therefore, $\CM(p)$ is also compact.

The second major difficulty comes from the fact that the restricted perturbation $p$ on the source space is not a ``regular'' perturbation (see Definition~\ref{def:regular-perturbation}).
This is problematic due to the fact that the present theory only guarantees the existence of a compact cobordism between abstract perturbations which are both assumed to be ``regular'' (see Theorem~\ref{thm:cobordism-between-regular-perturbations}).
In order to resolve this problem, we must generalize the abstract perturbation theory to allow for perturbation of $\ssc$-smooth proper ``Fredholm multisections'' (see \S\ref{subsec:fredholm-multisections}).
This generalization enables us to construct a compact cobordism from the restricted perturbation $p$ to a regular perturbation (see Proposition~\ref{prop:cobordism-multisection-regular}).



\subsection{Application: Naturality of the polyfold Gromov--Witten invariants}

The construction of a Gromov--Witten polyfold structure requires choices, such as the choice of a cut-off function in the gluing constructions, choices of good uniformizing families of stable maps, choice of a locally finite refinement of a cover of M-polyfold charts, and the choice of the exponential gluing profile.

In addition to these choices, one must also make a choice of a strictly increasing sequence $(\delta_i)_{i\geq 0} \subset (0,2\pi)$, i.e.,
\[
	0<\delta_0 < \delta_1 < \cdots < 2\pi.
\]
This sequence is used to define $\ssc$-Banach spaces which are then used to define the M-polyfold models of the Gromov--Witten polyfold $\cZ_{A,g,k}^{3,\delta_0}$ (see \cite[\S2.4]{HWZGW}).


\begin{theorem}[{\cite[Thm.~3.37]{HWZGW}}]
	Having fixed the exponential gluing profile and a strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$, the underlying topological space $\cZ_{A,g,k}^{3,\delta_0}$ of stable curves possesses a natural equivalence class of polyfold structures.
\end{theorem}

This theorem implies that the polyfold Gromov--Witten invariants are independent of all choices, with the exception of the choice of a strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$.

We may extend this result by applying Theorem~\ref{thm:naturality-polyfold-invariants} to show that the polyfold Gromov--Witten invariants are also independent of the choice of strictly increasing sequence, and hence are natural in the sense that they do not depend on any choice made in the construction of the Gromov--Witten polyfolds.

\begin{corollary}[Naturality of the polyfold Gromov--Witten invariants]\label{cor:naturality-polyfold-gw-invariants}
	The polyfold Gromov--Witten invariants do not depend on the choice of an increasing sequence $(\delta_i)_{i\geq 0} \allowbreak \subset (0,2\pi)$.
\end{corollary}

We now consider the choice of puncture at the marked points.
The underlying set of the Gromov--Witten polyfolds consist of stables curves.
As constructed in \cite{HWZbook}, these stable curves are required to satisfy exponential decay estimates on punctured neighborhoods of the nodal pairs.
In contrast, for these Gromov--Witten polyfolds no such decay is required at the marked points.

However, in some situations we would like to treat the marked points in the same way as the nodal points.
For example, this is true in the context of the splitting and genus reduction axioms, where we will wish to identify a pair of marked points with an incidence relation with a nodal pair.
Allowing a puncture with exponential decay at a specified marked point is a global condition on a Gromov--Witten polyfold, and hence different choices of puncture at the marked points yield distinct Gromov--Witten polyfolds.

We again use Theorem~\ref{thm:naturality-polyfold-invariants} to show that the polyfold Gromov--Witten invariants are independent of such choice of puncture at the marked points.

\begin{corollary}\label{cor:punctures-equal}
	The polyfold Gromov--Witten invariants do not depend on the choice of puncture at the marked points.
\end{corollary}

\subsection{Pulling back abstract perturbations in polyfold theory}

Consider distinct moduli spaces $\CM$ and $\CM'$ which are modeled by polyfolds $\cY$ and $\cZ$, respectively.
Consider a $\ssc$-smooth map between polyfolds $f: \cY \to \cZ$ which restricts to a map between moduli spaces $f|_{\CM} : \CM \to \CM'$.
In many situations we would like to study the geometry of this map in order to establish algebraic relationships between the respective polyfold invariants.

However, without work, we cannot assume that this map will \emph{persist} after abstract perturbation.
Abstract perturbations are constructed using bump functions and choices of vectors in a strong polyfold bundle, which in general we cannot assume will be preserved by the $\ssc$-smooth map $f$.

To solve this problem, consider a pullback diagram of strong polyfold bundles as follows:
\[\begin{tikzcd}
		f^* \cW \arrow[d, "f^*\delbar \quad"'] \arrow[r, "\text{proj}_2"'] & \cW \arrow[d, "\quad \delbar"] &  \\
		\cY \arrow[r, "f"'] \arrow[u, bend left] & \cZ. \arrow[u, bend right] &
	\end{tikzcd}\]
The natural approach for obtaining a well-defined map between the perturbed moduli spaces is to take the pullback an abstract perturbation.
The main technical point is ensuring that we can control the compactness of the pullback perturbation.
This is achieved by a mild topological hypothesis on the map $f$, called the ``topological pullback condition'' (see Definition~\ref{topological-pullback-condition}).

\begin{theorem}\label{thm:pullback-regular-perturbation}
	Consider a $\ssc$-smooth map between polyfolds, $f: \cY \to \cZ$, and consider a pullback diagram of strong polyfold bundles as above.
	If $f$ satisfies the topological pullback condition then there exists a regular perturbation $p$ which pulls back to a regular perturbation $f^*p$.

	It follows that we can consider a well-defined restriction between perturbed moduli spaces,
	\[
		f|_{\CM(f^*p)} : \CM(f^*p) \to \CM (p).
	\]
\end{theorem}

This theorem follows from the more technically stated Theorem~\ref{thm:compatible-pullbacks}.

\subsection{Application: Permutation maps between perturbed Gromov--Witten moduli spaces}

Let $(M,\ww)$ be a closed symplectic manifold, and fix a homology class $A \in H_2 (M;\Z)$ and integers $g,\ k\geq 0$ such that $2g+k \geq 3$.
Fix a permutation $\sigma: \{1,\ldots, k\} \to \{ 1,\ldots, k \}$.
Consider the natural $\ssc$-diffeomorpism between Gromov--Witten polyfold defined by permuting the marked points,
\[
	\sigma: \cZ_{A,g,k}\to \cZ_{A,g,k}.
\]
For a fixed compatible almost complex structure $J$, this map has a well-defined restriction to the unperturbed Gromov--Witten moduli spaces
\[
	\sigma|_{\CM_{A,g,k}(J)} : \CM_{A,g,k}(J) \to \CM_{A,g,k}(J).
\]

As we have mentioned, abstract perturbations are constructed using bump functions and choic\-es of vectors in a strong polyfold bundle, which in general will not exhibit symmetry with regards to the labelings of the marked points.
As a result, given a stable curve $x\in \cZ_{A,g,k}$ which satisfies a perturbed equation $(\delbarj+p)(x)=0$ we cannot expect that $(\delbarj+p)(\sigma(x))=0$, as the perturbations are not symmetric with regards to the permutation $\sigma$.
Therefore, naively there does not exist a permutation map between perturbed Gromov--Witten moduli spaces.

However, since $\sigma: \cZ_{A,g,k}\to \cZ_{A,g,k}$ is a homeomorphism on the level of the underlying topological spaces, it is immediate that it satisfies the topological pullback condition, hence we immediately obtain the following corollary.

\begin{corollary}\label{cor:pullback-via-permutation}
	There exists a regular perturbation which pulls back to a regular perturbation via the permutation map $\sigma:\cZ_{A,g,k}\to \cZ_{A,g,k}$.
	Therefore, we can consider a well-defined permutation map between the perturbed Gromov--Witten moduli spaces,
	\[
		\sigma|_{\CM_{A,g,k}(\sigma^*p)} : \CM_{A,g,k}(\sigma^*p) \to \CM_{A,g,k} (p).
	\]
\end{corollary}

\subsection{Organization of the paper}

In \S\ref{sec:naturality-polyfold-invariants} we provide a general framework for proving that the polyfold invariants are natural, and do not depend on the construction of a polyfold model for a given moduli space.
In \S\ref{subsec:invariance-of-domain} we prove an invariance of domain result for branched suborbifolds, Lemma~\ref{lem:invariance-of-domain-branched-orbifolds}.
In \S\ref{subsec:fredholm-multisections} we generalize the polyfold abstract perturbation theory to the case of a $\ssc$-smooth proper Fredholm multisection.
In \S\ref{subsec:intermediary-subbundles-naturality} we provide the general framework, introduce the definition of an intermediary subbundle, and prove that the equality of polyfolds invariants in Theorem~\ref{thm:naturality-polyfold-invariants}.
In \S\ref{subsec:independence-sequence} we apply Theorem~\ref{thm:naturality-polyfold-invariants} to show that the polyfold Gromov--Witten invariants are independent of the choice of increasing sequence.
In \S\ref{subsec:independence-punctures} we apply Theorem~\ref{thm:naturality-polyfold-invariants} to show that the polyfold Gromov--Witten invariants are independent of the choice of puncture at the marked points.

In \S\ref{sec:pulling-back-abstract-perturbations} we discuss how to pull back regular perturbations.
In \S\ref{subsec:pullbacks-strong-polyfold-bundles} we define the pullback of a strong polyfold bundle and of a $\ssc^+$-multisection.
In \S\ref{subsec:topological-pullback-condition-controlling-compactness} we introduce the topological pullback condition and show how it allows us to pullback a pair which controls compactness.
In \S\ref{subsec:construction-regular-perturbation-which-pullback} we construct regular perturbations which pullback to regular perturbations, proving Theorem~\ref{thm:compatible-pullbacks}.
In \S\ref{subsec:permutation-map} we apply Theorem~\ref{thm:compatible-pullbacks} to obtain a well-defined permutation map between the perturbed Gromov--Witten moduli spaces.

In Appendix~\ref{sec:abstract-perturbations-polyfold-theory} we give a self-contained review of the basic abstract perturbation machinery of polyfold theory.
In \ref{subsec:polyfolds-ep-groupoids} we review scale calculus, the definition of a polyfold as an ep-groupoid, and discuss the induced topology on subgroupoids and on branched suborbifolds.
In \ref{subsec:abstract-perturbations} we discuss strong polyfold bundles, $\ssc$-smooth Fredholm sections and $\ssc^+$-multisection perturbations. In addition, we also discuss transverse perturbations, how to control the compactness of a perturbation, and questions of orientation.
In \ref{subsec:branched-integral-polyfold-invariants} we consider $\ssc$-smooth differential forms, the definition of the branched integral on a weighted branched suborbifold, and how to define the polyfold invariants.

In Appendix~\ref{appx:local-surjectivity} we consider some basic properties of the linearized Cauchy--Riemann operator, which allow us to assert the simple fact that cokernel vectors can be chosen so that they vanish on small neighborhoods of the marked or nodal points.



\section{Naturality of polyfold invariants}\label{sec:naturality-polyfold-invariants}


\subsection{Invariance of domain and branched suborbifolds}\label{subsec:invariance-of-domain}

The perturbed moduli spaces of polyfold theory have the structure of compact oriented weighted branched suborbifolds.
While considering the naturality of the polyfold invariants, we will encounter a smooth bijection between weighted branched suborbifolds,
\[
	f: \cS_1 \to \cS_2,
\]
where $\dim \cS_1 = \dim \cS_2$ and where only the target $\cS_2$ is assumed to be compact.
We would like to show that this map is a homeomorphism.

However using only knowledge of the topologies of these spaces, it is impossible to show this.
The key to resolving this problem is understanding the branched suborbifold structure and how to use this additional structure to prove an invariance of domain result.
This result will allow us to assert that the above map is a homeomorphism.

Invariance of domain is a classical theorem of algebraic topology due to Brouwer, and was originally published in 1911.
\begin{theorem}[Invariance of domain, {\cite{brouwer1911beweis}}]\label{thm:invariance-of-domain}
	Let $U$ be an open subset of $\R^n$, and let $f: U\to \R^n$ be an injective continuous map.  Then $f$ is a homeomorphism between $U$ and $f(U)$.
\end{theorem}

This result can immediately be generalized to manifolds; let $M$ and $N$ be an $n$-dimensional manifolds and let $f: M\to N$ be an injective continuous map.  Then $f$ is a homeomorphism onto its image.  Moreover, if $f$ is bijective, it is a homeomorphism.  We seek to generalize this result to the branched suborbifolds of our current situation.

\subsubsection{Local topology of branched submanifolds}


As a starting definition, a \emph{branched manifold} is a topological space which is locally homeomorphic to a finite union of open subsets of $\R^n$.
However, such a broad definition of a branched manifold immediately raises the possibility of non-desirable topological properties. Consider the classic example of the \emph{line with two origins}---although this is a locally Euclidean and second-countable topological space, it is not Hausdorff.
In contrast, the branched submanifolds we study are embedded into open subsets of ambient M-polyfolds and have better behaved topologies, as the following lemma demonstrates.

\begin{lemma}\label{lem:topology-of-local-branching-structures}
	Let $U$ be a metrizable topological space.
	Let $M_i$, $i\in I$ be a finite collection of finite-dimensional manifolds together with inclusion maps $\phi_i: M_i \hookrightarrow U$.
	Assume moreover that each $\phi_i$ is proper and a topological embedding.

	Consider the set defined by the image of the inclusions, $\cup_{i \in I} \phi_i (M_i)$.
	There are two topologies we may consider on this set:
	\begin{itemize}
		\item $(\cup_{i \in I} \phi_i(M_i), \tau_s)$, where $\tau_s$ is the subspace topology induced from $U$
		\item $(\cup_{i \in I} \phi_i(M_i), \tau_q)$, where $\tau_q$ is the quotient topology induced by the map $\sqcup_{i\in I} \phi_i : \sqcup_{i\in I} M_i \to \cup_{i \in I} \phi(M_i)$.
	\end{itemize}
	These two topologies are identical.
\end{lemma}
\begin{proof}
	We show that $\tau_s = \tau_q$.
	\begin{itemize}
		\item $\tau_s \subset \tau_q$
	\end{itemize}
	Consider the following commutative diagram where $q$ is the quotient map, $\phi_i$ are the continuous inclusion maps $\phi_i: M_i \to U$, and $i$ is inclusion map.
	\begin{center}
		\begin{tikzcd}
			\bigsqcup_{i\in I} M_i \arrow[r, "\sqcup_{i\in I}\phi_i"] \arrow[d, "q"'] & U \\
			(\bigcup_{i\in I} \phi_i(M_i),\tau_q) \arrow[ru, "i",hook] \arrow[r, "\id"] & (\bigcup_{i \in I} \phi_i(M_i), \tau_s) \arrow[u, "i"', hook]
		\end{tikzcd}
	\end{center}
	Then by the characteristic property of the quotient topology, $\sqcup_{i\in I} \phi_i$ continuous implies $i:(\cup_{i \in I} \phi_i(M_i), \tau_q) \allowbreak \hookrightarrow \allowbreak U $ continuous.
	By the definition of the subspace topology, $i:(\cup_{i \in I} \phi_i(M_i), \tau_q) \hookrightarrow U $ is continuous.
	By the characteristic property of the subspace topology, $i:(\cup_{i \in I} \phi_i(M_i), \tau_q) \hookrightarrow U $ continuous implies %
	$\id : (\cup_{i \in I} \phi_i(M_i), \tau_q) \to (\cup_{i \in I} \phi_i(M_i), \tau_s)$
	is continuous.

	\begin{itemize}
		\item $\tau_q \subset \tau_s$
	\end{itemize}
	By assumption $U$ is a metrizable space; hence it is also a regular topological space.
	The assumption that each $\phi_i$ is a topological embedding and is proper implies moreover that the images $\phi_i(M_i)\subset U$ are closed in the subspace topology; to see this note that in metric spaces, sequential compactness is equivalent to compactness, and then use properness.

	Suppose $V\subset \cup_{i \in I} \phi_i(M_i)$ and $V\in \tau_q$.
	We will show for every $x\in V$ there exists a subset $B \subset \cup_{i \in I} \phi_i(M_i)$ such that $B \in \tau_s$ and $x \in B \subset V$.  This implies that $V\in\tau_s$, as desired.

	By the definition of the quotient topology, the set $q^{-1} (V) \subset \sqcup_{i\in I} M_i$ is open and hence $q^{-1} (V) \cap M_i$ is open in the topology on $M_i$.	Consider $x$ as a point in $U$ via the set inclusion $\cup_{i\in I} \phi_i(M_i) \subset U$, since $\phi_i : M_i\to U$ is an injection it follows that $q^{-1} (x) = \{x_{i_1}, \ldots, x_{i_k} \}$ where $x_{i_l} \in M_{i_l}$ for a nonempty subset $\{i_1,\ldots , i_k \} \subset I$.

	Let $B_\epsilon (x)\subset U$ be an $\epsilon$-ball at $x$.
	Since $\phi_{i_l}$ is a topological embedding it follows that the sets $\phi^{-1}_{i_l} (B_\epsilon(x))$ give a neighborhood basis for $M_{i_l}$ at the point $x_{i_l}$.
	Therefore, we may take $\epsilon$ small enough that $\phi^{-1}_{i_l} (B_\epsilon(x)) \subset q^{-1} (V) \cap M_{i_l}$ for all $i_l \in \{i_1,\ldots , i_k \}$.
	Since $U$ is a regular topological space, and since $x$ and $\phi_j(M_j)$ are disjoint closed subsets of $U$ for $j \in I \setminus \{i_1,\ldots , i_k \}$, we can find disjoint open neighborhoods that separate $x$ and $\phi_j(M_j)$.
	This moreover implies that we may take $\epsilon$ small enough that $\phi^{-1}_j (B_\epsilon (x)) = \emptyset$ for all $j \in I \setminus \{i_1,\ldots , i_k \}$.
	For such an $\epsilon$, it follows that $\phi_i^{-1} (B_\ep(x)) \subset q^{-1}(V) \cap M_i$ for all $i\in I$.

	The desired set is then given by
	\[
		B:= B_\epsilon (x) \cap \bigcup_{i \in I} \phi_i (M_i);
	\]
	it is an open set in the subspace topology on $\cup_{i \in I} \phi_i(M_i)$.
	By construction, $q^{-1}(B) = \sqcup_{i\in I} \phi_i^{-1} (B_\ep(x)) \subset \sqcup_{i\in I} q^{-1}(V) \cap M_i = q^{-1} (V)$, therefore $B\subset V$ as desired.


\end{proof}

An open subset of an M-polyfold with the subspace topology is a metrizable topological space, and hence the above lemma applies to the branched suborbifolds of Definition~\ref{def:weighed-branched-suborbifold}

\begin{lemma}[Invariance of domain for branched submanifolds of M-polyfolds]\label{lem:local-homeo-m-polyfold}
	Let $S_i$ be $n$-dimensional branched submanifolds of M-polyfolds $Z_i$ for $i=1,2$.
	Consider an injective continuous map between these two M-polyfolds,
	$\hat{f}: Z_1 \hookrightarrow Z_2$,
	and suppose that there is a well-defined restriction to the branched submanifolds,
	$\hat{f}|_{S_1}:S_1 \hookrightarrow S_2$.

	For every $x\in S_1$ with $y:= \hat{f}(x) \in S_2$, suppose that there exist local branching structures $(M_i)_{i\in I}$ at $x$ and $(M'_j)_{j\in I}$ at $y$ which have the same index set $I$.
	Moreover, assume that $\hat{f}$ has a well-defined restriction to the individual local branches for each index $i\in I$ as follows:
	\[
		\hat{f}|_{M_i} : M_i \hookrightarrow M'_i.
	\]
	Then $\hat{f}|_{S_1}$ is a local homeomorphism between $S_1$ and $S_2$. Since we have assumed that $\hat{f}$ is injective, it follows that $\hat{f}|_{S_1}$ is also a homeomorphism onto its image.
\end{lemma}
\begin{proof}
	Let $x\in S_1$ which maps to $\hat{f}(x)\in S_2$.  By assumption, there exists a local branching structure $(M_i)_{i\in I}$ in a neighborhood $O_x$ of $x$, and there exists a local branching structure $(M'_j)_{j\in J}$ in a neighborhood $O_{\hat{f}(x)}$ of $\hat{f}(x)$ such that the index sets are the same, $I=J$, and $\hat{f}$ restricts to a injective continuous map between each branch, i.e.,
	\[\hat{f}|_{M_i} : M_i \to M'_i.\]

	We may invoke invariance of domain \ref{thm:invariance-of-domain} to see that the restricted maps $\hat{f}|_{M_i}$ are homeomorphisms onto their images.
	Observe that the open balls $B_\epsilon(\hat{f}(x))\subset O_{\hat{f}(x)}$ give a neighborhood basis for $M_i'$ at $\hat{f}(x)$ for all $i\in I$.  It follows that $\hat{f}^{-1} (B_\epsilon (\hat{f}(x))) \subset O_x$ give a neighborhood basis for $M_i$ at $x$ for all $i\in I$.  For $\epsilon$ small enough, the restricted maps
	\begin{equation}\label{eq:restriction-to-local-branches}
		\hat{f}|_{M_i \cap \hat{f}^{-1} (B_\epsilon (\hat{f}(x)))} : M_i \cap \hat{f}^{-1} (B_\epsilon (\hat{f}(x))) \to M_i' \cap B_\epsilon(\hat{f}(x))
	\end{equation}
	are homeomorphisms for all $i\in I$.

	Define a neighborhood of $x$ by $U_x = \hat{f}^{-1} (B_\epsilon (\hat{f}(x)))$; then $N_i := M_i \cap \hat{f}^{-1} (B_\epsilon(\hat{f}(x)))$ give local branches in $U_x$.  Define a neighborhood of $\hat{f}(x)$ by $U_{\hat{f}(x)}:=B_\epsilon(\hat{f}(x))$; then $N_i' := M_i' \cap B_\epsilon(\hat{f}(x))$ give local branches in $U_{\hat{f}(x)}$.  We can now rewrite \eqref{eq:restriction-to-local-branches} more simply as
	\[
		\hat{f}|_{N_i} : N_i \to N'_i.
	\]
	and note again that the maps $\hat{f}|_{N_i}$ are homeomorphisms for all $i\in I$.  Hence the map $\sqcup_{i\in I} (\hat{f}|_{N_i}): \sqcup_{i\in I} N_i \to \sqcup_{i\in I} N'_i$ is also a homeomorphism.

	Consider the following commutative diagram of maps.
	\begin{center}
		\begin{tikzcd}
			\bigsqcup_{i\in I} N_i \arrow[d, "q"] \arrow[r, "\sqcup (\hat{f}|_{N_i})"] & \bigsqcup_{i\in I} N'_i \arrow[d, "q'"] \\
			(\cup_{i\in I} N_i, \tau_q) \arrow[r, "\hat{f}|_{\cup N_i}"', hook] & (\cup_{i\in I} N'_i, \tau_{q'})
		\end{tikzcd}
	\end{center}
	We assert that the map $\hat{f}|_{\cup N_i} : (\cup_{i \in I} N_i,\tau_q) \hookrightarrow (\cup_{i\in I} N'_i,\tau_{q'})$ is a homeomorphism.
	Indeed, by assumption $\hat{f}|_{\cup N_i}$ is injective.  We can use the fact that $\sqcup (\hat{f}|_{N_i})$ is a bijection to see that $\hat{f}|_{\cup N_i}$ must also be surjective.
	It is easy to check that $\hat{f}|_{\cup N_i}$ is continuous with respect to the quotient topologies $\tau_q$ and $\tau_{q'}$.
	Furthermore, $\hat{f}|_{\cup N_i}$ is an open map.
	To see this, let $U\subset (\cup_{i \in I} N_i,\tau_q)$ be an open set.  Then $q^{-1} (U) \subset \sqcup_{i\in I} N_i$ is open by the definition of the quotient topology.
	Since $\sqcup (\hat{f}|_{N_i})$ is a homeomorphism, $(\sqcup (\hat{f}|_{N_i})) (q^{-1}(U))$ is open.
	Commutativity of the diagram and the fact that both $\sqcup (\hat{f}|_{N_i})$ and $\hat{f}|_{\cup N_i}$ are bijections implies that $(\sqcup \hat{f}|_{N_i}) (q^{-1}(U)) = q'^{-1} (\hat{f}|_{\cup N_i} (U))$.
	It therefore follows that $\hat{f}|_{\cup N_I} (U)$ is open by the definition of the quotient topology.

	By Lemma~\ref{lem:topology-of-local-branching-structures}, the fact that $\hat{f}|_{\cup N_i} : (\cup_{i \in I} N_i,\tau_q) \hookrightarrow (\cup_{i\in I} N'_i,\tau_{q'})$ is a homeomorphism implies that $\hat{f}|_{\cup N_i} : (\cup_{i \in I} N_i,\tau_s) \hookrightarrow (\cup_{i\in I} N'_i,\tau_s)$ is a homeomorphism.
	Note that $\cup_{i \in I} N_i \subset S_1$ and $\cup_{i \in I} N'_i \subset S_2$ are both open subsets.
	By Remark~\ref{rmk:local-topology-subgroupoid}, the inclusion maps $(\cup_{i \in I} N_i,\tau_s)\hookrightarrow S_1$ and $(\cup_{i\in I} N'_i,\tau_s)\hookrightarrow S_2$ are both local homeomorphisms.  We now see that the map $\hat{f} : S_1 \to S_2$ is a local homeomorphism on an open neighborhood of the point $x\in S_1$.  Since $x\in S_1$ was arbitrary, and since $\hat{f}$ is injective, we can conclude $\hat{f}$, considered on the object sets, is a local homeomorphism.  It then follows from the \'etale property that $\hat{f}$, considered on the morphism sets, is a local homeomorphism.
\end{proof}

\begin{lemma}[Invariance of domain for branched suborbifolds of polyfolds]\label{lem:invariance-of-domain-branched-orbifolds}
	Let $\cS_i$ be an $n$-dimensional branched suborbifold of a polyfold $\cZ_i$ for $i=1,2$.
	Consider an injective continuous map between these two polyfolds, $f: \cZ_1 \hookrightarrow \cZ_2$,
	and which has an associated functor $\hat{f}: (Z_1,\bm{Z_1}) \hookrightarrow (Z_2,\bm{Z_2})$, which is injective and continuous with respect to the object and morphism sets.
	In addition, assume that the functor $\hat{f}$ is fully faithful.
	Suppose that $f$ has a well-defined restriction to the branched suborbifolds $f|_{\cS_1}:\cS_1 \hookrightarrow \cS_2$; it follows that $\hat{f}$ restricts to a well-defined functor between the subgroupoids $\hat{f}|_{S_1} : (S_1,\bm{S}_1) \to (S_2,\bm{S}_2)$.

	Assume that for every $x\in S_1$ with $y:= \hat{f}(x) \in S_2$, there exist local branching structures $M_i$, $i\in I$ at $x$ and $M'_j$, $j\in I$ at $y$ which have the same index set $I$.
	Moreover, assume that $\hat{f}$ has a well-defined restriction to the individual local branches for each index $i\in I$ as follows:
	\[
		\hat{f}|_{M_i} : M_i \hookrightarrow M'_i.
	\]

	Then the restriction $f|_{\cS_1}:\cS_1 \hookrightarrow \cS_2$ is a local homeomorphism. In particular, if $f|_{\cS_1}$ is a bijection, then it is a homeomorphism.
\end{lemma}
\begin{proof}
	Let $[x] \in \cS_1$ and let $f([x]) \in \cS_2$.  Let $x$ be a representative of $[x]$, hence $\hat{f}(x)$ is a representative of $f([x])$.
	From the proof of Lemma~\ref{lem:local-homeo-m-polyfold}, we have seen that there exists a local branching structure $(N_i)_{i\in I}$ at $x$ and a local branching structure $(N'_i)_{i\in I}$ at $\hat{f}(x)$ such that $\hat{f}|_{\cup N_i} : (\cup_{i \in I} N_i,\tau_s) \hookrightarrow (\cup_{i\in I} N'_i,\tau_s)$ is a homeomorphism.

	The proof now follows the same reasoning as Lemma~\ref{lem:local-homeo-m-polyfold}.
	Consider the following commutative diagram of maps.
	\begin{center}
		\begin{tikzcd}
			\bigcup_{i\in I} N_i \arrow[d, "q"] \arrow[r, "\hat{f}|_{\cup N_i}"] & \bigcup_{i\in I} N'_i \arrow[d, "q'"] \\
			(\abs{\cup_{i\in I} N_i},\tau_q)  \arrow[r, "f|_{\abs{\cup N_i}}"', hook] & (\abs{\cup_{i\in I} N'_i}, \tau_{q'})
		\end{tikzcd}
	\end{center}
	We assert that the map $f|_{\abs{\cup N_i}}$ is a homeomorphism.
	Indeed, by assumption $f|_{\abs{\cup N_i}}$ is injective.  We can use the fact that $\hat{f}|_{\cup N_i}$ is a bijection to see that $f|_{\abs{\cup N_i}}$ must also be surjective.
	By assumption, $f$ is continuous and therefore the restriction $f|_{\abs{\cup N_i}}$ is continuous.
	Furthermore, $f|_{\abs{\cup N_i}}$ is an open map.
	To see this, let $U\subset \abs{\cup_{i\in I} N_i}$ be an open set.
	Then $q^{-1}(U)\subset \cup_{i \in I} N_i$ is open by the definition of the quotient topology.
	Since $\hat{f}|_{\cup N_i}$ is a homeomorphism,  $(\hat{f}|_{\cup N_i})(q^{-1}(U)) \subset \cup_{i \in I} N'_i$ is open.  Commutativity of the diagram and the fact that both $\hat{f}|_{\cup N_i}$ and $f|_{\abs{\cup N_i}}$ are bijections implies that $(\hat{f}|_{\cup N_i}) (q^{-1}(U)) = q'^{-1} (f|_{\abs{\cup N_i}}(U))$.
	It therefore follows that $f|_{\abs{\cup N_i}}(U)$ is open by the definition of the quotient topology.

	Proposition~\ref{prop:natural-representation-subgroupoid} implies that the inclusion maps $\abs{\cup_{i\in I} N_i} \hookrightarrow \cS_1$ and $\abs{\cup_{i\in I} N'_i} \hookrightarrow \cS_2$ are local homeomorphisms.
	We now see that the map $f|_{\cS_1} : \cS_1 \to \cS_2$ is a local homeomorphism on an open neighborhood of the point $[x]\in \cS_1$.  Since $[x]\in \cS_1$ was arbitrary it follows that $f|_{\cS_1}$ is a local homeomorphism.
	It moreover follows that if $f|_{\cS_1}$ is bijective, it is a homeomorphism.
\end{proof}

\subsection{Fredholm multisections and abstract perturbations}\label{subsec:fredholm-multisections}

In this subsection we generalize the polyfold abstract perturbation theory from Fredholm sections to Fredholm multisections.
This involves minor modifications to the definitions and theorems originally developed in \cite{HWZ3} and which we recalled in \S\ref{subsec:abstract-perturbations}.
In particular, we may still perturb a Fredholm multisection via $\ssc^+$-multisections, and the perturbed solution space of a transversal Fredholm multisection is still a weighted branched suborbifold.

\begin{definition}
	Let $\cW\to \cZ$ be a strong polyfold bundle.  We define a \textbf{$\ssc$-smooth Fredholm multisection} as
	\begin{enumerate}
		\item a function $F:\cW \to \Q^+$,
		\item an associated functor $\hat{F}: W \to \Q^+$ where $\abs{\hat{F}}$ induces $F$,
	\end{enumerate}
	such that at ever $[x]\in \cZ$ there exists a \textbf{local Fredholm section structure} defined as follows.
	Let $x\in Z$ be a representative of $[x]$ and let $U\subset Z$ be a $\bm{G}(x)$-invariant open neighborhood of $x$, and consider the restricted strong M-polyfold bundle $P: W|_U \to U$.
	Then there exist finitely many $\ssc$-Fredholm sections $f_1,\ldots,f_k : U \to W|_U$ %
	with associated positive rational numbers $\sigma_1,\ldots ,\sigma_k \in \Q^+$ which satisfy the following:
	\begin{enumerate}
		\item $\sum_{i=1}^k \sigma_i =1$.
		\item The restriction $\hat{F}|_{W|_U}: W|_U \to \Q^+$ is related to the local sections and weights via the equation
		      \[
			      \hat{F}|_{W|_U}(w)=\sum_{\{i\in \{1,\ldots, k\} \mid w=f_i(p(w))\}} \sigma_i
		      \]
		      where the empty sum has by definition the value $0$.
	\end{enumerate}
\end{definition}

We say that the Fredholm multisection $F$ is \textbf{proper} if the unperturbed solution set
\[
	\cS (F) := \{ [z]\in \cZ \mid F(0_{[x]})	>0	\} \subset \cZ
\]
is a compact topological space.
(Notice that the condition $F(0_{[x]})>0$ is equivalent to the condition that $f_i(x) = 0$ for some $i \in I$ for a given representative $x$ and a local Fredholm section structure $(f_i)_{i\in I}$, $(\sigma_i)_{i\in I}$ at $x$.)
Furthermore, we can define a weight function on the unperturbed solution set, $\cS(F) \to \Q^+$, by $[z] \mapsto F(0_{[x]})$.

\begin{example}
	For the applications we have in mind, the $\ssc$-smooth Fredholm multisections are obtained as a pair $(\delbar,\Lambda)$ consisting of:
	\begin{itemize}
		\item a $\ssc$-smooth Fredholm section $\delbar:\cZ\to\cW$,
		\item a $\ssc^+$-multisection $\Lambda :\cW \to \Q^+$.
	\end{itemize}
	Given a point $[x]\in\cZ$, we define a local Fredholm section structure for $(\delbar,\Lambda)$ at $[x]$ as follows.
	Let $x\in Z$ be a representative of $[x]$ and let $U\subset Z$ be a $\bm{G}(x)$-invariant open neighborhood of $x$, and consider the restricted strong M-polyfold bundle $P: W|_U \to U$.
	Consider the $\ssc$-smooth Fredholm section $\hdelbar: U \to W|_U$, and let $(s_i)_{i\in I}$, $(\sigma_i)_{i\in I}$ be a local section structure for $\Lambda$ at $x$.

	Then the local Fredholm section structure is given by $f_i := \hdelbar - s_i$ with associated weight $\sigma_i$. It follows from \cite[Thm.~3.2]{HWZbook} that such an $f_i$ is in fact a $\ssc$-smooth Fredholm section.
	We may then define the functor $\hat{F}$ locally via the equation
	\[
		\hat{F}|_{W|_U}(w)=\sum_{i\in \{1,\ldots, k \mid w=f_i(p(w))\}} \sigma_i
	\]
	where the empty sum has by definition the value $0$. It is evident this extends to a well-defined functor $\hat{F}: (W,\bm{W}) \to \Q^+$.
	Finally, observe the perturbed solution set $\cS (\delbar,\Lambda)$ associated to the pair $(\delbar,\Lambda)$ is the same as the unperturbed solution set $\cS (F)$ associated to the Fredholm multisection $F$, i.e.,
	\[
		\{ [z]\in \cZ \mid \Lambda(\delbar([x]))	>0	\} = \{ [z]\in \cZ \mid F(0_{[x]})	>0	\}.
	\]
\end{example}

\subsubsection{Transverse perturbations of Fredholm multisections}

We can immediately adapt the main definitions and results of \S\ref{subsec:abstract-perturbations}; there is no difficulty in generalizing the construction of transverse perturbations to Fredholm multisections.

\begin{definition}
	Associated to a $\ssc$-smooth Fredholm multisection $\delbar$ and a $\ssc^+$-mul\-ti\-sec\-tion $\Gamma$,
	we define the \textbf{perturbed solution space} as the set
	\[
		\cS(F,\Lambda) :=\{[z]\in\cZ \mid (F\oplus\Gamma) (0_{[z]})	>0	\}\subset \cZ
	\]
	with topology given by the subspace topology induced from $\cZ$. It is equipped with the weight function $\cS(F,\Gamma) \to \Q^+$, $[z]\mapsto (F\oplus\Gamma) (0_{[z]})$.
\end{definition}

Along the same lines as Definition~\ref{def:transversal-pair}, we can formulate what it means for a Fredholm multisection and a $\ssc^+$-multisection to be transversal.

\begin{definition}\label{def:fredholm-multisection-transversal}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, $F$ a $\ssc$-smooth Fredholm multisection, and $\Gamma$ a $\ssc^+$-multisection.

	Consider a point $[x]\in \cZ$.  We say $(F,\Gamma)$ is \textbf{transversal at $[x]$} if, given a local Fredholm section structure for $F$ at $[x]$ and given a local $\ssc^+$-section structure for $\Gamma$ at $[x]$, then the linearized local expression
	\[
		D(f_i-s_j)(x):T_x Z \to W_x
	\]
	is surjective for all $i\in I$, $j\in J$ with $f_i(x)=s_j(x)$.  We say that $(F,\Gamma)$ is \textbf{transversal} if it is transversal at every $[x] \in \cS(F,\Gamma)$.
\end{definition}

Consider our example of a Fredholm multisection $(\delbar,\Lambda)$ consisting of a Fredholm section and a $\ssc^+$-multisection $\Lambda$, and let $\Gamma$ be an additional $\ssc^+$-multisection. Then the sum $\Lambda \oplus \Gamma: \cW \to \Q^+$ is a $\ssc^+$-multisection, with local section structure given by $s_i +r_j$ where $(s_i)_{i\in I}$ is a local section structure for $\Lambda$ and $(r_j)_{j\in J}$ is a local section structure for $\Gamma$.
We may now observe that the pair $(\delbar, \Lambda\oplus \Gamma)$ consisting of the Fredholm section $\delbar$ and the $\ssc^+$-multisection $\Lambda\oplus \Gamma$ is transversal in the sense of Definition~\ref{def:transversal-pair} if an only if the pair $((\delbar,\Lambda), \Gamma)$ consisting of the Fredholm multisection $(\delbar,\Lambda)$ and the $\ssc^+$-multisection $\Gamma$ is transversal in the sense of the above Definition~\ref{def:fredholm-multisection-transversal}.

We have an analog of Theorem~\ref{thm:transversality}.

\begin{proposition}\label{prop:fredholm-multisection-transversal-pairs-weighted-branched-suborbifolds}
	Let $P:\cW\rightarrow \cZ$ be a strong polyfold bundle, $F$ a $\ssc$-smooth Fredholm multisection, and $\Gamma$ a $\ssc^+$-multisection.
	If the pair  $(F,\Lambda)$ is transversal, then the perturbed solution set $\cS(F,\Gamma)$ carries in a natural way the structure of a weighted branched suborbifold.
\end{proposition}

\subsubsection{Controlling compactness of Fredholm multisections}

In contrast to construction of transverse perturbations of Fredholm multisections, where no modification of the underlying definitions or ideas was required, it is somewhat more involved to show how to control the compactness of Fredholm multisections.
It is necessary to refer to the earlier work contained in \cite[\S4.2]{HWZ3} in order to obtain complete results in our current situation.

\begin{definition}
	Consider a Fredholm multisection and a point $[z] \in \cZ$.
	Let $(f_i)_{i\in I}$ be a local section structure for $F$ at a representative $z$.
	Let $N:\cW[1]\to [0,\infty)$ be an auxiliary norm with associated $\ssc^0$-functor $\hat{N}:W[1]\to [0,\infty)$; as in \cite[p.~434]{HWZbook}, we may extend $N$ to all of $\cW$ by defining $N([w]):= +\infty$ for $[w]\in \cW[0] \setminus \cW[1]$, and likewise extend $\hat{N}$ to all of $W$.
	We define the \textbf{min norm of the Fredholm multisection} $F$ at $[z]$ by the equation
	\[
		N_{\min} (F) [z] := \min_{i\in I} \{	\hat{N} (	f_i(z)	)	\}.
	\]
\end{definition}

\begin{definition}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $F$ be a $\ssc$-smooth proper Fredholm multisection, and let $N :\cW\to [0,\infty)$ be an extended auxiliary norm.

	Consider an open neighborhood $\cU$ of the unperturbed solution set $\mathcal{S}(F)\subset \cZ$.
	We say that the pair $(N,\cU)$ \textbf{controls the compactness} of $F$ provided the set
	\[
		cl_\cZ \{[x]\in \cU \mid N_{\min} (F) [x]\leq 1\} \subset \cZ
	\]
	is compact.
\end{definition}

\begin{proposition}[Analog of {\cite[Thm.~4.5]{HWZ3}}]
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $F$ be a $\ssc$-smooth proper Fredholm multisection, and let $N :\cW[1]\to [0,\infty)$ be an auxiliary norm.  Then there exists an open neighborhood $\cU$ of the unperturbed solution set $\mathcal{S}(F)$ such that the pair $(N,\cU)$ controls the compactness of $F$.
\end{proposition}

\begin{proposition}[Analog of {\cite[Lem.~4.16]{HWZ3}}]\label{prop:fredholm-multisection-compactness}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $F$ be a $\ssc$-smooth proper Fredholm multisection, and let $(N,\cU)$ be a pair which controls compactness.
	If a $\ssc^+$-multisection $\Gamma$ satisfies $N[\Gamma] \leq 1$ and $\text{dom-supp} (\Gamma) \subset \cU$, then the perturbed solution set $\mathcal{S}(F,\Gamma)$ is compact.%
\end{proposition}

\subsubsection{Regular perturbations and compact cobordism}

Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $F$ be a $\ssc$-smooth proper Fredholm multisection, and let $(N, \cU)$ be a pair which controls compactness.
We say a $\ssc^+$-multisection $\Gamma$ is a \textbf{regular perturbation} of $F$ with respect to the pair $(N,\cU)$ if it satisfies the following:
\begin{itemize}
	\item $(F, \Gamma)$ is a transversal pair,
	\item $N[\Gamma] \leq 1$ and $\text{dom-supp} (\Gamma) \subset \cU$.
\end{itemize}
As in \cite[Cor.~15.1]{HWZbook}, one can prove that there exist regular perturbations $\Gamma$ of $F$ with respect to the pair $(N,\cU)$.
It follows from Proposition~\ref{prop:fredholm-multisection-transversal-pairs-weighted-branched-suborbifolds} and Proposition~\ref{prop:fredholm-multisection-compactness} that the perturbed solution space $\cS(F,\Gamma)$ has the structure of a compact weighted branched suborbifold, with weight function given by $\cS(F,\Gamma) \to \Q^+$, $[z]\mapsto (F\oplus \Gamma)(0_{[z]})$.

Furthermore, as in \cite[Cor.~15.1]{HWZbook} one can prove the existence of a compact cobordism between perturbed solution sets of regular perturbations.

\subsubsection{Cobordism from a transversal Fredholm multisection to a regular perturbation}\label{subsubsec:cobordism-multisection-regular}

Having developed the above generalization to Fredholm multisections, we are finally in a position to state the desired specialized result, Proposition~\ref{prop:cobordism-multisection-regular}.

Consider a strong polyfold bundle $P:\cW \to \cZ$ and a $\ssc$-smooth proper Fredholm section $\delbar$.
Suppose that $(N_0,\cU_0)$ is a pair which controls the compactness of $\delbar$.
Consider a $\ssc^+$-multisection $\Lambda$ and suppose that $(\delbar,\Lambda)$ is a transversal pair.
(Note that we do not assume that $\Lambda$ is admissible to a pair which controls compactness.)
Now, consider the strong polyfold bundle $\cW\times[0,1] \to \cZ\times[0,1]$, and consider a $\ssc$-smooth Fredholm multisection $(\tdelbar,\tilde{\Lambda})$ defined as follows:
\begin{itemize}
	\item $\tdelbar$ is the $\ssc$-smooth Fredholm section defined by $([z],s)\mapsto (\delbar([z]),s)$,
	\item $\tilde{\Lambda}$ is the $\ssc^+$-multisection defined for $s\neq 0$ by
	      $([w],s)\mapsto \Lambda(1/s \cdot [w])$ and for $s=0$ by
	      \[
		      ([w],0)	\mapsto
		      \begin{cases}
			      1, & \text{if } [w]=[0],     \\
			      0, & \text{if } [w]\neq [0],
		      \end{cases}
	      \]
	      and
	      whose local section structure at an object $(x,s)$ is defined by $O_x\times [0,1] \to W \times [0,1]; (x,s) \mapsto (s\cdot s_i(x), s)$ (where $(s_i)$ is the original local section structure for $\Lambda$ at the object $x\in Z$).
\end{itemize}
Moreover, let us assume that the Fredholm multisection $(\tdelbar,\tilde{\Lambda})$ is proper, i.e., the solution set $\cS(\tdelbar,\tilde{\Lambda})$ is compact.

Observe that the topological boundary of $\cS(\tdelbar,\tilde{\Lambda})$ is given by the following set:
\[
	\partial \cS(\tdelbar,\tilde{\Lambda}) = \cS(\delbar) \sqcup \cS(\delbar,\Lambda).
\]
By the assumption that $(\delbar, \Lambda)$ is a transversal pair $\cS(\delbar,\Lambda)$ is a weighted branched orbifold; moreover it is a closed subset of $\cS(\tdelbar, \tilde{\Lambda})$ and is therefore compact.
We emphasize that since $\Lambda$ is not admissible to a pair which controls compactness, it is not a regular perturbation (see Definition~\ref{def:regular-perturbation}) and hence cannot be used to define polyfold invariants.
We can almost consider $\cS(\tdelbar,\tilde{\Lambda})$ as a compact cobordism, except $\delbar$ is not assumed to be transverse and hence $\cS(\delbar)$ is not assumed to have the structure of a weighted branched suborbifold.

The following proposition demonstrates how to perturb the solution space $\cS(\tdelbar,\tilde{\Lambda})$ in order to obtain a compact cobordism between $\cS(\delbar,\Lambda)$ and a perturbed solution space $\cS(\delbar,\Gamma_0)$ where $\Gamma_0$ is a \emph{regular} perturbation.

\begin{proposition}\label{prop:cobordism-multisection-regular}
	Suppose that $\Gamma_0$ is a regular perturbation of $\delbar$ with respect to the pair $(N_0,\cU_0)$,
	There exists a pair $(N,\cU)$ which controls the compactness of the Fredholm multisection $(\tdelbar,\tilde{\Lambda})$ and which satisfies the following:
	\begin{itemize}
		\item the auxiliary norm $N: \cW\times [0,1] \to \Q^+$ restricts to $N_0$ on $\cW\times \{0\}$,
		\item the open neighborhood $\cU$ of $\cS(\tdelbar,\tilde{\Lambda})$ satisfies $\cU \cap (\cZ\times \{0\}) = \cU_0$.
	\end{itemize}
	Moreover, there exists a regular perturbation $\Gamma$ of $(\tdelbar,\tilde{\Lambda})$ with respect to the pair $(N,\cU)$ such that $\Gamma|_{\cW\times \{0\}}$ can be identified with $\Gamma_0$ and such that $\Gamma|_{\cW\times\{1\}} \equiv 0$.
\end{proposition}

The proof of this proposition follows the same reasoning used to prove Theorem~\ref{thm:cobordism-between-regular-perturbations}, noting in addition that  we do not need to perturb in a neighborhood of $\cZ\times\{1\}$, as by assumption $(\delbar,\Lambda)$ is a transversal pair.

\subsection{Intermediary subbundles and naturality of polyfold invariants}\label{subsec:intermediary-subbundles-naturality}

We present the necessary hypotheses for Theorem~\ref{thm:naturality}. Suppose we have a commutative diagram as follows,
\begin{equation}\label{eq:commutative-diagram-naturality}
	\begin{tikzcd}
		\cW_1 \arrow[r, "\iota_\cW"', hook] \arrow[d, "\delbar_1\quad "'] & \cW_2 \arrow[d, "\quad \delbar_2"] &  \\
		\cZ_1 \arrow[r, "\iota_\cZ"', hook] \arrow[u, bend left] & \cZ_2 \arrow[u, bend right] &
	\end{tikzcd}
\end{equation}
where:
\begin{itemize}
	\item $\cW_i \to \cZ_i$ are strong polyfold bundles for $i=1,2$.
	\item $\delbar_i$ are $\ssc$-smooth proper oriented Fredholm sections of the same index for $i=1,2$.
	\item $\iota_\cZ :\cZ_1 \hookrightarrow \cZ_2$ is a $\ssc$-smooth injective map, and the associated functor between polyfold structures $\hat{\iota}_\cZ : (Z_1,\bm{Z}_1) \hookrightarrow (Z_2,\bm{Z}_2)$ is fully faithful and is also an injection on both the object and the morphism sets.
	\item $\iota_\cW:\cW_1\hookrightarrow\cW_2$ is a $\ssc$-smooth injective map, and the associated functor between polyfold strong bundle structures $\hat{\iota}_\cW :(W_1,\bm{W}_1) \hookrightarrow (W_2,\bm{W}_2)$ is fully faithful, and is also an injection on both the object and the morphism sets.  Moreover, $\hat{\iota}$ is a bundle map (i.e., restricts to a linear map on the fibers).
	\item $\cS(\delbar_2) \subset \text{Im} (\iota_\cZ)$.
\end{itemize}

In order to deal with orientations, consider the following.
Consider a smooth object $x\in (Z_1)_\infty$ which maps to $y:= \hat{\iota}_\cZ \in (Z_2)_\infty$.
Consider a locally defined $\ssc^+$-section $s:' U \to W_2$ defined on an open neighborhood $U\subset Z_2$ of $y$, which satisfies $s'(y) = \hdelbar_2 (y)$.
Assume that this $\ssc^+$-section has a well-defined restriction $s'|_{U \cap \hat{\iota}_\cZ (Z_1)} : U \cap \hat{\iota}_\cZ (Z_1) \to \hat{\iota}_\cW (W_1)$, which induces a $\ssc^+$-section $s: \hat{\iota}_\cZ^{-1}(U) \to W_1$ which moreover satisfies $s(x) = \hdelbar_1 (x)$.
We therefore have a commutative diagram.
\[
	\begin{tikzcd}
		T_x W_1 \arrow[r, "D\hat{\iota}_\cW"'] & T_y W_2 &  \\
		T_x Z_1 \arrow[r, "D\hat{\iota}_\cZ"'] \arrow[u, "D(\hdelbar_1-s)(x)"] & T_y Z_2 \arrow[u, "D(\hdelbar_2-s')(y)"'] &
	\end{tikzcd}
\]
Consider the following maps: $D\hat{\iota}_\cZ: \ker ( D( \hdelbar_1-s ) (x) ) \to \ker ( D( \hdelbar_2-s' ) (y) )$, and $D\hat{\iota}_\cW: \text{Im} ( D(\hdelbar_1-s )(x) ) \to \text{Im} (D(\hdelbar_2-s')(y))$, which therefore induces a map $\coker ( D( \hdelbar_1-s ) (x) ) \to \coker ( D( \hdelbar_2-s' ) (y) )$.
These maps induce a map between the determinant real lines
\begin{gather*}
	\det ( D(\hdelbar_1-s) (x) ) = \Lambda^{\max} (\ker ( D(\hdelbar_1-s) (x) )) \otimes (\Lambda^{\max} (\coker ( D(\hdelbar_1-s) (x) ))^*,	\\
	\det ( D(\hdelbar_2-s') (y) ) = \Lambda^{\max} (\ker ( D(\hdelbar_2-s') (y) )) \otimes (\Lambda^{\max} (\coker ( D(\hdelbar_2-s') (y) ))	)^*	.
\end{gather*}

\begin{itemize}
	\item	Assume that the induced map between the determinants
	      \[\hat{\iota}_* : \det (D(\hdelbar_1-s)(x))) \to \det (D(\hdelbar_2-s')(y))\]
	      is an isomorphism. Moreover, assume that this isomorphism is orientation preserving, with respect to the chosen orientations of $\hdelbar_1$ at the point $x$ and $\hdelbar_2$ at the point $y$ (see Definition~\ref{def:oriented-Fredholm}).
\end{itemize}

Returning to the main discussion, it follows from commutativity of \eqref{eq:commutative-diagram-naturality} that $\iota_\cZ$ restricts to a continuous bijection between the unperturbed solution sets,
\[\iota_\cZ |_{\cS(\delbar_1)} : \cS(\delbar_1)\to \cS(\delbar_2).\]
In fact, this map is a homeomorphism as can be shown via point-set topology, noting that $\cS(\delbar_1)$ is compact and $\cS(\delbar_2)$ is Hausdorff (see \cite[Rmk.~3.1.15]{MWtopology}).

In order to compare the polyfold invariants, suppose we also have a commutative diagram
\begin{equation}\label{eq:gw-invariant-pair-of-polyfolds}
	\begin{tikzcd}
		&  & \cO \\
		\cZ_1 \arrow[r, "\iota_\cZ"', hook] \arrow[rru, "f_1"] & \cZ_2 \arrow[ru, "f_2"'] &
	\end{tikzcd}
\end{equation}
where:
\begin{itemize}
	\item $\cO$ is a finite-dimensional orbifold.
	\item $f_i$ are $\ssc$-smooth maps for $i=1,2$.
\end{itemize}

\begin{definition}\label{def:intermediate-subbundle}
	We define an  \textbf{intermediary subbundle} as a subset $\cR \subset \cW_2$ which satisfies the following properties.
	\begin{enumerate}
		\item Let $(R,\bm{R})$ be the associated subgroupoid of $\cR$. Then for every object $x\in Z_2$ we require that the fiber $R_x : = R \cap (W_2)_x$ is a vector subspace of $(W_2)_x$. (Note that we do not require that $R_x$ is complete.)
		\item\label{property-2-intermediary-subbundle} For any point $[x] \in \cZ_2$, if $\delbar_2 ([x]) \in \cR$ then $[x] \in \iota_\cZ(\cZ_1)$. (Equivalently, for any object $x\in Z_2$, if $\hdelbar_2 (x) \in R$ then $x \in \hat{\iota}_\cZ (Z_1)$.)
		\item\label{property-3-intermediary-subbundle}
		      Given $[x_0] \in \cS(\delbar_1) \simeq \cS(\delbar_2)$, let $V\subset U\subset Z_2$ be $\bm{G}(x_0)$-invariant open neighborhoods of a representative $x_0\in Z_2$ such that $\overline{V} \subset U$.
		      We require that there exist $\ssc^+$-sections
		      \[
			      s'_i :U \to W_2, \qquad 1\leq i \leq k
		      \]
		      which have well-defined restrictions $s'_i|_{U\cap \hat{\iota}_\cZ (Z_1)} : U\cap \hat{\iota}_\cZ (Z_1) \to \hat{\iota}_\cW (W_1)$. These restrictions induce sections $s_i : \hat{\iota}_\cZ^{-1} (U) \to W_1$ which we require to be $\ssc^+$ with respect to the M-polyfold structures on $Z_1$ and $W_1$.
		      We require that:
		      \begin{itemize}
			      \item $s'_i (U) \subset R$,
			      \item $s'_i= 0$ on $U\setminus V$,
			      \item $\text{span}\{s'_1(x_0),\ldots , s'_k(x_0)\} \oplus \text{Im}(D\hdelbar_2(x_0)) = (W_2)_{x_0}$,
			      \item $\text{span}\{s_1(x_0),\ldots , s_k(x_0)\} \oplus \text{Im}(D\hdelbar_1(x_0)) = (W_1)_{x_0}$.
		      \end{itemize}
		\item In addition, given a pair $(N_2,\cU_2)$ which controls the compactness of $\delbar_2$, we require that these $\ssc^+$-sections satisfy the following:
		      \begin{itemize}
			      \item $\hat{N}_2[s'_i] \leq 1$,
			      \item $\abs {\supp (s'_i)}\subset \cU_2$.
		      \end{itemize}

	\end{enumerate}
\end{definition}

Despite the lengthy properties that a intermediary subbundle must satisfy, in applications such subbundles are easy to construct, as we demonstrate in \S\ref{subsec:independence-sequence} and \S\ref{subsec:independence-punctures}.

We may now prove Theorem~\ref{thm:naturality-polyfold-invariants}, which we restate in order to be consistent with our current notation.

\begin{theorem}\label{thm:naturality}
	Suppose there exists an intermediary subbundle $\cR \subset \cW_2$. Then the polyfold invariants for $\cZ_1$ and $\cZ_2$ defined via the branched integral are equal.
	This means that, given a de Rahm cohomology class $\ww\in H^*_{\dR} (\cO)$ the branched integrals over the perturbed solution spaces are equal,
	\[
		\int_{\cS (\delbar_1, p_1)} f_1^* \ww = \int_{\cS(\delbar_2,p_2)} f_2^* \ww,
	\]
	for any choices of regular perturbations.
\end{theorem}
\begin{proof}
	We prove the theorem in six steps.

	\begin{step1}
		We use property \ref{property-3-intermediary-subbundle} of the intermediary subbundle to construct a transversal $\ssc^+$-multisection with a well-defined transversal restriction.
	\end{step1}

	At the outset, fix pairs $(N_i,\cU_i)$ which control the compactness of $\delbar_i$ for $i=1,2$. Consider a point $[x_0]\in \cS(\delbar_1)\simeq \cS(\delbar_2)$ and let $x_0\in Z_1$ be a representative with isotropy group $\bm{G}(x_0)$. Via the inclusion map $\hat{\iota}_\cZ$, we may identify $x_0$ with its image in $Z_2$ and note that we may also identify the isotropy groups.

	We may use property \ref{property-3-intermediary-subbundle} of the intermediary subbundle to construct an $\ssc^+$-mul\-ti\-sec\-tion functor $\hat{\Lambda}'_0:W_2 \times B_\ep^k \to \Q^+$
	with local section structure given by $\left\lbrace g * \left(\sum_{i=1}^k t_i \cdot s'_i\right)\right\rbrace_{g\in \bm{G}(x_0)}$ which satisfies the following.
	There exists a $\bm{G}(x_0)$-invariant open neighborhood $x_0 \subset U'_0 \subset Z_2$ such that at any object $x\in U'_0$ and for any $g\in \bm{G}(x_0)$ the linearization of the function
	\begin{align*}
		U'_0 \times B_\ep^k & \to W_2                                                                  \\
		(x, t_1,\ldots,t_k) & \mapsto \hdelbar_2 (x) - g * \left(\sum_{i=1}^k t_i \cdot s'_i(x)\right)
	\end{align*}
	projected to the fiber $(W_2)_x$ is surjective.

	Furthermore, property \ref{property-3-intermediary-subbundle} ensures that the functor
	$\hat{\Lambda}_0 :=\hat{\Lambda}_0' ( \hat{\iota}_\cW (\cdot), \cdot ) :W_1 \times B_\ep^k \to \Q^+$ is also a $\ssc^+$-multisection functor, with local section structure $\left\lbrace g * \left(\sum_{i=1}^k t_i \cdot s_i\right)\right\rbrace_{g\in \bm{G}(x_0)}$ where the $\ssc^+$-sections $s_i$ are induced by the well-defined restrictions of the sections $s'_i$. Likewise, there exists a $\bm{G}(x_0)$-invariant open neighborhood $x_0 \subset U_0 \subset Z_1$ such that at any object $x\in U_0$ and for any $g\in \bm{G}(x_0)$ the linearization of the function $\hdelbar_1(x) - g * \left(\sum_{i=1}^k t_i \cdot s_i(x)\right)$ projected to the fiber $(W_1)_x$ is surjective.

	We may cover the compact topological space $\cS(\delbar_2)$ by a finite collection of such neighborhoods $\abs{U'_i}$ of points $[x_i]\in \cS(\delbar_2)$; we may also cover $\cS(\delbar_1)$ by a finite collection of such neighborhoods $\abs{U_i}$ of points $[x_i]\in \cS(\delbar_1)$.
	It follows that the finite sum of $\ssc^+$-multisections
	\[
		\Lambda_2:= \bigoplus_i \Lambda'_i : \cW_2 \times B_\ep^N \to \Q^+
	\]
	has the property that: for any point $[x] \in \cZ_2$ with $\Lambda_2 \circ \delbar_2 ([x])>0$, and for any parametrized local section structure $\{s'_i\}_{i\in I}$ at a representative $x$, the linearization of the function $\hdelbar_2 (x) - s'_i(x,t)$ projected to the fiber $(W_2)_x$ is surjective.
	Likewise, the finite sum of $\ssc^+$-multisections
	\[
		\Lambda_1 := \bigoplus_i \Lambda_i = \bigoplus_i \Lambda'_i (\iota_\cW(\cdot),\cdot) : \cW_1 \times B_\ep^N \to \Q^+
	\]
	has the property that for any point $[x] \in \cZ_1$ which satisfies $\Lambda_1 \circ \delbar_1 ([x])>0$ and for any parametrized local section structure $\{s_i\}_{i\in I}$ at a representative $x$, the linearization of the function $\hdelbar_1 (x) - s_i(x,t)$ projected to the fiber $(W_1)_x$ is surjective. Observe moreover that the multisection sum commutes with composition and thus $\Lambda_1(\cdot,\cdot) = \Lambda_2 (\iota_\cW(\cdot),\cdot)$.

	Furthermore for $\ep$ sufficiently small, for any fixed $t_0 \in B_\ep^N$ the $\ssc^+$-multisection $\Lambda_2 (\cdot, t_0)$ is controlled by the pair $(N_2,\cU_2)$, i.e.,
	\begin{itemize}
		\item $N_2[\Lambda_2(\cdot,t_0)] \leq 1$,
		\item $\text{dom-supp}(\Lambda_2(\cdot,t_0)) \subset \cU_2$.
	\end{itemize}

	In contrast, $\Lambda_1(\cdot,t_0)$ will generally not be controlled by the pair $(N_1,\cU_1)$, as in general,
	\[
		\text{dom-supp}(\Lambda_1(\cdot,t_0)) = \iota_\cZ^{-1} (\text{dom-supp}(\Lambda_2(\cdot,t_0))) \nsubseteq \cU_1.
	\]

	\begin{step2}
		We show the thickened solution sets satisfy the hypotheses of Lemma~\ref{lem:invariance-of-domain-branched-orbifolds}, and are therefore homeomorphic.
	\end{step2}

	Consider the strong polyfold bundle $\cW_i \times B_\ep^N \to \cZ_i \times B_\ep^N$ for $i=1,2$, and let $\tdelbar_i : \cZ_i \times B_\ep^N \to \cW_i \times B_\ep^N$ denote the $\ssc$-smooth proper Fredholm section defined by $([z],t)\mapsto (\delbar_i([z]),t)$.
	By construction, $(\tdelbar_i, \Lambda_i)$ are transversal pairs; hence by Theorem~\ref{thm:transversality} the thickened solution sets
	\[
		\cS(\tdelbar_i, \Lambda_i) = \{ ([z],t) \in \cZ_i \times B_\ep^N \mid \Lambda_i (\tdelbar_i ([z],t)) >0 \} \subset \cZ_i\times B_\ep^N
	\]
	have the structure of weighted branched orbifolds.

	We now claim that these thickened solution sets satisfy the hypotheses of Lemma~\ref{lem:invariance-of-domain-branched-orbifolds}.
	Indeed, commutativity of the diagram \eqref{eq:commutative-diagram-naturality} together with the equation $\Lambda_1(\cdot,\cdot) = \Lambda_2 (\iota_\cW(\cdot),\cdot)$ imply that the injective continuous map $\tilde{\iota}_\cZ: \cZ_1 \times B_\ep^N \to \cZ_2 \times B_\ep^N; ([z],t)\mapsto (\iota_\cZ([z]),t)$ has a well-defined restriction to the thickened solution sets,
	\begin{equation}\label{eq:restriction-to-thickening}
		\tilde{\iota}_\cZ |_{\cS(\tdelbar_1, \Lambda_1)} : \cS(\tdelbar_1, \Lambda_1) \hookrightarrow \cS(\tdelbar_2, \Lambda_2).
	\end{equation}
	Moreover, at any $(x,t)\in S_1(\hdelbar_1,\hat{\Lambda}_1)$ which maps to $(y,t)\in S_2(\hdelbar_2,\hat{\Lambda}_2)$, the local section structure $(s_i)$ for $\hat{\Lambda}_1$ at $(x,t)$ is induced by the restrictions of the local section structure $(s'_i)$ for $\hat{\Lambda}_2$ at $(y,t)$. In particular, we have the following commutative diagram.
	\[\begin{tikzcd}[column sep = large]
			W_1\times B_\ep^N \arrow[r, "{(\hat{\iota}_\cW(\cdot),\cdot)}"', hook] \arrow[d, "\hdelbar_1 - s_i \quad "'] & W_2\times B_\ep^N \arrow[d, "\quad \hdelbar_2 - s'_i"] &  \\
			O_x\times B_\ep^N \arrow[r, "{(\hat{\iota}_\cZ(\cdot),\cdot)}"', hook] \arrow[u, bend left] & O_y\times B_\ep^N \arrow[u, bend right] &
		\end{tikzcd}\]
	As noted in Remark~\ref{rmk:relationship-local-section-structures-local-branching-structures}, the local section structures and the local branching structures are related via the equations $M_i= (\hdelbar_1 - s_i)^{-1}(0)$, $M'_i = (\hdelbar_2 - s'_i)^{-1}(0)$. Thus it follow from commutativity that we have the required well-defined restriction to the individual local branches.
	And now Lemma~\ref{lem:invariance-of-domain-branched-orbifolds} implies that the map \eqref{eq:restriction-to-thickening} is a local homeomorphism.

	Furthermore, we may observe that by our orientation assumptions the natural induced map $\tilde{\iota}_* : \det ( D(\hdelbar_1-s_i) (x) ) \to \det (D(\hdelbar_2-s'_i)(y) )$ is an orientation preserving isomorphism; hence the restriction $\tilde{\iota}_\cZ |_{M_i} : M_i \to M'_i$ is orientation preserving.

	We now show that \eqref{eq:restriction-to-thickening} is a bijection.
	Let $([y],t)\in \cS(\tdelbar_2,\Lambda_2)$, let $(y,t)$ be a representative of $([y],t)$, and consider a local section structure $(s'_i)$ for $\Lambda_2$ at $(y,t)$.
	It follows that $\hdelbar_2(y) - s'_i (y,t) = 0$ for some index $i$.
	Observe by construction, $s'_i$ is a finite sum of $\ssc^+$-sections with image contained in the intermediate subbundle $R$, and hence $s'_i(y,t)\in R$.
	It follows that $\hdelbar_2 (y)\in R$, hence property \ref{property-2-intermediary-subbundle} of the intermediate subbundle implies that $y\in \hat{\iota}_\cZ (Z_1)$. Therefore, there exists a point $[x]\in \cZ_1$ such that $\tilde{\iota}_\cZ ([x],t) = ([y],t)$. Commutativity of \eqref{eq:commutative-diagram-naturality} implies that $\Lambda_1(\tdelbar_1([x]),t) = \Lambda_2(\tdelbar_2([y],t)) >0$, and therefore $([x],t) \in \cS_1(\tdelbar_1, \Lambda_1)$.
	Thus, \eqref{eq:restriction-to-thickening} is a homeomorphism.

	\begin{step3}
		For a common regular value $t_0$ the branched integrals of the perturbed solution spaces of $\delbar_1$ and $\delbar_2$ are equal.
	\end{step3}

	By Sard's theorem, we can find a common regular value $t_0 \in B_\ep^N$ of the projections $\cS (\tdelbar_1, \Lambda_1) \to B_\ep^N$ and $\cS (\tdelbar_2,\Lambda_2) \to B_\ep^N$.
	For this common regular value, the perturbed solution sets
	\[
		\cS(\delbar_i, \Lambda_i (\cdot,t_0)) := \{	[z]\in \cZ_i \mid \delbar_i(\Lambda_i([z],t_0))>0	\} \subset \cZ_i
	\]
	have the structure of weighted branched suborbifolds.

	As we have already noted, $\Lambda_2(\cdot,t_0)$ is controlled by the pair $(N_2,\cU_2)$ and hence $\cS(\delbar_2, \Lambda_2 (\cdot,t_0))$ is a compact topological space.
	For such a common regular value, the homeomorphism \eqref{eq:restriction-to-thickening} has a well-defined restriction to these perturbed solution sets. This restriction is a homeomorphism, and hence $\cS(\delbar_1, \Lambda_1 (\cdot,t_0))$ is also a compact topological space (even though in general $\Lambda_1(\cdot,t_0)$ will not be controlled by the pair $(N_1,\cU_1)$).

	The restriction $\tilde{\iota}_\cZ |_{\cS(\delbar_1, \Lambda_1 (\cdot,t_0))}$ satisfies the necessary hypotheses for the change of variables theorem~\ref{thm:change-of-variables}.
	Therefore for a given $\ssc$-smooth differential form $\ww\in \Omega_\infty^* (\cZ_2)$ we have
	\begin{equation}
		\label{eq:change-variables}
		\int_{\cS(\delbar_2, \Lambda_2 (\cdot,t_0))} \ww
		= \int_{\cS(\delbar_1, \Lambda_1 (\cdot,t_0))} \tilde{\iota}_\cZ^* \ww.
	\end{equation}
	However, since in general $\Lambda_1(\cdot,t_0)$ is not controlled by a pair, we cannot assume that it is a regular perturbation in the sense of Definition~\ref{def:regular-perturbation}.
	This is problematic since Theorem~\ref{thm:cobordism-between-regular-perturbations} only implies the existence of a compact cobordism between the perturbed solution spaces of two perturbations which are both assumed to be regular perturbations (see Figure~\ref{fig:cobordism}).

	\begin{figure}[ht]
		\centering
		\includegraphics{cobordism.eps}
		\caption{Compact cobordism between regular perturbations}\label{fig:cobordism}
	\end{figure}

	\begin{step4}
		We show that the set
		\[
			\cS(\tdelbar_1, \Lambda_1 (\cdot,st_0)) = \{	([z],s) \in \cZ_1\times [0,1]	\mid	\Lambda_1(\delbar_1(z),s t_0)>0	\}
		\]
		is compact.
	\end{step4}


	Let $\delta = \abs{t_0}$.
	The auxiliary norm $\tilde{N}_2 : \cW_2[1] \times \overline{B_{\delta}^N} \to [0,\infty)$ defined by $\tilde{N}_2 ([w],t) := N_2([w])$ together with the open set $\tilde{\cU}_2 := \cU_2 \times \overline{B_{\delta}^N}$ together control the compactness of the extended $\ssc$-smooth Fredholm section $\tdelbar_2$.
	By construction, $\Lambda_2$ is controlled by this pair and hence by Theorem~\ref{thm:compactness} the thickened solution set $\cS(\tdelbar_2, \Lambda_2(\cdot, t); t\in \overline{B_\delta ^N})$ is a compact topological space.
	Therefore, the closed subset $\cS(\tdelbar_2, \Lambda_2(\cdot, t) ; t = s \cdot t_0, s\in[0,1])$ is also compact.

	The restriction of \eqref{eq:restriction-to-thickening} yields a homeomorphism
	\[
		\cS(\tdelbar_1, \Lambda_1(\cdot, t) ; t = s \cdot t_0, s\in[0,1]) \to \cS(\tdelbar_2, \Lambda_2(\cdot, t) ; t = s \cdot t_0, s\in[0,1]).
	\]
	From this it is now clear that
	\[
		\cS(\tdelbar_1, \Lambda_1 (\cdot,st_0)) \simeq \cS(\tdelbar_1, \Lambda_1(\cdot, t) ; t = s \cdot t_0, s\in[0,1])
	\]
	is a compact topological space.

	\begin{step5}
		We interpret the pair $(\delbar_1,\Lambda_1(\cdot,t_0))$ as a transversal Fredholm multisection, and use Proposition~\ref{prop:cobordism-multisection-regular} to obtain a compact cobordism to a regular perturbation.
	\end{step5}

	We claim that the hypotheses described in \S\ref{subsubsec:cobordism-multisection-regular} are satisfied.
	In particular, we must show that the extended Fredholm multisection $(\tdelbar_1, \tilde{\Lambda}_1 (\cdot,t_0))$ is proper.
	This can be seen using step 4; indeed, the solution set $\cS(\tdelbar_1, \tilde{\Lambda}_1 (\cdot,t_0))$ described in \S\ref{subsubsec:cobordism-multisection-regular} can be identified with the compact set $\cS(\tdelbar_1, \Lambda_1 (\cdot,st_0))$.

	We may therefore use Proposition~\ref{prop:cobordism-multisection-regular} to obtain a cobordism from $(\delbar_1,\Lambda_1(\cdot,t_0))$ to a regular perturbation $\Gamma_0: \cW_1 \to \Q^+$ of $\delbar_1$.
	Given a closed $\ssc$-smooth differential form $\ww\in \Omega_\infty^* (\cZ_1)$, Stokes' theorem~\ref{thm:stokes} then implies
	\begin{equation}
		\label{eq:step-5-cobordism-stokes}
		\int_{\cS(\delbar_1,\Gamma_0)}	\ww =\int_{\cS(\delbar_1,\Lambda_1(\cdot,t_0))} \ww.
	\end{equation}

	\begin{step6}
		We show that the polyfold invariants are equal.
	\end{step6}

	Let $\ww\in H^*_{\dR} (O)$ be the de Rahm cohomology class fixed in the statement of the theorem, and used to define the polyfold invariants.
	We can now compute relate the branched integrals as follows:
	\begin{align*}
		\int_{\cS(\delbar_2,\Lambda_2(\cdot,t_0))} f_2^* \ww
		 & =	\int_{\cS(\delbar_1, \Lambda_1 (\cdot,t_0))} \tilde{\iota}_\cZ^* f_2^*\ww \\
		 & =	\int_{\cS(\delbar_1, \Lambda_1 (\cdot,t_0))} f_1^*\ww                     \\
		 & =	\int_{\cS(\delbar_1,\Gamma_0)}	f_1^*\ww,
	\end{align*}
	where the first equality follows from equation \eqref{eq:change-variables}, the second equality follows from the commutativity of \eqref{eq:gw-invariant-pair-of-polyfolds}, and the third equality follows from equation \eqref{eq:step-5-cobordism-stokes}.
	By construction, $\Lambda_2(\cdot,t_0)$ is a regular perturbation of $\delbar_2$, while $\Gamma_0$ is a regular perturbation of $\delbar_1$.
	This proves the theorem.
\end{proof}

\subsection{Gromov--Witten invariants are independent of choice of sequence \texorpdfstring{$\delta_i$}{i}}\label{subsec:independence-sequence}

We now use Theorem~\ref{thm:naturality} to show that the Gromov--Witten polyfold invariants are independent of the choice of increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$.
Given two sequences $(\delta_i)\subset (0,2\pi)$ and $(\delta_i')\subset (0,2\pi)$ we can always find a third sequence $(\delta_i'')\subset (0,2\pi)$ which satisfies
\[
	\delta_i \leq \delta_i'', \qquad \delta_i' \leq \delta_i''
\]
for all $i$.  The GW-polyfold associated to the sequence $(\delta_i'')$ give a refinement of the GW-polyfolds associated to $(\delta_i)$ and $(\delta_i')$, in the sense that there are inclusion maps
\[
	\cZ_{A,g,k}^{3,\delta'_0} \hookleftarrow \cZ_{A,g,k}^{3,\delta''_0} \hookrightarrow \cZ_{A,g,k}^{3,\delta_0}.
\]
It is therefore sufficient to consider inclusion maps of the form
$\cZ^{3,\delta_0}_{A,g,k} \hookrightarrow \cZ^{3,\delta_0'}_{A,g,k}$
with $\delta_i' \leq \delta_i$ for all $i$ and demonstrate that the associated GW-invariants are equal.

To this end, consider the commutative diagram:
\[\begin{tikzcd}
		\cW^{2,\delta_0}_{A,g,k} \arrow[r, "\iota_\cW"', hook] \arrow[d, "\delbarj\quad "'] & \cW^{2,\delta_0'}_{A,g,k} \arrow[d, "\quad \delbarj'"] &  \\
		\cZ^{3,\delta_0}_{A,g,k} \arrow[r, "\iota_\cZ"', hook] \arrow[u, bend left] & \cZ^{3,\delta_0'}_{A,g,k} \arrow[u, bend right] &
	\end{tikzcd}\]
and observe that it satisfies the same properties as \eqref{eq:commutative-diagram-naturality}.
In addition, consider the commutative diagram:
\[\begin{tikzcd}
		&  & M^k\times \dmlog_{g,k} \\
		\cZ^{3,\delta_0}_{A,g,k} \arrow[r, "\iota_\cZ"', hook] \arrow[rru, "ev_i \times \pi"] & \cZ^{3,\delta_0'}_{A,g,k} \arrow[ru, "ev_i\times \pi"'] &
	\end{tikzcd}\]
which satisfies the same properties as \eqref{eq:gw-invariant-pair-of-polyfolds}.

Note that if $\delta_0' < \delta_0$ the inclusion map $\iota_\cZ$ is not proper.
To see this, exploit the difference in exponential weights to produce a sequence which converges in a local M-polyfold model for $\cZ^{3,\delta_0}_{A,g,k}$ but diverges in a local M-polyfold model for $\cZ^{3,\delta_0'}_{A,g,k}$.
Note also that the pullback strong polyfold bundle is not the same as the standard strong polyfold bundle on $\cZ^{3,\delta_0}_{A,g,k}$.

\begin{proposition}\label{prop:existence-subbundle-naturality}
	The set
	\[
		\cR := \{	[\Sigma,j,M,D,u,\xi] \in \cW^{2,\de_0'}_{A,g,k} \mid \supp \xi \subset K \subset \Sigma\setminus\abs{D} \text{ for some compact } K	\}
	\]
	is an intermediary subbundle of the strong polyfold bundle $\cW^{2,\de_0'}_{A,g,k}$.
\end{proposition}
\begin{proof}
	We must show that the set $\cR$ satisfies the properties of Definition~\ref{def:intermediate-subbundle}.
	The first two properties can be easily checked.

	We show how to construct the $\ssc^+$-sections required by property \ref{property-3-intermediary-subbundle}.
	Consider a stable curve $[\alpha]=[\Sigma,j,M,D,u] \in \cS(\delbarj') \subset \cZ^{3,\de_0'}_{A,g,k}$ and let let $\alpha = (\Sigma,j,M,D,u)$ be a stable map representative.
	Let $V_\alpha \subset U_\alpha$ be a $\bm{G}(\alpha)$-invariant M-polyfold charts centered at $\alpha$ such that $\overline{V_\alpha}\subset U_\alpha$.
	This means we have good uniformizing family
	\[
		(a,v,\eta ) \mapsto (\Sigma_{a},j(a,v),M_{a},D_{a}, \oplus_{a} \exp_u (\eta)),\qquad (a,v,\eta) \in O_\alpha.
	\]
	Let $K\to O_\alpha$ be a local strong bundle model, with $\ssc$-coordinates given by $(a,v,\eta,\xi)$ where $\xi \in H^{2,\de_0'}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)$.

	Use Corollary~\ref{cor:vectors-which-span-cokernel} to choose vectors $v_1,\ldots, v_k$ which vanish on disk-like regions of the nodal points and such that
	\begin{itemize}
		\item $\text{span}\{v_1,\ldots , v_k\} \oplus \text{Im}(D\hdelbarj'(\alpha)) = H^{2,\de_0'}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)$,
		\item $\text{span}\{v_1,\ldots , v_k\} \oplus \text{Im}(D\hdelbarj(\alpha)) = H^{2,\de_0}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)$.
	\end{itemize}

	Let $\beta: U_\alpha \to [0,1]$ be an $\ssc$-smooth cutoff function which satisfies $\beta\equiv 1$ near $(0,0,0)$, and $\beta \equiv 0$ on $U_\alpha\setminus V_\alpha$.
	In these local $\ssc$-coordinates, the desired $\ssc^+$-sections are defined as follows:
	\[
		s_i': U_\alpha\to K,\qquad (a,v,\eta) \mapsto (a,v,\eta, \beta(a,v,\eta) \cdot ( \rho_{a} (v_i)		)),
	\]
	where $\rho_{a}$ is the strong bundle projection defined using the hat gluings, see \cite[p.~117]{HWZbook} and \cite[pp.~65--67]{HWZGW}

	Let $(N,\cU)$ be a pair which controls the compactness of $\delbarj'$.
	By construction, these $\ssc^+$-sections satisfy $N[s_i'] \leq C$ for some constant $C\leq \infty$, and hence by rescaling the vectors $v_i$ we may assume that $N[s_i'] \leq 1$. Moreover, by shrinking the support of the cutoff function we may assume that $\abs{\supp s_i'} = \abs{\supp \beta } \subset \cU$.

	By construction, the $\ssc^+$-section $s_i'$ induces a well-defined restriction $s_i|_{\hat{\iota}_\cZ^{-1} (U_\alpha)}$. Locally this restriction is given by multiplying the $\ssc$-smooth cutoff $\beta \circ \hat{\iota}_\cZ$ and the locally constant vector $v_i$, hence it is $\ssc^+$.
\end{proof}

Having shown the previous proposition, we may immediately apply Theorem~\ref{thm:naturality} to see that
the polyfold Gromov--Witten invariants do not depend on the choice of an increasing sequence $(\delta_i)_{i\geq 0} \allowbreak \subset (0,2\pi)$.
This proves Corollary~\ref{cor:naturality-polyfold-gw-invariants}.

\subsection[Gromov-Witten invariants are independent of punctures at marked points]{Gromov--Witten invariants are independent of punctures at marked points}\label{subsec:independence-punctures}

We now recall the regularity estimates that the stable curves of the Gromov--Witten polyfolds as constructed in \cite{HWZGW} are required to satisfy.
Let $u: \Sigma \to M$ be a continuous map, and fix a point $z\in \Sigma$.
We consider a local expression for $u$ as follows. Choose a small disk-like neighborhood $D_z\subset \Sigma$ of $z$ such that there exists a biholomorphism $ \sigma:[0,\infty)\times S^1\rightarrow D_z \setminus\{z\}$.
Let $\varphi:U\rightarrow \R^{2n}$ be a smooth chart on a neighborhood $U \subset M$ of $u(z)$ such that to $\varphi (u(z))=0$.
The local expression
\[
	\tilde{u}: [s_0,\infty)\times S^1 \to \R^{2n}, \qquad (s,t) \mapsto \varphi\circ u\circ \sigma(s,t)
\]
is defined for $s_0$ large.
Let $m\geq 3$ be an integer, and let $\delta >0$. We say that $u$ is of \textbf{class $H^{m,\delta}$ around the point $z\in \Sigma$} %
if $e^{\delta s}  \tilde{u}$ belongs to the space $L^2([s_0,\infty)\times S^1,\R^{2n})$.
We say that $u$ is of \textbf{class} $H^m_{\text{loc}}$ \textbf{around the point $z\in \Sigma$} if $u$ belongs to the space $H^m_{\text{loc}}(D_z)$.
If $u$ is of class $H^{m,\delta}$ at a point $z\in \Sigma$ we will refer to that point as a \textbf{puncture}.

By definition, any stable map representative $(\Sigma,j,M,D,u)$ of a stable curve in the Gromov--Witten polyfold $\cZ_{A,g,k}$ is required to be of class $H^{3,\de_0}$ at all nodal points.
This is required in order to carry out the gluing construction at the nodes of \cite[\S2.4]{HWZGW}.

However, in some situations we would like to treat the marked points in the same way as the nodal points.
Note that allowing a puncture with exponential decay at a specified marked point is a global condition on a Gromov--Witten polyfold.
Hence, we will need to require that the map $u$ is of class $H^{3,\delta_0}$ at a fixed subset of the marked points (in addition to the nodal points).

Given a subset $I \subset \{1,\ldots,k\}$ we can define a GW-polyfold $\cZ^I_{A,g,k}$ where we require that all stable map representatives are of class $H^{3,\delta_0}$ at the marked points $z_i$ for all $i\in I$ and of class $H^3_\text{loc}$ at the remaining marked points.
Given another subset $J \subset\{1,\ldots,k\}$ we can define a GW-polyfold $\cZ^J_{A,g,k}$ in the same manner.
On the other hand, we can consider a GW-polyfold $\cY_{A,g,k}$ where we require that all stable map representatives are of class $H^{3,\delta_0}$ and also of class $H^3_\text{loc}$ at all the marked points.
Such a GW-polyfold with strict regularity at all marked points gives a refinement of the GW-polyfolds with different choices of punctures $I,J\subset \{1,\ldots,k\}$ at the marked points, in the sense that there are inclusion maps
\[
	\cZ^I_{A,g,k} \hookleftarrow \cY_{A,g,k} \hookrightarrow \cZ^J_{A,g,k}.
\]
It is sufficient to consider inclusion maps of the form $\cY_{A,g,k} \hookrightarrow \cZ^I_{A,g,k}$ and demonstrate that the associated GW-invariants are equal.

To this end, consider the commutative diagram:
\[\begin{tikzcd}
		\cV_{A,g,k} \arrow[r, "\iota_\cW"', hook] \arrow[d, "\delbarj\quad "'] & \cW^I_{A,g,k} \arrow[d, "\quad \delbarj"] &  \\
		\cY_{A,g,k} \arrow[r, "\iota_\cZ"', hook] \arrow[u, bend left] & \cZ^I_{A,g,k} \arrow[u, bend right] &
	\end{tikzcd}\]
and observe that it satisfies the same properties as \eqref{eq:commutative-diagram-naturality}.
In addition, consider the commutative diagram:
\[\begin{tikzcd}
		&  & M^k\times \dmlog_{g,k} \\
		\cY_{A,g,k} \arrow[r, "\iota_\cZ"', hook] \arrow[rru, "ev_i \times \pi"] & \cZ^I_{A,g,k} \arrow[ru, "ev_i\times \pi"'] &
	\end{tikzcd}\]
which satisfies the same properties as \eqref{eq:gw-invariant-pair-of-polyfolds}.

There exist sequences of maps which converge in $H^3_\text{loc}$ but do not converge in $H^{3,\delta_0}$.  Consequently, in general the above inclusion map is not proper.  Furthermore, the pullback strong polyfold bundle is not the same as the standard strong polyfold bundle on $\cY_{A,g,k}$.

\begin{proposition}
	The set
	\[
		\cR := \{	[\Sigma,j,M,D,u,\xi] \in \cW^I_{A,g,k} \mid \supp \xi \subset K \subset \Sigma\setminus M \text{ for some compact } K	\}
	\]
	is an intermediary subbundle of the strong polyfold bundle $\cW^I_{A,g,k}$.
\end{proposition}
\begin{proof}
	The proof is identical to the proof of Proposition~\ref{prop:existence-subbundle-naturality}, except here we use Corollary~\ref{cor:vectors-which-span-cokernel} to choose vectors $v_i$ which vanish on disk-like regions of the marked points instead of the nodal points.
\end{proof}

Again, combining the previous proposition and Theorem~\ref{thm:naturality} we see that the polyfold Gromov--Witten invariants do not depend on the choice of puncture at the marked points.
This proves Corollary~\ref{cor:punctures-equal}.


\section{Pulling back abstract perturbations}\label{sec:pulling-back-abstract-perturbations}

In this section we show how to construct a regular perturbation which pulls back to a regular perturbation, culminating in Theorem~\ref{thm:compatible-pullbacks} and in Corollary~\ref{cor:pullback-via-permutation}.

\subsection{Pullbacks of strong polyfold bundles}\label{subsec:pullbacks-strong-polyfold-bundles}

Let $P: \cW \to \cZ$ be a strong polyfold bundle, and let $f: \cY \to \cZ$ be a $\ssc$-smooth map between polyfolds.
Consider the topological pullback
\[f^* \cW = \{([x],[w]_{[y]})	\mid f([x])=[y]=P([w]_{[y]})	\} \subset \cY \times \cW\]
equipped with the subspace topology. Since $\cY$ and $\cW$ are second countable, paracompact, Hausdorff topological spaces, so too is the product $\cY \times \cW$ and hence $f^*\cW$ is also a second countable, paracompact, Hausdorff topological spaces.

We can take the pullback $\hat{f}^* W$ of the object strong M-polyfold bundle; by Proposition~\ref{prop:pullback-bundle} this has the structure of a strong M-polyfold bundle over the object space $Y$.
The fiber product
\[\bm{Y} _s \times_{\text{proj}_1} \hat{f}^* W = \{	(\phi,y,w_x) \mid s(\phi) = y, \hat{f}(y)=x	\}\]
may be viewed as the strong M-polyfold bundle via the source map $s$ over the morphism space $\bm{Y}$,
\[\begin{tikzcd}
		\bm{Y} _s \times_{\text{proj}_1} \hat{f}^* W \arrow[d] \arrow[r] & \hat{f}^* W \arrow[d] &  \\
		\bm{Y} \arrow[r, "s"'] & Y &
	\end{tikzcd}\]

We may define a \textbf{pullback strong polyfold bundle structure} over the polyfold structure $(Y,\bm{Y})$ as the strong M-polyfold bundle $\text{proj}_1 : \hat{f}^*W \to Y$ together with the bundle map defined as follows:
\begin{align*}
	\lambda: \bm{Y} _s \times_{\text{proj}_1} \hat{f}^* W & \to \hat{f}^*W                       \\
	(\phi,y,w_x)                                          & \mapsto (t(\phi), \mu(f(\phi), w_x))
\end{align*}
It is straightforward to check that this map satisfies the requirements of Definition~\ref{def:strong-polyfold-bundle}.

Given a $\ssc$-smooth section $\delbar:\cZ\to \cW$ there exists a well-defined \textbf{pullback section} $f^*\delbar:\cY \to f^*\cW$.  Between the underlying sets, it is defined by
\[
	f^*\delbar ([x]) = ([x], \delbar \circ f ([x]) ).
\]
It is automatically regularizing if $\delbar$ is regularizing.
We may define the pullback of a $\ssc^+$-multisection as follows.

\begin{definition}\label{def:pullback-multisection}
	Given a $\ssc^+$-multisection $\Lambda:\cW\to \Q^+$ there exists a well-defined \textbf{pullback $\ssc^+$-multisection} $\text{proj}_2^*\Lambda :f^*\cW \to \Q^+$.
	It consists of the following:
	\begin{enumerate}
		\item the function $\Lambda \circ \text{proj}_2 :f^*\cW\to\Q^+$
		\item the functor $\hat{\Lambda} \circ \text{proj}_2 :\hat{f}^* W\to \Q^+$
		\item at each $[x]\in \cZ_1$ there exists a ``pullback local section structure'' for $\text{proj}_2^*\Lambda$, defined below.
	\end{enumerate}
\end{definition}

Given $[x]\in\cZ_1$, the local section structure for $\text{proj}_2^*\Lambda$ at $[x]$ is described as follows.
Let $x\in Z_1$ be a representative of $[x]$.
Let $y:=\hat{f}(x)\in Z_2$, and let $U_y\subset Z_2$ be a $\bm{G}(y)$-invariant open neighborhood of $y$, and let
$s_1,\ldots,s_k : U_y \to W$ be a local section structure for $\hat{\Lambda}$ at $y$ with associated weights $\sigma_1,\ldots ,\sigma_k$.
Let $U_x\subset Z_1$ be a $\bm{G}(x)$-invariant open neighborhood of $x$ such that $\hat{f}(U_x)\subset U_y$, and consider the restricted strong M-polyfold bundle $(\hat{f}^*W)|_{U_x} \to U_x$.
Then the pullback of the local sections $\hat{f}^*s_1,\ldots,\hat{f}^*s_k :U_x \to \hat{f}^* W$ with the associated weights $\sigma_1,\ldots ,\sigma_k$ gives the local section structure for $\text{proj}_2^*\Lambda$ at $[x]$.

Indeed, it tautologically follows from the original assumption that $s_1,\ldots,s_k$, $\sigma_1,\ldots,\sigma_k$ is a local section structure for $\Lambda$ at $[y]$ that
\begin{enumerate}
	\item $\sum_{i=1}^k \sigma_i =1$
	\item the local expression $\text{proj}_2^* \hat{\Lambda}:\hat{f}^*W|_{U_x}\to \Q^+$ is related to the local sections and weights via the equation
	      \[
		      \text{proj}_2^* \hat{\Lambda} (x',w_{y'}) = \sum_{\{i\in \{1,\ldots, k \} \mid (x',w_{y'}) = \hat{f}^*s_i (\text{proj}_1 (x',w_{y'} ) )\}} \sigma_i
	      \]
	      for all $(x',w_{y'}) \in (\hat{f}^* W)|_{U_x}$ (which necessarily satisfy $\hat{f}(x')= y' = P(w_{y'})$).
\end{enumerate}

\subsection{The topological pullback condition and pullbacks of pairs which control compactness}\label{subsec:topological-pullback-condition-controlling-compactness}

Suppose at the outset that we have a $\ssc$-smooth map $f: \cY \to \cZ$ and a strong polyfold bundle $P:\cW \to \cZ$ with a $\ssc$-smooth proper Fredholm section $\delbar$.
Consider the pullback of this bundle and of this section via the map $f$ yielding the following commutative diagram:
\[\begin{tikzcd}
		f^* \cW \arrow[d, "f^* \delbar\quad"'] \arrow[r, "\text{proj}_2"'] & \cW \arrow[d, "\quad \delbar"] &  \\
		\cY \arrow[r, "f"'] \arrow[u, bend left] & \cZ. \arrow[u, bend right] &
	\end{tikzcd}\]
Assume that the $\ssc$-smooth section $f^*\delbar$ is a proper Fredholm section; such an assumption is not automatic from the above setup, however it is natural in the context of polyfold maps one might encounter.\footnote{An alternative to outright assuming that $f^*\delbar$ is a Fredholm section would be to formulate a precise notion of a ``Fredholm map'' for a map between polyfolds, and then require that $f$ is such a map. This would also be natural in the context of polyfold maps one might encounter.}

Given a pair $(N,\cU)$ which controls the compactness of $\delbar$ we show in this subsection how to obtain a pullback of this pair, which will control the compactness of $f^*\delbar$.

\begin{proposition}
	Let $N :\cW[1] \to [0,\infty)$ be an auxiliary norm. The pullback of $N$, given by
	\[
		\text{proj}_2^* N : f^* \cW[1] \to [0,\infty)
	\]
	defines an auxiliary norm on the pullback strong polyfold bundle $f^* \cW\to \cY$.
\end{proposition}
\begin{proof}
	This is immediate from the definitions.  In particular, property \ref{property-2-auxiliary-norm} of Definition~\ref{def:auxiliary-norm} can be checked as follows.  Let $(x_k, w_k)$ be a sequence in $\hat{f}^* W[1]$, such that $x_k$ converges to $x$ in $Y$, and suppose $\text{proj}_2^* \hat{N} (x_k, w_k) \to 0$.  Then $w_k$ is a sequence in $W[1]$ such that $\hat{f}(x_k)$ converges to $\hat{f}(x)$ in $Z$, and $\hat{N} (w_k) = \text{proj}_2^* \hat{N} (x_k, w_k) \to 0$, and hence $w_k\to 0_{\hat{f}(x)}$.  Thus $(x_k,w_k)\to (x,0_{\hat{f}(x)})$, as required.
\end{proof}

\begin{definition}\label{topological-pullback-condition}
	We say that $f$ satisfies the \textbf{topological pullback condition} if for all $[y] \in \cS(\delbar)\subset \cZ$ and for any open neighborhood $\cV \subset \cY$ of the fiber $f^{-1} ([y])$ there exists an open neighborhood $\cU_{[y]}\subset \cZ$ of $[y]$ such that $f^{-1} (\cU_{[y]}) \subset \cV$.
	Note that if $f^{-1} ([y])=\emptyset$, this implies that there exists an open neighborhood $\cU_{[y]}$ of $[y]$ such that $f^{-1} (\cU_{[y]})=\emptyset$.
\end{definition}

\begin{proposition}\label{prop:simultaneous-compactness}
	Suppose that the map $f:\cY \to \cZ$ satisfies the topological pullback condition.
	Then there exists a pair $(N,\cU)$ which controls the compactness of $\delbar$ such that the pair $(\text{proj}_2^* N, f^{-1} (\cU) )$ controls the compactness of $f^* \delbar$.

	Furthermore, if a $\ssc^+$-multisection $\Lambda: \cW\to \Q^+$ satisfies $N [\Lambda ] \leq 1$ and $\text{dom-supp} (\Lambda) \subset \cU$, then its pullback $\text{proj}_2^* \Lambda :f^*\cW \to \Q^+$ satisfies $\text{proj}_2^* N [\text{proj}_2^* \Lambda ] \leq 1$ and $\text{dom-supp} (\text{proj}_2^* \Lambda) \allowbreak \subset \allowbreak f^{-1} (\cU)$.
\end{proposition}
\begin{proof}
	Let $(N, \cV)$ be a pair which controls the compactness of $\delbar$.
	By the previous proposition we know that the pullback $\text{proj}_2^* N :f^* \cW[1]\to [0,\infty)$ is an auxiliary norm.
	We may then apply \cite[Prop.~4.5]{HWZ3} to assert the existence of a neighborhood $\cU'\subset \cY$ of $\cS(f^*\delbar)$ such that the pair $(\text{proj}_2^* N, \cU')$ controls the compactness of $f^*\delbar$.

	At every $[y] \in \cS(\delbar)$, observe that $f^{-1} ([y]) \subset \cS(f^*\delbar) \subset \cU'$.  We can use the topological pullback condition to choose a neighborhood $\cU_{[y]}$ of $[y]$ such that $f^{-1} (\cU_{[y]}) \subset \cU'\subset \cY$ and moreover such that $\cU_{[y]} \subset \cV\subset \cZ$.  %
	We define an open neighborhood by $\cU := \cup_i \ \cU_{[y]_i}$ for every $[y]_i\in \cS(\delbar)$.

	Then $(N,\cU)$ is the desired pair.
	Indeed, $\cU$ is an open neighborhood of the unperturbed solution set $\cS(\delbar)$.
	And $\cU\subset \cV$ since for every $[y]_i$ we have $\cU_{[y]_i}\subset \cV$.  Hence we have $\cS(\delbar) \subset \cU\subset \cV$ therefore it follows from Remark~\ref{rmk:shrink-neighborhood} that $(N,\cU)$ controls the compactness of $\delbar$.

	Observe that $\cS(f^*\delbar) = f^{-1} (\cS(\delbar)) \subset f^{-1}(\cU)$.  By the construction of $\cU$ we have $f^{-1} (\cU) \subset \cU'$.  Hence we have $\cS(f^*\delbar) \subset f^{-1}(\cU) \subset \cU'$ therefore it follows from Remark~\ref{rmk:shrink-neighborhood} that $(\text{proj}_2^* N, f^{-1} (\cU))$ controls the compactness of $f^* \delbar$.

	Finally, the claim regarding the pullback of a $\ssc^+$-multisection is immediate from the construction.
\end{proof}

\subsection{Construction of regular perturbations which pullback to regular perturbations}\label{subsec:construction-regular-perturbation-which-pullback}

With the same assumptions and setup as in the previous subsection (i.e., our map satisfies the topological pullback condition), we show in this subsection how to construct regular perturbations which will pullback to regular perturbations

\begin{theorem}\label{thm:compatible-pullbacks}
	We can construct a regular perturbation $\Lambda: \cW \to \Q^+$ which pulls back to a regular perturbation $\text{proj}_2^* \Lambda$. This means that the perturbations satisfy the following conditions:
	\begin{enumerate}
		\item $(\delbar, \Lambda)$ and $(f^* \delbar, \text{proj}_2^* \Lambda)$ are both transversal pairs.
		\item There exists a pair $(N,\cU)$ which controls the compactness of $\delbar$ such that the pair $(\text{proj}_2^* N, f^{-1} (\cU) )$ controls the compactness of $f^* \delbar$. Then:
		      \begin{itemize}
			      \item $N [\Lambda ] \leq 1$ and $\text{dom-supp} (\Lambda) \subset \cU$
			      \item $\text{proj}_2^* N [\text{proj}_2^* \Lambda ] \leq 1$ and $\text{dom-supp} (\text{proj}_2^* \Lambda) \subset f^{-1} (\cU)$.
		      \end{itemize}
	\end{enumerate}
\end{theorem}
\begin{proof}

	We now give an explicit construction of a $\ssc^+$-multisection $\Lambda : \cW \to \Q^+$ such that $(\delbar, \Lambda)$ and $(f^* \delbar, \text{proj}_2^* \Lambda)$ are both transversal pairs.  Our approach is based on the general position argument of \cite[Thm.~15.4]{HWZbook}.

	\begin{step1}
		We may construct local $\ssc^+$-multisection $\Lambda_0 : \cW \to \Q^+$ which will be transversal at a  given point $[y_0] \in \cS(\delbar) \subset \cZ$.
	\end{step1}

	Let $U(y_0) \subset Z$ be a $\bm{G}(y_0)$-invariant open neighborhood of $y_0$ and moreover let $V(y_0)\subset U(y_0)$ be a $\bm{G}(y_0)$-invariant open neighborhood of $y_0$ such that $\overline{V(y_0)} \subset U(y_0)$.

	Choose smooth vectors $v_1,\ldots, v_k \in W_{y_0}$ such that
	\[
		\text{span} \{v_1,\ldots,v_k \} \oplus D\hdelbar_{y_0} (T_{y_0} Z) = W_{y_0}.
	\]

	For each smooth vector $v_1,\ldots, v_k$ we can use \cite[Lem.~5.3]{HWZbook} to define $\ssc^+$-sections $s_i : U(y_0) \to W$ such that
	\begin{itemize}
		\item $s_i= 0$ on $U(y_0)\setminus V(y_0)$,
		\item $s_i(y_0) = v_i$.
	\end{itemize}
	Furthermore, to ensure that the resulting multisection will be controlled by the pair $(N,\cU)$ we require that
	\begin{itemize}
		\item $N[s_i] \leq 1$,
		\item $\text{supp}(s_i)\subset \cU$.
	\end{itemize}

	We may use these locally constructed $\ssc^+$-sections to define a $\ssc^+$-multisection functor
	\[\hat{\Lambda}'_0:W \times B_\ep^k \to \Q^+\]
	with local section structure given by
	$\left\lbrace g * \left(\sum_{i=1}^k t_i \cdot s_i\right)\right\rbrace_{g\in \bm{G}(y_0)}$
	which satisfies the following.
	There exists a $\bm{G}(y_0)$-invariant open neighborhood $y_0 \subset U'_0 \subset Z$ such that at any object $y\in U'_0$ and for any $g\in \bm{G}(y_0)$ the linearization of the function
	\begin{align*}
		U'_0 \times B_\ep^k & \to W                                                                \\
		(y, t_1,\ldots,t_k) & \mapsto \hdelbar(y) - g * \left(\sum_{i=1}^k t_i \cdot s_i(y)\right)
	\end{align*}
	projected to the fiber $W_y$ is surjective.

	We now construct a $\ssc^+$-multisection whose pullback $\text{proj}_2^* \Lambda_0 : f^*\cW \to \Q^+$ will be transversal at a point $[x_0] \in \cS(f^*\delbar) \subset \cY$.
	Consider a point $[x_0]\in \cS(f^*\delbar) \subset \cY$ which maps to $[y_0]:=f([x_0])\in \cS(\delbar)\subset \cZ$.
	Let $x_0\in S(\hat{f}^*\hdelbar)$ be a representative of $[x_0]$, and let $U(x_0) \subset Y$ be a $\bm{G}(x_0)$-invariant open neighborhood of $x_0$.
	Then $y_0:= \hat{f}(x_0) \in S(\hdelbar)$ is a representative of $[y_0]$.
	Let $U(y_0) \subset Z$ be a $\bm{G}(y_0)$-invariant open neighborhood of $y_0$ and moreover let $V(y_0)\subset U(y_0)$ be a $\bm{G}(y_0)$-invariant open neighborhood of $y_0$ such that $\overline{V(y_0)} \subset U(y_0)$.
	By shrinking the open set $U(x_0)$, we may assume that the local expression $\hat{f}: U(x_0)\to U(y_0)$ is well-defined.

	The fibers $(\hat{f}^*W)_{x_0}$ and $W_{y_0}$ may be identified via $\text{proj}_2$.
	Choose smooth vectors $v_1,\ldots, v_k \in W_{y_0}$ such that
	\[\text{span} \{\text{proj}_2^{-1} (v_1),\ldots,\text{proj}_2^{-1} (v_k) \} \oplus D\hat{f}^*\hdelbar_{x_0} (T_{x_0} Y) = (\hat{f}^*W)_{x_0}.\]

	For each smooth vector $v_1,\ldots, v_k$ we may use \cite[Lem.~5.3]{HWZbook} to define $\ssc^+$-sections $s_i : U(y_0) \to W$ such that
	\begin{itemize}
		\item $s_i\equiv 0$ on $U(y_0)\setminus V(y_0)$,
		\item $s_i(y_0) = v_i$.
	\end{itemize}
	Furthermore, to ensure that the resulting multisection will be controlled by the pair $(N,\cU)$ we require that
	\begin{itemize}
		\item $N[s_i] \leq 1$,
		\item $\text{supp}(s_i)\subset \cU$.
	\end{itemize}

	We may use these locally defined $\ssc^+$-sections to define a $\ssc^+$-multisection functor $\hat{\Lambda}_0:	W \times B_\ep^k \to \Q^+$
	with local section structure given as follows.
	\[\left\lbrace g * \left(\sum_{i=1}^k t_i \cdot s_i\right)\right\rbrace_{g\in \bm{G}(y_0)}\]
	By construction, the pullback $\ssc^+$-multisection functor
	$\text{proj}_2^* \hat{\Lambda}_0:	\hat{f}^* W \times B_\ep^k \to \Q^+$
	has local section structure given as follows.
	\[\left\lbrace \hat{f}^* \left(g * \left(\sum_{i=1}^k t_i \cdot s_i\right)\right) \right\rbrace_{g\in \bm{G}(y_0)}\]
	It may be observed that there exists a $\bm{G}(x_0)$-invariant open neighborhood $x_0 \subset U_0\subset Y$ such that at any object $x\in U_0$ and for any $g\in \bm{G}(y_0)$ the linearization of the function
	\begin{align*}
		U_0 \times B_\ep^k  & \to \hat{f}^*W                                                                                                        \\
		(x, t_1,\ldots,t_k) & \mapsto \hat{f}^* \hdelbar (x) - \hat{f}^* \left( g * \left(\sum_{i=1}^k t_i \cdot s_i\right)\right) (x)              \\
		                    & \phantom{\mapsto} = \left(x, \hdelbar (\hat{f}(x)) - g * \left(\sum_{i=1}^k t_i \cdot s_i(\hat{f}(x)) \right) \right)
	\end{align*}
	projected to the fiber $(\hat{f}^* W)_x$ is surjective.

	\begin{step2}
		We may construct a global parametrized $\ssc^+$-multisection, such that this multisection and its pullback both have surjective projection to the fiber, and such that the compactness of both is controlled.
	\end{step2}

	We may cover the compact topological space $\cS(\delbar)$ by a finite collection of such neighborhoods $\abs{U'_i}$ of points $[y_i]\in \cS(\delbar)$; we may also cover $\cS(f^*\delbar)$ by a finite collection of such neighborhoods $\abs{U_i}$ of points $[x_i]\in \cS(f^*\delbar)$.
	It follows that the finite sum of $\ssc^+$-multisections
	\[
		\Lambda:= \bigoplus_i \Lambda_i : \cW \times B_\ep^N \to \Q^+
	\]
	has the property that: for any point $[y] \in \cZ$ with $\Lambda \circ \delbar ([y])>0$, and for any parametrized local section structure $\{s_i\}_{i\in I}$ at a representative $y$, the linearization of the function $\hdelbar (y) - s_i(y,t)$ projected to the fiber $W_y$ is surjective.

	Likewise, the pullback $\ssc^+$-multisection $\text{proj}_2^* \Lambda : f^*\cW \times B_\ep^N \to \Q^+$
	has the property that for any point $[x] \in \cY$ which satisfies $\text{proj}_2^* \Lambda \circ f^*\delbar ([x])>0$ and for any parametrized local section structure $\{s_i\}_{i\in I}$ at a representative $x$, the linearization of the function $\hdelbar (x) - s_i(x,t)$ projected to the fiber $(\hat{f}^*W)_x$ is surjective.

	Furthermore for $\ep$ sufficiently small, for any fixed $t_0 \in B_\ep^N$ the $\ssc^+$-multisection $\Lambda (\cdot, t_0)$ is controlled by the pair $(N,\cU)$, i.e.,
	\begin{itemize}
		\item $N[\Lambda(\cdot,t_0)] \leq 1$,
		\item $\text{dom-supp}(\Lambda(\cdot,t_0)) \subset \cU$.
	\end{itemize}
	It follows from Proposition~\ref{prop:simultaneous-compactness} that the pullback $\ssc^+$-multisection $\text{proj}_2^* \Lambda (\cdot, t_0)$ is controlled by the pullback $(\text{proj}_2^*N,f^{-1}(\cU))$.

	\begin{step3}
		We apply Sard's theorem to find a common regular value for both the parametrized $\ssc^+$-multisection and its pullback.
	\end{step3}

	Consider the strong polyfold bundle $\cW \times B_\ep^N \to \cZ \times B_\ep^N$ and the pullback strong polyfold bundle $f^*\cW \times B_\ep^N \to \cY \times B_\ep^N$.
	Let $\tdelbar : \cZ \times B_\ep^N \to \cW \times B_\ep^N$ denote the $\ssc$-smooth proper Fredholm section defined by $([y],t)\mapsto (\delbar([y]),t)$, and let $\tilde{f}^*\tdelbar :\cY \times B_\ep^N \to f^*\cW\times B_\ep^N$ denote the $\ssc$-smooth proper Fredholm section defined by $([x],t) \mapsto ([x],\delbar(f([x])),t)$.
	By construction, $(\tdelbar, \Lambda)$ and $(\tilde{f}^*\tdelbar, \text{proj}_2^* \Lambda)$ are transversal pairs; hence by Theorem~\ref{thm:transversality} the thickened solution sets
	\begin{align*}
		\cS(\tdelbar, \Lambda)                            & = \{ ([y],t) \in \cZ \times B_\ep^N \mid \Lambda (\tdelbar ([y],t)) >0 \} \subset \cZ \times B_\ep^N,                          \\
		\cS(\tilde{f}^*\tdelbar, \text{proj}_2^* \Lambda) & = \{ ([x],t) \in \cY \times B_\ep^N \mid \text{proj}_2^*\Lambda (\tilde{f}^*\tdelbar ([x],t)) >0 \} \subset \cY \times B_\ep^N
	\end{align*}
	have the structure of weighted branched orbifolds.

	By Sard's theorem, we can find a common regular value $t_0 \in B_\ep^N$ of the projections $\cS(\tdelbar, \Lambda) \to B_\ep^N$ and $\cS(\tilde{f}^*\tdelbar, \text{proj}_2^* \Lambda)\to B_\ep^N$.
	Then the $\ssc^+$-multisection $\Lambda(\cdot,t_0) : \cW \to \Q^+$ and its pullback $\text{proj}_2^*\Lambda(\cdot,t_0) :f^*\cW \to \Q^+$ are the desired regular perturbations.
\end{proof}

The significance of this theorem is the following.
Both perturbed solution sets $\cS(f^*\delbar, \text{proj}_2^* \Lambda )$ and $\cS(\delbar,\Lambda)$ have the structure of compact oriented weighted branched suborbifolds.
Moreover, the restriction of $f$ gives a well-defined continuous function between these perturbed solution spaces, i.e.,
\[
	f|_{\cS(f^*\delbar, \text{proj}_2^* \Lambda )}: \cS(f^*\delbar, \text{proj}_2^* \Lambda ) \to \cS(\delbar,\Lambda).
\]
Furthermore, $f$ is weight preserving in the sense that the weight functions are related via pullback by the following equation $ ( \Lambda \circ \delbar) \circ f= \text{proj}_2^* \Lambda \circ f^* \delbar$.
This completes the proof of Thereom~\ref{thm:pullback-regular-perturbation}.

\subsection{The permutation maps between perturbed Gromov--Witten moduli spaces}\label{subsec:permutation-map}
{As we have explained in the introduction, naively there does not exist a permutation map for an arbitrary choice of abstract perturbation.}

Fix a permutation $\sigma \in S_k,\  \sigma: \{1,\ldots, k\}\to \{1,\ldots,k\}$.
Associated to this permutation we can define a $\ssc$-smooth permutation map between the Gromov--Witten polyfold
\[
	\sigma: \cZ_{A,g,k} \to \cZ_{A,g,k}, \qquad [\Sigma,j,M,D,u]  \mapsto [\Sigma,j,M^\sigma,D,u]
\]
where $M = \{z_1,\ldots,z_k\}$ and where $M^\sigma := \{z'_1,\ldots,z'_k\}$, $z'_i:= z_{\sigma(i)}$.

Consider the pullback via $\sigma$ of the strong bundle $\cW_{A,g,k} \to \cZ_{A,g,k}$ and the Cauchy--Riemann section $\delbarj$, as illustrated in the below commutative diagram.
\[
	\begin{tikzcd}
		\sigma^* \cW_{A,g,k} \arrow[d, "\sigma^* \delbarj \quad"'] \arrow[r, "\text{proj}_2"'] & \cW_{A,g,k} \arrow[d, "\quad \delbarj"] &  \\
		\cZ_{A,g,k} \arrow[r, "\sigma"'] \arrow[u, bend left] & \cZ_{A,g,k} \arrow[u, bend right] &
	\end{tikzcd}
\]
The map $\sigma$ is a homeomorphism when considered on the underlying topological spaces, and hence satisfies the topological pullback condition.
By applying Theorem~\ref{thm:compatible-pullbacks} we immediately obtain Corollary~\ref{cor:pullback-via-permutation}.

It follows that the permutation map restricts to a well-defined map between the perturbed Gromov--Witten moduli spaces,
\[
	\sigma|_{\cS_{A,g,k} (\delbarj, \text{proj}_2^* \Lambda)} : \cS_{A,g,k} (\delbarj, \text{proj}_2^* \Lambda) \to \cS_{A,g,k} (\delbarj,\Lambda).
\]
Considered on the underlying topological spaces, this map is a homeomorphism.  Considered on the branched ep-subgroupoid structures, the associated functor
\[
	\hat{\sigma}|_{S_{A,g,k} (\hdelbarj, \text{proj}_2^* \hat{\Lambda})}: S_{A,g,k} (\hdelbarj, \text{proj}_2^* \hat{\Lambda}) \to S_{A,g,k} (\hdelbarj,\hat{\Lambda})
\]
is a local diffeomorphism, and moreover is injective.
The restricted permutation map $\sigma$ and its associated functor $\hat{\sigma}$ are both weight preserving, i.e.,
$(\Lambda\circ \delbarj) \circ \sigma = \text{proj}_2^*\Lambda \circ \delbarj$ and $(\hat{\Lambda}\circ \hdelbarj) \circ \hat{\sigma} = \text{proj}_2^* \hat{\Lambda} \circ \hdelbarj$.

\appendix


\section{Abstract perturbations in polyfold theory}\label{sec:abstract-perturbations-polyfold-theory}

In this section we recall and summarize the construction of abstract perturbations in polyfold theory, as developed by Hofer, Wysocki, and Zehnder.
Although this appendix does not contain new material, we use and modify all of the constructions and definitions throughout this paper, so we have included it as a fast reference for our constructions.

\subsection{Polyfolds and ep-groupoids}\label{subsec:polyfolds-ep-groupoids}

We review the abstract definition of a ``polyfold'' in terms of the modern language of \'etale proper Lie groupoids. We refer the reader to \cite{HWZbook} for a complete exposition.

\subsubsection[sc-Structures, M-polyfolds, and polyfold structures]{$\ssc$-Structures, M-polyfolds, and polyfold structures}


We begin by discussing the basic definitions of ``scale calculus'' in polyfold theory.
Scale calculus is a generalization of classical functional analytic concepts, designed to address the classical failure of reparametrization actions to be differentiable (see \cite[Ex.~2.1.4]{ffgw2016polyfoldsfirstandsecondlook}).
Thus, scale calculus begins by generalizing notions of Banach spaces and of Fr\'echet differentiability in order to obtain scale structures where reparametrization will be a smooth action.


\begin{definition}[{\cite[Def.~1.1]{HWZbook}}]
	A \textbf{$\ssc$-Banach space} consists of a Banach space $E$ together with a decreasing sequence of linear subspaces
	\[
		E=E_0\supset E_1 \supset \cdots \supset E_\infty := \cap_{i\geq 0} E_i
	\]
	such that the following two conditions are satisfied.
	\begin{enumerate}
		\item The inclusion operators $E_{m+1} \to E_m$ are compact.
		\item $E_\infty$ is dense in every $E_i$.
	\end{enumerate}
\end{definition}

\begin{definition}[{\cite[Def.~1.9]{HWZbook}}]\label{def:ssc-differentiability-ssc-Banach-spaces}
	A map $f:U\rightarrow U'$ between two open subsets of $\ssc$-Banach spaces $E$ and $E'$ is called a \textbf{$\ssc^0$-map}, if  $f(U_i)\subset U'_i$  for all $i\geq 0$ and if the induced maps  $f:U_i\rightarrow U'_i$ are continuous.
	Furthermore, $f$ is called a \textbf{$\ssc^1$-map}, or of \textbf{class $\ssc^1$}, if the following conditions are satisfied.
	\begin{itemize}
		\item For every $x\in U_1$ there exists a bounded
		      linear  map $Df(x)\in  \mathcal{L}(E_0, E'_0)$ satisfying for $h\in
			      E_1$, with $x+h\in U_1$,
		      \[\frac{1}{\norm{h}_1}\norm{f(x+h)-f(x)-Df(x)h}_0\to 0\quad
			      \text{as\ $\norm{h}_1\to 0$.}\mbox{}\\[4pt]\]
		\item  The tangent map  $Tf:TU\to TU'$,
		      defined by
		      \[Tf(x, h)=(f(x), Df(x)h),
		      \]
		      is a $\ssc^0$-map between the tangent spaces.
	\end{itemize}
\end{definition}

If $Tf:TU\to TU'$ is of class $\ssc^1$, then $f:U\to U'$ is called of class $\ssc^2$; inductively, the map $f:U\to E'$ is called of class $\ssc^k$ if the $\ssc^0$-map $T^{k-1}f:T^{k-1}U\to T^{k-1}E'$ is of class $\ssc^1$.  A map which is of class $\ssc^k$ for every $k$ is called  \textbf{$\ssc$-smooth}  or of  \textbf{class $\ssc^{\infty}$}.  The basic building block which allows us to check the $\ssc$-differentiability of maps is the chain rule.

\begin{proposition}[Chain rule, {\cite[Thm.~1.1]{HWZbook}}]
	Assume that $E$, $F$, and $G$ are $\ssc$-smooth Banach spaces and $U\subset E$ and $V\subset F$ are open sets.  Assume that $f:E\to F$, $g:V\to G$ are of class $\ssc^1$ and $f(U)=V$.  Then the composition $g\circ f :U\to G$ is of class $\ssc^1$ and the tangent maps satisfy
	\[
		T(g\circ f) = Tg \circ Tf.
	\]
\end{proposition}



\begin{definition}[{\cite[Defs.~2.1,~2.2]{HWZbook}}]
	Consider a $\ssc$-Banach space $E$ and consider an open subset $U\subset E$.  A $\ssc$-smooth map $r:U\to U$ is called a \textbf{$\ssc$-smooth retraction} on $U$ if $r\circ r = r$.
	A \textbf{local M-polyfold model (without boundary)} is a pair $(O,E)$ consisting of a $\ssc$-Banach space $E$ and a subset $O\subset E$ such that there exists a $\ssc$-smooth retraction $r:U \to U$ defined on an open subset $U\subset E$ such that $r(U)= O$.  We call $O$, equipped with the subspace topology $O\subset E$, a \textbf{$\ssc$-retract}.
\end{definition}

These definitions of $\ssc$-differentiability extend to local M-polyfolds models in the following way.
\begin{definition}[{\cite[Def.~2.4]{HWZbook}}]
	A map $f:O \to O'$ between two local M-polyfold models is of \textbf{class $\ssc^k$} if the composition  $f\circ r:U\to E'$ is of class $\ssc^k$ where $U\subset E$ is an open subset of the $\ssc$-Banach space $E$ and where $r:U\to U$ is a $\ssc$-smooth retraction onto $r(U)=O$.
\end{definition}



In the absence of isotropy, we may consider the following definition of an ``M-polyfold'', short for a ``polyfold of manifold type''.

\begin{definition}[{\cite[Def.~2.8]{HWZbook}}]
	We say that a paracompact Hausdorff topological space $Z$ is an \textbf{M-polyfold} if every point $z\in Z$ has an open neighborhood %
	which is homeomorphic to a $\ssc$-retract $O$, and such that the induced transition maps between any two $\ssc$-retracts are $\ssc$-smooth.
\end{definition}

However, in almost all situations that arise isotropy is inevitable, and must be dealt with.
In this sense, polyfold behave like infinite-dimensional orbifolds, and so we introduce the language of ep-groupoids.

\begin{definition}[{\cite[Defs.~7.1,~7.3]{HWZbook}}]
	A \textbf{groupoid} $(Z,\bm{Z})$ is a small category consisting of a set of objects $Z$, a set of morphisms $\bm{Z}$ which are all invertible, and the five structure maps $(s,t,m,u,i)$ (the source, target, multiplication, unit, and inverse maps).
	An \textbf{ep-groupoid} is a groupoid $(Z,\bm{Z})$ such that the object set $Z$ and the morphism set $\bm{Z}$ are both M-polyfolds, and such that all the structure maps are $\ssc$-smooth maps which satisfy the following properties.
	\begin{itemize}
		\item \textbf{(\'etale).}  The source and target maps
		      $s:\bm{Z}\to Z$ and $t:\bm{Z}\to Z$ are surjective local sc-diffeomorphisms.
		\item \textbf{(proper).}  For every point $z\in Z$, there exists an
		      open neighborhood $V(z)$ so that the map
		      $t:s^{-1}(\overline{V(z)})\rightarrow Z$ is a proper mapping.
	\end{itemize}
\end{definition}

For a fixed object $z\in Z$ we denote the \textbf{isotropy group of $z$} by
\[
	\bm{G}(z) := \{	\phi \in \bm{Z} \mid s(\phi)=t(\phi = z)	\}.
\]
By \cite[Prop.~7.4]{HWZbook}, the properness condition ensures that this is a finite group.
The \textbf{orbit space} of the ep-groupoid $(Z,\bm{Z})$,
\[
	\abs{Z} := Z / \sim,
\]
is the quotient of the set of objects $Z$ by the equivalence relation given by $z\sim z'$ if there exists a morphism $\phi\in \bm{Z}$ with $s(\phi)=z$ and $t(\phi)=z'$.  It is equipped with the quotient topology defined via the map
\begin{equation}\label{eq:quotient-map}
	\pi: Z\to\abs{Z}, \qquad z\mapsto \abs{z}.
\end{equation}




\begin{definition}[{\cite[Def.~16.1]{HWZbook}}]
	Let $\cZ$ be a second countable, paracompact, Hausdorff topological space.  A \textbf{polyfold structure} on $\cZ$ consists of an ep-groupoid $(Z,\bm{Z})$ and a homeomorphism $\abs{Z}\simeq \cZ$.
\end{definition}

Defining an ep-groupoid involves making a choice of local structures.  Taking an equivalence class of ep-groupoids makes our differentiable structure choice independent.  The appropriate notion of equivalence in this category-theoretic context is a ``Morita equivalence class'' (see \cite[Def.~3.2]{HWZ3}).%

\begin{definition}[{\cite[Def.~16.3]{HWZbook}}]
	A \textbf{polyfold} consists of a second countable, paracompact, Hausdorff topological space $\cZ$ together with a Morita equivalence class of polyfold structures $[(Z,\bm{Z})]$ on $\cZ$.
\end{definition}

Taking a Morita equivalence class of a given polyfold structure (in the case of polyfolds) is analogous to taking a maximal atlas for a given atlas (in the usual definition of manifolds).
Given distinct polyfold structures which define an orbifold or a polyfold, the method of proving they define the same Morita equivalence class is by demonstrating that both polyfold structures possess a common refinement.

The scales of a $\ssc$-Banach space induce a filtration on the local M-polyfold models, which is moreover preserved by the structure maps $s,t$.  Consequently, there is a well-defined filtration on the orbit space which hence induces a filtration
\[
	\cZ = \cZ_0 \supset \cZ_1 \supset \cdots \supset \cZ_\infty = \cap_{k\geq 0} \cZ_k
\]
on the underlying topological space $\cZ$.

\begin{notation}
	It is common to denote both the ep-groupoid ``$(Z,\bm{Z})$'', and its object set ``$Z$'', by the same letter ``$Z$''.
	We will refer to the underlying set, the underlying topological space, or the polyfold by the letter ``$\cZ$''.
	We will always assume that a topological space $\cZ$ with a polyfold structure is necessarily second countable, paracompact, and Hausdorff.
	Furthermore, we will write objects as ``$x\in Z$'', morphisms as ``$\phi \in \bm{Z}$'', and points as ``$[x]\in \cZ$'' (due to the identification $\abs{Z} \simeq \cZ$). We will write ``$\phi: x\to y$'' for a morphism $\phi \in \bm{Z}$ with $s(\phi)=x$ and $t(\phi)=y$.
\end{notation}

The local topology of a polyfold is related to the local isotropy groups, as demonstrated by the following proposition.

\begin{proposition}[Natural representation of $\bm{G}(x)$, {\cite[Thm.~7.1, Prop.~7.6]{HWZbook}}]\label{prop:natural-representation}
	Let be an ep-groupoid $(Z,\bm{Z})$.  Let $x\in Z$ with isotropy group $\bm{G}(x)$.  Then for every open neighborhood $V$ of $x$ there exists an open neighborhood $U\subset V$ of $x$, a group homomorphism $\Phi : \bm{G}(x)\rightarrow \text{Diff}_{\ssc}(U)$, $g\mapsto  \Phi (g)$,  and a $\ssc$-smooth map
	$\Gamma: \bm{G}(x)\times U\rightarrow \bm{Z}$ such that the following holds.
	\begin{enumerate}
		\item $\Gamma(g,x)=g$.
		\item $s(\Gamma(g,y))=y$ and $t(\Gamma(g,y))=\Phi (g)(y)$ for all $y\in U$ and $g\in \bm{G}(x)$.
		\item If $h: y\rightarrow z$ is a morphism between points in $U$, then there exists a unique element $g\in \bm{G}(x)$ satisfying $\Gamma(g,y)=h$, i.e.,
		      \[
			      \Gamma: \bm{G}(x)\times U\rightarrow \{\phi\in \bm{Z} \mid   \text{$s(\phi)$ and $t(\phi)\in U$}\}
		      \]
		      is a bijection.
	\end{enumerate}
	The data $(\Phi,\Gamma)$ is called the \textbf{natural representation} of $\bm{G}(x)$.
	Moreover, consider the following topological spaces:
	\begin{itemize}
		\item $\bm{G}(x) \backslash U$, equipped with quotient topology defined by the projection $U \to \bm{G}(x) \backslash U$,
		\item $U / \sim$, where $x \sim x'$ for $x, x' \in U$ if there exists a morphism $\phi \in \bm{Z}$ with $s(\phi)=x$ and $t(\phi)=x$, equipped with the quotient topology defined by the projection $U \to U / \sim$,
		\item $\abs{U}$, the image of $U$ under the map $Z\to \abs{Z}$, equipped with the subspace topology defined by the inclusion $\abs{U}\subset \abs{Z}$.
	\end{itemize}
	Then these spaces are all naturally homeomorphic.
\end{proposition}

\subsubsection{Maps between polyfolds}

Using category-theoretic language, we discuss the definition of map between polyfolds.

\begin{definition}
	A \textbf{$\ssc^k$ functor} between two polyfold structures
	\[
		\hat{f}:(Z_1,\bm{Z}_1) \to (Z_2,\bm{Z}_2)
	\]
	is a functor on groupoidal categories which moreover is a $\ssc^k$ map when considered on the object and morphism sets.
\end{definition}

A $\ssc^k$ functor between two polyfold structures $(Z_1,\bm{Z}_1)$, $(Z_2,\bm{Z}_2)$ with underlying topological spaces $\cZ_1$, $\cZ_2$ induces a continuous map on the orbit spaces $\abs{\hat{f}}:\abs{Z_1} \to \abs{Z_2}$, and hence also induces a continuous map $f : \cZ_1 \to \cZ_2$, as illustrated in the following commutative diagram.
\[
	\begin{tikzcd}[row sep=small]
		\abs{Z_1} \arrow[d,phantom,"\rotatebox{90}{\(\simeq\)}"] \arrow[r,"\abs{\hat{f}}"] & \abs{Z_2} \arrow[d,phantom,"\rotatebox{90}{\(\simeq\)}"] \\
		\cZ_1 \arrow[r,"f"] & \cZ_2
	\end{tikzcd}
\]

\begin{definition}
	Consider two topological spaces  $\cZ_1$, $\cZ_2$ with orbifold structures $(Z_1,\bm{Z}_1)$, $(Z_2,\bm{Z}_2)$. We define a \textbf{$\ssc^k$ map between polyfolds} as a continuous map
	\[
		f: \cZ_1 \to \cZ_2
	\]
	between the underlying topological spaces of the polyfolds, for which there exists an associated $\ssc^k$ functor
	\[
		\hat{f}: (Z_1,\bm{Z}_1) \to (Z_2,\bm{Z}_2).
	\]
	such that $\abs{\hat{f}}$ induces $f$.
\end{definition}


\subsubsection{Subgroupoids}

We state some essential facts about the topology of subgroupoids.

\begin{definition}
	Let $(Z,\bm{Z})$ be an ep-groupoid.
	We say that a subset of the object set, $S\subset Z$, is \textbf{saturated} if $S = \pi^{-1} (\pi(S))$, where $\pi$ is the quotient map \eqref{eq:quotient-map}.
	We define a \textbf{subgroupoid} as the full subcategory $(S,\bm{S})$ associated to a saturated subset of the object set.
\end{definition}

A subgroupoid $(S,\bm{S})$ comes equipped with the subspace topology induced from the ep-groupoid $(Z,\bm{Z})$, in addition to the induced grading.  It does not come with a $\ssc$-smooth structure in general, so the \'etale condition no longer makes sense.  However, one may observe it inherits the following directly analogous properties.
\begin{itemize}
	\item The source and target maps are surjective local homeomorphisms which moreover respect the induced grading. We say that the source and target maps are \textbf{$\ssc^0$-homeomorphisms} and the subgroupoid $(S,\bm{S})$ is automatically \textbf{$\ssc^0$-\'etale}.
	\item For every point $x\in S$, there exists an open neighborhood $V(x)$ so that the map $t: s^{-1}(\overline{V(x)}) \to S$ is a proper mapping. (This can be shown from the definitions, using in addition that if $f:X\to Y$ is proper, then for any subset $V\subset Y$ the restriction $f|_{f^{-1}(V)}: f^{-1}(V)\to V$ is proper.)
\end{itemize}
Thus, a subgroupoid is automatically $\ssc^0$-\'etale in the above sense, as well as proper.

\begin{remark}\label{rmk:local-topology-subgroupoid}
	Let $U$ be an open subset of $S$.
	We may consider two topologies on $U$:
	\begin{itemize}
		\item $(U, \tau_S)$, where $\tau_S$ is the subspace topology induced from the inclusion $\cup_{i\in I} M_i \allowbreak \hookrightarrow S$,
		\item $(U, \tau_Z)$, where $\tau_Z$ is the subspace topology induced from the inclusion $\cup_{i\in I} M_i \allowbreak \hookrightarrow Z$.
	\end{itemize}
	Then these two topologies are identical. Moreover, $U\hookrightarrow S$ is a local homeomorphism.
\end{remark}



\begin{proposition}\label{prop:topology-subgroupoid}
	Consider the orbit space of a subgroupoid, $\abs{S}$.  There are two topologies on this space we may consider:
	\begin{itemize}
		\item the subspace topology $\tau_s$, induced from the inclusion $\abs{S}\subset \abs{Z}$,
		\item the quotient topology $\tau_q$, induced from the projection $S\to \abs{S}$.
	\end{itemize}
	These two topologies are identical.
\end{proposition}
\begin{proof}
	We show that $\tau_s = \tau_q$.
	\begin{itemize}
		\item $\tau_s \subset \tau_q$
	\end{itemize}
	Suppose $U\subset \abs{S}$ and $U\in \tau_s$.  Then $U = V\cap \abs{S}$ for $V\subset \abs{Z}$ open.  By definition, $\pi^{-1} (V) \subset Z$ is open.  Moreover, $\pi^{-1} (U)  = \pi^{-1} (V) \cap \pi^{-1}(S) = \pi^{-1}(V)\cap S$.  Hence $\pi^{-1}(U)$ is open in $S$.  It follows from the definition of the quotient topology that $U\in \tau_q$.
	\begin{itemize}
		\item $\tau_q \subset \tau_s$
	\end{itemize}
	Suppose $U\subset \abs{S}$ and $U\in \tau_q$.  We will show for every $[x]\in U$ there exists a subset $B \subset \abs{S}$ such that $B \in \tau_s$ and $[x] \in B \subset U$.  It will then follow that $U\in\tau_s$, as desired.

	Let $x\in \pi^{-1}(U)$ be a representative of $[x]$.  There exists an open neighborhood $V(x) \subset Z$ equipped with the natural action by $\bm{G}(x)$ and such that $V(x) \cap S \subset \pi^{-1}(U)$.
	Observe that $\abs{V(x)\cap S} = \abs{V(x)} \cap \abs{S}$; this follows since $S$ is saturated.

	Let $B:= \abs{V(x)} \cap \abs{S} \subset U$.  Then observe that $\abs{V(x)} \subset \abs{Z}$ is open,
	since the quotient map $\pi : Z \to \abs{Z}$ is an open map (see \cite[Prop.~7.1]{HWZbook}).
	Hence $B:=\abs{V(x)} \cap \abs{S}\subset \abs{S}$ is open in the subspace topology.  It follows that  $B \in \tau_s$ and $[x] \in B \subset U$, as desired.
\end{proof}

The following proposition is an analog of Proposition~\ref{prop:natural-representation} for subgroupoids.

\begin{proposition}[Induced representation of $\bm{G}(x)$ for a subgroupoid]\label{prop:natural-representation-subgroupoid}
	Let $(S,\bm{S})$ be a subgroupoid of an ep-groupoid $(Z,\bm{Z})$.  Let $x\in S$ with isotropy group $\bm{G}(x)$.  Then for every open neighborhood $V$ of $x$ there exists an open neighborhood $U\subset V$ of $x$, a group homomorphism $\Phi : \bm{G}(x)\rightarrow \text{Homeo}_{\ssc^0}(U)$, $g\mapsto  \Phi (g)$,  and a $\ssc^0$-map
	$\Gamma: \bm{G}(x)\times U\rightarrow \bm{S}$ such that the following holds.
	\begin{enumerate}
		\item $\Gamma(g,x)=g$,
		\item $s(\Gamma(g,y))=y$ and $t(\Gamma(g,y))=\Phi (g)(y)$ for all $y\in U$ and $g\in \bm{G}(x)$,
		\item if $h: y\rightarrow z$ is a morphism between points in $U$, then there exists a unique element $g\in \bm{G}(x)$ satisfying $\Gamma(g,y)=h$, i.e.,
		      \[
			      \Gamma: \bm{G}(x)\times U\rightarrow \{\phi\in \bm{Z} \mid   \text{$s(\phi)$ and $t(\phi)\in U$}\}
		      \]
		      is a bijection.
	\end{enumerate}
	Moreover, consider the following topological spaces:
	\begin{itemize}
		\item $\bm{G}(x) \backslash U$, equipped with quotient topology via the projection $U \to \bm{G}(x) \backslash U$,
		\item $U / \sim$, where $x \sim x'$ for $x, x' \in U$ if there exists a morphism $\phi : x \to x'$, equipped with the quotient topology via the projection $U \to U / \sim$,
		\item $\abs{U}$, the image of $U$ under the map $S\to \abs{S}$, equipped with the subspace topology,
		\item $\abs{U}$, the image of $U$ under the map $Z \to \abs{Z}$, equipped with the subspace topology.
	\end{itemize}
	Then these spaces are all naturally homeomorphic.
\end{proposition}

\subsubsection{Weighted branched suborbifolds}

View $\Q^+:= \Q \cap [0,\infty)$ as an ep-groupoid, having only the identities as morphisms.
Consider a polyfold, consisting of a polyfold structure $(Z,\bm{Z})$ and an underlying topological space $\cZ$.
Consider a functor $\hat{\theta}: (Z,\bm{Z}) \to \Q^+$ which induces the function $\theta:=\abs{\hat{\theta}} :\cZ \to \Q^+$.
Observe that $\hat{\theta}$ defines a subgroupoid $(S,\bm{S})\subset (Z,\bm{Z})$ with object set
\[
	S:= \supp (\hat{\theta}) = \{x\in Z\mid \hat{\theta}(x)>0 \}
\]
and with underlying topological space
\[
	\cS := \supp (\theta) = \{[x]\in \cZ \mid \theta([x])>0\}.
\]
Moreover, $(S,\bm{S})$ is a full subcategory of $(Z,\bm{Z})$ whose object set is saturated, i.e., $S= \pi^{-1} (\pi(S))$ where $\pi : Z \to \abs{Z}, x\mapsto [x]$.

\begin{definition}[{\cite[Def.~9.1]{HWZbook}}]\label{def:weighed-branched-suborbifold}
	A \textbf{weighted branched suborbifold structure} consists of a subgroupoid $(S,\bm{S}) \subset (Z,\bm{Z})$ defined by a functor $\hat{\theta} : (Z,\bm{Z}) \to \Q^+$ as above which satisfies the following properties.
	\begin{enumerate}
		\item $\cS \subset \cZ_\infty$.
		\item Given an object $x\in S$, there exists an open neighborhood $U\subset Z$ of $x$ and a finite collection $M_i$, $i\in I$ of finite-dimensional submanifolds of $Z$ (in the sense of \cite[Def.~4.19]{HWZ2}) such that
		      \[
			      S \cap U= \bigcup_{i \in I}M_i.
		      \]
		      We require that the inclusion maps $\phi_i: M_i\hookrightarrow U$ are proper and are {topological embeddings,} and in addition we require that the submanifolds $M_i$ all have the same dimension.
		      The submanifolds $M_i$ are called \textbf{local branches} in $U$.\label{def:local-branches}
		\item There exist positive rational numbers $w_i$, $i\in I$, (called \textbf{weights}) such that if $y\in S \cap U$, then
		      \[\hat{\theta}(y)=\sum_{\{i \in I \mid   y\in M_i\}} w_i.\]
	\end{enumerate}
	We call ${(M_i)}_{i\in I}$ and ${(w_i)}_{i\in I}$ a \textbf{local branching structure}.
\end{definition}

By shrinking the open set $U$ we may assume that the local branches $M_i$ (equipped with the subspace topology induced from $U$) are homeomorphic to open subsets of $\R^n$.  Hence we may assume that a local branch is given by a subset $M_i\subset\R^n$ and an inclusion map $\phi_i : M_i\hookrightarrow U$ where $\phi_i$ is proper and a homeomorphism onto its image.


\begin{definition}\label{def:local-orientation}
	Let $(S,\bm{S})$ be a weighted branched suborbifold structure. Consider an object $x\in S$ and a local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$ at $x$.
	Suppose moreover that each local branch has an \textit{orientation}, denoted as $(M_i,o_i)$

	We define a \textbf{local orientation} at $x$ with respect to the local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$ as the following finite formal sum of weighted oriented tangent planes:
	\[
		\sum_{\{i\in I \mid x\in M_i\}} w_i \cdot T_x (M_i,o_i).
	\]
\end{definition}

\begin{definition}\label{def:orientation}
	Let $(S,\bm{S})$ be a weighted branched suborbifold structure.
	We define an \textbf{orientation} on $(S,\bm{S})$ as a local orientation at every object $x\in S$ and local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$ at $x$ such that the following holds.
	\begin{enumerate}
		\item We require that the local orientation is well-defined and does not depend on choice of local branching structure. Given an object $x\in S$, suppose we have:
		      \begin{itemize}
			      \item a local orientation at $x$ with respect to a local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$,
			      \item a local orientation at $x$ with respect to a local branching structure $(M'_j)_{j\in I'}$, $(w'_j)_{j\in I'}$.
		      \end{itemize}
		      We require the finite formal sums of weighted oriented tangent planes to be identical, i.e.,
		      \[
			      \sum_{\{i\in I \mid x\in M_i\}} w_i \cdot T_x (M_i,o_i)= \sum_{\{j\in I' \mid x\in M'_j\}} w'_j \cdot T_x (M'_j,o_j)
		      \]
		\item We require morphism invariance of the local orientations. Given a morphism, $\phi : x \to y$ there exists a well-defined tangent map $T\phi : T_xZ \to T_yZ$.
		      Suppose we have:
		      \begin{itemize}
			      \item a local orientation at $x$ with respect to a local branching structure $(M_i)_{i\in I}$, $(w_i)_{i\in I}$,
			      \item a local orientation at $y$ with respect to a local branching structure $(M'_j)_{j\in I'}$, $(w'_j)_{j\in I'}$.
		      \end{itemize}
		      The image of a finite formal sum of weighted oriented tangent planes under this map is again a finite formal sum of weighted oriented tangent planes.
		      We require invariance of the local orientations under this map, i.e.,
		      \[
			      \sum_{\{j\in I' \mid y\in M'_j\}} w'_j \cdot T_y (M'_j,o'_j) = \sum_{\{i\in I \mid x\in M_i\}} w_i \cdot T\phi_* (T_x (M_i,o_i)).
		      \]
	\end{enumerate}
\end{definition}

A \textbf{weighted branched suborbifold structure with boundary} consists of a subgroupoid $(S,\bm{S})\subset (Z,\bm{Z})$ defined identically to Definition~\ref{def:weighed-branched-suborbifold} except we allow the possibility that the local branches are manifolds with boundary.
A \textbf{local orientation} at an object $x\in S$ is again defined as in Definition~\ref{def:local-orientation} as a finite formal sum determined by orientations of the local branches, and again an \textbf{orientation} is also defined similarly to Definition~\ref{def:orientation}.

\subsection{Abstract perturbations in polyfold theory}\label{subsec:abstract-perturbations}

Abstract perturbations in polyfold theory are a mixture of two different technologies:
\begin{enumerate}
	\item scale calculus generalizations of classical Fredholm theory, involving the development of analogs of Fredholm maps, compact perturbations, and the implicit function theorem for surjective Fredholm operators (originally developed in \cite{HWZ2});
	\item equivariant transversality through the use of ``multisections;'' due to the presence of nontrivial isotropy, it is generally impossible to obtain transversality through the use of single valued sections, and thus it is necessary to work with multisections (developed in \cite{cieliebak2003equivariant} and generalized to polyfold theory in \cite{HWZ3}).
\end{enumerate}

\subsubsection[Strong polyfold bundles and sc+-multisections]{Strong polyfold bundles and $\ssc^+$-multisections}\label{subsubsec:polyfold-abstract-perturbations}

In order to develop a Fredholm theory for polyfolds, it is necessary to formulate the notion of a ``strong polyfold bundle'' over a polyfold.
Let $P:W\to Z$ be a strong M-polyfold bundle (see \cite[Def.~2.26]{HWZbook}).
Recall that a fiber  $p^{-1} (y) = W_y$ over an object $y \in O_x$ carries the structure of a $\ssc$-Banach space. Furthermore $W$ is equipped with a double filtration $W_{m,k}$ for $0\leq k\leq m+1$, and the filtered spaces
\begin{gather*}
	W[0]:= W_{0,0} \supset W_{1,1}\supset \cdots \supset W_{i,i} \supset \cdots,	\\
	W[1]:= W_{0,1} \supset W_{1,2}\supset \cdots \supset W_{i,i+1}\supset \cdots
\end{gather*}
are both M-polyfolds in their own rights.
With respect to these filtrations, the maps $P[0]: W[0]\to Z$ and $P[1]:W[1]\to Z$ are both $\ssc$-smooth.

\begin{proposition}[{\cite[Prop.~2.16]{HWZbook}}]\label{prop:pullback-bundle}
	Let $P: W \to Z$ be a strong M-polyfold bundle, and let $f: Y \to Z$ be a $\ssc$-smooth map between M-polyfolds. The pullback $f^* W := \{(y,w_x) \in Y \times W \mid f(y)=x=P(w_x) \}$ carries a natural structure of a strong M-polyfold bundle over the M-polyfold $Y$.
\end{proposition}

Let $(Z,\bm{Z})$ be a polyfold structure, and consider a strong M-polyfold bundle over the object space, $P:W\to Z$.
The source map $s:\bm{Z}\to Z$ is a local $\ssc$-diffeomorphism, and hence we may consider the fiber product
\[
	\bm{Z} _s\times_P W = \{(\phi,w)\in \bm{Z}\times W	\mid	s(\phi)=P(w)	\}.
\]
Via the above proposition, we can also view as $\bm{Z} _s\times_P W$ as the pullback bundle via $s$ over the morphism space $\bm{Z}$,
\[\begin{tikzcd}
		\bm{Z} _s\times_P W \arrow[r] \arrow[d] & W \arrow[d] \\
		\bm{Z} \arrow[r, "s"] & Z.
	\end{tikzcd}\]

\begin{definition}[{\cite[Def.~8.4]{HWZbook}}]\label{def:strong-polyfold-bundle}
	A \textbf{strong polyfold bundle structure} $(W,\bm{W})$ over a polyfold structure $(Z,\bm{Z})$ consists of a strong M-polyfold bundle over the object M-polyfold $P:W\to Z$ together with a strong bundle map
	\[
		\mu : \bm{Z} _s\times_P W \to W
	\]
	which covers the target map $t:\bm{Z} \to Z$, such that the diagram
	\begin{center}
		\begin{tikzcd}
			\bm{Z} _s\times_P W \arrow[r, "\mu"] \arrow[d] & W \arrow[d] \\
			\bm{Z} \arrow[r, "t"] & Z
		\end{tikzcd}
	\end{center}
	commutes.
	Furthermore we require the following:
	\begin{enumerate}
		\item $\mu$ is a surjective local diffeomorphism and linear on fibers,
		\item $\mu(\id_x,w)= w$ for all $x\in Z$ and $w\in W_x$,
		\item $\mu(\phi \circ \g ,w)= \mu (\phi,\mu(\g,w))$ for all $\phi,\g\in\bm{Z}$ and $w\in W$ which satisfy
		      \[
			      s(\g) = P(w),\qquad t(\g) = s(\phi) = P(\mu(\g,w)).
		      \]
	\end{enumerate}
\end{definition}

A strong polyfold bundle structure $(W,\bm{W})$ has polyfold structures in its own right: we may take $W$ as the object set with the grading $W_{i,i}$ or $W_{i,i+1}$, and define the morphism set by $\bm{W}:= \bm{Z} _s\times_P W$. Moreover, we have source and target maps $s,t: \bm{W} \to W$ defined as follows:
\[
	s(\phi,w) := w, \qquad t(\phi,w) := \mu(\phi,w).
\]
We have a natural smooth projection functor $\hat{P}: (W,\bm{W}) \to (Z,\bm{Z})$.

\begin{definition}
	A \textbf{strong polyfold bundle} consists of a topological space $\cW$ together with a Morita equivalence class of strong polyfold bundle structures $(W,\bm{W})$.
\end{definition}

The double filtration of the fibers is preserved by the structure maps, and hence the orbit space $\abs{W}$ is equipped with a double filtration
\[
	\abs{W}_{m,k}, \quad \text{for } 0\leq m \ \text{and}\ 0\leq k\leq m+1.
\]
We moreover obtain polyfolds $\cW[0]$ and $\cW[1]$ with the filtrations $\cW[0]_i := \cW_{i,i}$ and $\cW[1]_i := \cW_{i,i+1}$.  Unless specified, ``$\cW$'' refers to the first filtration, i.e., $\cW[0]$ and ``$P$'' refers to the projection map with respect to this filtration.

\begin{definition}[{\cite[Def.~12.1]{HWZbook}}]
	We define a \textbf{$\ssc$-smooth Fredholm section} of the strong polyfold bundle $P:\cW\to\cZ$ as a $\ssc$-smooth map between polyfolds $\delbar: \cZ\to \cW$ which satisfies $P\circ \delbar = \id_\cZ$ (where $\id_\cZ$ is the identity map on $\cZ$)
	We require that $\delbar$ is \textbf{regularizing}, meaning that if $[x] \in \cZ_m$ and $\delbar ([x]) \in \cW_{m,m+1}$ then $[x]\in \cZ_{m+1}$.
	Finally, we require that at every smooth object $x\in Z$ the germ $(\hdelbar,x)$ is a ``Fredholm germ'' (see \cite[Def.~3.7]{HWZbook}).
\end{definition}

\begin{definition}\label{def:unperturbed-solution-space}
	We define the \textbf{unperturbed solution space} of $\delbar$ as the set
	\[
		\cS(\delbar) :=\{ [x]\in \cZ\mid \delbar([x]) = 0\} \subset \cZ,
	\]
	with topology given by the subspace topology induced from $\cZ$.
	The space $\cS(\delbar)$ has an associated subgroupoid structure $(S(\hdelbar), \bm{S}(\hdelbar))$ defined as follows:
	\begin{itemize}
		\item (saturated) object set: $S(\hdelbar) := \{	x\in Z \mid \hdelbar(x)=0	\} \subset Z$,
		\item morphism set: $\bm{S} (\hdelbar) := \{ \phi \in \bm{Z}	\mid s(\phi) \in S(\hdelbar) \ (\text{equivalently } t(\phi)\in S(\hdelbar))	\} \subset	\bm{Z}$.
	\end{itemize}
	Both the object and morphism sets carry the subspace topology induced from the topologies on the object space $Z$ and morphism space $\bm{Z}$.
\end{definition}

We say that the Fredholm section $\delbar$ is \textbf{proper} if the unperturbed solution space $\cS(\delbar)$ is a compact topological space.

\begin{definition}[{\cite[Def.~2.24]{HWZbook}}]
	A \textbf{$\ssc^+$-section} is a $\ssc$-smooth map $s: Z \to W[1]$ which satisfies $P\circ s = \id_Z$
\end{definition}

The significance of this definition is captured in the fact that if $(\hdelbar,x)$ is a Fredholm germ and $s$ is a germ of a $\ssc^+$-section around $y$, then $(\hdelbar+s,x)$ remains a Fredholm germ.
This follows tautologically from the definition of a Fredholm germ (see the comment following \cite[Def.~2.44]{HWZGW}).
We may view the relationship of Fredholm sections and $\ssc^+$-sections in the current theory as the analogs of Fredholm and compact operators in classical functional analysis.

One can view a ``multisection'' as the rationally weighted characteristic function of an equivariant collection of locally defined single valued sections.
This is made precise in the following definition.

\begin{definition}\label{def:sc-multisection}
	We view $\Q^+:= \Q \cap [0,\infty)$ as an ep-groupoid, having only the identities as morphisms.
	A \textbf{$\ssc^+$-multisection} of a strong polyfold bundle $P:\cW\to \cZ$ consists of the following:
	\begin{itemize}
		\item a function $\Lambda:\cW \to \Q^+$,
		\item an associated functor $\hat{\Lambda}: W \to \Q^+$ where $\abs{\hat{\Lambda}}$ induces $\Lambda$,
	\end{itemize}
	such that at every $[x]\in \cZ$ there exists a \textbf{local section structure} defined as follows.
	Let $x\in Z$ be a representative of $[x]$ and let $U\subset Z$ be a $\bm{G}(x)$-invariant open neighborhood of $x$, and consider the restricted strong M-polyfold bundle $P: W|_U \to U$.
	Then there exist finitely many $\ssc^+$-sections $s_1,\ldots,s_k : U \to W_U$ (called \textbf{local sections}) with associated positive rational numbers $\sigma_1,\ldots ,\sigma_k \in \Q^+$ (called \textbf{weights}) which satisfy the following:
	\begin{enumerate}
		\item $\sum_{i=1}^k \sigma_i =1$.
		\item The restriction $\hat{\Lambda}|_{W|_{U}}: W_U \to \Q^+$ is related to the local sections and weights via the equation
		      \[
			      \hat{\Lambda}|_{W|_{U}}(w)=\sum_{i\in \{1,\ldots, k \mid w=s_i(P(w))\}} \sigma_i
		      \]
		      where the empty sum has by definition the value $0$.
	\end{enumerate}
\end{definition}

We define the \textbf{domain support} of $\Lambda$ as the subset of $\cZ$ given by
\[
	\text{dom-supp}(\Lambda) := \text{cl}_\cZ (	\{	[x]\in\cZ \mid \exists [w]\in \cW_{[x]}\setminus\{0\} \text{ such that } \Lambda([w])>0	\}	).
\]


\begin{definition}\label{def:perturbed-solution-space}
	Associated to a $\ssc$-smooth Fredholm section $\delbar$ and a $\ssc^+$-multisection $\Lambda$,
	we define the \textbf{perturbed solution space} as the set
	\[
		\cS(\delbar,\Lambda) :=\{[x]\in\cZ \mid \Lambda(\delbar([x]))	>0	\}\subset \cZ
	\]
	with topology given by the subspace topology induced from $\cZ$. It is equipped with a \textbf{weight function} $\Lambda\circ \delbar:\cS(\delbar,\Lambda) \to \Q^+$.
	The space $\cS(\delbar,\Lambda)$ has an associated subgroupoid structure $(\cS(\hdelbar,\hat{\Lambda}), \bm{\cS}(\hdelbar,\hat{\Lambda}))$ with (saturated) object set
	\[
		S(\hdelbar,\hat{\Lambda}) :=\{x\in Z \mid \hat{\Lambda} ( \hdelbar(x))>0\} \subset Z
	\]
	and with morphism set given by
	\[
		\bm{S} (\hdelbar, \hat{\Lambda}) := \{ \phi \in \bm{Z}	\mid s(\phi) \in S(\hdelbar,\hat{\Lambda})	\} \subset	\bm{Z}
	\]
	(we could equivalently require that $t(\phi)\in S(\hdelbar, \hat{\Lambda})$).
	It is equipped with a \textbf{weight functor} $\hat{\Lambda}\circ \hdelbar:(\cS(\hdelbar,\hat{\Lambda}), \bm{\cS}(\hdelbar,\hat{\Lambda})) \to \Q^+$.
\end{definition}

Note that the space $\cS(\hdelbar,\hat{\Lambda})$ or the subgroupoid $(\cS(\hdelbar,\hat{\Lambda}), \bm{\cS}(\hdelbar,\hat{\Lambda}))$ can be respectively encoded entirely via the weight function or the weight functor; such a description is closer to the language used in \cite{HWZ3} and \cite{HWZbook}.

\subsubsection{Transverse perturbations}

At a local level, it is easy to adapt the functional analytic construction of compact perturbations of Fredholm operators to M-polyfolds; the implicit function theorem for M-polyfolds \cite[Thm.~3.13]{HWZbook} then guarantees that the zero set of a transversal $\ssc$-Fredholm section has the structure of a finite-dimensional manifold.
It is somewhat more involved to adapt these constructions to the global level, as this requires using multisections to obtain equivariance.

\begin{definition}[{\cite[Def.~15.2]{HWZbook}}]\label{def:transversal-pair}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, $\delbar$ a $\ssc$-smooth Fredholm section, and $\Lambda$ a $\ssc^+$-multisection.

	Consider a point $[x]\in \cZ$.  We say $(\delbar,\Lambda)$ is \textbf{transversal at $[x]$} if, given a local $\ssc^+$-section structure for $\Lambda$ at a representative $x$, the linearized local expression
	\[D(\hdelbar-s_i)(x):T_x Z \to W_x\]
	is surjective for all $i\in I$ with $\hdelbar(x)=s_i(x)$.  We say that $(\delbar,\Lambda)$ is \textbf{transversal} if it is transversal at every $[x] \in \cS(\delbar,\Lambda)$.


\end{definition}

Given a $\ssc$-Fredholm section it is relatively easy to construct a transversal multisection (see the general position argument of \cite[Thm.~15.4]{HWZbook}); a key ingredient is \cite[Lem.~5.3]{HWZbook} which guarantees the existence of locally defined $\ssc^+$-sections which take on a prescribed value at a point.

\begin{theorem}[{\cite[Thm.~4.13]{HWZ3}}]\label{thm:transversality}
	If the pair  $(\delbar,\Lambda)$ is transversal, then the perturbed solution set $\cS(\delbar,\Lambda)$ carries in a natural way the structure of a weighted branched suborbifold.
\end{theorem}

\begin{remark}[Relationship between local section structures and local branching structures]\label{rmk:relationship-local-section-structures-local-branching-structures}
	Consider a weighted branched suborbifold $\cS(\delbar,\Lambda)$ defined by a transversal $\ssc$-smooth Fredholm section $\delbar$ and a $\ssc^+$-multisection $\Lambda$.
	The relationship between the local section structure for $\Lambda$ and the local branching structure can be described as follows.
	Consider a point $[x]\in\cS(\delbar,\Lambda)$, and let $U\subset Z$ be a $\bm{G}(x)$-invariant open neighborhood of a representative $x$.
	Consider a local section structure for $\Lambda$ at $[x]$ consisting of $\ssc^+$-sections $s_i  : U \to W|_U$ and weights $w_i$ for $i\in I$.
	The implicit function theorem for M-polyfolds then implies that the sets
	\[
		M_i = (\hdelbar -s_i)^{-1}(0)
	\]
	define finite dimensional submanifolds which together with the weights $w_i$ give a local branching structure in $U$.
\end{remark}

\subsubsection{Pairs which control compactness}

Given a proper $\ssc$-smooth Fredholm section $\delbar$ and a $\ssc^+$-multisection $\Lambda$, we need some way to control the compactness of the resulting perturbed solution space $\cS(\delbar,\Lambda)$. This can be achieved by requiring that the perturbation $\Lambda$ is ``small'' in a suitable sense.

\begin{definition}[{\cite[Def.~12.2]{HWZbook}}]\label{def:auxiliary-norm}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle. %
	We define an \textbf{auxiliary norm} as a $\ssc^0$-map
	\[N:\cW[1] \to [0,\infty)\]
	where we regard $[0,\infty)$ as a smooth manifold with the trivial ep-groupoid structure (i.e., a polyfold with finite-dimensional local models and trivial isotropy).
	It has an associated $\ssc^0$-functor $\hat{N}:W[1]\to [0,\infty)$ where as usual $\abs{\hat{N}}$ induces $N$.
	We require that $\hat{N}$ satisfies the following conditions.
	\begin{enumerate}
		\item The restriction of $\hat{N}$ to each fiber $W_x[1]$ is a complete norm. (Recall that for each $x\in Z$, the fiber $W_x[1]$ is a $\ssc$-Banach space.)
		\item\label{property-2-auxiliary-norm} If $\{h_k\}$ is a sequence in $W[1]$ such that $\{\hat{P}(h_k)\}$ converges in $Z$ to an object $x$, and if $\lim_{k\to \infty} \hat{N}(h_k) = 0$, then $\{h_k\}$ converges to $0_x \in W_x[1]$.
	\end{enumerate}
\end{definition}


Given a point $[x]\in\cZ$ we define the \textbf{pointwise norm} of $\Lambda$ at $[x]$ with respect to the auxiliary norm $N$ by
\[
	N[\Lambda] ([x]) := \max \{	N([w])	\mid	[w]\in \cW[1], \Lambda ([w])>0, P([w])=[x]	\}
\]
and moreover define the \textbf{norm} of $\Lambda$ with respect to $N$ by
\[
	N[\Lambda] := \sup_{[x]\in\cZ} N[\Lambda] ([x]).
\]

\begin{definition}[{\cite[Def.~15.4]{HWZbook}}]\label{def:pair-which-controls-compactness}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $\delbar$ be a $\ssc$-smooth proper Fredholm section, and let $N :\cW[1]\to [0,\infty)$ be an auxiliary norm.
	Consider an open neighborhood $\cU$ of the unperturbed solution set $\cS(\delbar)\subset \cZ$. %
	We say that the pair $(N,\cU)$ \textbf{controls the compactness} of $\delbar$ if the set
	\[
		cl_\cZ \{[x]\in \cU \mid \delbar ([x]) \in \cW[1], N(\delbar([x]))\leq 1\} \subset \cZ
	\]
	is compact.
\end{definition}

\begin{remark}\label{rmk:shrink-neighborhood}
	We may always shrink the controlling neighborhood $\cU$ of the unperturbed solution set. To be precise, suppose that $(N, \cU)$ is a pair which controls compactness, and let $\cU'$ be an open set such that $\cS(\delbar)\subset\cU'\subset \cU$.  It is immediate from the above definition that the pair $(N, \cU')$ also controls compactness.
\end{remark}

Given a $\ssc$-smooth proper Fredholm section of a strong polyfold bundle, \cite[Prop.~2.27]{HWZ3} guarantees the existence of auxiliary norms.  The existence of a pair which control compactness then follows from \cite[Thm.~4.5]{HWZ3} which states that given an auxiliary norm $N$ there always exists an associated neighborhood $\cU$, such that the pair $(N, \cU)$ controls compactness.

\begin{theorem}[{\cite[Lem.~4.16]{HWZ3}}]\label{thm:compactness}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $\delbar$ be a $\ssc$-smooth proper Fredholm section, and let $(N, \cU)$ be a pair which controls compactness.

	Consider a $\ssc^+$-multisection $\Lambda$ and suppose it satisfies the following:
	\begin{itemize}
		\item $N[\Lambda] \leq 1$,
		\item $\text{dom-supp} (\Lambda) \subset \cU$.
	\end{itemize}
	Then the perturbed solution set $\cS(\delbar,\Lambda)$ is compact.
	We call such a $\ssc^+$-multisection \textbf{$(N,\cU)$-admissible} (compare with \cite[Def.~15.5]{HWZbook}).
\end{theorem}

\subsubsection{Determinant line bundles and orientations}

We do not try to give a full account of the polyfold theory on orientations (for that, we refer to \cite[\S6]{HWZbook}).
However, to talk precisely about orientations in our main theorems it is necessary to give a brief summary of the main ideas and definitions.

\begin{definition}[{\cite[Defs.~6.3,~6.4]{HWZbook}}]
	Let $T: E \to F$ be a bounded linear Fredholm operator between real Banach spaces. The \textbf{determinant} of $T$ is the 1-dimensional real vector space
	\[\det T = \Lambda^{\max} (\ker T) \otimes \left(\Lambda^{\max} (\coker T)	\right)^*.\]
	An \textbf{orientation} of $T$ is a choice of orientation of the real line $\det T$.
\end{definition}

Let $P: W\to Z$ be a strong M-polyfold bundle, and let $\hdelbar: Z \to W$ be a $\ssc$-smooth Fredholm section.
In general, there is no intrinsic notion a linearization of the section $\hdelbar$ at smooth points $x \in Z_\infty$ if $\hdelbar(x) \neq 0$.
To deal with this, one chooses a locally defined $\ssc^+$-section $s$ such that $s(x)=\hdelbar(x)$; one may then consider the well-defined linearization $D(\hdelbar - s)(x) :T_xZ \to W_x$.
The \textbf{space of linearizations} of $\hdelbar$ at $x$ is then defined as the following subset of linear Fredholm operators from $T_x Z \to W_x$:
\[\Lin(\hdelbar,x) := \{	D(\hdelbar - s)(x) + a \mid a: T_x Z \to W_x \text{ is a }\ssc^+\text{-operator}	\}.\]
It may be observed that $\Lin(\hdelbar,x)$ is a convex subset, and hence is contractible.

To each linearization we may associate its determinant; in doing so, we may consider the disjoint union
\[\DET(\hdelbar,x) := \bigsqcup_{L\in \Lin(\hdelbar,x)} \{L\}\times \det(L).\]
A priori, this set does not have much structure, as although each determinant is a real line, locally the kernel and cokernel of the linearizations may vary in dimension.
However, with some work it is possible to prove the following proposition.

\begin{proposition}[{\cite[Prop.~6.11]{HWZbook}}]
	The set $\DET(\hdelbar,x)$ has the structure of a topological line bundle over $\Lin(\hdelbar,x)$.
	The base space $\Lin(\hdelbar,x)$ is contractible and hence $\DET(\hdelbar,x)$ has two possible orientations.
\end{proposition}

We may therefore define an \textbf{orientation of $\hdelbar$ at a smooth point $x\in Z_\infty$} as a choice of one of the two possible orientations for $\DET(\hdelbar,x)$. We denote such an orientation by $o_{(\hdelbar,x)}$.

As we vary the smooth points, we need some way to compare the orientations at each point.
Intuitively, the choice of an orientation at a point should automatically determine an orientation at all nearby points.
This intuition is made precise in the theory as a sort of ``local orientation propagation''.

\begin{theorem}[{\cite[Thm.~6.1]{HWZbook}}]
	Consider a smooth point $x\in Z_\infty$. There exists an open neighborhood $U\subset Z$ such that for any smooth point $y\in U$ and for any $\ssc$-smooth path $\phi: [0,1] \to Z$ with $\phi(0)=x$, $\phi(1)=y$ there exists a well-defined ``local orientation propagation''. This means that, given an orientation $o_{(\hdelbar,x)}$ of $\DET(\hdelbar,x)$ we can associate an orientation $\phi_* o_{(\hdelbar,x)}$ of $\DET(\hdelbar,y)$, and moreover this association does not depend on the choice of $\ssc$-smooth path.
\end{theorem}

We may therefore define an orientation of a Fredholm section as a fixed choice of orientation at all smooth points which is consistent with the local orientation propagation.

\begin{definition}[{\cite[Def.~6.11]{HWZbook}}]\label{def:oriented-Fredholm}
	Let $P: W\to Z$ be a strong M-polyfold bundle, and let $\hdelbar: Z \to W$ be a $\ssc$-smooth Fredholm section.
	We define an \textbf{orientation} of $\hdelbar$ as an association for every smooth point $x\in Z_\infty$ with an orientation $o_{(\hdelbar,x)}$ of the determinant $\DET(\hdelbar,x)$ and which is consistent with the local orientation propagation in the following sense.

	For any two smooth points $x, y \in Z_\infty$ and for any $\ssc$-smooth path $\phi:[0,1] \to Z$ with $\phi(0)=x$, $\phi(1)=y$ the orientation $o_{(\hdelbar,y)}$ is the same as the pushforward orientation $\phi_* o_{(\hdelbar,x)}$ determined by the local orientation propagation. (Compare with \cite[Defs.~6.12,~6.13]{HWZbook}.)
\end{definition}

We end with an observation regarding how the above abstract discussion induces orientations on the perturbed solution spaces.
Consider an oriented $\ssc$-smooth Fredholm section $\hdelbar:Z\to W$ and consider a $\ssc^+$-section locally defined on a neighborhood $U$ of a point $x\in Z$, $s: U \to W|_U$.
Suppose that $\hdelbar(x) = s(x)$ and suppose that the linearization
\[D(\hdelbar - s)(x) :T_x Z \to W_x\]
is surjective. The implicit function theorem for M-polyfolds implies that $M:= (\hdelbar - s)^{-1}(0)$ has the structure of a finite-dimensional manifold.

A choice of orientation $o_{(\hdelbar,x)}$ of $\DET(\hdelbar,x)$ determines for any linearization $T\in \Lin (\hdelbar,x)$ a choice of orientation of $\det T$.
Then simply observe that $D(\hdelbar - s)(x) \in \Lin(\hdelbar,x)$, and since
\[\det  (D(\hdelbar - s)(x)) = \Lambda^{\max} (\ker (D(\hdelbar - s)(x))) = \Lambda^{\max} (T_x M)\]
a choice of orientation for $\det ((D(\hdelbar - s)(x))$ automatically induces an orientation for $M$ at $x$.

\subsubsection{Regular perturbations and compact cobordism}

In order to define invariants, a perturbed solution set needs to be both transversally cut out, and compact.
We therefore introduce the following definition, given also in \cite[Cor.~15.1]{HWZbook}.

\begin{definition}\label{def:regular-perturbation}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $\delbar$ be a $\ssc$-smooth proper Fredholm section, and let $(N, \cU)$ be a pair which controls compactness.

	Suppose a $\ssc^+$-multisection $\Lambda$ satisfies both the requirements of Theorem~\ref{thm:transversality} and Theorem~\ref{thm:compactness}, i.e.,
	\begin{itemize}
		\item $(\delbar, \Lambda)$ is a transversal pair,
		\item $N[\Lambda] \leq 1$ and $\text{dom-supp} (\Lambda) \subset \cU$.
	\end{itemize}
	We then say $\Lambda$ is a \textbf{regular perturbation} of $\delbar$ with respect to the pair $(N,\cU)$.
\end{definition}

\begin{corollary}[{\cite[Cor.~15.1]{HWZbook}}]\label{prop:existence-regular-perturbations}

	There exist regular perturbations $\Lambda$ of $\delbar$ with respect to the pair $(N,\cU)$.
	Theorems~\ref{thm:transversality} and \ref{thm:compactness} immediately imply that the perturbed solution space $\cS(\delbar,\Lambda)$ has the structure of a compact weighted branched suborbifold, with weight function given by $\Lambda\circ \delbar : \cS(\delbar,\Lambda) \to \Q^+$.
\end{corollary}

Compact weighted branched suborbifolds are suitable geometric spaces for defining invariants.
However, it remains to show that such invariants are independent of the choices used to define such a compact weighted branched orbifold, in particular, are independent of:
\begin{itemize}
	\item the choice of regular perturbation,
	\item the choice of pair which controls compactness.
\end{itemize}

\begin{theorem}[{\cite[Cor.~15.1]{HWZbook}}]\label{thm:cobordism-between-regular-perturbations}
	Let $P:\cW\to \cZ$ be a strong polyfold bundle, let $\delbar$ be a $\ssc$-smooth proper oriented Fredholm section, and let $(N_0, \cU_0)$, $(N_1,\cU_1)$ be two pairs which control compactness.  Suppose that $\Lambda_0$ is a regular perturbation of $\delbar$ with respect to the pair $(N_0,\cU_0)$, and likewise $\Lambda_1$ is a regular perturbation of $\delbar$ with respect to the pair $(N_1,\cU_1)$.  Consider the strong polyfold bundle $[0,1]\times \cW \to [0,1]\times \cZ$ and the $\ssc$-smooth proper oriented Fredholm section $\tdelbar$ defined by $(t,[z]) \mapsto (t,\delbar([z]))$.

	Then there exists a pair $(N,\cU)$ which controls the compactness of $\tdelbar$ and which satisfies the following:
	\begin{enumerate}
		\item the auxiliary norm $N:[0,1]\times \cW \to \Q^+$ restricts to $N_0$ on $\{0\}\times \cW$ and restricts to $N_1$ on $\{1\}\times \cW$,
		\item the open neighborhood $\cU$ of $\cS (\tdelbar)$ satisfies $\cU \cap (\{0\}\times \cZ )= \cU_0$ and $\cU \cap (\{1\}\times \cZ )= \cU_1$.
	\end{enumerate}

	In addition, there exists a regular perturbation $\tilde{\Lambda}$ of $\tdelbar$ with respect to the pair $(N,\cU)$, such that $\tilde{\Lambda}|_{\{0\}\times \cW}$ can be identified with $\Lambda_0$ and likewise $\tilde{\Lambda}|_{\{1\}\times \cW}$ can be identified with $\Lambda_1$.

	It follows that the perturbed solution set $\cS (\tdelbar, \tilde{\Lambda})$ has the structure of a compact weighted branched suborbifold, and is a cobordism between perturbed solution sets, in the sense that
	\[
		\partial \cS (\tdelbar, \tilde{\Lambda}) = -\cS (\delbar,\Lambda_0) \sqcup \cS (\delbar,\Lambda_1).
	\]
\end{theorem}

\subsection{The branched integral and polyfold invariants}\label{subsec:branched-integral-polyfold-invariants}

We now describe how to define the polyfold invariants through the use of the branched integral. The definition of the branched integral theory on compact oriented weighted branched suborbifolds was originally developed in \cite{HWZint}.

\begin{definition}[{\cite[Def.~4.9]{HWZbook}}]
	Let $\cZ$ be a polyfold with an associated polyfold structure $(Z,\bm{Z})$.
	The vector space of $\ssc$-differential $k$-forms $\Omega^k (Z)$ is the set of $\ssc$-smooth maps
	\[\ww:\bigoplus^k_{n=1} TZ\rightarrow \R\]
	defined on the Whitney sum of the tangent of the object space, which are linear in each argument and skew-symmetric.
	Moreover, we require that the maps $\ww$ are morphism invariant in the following sense: for every morphism $\phi: x\to y$ in $\bm{Z}_1$ with tangent map $T\phi:T_xZ\rightarrow T_yZ$ we require that
	\[
		(T\phi)^*\ww_y=\ww_x.
	\]
\end{definition}

Recall the definition of $\cZ^i$ as the shifted polyfold with shifted polyfold structure $(Z^i,\bm{Z}^i)$.
Via the inclusion maps $\cZ^i \hookrightarrow \cZ$ we may pullback a $\ssc$-differential $k$-form $\ww$ in $\Omega^k(Z)$ to $\Omega^k(Z^i)$, obtaining a directed system
\[
	\Omega^k(Z) \to \cdots \to \Omega^k(Z^i) \to \Omega^k(Z^{i+1}) \to \cdots,
\]
we denote by $\Omega^k_\infty (Z)$ the direct limit of this system.
As defined in \cite[p.~149]{HWZbook} there exists an \textbf{exterior derivative}
\[
	d:\Omega^*(Z^{i+1}) \to \Omega^{* +1}(Z^i)
\]
such that the composition $d\circ d = 0$.
The exterior derivative commutes with the inclusion maps $Z^i \hookrightarrow Z^{i+1}$ and hence induces a map
\[
	d:\Omega^*_\infty(Z) \to \Omega^{* +1}_\infty(Z)
\]
which also satisfies $d\circ d =0$.

\begin{theorem}[{\cite[Thm.~9.2]{HWZbook}}]\label{def:branched-integral}
	Let $\cZ$ be a polyfold with polyfold structure $(Z,\bm{Z})$ which admits $\ssc$-smooth partitions of unity.
	Given a $\ssc$-smooth differential form $\ww\in \Omega^n_\infty (Z)$ and an $n$-dimensional compact oriented weighted branched suborbifold $\cS\subset \cZ$.

	Then there exists a well-defined \textbf{branched integral}, denoted as
	\[\int_{\cS} \ww,\]
	which is partially characterized by the following property.
	Consider a point $[x]\in \cS$ and a representative $x\in S$ with isotropy group $\bm{G}(x)$. Let $(M_i)_{i\in I}$, $(w_i)_{i\in I}$, $(o_i)_{i\in I}$ be a local branching structure at $x$ contained in a $\bm{G}(x)$-invariant open neighborhood $U\subset Z$ of $x$.
	Consider a $\ssc$-smooth differential form $\ww\in \Omega^n_\infty (Z)$ and suppose that $\abs{\supp \ww} \subset \abs{U}$.
	Then
	\[
		\int_{\cS} \ww = \frac{1}{\sharp \bm{G}^\text{eff}(x)} \left( \sum_{i\in I} w_i \cdot \int_{(M_i,o_i)} \ww\right)
	\]
	where $\sharp \bm{G}^\text{eff}(x)$ is the order of the effective isotropy group and $\int_{(M_i,o_i)} \ww$ is the usual integration of the differential $n$-form $\ww$ on the oriented $n$-dimensional manifold $M_i$.
\end{theorem}

\begin{theorem}[Stokes' theorem, {\cite[Thm.~9.4]{HWZbook}}]\label{thm:stokes}
	Let $\cZ$ be a polyfold with polyfold structure $(Z,\bm{Z})$ which admits $\ssc$-smooth partitions of unity.
	Let $\cS$ be an $n$-dimensional compact oriented weighted branched suborbifold, and let $\partial \cS$ be its boundary with induced weights and orientation.  Consider a $\ssc$-differential form $\omega\in \Omega^{n-1}_\infty (Z)$.
	Then
	\[
		\int_{\cS} d\omega   = \int_{\partial \cS} \omega.
	\]
\end{theorem}

The next theorem follows the same reasoning used to prove \cite[Thm.~11.8]{HWZbook}.
\begin{theorem}[Change of variables]\label{thm:change-of-variables}
	Let $\cS_i\subset \cZ_i$ be $n$-dimensional compact oriented weighted branched suborbifolds with weight functions $\vartheta_i:\cS_i \to \Q^+$ for $i=1,2$.
	Let $(S_i,\bm{S_i})$ be the associated branched suborbifold structures with associated weight functors $\hat{\vartheta}_i: (S_i,\bm{S_i}) \to \Q^+$ for $i=1,2$.

	Let $g:\cZ_1 \to \cZ_2$ be a $\ssc$-smooth map between polyfolds, which has a well-defined restriction $g|_{\cS_1}	: \cS_1 \to \cS_2$ between the branched suborbifolds. In addition, assume the following:
	\begin{itemize}
		\item $g: \cS_1 \to \cS_2$ is a homeomorphism between the underlying topological spaces,
		\item $\hat{g}: S_1\to S_2$ is injective and an orientation preserving local homeomorphism,
		\item $g$ is weight preserving, i.e., $\vartheta_2\circ g=\vartheta_1$ and $\hat{\vartheta}_2 \circ \hat{g}=\hat{\vartheta}_1$.
	\end{itemize}

	Then given a $\ssc$-smooth differential form $\ww \in \Omega^n_\infty (Z_2)$,
	\[
		\int_{\cS_2} \ww = \int_{\cS_1} g^* \ww.
	\]
\end{theorem}

\begin{theorem}[Polyfold invariants as branched integrals, {\cite[Cor.~15.2]{HWZbook}}]
	Consider a $\ssc$-smooth map
	\[
		f:\cZ \to \cO
	\]
	from a polyfold $\cZ$ to an orbifold $\cO$.
	We may define the \textbf{polyfold invariant} as the homomorphism obtained by pulling back a de Rahm cohomology class from the orbifold and taking the branched integral over a perturbed zero set:
	\[
		H^*_{\dR} (O) 	\to \R, \qquad \ww \mapsto \int_{\cS(p)} f^*\ww.
	\]
	By Theorem~\ref{thm:cobordism-between-regular-perturbations} and by Stokes' theorem~\ref{thm:stokes}, this homomorphism does not depend on the choice of abstract perturbation used to obtain the compact oriented weighted branched suborbifold $\cS(p)$.
\end{theorem}

\section{Local surjectivity of the linearized Cauchy--Riemann operator}\label{appx:local-surjectivity}


We recall some basic facts about the standard, linear Cauchy--Riemann operator.

\begin{proposition}[{\cite[Prop.~4.15]{HWZGW}}]\label{prop:linear-cr-cylinder}
	Let $H_c^{3,\delta_0}(\R\times S^1,{\mathbb R}^{2n})$ be the $\ssc$-Hilbert space with antipodal asymptotic constants, where the level $m$ has regularity $(m+3,\delta_m)$.  Let $J(0)$ be a constant almost complex structure on $\R^{2n}$.
	The Cauchy--Riemann operator
	\[
		\partial_s+J(0)\partial_t: H^{3,\delta_0}_c( \R\times S^1,\R^{2n} )\rightarrow H^{2,\delta_0}(\R\times S^1, \R^{2n} )
	\]
	is a $\ssc$-isomorphism.
\end{proposition}

This expression also gives the formula for the filled section for the Cauchy--Riemann operator, (see \cite[pp.~129--130]{HWZGW}).  We have a similar result for disks.

\begin{proposition}\label{prop:linear-cr-disk}
	Consider the $\ssc$-Hilbert space $H^3_\text{loc}(\mathbb{D},\R^{2n})$.  Let $J(0)$ be a constant almost complex structure on $\R^{2n}$.
	The Cauchy--Riemann operator
	\[
		\partial_s+J(0)\partial_t: H^3_\text{loc}(\mathbb{D},\R^{2n}) \to H^2_\text{loc}(\mathbb{D},\R^{2n})
	\]
	is surjective.
\end{proposition}
\begin{proof}
	This follows from \cite[Exer.~B.3.3]{MSbook}, where solutions can be constructed using the existence of solutions to the Laplacian.

\end{proof}

Consider now the Cauchy--Riemann section, defined on the underlying sets of the polyfold $\cZ_{A,g,k}^{3,\delta_0}$ and strong polyfold bundle $\cW_{A,g,k}^{2,\delta_0}$ by the equation
\[
	[\Sigma,j,M,D,u] \mapsto [\Sigma,j,M,D,u,\tfrac{1}{2}(du+J(u)\circ du \circ j))].
\]
In local $\ssc$-coordinates it has the following local expression
\[
	(a,v,\eta) \mapsto (a,v,\eta, \overline{\xi})
\]
where $\overline{\xi}$ is the unique solution of the equations
\begin{align}
	\Gamma (\oplus_a \exp_u \eta, \oplus_a u) \cdot \hat{\oplus}_a \overline{\xi} \circ \delta(a,v) & = \delbar_{J,j(a,v)} (\oplus_a \exp_u \eta),\nonumber \\
	\hat{\ominus}_a \overline{\xi} \cdot \frac{\partial}{\partial_s}                                & = 0, \label{eq:local-expression-cr-operator}
\end{align}
where:
\begin{itemize}
	\item $\delta(a,v):(T\Sigma_a,j(a,v)) \to (T\Sigma_a,j(a,0))$ is the complex linear map given by $\delta(a,v)h=\tfrac{1}{2}(id - j(a,0)\circ j(a,v)) h$,
	\item $\Gamma$ is defined via parallel transport of a complex connection, as follows.
	      Fix a complex connection on the almost complex vector bundle $(TM, J)\to M$, i.e., if $\nabla_X$ is the covariant derivative on $M$ belonging to the Riemaniann metric $\omega\circ (\id \oplus J)$, the connection $\tilde{\nabla}_X$, defined by $\tilde{\nabla}_XY=\nabla_XY-\frac{1}{2}J(\nabla_XJ)Y$, defines a complex connection, in the sense that it satisfies $\tilde{\nabla}_X(JY)=J(\tilde{\nabla}_XY)$.
	      If $\eta\in T_pM$ is a tangent vector, the parallel transport of a complex connection along the path $t\mapsto \exp_p (t\eta)$ for $t\in [0,1]$, defines the linear map
	      \[
		      \Gamma  (\exp_p(\eta), p):(T_pM, J(p))\to (T_{\exp_p(\eta)}M, J( \exp_p(\eta)))
	      \]
	      which is complex linear, hence $\Gamma (\exp_p(\eta), p)\circ J(p)= J( \exp_p(\eta))\circ  \Gamma (\exp_p(\eta), p)$.
\end{itemize}
A full explanation of these details can be found in \cite[p.~118, p.~126]{HWZGW}.

We can simplify this expression by fixing the coordinates $a=0$, $v=0$.  Moreover, we may identify a neighborhood of a point $q\in M$ with a neighborhood of $0\in\R^{2n}$ under which the Euclidean metric pulls back to the Riemannian metric on $M$.  The formula \eqref{eq:local-expression-cr-operator} defining $\overline{\xi}$  now becomes
\[
	\overline{\xi} = \Gamma (u+ \eta, u)^{-1} \cdot \left( \partial_s(u+\eta) + J(u+\eta ) \partial_t(u+\eta)	\right).
\]
Consider the linearization at a solution $\delbar_{J,j} u =0$ with respect to the coordinate $\eta$.  This linearization is given as follows:
\[
	\eta \mapsto \frac{1}{2} \left(	\partial_s \eta + J(u) \partial_t \eta + \partial_\eta J(u) \partial_t u	\right).
\]

\begin{lemma}[Local surjectivity of the linearized Cauchy--Riemann operator]\label{lem:local-surjectivity-cauchy-riemann}
	Let $(\Sigma,\allowbreak j,\allowbreak M,\allowbreak D,\allowbreak u)$ be a stable map which is a solution to the Cauchy--Riemann operator $\hdelbar$.  Let
	\[
		D_{u} \hdelbar : H^{3,\delta_0} (\Sigma, u^*TM) \to H^{2,\delta_0}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)
	\]
	be the linearization of $\hdelbar$ at $(\Sigma,j,M,D,u)$, considered as an $\ssc$-Fredholm operator between $\ssc$-Banach spaces, where we have fixed the complex structure on $(\Sigma,j)$ and the gluing parameters.
	Then there exist open subsets of the Riemann surface $\Sigma$:
	\begin{itemize}
		\item a disk-like neighborhood $D_{z_i}$ at every marked point $z_i \in M$ (regardless of whether we require $u$ is of class $H^{3,\delta_0}$ or of class $H^3_\text{loc}$ at $z_i$)
		\item disk-like neighborhoods $D_{x_a}\sqcup D_{y_a}$ at every nodal pair $\{x_a,y_a\}\in D$
		\item (if it exists) a component $S^2\subset \Sigma$ with two punctures, on which $u$ is constant
	\end{itemize}
	such that the restriction of $D_{u} \hdelbar$ to each of these regions is a surjective operator.
\end{lemma}
\begin{proof}
	We prove the existence of the first neighborhood, assuming $u$ is of class $H^3_\text{loc}$.  Consider the operator
	\[
		D_{u} \hdelbar : H^3_\text{loc} (\mathbb{D}, \R^{2n}) \to H^2_\text{loc} (\mathbb{D}, \R^{2n})
	\]
	which is defined by the local expression we have just discussed, i.e.,
	\[
		D_{u} \hdelbar \eta = \frac{1}{2} \left(	\partial_s \eta + J(u) \partial_t \eta + \partial_\eta J(u) \partial_t u	\right).
	\]
	Moreover, assume we have identified a neighborhood of $M$ with a neighborhood of $\R^{2n}$ such that $u(0) =0$.

	For every $\epsilon>0$ there exists a $\delta>0$ such that we have the following estimates for the ball $B_\delta(0)\subset \mathbb{D}$:
	\[
		\norm{(J(u)-J(0)) \partial_t \eta }_{H^2_\text{loc} (B_\delta, \R^{2n})} \leq \frac{\epsilon}{2} \cdot \norm{\eta}_{H^3_\text{loc} (B_\delta, \R^{2n})}
	\]
	and
	\[
		\norm{\partial_\eta J(u) \partial_t u}_{H^2_\text{loc} (B_\delta, \R^{2n})} \leq \frac{\epsilon}{2} \cdot \norm{\eta}_{H^3_\text{loc} (B_\delta, \R^{2n})}.
	\]
	We consider the restriction of $D_{u} \hdelbar$ to $H^3_\text{loc} (B_\delta, \R^{2n})$; we may write
	\[
		D_{u} \hdelbar \eta = \frac{1}{2} \left(	\partial_s \eta + J(0) \partial_t \eta\right)
		+ \frac{1}{2} \left((J(u)-J(0))\partial_t \eta\right)
		+ \frac{1}{2} \left(\partial_\eta J(u) \partial_t u \right).
	\]
	From Proposition~\ref{prop:linear-cr-disk} the first term on the right is surjective, while we can bound the other two terms on the right in the operator norm by $\epsilon$.  From classical functional analysis %
	the space of surjective operators is open.  Hence there exists some $\delta$ such that
	\[
		D_{u} \hdelbar : H^3_\text{loc} (B_\delta, \R^{2n}) \to H^2_\text{loc} (B_\delta, \R^{2n})
	\]
	is surjective.

	We prove the existence of first neighborhood, assuming $u$ is of class $H^{3,\delta_0}$.
	By symmetry, this will also show the existence of the second neighborhood.  Consider the operator
	\[
		D_{u} \hdelbar : H^{3,\delta_0}_c (\R^+\times S^1, \R^{2n}) \to H^{2,\delta_0} (\R^+\times S^1, \R^{2n})
	\]
	which is defined by the same expression as before.  Moreover, assume we have identified a neighborhood of $M$ with a neighborhood of $\R^{2n}$ such that $\lim_{s\to \infty} u(s) =0$.
	We proceed the same as before.  By \cite[Lem.~4.19]{HWZGW} there exists $R\geq 0$ such that we have the following estimate for the region $[R,\infty)\times S^1 \subset \R^+\times S^1$,
	\[
		\norm{ ( J(u)-J(0) ) \partial_t \eta }_{H^{2,\delta_0} ([R,\infty)\times S^1, \R^{2n})} \leq \frac{\epsilon}{2} \norm{\eta}_{H^{3,\delta_0}_c ([R,\infty)\times S^1, \R^{2n})}.
	\]
	The same argument shows that there exists $R\geq 0$ such that
	\[
		\norm{\partial_\eta J(u) \partial_t u}_{H^{2,\delta_0} ([R,\infty)\times S^1, \R^{2n})} \leq \frac{\epsilon}{2} \norm{\eta}_{H^{3,\delta_0}_c ([R,\infty)\times S^1, \R^{2n})}.
	\]
	One should be careful to note the presence of the exponential weights in the above norms.  Using Proposition~\ref{prop:linear-cr-cylinder}, we may use the same argument to conclude that there exists some $R\geq 0$ such that
	\[
		D_{u} \hdelbar : H^{3,\delta_0}_c ([R,\infty)\times S^1, \R^{2n}) \to H^{2,\delta_0} ([R,\infty)\times S^1, \R^{2n})
	\]
	is surjective.

	We prove the existence of the third neighborhood.  Noting that $u$ is constant on the component $S^2$, and assuming in our chart $u(S^2)=0$ the local expression for the linearized Cauchy--Riemann operator
	\[
		D_{u} \hdelbar :	H^{3,\delta_0}_{a,b}( \R\times S^1,\R^{2n} )\rightarrow H^{2,\delta_0}(\R\times S^1, \R^{2n} )
	\]
	is given by
	\[
		\eta \mapsto \partial_s+J(0)\partial_t \eta
	\]
	where $H^{3,\delta_0}_{a,b}( \R\times S^1,\R^{2n} )$ is the $\ssc$-Hilbert space of maps with asymptotic constant $a$ as $s\to -\infty$ and asymptotic constant $b$ as $s\to +\infty$.  By Proposition~\ref{prop:linear-cr-cylinder}, we can observe that this is a surjective Fredholm operator, with kernel the constant maps.
\end{proof}

As a consequence of the above lemma, we obtain the following.

\begin{corollary}\label{cor:vectors-which-span-cokernel}
	Shrink the above small disk-like neighborhoods slightly.  If necessary, shrink further in order to assume the regions are all disjoint.  Then there exist vectors $v_1, \ldots, v_k\in H^{2,\delta_0}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)$ such that
	\begin{itemize}
		\item $v_1, \ldots, v_k$ together with $\text{Im} (D_{u} \hdelbar)$ span $H^{2,\delta_0}(\Sigma,\Lambda^{0,1} \otimes_J u^* TM)$
		\item $v_1, \ldots, v_k$ vanish on the above regions of $\Sigma$.
	\end{itemize}
\end{corollary}

\begin{remark}
	This is not the full linearization of the $\ssc$-smooth proper Fredholm operator $\delbarj :\cZ \to \cW$, rather the linearization restricted to the subset $a=0, v=0$.  However, the image of the full linearization contains $\text{Im} (D_{u} \hdelbar)$, so all this implies is that the number of vectors in the above corollary will be greater or equal to the dimension of the cokernel of the full linearization.
\end{remark}
Polyfold theory, as developed by Hofer, Wysocki, and Zehnder, is a relatively new approach to resolving transversality issues that arise in the study of $J$-holomorphic curves in symplectic geometry.
This approach has recently led to a well-defined Gromov--Witten invariant for $J$-holomorphic curves of arbitrary genus, and for all closed symplectic manifolds.

The Gromov--Witten axioms, as originally described by Kontsevich and Manin, give algebraic relationships between the Gromov--Witten invariants.
In this paper, we prove the Gromov--Witten axioms for the polyfold Gromov--Witten invariants.


\section{Introduction}

\subsection{History}

In 1985 Gromov published the paper ``Pseudo holomorphic curves in symplectic manifolds'', laying the foundations for the modern study of pseudo holomorphic curves (also know as $J$-holomorphic curves) in symplectic topology \cite{G}.
In this paper, Gromov proved a compactness result for the moduli space of $J$-holomorphic curves in a fixed homology class.  This paper contained antecedents to the modern notion of the Gromov--Witten invariants in the proofs of the nonsqueezing theorem and the uniqueness of symplectic structures on $\CP^2$.

Around 1988, inspired by Floer's study of gauge theory on three manifolds, Witten introduced the topological sigma model \cites{floer1988instanton, witten1988topological}.
The invariants of this model are the ``$k$-point correlation functions'', another precursor to the modern notion of the Gromov--Witten invariants.
Witten also observed some of the relationships between these invariants and possible degenerations of Riemann surfaces \cite{witten1990two}.
Further precursors to the notion of the Gromov--Witten invariants can also be seen in McDuff's classification of symplectic ruled surfaces \cite{mcduff1991symplectic}.

In 1993 Ruan gave a modern definition of the genus zero Gromov--Witten invariants for semipositive symplectic manifolds \cites{ruan1996topological, ruan1994symplectic}.  At the end of 1993, Ruan and Tian established the associativity of the quantum product for semipositive symplectic manifolds, giving a mathematical basis to the composition law of Witten's topological sigma model \cite{rt1995quatumcohomology}.

In 1994 Kontsevich and Manin stated the Gromov--Witten axioms, given as a list of formal relations between the Gromov--Witten invariants \cite{KM}.
At the time it was not possible for Kontsevich and Manin to give a proof of the relations they listed; the definition of the Gromov--Witten invariant (complete with homology classes from a Deligne--Mumford space) would require in addition new ideas involving ``stable maps'' \cite{Kstable}.
Hence they used to term ``axiom'' with the presumed meaning ``to take for assumption without proof''/``to use as a premise for further reasoning''.  And indeed, from these starting assumptions they were able to establish foundational results in enumerative geometry, answers to esoteric questions such as:
\begin{namedthm*}{Kontsevich's recursion formula}
	Let $d\geq 1$.  How many degree $d$ rational curves in $\CP^2$ pass through $3d - 1$ points in general position?
\end{namedthm*}
Moreover, in this paper they outlined some of the formal consequences of the axioms by demonstrating how to combine the invariants into a Gromov--Witten potential, and interpret the axioms as differential equations which the potential satisfies.

To varying extents, this work has predated the construction of a well-defined Gromov--Witten invariant in symplectic geometry for $J$-holomorphic curves of arbitrary genus, and for all closed symplectic manifolds.
Efforts to construct a well-defined Gromov--Witten invariant constitute an ever growing list of publications, including but not limited to the following: \cites{LT, FO, fukaya2012technical, Si, cieliebak2007symplectic, mcduff2012smooth, mcduff2018fundamental, MWtopology, ionel2013natural, pardon2016algebraic}.
A discussion of some of the difficulties inherent in these approaches can be found in \cite{ffgw2016polyfoldsfirstandsecondlook}.
Similarly, there have been several efforts to prove the Gromov--Witten axioms \cites{FO, MSbook, castellano2016genus}.

Over the past two decades, Hofer, Wysocki, and Zehnder have developed a new approach to resolving transversality issues that arise in the study of $J$-holomorphic curves in symplectic geometry called \textit{polyfold theory} \cites{HWZ1, HWZ2, HWZ3, HWZGW, HWZsc, HWZdm, HWZint, HWZbook}.  This approach has been successful in constructing a well-defined Gromov--Witten invariant \cite{HWZGW}.

\subsection{The polyfold Gromov--Witten invariants}

Let $(M,\ww)$ be a closed symplectic manifold and let $J$ be a compatible almost complex structure.
Let $2n:= \dim_{\R} M$.
For a fixed homology class $A\in H_2(M,\Z)$, and for fixed integers $g\geq 0$, $k\geq 0$, we consider the following set:
\[
	\cM_{A,g,k}(J) :=
	\left\{
	\begin{array}{c}
		u: (\Sigma_g,j) \to M \\
		\{z_1,\ldots,z_k\}\in \Sigma_g
	\end{array}
	\biggm|
	\begin{array}{c}
		\tfrac{1}{2} (du+J\circ du\circ j)=0 \\
		u_*[\Sigma_g] = A
	\end{array}
	\right\}
	\biggm/
	\begin{array}{l}
		u \sim u\circ \phi, \\
		\phi\in \Aut
	\end{array}
\]
consisting of smooth maps $u:(\Sigma_g,j)\to M$ which satisfy the Cauchy--Riemann equation modulo reparametrization; here $(\Sigma_g,j)$ is a genus $g$ Riemann surface and $\Aut$ is the automorphism group of the Riemann surface $(\Sigma_g,j)$ which preserves the ordering of the marked points.
We will refer to an equivalence class of a map which solves the Cauchy--Riemann equation as a \textbf{$J$-holomorphic curve}.

Gromov's compactness theorem states that given a sequence of $J$-holomorphic curves there exists a subsequence which ``weakly converges'' to a ``cusp-curve'' \cite{G}.
This was later refined in \cite{Kstable} into the ``stable map compactification''.
Consequently, the set $\cM_{A,g,k}(J)$ can be compactified by adding nodal curves yielding a \textit{compact} topological space
\[
	\CM_{A,g,k}(J) := \cM_{A,g,k}(J) \sqcup \{\text{nodal curves}\}.
\]
We call this space the \textbf{unperturbed Gromov--Witten moduli space} of genus $g$, $k$ marked stable curves which represent the class $A$.

In a set of small but often studied cases where the symplectic manifold $(M,\ww)$ is ``semipositive'' it is possible to give this compact topological space the additional structure of a ``pseudocycle,'' which is suitable for defining an invariant.
This is achieved via a perturbation of the almost complex structure $J$.
The space of compatible almost complex structures $\mathcal{J}(M,\ww)$ is nonempty and contractible, from which it can be shown that the invariant does not depend on the choice of $J$.
However in general symplectic manifolds no $J\in \mathcal{J}(M,\ww)$ can give sufficient transversality to yield a well-defined invariant.  For a textbook treatment of this material, we refer to \cite{MSbook}.

Polyfold theory, developed by Hofer, Wysocki, and Zehnder, is a relatively new approach to resolving transversality issues that arise in attempts to solve moduli space problems in symplectic geometry.
The polyfold theoretic approach to solving a moduli space problem is to recast the problem into familiar terms from differential geometry.
To do this, we may construct a ``Gromov--Witten polyfold'' $\cZ_{A,g,k}$---a massive, infinite-dimensional ambient space, designed to contain the entire unperturbed Gromov--Witten moduli space $\CM_{A,g,k}(J)$ as a compact subset.
We may furthermore construct a ``strong polyfold bundle'' $\cW_{A,g,k}$ over $\cZ_{A,g,k}$; the Cauchy--Riemann operator then defines a ``scale smooth Fredholm section'' of this bundle, $\delbarj :\cZ_{A,g,k} \to \cW_{A,g,k}$, such that $\delbarjinv(0) = \CM_{A,g,k}(J)$.
We can construct ``abstract perturbations'' $p$ of this section such that $\delbarj +p$ is transverse to the zero section and such that $(\delbarj+p)^{-1}(0)$ is a compact set.
In this way, we may take a scale smooth Fredholm section and ``regularize'' the unperturbed Gromov--Witten moduli space yielding a \textbf{perturbed Gromov--Witten moduli space} $\cS_{A,g,k}(p):= \text{`` }(\delbarj+p)^{-1}(0) \text{ ''}$ which has the structure of a compact oriented ``weighted branched orbifold''.

\[
	\begin{array}{c}
		\CM_{A,g,k}(J) = \delbarj^{-1}(0)        \\
		\text{\small{compact topological space}} \\
		\mbox{}
	\end{array}
	\begin{tikzcd}
		\mbox{} \arrow[rrr, "\text{\small{``polyfold regularization''}}", squiggly] & \mbox{} & \mbox{} & \mbox{}
	\end{tikzcd}
	\begin{array}{c}
		\cS_{A,g,k}(p):=(\delbarj+p)^{-1}(0) \\
		\text{\small{compact ``weighted}}    \\
		\text{\small{branched orbifold''}}
	\end{array}
\]

This approach has been successful in giving a well-defined Gromov--Witten invariant for curves of arbitrary genus, and for all closed symplectic manifolds.
Suppose that $2g+k\geq 3$, and consider the following diagram of smooth maps between the perturbed Gromov--Witten moduli space $\cS_{A,g,k}(p)$, the $k$-fold product manifold $M^k$, and the Deligne--Mumford orbifold $\dmlog_{g,k}$:
\[
	\begin{tikzcd}[column sep=12ex]
		\cS_{A,g,k}(p) \arrow{r}{ev_1\times\cdots\times ev_k} \arrow{d}{\pi} & M^k\\
		\dmlog_{g,k}
	\end{tikzcd}
\]
Here $ev_i$ is evaluation at the $i$th-marked point, and $\pi$ is the projection map to the Deligne--Mumford space which forgets the stable map solution and stabilizes the resulting nodal Riemann surface by contracting unstable components.

Consider homology classes $\alpha_1,\ldots, \alpha_k \in H_* (M;\Q)$ and $\beta\in H_* (\dmlog_{g,k};\Q)$.
We can represent the Poincar\'e duals of the $\alpha_i$ and $\beta$ by closed differential forms in the de Rahm cohomology groups, $\PD(\alpha_i)\in H^*_{\dR} (M)$ and $\PD(\beta)\in H^*_{\dR}(\dmlog_{g,k})$.
By pulling back via the evaluation and projection maps, we obtain a closed $\ssc$-smooth differential form
\[
	ev_1^* \PD (\alpha_1) \wedge \cdots \wedge ev_k^* \PD(\alpha_k) \wedge\pi^* \PD (\beta) \in H^*_{\dR} (\cZ_{A,g,k}).
\]

\begin{theorem}[{\cite{HWZGW}*{Thm.~1.12}}]
	The \textbf{polyfold Gromov--Witten invariant} is the homomorphism
	\[
		\GW_{A,g,k} : H_* (M;\Q)^{\otimes k} \otimes H_* (\dmlog_{g,k}; \Q) \to \Q
	\]
	defined via the ``branched integration'' of \cite{HWZint}:
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k;\beta) : = \int_{\cS_{A,g,k}(p)} ev_1^* \PD (\alpha_1) \wedge \cdots \wedge ev_k^* \PD(\alpha_k) \wedge\pi^* \PD (\beta).
	\]
	This invariant does not depend on the choice of perturbation.
\end{theorem}

For a survey of the core ideas of the polyfold theory, we refer to \cite{ffgw2016polyfoldsfirstandsecondlook}.
For a complete treatment of polyfold theory in the abstract, we refer to \cite{HWZbook}.
For the construction of the GW-polyfolds and the polyfold GW-invariants, we refer to \cite{HWZGW}.

\subsection{The Gromov--Witten axioms}

With a general polyfold Gromov--Witten invariant in place, a natural question is: To what extent does this newly defined invariant satisfy traditional results of Gromov--Witten theory for symplectic manifolds?  A natural place to begin is with verifying the Gromov--Witten axioms.

\begin{mainresult}
	The polyfold Gromov--Witten invariants satisfy the Gromov--Witten axioms.
\end{mainresult}
\begin{axiom*}{Effective axiom}
	If $\ww (A) <0 $ then $\GW_{A,g,k} = 0$.
\end{axiom*}
\begin{axiom*}{Grading axiom}
	If $\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta) \neq 0$ then
	\[
		\sum_{i=1}^k (2n - \deg (\alpha_i)) + (6g-6+2k - \deg(\beta)) = 2c_1(A) + (2n - 6)(1-g) + 2k.
	\]
\end{axiom*}
\begin{axiom*}{Homology axiom}
	There exists a homology class
	\[
		\sigma_{A,g,k} \in H_{2c_1(A) + (2n-6)(1-g) + 2k} (M^k\times \dmspace_{g,k};\Q)
	\]
	such that
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta) = \langle p_1^* \PD(\alpha_1) \smallsmile \cdots \smallsmile p_k^*\PD (\alpha_k) \smallsmile p_0^*\PD(\beta), \sigma_{A,g,k} \rangle
	\]
	where $p_i: M^k \times \dmspace_{g,k} \to M$ denotes the projection onto the $i$th factor and the map $p_0:M^k \times \dmspace_{g,k}\to\dmspace_{g,k}$ denotes the projection onto the last factor.
\end{axiom*}
\begin{axiom*}{Zero axiom}
	If $A=0,\ g=0$ then $\GW_{0,0,k} (\alpha_1,\ldots,\alpha_k;\beta) = 0$ whenever $\deg (\beta) >0$, and
	\[
		\GW_{0,0,k} (\alpha_1,\ldots,\alpha_k; [\pt])
		= \int_M \PD(\alpha_1) \wedge \cdots \wedge \PD(\alpha_k).
	\]
\end{axiom*}
\begin{axiom*}{Symmetry axiom}
	Fix a permutation $\sigma: \{1,\ldots, k\}\to \{1,\ldots,k\}$.  Consider the permutation map $\sigma:\dmlog_{g,k}\to \dmlog_{g,k}, \ [\Sigma,j,M,D]  \mapsto [\Sigma,j,M^\sigma,D]$ where $M = \{z_1,\ldots,z_k\}$ and where $M^\sigma := \{z'_1,\ldots,z'_k\}$, $z'_i:= z_{\sigma(i)}$.
	Then
	\[
		\GW_{A,g,k} (\alpha_{\sigma(1)},\ldots,\alpha_{\sigma(k)}; \sigma_*\beta) = (-1)^{N(\sigma;\alpha_i)} \GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta)
	\]
	where $N(\sigma;\alpha_i):= \sharp 	\{	i<j \mid \sigma(i)> \sigma(j), \deg (\alpha_i)\deg(\alpha_j)\in 2\Z +1	\}	$.
\end{axiom*}

\begin{definition}[{\cite{KM}*{Eq.~2.3}}]\label{def:basic-classes}
	We say that $(A,g,k)$ is a \textbf{basic class} if it is equal to one of the following: $(A,0,3)$, $(A,1,1)$, or $(A,g\geq 2,0)$.
\end{definition}
The point is, for such values of $g$ and $k$ we will have $\dmspace_{g,k-1} = \emptyset$ by definition.

\begin{axiom*}{Fundamental class axiom}
	Consider the fundamental classes $[M]\in H_{2n}(M;\Q)$ and $[\dmlog_{g,k}] \in H_{6g-6+2k}(\dmlog_{g,k};\Q)$.  Suppose that $A\neq 0$ and that $(A,g,k)$ is not basic.  Then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; [\dmlog_{g,k}]) = 0.
	\]

	Consider the canonical section $s_i :\dmlog_{g,k-1} \to \dmlog_{g,k}$ defined by doubling the $i$th-marked point.  Then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; s_{i*}\beta) = \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta).
	\]
\end{axiom*}

\begin{axiom*}{Divisor axiom}
	Suppose $(A,g,k)$ is not basic.
	If $\deg (\alpha_k) = 2n-2$ then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \PD (ft_k^* \PD (\beta))) = (A\cdot \alpha_k ) \ \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta),
	\]
	where $A\cdot \alpha_k$ is given by the homological intersection product.
\end{axiom*}

Let $\{e_\nu \} \in H^*(M;\Q)$ be a homogeneous basis and let $\{e^\mu \} \in H^*(M;\Q)$ be the dual basis with respect to Poincar\'e duality, i.e., $\langle e_\nu \smallsmile e^\mu, [M] \rangle = \delta_{\nu \mu}$.
It follows from the K\"unneth formula that $\{e_\nu \otimes e^\mu \}$ is a basis for $H^*(M\times M;\Q)$.
We correct the sign by redefining $e_\nu$ as $(-1)^{\deg e_\nu} e_\nu$.
We can write the Poincar\'e dual of the diagonal $\Delta \subset M\times M$ in this basis as
$\PD([\Delta]) = \sum_\nu e_\nu \otimes e^\nu$ (see \cite{bott2013differential}*{Lem.~11.22}).

\begin{axiom*}{Splitting axiom}
	Fix a partition $S_0 \sqcup S_1 =\{1,\ldots, k\}$.
	Let $k_0 := \sharp S_0$, $k_1 := \sharp S_1$ and let $g_0$, $g_1 \geq 0$ such that $g = g_0 + g_1$,
	and $k_i + g_i \geq 2$ for $i=0,1$.
	Consider the natural map
	\[\phi_S : \dmspace_{k_0+1 , g_0}\times \dmspace_{k_1+1 , g_1} \to \dmspace_{g,k}\]
	which identifies the last marked point of a stable noded Riemann surface in $\dmspace_{k_0+1 , g_0}$ with the first marked point of a stable noded Riemann surface in $\dmspace_{k_1+1, g_1}$, and which maps the first $k_0$ marked points of $\dmspace_{g_0,k_0+1}$ to marked points indexed by $S_0$ and likewise maps the last $k_1$ marked points of $\dmspace_{g_1,k_1+1}$ to marked points indexed by $S_1$.
	Then
	\begin{align*}
		 & \GW_{A,g,k} (\alpha_1, \ldots, \alpha_k; \phi_{S*} (\beta_0\otimes \beta_1) ) =
		(-1)^{N(S;\alpha)} \sum_{A_0+A_1 = A}	\sum_\nu                                     \\
		 & \qquad
		\GW_{A_0,g_0,k_0+1} (\{\alpha_i\}_{i\in S_0}, \PD (e_\nu) ; \beta_0)
		\cdot
		\GW_{A_1,g_1,k_1+1} (\PD (e^\nu), \{\alpha_j\}_{j\in S_1} ; \beta_1)
	\end{align*}
	where $N(S;\alpha)=\sharp \{j<i \mid i\in S_0, j\in S_1, \deg(\alpha_i)\deg(\alpha_j)\in 2\Z +1 \}$.
\end{axiom*}

\begin{axiom*}{Genus reduction axiom\footnote{We note that the original statement \cite{KM}*{Eq.~2.12} missed the additional factor of $2$.}}
	Consider the natural map
	\[\psi: \dmspace_{g-1,k+2} \to \dmspace_{g,k}\]
	which identifies the last two marked points of a stable noded Riemann surface, increasing the arithmetic genus by one.
	Then
	\[
		2 \cdot \GW_{A,g,k} (\alpha_1, \ldots, \alpha_k; \psi_* \beta) = \sum_\nu \GW_{A,g-1,k+2} (\alpha_1,\ldots,\alpha_k, \PD (e_\nu) , \PD (e^\nu) ; \beta).
	\]
\end{axiom*}

\subsection{Strategy of the proof}

The Gromov--Witten axioms give relationships between the Gromov--Witten invariants.
These relationships are determined by the geometry of certain naturally defined maps defined between the unperturbed Gromov--Witten moduli spaces, namely:
\begin{itemize}
	\item permutation maps, \[\sigma : \CM_{A,g,k}(J) \to \CM_{A,g,k}(J),\]
	\item $k$th-marked point forgetting maps, \[ft_k : \CM_{A,g,k}(J) \to \CM_{A,g,k-1}(J),\]
	\item canonical sections, \[s_i : \CM_{A,g,k-1}(J) \hookrightarrow \CM_{A,g,k}(J).\]
\end{itemize}

Furthermore, using the map
\[
	ev_{k_0+1} \times ev_1 : \CM_{A_0,g_0,k_0+1}(J) \times \CM_{A_1,g_1,k_1+1}(J) \to M\times M
\]
we may consider the subset  $(ev_{k_0+1} \times ev_1 )^{-1}(\Delta)$ of the product unperturbed Gromov--Witten moduli space with a constraint imposed by the diagonal $\Delta \subset M\times M$.
We then additionally have:
\begin{itemize}
	\item inclusion maps, and maps $\phi$ which identify the marked points $z_{k_0+1}$ and $z_1'$,
\end{itemize}
\[
	\begin{tikzcd}
		\CM_{A_0,g_0,k_0+1}(J) \times \CM_{A_1,g_1,k_1+1}(J)	&	\\
		(ev_{k_0+1} \times ev_1 )^{-1}(\Delta) \arrow[u, hook, "i"] \arrow[r, "\phi"] & \CM_{A_0+A_1,g_0+g_1,k_0+k_1}(J)
	\end{tikzcd}
\]
Likewise, using the map
$ev_{k+1} \times ev_{k+2} : \CM_{A,g-1,k+2}(J) \to M\times M$
we may consider the subset $(ev_{k+1} \times ev_{k+2} )^{-1}(\Delta)$ of the unperturbed Gromov--Witten moduli space with a constraint imposed by the diagonal $\Delta \subset M\times M$.
We then additionally have:
\begin{itemize}
	\item inclusion maps, and maps $\psi$ which identify the marked points $z_{k+1}$ and $z_{k+2}$ (increasing the arithmetic genus by one),
\end{itemize}
\[
	\begin{tikzcd}
		\CM_{A,g-1,k+2}(J)	&	\\
		(ev_{k+1} \times ev_{k+2} )^{-1}(\Delta) \arrow[u, hook, "i"] \arrow[r, "\psi"] & \CM_{A,g,k}(J)
	\end{tikzcd}
\]

Intuitively, we should prove the Gromov--Witten axioms by interpreting the Gromov--Witten invariants as a finite count of curves and using the geometry of the above maps to directly compare such counts with respect to constraints imposed by the homology classes on $M$ and $\dmlog_{g,k}$.

A substantial amount of work is required to make this intuition rigorous in the context of an abstract perturbation theory.
A deep understanding of the full machinery of polyfold theory, in addition to the geometry of the Gromov--Witten invariants is necessary to navigate substantial difficulties that we encounter.

\subsubsection*{The polyfold Gromov--Witten invariants as intersection numbers}

The branched integral is useful for giving a well-defined definition of the polyfold Gromov--Witten invariants and moreover showing that they are, in fact, invariants and do not depend on choices.  But they are not the best viewpoint for giving a proof of all of the axioms.

To prove the Gromov--Witten axioms, it is necessary to interpret the Gromov--Witten invariants as a finite count of curves via intersection theory.
By \cite{schmaltz2019steenrod}*{Cor.~1.7}, the polyfold Gromov--Witten invariants may equivalently be defined as an intersection number evaluated on a basis of representing submanifolds $\cX \subset M$ and {representing suborbifolds} $\cB \subset \cO$:
\[
	\GW_{A,g,k} ([\cX_1],\ldots,[\cX_k];[\cB]) :=
	\left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
\]
The invariant does not depend on the choice of abstract perturbation, nor on the choice of representing basis.
Thus, the traditional geometric interpretation of the Gromov--Witten invariants as a ``count of curves which at the $i$th-marked point passes through $\cX_i$ and such that the image under the projection $\pi$ lies in $\cB$'' is made literal.

\subsubsection*{Pulling back abstract perturbations}

In some cases there exist natural extensions of these maps from the Gromov--Witten moduli spaces to the modeling Gromov--Witten polyfolds.
However, these maps will not in general \textit{persist} after abstract perturbation, i.e., maps between Gromov--Witten polyfolds will not have well-defined restrictions to the perturbed Gromov--Witten moduli spaces.

In the semipositive situation, the set of compatible almost complex structures $\cJ (M, \ww)$ gives a common space of perturbations; we can therefore choose a common regular $J$ for the source and target of a map and obtain a well-defined map between Gromov--Witten moduli spaces.

In contrast, abstract perturbations are constructed using bump functions and choices of vectors in a strong polyfold bundle, which in general we cannot assume will be preserved by an arbitrary map between Gromov--Witten polyfolds.
For example, consider the permutation map which lifts to a $\ssc$-diffeomorphism
$\sigma: \cZ_{A,g,k} \to \cZ_{A,g,k}$.
In general, the aforementioned bump functions and choices of vectors in a strong polyfold bundle will not exhibit symmetry with regards to the labelings of the marked points.
As a result, given a stable curve $x \in \cZ_{A,g,k}$ which satisfies a perturbed equation $(\delbarj +p )(x)=0$ we cannot expect that  $(\delbarj +p )(\sigma (x))=0$.
Therefore, naively there does not exist a well-defined permutation map between perturbed Gromov--Witten moduli spaces.

The natural approach for obtaining a well-defined map between perturbed moduli spaces is to pullback an abstract perturbation.
In \S\ref{subsec:pulling-back-abstract-perturbations} we apply \cite{schmaltz2019naturality}*{Thm.~1.7} to obtain well-defined restricted maps between perturbed Gromov--Witten moduli spaces for several of the maps we have considered.

\subsubsection*{Problems arise}

The $k$th-marked point forgetting map is, by far, the most difficult and complicated map to define between perturbed Gromov--Witten moduli spaces, as we immediately encounter numerous difficulties.

The construction of the smooth structure for the Deligne--Mumford orbifolds as described in \cites{HWZGW, HWZdm} requires a choice: that of a ``gluing profile'', i.e., a smooth diffeomorphism $\varphi: (0,1]\to [0,\infty)$.
The logarithmic gluing profile is given by
\[\varphi_{\log} (r) = -\frac{1}{2\pi} \log (r)\]
and produces the classical holomorphic Deligne--Mumford orbifolds $\dmlog_{g,k}$.  There is also an exponential gluing profile, given by
\[\varphi_{\exp} (r) = e^{1/r} - e\]
which produces Deligne--Mumford orbifolds $\dmexp_{g,k}$ which are only smooth orbifolds.

This use of nonstandard smooth structure has the following consequence:
\begin{problem_intro}
	In general the map $ft_k: \dmexp_{g,k} \to \dmexp_{g,k-1}$ is continuous but not differentiable.
\end{problem_intro}

Independent of the usage of a nonstandard gluing profile, there is no hope of defining a $k$th-marked point forgetting map on the Gromov--Witten polyfolds as they are defined:
\begin{problem_intro}
	In general there does not exist a natural map $ft_k$ on the Gromov--Witten polyfolds.
\end{problem_intro}
The reason is that the GW-stability condition \eqref{eq:gw-stability-condition} imposed on stable curves in the polyfold $\mathcal{Z}_{A,g,k}$ may not hold in $\mathcal{Z}_{A,g,k-1}$ once the $k$th point is removed.

A stable curve in $\cZ_{A,g,k}$ may contain a ``destabilizing ghost component'', i.e., a component $C_k\simeq S^2$ with precisely $3$ special points, one of which is the $k$th-marked point, and such that $\int_{C_k} u^*\ww =0, \ u|_{C_k} \neq\text{const}$.
After removal of the $k$th-marked point from such a component, the GW-stability condition \eqref{eq:gw-stability-condition} is no longer satisfied and we cannot consider the resulting data as a stable curve in $\cZ_{A,g,k-1}$.


We might try to consider a subset of stable curves in $\cZ_{A,g,k}$ for which the GW-stability condition \eqref{eq:gw-stability-condition} will hold after forgetting the $k$th-marked point; thus we can attempt to restrict to a subset $\cZ^\text{const}_{A,g,k}\subset \cZ_{A,g,k}$ with a stronger stability condition, and such that the $k$th-marked point forgetting map is well-defined on $\mathcal{Z}^\text{const}_{A,g,k}$.
However, if we consider $\mathcal{Z}^\text{const}_{A,g,k}\subset \mathcal{Z}_{A,g,k}$ with the subspace topology, and $\mathcal{Z}_{A,g,k-1}$ with the usual polyfold topology, then:
\begin{problem_intro}
	In general the well-defined restriction $ft_k:\cZ_{A,g,k}^\text{const} \to \mathcal{Z}_{A,g,k-1}$ is not continuous.
\end{problem_intro}

There is a final problem. In general, the projection map must factor through the $k$th-marked point forgetting map; this is due to the need to forget the added stabilizing points (see Proposition~\ref{prop:projection-map-smooth}). Thus, in order to obtain a smooth projection map we must map to the logarithmic Deligne--Mumford orbifold. However:
\begin{problem_intro}
	While the projection $\pi : \cZ_{A,g,k} \to \dmlog_{g,k}$ is $\ssc$-smooth, in general it is not a submersion.
\end{problem_intro}
This has important consequences if we wish to consider the Gromov--Witten invariant as an intersection number; the only way to get transversality of the projection map with a representing suborbifold $\cB \subset \dmlog_{g,k}$ is through perturbation of the suborbifold.
Fortunately, by \cite{schmaltz2019steenrod}*{Thm.~1.2} there exist suitable representing suborbifolds for which perturbation is possible \cite{schmaltz2019steenrod}*{Prop.~3.9}.

\subsubsection*{The universal curve polyfold}

In essence the central problem is that the Gromov--Witten polyfolds as constructed are not ``universal curves''.
Our proof of Gromov--Witten axioms rectifies this by constructing a universal curve polyfold $\cZ^\text{uc}_{A,g,k}$ over $\cZ_{A,g,k-1}$, on which we may consider a well-defined $k$th-marked point forgetting map
\[
	ft_k : \cZ^\text{uc}_{A,g,k} \to \cZ_{A,g,k-1}.
\]
The preimage of stable curve  in $\cZ_{A,g,k-1}$ via $ft_k$ consists of the underlying Riemann surface with nodes identified, thereby justifying our choice of nomenclature ``universal curve''.

Although this map is $\ssc^0$ due to the use of the exponential gluing profile, it is still possible to pullback $\ssc$-smooth abstract perturbations via this map.
Furthermore, applying \cite{schmaltz2019naturality}*{Thm.~1.3} we may prove that the invariants associated to the universal curve polyfold coincide with the usual polyfold Gromov--Witten invariants.

\subsection{Organization of the paper}

In \S\ref{sec:dm-orbifolds-gw-polyfolds} we review the construction of the DM-orbifolds and the GW-polyfolds.
In particular, we consider the local smooth structures given by the good uniformizing families of stable noded Riemann surfaces/stable maps. We also consider additional GW-type polyfolds needed to prove the splitting and genus reduction axioms.
In \S\ref{sec:maps-between-orbifolds-polyfolds} we consider certain naturally defined maps on the DM-orbifolds/GW-polyfolds.
In \S\ref{sec:the-polyfold-gw-invariants} we recall the definition of the polyfold GW-invariants, defined equivalently via the branched integral and by the intersection number. We show how to pullback abstract perturbations for many of the natural maps we are considering, yielding well-defined maps on the perturbed GW-moduli spaces.
In \S\ref{sec:problems-arise} we discuss the many problems that arise in considering the $k$th-marked point forgetting map.
In \S\ref{sec:universal-curve-polyfold} we construct the universal curve polyfold.
We prove that the invariants for this polyfold are equal to the usual GW-invariants.
Furthermore, we show that we can define a $k$th-marked point forgetting map on this polyfold, and that we may pullback abstract perturbations via this map.
In \S\ref{sec:gw-axioms} we prove the GW-axioms.


\section{The Deligne--Mumford orbifolds and the Gromov--Witten polyfolds}\label{sec:dm-orbifolds-gw-polyfolds}




In this section, we give a precise description of the underlying sets and the local smooth structures of the DM-orbifolds and GW-polyfolds.
A full treatment of the smooth structure of an orbifold or a polyfold requires in addition transition information for how these local smooth structures fit together; this is accomplished via the language of ep-groupoids.

Our discussion of the DM-orbifolds is from the perspective of modern symplectic geometry (rather than algebraic geometry), for this point of view, we refer to \cites{HWZdm,robbinsalamon2006delignemumford}.
Our discussion of the GW-polyfolds is due to \cite{HWZGW}.

\subsection{The Deligne--Mumford orbifolds}

We begin by describing the underlying sets of the DM-spaces and discussing their natural topology.

\begin{definition}\label{def:underlying-dmspace}
	For fixed integers $g\geq 0$ and $k\geq 0$ which satisfy $2g+k\geq 3$, the \textbf{underlying set of the Deligne--Mumford space} $\dmspace_{g,k}$ is defined as the set of equivalence classes of stable noded Riemann surfaces of arithmetic genus $g$ and with $k$ marked points, i.e.,
	\[
		\dmspace_{g,k}:= \{(\Sigma,j,M,D) \mid \cdots, \text{ DM-stability condition} \} / \sim
	\]
	with data as follows:
	\begin{itemize}
		\item $(\Sigma,j)$ is a closed (possibly disconnected) Riemann surface.
		\item $M$ consists of $k$ ordered distinct marked points $z_1,\ldots,z_k\in\Sigma$.
		\item $D$ consists of finitely many unordered nodal pairs $\{x,y\}$ with $x,y\in\Sigma$ and $x\neq y$.  We require that two such pairs are disjoint.  We require both elements of the pair to be distinct from $M$.  We denote $\abs{D} := \cup_{\{x,y\}\in D} \{x,y\} \subset \Sigma$, and we let $\sharp D:=\tfrac{1}{2} \sharp \abs{D}$, i.e., the number of pairs.
		\item Viewing each connected component $C\subset \Sigma$ as a vertex, and each nodal pair $\{x,y\}$ as an edge via the incidence relation $\{C_x,C_y\}$ if $x\in C_x,\ y\in C_y$, we obtain a graph $T$.  We require that $T$ be connected.
		\item The arithmetic genus $g$ is given as:
		      \[
			      g=\sum_{C} g_C + \text{number of cycles of the graph $T$}
		      \]
		      where the sum is taken over the finitely many connected components $C\subset \Sigma$, and where $g_C$ is defined as the genus of the connected component $C$.
		\item For each connected component $C\subset \Sigma $ we require the following \textbf{DM-stability condition}:
		      \begin{equation}
			      \label{eq:dm-stability-condition}
			      2 g_C+\sharp (M \cup \abs{D})_C \geq 3
		      \end{equation}
		      where $\sharp (M \cup \abs{D})_C := \sharp ((M\cup\abs{D}) \cap C)$, i.e., the number of marked and nodal points on the component $C$.
		\item The equivalence relation is given by $(\Sigma,j,M,D)\sim (\Sigma',j',M',D')$ if there exists a biholomorphism $\phi: (\Sigma,j)\to(\Sigma',j')$ such that $\phi(M)=M',\ \phi(\vert D\vert)=\vert D'\vert$, and which preserves the ordering of the marked points, and maps each pair of nodal points to a pair of nodal points. We call such a $\phi$ a \textbf{morphism between stable Riemann surface}, and write it as
		      \[
			      \phi: (\Sigma,j,M,D) \to (\Sigma',j',M',D').
		      \]
	\end{itemize}
	We will refer to any point in $M \cup \abs{D}$ as a \textbf{special point}.
	We call a tuple $(\Sigma,j,M,D)$ which satisfies the DM-stability condition a \textbf{stable noded Riemann surface}.
\end{definition}

For a fixed $(\Sigma,j,M,D)$ the \textbf{isotropy group}
\[
	\Aut(\Sigma,j,M,D) :=
	\left\{
	\begin{array}{c}
		\phi: (\Sigma,j) \to (\Sigma,j)
	\end{array}
	\biggm|
	\begin{array}{c}
		\phi \text{ biholomorphic},            \\
		\phi(M)=M \text{ preservers ordering}, \\
		\phi(\vert D\vert)=\vert D\vert
	\end{array}
	\right\}
\]
is finite if and only if the DM-stability condition holds.




\begin{proposition}[{\cite{HWZGW}*{Prop.~2.4}}]
	Independent of the construction of a smooth structure, the set $\dmspace_{g,k}$ has a natural second-countable, paracompact, Hausdorff topology.  With this topology, $\dmspace_{g,k}$ is a compact topological space.
\end{proposition}


To describe the local smooth structure of a DM-orbifold, we must construct certain families of stable Riemann surfaces. These families are the so-called ``good uniformizing families''.

\subsubsection{Gluing profiles and the gluing construction for a nodal Riemann surface}\label{subsubsec:gluing-profiles-gluing-construction-noded-reimann-surface}

In order to describe the gluing construction for a nodal Riemann surface, we must first choose a ``gluing profile'' which we now define.

\begin{definition}[{\cite{HWZGW}*{Def.~2.1}}]\label{def:gluing-profile}
	A \textbf{gluing profile} is a smooth diffeomorphism
	\[
		\varphi:(0,1]\to [0, \infty ).
	\]
\end{definition}

A gluing profile allows us to make a conversion of the absolute value of a non-zero complex number into a positive real number.
This is used to define the gluing construction at the nodes of a nodal Riemann surface, replacing a neighborhood of a nodal region with a finite cylinder. We recall this construction now.

Consider a Riemann surface $(\Sigma,j)$ with a nodal pair $\{x,y\}$.
Associate to this pair a \textbf{gluing parameter} $a\in\hb =\{z\in\C \mid \abs{z}< 1/2\}$.
We use the gluing profile to construct a family of Riemann surfaces parametrized by $a$ in the following way:
\begin{enumerate}
	\item Choose small disk-like neighborhoods $D_x$ of $x$ and $D_y$ of $y$, and identifications (via biholomorphisms) $D_x\setminus\{x\}\simeq \R^+\times S^1$ and $D_y \setminus \{y\} \simeq \R^- \times S^1$.  Moreover, the punctures $x$ and $+\infty$ are identified, and likewise $y$ and $-\infty$.
	\item Write the gluing parameter $a\neq 0$ in polar coordinates as
	      \[
		      a = r_a e^{-2\pi i\theta_a}, \qquad r_a \in (0,\tfrac{1}{2}),\ \theta_a\in \R / \Z.
	      \]
	      We then use the gluing profile to define a \textbf{gluing length} given by
	      \[
		      R_a:= \varphi(r_a) \in (\varphi (\tfrac{1}{2}), \infty).
	      \]
	\item Delete the points $(R_a,+\infty)\times S^1 \subset \R^+\times S^1$ and $(-\infty,-R_a)\times S^1\subset \R^-\times S^1$ from $\R^+\times S^1$ and $\R^-\times S^1$, and identify the remaining cylinders $[0,R_a]\times S^1$ and $[-R_a,0]\times S^1$ via the map
	      \[
		      L_{R_a} : [0,R_a]\times S^1 \to [-R_a,0]\times S^1, \qquad (s,t)\mapsto (s-R_a,t-\theta_a).
	      \]
	      We replace $D_x \sqcup D_y$ with the finite cylinder
	      \[
		      Z_a:= [0,R_a] \times S^1 \simeq_{L_{R_a}} [-R_a,0] \times S^1.
	      \]
	      (For $a=0$ we may define $Z_0 := \R^+\times S^1\sqcup \R^-\times S^1$, identifiable with $D_x \setminus \{x\}\sqcup D_y \setminus \{y\}$.)
	\item This procedure yields a new Riemann surface defined by the quotient space
	      \[
		      \Sigma_a := \frac{\Sigma \setminus \left (( [R_a,\infty) \times S^1 \cup \{x\} ) \cup (\{y\}\cup (-\infty, R_a] \times S^1)\right) }{L_{R_a} : [0,R_a]\times S^1 \to [-R_a,0]\times S^1}
	      \]
	      and which carries a naturally induced complex structure.
\end{enumerate}

Alternatively, we can write $\Sigma_a$ as the disjoint union
\[
	\Sigma_a = (\Sigma \setminus (D_x\sqcup D_y) ) \sqcup Z_a
\]
with complex structure
\[
	j(a):= \begin{cases}
		j & \text{on } \Sigma \setminus (D_x\sqcup D_y) \\
		i & \text{on } Z_a
	\end{cases}
\]
where $i$ is the standard complex structure on the finite cylinder $Z_a=[0,R_a]\times S^1$.

We can repeat this gluing construction for a Riemann surface with multiple nodes, hence we introduce the following definition.
\begin{definition}\label{def:family-Riemann-surfaces}
	Consider a Riemann surface $(\Sigma,j)$ with nodal pairs $\{x_a,y_a\} \in D$.
	We may choose disjoint small disk-like neighborhoods $D_{x_a}$ and $D_{y_a}$ at every node.  Carrying out the above procedure at every node we obtain a \textbf{glued Riemann surface} defined by the quotient space
	\[
		\Sigma_a := \frac{\Sigma \setminus \sqcup_{\{x_a,y_a\}\in D} \left (( [R_a,\infty) \times S^1 \cup \{x_a\} ) \cup (\{y_a\}\cup (-\infty, R_a] \times S^1)\right) }{ L_{R_a} : [0,R_a]\times S^1 \to [-R_a,0]\times S^1 }
	\]
	and which carries a naturally induced complex structure.
\end{definition}

Alternatively, we can write $\Sigma_a$ as the disjoint union
\[
	\Sigma_a := \left(\Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} )\right) \sqcup Z_a.
\]
with complex structure
\[
	j(a) := \begin{cases}
		j & \text{on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} ) \\
		i & \text{on } Z_a \text{ for every pair } \{x_a,y_a\}\in D
	\end{cases}
\]
where $i$ is the standard complex structure on the finite cylinder $Z_a$.

\subsubsection{Good uniformizing families of stable Riemann surfaces}

We now describe a certain family of variations of the complex structure of a stable Riemann surfaces.
This variation is designed to additionally account for the movement of the marked points.

\begin{definition}[{\cite{HWZGW}*{Def.~2.6}}]
	Let $(\Sigma,j,M,D)$ be a stable noded Riemann surface. Choose (disjoint) small disk-like neighborhoods $D_z \subset \Sigma$ at the special points $z\in M\cup \abs{D}$; we may moreover assume that these disk-like neighborhoods are invariant under the natural action of the isotropy group $\Aut(\Sigma,j,M,D)$.
	Consider a smooth family of complex structures $\cJ(\Sigma)$ on $\Sigma$:
	\[
		V \to \cJ(\Sigma), \qquad	v \mapsto j(v)
	\]
	where $V$ is an open subset which contains $0$ of a complex vector space $E$ of dimension $\dim_{\R} E = 6g-6 + 2\sharp M - 2\sharp D$.
	We call such a family $v\mapsto j(v)$ a \textbf{good complex deformation} if it satisfies the following:
	\begin{itemize}
		\item $j(0)=j$.
		\item The family is constant on the disk-like neighborhoods, i.e., $j(v)=j$ on $D_z$ for every $z\in M\cup \abs{D}$.
		\item For every $v\in V$ the \textit{Kodaira--Spencer differential}
		      \[
			      [Dj(v)] : H^1 (\Sigma,j,M,D) \to H^1 (\Sigma,j(v),M,D)
		      \]
		      is a complex linear isomorphism (for the definition of the differential see \cite{HWZGW}*{pp.~21--22}).
		\item There exists a natural action
		      \[
			      \Aut(\Sigma,j,M,D) \times V \to V,\qquad (\phi,v)\mapsto \phi\ast v
		      \]
		      such that $\phi: (\Sigma,j(v)) \to (\Sigma,j(\phi\ast v))$ is biholomorphic.
	\end{itemize}
\end{definition}

\begin{definition}[{\cite{HWZGW}*{Def.~2.12}}]\label{def:good-uniformizing-family}
	Let $(\Sigma,j,M,D)$ be a stable noded Riemann surface and let $v\mapsto j(v)$ be a good complex deformation.
	We may define a \textbf{good uniformizing family} as the following family of stable noded Riemann surfaces
	\[
		(a,v) \mapsto (\Sigma_a, j(a,v), M_a, D_a), \quad (a,v)\in (\hb)^{\sharp D} \times V.
	\]
	with data as follows.
	\begin{itemize}
		\item As in Definition~\ref{def:family-Riemann-surfaces} the glued surface $\Sigma_a$ is given by
		      \[
			      \Sigma_a = \left(\Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} )\right) \sqcup Z_a.
		      \]
		\item The complex structure $j(v)$ on the unglued Riemann surfaces $\Sigma$ induces the following complex structure on $\Sigma_a$:
		      \[
			      j(a,v):=
			      \begin{cases}
				      j(v) & \text{ on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} ), \\
				      i    & \text{ on } Z_a \text{ for every pair } \{x_a,y_a\}\in D.
			      \end{cases}
		      \]
		\item The set of marked points $z_1,\ldots,z_k \in M_a$ are given by the former marked points which by definition all lie in $\Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a})$.
		\item The set of nodal pairs $D_a$ is obtained from $D$ by deleting every nodal pair $\{x_a,y_a\}\in D$ for which $a\neq 0$.
	\end{itemize}
	This good uniformizing family is \textbf{centered} at $(\Sigma,j,M,D)$ in the sense that $(0,0) \mapsto (\Sigma,j,M,D)$.
	We call the parameters $(a,v)$ \textbf{local coordinates} centered at the stable noded Riemann surface $(\Sigma,j,M,D)$.
\end{definition}

The following proposition gives a description of the action of the isotropy group of a point on a neighborhood of the point.

\begin{proposition}\label{prop:natural-representation}
	Consider a stable noded Riemann surface $(\Sigma,j,M,D)$ and let $G:= \Aut(\Sigma,j,M,D)$.
	Consider the family of stable noded Riemann surfaces as constructed above,
	\[(a,v) \mapsto (\Sigma_a,j(a,v),M_a,D_a),\qquad (a,v) \in (\hb)^{\sharp D} \times V.\]
	For every open neighborhood of $0$ in $\hb^{\sharp D} \times V$ there exists an open subneighborhood $U$ of $0$ and a group action
	\begin{equation}
		\label{eq:natural-representation}
		\begin{split}
			G \times U   & \to U,                \\
			(\phi,(a,v)) & \mapsto \phi\ast(a,v)
		\end{split}
	\end{equation}
	such that the following holds.
	\begin{enumerate}
		\item For every $(\phi,(a,v))\in G\times U$ there exists a morphism
		      \[
			      \phi_{(a,v)} : (\Sigma_a,j(a,v),M_a,D_a) \to (\Sigma_{\phi\ast (a,v)}, j(\phi\ast(a,v)), M_{\phi\ast (a,v)}, D_{\phi\ast (a,v)}).
		      \]
		\item Given a morphism $\psi : (\Sigma_a,j(a,v),M_a,D_a) \to (\Sigma_{a'}, j(a',v'), M_{a'}, D_{a'})$ for parameters $(a,v), (a',v')\in U$, there exists a unique element $\phi \in G$ such that $\phi \ast (a,v) = (a',v')$ and moreover $\psi = \phi_{(a,v)}$.
	\end{enumerate}
	The neighborhood $U$ is called a \textbf{local uniformizer} centered at $(\Sigma,j,M,D)$.
\end{proposition}




\subsubsection{Parametrizing the movement of a marked point}
Situations will arise where we will want to parametrize the movement of the $k$th-marked point directly, e.g., when we consider the $k$th-marked point forgetting maps in \S\ref{subsec:kth-marked-point-forgetting-map-log-dm}.

In the above description of a good uniformizing family, movement of the marked points is determined by the variation of the complex structure $j$ via the parameter $v$.  Consider a stable noded Riemann surface $(\Sigma,j,M,D)$ with a good complex deformation $v\mapsto j(v)$.  Wiggle the marked points slightly, and obtain a new stable noded Riemann surface $(\Sigma,j,M',D)$; there exists a parameter $v\in V$ such that there exists a biholomorphism $\phi : (\Sigma,j(v),M,D) \to (\Sigma,j,M',D)$.

We now describe a good uniformizing family in which the movement of the $k$th-marked point is parametrized.
Consider a stable noded Riemann surface $(\Sigma,j,M,D)$ and suppose that the component $C_k$ which contains the $k$th-marked point $z_k$ remains stable after forgetting $z_k$.
We parametrize a neighborhood of $z_k$ by embedding a small disk via a holomorphic map
\[
	\varphi:(B_\epsilon,i) \hookrightarrow (\Sigma,j), \quad \text{such that } \varphi(0)=z_k\text{ and }\varphi(B_\epsilon)\subset D_{z_k},
\]
where $D_{z_k}$ is a small disk-like neighborhood of $z_k$.



\begin{definition}
	Let $(\Sigma,j,M,D)$ be a stable noded Riemann surface and choose disjoint smooth disk-like neighborhoods $D_z \subset \Sigma$ at the special points $z\in M\cup \abs{D}$ which we may moreover assume are $\Aut(\Sigma,j,M,D)$-invariant.
	Consider a smooth family of complex structures $\cJ(\Sigma)$ on $\Sigma$:
	\[
		V \to \cJ(\Sigma), \qquad	v \mapsto j(v)
	\]
	where $V$ is an open subset which contains $0$ of a complex vector space $E$ of dimension $\dim_{\R} E = 6g-6 + 2\sharp M - 2\sharp D-2$.
	We call such a family $v\mapsto j(v)$ an \textbf{alternative good complex deformation} if it satisfies the following:
	\begin{itemize}
		\item $j(0)=j$.
		\item The family is constant on the disk-like neighborhoods, i.e., $j(v)=j$ on $D_z$ for every $z\in M\cup \abs{D}$.
		\item For every $v\in V$ the Kodaira--Spencer differential
		      \[
			      [Dj(v)] : H^1 (\Sigma,j,M\setminus\{z_k\},D) \to H^1 (\Sigma,j(v),M\setminus\{z_k\},D)
		      \]
		      is a complex linear isomorphism.
		\item There exists a natural action
		      \[
			      \Aut(\Sigma,j,M,D) \times V \times B_\ep \to V\times B_\ep,\qquad (\phi,v,y)\mapsto (\phi\ast v, \phi \ast y)
		      \]
		      such that $\phi: (\Sigma,j(v)) \to (\Sigma,j(\phi \ast v))$ is biholomorphic and which furthermore satisfies $\phi(\varphi(y)) = \varphi(\phi \ast y)$.
	\end{itemize}
\end{definition}

\begin{definition}
	Let $(\Sigma,j,M,D)$ be a stable noded Riemann surface and let $v\mapsto j(v)$ be a good complex deformation.
	We may define an \textbf{alternative good uniformizing family} centered at $(\Sigma,j,M,D)$ as the following family of stable noded Riemann surfaces
	\[
		(a,v,y) \mapsto (\Sigma_a, j(a,v), M_{(a,y)}, D_a), \quad (a,v,y)\in (\hb)^{\sharp D} \times V \times B_\ep
	\]
	with data as follows.
	\begin{itemize}
		\item As in Definition~\ref{def:family-Riemann-surfaces} the glued surface $\Sigma_a$ is given by
		      \[
			      \Sigma_a = \left(\Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} )\right) \sqcup Z_a.
		      \]
		\item The complex structure $j(v)$ on the unglued Riemann surfaces $\Sigma$ induces the following complex structure on $\Sigma_a$:
		      \[
			      j(a,v):=
			      \begin{cases}
				      j(v) & \text{ on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a} ), \\
				      i    & \text{ on } Z_a \text{ for every pair } \{x_a,y_a\}\in D.
			      \end{cases}
		      \]
		\item The set of marked points $z'_1,\ldots,z'_{k-1} \in M_{(a,y)}$ are given by the former marked points which by construction all lie in $\Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a})$.  The $k$th-marked point is parametrized by the map $\varphi : B_\epsilon \hookrightarrow \Sigma$, i.e.,
		      \[
			      z'_k := \varphi(y) \in \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a}).
		      \]
		\item The set of nodal pairs $D_a$ is obtained from $D$ by deleting every nodal pair $\{x_a,y_a\}\in D$ for which $a\neq 0$.
	\end{itemize}
\end{definition}

There exists an analog of Proposition~\ref{prop:natural-representation} associated to an alternative good uniformizing family.

\subsubsection{Gluing profiles and local smooth structures on the logarithmic and exponential Deligne--Mumford orbifolds}

An orbifold is locally homeomorphic to the quotient of an open subset of $\R^n$ by a finite group action.
In the current context, given a local uniformizer for a good uniformizing family of stable Riemann surfaces, the projection to an equivalence class is $\Aut$-invariant. Hence we obtain a well-defined map
\[
	\frac{\{(\Sigma_a,j(a,v), M_a,D_a)\}_{(a,v)\in U}}{\Aut(\Sigma,j,M,D)} \to \dmspace_{g,k}.
\]
This map is a local homeomorphism (see \cite{HWZGW}*{\S2.1}).

However, this is only a small part of the orbifold structure of the DM-spaces; in order to understand the full smooth orbifold structure it is necessary to construct an ep-groupoid structure on $\dmspace_{g,k}$. This is discussed in \cite{HWZGW}*{pp.~28--31}.

Remember that the construction of a family of Riemann surfaces, and hence of the good uniformizing families required the choice of a gluing profile.
Ergo different choices of gluing profile yield different smooth orbifold structures for the same underlying topological space $\dmspace_{g,k}$.

We will be especially concerned with the following two gluing profiles: the \textbf{logarithmic gluing profile}
\[
	\varphi_\text{log}: (0,1]\rightarrow [0,\infty), \quad r\mapsto  -\frac{1}{2\pi}\log(r).
		\]
		and the \textbf{exponential gluing profile}
		\[
		\varphi_\text{exp}: (0,1]\rightarrow [0,\infty),\quad  r\mapsto e^{1/r}-e.
\]

\begin{theorem}[{\cite{HWZGW}*{Thms.~2.14,~2.16}}]
	Using the logarithmic gluing profile, we reproduce the classical Deligne--Mumford theory and obtain a complex orbifold we denote as $\dmlog_{g,k}$.  Conversely, using the exponential gluing profile we obtain a smooth oriented orbifold $\dmexp_{g,k}$. In both cases, the real dimension is equal to $6g-6 + 2k$.
\end{theorem}

\subsection{The Gromov--Witten polyfolds}\label{subsec:the-gw-polyfolds}

We now describe the underlying set of the GW-polyfolds.

\begin{definition}\label{def:gw-polyfold}
	For a fixed homology class $A\in H_2 (M;\Z)$, and for fixed integers $g\geq 0$ and $k\geq 0$, \textbf{the underlying set of the Gromov--Witten polyfold} $\cZ_{A,g,k}$ is defined as the set of stable curves with homology class $A$, arithmetic genus $g$, and $k$ marked points
	\[
		\cZ_{A,g,k}:= \{ (\Sigma,j,M,D,u)  \mid  \cdots, \text{ GW-stability condition} \}/ \sim
	\]
	where $(\Sigma,j,M,D)$ is a noded Riemann surface except that we do not require the DM-stability condition \eqref{eq:dm-stability-condition}, with data as follows.
	\begin{itemize}
		\item $u:\Sigma \to M$ is a continuous map such that $u_*[\Sigma]=A \in H_2 (M;\Z)$.
		\item For each nodal pair $\{x,y\}\in D$ we have $u(x)=u(y)$.
		\item The map $u$ is of class $H^{3,\delta_0}$ at the nodal points in $\abs{D}$ and of class $H^3_\text{loc}$ near the other points in $\Sigma$ (see Definition~\ref{def:class-3delta} below).
		\item $\int_C u^*\ww \geq 0$ for each connected component $C\subset \Sigma$.
		\item For each connected component $C\subset \Sigma$ the following \textbf{GW-stability condition} holds.  We require at least one of the following:
		      \begin{equation}
			      2 g_C+\sharp (M\cup\abs{D})_C \geq 3 \quad \text{or} \quad \int_C u^* \ww > 0, \label{eq:gw-stability-condition}
		      \end{equation}
		      where $g_C$ is the genus of $C$ and $\sharp (M\cup\abs{D})_C$ is the number of marked and nodal points on the component $C$.
		\item The equivalence relation is given by $(\Sigma,j,M,D,u)\sim (\Sigma',j',M',D',u')$ if there exists a biholomorphism $\phi:(\Sigma,j)\to (\Sigma',j')$ such that $u'\circ\phi = u$, in addition to $\phi(M)=M',\ \phi(\vert D\vert)=\vert D'\vert$, and which preserves ordering and pairs.
	\end{itemize}
	We call a tuple $(\Sigma,j,M,D,u)$ which satisfies these requirements a \textbf{stable map}, and call an equivalence class $[\Sigma,j,M,D,u]$ a \textbf{stable curve}.
\end{definition}

\begin{definition}[{\cite{HWZGW}*{Def.~1.1}}]\label{def:class-3delta}
	Let $u: \Sigma \to M$ be a continuous map, and fix a point $z\in \Sigma$.
	We consider a local expression for $u$ as follows. Choose a small disk-like neighborhood $D_z\subset \Sigma$ of $z$ such that there exists a biholomorphism $ \sigma:[0,\infty)\times S^1\rightarrow D_z \setminus\{z\}$.
	Let $\varphi:U\rightarrow \R^{2n}$ be a smooth chart on a neighborhood $U \subset M$ of $u(z)$ such that to $\varphi (u(z))=0$.
	The local expression
	\[
		\tilde{u}: [s_0,\infty)\times S^1 \to \R^{2n}, \qquad (s,t) \mapsto \varphi\circ u\circ \sigma(s,t)
	\]
	is defined for $s_0$ large.

	Let $m\geq 3$ be an integer, and let $\delta >0$. We say that $u$ is of \textbf{class $H^{m,\delta}$ around the point $z\in \Sigma$} %
	if $e^{\delta s}  \tilde{u}$ belongs to the space $L^2([s_0,\infty)\times S^1,\R^{2n})$.
	We say that $u$ is of \textbf{class} $H^m_{\text{loc}}$ \textbf{around the point $z\in \Sigma$} if $u$ belongs to the space $H^m_{\text{loc}}(D_z)$.
	If $u$ is of class $H^{m,\delta}$ at a point $z\in \Sigma$ we will refer to that point as a \textbf{puncture}.

	These definitions do not depend on the choices involved of holomorphic polar coordinates on $\Sigma$ or smooth charts on $M$.
\end{definition}

Some situations will require that the map
$u$ is of class $H^{3,\delta_0}$ at a fixed subset of the marked points, in addition to the nodal points.
Allowing a puncture at an $i$th-marked is a global condition on our polyfold, and so we may
add the following to the above conditions on the set $\cZ_{A,g,k}$:
\begin{itemize}
	\item We require that $u$ is of class $H^{3,\delta_0}$ at all marked points in a fixed subset of the index set $\{1,\ldots,k\}$.
\end{itemize}
By \cite{schmaltz2019naturality}*{Cor.~1.6} the polyfold GW-invariants are independent of a fixed choice of puncture at the marked points.
As an aside, consider a point $z\in \Sigma$ with a small disk neighborhood $D_z\subset \Sigma$ as above.
Consider the spaces $H^{3,\delta_0} (D_z\setminus\{z\})$ and $H^3_\text{loc} (D_z)$;  as it turns out, neither of these spaces contains the other.
As an aside, one can show that there exists an inclusion map $H^{3,\delta_0} (D_z\setminus \{z\}) \hookrightarrow C^0 (D_z)$.

For a fixed $(\Sigma,j,M,D,u)$ the \textbf{isotropy group}
\[
	\Aut(\Sigma,j,M,D,u) :=
	\left\{
	\begin{array}{c}
		\phi: (\Sigma,j) \to (\Sigma,j)
	\end{array}
	\middle|
	\begin{array}{c}
		\phi \text{ biholomorphic},            \\
		u \circ \phi = u,                      \\
		\phi(M)=M \text{ preservers ordering}, \\
		\phi(\vert D\vert)=\vert D\vert
	\end{array}
	\right\}
\]
is finite if and only if the GW-stability condition \eqref{eq:gw-stability-condition} holds.

\begin{theorem}[{\cite{HWZGW}*{Thm.~3.27}}]
	The set of stable curves $\cZ_{A,g,k}$ has a natural second countable, paracompact, Hausdorff topology.
\end{theorem}




Before describing a fully general good uniformizing family of stable maps, we will consider special cases of such families which allow us to isolate:
\begin{enumerate}
	\item the gluing construction of stable maps in a region of a nodal Riemann surface,
	\item the transversal constraint construction in the case that a domain component does not satisfy the DM-stability condition \ref{eq:dm-stability-condition}.
\end{enumerate}


\subsubsection{Good uniformizing families centered at unnoded stable maps in the stable case}

The simplest description of a good uniformizing family centered at a stable map occurs when the stable map is without nodes and whose underlying Riemann surface is already stable.
Thus, consider an unnoded stable map $(\Sigma,j,M,\emptyset,u)$.
Let us assume moreover that $2g+k \geq 3$; it follows that $(\Sigma,j,M,\emptyset)$ is a stable Riemann surface, and we can let $v\mapsto j(v)$, $v\in V$ be a good complex deformation.

Consider the space of sections $H^3(\Sigma, u^*TM)$; for a given Riemannian metric $g$ on $M$.
There exists a sufficiently small neighborhood $U\subset H^3(\Sigma, u^*TM)$ such that the associated exponential map defines a map $\exp_u \eta : \Sigma \to M$.

In this case, a good uniformizing family centered at the stable map $(\Sigma,j,M,\emptyset,u)$ can be given as the following family of stable maps
\[
	(v, \eta) \mapsto (\Sigma, j(v), M, \emptyset, \exp_u \eta) \quad \text{where } (v,\eta) \in V \times U \subset E\times H^3(\Sigma, u^*TM).
\]

\subsubsection{The gluing construction for a stable map}\label{subsubsec:the-gluing-construction-stable-map}

The description of a good uniformizing family is complicated by the fact that stable maps may be defined on nodal domains.
To examine this situation, let us consider a stable map with a single nodal pair, and such that that every domain component is stable.
In order to describe the good uniformizing family centered at such a stable map, we recall the gluing construction for a stable map as described in \cite{HWZGW}*{\S2.4}.

At the outset, fix a smooth cutoff function $\beta:{\mathbb R}\rightarrow [0,1] $ which satisfies the following:
\begin{itemize}
	\item $\beta (-s)+\beta (s)=1$ for all $s\in \R$,
	\item $\beta (s)=1$ for all $s\leq -1$,
	\item $\tfrac{d}{ds}\beta(s)<0$ for all $s\in (-1, 1)$.
\end{itemize}
Consider a pair of continuous maps
\[
	h^+:\R^+\times S^1\to \R^{2n}, \qquad h^-:\R^-\times S^1\to \R^{2n};
\]
with common asymptotic constant $c:= \lim_{s\to\infty} h^+(s,t) = \lim_{s\to-\infty} h^-(s,t)$.
For a given gluing parameter $a\in \hb$ we define the \textbf{glued map} $\oplus_a (h^+,h^-) : Z_a \to \R^{2n}$ by the interpolation
\[
	\oplus_a (h^+,h^-) (s,t):=
	\begin{cases}
		\beta\left(	s - \tfrac{R_a}{2}	\right) \cdot h^+(s,t)                                    &                     \\
		\qquad+\left(1-\beta \left(	s-\tfrac{R_a}{2}	\right)\right) \cdot  h^-(s-R_a,t-\theta_a) & \text{if } a\neq 0, \\
		(h^+,h^-)                                                                                & \text{if }a=0.
	\end{cases}
\]

Now consider a stable map with a single nodal pair $(\Sigma,j,M,\{x_a,y_a\}, u)$, and such that every connected component $C\subset \Sigma$ is stable. Since $(\Sigma,j,M,\{x_a,y_a\})$ is assumed to be stable there exists a good complex deformation $v\mapsto j(v), v\in V$.

Consider the following space of sections $H^{3,\delta_0}_c(\Sigma, u^*TM)$, consisting of sections $\eta : \Sigma \to u^*TM$ such that:
$\eta$ is of class $H^{3,\delta_0}$ around the nodal points and of class $H^3_\text{loc}$ at the other points of $\Sigma$, and in addition $\eta$ has matching asymptotic values at the nodal pairs, i.e., $\eta(x_a) = \eta(y_a)$ for $\{x_a,y_a\}\in D$.
We now consider local expressions for the map $u$ and the section $\eta$ as follows.
In a neighborhood of the point $u(x_a)=u(y_a) \in M$ choose a chart which identifies $u(x_a)=u(y_a)$ with $0\in \R^{2n}$.
Furthermore, given a Riemannian metric $g$ on $M$ we may assume that this chart is chosen such that this metric is identifiable with the Euclidean metric on $\R^{2n}$.
Choose small disk neighborhoods at $x_a$ and $y_a$ such that via biholomorphisms we may identify $D_{x_a}\setminus \{x_a\} \simeq \R^+\times S^1$ and $D_{y_a}\setminus \{y_a\} \simeq \R^-\times S^1$.
Localized to these coordinate neighborhoods, we may view the base map $u$ as a pair of maps
\[u^+:\R^+\times S^1\to \R^{2n}, \qquad u^-:\R^-\times S^1\to \R^{2n}\]
and likewise the section $\eta$ as maps
\[\eta^+:\R^+\times S^1\to \R^{2n}, \qquad \eta^-:\R^-\times S^1\to \R^{2n}.\]

Given a gluing parameter $a\in \hb$ we define the \textbf{glued stable map} $\oplus_a \exp_u (\eta) :\Sigma_a \to M$ as follows:
\[
	\oplus_a \exp_u \eta :=
	\begin{cases}
		\exp_u \eta                            & \text{ on } \Sigma \setminus (D_{x_a}\sqcup D_{y_a}), \\
		\oplus_a (u^+ + \eta^+, u^- + \eta^- ) & \text{ on } Z_a.
	\end{cases}
\]

At this point, we might hope to define a good uniformizing family of stable maps centered at $(\Sigma,j,M,\{x_a,y_a\},u)$ as follows:
\begin{align*}
	 & (a,v,\eta) \mapsto (\Sigma_a, j(a,v), M_a, \{x_a,y_a\}_a, \oplus_a \exp_u \eta),                                      \\
	 & \qquad \text{where } (a,v,\eta) \in \hb \times V \times U \subset \C \times E \times H^{3,\delta_0}_c (\Sigma,u^*TM),
\end{align*}
where $U$ is a suitably small neighborhood of the zero section.
The problem with this is that this map is not injective; to see this, fix a gluing parameter $a\neq 0$ and consider two sections $\eta$, $\eta'$ which differ only in a sufficiently small neighborhood of the nodal pair $\{x_a,y_a\}$; the glued stable maps will be identical, $\oplus_a \exp_u  \eta = \oplus_a \exp_u \eta'$.

\begin{theorem}[{\cite{HWZGW}*{Thm.~2.49}}]\label{thm:ssc-retraction}
	There exists a ``$\ssc$-retraction'' (i.e., a $\ssc$-smooth map which satisfies $\pi \circ \pi = \pi$),
	\begin{align*}
		\pi: \hb \times V \times U & \to \hb \times V \times U   \\
		(a,v,\eta)                 & \mapsto (a,v,\pi_a (\eta)),
	\end{align*}
	such that the restriction of the above family to the subset $\cV := \pi (\hb \times V \times U)$ is injective.
\end{theorem}

We therefore define a good uniformizing family of stable maps centered at $(\Sigma,j,M,\{x_a,y_a\},u)$ by
\[
	(a,v,\eta) \mapsto (\Sigma_a, j(a,v), M_a, \{x_a,y_a\}_a, \oplus_a \exp_u \eta) \quad \text{where } (a,v,\eta) \in \cV.
\]

\begin{remark}
	The exponential gluing profile is necessary to prove the scale smoothness of the above map $\pi$; see \cite{HWZsc}*{Thms.~1.27,~1.28}, the relevant calculations involving the exponential gluing profile appear in \cite{HWZsc}*{\S2.3}.
\end{remark}

\subsubsection{The transversal constraint construction}

The description of a good uniformizing family is again complicated by the possibility that for a given stable map the underlying Riemann surface may contain unstable components. For the sake of explaining the phenomena in a simple case, let us consider an unnoded stable map $(\Sigma,j,M, \emptyset, u)$ whose underlying Riemann surface $(\Sigma,j,M,\emptyset)$ is not stable.
Let us assume the automorphism group is the identity, $\Aut(\Sigma,j,M, \emptyset, u)= \{\id \}$.
Since this is a stable map, it necessarily follows from the GW-stability condition \eqref{eq:gw-stability-condition} that $\int_\Sigma u^*\ww >0$.
We note that $\Sigma$ consists of a single component of genus $0$ or $1$. If $g=0$ then $\sharp M <3$, and if $g=0$ then $M=\emptyset$.

Suppose that $\Sigma = S^2$, and suppose that there is a single marked point, $M=\{z_1\}$ (the cases where there are no marked points or two marked points are similar).
Recall that up to diffeomorphism, any complex structure on $S^2$ is the standard complex structure.
In order to stabilize $S^2$, choose a finite set of unordered points $S\subset S^2$ such that:
\begin{itemize}
	\item $S$ is disjoint from the marked point, in this case, $\{z_1\}\cap S = \emptyset$,

	\item $\sharp S \geq 2$, i.e.,  $(S^2,i,\{z_1\}\cup S,\emptyset)$ satisfies the DM-stability condition \eqref{eq:dm-stability-condition},

	\item the image $u(S)$ is disjoint from $u(z_1)$,
	\item at each point $z \in S$ the differential $du_z : T_z S^2 \to T_{u(z)} M$ is injective, the pullback $u^*\ww$ is non-degenerate on $T_zS^2$, and the induced orientation of $u^*\ww$ on $T_z S^2$ agrees with the orientation determined by the standard complex structure $i$.
\end{itemize}
Such a stabilization always exists \cite{HWZGW}*{Lem.~3.2}.
Let $l :=\sharp S -2$, and note that $\dim \dmlog_{0,1 + \sharp S} = 2l$.
For any three distinct points on the sphere there exists a unique M\"{o}bius transformation $\phi\in \text{PGL}(2,\C)$ which sends these points to $\{0,1,\infty\}\in S^2$.
Let $S_0:=\{y',y''\}$ denote the first two points of $S$; by fixing the three points $M\cup S_0$ and by parametrizing the remaining $\sharp S -2$ stabilizing points via maps $\phi_i : B_\ep \hookrightarrow S^2$, one can associate to a parameter $y\in B^{2l}_\ep$ the stabilization $S_y := S_0 \cup \{ \phi_i(y_i)\}_{1\leq i\leq l}$; we write $z_y\in S_y$ for one of the parametrized points.
Thus, we obtain a good uniformizing family centered at the stabilized sphere $(S^2,i,M\cup S,\emptyset)$:
\[
	y \mapsto (S^2,i, \{z_0\} \cup S_0 \cup S_y,\emptyset), \qquad y \in B_\ep^{2l}.
\]

Intuitively, each stabilizing point ``increases'' the dimension by $2$,
To get the correct dimension, we can place a codimension $2$ constraint at the stabilizing points on the space of sections.
This can be done as follows.

Using the requirement that at each point $z \in S$ the differential $du_z : T_z \Sigma \to T_{u(z)} M$ is injective, choose a $2n-2$-dimensional complement $H_{u(z)}$ such that
\[
	du_z (T_z\Sigma ) \oplus H_{u(z)} = T_{u(z)} M.
\]
We call such a complement a \textbf{linear constraint} associated with the point $z\in S$.
We may also identify a neighborhood of zero in $H_{u(z)}$ with an embedded submanifold of $M$ via the exponential map.
We will restrict our family of stable maps to sections which satisfy the linear constraint the following space $H_{u(z)}$ at associated (parametrized) point $z_y \in S_y$, i.e., we restrict to an open neighborhood $U$ of zero in the space
\[
	E_S := \{ (y,\eta) \in B^{2l}_\ep \times H^3 (\Sigma, u^*TM)	\mid \eta(z_y) \in H_{u(z)} \text{ for } z_y \in S_y\}.
\]

Thus using the above \textbf{transversal constraint construction}, we define a good uniformizing family of stable maps centered at $(S^2,i,\{z_0\},\emptyset,u)$ by
\[
	(y, \eta) \mapsto (S^2,i,\{z_0\},\emptyset, \exp_u \eta), \qquad (y,\eta) \in U \subset E_S.
\]
This construction is justified by the following assertion: the projection to the space of stable curves
\[
	(y,\eta)  \mapsto [S^2,i, \{z_0\}, \emptyset, \exp_u \eta], \qquad (y,\eta)\in U \subset E_S
\]
is a local homeomorphism (for the appropriate topology on the space of stable curves).

Indeed, it is locally surjective. Consider a nearby stable curve, and let $(S^2,i,\{w_0\}, \emptyset, v)$ be a stable map representative which is also near $(S^2,i,\{z_0\},\emptyset,u)$.
Observe that for any map $v$ sufficiently close to $u$ will have the property that it intersects the submanifold associated to each linear constraint $H_{u(z)}$ precisely once, and intersects transversally.
Let $\phi:S^2\to S^2$ be the unique M\"{o}bius transformation which takes $\{z_0,y',y''\}$ to $\{w_0\}$ and the unique points of intersection of the map $v$ with the linear constraints associated to $y'$ and $y''$.
We then define $\eta$ uniquely by $\exp_u \eta = v\circ \phi$ and $y$ by the unique points of intersection of $v\circ \phi$ with the constraints $H_{u(z)}, z\in S$.
Moreover, since these parameters are uniquely determined the projection is injective.





\subsubsection{Good uniformizing families of stable maps in the general case}\label{subsubsec:families-stable-maps-in-general}

Hopefully the above prototypical cases provide some intuition for the gluing/transversal constraint constructions.
In general, both constructions will be needed in the construction of a general good uniformizing family---clearly, a stable map may contain nodal points as well as unstable domain components.
There is no issue with using both constructions at the same time, since these constructions are localized to disjoint regions of the underlying Riemann surface.

Consider a stable map $(\Sigma,j,M,D,u)$ and consider the associated automorphism group $\Aut(\Sigma,j,M,D,u)$.
We now recall the full definition of a stabilization \cite{HWZGW}*{Def.~3.1} in the general case. A \textbf{stabilization} is a set of points $S\subset \Sigma$ which satisfy the following:
\begin{itemize}
	\item $S$ is disjoint from the special points, i.e., $S\cap (M\cup\abs{D}) = \emptyset$,
	\item given an automorphism $\phi \in \Aut(\Sigma,j,M,D,u)$ then $\phi(S) =S$,
	\item the tuple $(\Sigma,j,M\cup S,D)$ satisfies the DM-stability condition \eqref{eq:dm-stability-condition},
	\item if $u(z)=u(z')$ for $z,z'\in S$ then there exists an automorphism $\phi$ such that $\phi(z)=z'$,
	\item the image $u(S)$ is disjoint from $u(M)$ and from $u(D)$,
	\item at each point $z \in S$ the differential $du_z : T_z \Sigma \to T_{u(z)} M$ is injective, the pullback $u^*\ww$ is non-degenerate on $T_z\Sigma$, and the induced orientation of $u^*\ww$ on $T_z \Sigma$ agrees with the orientation determined by the complex structure $j$.
\end{itemize}
Again, such a stabilization always exists \cite{HWZGW}*{Lem.~3.2}.

The Riemann surface $(\Sigma,j,M\cup S,D)$ is now stable; let
\[
	(a,v)\mapsto (\Sigma_a, j(a,v), (M\cup S)_a, D_a), \quad (a,v) \in \hb^{\sharp D} \times V
\]
be a good uniformizing family of stable noded Riemann surfaces.

By the final condition of a stabilization, we may choose a $(2n-2)$-dimensional complement $H_{u(z)}$ such that
\[
	du_z (T_z\Sigma ) \oplus H_{u(z)} = T_{u(z)} M.
\]
We call such a complement a \textbf{linear constraint} associated with the point $z\in S$.

Consider the constrained subspace of sections
\[
	E_S := \{ \eta \in H^{3,\delta_0}_c (u^*TM)	\mid \eta(z_s) \in H_{u(z_s)} \text{ for } z_s \in S\}
\]
and let $U \subset E_S$ be an suitably small open neighborhood of the zero section.
As before, by using the gluing construction one can define a $\ssc$-retraction
\begin{align*}
	\pi : \hb^{\sharp D} \times V \times U & \to \hb^{\sharp D} \times V \times U \\
	(a,v,\eta)                             & \mapsto (a,v,\pi_a(\eta)).
\end{align*}
Then the image $\cV : = \pi (\hb^{\sharp D} \times V \times U)$ is a $\ssc$-retract on which the gluing map is injective.

\begin{definition}[{\cite{HWZGW}*{Def.~3.9}}]\label{def:good-uniformizing-family-of-stable-maps}
	Having chosen a stabilization $S$, a \textbf{good uniformizing family of stable maps} centered at $(\Sigma,j,M,D,u)$ is a family of stable maps
	\[
		(a,v,\eta) \mapsto (\Sigma_a, j(a,v), M_a, D_a, \oplus_a \exp_u \eta), \quad (a,v,\eta )\in \cV.
	\]
	In particular, the section $\eta$ satisfies the linear constraint $H_{u(z_s)}$ at each stabilizing point $z_s\in S$.
	In addition, the glued stable map may be described on the glued Riemann surface as follows:
	\[
		\oplus_a \exp_u \eta :=
		\begin{cases}
			\exp_u \eta          & \text{on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a}), \\
			\oplus_a \exp_u \eta & \text{on } Z_a \text{ for every gluing parameter } a \in \hb.
		\end{cases}
	\]
	We call the parameters $(a,v,\eta)$ \textbf{local $\ssc$-coordinates} centered at the stable map $(\Sigma,j,M,D,u)$.
\end{definition}

\begin{proposition}[{\cite{HWZGW}*{Prop.~3.12}}]
	Consider a stable map $(\Sigma,j,M,D,u)$ and let $G:= \Aut(\Sigma,j,M,D,u)$. Consider a good uniformizing family of stable maps centered at $(\Sigma,j,M,D,u)$:
	\[
		(a,v,\eta) \mapsto (\Sigma_a, j(a,v), M_a, D_a, \oplus_a \exp_u \eta), \quad (a,v,\eta )\in \cV.
	\]
	For every open neighborhood of $0$ in $\cV$ there exists an open subneighborhood of $0$, call it $\cU$, and a group action
	\begin{align*}
		G\times \cU       & \to \cU                                       \\
		(\phi,(a,v,\eta)) & \mapsto (\phi\ast(a,v), \eta \circ \phi^{-1})
	\end{align*}
	(where $\phi\ast(a,v)$ is the action from equation \eqref{eq:natural-representation}) such that the following holds.
	\begin{enumerate}
		\item Let $(\phi,(a,v,\eta)) \in G\times \cU$, and denote $(b,w,\xi):= (\phi\ast (a,v), \eta\circ \phi^{-1})$. Then there exists a morphism
		      \[
			      \phi_{(a,v,\eta)} : (\Sigma_a,j(a,v),M_a,D_a, \oplus_a \exp_u \eta ) \to
			      (\Sigma_b,j(b,w),M_b,D_b, \oplus_b \exp_u \xi).
		      \]
		\item Consider a morphism
		      \[
			      \psi : (\Sigma_a,j(a,v),M_a,D_a, \oplus_a \exp_u \eta ) \to (\Sigma_{a'},j(a',v'),M_{a'},D_{a'}, \oplus_{a'} \exp_u \eta' )
		      \]
		      for parameters $(a,v,\eta), (a',v',\eta') \in \cU_S$. Then there exists a unique element $\phi \in G$ such that $(\phi\ast(a,v), \eta \circ \phi^{-1}) = (a',v',\eta')$ and moreover $\psi = \phi_{(a,v,\eta)}$.
	\end{enumerate}
	We call $\cU$ a \textbf{local uniformizer} centered at $(\Sigma,j,M,D,u)$.
\end{proposition}

\subsubsection{Local smooth structures on the Gromov--Witten polyfolds}

A polyfold is locally homeomorphic to the quotient of a $\ssc$-retract by a finite group action (compare with our mantra regarding the local topology of an orbifold.).
In the current context, given a local uniformizer for a good uniformizing family of stable maps, the projection to an equivalence class is $\Aut$-invariant. Hence we obtain a well-defined map
\[
	\frac{\{(\Sigma_a,j(a,v), M_a,D_a, \oplus_a \exp_u \eta)\}_{(a,v,\eta)\in \cU}}{\Aut(\Sigma,j,M,D,u)} \to \cZ_{A,g,k}.
\]
This map is a local homeomorphism (see \cite{HWZGW}*{\S2.1}). This further gives us a picture of the local smooth structure of a GW-polyfold

In order to understand the full smooth structure on $\cZ_{A,g,k}$, it is necessary to construct a polyfold structure on $\cZ_{A,g,k}$. We refer to \cite{HWZGW}*{\S3.5} for such a construction.

\begin{theorem}[{\cite{HWZGW}*{Thm.~3.37}}]
	Having fixed the exponential gluing profile and a strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$, the second countable, paracompact, Hausdorff topological space $\cZ_{A,g,k}$ possesses a natural equivalence class of polyfold structures.
\end{theorem}

It was further proven that the polyfold GW-invariants are independent of the choice of strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$, see \cite{schmaltz2019naturality}*{Cor.~1.5}.

\subsection{Other Gromov--Witten-type polyfolds}\label{subsec:other-gw-polyfolds}

We now introduce two variants of the GW-polyfolds which will play an important role in proving the GW-axioms.

Fix a pair $(g,k)$ of integers such that $g\geq 0$, $k\geq 0$, and $2g+k \geq 3$.
A \textbf{splitting} $S$ of $(g,k)$ consists of the following:
\begin{itemize}
	\item a pair of integers $k_0,k_1 \geq 0$ such that $k_0 + k_1 = k$,
	\item a pair of integers $g_0,g_1 \geq 0$ such that $g_0 + g_1 = g$,
\end{itemize}
such that the following holds: $k_0 + g_0 \geq 2$ and $k_1 + g_1 \geq 2$.

\begin{definition}
	Fix a homology class $A\in H_2(M;\Z)$, and fix a pair of integers $g,\ k$ such that $g\geq 0$, $k\geq 0$ and $2g+k \geq 3$.
	Let $A_0, A_1$ be such that $A_0+A_1=A$, and let $S$ be a splitting of $(g,k)$.
	The \textbf{underlying set of the split Gromov--Witten polyfolds} with respect to $S$ and $A_0,A_1$ is defined as
	\[
		\cZ_{A_0+A_1,S} := \{(\Sigma_0, j_0, M_0, D_0 , u_0, \Sigma_1, j_1 , M_1, D_1, u_1  ) \mid \cdots, u_0 (z_{k_0+1}) = u_1 (z'_1) 		\} / \sim
	\]
	with data as follows.
	\begin{itemize}
		\item The $(\Sigma_i,j_i,M_i,u_i)$ is a stable map with respect to the GW-polyfold $\cZ_{A_i,k_i+1,g_i}$ for $i=0,1$.
		\item We require the following incidence relation between the last marked point of $M_0$ and the first marked point of $M_1$:
		      \[u_0 (z_{k_0+1}) = u_1 (z'_1).\]
		      We moreover require that $u_0$ and $u_1$ are of class $H^{3,\delta_0}$ at the punctures $z_{k_0+1}$ and $z'_1$, respectively.
		\item As usual, the equivalence relation is given by biholomorphisms of the form $\phi:(\Sigma_0\sqcup \Sigma_1,j_0\sqcup j_1)\to (\Sigma'_0\sqcup \Sigma'_1,j'_0\sqcup j'_1)$ such that $\phi$ preserves the ordering of the marked points and maps pairs to pairs; notice that since $\phi$ preserves the $(k_0+1)$th and $1$st marked points this is already enough to imply that $\phi(\Sigma_i)=\Sigma'_i$ for $i=0,1$. We then require in addition that $u'_i\circ \phi = u_i$ for $i=0,1$.
	\end{itemize}
\end{definition}

There are multiple ways to give $\cZ_{A_0+A_1,S}$ a natural polyfold structure.
Consider the map
\[
	ev_{k_0+1} \times ev_1 : \cZ_{A_0,g_0,k_0+1} \times \cZ_{A_1,g_1,k_1+1} \to M\times M;
\]
it follows from Proposition~\ref{prop:evaluation-smooth-submersion} this map is transverse to the diagonal $\Delta \subset M\times M$.
The preimage $(ev_{k_0+1} \times ev_1)^{-1} (\Delta)$ may be identified with $\cZ_{A_0+A_1,S}$ and intuitively should possess a natural smooth structure.
Indeed, this is precisely the situation described by \cite{filippenko2018constrained}, which considers the general problem of developing a polyfold regularization theorem for constrained moduli spaces.
A natural polyfold structure on $\cZ_{A_0+A_1,S}$ follows from \cite{filippenko2018constrained}*{Thm.~1.5}; we make the technical remark that this requires shifting the polyfold filtration up one level.

On the other hand, it is straightforward to directly define a polyfold structure on $\cZ_{A_0+A_1,S}$; this does not require any shifting of the polyfold filtrations.
In the construction of a good uniformizing family of stable maps we may simply restrict to sections $\eta_0\in H^{3,\delta_0}_c (u_0^*TM)$,  $\eta_1\in H^{3,\delta_0}_c (u_1^*TM)$ which have matching asymptotic values at the punctures $z_{k_0+1}$, $z'_1$, i.e.,
\[
	\eta_0 (z_{k_0+1}) = \eta_1 (z'_1).
\]
In essence, to construct an appropriate good uniformizing family we treat $\{z_{k_0}, z'_1\}$ as a nodal pair but without an associated gluing parameter.
Compatibility of such different good uniformizing families of stable maps may then be shown by considering compatibility in the general case but where we restrict a gluing parameter to zero.

\begin{definition}
	Fix a homology class $A\in H_2(M;\Z)$ and fix a pair of integers $g,\ k$ such that $g\geq 1$, $k\geq 0$ and $2g+k \geq 3$.
	The \textbf{underlying set of the increased arithmetic genus Gromov--Witten polyfold (genus GW-polyfold)} is defined as
	\[
		\cZ^\text{g}_{A,g-1,k+2} := \{(\Sigma,j,M,D,u) \mid \cdots, u(z_{k+1})= u(z_{k+2}) \} / \sim
	\]
	with data as follows.
	\begin{itemize}
		\item The tuple $(\Sigma,j,M,D,u)$ is a stable map with respect to the GW-polyfold $\cZ_{A,g-1,k+2}$.
		\item We require the following incidence relation between the second-to-last and last marked points:
		      \[u (z_{k+1}) = u (z_{k+2}).\]
		      We moreover require that $u$ is of class $H^{3,\delta_0}$ at the punctures $z_{k+1}$ and $z_{k+2}$.
		\item As usual, the equivalence relation is given by biholomorphisms of the form $\phi:(\Sigma,j)\to (\Sigma',j')$ such that $\phi$ preserves the ordering of the marked points and maps pairs to pairs, and such that $u'\circ \phi = u$.
	\end{itemize}
\end{definition}

Consider the map
\[
	ev_{k+1} \times ev_{k+2} : \cZ_{A,g-1,k+2} \to M\times M.
\]
As above, the preimage $(ev_{k+1} \times ev_{k+2})^{-1} (\Delta)$ may be identified with $\cZ^\text{g}_{A,g-1,k+2}$.
A natural polyfold structure on $\cZ^\text{g}_{A,g-1,k+2}$ can be seen exactly as in the above case of the split GW-polyfolds.

We remark that considering the $(k+1)$th and $(k+2)$th marked points as a nodal pair, a stable curve in $\cZ^\text{g}_{A,g-1,k+2}$ has arithmetic genus $g$ and $k$ marked points.
However, it is vital to note that the morphisms would differ with this viewpoint; a morphism must fix the $(k+1)$th and $(k+2)$th marked points, however it may permute the nodal pairs.
As an explicit example of this phenomena, consider the sphere $S^2$ with three marked points $\{0,1,\infty\}$; the only morphism is the identity.
However if we consider $\{0\}$ as the only marked point and consider $\{1,\infty\}$ as a nodal pair we obtain a surface with arithmetic genus $1$ with two distinct morphisms: the identity, and the element of $\text{PGL}(2,\C)$ which fixes $0$ and exchanges the points $1$ and $\infty$.


\section{Maps between Deligne--Mumford orbifolds/Gromov--Witten polyfolds}\label{sec:maps-between-orbifolds-polyfolds}

In this section we consider certain naturally defined maps between DM-orbifolds\slash GW-polyfolds.

\subsection{Maps between orbifolds/polyfolds}

In principle, the definition of a map between orbifold-type spaces is somewhat subtle; the appropriate notion is a ``generalized map'' which is itself an equivalence class of a functor between two ep-groupoids (see \cite{HWZbook}*{Def.~16.5}).
However, in the present context this subtlety is not a concern due to the naturality of the maps we are considering; in these cases generalized maps arise naturally.
In the cases we consider, it is sufficient to define a map on the level of the underlying sets and then to check (scale) smoothness by writing appropriate local expressions in terms of good uniformizing families of stable noded Riemann surfaces/good uniformizing families of stable maps.

In the present context, it is sufficient to know the following: a generalized map $f: \cO \to \cP$ between orbifolds/polyfolds defines a continuous map between the underlying topological spaces (also written as $f: \cO \to \cP$) and also gives rise to an equivariant lift between local uniformizers:
\[
	\begin{tikzcd}[row sep = small]
		U \arrow[r, "\hat{f}"] \arrow[d]			& V \arrow[d] \\
		U / G \arrow[r, "\abs{\hat{f}}"] \arrow[d]	& V / H \arrow[d] \\
		\cO \arrow[r, "f"]							& \cP.
	\end{tikzcd}
\]
The lift $\hat{f}$ is equivariant with respect to an induced group homomorphism between the local isotropy groups, $G \to H$.
Then the induced map $\abs{\hat{f}}$ between the quotients $U/G$, $V/H$ is identifiable via local homeomorphisms with a restriction of the continuous map $f: \cO \to \cP$.
Hence, (scale) smoothness may therefore be checked by considering the local expressions given by the lift $\hat{f}$.

We also recall the important definition of scale smoothness.
Consider two $\ssc$-smooth retractions $\pi : U \to U$, $\pi' : U' \to U'$, and let $O:= \pi (U)$, $O':= \pi' (U')$ be the associated $\ssc$-retracts.
A map between two $\ssc$-retracts, $f: O \to O'$ is \textbf{$\ssc$-smooth} (resp.\ $\ssc^k$) if the composition $f\circ \pi : U \to U'$ is $\ssc$-smooth (resp.\ $\ssc^k$).
Note that for a finite-dimensional space the identity is a $\ssc$-retract, and hence we also have a consistent notion of $\ssc$-smoothness when the source or target space is finite-dimensional.

\subsection{Natural maps between the Deligne--Mumford orbifolds/Gromov--Witten polyfolds}


To begin, we consider the \textbf{identity map}
\[\id : \dmspace^\varphi_{g,k} \to \dmspace^\phi_{g,k}\]
on the DM-orbifolds with respect to different gluing profiles $\varphi$, $\phi$.
Since the topology is independent of gluing profile, it is clear this map is continuous for any choices of gluing profiles.

We begin by comparing the gluing constructions for different choices of gluing profile; it is easy to see that different gluing parameters will produce identical glued Riemann surfaces
$\Sigma^\varphi_a = \Sigma^\phi_b$
precisely when $\varphi (r_a) = \phi (r_b)$ and $\theta_a = \theta_b$.

Using this fact, we may write a local expression for the identity at an arbitrary point $[\Sigma,j,M,D] \in \dmspace^\varphi_{g,k}$ in terms of good uniformizing families centered at a stable noded Riemann surface representative $(\Sigma,j,M,D)$ as follows:
\begin{align*}
	\hat{\id} : \{\Sigma^\varphi_a,j(a,v),M_a,D_a \}_{(a,v)\in U}
	                            & \to \{\Sigma^\phi_b,j(b,w), M_b,D_b \}_{(b,w)\in V}           \\
	(r_a e^{-2\pi i\theta_a},v) & \mapsto (\phi^{-1}\circ \varphi(r_a) e^{-2\pi i\theta_a}, v).
\end{align*}


\begin{proposition}\label{prop:identity-exp-to-log}
	The identity map from the exponential to the logarithmic DM-orbifolds,
	\[
		\id : \dmexp_{g,k} \to \dmlog_{g,k}
	\]
	is smooth.
\end{proposition}
\begin{proof}
	We assert that all local expressions for the identity map are smooth. 	This reduces to the claim that the function
	\[
		\C \to \C, \qquad r_a e^{-2\pi i\theta_a} \mapsto \varphi^{-1}_{\log}\circ \varphi_{\exp}(r_a) e^{-2 \pi i\theta_a}
	\]
	is smooth.
	The inverse of $\varphi_{\log}(r) = -\tfrac{1}{2\pi} \log (r)$ is given by $\varphi^{-1}_{\log} (R) = e^{-2\pi R}$, hence $\varphi^{-1}_{\log}\circ \varphi_{\exp}(r_a) = e^{-2\pi (e^{1/r_a}-e)}$.
	We may write this function in rectangular coordinates as
	\[
		\R^2 \to \R^2, \qquad (x,y) \mapsto \frac{\varphi^{-1}_{\log}\circ \varphi_{\exp}(\sqrt{x^2+y^2})}{\sqrt{x^2+y^2}} (x,y).
	\]
	This function is smooth, except possibly at $(0,0)$.
	Considering partial derivatives of the coordinate functions, one may see that it is enough to show that the coordinate function
	\[
		\R \to \R, \qquad x \mapsto \sign (x) e^{-2\pi \left(e^{{1}/{\abs{x}}}-e\right)}
	\]
	is smooth at $0$.
	The derivatives of this function may be computed using the chain rule; they will involve sums and multiples of terms of the form
	\[
		\frac{C  e^{-2\pi \left(e^{1/\abs{x}} -e\right) + a/\abs{x}}}{x^b}
	\]
	for a constant $C$ and positive integers $a,b$; such terms have limit $0$ as $x\to 0$.
\end{proof}

\begin{remark}
	Consider now the identity map from the logarithmic to the exponential DM-orbifolds,
	\[\id : \dmlog_{g,k} \to \dmexp_{g,k}.\]
	As we have already observed this identity map is continuous; however in general it is not differentiable---the only the exception is the trivial case $(g,k)=(0,3)$, in which case $\dmspace_{0,3} = \{\pt\}$.
	As above, the gluing parameters transform according to the function
	\[
		\C \to \C, \qquad r_a e^{-2\pi i\theta_a} \mapsto \varphi^{-1}_{\exp}\circ \varphi_{\log}(r_a) e^{-2 \pi i\theta_a}.
	\]
	We may further write a coordinate function
	\[
		\R \to \R, \qquad x \mapsto \sign (x) \frac{1}{\log ( -\tfrac{1}{2\pi} \log (\abs{x}) + e )}.
	\]
	The limits as $x\to 0$ of the first derivatives of this function do not exist.
\end{remark}


The \textbf{evaluation map at the $i$th-marked point} is defined on the level of underlying sets by
\begin{align*}
	ev_i : 	\cZ_{A,g,k} & \to M           \\
	[\Sigma,j,M,D,u]    & \mapsto u(z_i).
\end{align*}
It is well-defined regardless of whether there is a puncture at the marked point $z_i$ or not.

\begin{proposition}\label{prop:evaluation-smooth-submersion}
	The evaluation map is a $\ssc$-smooth submersion.
\end{proposition}
\begin{proof}
	We check the $\ssc$-smoothness at an arbitrary stable curve $[\Sigma,j,M,D,u]\in \cZ_{A,g,k}$.
	Let $(a,v,\eta)\in\cU$ be a local uniformizer centered at a representative $(\Sigma,j,M,D,u)$.
	Choose a chart on $M$ which identifies $u(z_i)\in M$ with $0\in \R^{2n}$ and assume moreover this chart is chosen such that the given Riemannian metric $g$ on $M$ is identifiable with the Euclidean metric on $\R^{2n}$.
	The local expression for a retraction composed with the evaluation map is
	\[
		(a,v,\eta) \mapsto (a,v,\pi_a (\eta)) \mapsto \exp_u\eta (z_i) = \eta(z_i).
	\]
	which is $\ssc$-smooth.
	The linearization of this expression also clearly spans the tangent space $T_{u(z_i)} M$, which proves the claim that the evaluation map is submersive.
\end{proof}


The \textbf{projection map},
\begin{align*}
	\pi:\cZ_{A,g,k}  & \rightarrow \dmspace_{g,k}        \\
	[\Sigma,j,M,D,u] & \mapsto  [(\Sigma,j,M,D)_{stab}],
\end{align*}
is defined on the level of underlying sets by taking a stable curve and, after removing unstable components, associating the underlying stable domain.

We describe this process on the level of the underlying sets as follows.  Consider a point $[\Sigma,j,M,D,u]\in \cZ_{A,g,k}$, and let $(\Sigma,j,M,D,u)$ be a stable map representative.
First forget the map $u$ and consider, if it exists, a component $C\subset \Sigma$ satisfying $2g_C+\sharp (M\cup |D|)_C<3$.
Then we have the following cases.
\begin{enumerate}
	\item $C$ is a sphere without marked points and with one nodal point, say $x$. Then  we remove the sphere, the nodal point $x$ and its partner $y$, where $\{x,y\}\in D$.
	\item $C$ is a sphere with two nodal points. In this case there are two  nodal pairs $\{x,y\}$ and $\{x',y'\}$, where $x$ and $x'$ lie on the sphere.  We remove the sphere and the two nodal pairs  but add the nodal pair $\{y,y'\}$.
	\item $C$ is a sphere with one node and one marked point. In that case we  remove the sphere but replace the corresponding nodal point  on the other component by the marked point.
\end{enumerate}
Once we have removed all unstable components in this manner, we end up with a stable noded marked Riemann surface we denote as $(\Sigma,j,M,D)_{stab}$.

\begin{proposition}\label{prop:projection-map-smooth}
	The projection map
	\begin{align*}
		\pi: \cZ_{A,g,k} & \to \dmlog_{g,k}                       \\
		[\Sigma,j,M,D,u] & \mapsto [(\Sigma,j,M,D)_{\text{stab}}]
	\end{align*}
	defined between the GW-polyfold and the logarithmic DM-orbifold is $\ssc$-smooth.

\end{proposition}
\begin{proof}
	We check scale smoothness at an arbitrary stable curve $[\Sigma,j,M,D,u]\in \cZ_{A,g,k}$.
	Consider a good uniformizing family of stable maps centered at a stable map representative:
	\[(a,v,\eta) \to (\Sigma_a,j(a,v),M_a,D_a,\oplus_a \exp_u \eta), \qquad (a,v,\eta)\in \cU\]
	Recall that the construction of a good uniformizing family of stable maps requires we choose a stabilization $S\subset \Sigma$ to the underlying Riemann surface in order to make it stable.
	Thus, we may also consider the following a good uniformizing family of stable Riemann surfaces:
	\[(a,v) \mapsto (\Sigma_a,j(a,v), (M\cup S)_a, D_a), \qquad (a,v)\in U\]
	Crucially, we use the exponential gluing profile for both of these good uniformizing families.

	We may write a local expression for the projection map as a composition in the following way.
	First, forget the stable map from the good uniformizing family,
	\begin{align*}
		\{(\Sigma_a,j(a,v),M_a,D_a,\oplus_a \exp_u \eta)\}_{(a,v,\eta)\in \cU}
		           & \to \{(\Sigma_a,j(a,v), (M\cup S)_a, D_a)\}_{(a,v)\in U} \\
		(a,v,\eta) & \mapsto (a,v)
	\end{align*}
	(note also that this expression is only defined locally due to the stabilization).
	Then switch from the exponential to the logarithmic gluing profile,
	\begin{align*}
		\{(\Sigma_a,j(a,v), (M\cup S)_a, D_a)\}_{(a,v)\in U}
		                            & \xrightarrow{\hat{\id}} \{(\Sigma_b,j(b,w), (M\cup S)_b, D_b)\}_{(b,w)\in V}      \\
		(r_a e^{-2\pi i\theta_a},v) & \mapsto (\varphi_{\log}^{-1} \circ \varphi_{\exp} (r_a) e^{-2 \pi i\theta_a}, v).
	\end{align*}
	We may then forget all of the stabilizing points in $S$, which we may write as a composition of maps which each forgets a single stabilizing point, by composing with the following sequence of maps:%
	\[
		\dmlog_{g,k+\sharp S} \xrightarrow{ft} \dmlog_{g,k+\sharp S-1} \xrightarrow{ft} \cdots \xrightarrow{ft} \dmlog_{g,k}
	\]
	By Proposition~\ref{prop:ftk-log-dmspace} the forgetting maps on the logarithmic DM-orbifolds are smooth. Hence, the local expression for $\pi$ is a composition of $\ssc$-smooth maps, and is therefore smooth.



\end{proof}


Fix a permutation $\sigma \in S_k$ in the symmetric group, i.e., a bijection $\sigma: \{1,\ldots, k\}\to \{1,\ldots,k\}$.
The \textbf{permutation map} is defined on the underlying set of a DM-space
\[
	\sigma: \dmspace_{g,k} \to \dmspace_{g,k}, \qquad [\Sigma,j,M,D]  \mapsto [\Sigma,j,M^\sigma,D]
\]
or on the underlying set of a GW-polyfold
\[
	\sigma: \cZ_{A,g,k} \to \cZ_{A,g,k}, \qquad [\Sigma,j,M,D,u]  \mapsto [\Sigma,j,M^\sigma,D,u]
\]
by relabeling the marked points as follows: with $M = \{z_1,\ldots,z_k\}$ we define $M^\sigma := \{z'_1,\ldots,z'_k\}$ by the relabeling $z'_i:= z_{\sigma(i)}$.

\begin{proposition}\label{permutation-map-sc-smooth}
	The permutation map between logarithmic or exponential DM-orbifolds is a diffeomorphism. The permutation map between GW-polyfolds is a $\ssc$-diffeomorphism.
\end{proposition}
\begin{proof}
	In either case, the choice of good uniformizing family (along with data such as the stabilization) may be made identically, without regard for the specific numbering of the marked points. The permutation map in such local coordinates will be the identity.
\end{proof}


\subsection{The \texorpdfstring{$k$th-marked}{kth-marked} point forgetting map on the logarithmic Deligne--Mumford orbifolds}\label{subsec:kth-marked-point-forgetting-map-log-dm}
Suppose that $2g+k >3$.  We define the \textbf{$k$th-marked point forgetting map}
\[
	ft_k :\dmspace_{g,k} \to \dmspace_{g,k-1}
\]
on the underlying sets of the DM-spaces as follows.  Let $[\Sigma,j,M,D]\in \dmspace_{g,k}$, and let $(\Sigma,j,M,D)$ be a representative given by a stable noded Riemann surface.  To define $ft_k ([\Sigma,j,M,D])$ we distinguish three cases for the component $C_k$ which contains the $k$th-marked point, $z_k\in C_k$.
\begin{enumerate}
	\item\label{case-1}
	      The component $C_k\setminus \{z_k\}$ satisfies the DM-stability condition. It follows that  $2 g_{C_k} + \sharp (M \cup \abs{D})_{C_k}>3$ and we define
	      \[
		      ft_k ([\Sigma,j,M,D]) = [\Sigma,j,M\setminus\{z_k\}, D].
	      \]
	\item The component $C_k\setminus \{z_k\} $ does not satisfy the DM-stability condition.  It follows that $2 g_{C_k} + \sharp (M \cup \abs{D})_{C_k}=3$.  From $2g+k>3$ and the assumption that the set $\Sigma / \sim$ (where $x_a\sim y_a$ for nodal pairs $\{x_a,y_a\}\in D$) is connected, we can deduce
	      \[
		      2 g_{C_k} = 0, \qquad \sharp (M \cup \abs{D})_{C_k}=3.
	      \]
	      There are now two possibilities.
	      \begin{enumerate}
		      \item[(2a)]\label{case-2a}
		            $z_k\in M_{C_k}$, and two nodal points $z_a, z_b \in \abs{D}_{C_k}$
		            Then $ft_k ([\Sigma,j,M,D])$ is defined as the equivalence class of the stable noded Riemann surface obtained from $(\Sigma,j,M,D)$ as follows.
		            Delete $z_k$, delete the component $C_k$, and delete the two nodal pairs.  We add a new nodal pair $\{x_a,y_b\}$ given by two points of the former nodal pairs.
		      \item[(2b)]\label{case-2b}
		            $z_i, z_k\in M_{C_k}$, and one nodal point $z_a \in \abs{D}_{C_k}$
		            Then $ft_k ([\Sigma,j,M,D])$ is defined as the equivalence class of the stable noded Riemann surface obtained from $(\Sigma,j,M,D)$ as follows.
		            Delete $z_k$, delete the component $C_k$, and delete the nodal pair.  We add a new marked point $z_i$, given by the former nodal point which did not lie on $C_k$.
	      \end{enumerate}
\end{enumerate}


\begin{remark}[Special cases for the $k$th-marked point forgetting map]\label{rmk:special-cases-forgetting}
	By definition, if $2g+(k-1) < 3$ then $\dmspace_{g,k-1}=\emptyset$; hence, one can also consider the trivial map $ft_k : \dmspace_{g,k} \to \emptyset$.

	By considering possible stable configurations, one can see that $ft_k$ is given by case 1 whenever $[\Sigma,j,M,D]$ lies on the top dimensional stratum of the DM-space.
	Additionally, there will exist a point $[\Sigma,j,M,D]$ with the configuration specified by case 2a whenever
	\[
		(g=0, k\geq 5), \quad (g=1,k=1), \quad (g\geq 2, k\geq 1).
	\]
	Finally, there will exist a point $[\Sigma,j,M,D]$ with the configuration specified by case 2b whenever
	\[
		(g=0, k\geq 4), \qquad (g\geq 1, k\geq 2).
	\]
\end{remark}

\begin{remark}[The universal curve]
	The preimage of a point $[\Sigma,j,M,D] \in \dmspace_{g,k-1}$ via $ft_k$ consists of the Riemann surface $\Sigma$ with nodes identified, i.e.,
	\[
		ft_k^{-1} ([\Sigma,j,M,D]) \simeq \Sigma / \sim, \quad \text{where $x_a\sim y_a$ for nodal pairs $\{x_a,y_a\}\in D$}.
	\]
	According to such a description $\dmspace_{g,k}$ is sometimes called the \textbf{universal curve} over $\dmspace_{g,k-1}$.  We note that this is not a fiber bundle (the ``fibers'' are not constant and can vary locally), nor is it a fibration (the ``fibers'' are not homotopy equivalent).  However, considered as homology classes, the fibers are homologous.
\end{remark}

\subsubsection{Local expressions for the $k$th-marked point forgetting map on the DM-orbifolds.}\label{subsubsec:local-expression-forgetting-map-on-dm-orbifold}
We now write down local expressions for $ft_k$ in the coordinates given by the (alternative) good uniformizing families. We work first with regards to an arbitrary gluing profile on the DM-orbifolds to obtain general expressions.


Consider a stable Riemann surface $[\Sigma,j,M,D]\in \dmspace_{g,k}$.
We may write a local expression for $ft_k$ for each of the three cases as follows.

\noindent\textit{Case 1.}
By assumption $C_k \setminus \{z_k\}$ is stable.
Hence we can take an alternative good uniformizing family centered at a representative $(\Sigma,j,M,D)$: $(a,v,y)\mapsto (\Sigma_a, j(a,v), M_{(a,y)}, D_a )$.
Observe that forgetting the parametrization of the $k$th-marked point gives a good uniformizing family centered at $(\Sigma,j,M\setminus\{z_k\},D)$: $(a,v)\mapsto (\Sigma_a, j(a,v), (M\setminus\{z_k\})_a, D_a )$.

A local expression for $\hat{ft}_k$ in terms of these good uniformizing families is given by
\begin{align*}
	\hat{ft}_k : \{(\Sigma_a,j(a,v),M_{(a,y)}, D_a)\}_{(a,v,y)\in U}
	        & \to \{(\Sigma_b, j(b,w), (M\setminus\{z_k\})_b, D_b)\}_{(b,w)\in V} \\
	(a,v,y) & \mapsto (a,v).
\end{align*}

\noindent\textit{Case 2a.}
For notational simplicity, let us assume that $\{x_a,y_a\}$ and $\{x_b,y_b\}$ are the only nodal pairs on the stable Riemann surface, i.e., we consider $[\Sigma, \allowbreak j, \allowbreak M, \allowbreak \{\{x_a,y_a\}, \allowbreak  \{x_b,y_b\}\}]$.
Hence after forgetting the $k$th-marked point there is only one nodal pair, which we denote as $\{x_c,y_c\}$.

There is a unique biholomorphism
\[C_k \setminus \{y_a,x_b\} \simeq \R\times S^1\]
which sends the marked point $z_k$ to the point $(0,0)$, the puncture $y_a$ to $-\infty$, and the puncture $x_b$ to $+\infty$.
We may choose the small disk structure at $y_a$ such that there is a biholomorphism between $D_{y_a}\setminus \{y_a\}$ and $\R^-\times S^1\subset \R\times S^1$.  Likewise, we choose the small disk structure at $x_b$ such that there is a biholomorphism between $D_{x_b}\setminus \{x_b\}$ and $\R^+\times S^1$.

We replace $D_{x_a}\sqcup C_k \sqcup D_{y_b}$ with the glued cylinder
\[
	Z_{a,b} :=
	\begin{cases}
		[0,R_a+R_b]\times S^1                                    & a\neq 0, b\neq 0,                     \\
		\R^+\times S^1 \sqcup \R^-\times S^1                     & a\neq 0,b=0 \text{ or } a=0, b\neq 0, \\
		\R^+\times S^1 \sqcup \R\times S^1 \sqcup \R^-\times S^1 & a=0, b=0.
	\end{cases}
\]
We thus obtain the glued Riemann surface
\[\Sigma_{a,b}: = \Sigma \setminus (D_{x_a}\sqcup C_k \sqcup D_{y_b}) \sqcup Z_{a,b}.\]
The movement of the marked point $z_k$ is parametrized as follows:
\begin{itemize}
	\item For $a=b=0$, the marked point $z_k$ is given by $(0,0)$ on the component $\R \times S^1$.
	\item For $a\neq 0$ and $b=0$, the marked point $z_k$ is given by $(R_a,\theta_a)\in \R^+\times S^1$.  Analogously for $a=0$ and $b\neq 0$, the marked point is given by $(R_b,\theta_b)\in \R^-\times S^1$.
	\item For $a\neq 0$ and $b\neq 0$, the marked point $z_k$ is given by $(R_a,\theta_a)$ in the $(s^+,t^+)$ coordinates and $(-R_b,-\theta_b)$ in the $(s^-,t^-)$ coordinates.
\end{itemize}

Consider a good uniformizing family centered at $(\Sigma,j,M, \{\{x_a,\hspace{-1pt}y_a\}, \{x_b,\hspace{-1pt}y_b\}\})$:
\[
	(a,b,v)\mapsto (\Sigma_{a,b},j(a,b,v),M_{a,b},\{\{x_a,y_a\}, \{x_b,y_b\} \}_{a,b} ), \qquad (a,b,v) \in \hb\times \hb \times V.
\]
We may use the same good complex deformation after forgetting the $k$th-marked point, hence we may also consider a good uniformizing family centered at  $\hat{ft}_k (\Sigma,j,M,\{\{x_a,y_a\}, \{x_b,y_b\}\}) = (\Sigma\setminus C_k, j, M\setminus \{z_k\}, \{\{x_c,y_c\}\})$:
\[
	(c,w)\mapsto ((\Sigma\setminus C_k)_c, j(c,w), (M\setminus \{z_k\})_c, \{\{x_c,y_c\}\}_c), \qquad (c,w) \in \hb \times V
\]
Comparing the families of Riemann surfaces, we see
\begin{align*}
	 & \hat{ft}_k (\Sigma_{a,b},j(a,b,v),M_{a,b},\{\{x_a,y_a\}, \{x_b,y_b\}\}_{a,b})     \\
	 & \qquad = ((\Sigma\setminus C_k)_c, j(c,w), (M\setminus \{z_k\})_c, \{x_c,y_c\}_c)
\end{align*}
precisely when $w=v$ and when $c= a\ast_{\varphi} b$ where $a\ast_{\varphi} b$ is defined by:
\[\label{local-expression-for-ftk}
	a\ast_{\varphi} b :=
	\begin{cases}
		\varphi^{-1}(\varphi(r_a)+\varphi(r_b)) e^{-2\pi i (\theta_a+\theta_b)} & \text{when } a\neq 0 \text{ and } b\neq 0, \\
		0                                                                       & \text{when } a=0 \text{ or } b=0.
	\end{cases}
\]

A local expression for $\hat{ft}_k$ is given by:
\begin{align*}
	\hat{ft}_k : & \{(\Sigma_{a,b},j(a,b,v),M_{a,b},\{\{x_a,y_a\}, \{x_b,y_b\}\}_{a,b})\}_{(a,b,v)}               \\
	             & \qquad\to \{((\Sigma\setminus C_k)_c, j(c,w), (M\setminus \{z_k\})_c, \{x_c,y_c\}_c)\}_{(c,w)} \\
	             & (a,b,v)  \mapsto (a\ast_{\varphi} b, v).
\end{align*}

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{ft5.eps}
	\caption{The $5$th-marked point forgetting map}
\end{figure}

\noindent\textit{Case 2b.}
Again for simplicity, let us assume that $\{x_a,y_a\}$ is the only nodal pair on $[\Sigma,j,M,D]$ and hence $ft_k([\Sigma,j,M,D])$ contains no nodal pairs.
Hence we consider assume $[\Sigma,j,M,\{\{x_a,y_a\}\}]$ which maps to $ft_k ([\Sigma,j,M,\{\{x_a,y_a\}\}]) = [\Sigma\setminus C_k, j, M\setminus \{z_k\}, \emptyset]$.

Again, there is a unique biholomorphism between $C_k \setminus \{y_a,z_i\}$ and $\R\times S^1$ which sends the marked point $z_k$ to the point $(0,0)$, the puncture $y_a$ to $-\infty$, and the puncture at the marked point $z_i$ to $+\infty$.
We may choose the small disk structure at $y_a$ such that there is a biholomorphism between $D_{y_a}\setminus \{y_a\}$ and $\R^-\times S^1\subset \R\times S^1$.
For $a\neq 0$ we may write the ``glued'' cylinder as:
\[
	\Sigma_a = \Sigma \setminus (D_{x_a} \sqcup D_{y_a}) \sqcup Z_a \sqcup \R^+\times S^1 \sqcup \{+\infty\} \simeq \Sigma \setminus C_k.
\]
The movement of the marked point $z_k$ is parametrized as follows:
\begin{itemize}
	\item For $a=0$, the marked point $z_k$ is given by $(0,0)$ on the component $\R \times S^1$, while the marked point $z_i$ is given by the puncture at $+\infty$ on $\R\times S^1$.
	\item For $a\neq 0$ the marked point $z_k$ is given by $(R_a,\theta_a)\in \R^+\times S^1$, while the marked point $z_i$ is again given by the puncture at $+\infty$ on $\R^+\times S^1$.
\end{itemize}

Consider a good uniformizing family centered at $(\Sigma,j,M,\{\{x_a,y_a\}\})$:
\[
	(a,v)\mapsto (\Sigma_a,j(a,v),M_a,\{\{x_a,y_a\}\}_a), \qquad (a,v) \in \hb \times V
\]
We may use the same good complex deformation after forgetting the $k$th-marked point, hence we may also consider a good uniformizing family centered at $\hat{ft}_k (\Sigma,j,M,\{\{x_a,y_a\}\}) = (\Sigma\setminus C_k, j, M\setminus \{z_k\}, \emptyset)$:
\[
	w\mapsto (\Sigma\setminus C_k, j(w), M\setminus \{z_k\},\emptyset), \qquad w\in V
\]

Comparing the families of Riemann surfaces, we see
\[
	\hat{ft}_k (\Sigma_a,j(a,v),M_a,\{\{x_a,y_a\}\}_a) = (\Sigma\setminus C_k, j(w), M\setminus \{z_k\}, \emptyset)
\]
precisely when $w=v$.

A local expression for $\hat{ft}_k$ is given by:
\begin{align*}
	\hat{ft}_k : \{(\Sigma_a,j(a,v),M_a,\{\{x_a,y_a\}\}_a)\}_{(a,v)} & \to \{(\Sigma\setminus C_k, j(w), M\setminus \{z_k\}, \emptyset)\}_{w} \\
	(a,v)                                                            & \mapsto v.
\end{align*}



\begin{proposition}\label{prop:ftk-log-dmspace}
	The $k$th-point forgetting map, considered on the Deligne--Mumford orbifolds constructed with the logarithmic gluing profile,
	\[
		ft_k: \dmlog_{g,k}\to \dmlog_{g,k-1},
	\]
	is a smooth map.  Moreover, it is holomorphic.
\end{proposition}
\begin{proof}
	We check the smoothness of local expressions of $ft_k$.  The only points in $\dmlog_{g,k}$ where the local expression of $\hat{ft}_k$ will not be trivially holomorphic is when $[\Sigma,j,M,D]$ belongs to case \ref{case-2a}, i.e., a representative contains a component $S^2$ with precisely $3$ special points, one of which is the $k$th-marked point while the other two are nodal points.
	The inverse of $\varphi_\text{log}(r)=-\tfrac{1}{2\pi}\log (r)$ is given by $\varphi^{-1}_\text{log}(R)= e^{-2\pi R}$.  Hence it follows that:
	\[
		a\ast_{\log} b = r_a\cdot r_b e^{-2\pi i (\theta_a+\theta_b)} =	a\cdot b,
	\]
	i.e., complex multiplication of the gluing parameters. Therefore the local expressions for $\hat{ft}_k$ are all holomorphic.
\end{proof}


For $i\in \{1,\ldots,k-1\}$, we may define a \textbf{canonical section}
\[
	s_i : \dmspace_{g,k-1} \to \dmspace_{g,k}
\]
on the DM-spaces by introducing a new component $S^2$ which contains the marked points $z_i$ and $z_k$.
This map is a section of $ft_k: \dmspace_{g,k} \to \dmspace_{g,k-1}$ in the sense that $ft_k \circ s_i = \id_{\dmspace_{g,k-1}}$.
For any choice of gluing profile, this map is a {smooth embedding} of $\dmspace_{g,k-1}$ into $\dmspace_{g,k}$.


\subsection{Inclusion and marked point identifying maps for the split/genus Gromov--Witten polyfolds}\label{subsec:inclusion-marked-point-identifying-maps}

Associated to a splitting $S$ of $(g,k)$ as defined in \S\ref{subsec:other-gw-polyfolds} we may consider the natural \textbf{marked point identifying map}
\[
	\phi_S : \dmspace_{k_0+1 , g_0}\times \dmspace_{k_1+1 , g_1} \to \dmspace_{g,k}
\]
which identifies the last marked point of a stable noded Riemann surface in $\dmspace_{k_0+1 , g_0}$ with the first marked point of a stable noded Riemann surface in $\dmspace_{k_1+1, g_1}$, and which maps the first $k_0$ marked points of $\dmspace_{g_0,k_0+1}$ to $\{1,\ldots,k_0\}$ and likewise maps the last $k_1$ marked points of $\dmspace_{g_1,k_1+1}$ to $\{k_0+1,\ldots,k_0+k_1\}$.

Let $A_0$, $A_1$ be such that $A_0+A_1=A$.
Together with the inclusion map, this map lifts to a $\ssc$-smooth map defined on the split GW-polyfolds:
\[
	\begin{tikzcd}
		\cZ_{A_0,g_0,k_0+1} \times \cZ_{A_1,g_1,k_1+1}	&	\\
		\cZ_{A_0+A_1,S}	\arrow[u, hook, "i"] \arrow[r, "\phi_S"] & \cZ_{A,g,k}
	\end{tikzcd}
\]

There is also a natural map
\[\psi: \dmspace_{g-1,k+2} \to \dmspace_{g,k}\]
which identifies the last two marked points of a stable noded Riemann surface increasing the arithmetic genus by one.
Note that this is a degree two map.
Given a point in the top stratum of $\dmspace_{g-1,k+2}$, by exchanging the marked points $z_{k+1}$ and $z_{k+2}$ we will in general obtain distinct points in $\dmspace_{g-1,k+2}$, but both of these points will map to the same point in $\dmspace_{g,k}$.
The exception is if both points $z_{k+1}$ and $z_{k+2}$ lie on a single component $S^2$ with one other special point; however in this case the image will be a singular point $\dmspace_{g,k}$ and should be counted with weight $\tfrac{1}{2}$.

Together with the inclusion map, this map also lifts to a $\ssc$-smooth map defined on the genus GW-polyfolds:
\[
	\begin{tikzcd}
		\cZ_{A,g-1,k+2} 		&	\\
		\cZ^\text{g}_{A,g-1,k+2}	\arrow[u, hook, "i"] \arrow[r, "\psi"] & \cZ_{A,g,k}
	\end{tikzcd}
\]


\section{The polyfold Gromov--Witten invariants}\label{sec:the-polyfold-gw-invariants}

In this section, we give a brief introduction to the polyfold GW-invariants as defined in \cite{HWZGW}.
In addition to the definition of these invariants via the branched integral of \cite{HWZint}, it is also necessary to give an equivalent definition of these invariants in terms of intersection numbers, as introduced in \cite{schmaltz2019steenrod}.

\subsection{Abstract perturbation of the Cauchy--Riemann section}\label{subsec:cauchy-riemann-section}

At the outset, fix a compatible almost complex structure $J$ on $M$ so that $\ww(\cdot,J\cdot)$ is a Riemannian metric on $M$.

\begin{definition}\label{def:strong-polyfold-bundle}
	The \textbf{underlying set of the strong polyfold bundle $\cW_{A,g,k}$} is defined as the set of equivalence classes
	\[
		\cW_{A,g,k}:= \{ (\Sigma,j,M,D,u,\xi ) \mid \cdots \} / \sim
	\]
	with data as follows.
	\begin{itemize}
		\item $(\Sigma,j,M,D,u)$ is a stable map representative of a stable curve in $\cZ_{A,g,k}$.
		\item $\xi$ is a continuous section along $u$ such that the map
		      \[
			      \xi(z):T_z\Sigma\rightarrow T_{u(z)}M,\qquad \text{for } z\in
			      \Sigma
		      \]
		      is a complex anti-linear map.
		\item As in Definition~\ref{def:class-3delta} we may write a local expression for $\xi$ of the form
		      \[
			      [s_0,\infty) \times S^1 \to \R^{2n}, \quad (s,t) \mapsto d\varphi_{u(\sigma(s,t))} \cdot \xi (\sigma(s,t)) \cdot \left(\tfrac{\partial}{\partial_s} \sigma(s,t)\right)
		      \]
		      which is defined for $s_0$ large. We require this local expression is of class $H^{2,\delta_0}$ around the nodal points in $\abs{D}$.
		      We require a similar coordinate expression is of class $H^2_\text{loc}$ near the other points in $\Sigma$.
		      (If $u$ has a puncture at the marked point $z_i$, then we also require that $\xi$ is of class $H^{2,\delta_0}$ at the marked point.)
		\item The equivalence relation is given by
		      \[(\Sigma,j,M,D,u,\xi)\sim (\Sigma',j',M',D',u',\xi')\]
		      if there exists a biholomorphism $\phi :(\Sigma,j)\to (\Sigma',j')$ which satisfies $\xi'\circ d\phi=\xi$ in addition to $u'\circ \phi = u$, $\phi(M)= M'$, $\phi (\abs{D})=\abs{D'}$, and which preserves ordering and pairs.
	\end{itemize}
\end{definition}

By \cite{HWZGW}*{Thm.~1.10}, the set $\cW_{A,g,k}$ possesses a polyfold structure such that
\[
	P:\mathcal{W}_{A,g,k}\to \mathcal{Z}_{A,g,k}, \qquad [\Sigma,j,M,D,u,\xi]\mapsto [\Sigma,j,M,D,u]
\]
defines a ``strong polyfold bundle'' over the GW-polyfold $\cZ_{A,g,k}$.

The \textbf{Cauchy--Riemann section} $\delbarj$ of the strong polyfold bundle $P:\cW_{A,g,k}\to \cZ_{A,g,k}$ is defined on the underlying sets by
\[
	\delbarj([\Sigma,j,M,D,u]):=[\Sigma,j,M,D,u, \frac{1}{2}( du+J(u)\circ du\circ j)].
\]
By \cite{HWZGW}*{Thm.~1.11}, the  Cauchy--Riemann section is an $\ssc$-smooth Fredholm section with Fredholm index given by
\[\ind \delbarj =2c_1(A)+(\dim_{\R} M-6)(1-g)+2k.\]

We define the \textbf{unperturbed Gromov--Witten moduli space} as the zero set of this section,
\[
	\CM_{A,g,k}(J) := \{[\Sigma,j,M,D,u] \mid \delbarj([\Sigma,j,M,D,u])  =0 \} \subset \cZ_{A,g,k}.
\]
This set is precisely the same as the stable map compactification of a GW-moduli space as we discussed in the introduction.
Moreover, one may show that the subspace topology on $\CM_{A,g,k}(J)$ is equivalent to the Gromov topology defined on the stable map compactification.





There exist ``regular perturbations'' $p$ which ``regularize'' the unperturbed GW-moduli spaces; thus we obtain a \textbf{perturbed Gromov--Witten moduli space}
\[
	\cS_{A,g,k} (p) := \text{`` } (\delbarj +p)^{-1}(0) \text{ ''} \subset \cZ_{A,g,k}
\]
which has the structure of a compact oriented \textit{weighted branched suborbifold}.
For the precise definition of a ``regular perturbation'', we refer to \cite{HWZbook}*{Cor.~15.1}.
We recall some important properties of such a suborbifold.

\begin{definition}\label{def:weighed-branched-suborbifold}
	Let $\Q^+:= \Q \cap [0,\infty)$.
	A \textbf{weighted branched suborbifold} $\cS$ of the GW-polyfold $\cZ_{A,g,k}$ is a subset $\cS \subset \cZ_{A,g,k}$ such that:
	\begin{itemize}
		\item $\cS$ consists entirely of \textit{smooth} stable curves,
		\item $\cS$ comes equipped with a rational valued \textbf{weight function} $\theta : \cS \to \Q^+$.
	\end{itemize}
	Given a stable curve $[\Sigma,j,M,D,u] \in \cS$, let
	\[
		(a,v,\eta) \to (\Sigma_a,j(a,v),M_a,D_a,\oplus_a \exp_u \eta), \quad (a,v,\eta) \in \cU
	\]
	be a local uniformizer for $\cZ_{A,g,k}$ centered at a representative $(\Sigma,j,M,D,u)$.
	Then $\cS$ may be locally described as follows:
	\begin{itemize}
		\item \textbf{Local branches.} There exists a finite collection $M_i$, $i\in I$ of finite-dimensional manifolds $(M_i)_{i\in I}$ and proper embeddings
		      \[
			      M_i \hookrightarrow \{(\Sigma_a,j(a,v),M_a,D_a,\oplus_a \exp_u \eta)\}_{(a,v,\eta) \in \cU}
		      \]
		      such that the union $\cup_{i\in I} M_i$ is $\Aut(\Sigma,j,M,D,u)$-invariant, and moreover
		      \[
			      \frac{\bigcup_{i \in I} M_i}{\Aut(\Sigma,j,M,D,u)} \to \cS
		      \]
		      is a local homeomorphism.
		\item \textbf{Weights.} Associated to each $M_i$ there exists a positive rational number $w_i$ such that the function
		      \[
			      \hat{\theta} : \bigcup_{i \in I} M_i \to \Q^+, \qquad	x \mapsto \sum_{ \{i\in I \mid x\in M_i\} } w_i
		      \]
		      is an $\Aut(\Sigma,j,M,D,u)$-invariant lift of the weight function $\theta:\cS \to \Q^+$.
	\end{itemize}
	The data ${(M_i)}_{i\in I}$, ${(w_i)}_{i\in I}$ is called a \textbf{local branching structure}.
	We say that $\cS$ is \textbf{compact} if the underlying topological space equipped with the subspace topology is compact.
	We may define an \textbf{orientation} on a weighted branched suborbifold as an $\Aut$-invariant orientation of each local branch, denoted as $(M_i,o_i)$.
\end{definition}
We note that this is only a partial description of a weighted branched suborbifold but it is sufficient for our purposes, see {\cite{HWZbook}*{Def.~9.1}} for a full definition in the context of ep-groupoid theory.


\subsection{Polyfold Gromov--Witten invariants as branched integrals}\label{subsec:branched-integrals}

We briefly consider the branched integration theory, as originally developed in \cite{HWZint}.
Given a smooth map from a polyfold to a manifold/orbifold,
\[f:\cZ \to \cO,\]
we may pullback a differential form $\ww \in \Omega^n(\cO)$ and obtain a ``$\ssc$-differential form'' $f^*\ww \in \Omega^n_\infty (Z)$.
We can consider the restriction of a $\ssc$-differential form to a weighted branched suborbifold; locally this restriction is the same as the normal pullback on the local branches.

\begin{theorem}[{\cite{HWZbook}*{Thm.~9.2}}]\label{def:branched-integral}
	Let $\cZ$ be a polyfold.
	Consider a $\ssc$-smooth differential form $\ww\in \Omega^n_\infty (Z)$ and an $n$-dimensional compact oriented weighted branched suborbifold $\cS\subset \cZ$.
	Then there exists a well-defined \textbf{branched integral}, denoted as $\int_{\cS} \ww$.
\end{theorem}

In our current situation, we may note that the GW-polyfolds admit $\ssc$-smooth partitions of unity,  see the discussion in \cite{HWZbook}*{\S5.5}.
Furthermore, we may note that the automorphism groups are all effective; this may be seen by considering the explicit action of the automorphism group, for any automorphism we may find a stable map which breaks the symmetry.
Therefore, we may compute the the branched integral as described in \cite{schmaltz2019steenrod}*{Rem.~3.6} as follows.

Cover the compact topological space $\cS$ with finitely many open sets of the form $\cup_{i\in I} M_i / \Aut$.
As in the remark, we can define a $\ssc$-smooth partition of unity on $\cZ$ so that its restriction to $\cS$ is also a partition of unity with respect to the open cover $\cup_{i\in I} M_i / \Aut$. We can then write:
\[
	\int_{\cS} \ww = \sum_n \int_{\cS} \beta_n \cdot \ww = \sum_n \frac{1}{\sharp \Aut(\Sigma,j,M,D,u) } \sum_{i\in I} w_i \int_{(M_i,o_i)} \beta_n \cdot \ww
\]
where the first sum is over the open cover indexed by $n$ and $\beta_n$ is the associated partition of unity.

The polyfold GW-invariant is defined as the homomorphism
\[
	\GW_{A,g,k} : H_*(M;\Q)^{\otimes k} \otimes H_*(\dmlog_{g,k};\Q ) \to \Q
\]
defined via the branched integration of \cite{HWZint}:
\[
	\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k;\beta) := \int_{\cS_{A,g,k}(p)} ev_1^* \PD (\alpha_1)\wedge \cdots \wedge ev_k^* \PD (\alpha_k) \wedge\pi^* \PD (\beta).
\]
It was justified in \cite{schmaltz2019steenrod}*{Rem.~3.15} that this homomorphism is rationally valued, using equivalence of the branched integral with the intersection number.


\begin{theorem}[Change of variables, {\cite{schmaltz2019naturality}*{Thm.~A.47}}]\label{thm:change-of-variables}
	Let $\cS_i\subset \cZ_i$ be $n$-dimensional compact oriented weighted branched suborbifolds with weight functions $\theta_i:\cS_i \to \Q^+$ for $i=1,2$.
	Let $g:\cZ_1 \to \cZ_2$ be a $\ssc^1$-map between polyfolds, which has a well-defined restriction $g|_{\cS_1}	: \cS_1 \to \cS_2$ between the branched suborbifolds. In addition, assume the following:
	\begin{itemize}
		\item $g|_{\cS_1}: \cS_1 \to \cS_2$ is a homeomorphism between the underlying topological spaces and is \textit{weight preserving}, i.e., $\theta_2\circ g=\theta_1$,
		\item A lift to the local branching structures $\hat{g}: \bigcup_{i \in I} M_i \to \bigcup_{j \in I'} M_j'$ is a local homeomorphism, and moreover maps branches to branches and is orientation and weight preserving on each branch.
	\end{itemize}
	Then given a $\ssc$-smooth differential form $\ww \in \Omega^n_\infty (Z_2)$,
	\[
		\int_{\cS_2} \ww = \int_{\cS_1} g^* \ww.
	\]
\end{theorem}

\subsection{The Steenrod problem and polyfold Gromov--Witten invariants as intersection numbers}\label{subsec:intersection-numbers}

We now describe the definition of the GW-invariants as intersection numbers, as developed in \cite{schmaltz2019steenrod}.

The polyfold GW-invariants take as input homological data coming from a closed orientable orbifold of the form $M^k \times \dmlog_{g,k}$.
In order to define the polyfold GW-invariants as intersection numbers, we need to understand how to take this homological data and interpret it in a suitable way.

This is done via the Steenrod problem. As proved by Thom in \cite{thom1954quelques}*{Thm.~II.1}, there exists a basis of $H_*(M;\Q)$ which consists of the fundamental classes of closed embedded submanifolds $\cX\subset M$.
We call such a submanifold a \textbf{representing submanifold}.
Since $\dmlog_{g,k}$ is an orbifold for $g\neq 0$, we need the following theorem.

\begin{theorem}[The Steenrod problem for orbifolds, {\cite{schmaltz2019steenrod}*{Thm.~1.2}}]
	Let $\cO$ be a closed orientable orbifold.
	There exists a basis $\{[\cX_i]\}$ of $H_*(\cO;\Q)$ which consists of the fundamental classes of ``closed embedded full suborbifolds $\cX_i\subset \cO$ whose normal bundles have fiberwise trivial isotropy action'' (see \cite{schmaltz2019steenrod}*{Defs.~2.12,~2.14}).
	We will call such a suborbifold a \textbf{representing suborbifold}.
\end{theorem}

Consider the evaluation and projection maps defined on a GW-polyfold:
\[
	\cZ_{A,g,k} \xrightarrow{ev_1\times\cdots\times ev_k \times \pi} M^k \times \dmlog_{g,k}.
\]
Let $\cS_{A,g,k}(p)$ be a perturbed GW-moduli space, and let $\cX_1\times \cdots \times \cX_k \times \cB \subset M^k\times \dmlog_{g,k}$ be a representing suborbifold. Consider the diagram:
\[
	\begin{tikzcd}[column sep= huge, row sep=tiny]
		\cS_{A,g,k}(p) \arrow[r,"ev_1\times \cdots \times ev_k \times \pi"] & M^k \times \dmlog_{g,k} \arrow[d,phantom,"\cup\quad"] \\
		& \cX_1\times \cdots \times \cX_k \times \cB.
	\end{tikzcd}
\]
Then there exists a well-defined notion of \textbf{transversal intersection} \cite{schmaltz2019steenrod}*{Def.~3.8}
\[
	(ev_1\times \cdots \times ev_k \times \pi)|_{\cS_{A,g,k}(p)} \pitchfork (\cX_1\times \cdots \times \cX_k \times \cB)
\]
and moreover a well-defined \textbf{intersection number}  \cite{schmaltz2019steenrod}*{Def.~3.13}
\[
	\left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
\]
When $\dim \cS_{A,g,k}(p) + \dim \left(\cX_1 \times\cdots\times \cX_k \times \cB\right) = \dim (M^k \times \dmlog_{g,k})$ the intersection number is given by the signed weighted count of a finite number of points of intersection.

We may then define the polyfold GW-invariants as the intersection number
\[
	\GW_{A,g,k} ([\cX_1],\ldots,[\cX_k];[\cB]) := \left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
\]

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{geometric.eps}
	\caption{A Gromov--Witten invariant as an intersection number}
\end{figure}

By \cite{schmaltz2019steenrod}*{Thm.~1.6, Cor.~1.7} the branched integral and the intersection number are related by the following equation:
\begin{align*}
	 & \int_{\cS_{A,g,k}(p)} ev_1^* \PD [\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge\pi^* \PD [\cB]                                      \\
	 & \qquad = \left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
\end{align*}

Transversality of a perturbed solution space of a polyfold with representing submanifolds/suborbifolds may \textit{always} be achieved through either of the following:
\begin{itemize}
	\item Through the perturbation of the representing suborbifold; due to the properties of the normal bundle representing suborbifolds may always be perturbed (see \cite{schmaltz2019steenrod}*{Prop.~3.9}).
	\item Assuming the map defined on the ambient polyfold is a submersion, we may obtain transversality through choice of a suitable regular perturbation (see \cite{schmaltz2019steenrod}*{Prop.~3.10}).
\end{itemize}

We showed in Proposition~\ref{prop:evaluation-smooth-submersion} that the evaluation map is a smooth submersion, hence we may always choose a perturbation such that $ev_i \pitchfork \cX_i$.
This is important in the contexts of the splitting and genus reduction axioms where we consider a representing submanifold given by the diagonal $\Delta \subset M\times M$; in these cases, it is important that we do not perturb this representing submanifold or else we will lose the geometric meaning of the intersection.

However, the projection map
\[
	\pi: \cZ_{A,g,k} \to \dmlog_{g,k}
\]
is not a submersion (unless $(g,k)=(0,3)$) as we explain in Problem~\ref{prob:projection-not-submersion}.
Hence in this case we must perturb the representing suborbifold $\cB \subset \dmlog_{g,k}$ in order to obtain transversality.


\subsection{Pulling back abstract perturbations and maps between perturbed moduli spaces}\label{subsec:pulling-back-abstract-perturbations}

The natural approach for obtaining a well-defined map between perturbed GW-moduli spaces is to pullback an abstract perturbation. The technical details for this approach are contained in \cite{schmaltz2019naturality}.

The general setup for this problem may be given as follows.
Consider a $\ssc$-smooth map between polyfolds, $f: \cY \to \cZ$, and consider a pullback diagram of strong polyfold bundles:
\[\begin{tikzcd}
		f^* \cW \arrow[d, "f^*\delbarj\quad"'] \arrow[r, "\text{proj}_2"'] & \cW \arrow[d, "\quad \delbarj"] &  \\
		\cY \arrow[r, "f"'] \arrow[u, bend left] & \cZ. \arrow[u, bend right] &
	\end{tikzcd}\]
It is possible to obtain transversality for both strong bundles through the choice of an appropriately generic perturbation.
The main technical point therefore is ensuring that we can control the compactness of the pullback perturbation.
This is achieved by a mild topological hypothesis on the map $f$.

We say that $f$ satisfies the \textbf{topological pullback condition} if for all $[y] \in \cS(\delbarj)\subset \cZ$ and for any open neighborhood $\cV \subset \cY$ of the fiber $f^{-1} ([y])$ there exists an open neighborhood $\cU_{[y]}\subset \cZ$ of $[y]$ such that $f^{-1} (\cU_{[y]}) \subset \cV$.
(Note that if $f^{-1} ([y])=\emptyset$, this implies that there exists an open neighborhood $\cU_{[y]}$ of $[y]$ such that $f^{-1} (\cU_{[y]})=\emptyset$.)

\begin{theorem}[{\cite{schmaltz2019naturality}*{Thm.~1.7}}]\label{thm:pullback-regular-perturbation}
	If $f$ satisfies the topological pullback condition then there exists a regular perturbation $p$ which pulls back to a regular perturbation $f^*p$.

	It follows that we can consider a well-defined restriction between perturbed moduli spaces,
	\[f|_{\cS(f^*p)} : \cS(f^*p) \to \cS (p).\]
	This map is weight preserving.
\end{theorem}

By checking that the strong bundles are related by pullback, and by checking the topological pullback condition holds, we may obtain well-defined maps between perturbed GW-moduli spaces.
In particular, by pulling back via the permutation map between GW-polyfolds, $\sigma: \cZ_{A,g,k} \to \cZ_{A,g,k}$, we obtain:
\begin{itemize}
	\item permutation maps,
	      \[
		      \sigma : \cS_{A,g,k}(\sigma^* p ) \to \cS_{A,g,k}(p).
	      \]
\end{itemize}

By pulling back via the inclusion maps from \S\ref{subsec:inclusion-marked-point-identifying-maps}, we obtain:
\begin{itemize}
	\item inclusion maps for the split perturbed GW-moduli spaces,
	      \[
		      i: \cS_{A_0+A_1,S}(i^*p) \hookrightarrow (\cS_{A_0,g_0,k_0+1} \times \cS_{A_1,g_1,k_1+1})(p),
	      \]
	\item inclusion maps for the genus perturbed GW-moduli spaces,
	      \[
		      i:\cS^\text{g}_{A,g-1,k+2}(i^*p) \hookrightarrow \cZ_{A,g-1,k+2} (p).
	      \]
\end{itemize}

Observe that since the unperturbed GW-moduli space $\CM_{A,g,k}$ is compact, there are only finitely many decompositions $A_0+A_1$ for which the associated split GW-polyfolds can contain a nonempty unperturbed GW-moduli space.
We may then pullback via
\[\sqcup \phi_S: \displaystyle{\bigsqcup_{A_0+A_1 = A}} \cZ_{A_0+A_1,S} \to \cZ_{A,g,k}\]
where the (finite) disjoint union is only considered for split GW-polyfolds which contain a nonempty unperturbed GW-moduli space.
We thus obtain
\begin{itemize}
	\item marked point identifying maps for a disjoint union of split perturbed GW-moduli spaces:
	      \[
		      \sqcup \phi_S: \displaystyle{\bigsqcup_{A_0+A_1 = A}} \cS_{A_0+A_1,S} (\phi_S^*p )	\to \cS_{A,g,k}(p).
	      \]
\end{itemize}

Finally, we also obtain:
\begin{itemize}
	\item marked point identifying maps for the genus perturbed GW-moduli spaces,
	      \[
		      \psi: \cS^\text{g}_{A,g-1,k+2}(\psi^* p)  \to \cS_{A,g,k} (p).
	      \]
\end{itemize}

\begin{theorem}
	We can give a perturbed Gromov--Witten moduli space the structure of a stratified space, whose codimension $2m$ strata are given by the $m$-noded stable curves.
\end{theorem}
\begin{proof}
	In the literature, we may keep track of possible degenerations of an unperturbed GW-moduli space $\CM_{A,g,k}(J)$ by means of a tree $T$ with labelings $(A_\alpha, g_\alpha, k_\alpha)$ on each vertex $\alpha$ such that
	\[A = \sum_{\alpha} A_\alpha, \quad g= \sum_{\alpha} g_\alpha, \quad k = \sum_{\alpha} k_\alpha.\]
	Since $\CM_{A,g,k}(J)$ is compact, the set of such trees which model a possible degeneration is finite.
	We can define a GW-polyfold modeled on a tree as in \S\ref{subsec:other-gw-polyfolds}; the theorem is then obtained by pulling back an abstract perturbation via the map
	\[
		\displaystyle{\bigsqcup_T} \cZ_T \to \cZ_{A,g,k}.
	\]
\end{proof}


\section{Problems arise}\label{sec:problems-arise}

At this point, there are substantial obstructions in polyfold GW-theory which we must understand before we have any hope to prove the GW-axioms.

\subsection{Problems}

\begin{problem}\label{prob:ftk-continuous-not-c0}
In general the map $ft_k: \dmexp_{g,k} \to \dmexp_{g,k-1}$ is continuous but not differentiable.
\end{problem}

The construction of the GW-polyfolds requires the modification of the gluing profile used to define the DM-orbifolds, giving rise to exponential DM-orbifolds.
As a consequence of this nonstandard smooth structure the map $ft_k: \dmexp_{g,k} \to \dmexp_{g,k-1}$ is in general continuous but not differentiable.
Differentiability fails at points which are nodal Riemann surfaces which contain components
$S^2$ with precisely $3$ special points, two of which are nodal, and one of which is the
$k$th-marked point.
In \S\ref{subsec:differentiability-failure-ftk} we show this failure via explicit calculation.

\begin{problem}\label{prob:no-natural-forgetting-map}
In general there does not exist a natural map which forgets the $k$th-marked point on the GW-polyfolds.
\end{problem}

The GW-stability condition \eqref{eq:gw-stability-condition} imposed on stable curves in the polyfold $\cZ_{A,g,k}$ may not hold in $\cZ_{A,g,k-1}$ once the $k$th-marked point is removed.
Recall once again the GW-stability condition:
\begin{itemize}
	\item For each connected component $C\subset \Sigma$ we require at least one of the following:
	      \begin{equation*}
		      2g_C+\sharp (M\cup\abs{D})_C \geq 3 \quad \text{or} \quad \int_C u^* \ww > 0.
	      \end{equation*}
\end{itemize}
A stable curve in $\cZ_{A,g,k}$ may contain a ``destabilizing ghost component'', i.e., a component $C_k\simeq S^2$ with precisely $3$ special points, one of which is the $k$th-marked point, and such that $\int_{C_k} u^*\ww =0, \ u|_{C_k} \neq \text{const}$.
In this case, after removal of the $k$th-marked point the GW-stability condition is no longer satisfied, and we cannot consider the resulting data as a stable curve in $\cZ_{A,g,k-1}$.
Hence even on the level of the underlying sets of the GW-polyfolds there does not exist a natural $k$th-marked point forgetting map.
In \S\ref{subsec:classifying-destabilizing-ghost-components} we classify possible destabilizing ghost components, and also consider the fringe situations where it is possible to obtain a (trivial) well-defined $k$th-marked point forgetting map.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{ftknotdefined.eps}
	\caption{There does not exist a natural map which forgets the $k$th-marked point.}
\end{figure}

\begin{problem}\label{prob:restriction-is-not-continuous}
In general the well-defined restriction $ft_k:\cZ_{A,g,k}^\text{const} \to \cZ_{A,g,k-1}$ is not continuous.
\end{problem}

We can attempt to restrict to a subset $\cZ^\text{const}_{A,g,k}\subset \cZ_{A,g,k}$ with a stronger stability condition:
\begin{itemize}
	\item For each connected component $C\subset \Sigma$ we require at least one of the following:
	      \[
		      2 g_C+\sharp (M\cup\abs{D})_C \geq 3 \quad \text{or} \quad \int_C u^* \ww > 0.
	      \]
	      Additionally, if the $k$th-marked point $z_k$ lies on a component $C_k$ with
	      \[
		      2 g_{C_k} +\sharp (M\cup \abs{D})_{C_k} = 3 \quad \text{and}\quad \int_{C_k} u^*\ww =0
	      \]
	      then we require that $u|_{C_k}$ is constant, hence necessarily $u|_{C_k}\equiv u(z_k)$.
\end{itemize}

By the energy identity, any map $u: C_k \to M$ with $\delbarj u = 0$ and $\int_{C_k} u^* \ww =0$ must be constant.  Hence it follows that the above subset is large enough to contain the entire unperturbed Gromov--Witten solution space, i.e., $\CM_{A,g,k}(J) \subset \cZ^\text{const}_{A,g,k}$.

With this stability condition the $k$th-marked point forgetting map is well-defined on $\cZ^\text{const}_{A,g,k}$, considered as a set.
Consider the subspace topology on $\cZ^\text{const}_{A,g,k}\subset \cZ_{A,g,k}$, and the usual polyfold topology on $\cZ_{A,g,k-1}$.
In general, with respect to these topologies the $k$th-marked point forgetting map is not continuous.
In \S\ref{subsec:failure-of-continuity-ftk} we demonstrate lack of continuity by exhibiting a sequence which converges in the subspace topology on $\cZ^\text{const}_{A,g,k}$ but for which the image of the sequence does not converge.

\begin{problem}\label{prob:projection-not-submersion}
While the projection $\pi : \cZ_{A,g,k} \to \dmlog_{g,k}$ is $\ssc$-smooth, in general it is not a submersion.
\end{problem}

We observed in Proposition~\ref{prop:projection-map-smooth} that the projection $\pi$ locally factors through the (smooth) identity map $\id :\dmexp_{g,k} \to \dmlog_{g,k}$.
However, in general this identity map is not a submersion.
The only exception is when $(g,k)=(0,3)$ as in this case $\dmspace_{0,3} = \{\pt\}$.
In the proof of Proposition~\ref{prop:identity-exp-to-log} we saw that the gluing parameters transform according to the rectangular coordinate expression
\[
	F:\R^2 \to \R^2, \qquad (x,y) \mapsto \frac{e^{-2\pi \left(e^{1/\sqrt{x^2+y^2}}-e\right)}}{\sqrt{x^2+y^2}} (x,y).
\]
It is elementary to compute partial derivatives of $F$ and obtain:
\begin{align*}
	\frac{\partial F_1}{\partial x} (x,0) & = \frac{-2\pi e^{\left(-2\pi (e^{1/\abs{x}}-e)  + 1/\abs{x} \right)} }{x^2}, \\
	\frac{\partial F_1}{\partial y} (0,y) & = \frac{\partial F_2}{\partial x} (x,0) = 0,                                 \\
	\frac{\partial F_2}{\partial y} (0,y) & = \frac{-2\pi e^{\left(-2\pi (e^{1/\abs{y}}-e)  + 1/\abs{y} \right)} }{y^2}.
\end{align*}
Taking limits, one may observe that the Jacobian of this function at $(0,0)$ is therefore
\[
	\bm{J}(0,0) =
	\begin{bmatrix}
		0 & 0 \\
		0 & 0
	\end{bmatrix}.
\]

\subsection{Differentiability of the \texorpdfstring{$k$th-marked}{kth-marked} point forgetting map on the exponential Deligne--Mumford orbifolds}\label{subsec:differentiability-failure-ftk}

We begin by remarking that the topology on the DM-space is independent of the choice of gluing profile, hence it automatically follows from Proposition~\ref{prop:ftk-log-dmspace} that $ft_k: \dmexp_{g,k}\to \dmexp_{g,k-1}$ is, at the very least, continuous.

However in general, $ft_k :\dmexp_{g,k} \to \dmexp_{g,k-1}$ is not $C^1$.
Differentiability fails at points in $\dmexp_{g,k}$ which contain precisely $3$ special points, one of which is the $k$th-marked point while the other two are nodal points.
In particular, differentiability fails in case 2a from \S\ref{subsubsec:local-expression-forgetting-map-on-dm-orbifold}, and as noted in Remark~\ref{rmk:special-cases-forgetting} such points will occur when $(g=0,k\geq 5)$, $(g=1,k=1)$, or $(g\geq 2, k\geq 1)$.
We previously derived coordinate expressions for $ft_k$ for an arbitrary gluing profile; in case 2a such an expression has the following simplified form:
\[
	\hat{ft}_k: (a,b,v) \mapsto (a\ast_{\exp} b, v).
\]
Hence consider the function
\[
	\C \times \C \to \C, \qquad (a,b) \mapsto a\ast_{\exp} b
\]
where once again
\[
	a\ast_{\exp} b :=
	\begin{cases}
		\varphi_\text{exp}^{-1}(\varphi_\text{exp}(r_a)+\varphi_\text{exp}(r_b)) e^{-2\pi i (\theta_a+\theta_b)} & \text{when } a\neq 0 \text{ and } b\neq 0, \\
		0                                                                                                        & \text{when } a=0 \text{ or } b=0.
	\end{cases}
\]
The inverse of $\varphi_\text{exp}(r)=e^{1/r}-e$ is given by $\varphi^{-1}_\text{exp}(R)= \tfrac{1}{\log(R+e)}$, and so if $a\neq 0$ and $b\neq 0$ we have
\[
	a\ast_{\exp} b = \tfrac{1}{\log \left(e^{1/r_a}+e^{1/r_b}-e\right)}e^{-2\pi i(\theta_a+\theta_b)}.
\]
This expression is not $C^1$.
To see this, we rewrite the equation in rectangular coordinates as a function $F:\R^4\to \R^2$,
\begin{multline*}
	F(x_1,x_2,x_3,y_4):= \\
	\begin{cases}
		(0,0)                                                                                                            & \text{if } x_1=x_2=0 \text{ or } x_3=x_4=0, \\
		\frac{1}{\log \left(e^{1/r_a}+e^{1/r_b}-e\right)}(\cos (\vartheta_a+\vartheta_b),\sin (\vartheta_a+\vartheta_b)) & \text{else},
	\end{cases}
\end{multline*}
where $r_a^2 := x_1^2+x_2^2, r_b^2:=x_3^2+x_4^2$ and $\vartheta_a:=-2\pi\tan^{-1}(\tfrac{x_2}{x_1}), \vartheta_b:=-2\pi \tan^{-1}(\tfrac{x_4}{x_3})$.
We now compute the Jacobian matrix $\bm{J}$ of partial derivatives of $F$ at $(0,0,0,0)\in \R^4$.  From the above expression for $F$ we see that $\tfrac{\partial F_i}{\partial x_j} = 0$ for all $i=1,2$ and $j=1,2,3,4$, hence $\bm{J}_{i,j} = 0$.

If $F$ were differentiable, the Jacobian matrix would give the total derivative, and we could compute the directional derivative at $(0,0,0,0)$ via the equation
\[\nabla_v F =\bm{J}\cdot v = (0,0).\]
We may directly compute the directional derivative as follows.
Let $v\in \R^4$ be a unit vector, we may write
\[v = r_1 \cos \theta_1 \tfrac{\partial}{\partial x_1} + r_1 \sin \theta_1 \tfrac{\partial}{\partial x_2} + r_2 \cos \theta_2 \tfrac{\partial}{\partial x_3} + r_2 \cos \theta_2 \tfrac{\partial}{\partial x_4}\]
where $r_1^2 +r_2^2 = 1$.
Then one may calculate:
\begin{align*}
	\nabla_v F
	 & =	\lim_{h\to 0} \frac{F(0+hv)}{h}                                                                                               \\
	 & =	\lim_{h\to 0} \frac{1}{h \log \left(e^{1/(r_1 h)}+e^{1/(r_2 h)}-e\right)} (\cos (\theta_1+\theta_2), \sin(\theta_1+\theta_2)) \\
	 & = \min \{r_1,r_2\} (\cos (\theta_1+\theta_2), \sin(\theta_1+\theta_2)).
\end{align*}
This contradicts the assumption that $F$ was differentiable.

\subsection{Classifying destabilizing ghost components and fringe definitions of the \texorpdfstring{$k$th-marked}{kth-marked} point forgetting map on the Gromov--Witten polyfolds}\label{subsec:classifying-destabilizing-ghost-components}

Consider a stable curve $[\Sigma,j,M,D,u]$ with $k$ marked points, and let $(\Sigma,j,M,D,u)$ be a stable map representative.  We say that this stable curve/stable map contains a \textbf{destabilizing ghost component} if the connected component $C_k\subset \Sigma$ with $z_k \in C_k$ satisfies
\[
	2 g_{C_k} +\sharp (M\cup \abs{D})_{C_k} = 3 \quad \text{and}\quad \int_{C_k} u^*\ww =0.
\]
We may classify destabilizing ghost components as follows:
\begin{itemize}
	\item Type $(0,1)$, i.e., $(g_{C_k}, M_{C_k}) = (0,1)$. There are two nodal points on $C_k$.
	\item Type $(0,2)$, i.e., $(g_{C_k}, M_{C_k}) = (0,2)$. There is one nodal point on $C_k$.
	\item Type $(0,3)$, i.e., $(g_{C_k}, M_{C_k}) = (0,3)$. Then $C_k$ contains no nodal points; it follows that $C_k$ is the only component and hence $[A]=0$. This situation can only arise when $(A,g,k)=(0,0,3)$.
	\item Type $(1,1)$, i.e., $(g_{C_k}, M_{C_k}) = (1,1)$. Then $C_k$ contains no nodal points; it follows that $C_k$ is the only component and hence $[A]=0$. This situation can only arise when $(A,g,k)=(0,1,1)$.
\end{itemize}

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{dgc.eps}
	\caption{Destabilizing ghost components}
\end{figure}

We now consider fringe definitions of the $k$th-marked point forgetting map on the GW-polyfolds.
Notice that by definition, the following sets of stable curves must be empty:
\[\cZ_{0,0,2} = \cZ_{0,0,1} = \cZ_{0,1,0} = \cZ_{0,0,0}= \emptyset.\]
This is because the GW-stability condition \eqref{eq:gw-stability-condition} cannot be satisfied.
It follows that there exist trivially well-defined $\ssc$-smooth maps $ft_3 : \cZ_{0,0,3} \to \cZ_{0,0,2}=\emptyset$ and $ft_1: \cZ_{0,1,1} \to \cZ_{0,1,0}=\emptyset$, in addition to the trivially defined $k$th-marked point forgetting map with source any of the above GW-polyfolds.

Since destabilizing ghost components of types $(0,3)$ and $(1,1)$ may only arise in the fringe situations $(A,g,k)=(0,0,3)$ and $(A,g,k)=(0,1,1)$ respectively, we already have a well-defined $k$th-marked point forgetting map in these cases.

On the other hand, just as in Remark~\ref{rmk:special-cases-forgetting}, a destabilizing ghost component of type $(0,1)$ will always arise in the following situations:
\[
	(A,g=0, k\geq 5),\quad (A,g=1, k\geq 2), \quad (A,g\geq 2, k\geq 1)
\]
while a destabilizing ghost component of type $(0,2)$ will always arise in the following situations:
\[
	(A,g=0, k\geq 4), \qquad (A,g\geq 1, k\geq 2).
\]


\subsection{Failure of continuity for the \texorpdfstring{$k$th-marked}{kth-marked} point forgetting map restricted to the subset of stable curves with constant destabilizing ghost components}\label{subsec:failure-of-continuity-ftk}

Consider the subset $\cZ^\text{const}_{A,g,k}\subset \cZ_{A,g,k}$ of stable curves with constant destabilizing ghost components.
We may define a $k$th-marked point forgetting map
\[
	ft_k: \cZ^\text{const}_{A,g,k} \to \cZ_{A,g,k-1}.
\]
If $\cZ^\text{const}_{A,g,k}$ contains a destabilizing ghost component of type $(0,1)$ or of type $(0,2)$ this map is not continuous.

Failure of continuity occurs at stable curves in $\cZ^\text{const}_{A,g,k}$ which contain a component $S^2$ with precisely $3$ special points, one of which is the $k$th-marked point, and such that $\int_{S^2} u^*\ww =0$.
We demonstrate lack of continuity by exhibiting a sequence which converges to a stable curve $[\Sigma,j,M,D,u]$ but for which the image of the sequence does not converge.
For simplicity, we will assume that $[\Sigma,j,M,D,u]$ satisfies the following:
\begin{itemize}
	\item $u$ is constant on a region surrounding the component $S^2$ (this simplifies the local forms for $ft_k$ since our reference curves are now constant),
	\item the two other special points on $S^2$ are both nodal points.
\end{itemize}

Consider a $\ssc$-Banach space which consists of a gluing parameter $a\in\hb\subset\C$ and of maps
\[\eta^+ : \R^+\times S^1\to \R^{2n}, \qquad	\eta^0 :\R \times S^1 \to \R^{2n}\]
which converge to asymptotic constants
\[\lim_{s\to\infty} \eta^+ = \lim_{s\to-\infty} \eta^0 = c \quad \text{and}\quad \lim_{s\to\infty} \eta^0 = c'.\]
On the level $m$ we give this space the following norm:
\begin{equation}
	\label{eq:norm-1}
	\begin{split}
		\abs{(a,\eta^+,\eta^0)}_m^2 = & \abs{a}^2 + \abs{c}^2 + \abs{c'}^2 + \sum_{|\alpha|\leq m+3} \int_{\R^+ \times S^1} \abs{D^\alpha (\eta^+-c)}^2 e^{2\delta_m\abs{s}}ds\ dt \\
		                              & \qquad + \sum_{|\alpha|\leq m+3} \int_{\R^- \times S^1} \abs{D^\alpha (\eta^0-c)}^2 e^{2\delta_m\abs{s}}ds\ dt                             \\
		                              & \qquad + \sum_{|\alpha|\leq m+3} \int_{\R^+ \times S^1} \abs{D^\alpha (\eta^0-c')}^2 e^{2\delta_m\abs{s}}ds\ dt.
	\end{split}
\end{equation}
We now construct the sequence.  Choose a smooth cut-off function $\beta : \R \to [0,1]$ such that:
\begin{itemize}
	\item $\beta (s)=1$ for all $-\tfrac{1}{2} \leq s \leq \tfrac{1}{2}$,
	\item $\beta (s)=0$ for all $-1 \leq s \leq 1$.
\end{itemize}
Choose a vector $v\in \R^{2n}$.  Then define a vector field $\gamma :\R\times S^1 \to \R^n$ by
\[
	\gamma (s,t) := \beta(s)\cdot v.
\]
We may renormalize $v$ by a constant so that
\[
	\sum_{\abs{\alpha}\leq 3}\int_{\R \times S^1}\abs{D^{\alpha} \gamma (s, t)}^2e^{2\delta_0 \abs{s}}\ ds\ dt=1.
\]
Then $\xi_n := \tfrac{1}{\sqrt{n}} \gamma$ is a vector field such that
\[\sum_{\abs{\alpha}\leq 3}\int_{\R \times S^1}\abs{D^{\alpha} \xi_n (s, t)}^2e^{2\delta_0 \abs{s}}\ ds\ dt=\tfrac{1}{n}.\]
Now choose $a_n\in\hb$, $a_n \neq 0$ small enough such that $e^{2\delta_0 R_{a_n}} > \tfrac{2n}{\abs{v}^2}$.
It follows that
\[
	\abs{(a_n,0,\xi_n)}_0^2 = \abs{a_n}^2 + \tfrac{1}{n} \to 0 \quad \text{as } n\to \infty.
\]

On the other hand, we may consider a second $\ssc$-Banach space consisting of maps
\[\eta' : \R^+\times S^1 \to \R^{2n}\]
with asymptotic constant given by $\lim_{s\to \infty} \eta' = c''$ and with $m$ level norm
\begin{equation}
	\label{eq:norm-2}
	\abs{\eta'}_m^2 = \abs{c''}^2 + \sum_{|\alpha|\leq m+3} \int_{\R^+ \times S^1} \abs{D^\alpha (\eta'-c'')}^2 e^{2\delta_m\abs{s}}ds\ dt.
\end{equation}
Consider the sequence $\oplus_{a_n}(0,\xi_n)$, using the gluing procedure described in \cite{HWZGW}*{\S2.4}.
In this norm:
\begin{align*}
	\abs{\oplus_{a_n}(0,\xi_n)}^2_0
	 & =\sum_{\abs{\alpha}\leq 3}\int_{\R^+ \times S^1}\abs{D^{\alpha} \xi_n(s-R_{a_n})  }^2e^{2\delta_0 \abs{s}}ds\ dt \\
	 & > \int_{[R_{a_n}, R_{a_n}+1/2]\times S^1} \left|\tfrac{1}{\sqrt{n}} \cdot v\right|^2 e^{2\delta_0 \abs{s}}ds\ dt \\
	 & > \frac{1}{2}\cdot \frac{1}{n}\cdot \abs{v}^2 \cdot e^{2\delta_0 R_{a_n}} >1.
\end{align*}
for all $n$.

The topology of a neighborhood of $[\Sigma,j,M,D,u]$ is determined by the $0$-level norm \eqref{eq:norm-1}, moreover, because the gluing parameters $a_n$ are not equal to $0$ the sequence $(a_n,0,\xi_n)$ can be used to define a sequence $x_n \in \cZ^\text{const}_{A,g,k}$ which converges to $[\Sigma,j,M,D,u]$.
On the other hand, the topology of a neighborhood of $ft_k ([\Sigma,j,M,D,u])$ is determined by the $0$-level norm \eqref{eq:norm-2}; the image $\oplus_{a_n} (0,\xi_n)$ correspond to a sequence $ft_k(x_n) \in \cZ_{A,g,k-1}$ which does not converge.


\section{The universal curve polyfold}\label{sec:universal-curve-polyfold}

We show how to construct a polyfold $\cZ^\text{uc}_{A,g,k}$ of \textit{universal curves} over the GW-polyfold $\cZ_{A,g,k-1}$.
The underlying set of this polyfold may be identified with $\cZ^\text{const}_{A,g,k}$, and hence we can also consider this as a GW-polyfold of stable curves with constant destabilizing ghost components.
However, we give it a \textit{new} polyfold structure, with a \textit{new} $\ssc$-smooth structure, and a \textit{new} topology.

This new polyfold $\cZ^\text{uc}_{A,g,k}$ uses a modified gluing construction, designed to more accurately anticipate the geometry of the desired solution space.
When the destabilizing ghost component is of type $(0,1)$, it interpolates the gluing parameters surrounding a ghost component directly.
When the destabilizing ghost component is of type $(0,2)$, it forgets the gluing parameter, and relabels the remaining nodal point as a marked point.

This new polyfold carries the full abstract perturbation theory developed in \cite{HWZ3}.
We thus obtain well-defined GW-invariants for this new polyfold, see Theorem~\ref{thm:gw-invariants-new-polyfold}.
That these invariants coincide with the original polyfold GW-invariants constructed in \cite{HWZGW} is proved in Theorem~\ref{thm:equivalence-polyfold-invariants}.

Crucially, on the universal curve polyfold we may consider a well-defined $k$th-marked point forgetting map
\[
	ft_k :\cZ^\text{uc}_{A,g,k}\to \cZ_{A,g,k-1}.
\]
and indeed, the preimage of a point $[\Sigma,j,M,D,u] \in \cZ_{A,g,k-1}$ via $ft_k$ consists of the Riemann surface $\Sigma$ with nodes identified, i.e.,
\[
	ft_k^{-1} ([\Sigma,j,M,D,u]) \simeq \Sigma / \sim, \quad \text{where $x_a\sim y_a$ for nodal pairs $\{x_a,y_a\}\in D$}.
\]
This map is $\ssc^0$, and fails to be $\ssc^1$ at stable curves which contain a destabilizing ghost component of type $(0,1)$.
As a consequence, pulling back perturbations is not quite as automatic as in \S\ref{subsec:pulling-back-abstract-perturbations}, and will require a slightly more hands-on approach.

Throughout this section, we will assume that $(A,g,k) \neq (0,0,2)$, $(0,0,1)$,  $(0,0,0)$,  $(0,1,0)$ and $(A,g,k) \neq (0,0,3)$,  $(0,1,1)$ as in these cases we may consider the trivially defined $k$th-marked point forgetting map $ft_k :\cZ_{A,g,k} \to \emptyset$ (see the discussion in \S\ref{subsec:classifying-destabilizing-ghost-components}).



\subsection{Constructing the universal curve polyfold}

We begin by describing the underlying set of the universal curve polyfold.

\begin{definition}
	The \textbf{universal curve polyfold} $\cZ^\text{uc}_{A,g,k}$ is defined as the set of stable curves with constant destabilizing ghost components
	\[
		\cZ^\text{uc}_{A,g,k}:= \{ (\Sigma,j,M,D,u)  \mid  \cdots, \text{ uc-stability condition} \}/ \sim
	\]
	where $(\Sigma,j,M,D)$ is a connected noded Riemann surface (where we do not require the DM-stability condition), and which satisfies the same conditions as Definition~\ref{def:gw-polyfold}---except here we replace the GW-stability condition \eqref{eq:gw-stability-condition} with the following.
	\begin{itemize}
		\item For each connected component $C\subset \Sigma$ the following \textbf{uc-stability condition} holds.  We require at least one of the following:
		      \[
			      2 g_C+\sharp (M\cup\abs{D})_C \geq 3 \quad \text{or} \quad \int_C u^* \ww > 0.
		      \]
		      Additionally, if the $k$th-marked point $z_k$ lies on a component $C_k$ which is unstable after forgetting $z_k$ then we require that $u|_{C_k}$ is constant (hence necessarily $u|_{C_k}\equiv u(z_k)$), i.e.,
		      \begin{equation}
			      \label{eq:new-stability}
			      2 g_{C_k} +\sharp (M\cup \abs{D})_{C_k} = 3 \quad \text{and}\quad \int_{C_k} u^*\ww =0 \implies u|_{C_k} \equiv \text{const.}
		      \end{equation}
		\item We require that $u$ be of class $H^{3,\delta_0}$ at all marked points $\{z_1,\ldots z_{k-1}\}$.  We require that $u$ be of class $H^3_\text{loc}$ at the marked point $z_k$ (see Definition~\ref{def:class-3delta}).
	\end{itemize}
	We call a tuple $(\Sigma,j,M,D,u)$ which satisfies the above a \textbf{stable map with constant destabilizing ghost component $C_k$}, and call an equivalence class satisfying the above a \textbf{stable curve with constant destabilizing ghost component $C_k$}.
\end{definition}

\subsubsection{New gluing constructions at destabilizing ghost components}\label{new-gluing-construction}

Consider a stable map $(\Sigma,j,M,D,u)$ which satisfies the uc-stability condition \eqref{eq:new-stability}, and suppose the marked point $z_k$ lies on a destabilizing ghost component $C_k$.

By the classification of destabilizing ghost components in \S\ref{subsec:classifying-destabilizing-ghost-components} and by the assumption $(A,g,k) \neq (0,0,3)$, $(0,0,1)$ we need only consider destabilizing ghost components of type $(0,1)$ and type $(0,2)$.

In what follows, we will define new gluing constructions for these cases, designed to more accurately model the expected behavior of the GW-moduli spaces on regions near a destabilizing ghost component.
This new gluing procedure remains identical to the DM-gluing considered on the underlying Riemann surface $\Sigma$ in \S\ref{subsubsec:gluing-profiles-gluing-construction-noded-reimann-surface}, it only modifies the gluing construction at a stable map as described in \S\ref{subsubsec:the-gluing-construction-stable-map}.
In order to ensure $\ssc$-smoothness of the expressions for gluing and anti-gluing it is important to use the exponential  gluing profile given by $\varphi_{\exp} (r)=e^{1/r}-e$.

\subsubsection{Gluing at destabilizing ghost components of type $(0,1)$}



For simplicity we will assume that $\{x_a,y_a\}, \{x_b,y_b\}$ are the only nodal pairs.
We recall the gluing construction for a noded Riemann surface of case $2a$ from \S\ref{subsubsec:local-expression-forgetting-map-on-dm-orbifold}.
Writing the gluing parameters $a\neq 0$ or $b\neq 0$ in polar coordinates as
\begin{align*}
	a = r_a e^{-2\pi i\theta_a}, \qquad & r_a\in (0,\tfrac{1}{2}),\ \theta_a \in \R/ \Z, \\
	b = r_b e^{-2\pi i\theta_b}, \qquad & r_b\in (0,\tfrac{1}{2}),\  \theta_b \in \R/\Z,
\end{align*}
we replace $D_{x_a}\sqcup C_k \sqcup D_{y_b}$ with the glued cylinder
\[
	Z_{a,b} :=
	\begin{cases}
		[0,R_a+R_b]\times S^1                                    & a\neq 0, b\neq 0                               \\
		\R^+\times S^1 \sqcup \R^-\times S^1                     & \text{if } a\neq 0,b=0 \text{ or } a=0,b\neq 0 \\
		\R^+\times S^1 \sqcup \R\times S^1 \sqcup \R^-\times S^1 & \text{if } a=0,b=0.
	\end{cases}
\]
We thus obtain the glued Riemann surface
\[\Sigma_{a,b}: = \Sigma \setminus (D_{x_a}\sqcup C_k \sqcup D_{y_b}) \sqcup Z_{a,b}.\]

We now define the new stable map gluings.
At the outset, fix a smooth cutoff function $\beta:{\mathbb R}\rightarrow [0,1] $ which satisfies the following:
\begin{itemize}
	\item $\beta (-s)+\beta (s)=1\quad \text{for all } s\in \R$
	\item $\beta (s)=1\quad \text{for all } s\leq -1$
	\item $\tfrac{d}{ds}\beta(s)<0\quad \text{for all } s\in (-1, 1)$.
\end{itemize}
Consider a pair of continuous maps
\[
	h^+:\R^+\times S^1\to \R^{2n}, \qquad h^-:\R^-\times S^1\to \R^{2n}
\]
with common asymptotic constant $c:= \lim_{s\to  \infty} h^+(s,t)= \lim_{s\to  -\infty} h^-(s,t)$.
For given gluing parameters $a,b\in \hb$, $a\neq 0$, $b\neq 0$ we define the \textbf{glued map of type $(0,1)$},  $\oplus^\text{uc}_{a,b} (h^+,h^-) : Z_{a,b} \to \R^{2n}$, by
\begin{align*}
	\oplus^\text{uc}_{a,b} (h^+,h^-) (s,t):=
	 & \beta\left(	s - \tfrac{R_a+R_b}{2}	\right) \cdot h^+(s,t)                                           \\
	 & + \left(1-\beta \left(	s-\tfrac{R_a+R_b}{2}	\right)\right) \cdot h^-(s-R_a-R_b,t-\theta_a-\theta_b)
\end{align*}
For other values of $a$ and $b$ we define $\oplus^\text{uc}_{a,b} (h^+,h^-)$ by
\begin{align*}
	 & \oplus^\text{uc}_{a,b} (h^+,h^-):=                                                                                  \\
	 & \qquad \begin{cases}
		          (h^+,h^-):\R^+\times S^1\sqcup \R^-\times S^1 \to \R^{2n}                         & \text{if } a\neq 0, b=0  \\
		                                                                                            & \text{or } a=0, b\neq 0, \\
		          (h^+,c,h^-) : \R^+\times S^1\sqcup \R\times S^1 \sqcup \R^-\times S^1 \to \R^{2n} & \text{if } a=0, b=0,
	          \end{cases}
\end{align*}
where $c:\R\times S^1 \to \R^{2n}$ is the constant map to $c\in \R^{2n}$

Consider the following space of sections $H^{3,\delta_0}_{c,\text{const}}(\Sigma, u^*TM)$, consisting of sections $\eta : \Sigma \to u^*TM$ such that:
$\eta$ is of class $H^{3,\delta_0}$ around the nodal points and of class $H^3_\text{loc}$ at the other points of $\Sigma$, $\eta$ has matching asymptotic values at the nodal pairs and is constant on the destabilizing ghost component, i.e., $\eta(x_a) = \eta(C_k)=\eta(y_b)$.
We now consider local expressions for the map $u$ and section $\eta$ as follows.
In a neighborhood of the point $u(x_a)=u(C_k)=u(y_b) \in M$ choose a chart which identifies the point with $0\in \R^{2n}$.
Furthermore, given a Riemannian metric $g$ on $M$ we may assume that this chart is chosen such that this metric is identifiable with the Euclidean metric on $\R^{2n}$.
Localized to these coordinate neighborhoods, we may view the base map $u$ as maps
\[u^+:\R^+\times S^1\to \R^{2n}, \quad 0:\R\times S^1 \to \R^{2n}, \quad u^-:\R^-\times S^1\to \R^{2n}\]
and likewise the section $\eta$ as maps
\[\eta^+:\R^+\times S^1\to \R^{2n}, \quad c:\R\times S^1 \to \R^{2n}, \quad \eta^-:\R^-\times S^1\to \R^{2n}\]
such that $c:=\lim_{s\to  \infty} \eta^+ = \lim_{s\to  -\infty} \eta^-$ and where $c:\R\times S^1 \to \R^{2n}$ is the constant map to $c\in \R^{2n}$.

Given a gluing parameters $a,b \in \hb$ we define the \textbf{new glued stable map} $\oplus^\text{uc}_{a,b} \exp_u (\eta) :\Sigma_{a,b} \to M$ as follows:
\[
	\oplus^\text{uc}_{a,b} \exp_u \eta :=
	\begin{cases}
		\exp_u \eta                                          & \text{ on } \Sigma \setminus (D_{x_a}\sqcup C_k\sqcup D_{y_a}), \\
		\oplus^\text{uc}_{a,b} (u^+ + \eta^+, u^- + \eta^- ) & \text{ on } Z_{a,b}.
	\end{cases}
\]

We will sometimes use the abbreviations
$R_{a,b}:= \varphi (\abs{a}) +\varphi(\abs{b})$ and $\theta_{a,b} := \theta_a+\theta_b$.
If $a,b\in \hb$ are gluing parameters with $a\neq 0$, $b\neq 0$, we define the cutoff function $\beta_{a,b}:\R\to \R$ by
\[
	\beta_{a,b} (s):=\beta \left( s-\tfrac{R_{a,b}}{2}\right).
\]

In order to describe data that would otherwise be lost in the gluing procedure, we define corresponding cylinders $C_{a,b}$ by
\[
	C_{a,b} :=
	\begin{cases}
		\R\times S^1 & \text{when } a\neq 0, b\neq 0 \\
		\emptyset    & \text{otherwise}.
	\end{cases}
\]
For $a\neq 0$ and $b\neq 0$ define the \textbf{new anti-glued section} %
as the map $\ominus^\text{uc}_{a,b}(\eta^+,\eta^-) : C_{a,b}\to \R^{2n}$,
\begin{align*}
	\ominus^\text{uc}_{a,b} (\eta^+,\eta^-)(s,t):=
	 & -\left(1-\beta_{a,b}(s) \right) \cdot \left(	\eta^+(s,t)	-\av_{a,b}(\eta^+,\eta^-)\right)              \\
	 & \qquad + \beta_{a,b}(s) \cdot \left(\eta^-(s-R_{a,b},t-\theta_{a,b}) -	\av_{a,b}(\eta^+,\eta^-)\right)
\end{align*}
where
\[
	\av_{a,b} (\eta^+,\eta^-):= \frac{1}{2} \left(	\int_{S^1} \eta^+(\tfrac{R_{a,b}}{2},t)dt + \int_{S^1} \eta^-(-\tfrac{R_{a,b}}{2},t)dt	\right).
\]
For other values of $a$ and $b$ we define $\ominus^\text{uc}_{a,b} (\eta^+,\eta^-)$ as the unique map $\emptyset \to \R^{2n}$.

Letting $U\subset H^{3,\delta_0}_{c,\text{const}}(\Sigma, u^*TM)$ be a sufficiently small neighborhood of the zero section, we have an analog of Theorem~\ref{thm:ssc-retraction}.
\begin{proposition}
	There exists a $\ssc$-retraction, i.e., a $\ssc$-smooth map which satisfies $\pi \circ \pi = \pi$,
	\begin{align*}
		\pi: \hb \times\hb \times V \times U & \to \hb \times\hb \times V \times U \\
		(a,b,v,\eta)                         & \mapsto (a,b,v,\pi_{a,b} (\eta)),
	\end{align*}
	such that the restriction of the above family to the subset $\cV := \pi (\hb \times\hb \times V \times U)$ is injective.
\end{proposition}
\begin{proof}
	We may consider a simplified local expression
	\begin{align*}
		\pi: \hb\times\hb \times E^\pm & \to  \hb\times\hb\times E^\pm \\
		(a,b,\xi^+,\xi^-)              & \mapsto (a,b,\eta^+,\eta^-)
	\end{align*}
	where $\eta^\pm$ are uniquely defined by the equations:
	\[
		\oplus^\text{uc}_{a,b}(\eta^+,\eta^-) = \oplus^\text{uc}_{a,b}(\xi^+,\xi^-) \quad \text{and}\quad \ominus^\text{uc}_{a,b} (\eta^+,\eta^-) =0.
	\]
	Abbreviate $\gamma_{a,b}=\beta_{a,b}^2(s^+)+(1-\beta_{a,b}(s^+))^2$.  We may write down the following explicit formulas:
	\begin{align*}
		\eta^+(s^+, t^+) = & \left(1-\frac{\beta_{a,b}}{\gamma_{a,b}}\right)\cdot \av_{a,b}(\xi^+, \xi^-) +\frac{\beta_{a,b}^2}{\gamma_{a,b}}\cdot \xi^+(s^+, t^+) \\
		                   & + \frac{\beta_{a,b} (1-\beta_{a,b})}{\gamma_{a,b}}\cdot \xi^-(s^+-R_{a,b}, t^+ -\theta_{a,b})
	\end{align*}
	for $(s^+, t^+)\in \R^+\times S^1$.  A similar calculation leads to the following formula for $\eta^-$:

	\begin{align*}
		\eta^-(s^-, t^-)= & \left( 1-\frac{\beta_{a,b} (- s^-)}{\gamma_{a,b} (-s^-)}\right)\cdot \av_{a,b} (\xi^+, \xi^-)                       \\
		                  & +\frac{\beta_{a,b} (-s^- ) (1-\beta_{a,b} (-s^- ))}{\gamma_{a,b}(-s^- )}\cdot \xi^+(s^-+R_{a,b}, t^- +\theta_{a,b}) \\
		                  & +\frac{\beta_{a,b} (-s^- )^2}{\gamma_{a,b}(-s^- )}\xi^-(s^-, t^-)
	\end{align*}
	for $(s^-, t^-)\in \R^-\times S^1$.



	The argument that the retraction $\pi$ is $\ssc$-smooth then follows precisely the same reasoning as in the proof that the projection $\pi_a$ defined via the usual gluing and anti-gluing is $\ssc$-smooth, namely by checking differentiability of individual terms in the explicit formula for $\eta^\pm$ and applying the chain rule.  Full details must follow the lengthy arguments given in \cite{HWZsc}*{\S2.4}.
\end{proof}

As in \cite{HWZGW}*{pp.~60--61}, there are analogous new hat gluings and new hat antigluings, used to define the strong polyfold bundles.

\subsubsection{Gluing at destabilizing ghost components of type $(0,2)$}

For simplicity, we will assume that $\{x_a,y_a\}$ is the only nodal pair.
Let $a\in \hb$ be the associated gluing parameter.
Recall the gluing construction for a noded Riemann surface of case $2b$ from \S\ref{subsubsec:local-expression-forgetting-map-on-dm-orbifold}, in particular, note that when $a\neq 0$, the Riemann surface $\Sigma_a$ is obtained by simply deleting the component $C_k$.

In this case we use the single gluing parameter to parametrize movement of the marked point $z_k$; we do not interpolated maps across the node.
We consider the space $\eta \in H^{3,\delta_0}_{c,\text{const}}(\Sigma, u^*TM)$ consisting of sections $\eta: \Sigma \to u^*TM$ such that: $\eta$ is of class $H^{3,\delta_0}$ around the nodal points and of class $H^3_\text{loc}$ at the other points of $\Sigma$, $\eta$ is constant on the destabilizing ghost component, i.e., $\eta(x_a) = \eta (C_k)$.
The new glued stable map $\oplus^\text{uc}_a \exp_u \eta : \Sigma_a \to M$ is then defined by:
\[
	\oplus^\text{uc}_a \exp_u \eta :=
	\begin{cases}
		\exp_u \eta |_{\Sigma\setminus C_k}                           & a\neq 0, \\
		\exp_u \eta |_{\Sigma\setminus C_k}, \exp_u \eta (C_k)|_{C_k} & a=0.
	\end{cases}
\]

\subsubsection{Good uniformizing families of stable maps with constant destabilizing ghost components}

As in \S\ref{subsubsec:families-stable-maps-in-general} we may choose a stabilization together with linear constraints.
The Riemann surface $(\Sigma,j,M\cup S,D)$ is now stable; let
\[
	(a,v)\mapsto (\Sigma_a, j(a,v), (M\cup S)_a, D_a), \quad (a,v) \in \hb^{\sharp D} \times V
\]
be a good uniformizing family of stable noded Riemann surfaces.
Using the linear constraints, we consider the constrained subspace of sections
\[
	E_S := \{ \eta \in H^{3,\delta_0}_{c,\text{const}} (\Sigma, u^*TM)	\mid \eta(z_s) \in H_{u(z_s)} \text{ for } z_s \in S\}
\]
and let $U \subset E_S$ be an suitably small open neighborhood of the zero section.
One can then define a $\ssc$-retraction
\begin{align*}
	\pi : \hb^{\sharp D} \times V \times U & \to \hb^{\sharp D} \times V \times U \\
	(a,v,\eta)                             & \mapsto (a,v,\pi_a(\eta)).
\end{align*}
The image $\cU : = \pi (\hb^{\sharp D} \times V \times U)$ is a $\ssc$-retract on which the gluing map is injective.

\begin{definition}
	Analogously to Definition~\ref{def:good-uniformizing-family-of-stable-maps}, we define a \textbf{good uniformizing family of stable maps associated to the new gluing} centered at $(\Sigma,j,M,D,u)$ as a family of stable maps
	\[
		(a,v,\eta) \mapsto (\Sigma_a, j(a,v), M_a, D_a, \oplus^\text{uc}_a \exp_u \eta), \quad (a,v,\eta )\in \cU.
	\]
	In particular, the section $\eta$ satisfies the linear constraint $H_{u(z_s)}$ at each stabilizing point $z_s\in S$.

	If the stable map $(\Sigma,j,M,D,u)$ contains a destabilizing ghost component of type $(0,1)$, the new glued map $\oplus^\text{uc}_a \exp_u \eta : \Sigma_a \to M$ can be described as follows:
	\[
		\oplus^\text{uc}_{a,b} \exp_u \eta :=
		\begin{cases}
			\exp_u \eta                        & \text{on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a}), \\
			\oplus^\text{uc}_{a,b} \exp_u \eta & \text{on } Z_{a,b},                                                          \\
			\oplus_{a'} \exp_u \eta            & \text{on } Z_{a'} \text{ for all other gluing parameters}.
		\end{cases}
	\]

	If the stable map $(\Sigma,j,M,D,u)$ contains a destabilizing ghost component of type $(0,2)$, we define the new glued map $\oplus^\text{uc}_a \exp_u \eta : \Sigma_a \to M$ can be described as follows:
	\[
		\oplus^\text{uc}_a \exp_u (\eta) :=
		\begin{cases}
			\exp_u \eta             & \text{ on } \Sigma \setminus \cup_{\{x_a,y_a\}\in D} (D_{x_a}\sqcup D_{y_a}) \\
			\exp_u \eta             & \text{ on the small disks bordering the $i$th-marked point}                  \\
			\oplus_{a'} \exp_u \eta & \text{ on } Z_{a'} \text{ for all other gluing parameters}.
		\end{cases}
	\]
\end{definition}

\subsubsection{Local smooth structures on the universal curve polyfold}

In practice, the construction of a topology and the construction of a polyfold structure on a candidate set $\cZ$ are intertwined. A key step in the construction is proving a compactness property holds for the morphism set as in \cite{HWZGW}*{Prop.~3.22}.

Alternatively, one should use the updated approach of \cite{HWZbook}*{Part~IV} to recast the process in terms of ``groupoidal topological categories''.

Following the arguments of \cite{HWZGW}*{\S3.4}, we may assert that the set $\cZ^\text{uc}_{A,g,k}$ has a natural second countable, paracompact, Hausdorff topology.
By construction of this topology, the map
\[
	\frac{\{(\Sigma_a,j(a,v), M_a,D_a, \oplus^\text{uc}_a \exp_u \eta)\}_{(a,v,\eta)\in \cU}}{\Aut(\Sigma,j,M,D,u)} \to \cZ^\text{uc}_{A,g,k}.
\]
is a local homeomorphism.

Following the arguments of \cite{HWZGW}*{\S3.5}, we can construct a polyfold structure on the set of universal curves.

\begin{theorem}
	Fix a strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$.
	The second countable, paracompact, Hausdorff topological space $\cZ^\text{uc}_{A,g,k}$ possesses a natural equivalence class of polyfold structures.
\end{theorem}

\subsection{Invariants for the universal curve polyfold}

Just as in \S\ref{sec:the-polyfold-gw-invariants} we may define invariants for the universal curve polyfold.

\begin{definition}\label{def:new-strong-polyfold-bundle}
	As in Definition~\ref{def:strong-polyfold-bundle}, the underlying set of the strong polyfold bundle $\cW^{\text{uc}}_{A,g,k}$ is defined as the set of equivalence classes
	\[
		\cW^{\text{uc}}_{A,g,k}:= \{ (\Sigma,j,M,D,u,\xi ) \mid \cdots \} / \sim
	\]
	with data as follows.
	\begin{itemize}
		\item $(\Sigma,j,M,D,u)$ is a stable map representative of a stable curve in $\cZ^{\text{uc}}_{A,g,k}$.
		\item $\xi$ is a continuous section along $u$ such that the map
		      \[
			      \xi(z):T_z\Sigma\rightarrow T_{u(z)}M,\quad \text{for } z\in
			      \Sigma
		      \]
		      is a complex anti-linear map.
		\item At a destabilizing ghost component $C_k \subset \Sigma$ we define $\xi$ to be the zero section.
		\item As in Definition~\ref{def:strong-polyfold-bundle} we require that the local expressions for $\xi$ are of class $H^{2,\delta_0}$ around the nodal points in $\abs{D}$ and around the marked points $\{z_1,\ldots,z_{k-1}\}$.
		      We require the local expression is of class $H^2_\text{loc}$ near the other points in $\Sigma$.
		\item The equivalence relation is given by
		      \[(\Sigma,j,M,D,u,\xi)\sim (\Sigma',j',M',D',u',\xi')\]
		      if there exists a biholomorphism $\phi :(\Sigma,j)\to (\Sigma',j')$ which satisfies $\xi'\circ d\phi=\xi$ in addition to $u'\circ \phi = u$, $\phi(M)= M'$, $\phi (\abs{D})=\abs{D'}$, and which preserves ordering and pairs.
	\end{itemize}
\end{definition}

We claim that we can give $\cW^{\text{uc}}_{A,g,k}$ a polyfold structure such that
\[
	P:\cW^{\text{uc}}_{A,g,k}\to \cZ^{\text{uc}}_{A,g,k}, \qquad [\Sigma,j,M,D,u,\xi]\mapsto [\Sigma,j,M,D,u]
\]
defines a strong polyfold bundle over the universal curve polyfold $\cZ^{\text{uc}}_{A,g,k}$.
The Cauchy--Riemann section $\delbarj$ of the strong polyfold bundle  $P:\cW^{\text{uc}}_{A,g,k}\to \cZ^{\text{uc}}_{A,g,k}$ is a proper $\ssc$-smooth Fredholm section.  The Fredholm index of $\delbarj$ is given by
\[\ind \delbarj =2c_1(A)+(\text{dim}_{\R} M-6)(1-g)+2k.\]
Notice that the unperturbed GW-moduli space $\CM_{A,g,k}(J)$ is identical for both the universal curve polyfold $\cZ^{\text{uc}}_{A,g,k}$ and the usual GW-polyfold $\cZ_{A,g,k}$

By \cite{HWZbook}*{Cor.~15.1} there exist regular perturbations of the Cauchy--Riemann section, hence the perturbed moduli space
\[
	\cS^{\text{uc}}_{A,g,k}(p) : = \text{`` }(\delbarj + p)^{-1} (0) \text{ ''} \subset \cZ^{\text{uc}}_{A,g,k}
\]
has the structure of a compact oriented weighted branched suborbifold.

As in \S\S\ref{subsec:branched-integrals} and \ref{subsec:intersection-numbers}, we may use this perturbed moduli space to define invariants.

\begin{theorem}\label{thm:gw-invariants-new-polyfold}
	We define the \textbf{Gromov--Witten invariant for the universal curve polyfold} as the homomorphism
	\[
		\GW^{\text{uc}}_{A,g,k} : H_*(M;\Q)^{\otimes k} \otimes H_*(\dmlog_{g,k};\Q ) \to \Q
	\]
	defined via either the branched integration of \cite{HWZint}:
	\[
		\GW^{\text{uc}}_{A,g,k} (\alpha_1,\ldots,\alpha_k;\beta) := \int_{\cS^\text{uc}_{A,g,k}(p)} ev_1^* \PD (\alpha_1)\wedge \cdots \wedge ev_k^* \PD (\alpha_k) \wedge\pi^* \PD (\beta)
	\]
	or the intersection number of \cite{schmaltz2019steenrod}:
	\[
		\GW^{\text{uc}}_{A,g,k} ([\cX_1],\ldots,[\cX_k];[\cB]) := \left(ev_1\times\cdots\times ev_k\times\pi\right)|_{\cS^{\text{uc}}_{A,g,k}(p)} \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
	\]
	This invariant does not depend on the choice of perturbation, nor on choice of basis of representing submanifolds/suborbifolds.
\end{theorem}

\subsection{Naturality of the polyfold invariants for the universal curve and the Gromov--Witten polyfolds}

Consider the unperturbed GW-moduli space $\CM_{A,g,k}(J)$ defined in the introduction as the stable map compactification of the set of $J$-holomorphic curves.
We have distinct polyfolds $\cZ^{\text{uc}}_{A,g,k}$ and $\cZ_{A,g,k}$ which contain $\CM_{A,g,k}(J)$ as a compact subset; after regularization we obtain distinct perturbed moduli spaces and moreover distinct polyfold invariants $\GW^{\text{uc}}_{A,g,k}$ and  $\GW_{A,g,k}$ which, a priori, we cannot assume are equivalent.
This is precisely the type of problem described in \cite{schmaltz2019naturality}.

We may consider a commutative diagram of inclusion maps between polyfolds and between strong polyfold bundles:
\[\begin{tikzcd}
		\cW^{\text{uc}}_{A,g,k} \arrow[r, hook] \arrow[d, "\delbarj \quad"'] & \cW_{A,g,k} \arrow[d, "\quad \delbarj"] &  \\
		\cZ^{\text{uc}}_{A,g,k} \arrow[r, hook] \arrow[u, bend left] & \cZ_{A,g,k} \arrow[u, bend right] &
	\end{tikzcd}\]
in addition to a commutative diagram:
\[\begin{tikzcd}
		&  & M^k \times \dmlog_{g,k} \\
		\cZ^{\text{uc}}_{A,g,k} \arrow[r, hook] \arrow[rru, "ev\times\pi"] & \cZ_{A,g,k} \arrow[ru, "ev\times\pi"'] &
	\end{tikzcd}
\]
One should immediately note that $\cW^{\text{uc}}_{A,g,k}$ is not the pullback bundle of $\cW_{A,g,k}$ (recall we require the complex anti-linear sections $\xi$ are constant on destabilizing ghost components in $\cW^{\text{uc}}_{A,g,k}$).

It is straightforward to check that the maps in these diagrams satisfy the same properties as described in \cite{schmaltz2019naturality}*{\S2.3}.
The critical hypothesis is the existence of a ``intermediary subbundle'' \cite{schmaltz2019naturality}*{Def.~2.15}.

\begin{proposition}
	The set
	\begin{align*}
		\cR := \{	[\Sigma,j,M,D,u,\xi] \in \cW_{A,g,k} \mid & \supp \xi \subset K \subset \Sigma \setminus (S^2_k \sqcup \{x_a,y_b\}) \\
		                                                    & \qquad\qquad\qquad\text{ for some compact } K\},
	\end{align*}
	(i.e., the subset of complex anti-linear sections which are supported away from a possible destabilizing ghost component and any adjacent nodes)
	is an intermediary subbundle of the strong polyfold bundle $\cW_{A,g,k}$.
\end{proposition}
\begin{proof}
	The proof follows the same reasoning as the proofs of \cite{schmaltz2019naturality}*{Props.~2.17,~2.18}.
	In particular, by \cite{schmaltz2019naturality}*{Cor.~B.4} one can find vectors which span the cokernel and vanish on the destabilizing ghost component and on disk-like regions of any adjacent nodes.
\end{proof}

We therefore satisfy the hypothesis of \cite{schmaltz2019naturality}*{Thm.~1.3}, and hence we immediately obtain the following theorem.

\begin{theorem}\label{thm:equivalence-polyfold-invariants}
	The polyfold GW-invariants associated to the universal curve polyfold $\cZ^{\text{uc}}_{A,g,k}$ and to the GW-polyfold $\cZ_{A,g,k}$ are identical, i.e.,
	\[\GW^{\text{uc}}_{A,g,k}= \GW_{A,g,k}.\]
\end{theorem}

\subsection{Pulling back perturbations to the universal curve polyfold via the \texorpdfstring{$k$th-marked}{kth-marked} point forgetting map}\label{subsec:pulling-back-via-ftk}

The entire point of defining the universal curve polyfold is to be able to consider a well-defined $k$th-marked point forgetting map
\[
	ft_k : \cZ^\text{uc}_{A,g,k} \to \cZ_{A,g,k-1}.
\]
We now how to pullback abstract perturbations via this map.

\subsubsection{The $k$th-marked point forgetting map redux}

Recall that we require the stable curves in $\cZ^{\text{uc}}_{A,g,k}$ are of class $H^{3,\delta_0}$ at all marked points $\{z_1,\ldots z_{k-1}\}$, and of class $H^3_\text{loc}$ at the marked point $z_k$.
In order to get a well-defined map, we then require that the stable curves in $\cZ_{A,g,k-1}$ are of class $H^{3,\delta_0}$ at all marked points $\{z_1,\ldots z_{k-1}\}$.

\begin{definition}\label{def:kth-marked-point-forgetting-map-redux}
	We define the \textbf{$k$th-marked point forgetting map}
	\[
		ft_k :\cZ^{\text{uc}}_{A,g,k}\to \cZ_{A,g,k-1}
	\]
	on the underlying sets of the GW-polyfolds as follows.  Let $[\Sigma,j,M,D,u]\in \cZ^{\text{uc}}_{A,g,k}$ be a stable curve and let $(\Sigma,j,M,D,u)$ be a stable map representative. To define $ft_k$ we distinguish three cases for the component $C_k$ which contains the $k$th-marked point, $z_k \in C_k$.
	\begin{enumerate}
		\item The component $C_k\setminus \{z_k\}$ satisfies the usual GW-stability condition \eqref{eq:gw-stability-condition}, i.e.,
		      \[
			      2 g_{C_k} +\sharp ((M\setminus\{z_k\}) \cup \abs{D})_{C_k} \geq 3 \quad \text{or}\quad \int_{C_k} u^*\ww >0.
		      \]
		      We therefore define
		      \[
			      ft_k ([\Sigma,j, M,D,u]) = [\Sigma,j, M\setminus\{z_k\},D,u].
		      \]
		\item[(2a)] The component $C_k$ is a destabilizing ghost component of type $(0,1)$.  Then $ft_k ([\Sigma,\allowbreak j,\allowbreak  M,\allowbreak D,\allowbreak u])$ is give by the stable curve obtained as follows.  Delete $z_k$, delete the component $C_k$, and delete the two nodal pairs.  We add a new nodal pair $\{x_a,y_b\}$ given by two points of the former nodal pairs.
		\item[(2b)] The component $C_k$ is a destabilizing ghost component of type $(0,2)$.  Then $ft_k ([\Sigma,\allowbreak j,\allowbreak  M,\allowbreak D,\allowbreak u])$ is give by the stable curve obtained as follows.  Delete $z_k$, delete the component $C_k$, and delete the nodal pair.  We add a new marked point $z_i$, given by the former nodal point which did not lie on $C_k$.
	\end{enumerate}
\end{definition}

\subsubsection{Local expressions for the $k$th-marked point forgetting map on the universal curve polyfold}

We now write down local expressions for $ft_k$ in terms of local scale coordinates, in an analagous way as in \S\ref{subsubsec:local-expression-forgetting-map-on-dm-orbifold}.

\noindent\textit{Case 1.}
Using an alternative good uniformizing family to parametrize the movement of the $k$th-marked point directly,
and noting that we may choose identical stabilizations for the source and target,
a local expression for $\hat{ft}_k$ is given by:
\begin{align*}
	\hat{ft}_k : & \{(\Sigma_a,j(a,v),M_{(a,y)}, D_a, \oplus_a^{\text{uc}} \exp_u \eta)\}_{(a,v,y, \eta)\in \cU}            \\
	             & \qquad\to \{(\Sigma_b, j(b,w), (M\setminus\{z_k\})_b, D_b, \oplus_b \exp_u \zeta)\}_{(b,w,\zeta)\in \cV} \\
	             & (a,v,y,\eta) \mapsto (a,v, \eta).
\end{align*}
\noindent\textit{Case 2a.}
By construction, the interpolation given by the new gluing at a destabilizing ghost component of type $(0,1)$ for a parameter $(a,b)$ is identical to the usual gluing at a parameter $c$ are the same precisely when $c = a\ast_{\exp} b$, i.e.,
\[
	\oplus_{a,b}^\text{uc} (\eta^+,\eta^-) = \oplus_{a\ast_{\exp} b} (\eta^+,\eta^-).
\]
The anti-gluings are related by a similar equation, and it isn't hard to then show the appropriate $\ssc$-retractions are identical when considered on gluing parameters $(a,b)$ and $a\ast_{\exp} b$.
Using this observation, a local expression for $\hat{ft}_k$ is given by:
\begin{align*}
	\hat{ft}_k : & \{(\Sigma_{a,b},j(a,b,v),M_{a,b},\{\{x_a,y_a\}, \{x_b,y_b\}\}_{a,b}, \oplus_{a,b}^\text{uc} \exp_u \eta)\}_{(a,b,v,\eta)\in \cU}   \\
	             & \qquad\to \{((\Sigma\setminus C_k)_c, j(c,w), (M\setminus \{z_k\})_c, \{x_c,y_c\}_c, \oplus_c \exp_u \zeta)\}_{(c,w,\zeta)\in \cV} \\
	             & (a,b,v, \eta)  \mapsto (a\ast_{\exp} b, v, \eta).
\end{align*}
\noindent\textit{Case 2b.}
In this case, the gluing parameter is only used to keep track of the $k$th-marked point and there is no interpolation involved. A local expression for $\hat{ft}_k$ is given by:
\begin{align*}
	\hat{ft}_k : & \{(\Sigma_a,j(a,v),M_a,\{\{x_a,y_a\}\}_a, \exp_u \eta)\}_{(a,v,\eta)\in \cU}                              \\
	             & \qquad\to \{(\Sigma\setminus C_k, j(w), M\setminus \{z_k\}, \emptyset, \exp_u \zeta)\}_{(w,\zeta)\in \cV} \\
	             & (a,v,\eta)   \mapsto (v,\eta).
\end{align*}

\subsubsection{Pulling back perturbations via the $k$th-marked point forgetting map}

We now may consider pullbacks of perturbations via $ft_k$ as in \S\ref{subsec:pulling-back-abstract-perturbations}.

\begin{theorem}\label{thm:pulling-back-via-ftk}
	We can construct a regular perturbation which pulls back to a regular perturbation via the $k$th-marked point forgetting map.
	Thus, we can consider a well-defined restriction between perturbed GW-moduli spaces,
	\[
		ft_k : \cS^{\text{uc}}_{A,g,k} (ft_k^*p) \to \cS_{A,g,k-1}(p).
	\]
\end{theorem}
\begin{proof}
	The methods of \cite{schmaltz2019naturality}*{\S3} which we recalled in \S\ref{subsec:pulling-back-abstract-perturbations} are complicated by the fact that $ft_k$ is $\ssc^0$, and fails to be $\ssc^1$ at stable curves which contain a destabilizing ghost component of type $(0,1)$.  This is an unavoidable consequence of the fact that our construction of the GW-polyfolds uses as a base the exponential DM-orbifolds, and we have shown in Problem~\ref{prob:ftk-continuous-not-c0} that $ft_k :\dmexp_{g,k} \to \dmexp_{g,k-1}$ fails to be $C^1$ at precisely the components of type $(0,1)$.


	We may still consider the pullback via $ft_k$ of the strong polyfold bundle $\cW_{A,g,k-1} \to \cZ_{A,g,k-1}$ and the Cauchy--Riemann section $\delbarj$, as illustrated in the below commutative diagram.
	\[
		\begin{tikzcd}
			ft_k^* \cW_{A,g,k-1} \arrow[d, "ft_k^* \delbarj\quad "'] \arrow[r, "\text{proj}_2"'] & \cW_{A,g,k-1} \arrow[d, "\quad \delbarj"] &  \\
			\cZ^{\text{uc}}_{A,g,k} \arrow[r, "ft_k"'] \arrow[u, bend left] & \cZ_{A,g,k-1} \arrow[u, bend right] &
		\end{tikzcd}
	\]
	However, the pullback $ft_k^* \mathcal{W}_{A,g,k-1}$ does not carry a $\ssc$-smooth structure.  We may replace the \'etale condition with a $\ssc^0$-\'etale condition (where the source and target maps are required to be surjective local homeomorphisms) and hence we may consider $ft_k^* \mathcal{W}_{A,g,k-1}$ as carrying a \textit{topological} polyfold structure.


	The strong polyfold bundle $\cW^{\text{uc}}_{A,g,k}\to \cZ^{\text{uc}}_{A,g,k}$ carries a $\ssc$-smooth structure.  Moreover, there is a natural $\ssc^0$-homeomorphism $\cW^{\text{uc}}_{A,g,k} \simeq ft_k^* \cW_{A,g,k-1}$.  We may therefore consider the pullback of a parametrized $\ssc^+$-multisection $\Lambda^t : \cW_{A,g,k-1} \to \Q^+$ as defining a parametrized $\ssc^0$-multisection $\text{proj}_2^* \Lambda^t :\mathcal{W}^{ft}_{A,g,k} \to \Q^+$.  Observe that since we are pulling back via a $\ssc^0$-map, the local section structures can only be assumed to be $\ssc^0$.

	A multisection which is $\ssc^0$ is unsuitable for running a transversality argument.  However, if we are careful in our construction of the $\ssc^+$-multisection $\Lambda$ we can actually ensure that the pullback local section structures $ft_k^* s^t_1, \ldots, ft_k^*s^t_j$ will be $\ssc$-smooth.  The main idea is the following: in the local expressions we can pinpoint exactly where the failure of differentiability occurs; the map between the gluing parameters $(a,b)\mapsto a\ast_{\exp} b $ fails to be $C^1$ at points $(a,b)$ with $a\ast_{\exp} b=0$.  We can define a cutoff function $\beta : \hb \subset \C\to [0,1]$ to be constant on a small neighborhood of the gluing parameter $c=0$.  Hence, while the expression $a \ast_{\exp} b$ is not $C^1$, the cutoff
	\[\C\times \C\to \R, \qquad (a,b)\mapsto \beta (a\ast_{\exp} b)\]
	is smooth.

	Following this observation, it is easy to show that the methods of \cite{schmaltz2019naturality}*{\S3} may be used to achieve simultaneous transversality.  In order to achieve simultaneous compactness, we note that auxiliary norms are only assumed to be $\ssc^0$, and hence the pullback of an auxiliary norm by $ft_k$ gives a well-defined auxiliary norm on the strong polyfold bundle $\cW^{\text{uc}}_{A,g,k}\to \cZ^{\text{uc}}_{A,g,k}$.
	It is then a topological exercise to show that the map $ft_k$ satisfies the topological pullback condition.
\end{proof}


\section{The Gromov--Witten axioms}\label{sec:gw-axioms}

We restate and prove the Gromov--Witten axioms for the polyfold Gromov--Witten invariants.

\begin{axiom*}{Effective axiom}
	If $\ww (A) <0 $ then $\GW_{A,g,k} = 0$.
\end{axiom*}
\begin{proof}
	The energy of a smooth map $u:\Sigma \to M$ is defined as
	\[
		E(u):= \frac{1}{2} \int_\Sigma \abs{du}_j^2 \text{dvol}_\Sigma.
	\]
	By the energy identity, a $J$-holomorphic map must satisfy $\ww(A) = E(u) \geq 0$ (for example, see \cite{MSbook}*{Lem.~2.2.1}).
	Hence, the unperturbed GW-moduli space is the empty set, i.e., $\CM_{A,g,k}(J)= \emptyset$, and hence the Cauchy--Riemann section is trivially transverse without perturbation.  Therefore,
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k;\beta) = 	\int_{\emptyset} ev_1^* \PD (\alpha_1)\wedge\cdots \wedge ev_k^* \PD(\alpha_k) \wedge \pi^* \PD (\beta) = 0.
	\]
\end{proof}

\begin{axiom*}{Grading axiom}
	If $\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta) \neq 0$ then
	\[
		\sum_{i=1}^k (2n - \deg (\alpha_i)) + (6g-6+2k - \deg(\beta)) = 2c_1(A) + (2n-6)(1-g) + 2k.
	\]
\end{axiom*}
\begin{proof}
	The left hand side is the codegree of $\alpha_1\times \cdots \alpha_k \times \beta$ in the product $M^k\times \dmlog_{g,k}$, while the right hand side is the dimension of the perturbed GW-moduli space.  Hence, this follows directly from the definition of the GW-invariants.%
\end{proof}

\begin{axiom*}{Homology axiom}
	There exists a homology class
	\[
		\sigma_{A,g,k} \in H_{2c_1(A) + (2n-6)(1-g) + 2k} (M^k\times \dmspace_{g,k};\Q)
	\]
	such that
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta) = \langle p_1^* \PD(\alpha_1) \smallsmile \cdots \smallsmile p_k^*\PD (\alpha_k) \smallsmile p_0^*\PD(\beta), \sigma_{A,g,k} \rangle
	\]
	where $p_i: M^k \times \dmspace_{g,k} \to M$ denotes the projection onto the $i$th factor and the map $p_0:M^k \times \dmspace_{g,k}\to\dmspace_{g,k}$ denotes the projection onto the last factor.
\end{axiom*}
\begin{proof}
	The polyfold GW-invariants define homomorphisms
	\[\GW_{A,g,k}: H_*(M;\Q)^{\otimes k} \otimes H_* (\dmspace_{g,k}; \Q) \to \Q.\]
	Such a homomorphism defines a cohomology class in $H^*(M^k \times \dmspace_{g,k}; \Q)$ for $*= \sum_{i=1}^k (\dim_{\R} M - \deg (\alpha_i)) + (6g-6+2k - \deg(\beta))$.
	The Poincar\'e dual of this cohomology class is the required homology class $\sigma_{A,g,k}$ of codegree $*$.

\end{proof}


\begin{axiom*}{Zero axiom}
	If $A=0,\ g=0$ then $\GW_{0,0,k} (\alpha_1,\ldots,\alpha_k;\beta) = 0$ whenever $\deg (\beta) >0$, and
	\[
		\GW_{0,0,k} (\alpha_1,\ldots,\alpha_k; [\pt])
		= \int_M \PD(\alpha_1) \wedge \cdots \wedge \PD(\alpha_k).
	\]
\end{axiom*}
\begin{proof}
	Any map $u :\Sigma \to M$ with $\delbarj u = 0$ and $u_*[\Sigma ] = 0$ must be constant.  Moreover, at all constant, genus $0$ stable curves the linearization of the Cauchy--Riemann operator is surjective (e.g., see \cite{MSbook}*{Lem.~6.7.6}).
	It therefore follows that the unperturbed GW-moduli space $\CM_{0,0,k} (J)$	is transversally cut out.
	Observe that $\CM_{0,0,k} (J) \simeq M\times \dmexp_{0,k}$; via this identification we may identify the map $ev \times \pi: \CM_{0,0,k}(J) \to M^k\times \dmlog_{0,k}$ with the map $\Delta \times \id_{\dmspace_{0,k}}: M\times \dmexp_{0,k} \to M^k \times \dmlog_{0,k}$ where $\Delta$ is the diagonal $x \mapsto (x,\ldots ,x)$.

	We may now write
	\begin{align*}
		\GW_{0,0,k} (\alpha_1,\ldots,\alpha_k; [\pt])
		 & = \int_{\CM_{0,0,k} (J) } ev^* (\PD (\alpha_1) \otimes \cdots \otimes \PD(\alpha_k)) \wedge \pi^* \PD (\beta)                                \\
		 & = \int_{M\times \dmexp_{0,k}} \Delta^* (\PD (\alpha_1) \otimes \cdots \otimes \PD(\alpha_k)) \wedge \text{id}_{\dmspace_{0,k}}^* \PD (\beta) \\
		 & = \int_{M} \PD (\alpha_1) \wedge \cdots \wedge \PD(\alpha_k) \cdot \int_{\dmexp_{0,k}} \PD (\beta).
	\end{align*}
	If $\deg(\beta)>0$ then $\deg (\PD (\beta )) < \dim (\dmexp_{0,k})$ and hence $\int_{\dmexp_{0,k}} \PD (\beta) =0$.
	On the other hand, if $\beta = [\pt]$, then $\int_{\dmexp_{0,k}} \PD [\pt] =1$.
\end{proof}

\begin{axiom*}{Symmetry axiom}
	Fix a permutation $\sigma: \{1,\ldots, k\}\to \{1,\ldots,k\}$.  Consider the permutation map $\sigma:\dmlog_{g,k}\to \dmlog_{g,k}, \ [\Sigma,j,M,D]  \mapsto [\Sigma,j,M^\sigma,D]$ where $M = \{z_1,\ldots,z_k\}$ and where $M^\sigma := \{z'_1,\ldots,z'_k\}$, $z'_i:= z_{\sigma(i)}$.
	Then
	\[
		\GW_{A,g,k} (\alpha_{\sigma(1)},\ldots,\alpha_{\sigma(k)}; \sigma_*\beta) = (-1)^{N(\sigma;\alpha_i)} \GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta)
	\]
	where $N(\sigma;\alpha_i):= \sharp 	\{	i<j \mid \sigma(i)> \sigma(j), \deg (\alpha_i)\deg(\alpha_j)\in 2\Z +1	\}	$.
\end{axiom*}
\begin{proof}
	In essence, the proof follows from the change of variables theorem~\ref{thm:change-of-variables}.

	Consider the permutation map between GW-polyfolds, $\sigma: \cZ_{A,g,k} \to \cZ_{A,g,k}$.
	As discussed in \S\ref{subsec:pulling-back-abstract-perturbations} we may pullback an abstract perturbation via this map, yielding a map between the perturbed GW-moduli spaces
	\[
		\sigma: \mathcal{S}_{A,g,k}(\sigma^* p) \to \mathcal{S}_{A,g,k}(p).
	\]

	Consider the following commutative diagram of maps:
	\[
		\begin{tikzcd}
			&  & M \\
			\mathcal{S}_{A,g,k}(\sigma^* p) \arrow[r, "\sigma"'] \arrow[d, "\pi"'] \arrow[rru, "ev_{\sigma(i)}"] & \mathcal{S}_{A,g,k}(p) \arrow[d, "\pi'"] \arrow[ru, "ev'_i"'] &  \\
			\dmlog_{g,k} \arrow[r, "\sigma"'] & \dmlog_{g,k}. &
		\end{tikzcd}
	\]

	We may then compute the GW-invariants as follows:
	\begin{align*}
		 & \GW_{A,g,k} (\alpha_{\sigma(1)},\ldots,\alpha_{\sigma(k)}; \sigma_*\beta)                                                                                                                        \\
		 & \qquad = \int_{\mathcal{S}_{A,g,k}(p)} ev_1^{'*} \PD (\alpha_{\sigma(1)}) \wedge \cdots \wedge ev_k^{'*} \PD (\alpha_{\sigma(k)}) \wedge \pi'^* \PD(\sigma_*\beta)                               \\
		 & \qquad = \int_{\mathcal{S}_{A,g,k}(\sigma^* p)} \sigma^*\left(ev_1^{'*} \PD (\alpha_{\sigma(1)}) \wedge \cdots \wedge ev_k^{'*} \PD (\alpha_{\sigma(k)}) \wedge \pi'^* \PD(\sigma_*\beta)\right) \\
		 & \qquad = \int_{\mathcal{S}_{A,g,k}(\sigma^* p)} ev_{\sigma(1)}^* \PD (\alpha_{\sigma(1)}) \wedge \cdots \wedge ev_{\sigma(k)}^* \PD (\alpha_{\sigma(k)}) \wedge \pi^* \PD(\beta)                 \\
		 & \qquad = (-1)^{N(\sigma;\alpha_i)} \int_{\mathcal{S}_{A,g,k}(\sigma^* p)} ev_{1}^* \PD (\alpha_1) \wedge \cdots \wedge ev_{k}^* \PD (\alpha_k) \wedge \pi^* \PD(\beta)                           \\
		 & \qquad = (-1)^{N(\sigma;\alpha_i)} \GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \beta).
	\end{align*}
	In the second equality, we have $\int_{\mathcal{S}_{A,g,k}(p)} \ww = \int_{\mathcal{S}_{A,g,k}(\sigma^*p)} \sigma^* \ww$ by the change of variables theorem~\ref{thm:change-of-variables}.
	In the third equality, we use commutativity of the diagram to see that $ev'_i \circ \sigma = ev_{\sigma(i)}$ hence $\sigma^* ev_i^{'*} = ev^*_{\sigma(i)}$;
	we also see that $\pi'\circ \sigma = \sigma \circ \pi$ hence $\sigma^*\pi'^* =\pi^*\sigma^*$.
	Since the map $\sigma: \dmlog_{g,k} \to \dmlog_{g,k}$ is a diffeomorphism it follows that $\sigma^* \PD (\sigma_* \beta) = \PD (\beta) $ for all $\beta\in H_*(\dmlog_{g,k}; \Q)$, and therefore
	\[
		\sigma^* \pi^{'*} \PD (\sigma_* \beta) = \pi^*\sigma^* \PD(\sigma_* \beta) = \pi^* \PD(\beta).
	\]
	In the final equality, the sign $(-1)^{N(\sigma;\alpha_i)}$ is introduced by permutation of the differential forms.
\end{proof}

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{symmetry.eps}
	\caption{Symmetry axiom}
\end{figure}

Recall from Definition~\ref{def:basic-classes} that $(A,g,k)$ is a basic if it is equal to one of the following: $(A,0,3)$, $(A,1,1)$, or $(A,g\geq 2,0)$.
Again, for such values of $g$ and $k$ we will have $\dmspace_{g,k-1} = \emptyset$ by definition.

\begin{axiom*}{Fundamental class axiom}
	Consider the fundamental classes $[M]\in H_{2n}(M;\Q)$ and $[\dmlog_{g,k}] \in H_{6g-6+2k}(\dmlog_{g,k};\Q)$.  Suppose that $A\neq 0$ and that $(A,g,k)$ is not basic.  Then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; [\dmlog_{g,k}]) = 0.
	\]

	Consider the canonical section $s_i :\dmlog_{g,k-1} \to \dmlog_{g,k}$ defined by doubling the $i$th-marked point.  Then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; s_{i*}\beta) = \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta).
	\]
\end{axiom*}
\begin{proof}
	As shown in \S\ref{subsec:pulling-back-via-ftk} we may pullback perturbations via the well-defined $k$th-marked point forgetting map $ft_k :\cZ^\text{uc}_{A,g,k} \to \cZ_{A,g,k-1}$, yielding a map between perturbed GW-moduli spaces
	\[ft_k : \cS^\text{uc}_{A,g,k} (ft_k^*p)\to \cS_{A,g,k-1}(p).\]
	By construction, the preimage of a point $[\Sigma,j,M,D,u]\in \cS_{A,g,k-1}(p)$ consists of the Riemann surface $\Sigma$ with nodes identified, i.e.,
	\[
		ft_k^{-1} ([\Sigma,j,M,D,u]) \simeq \Sigma/\sim, \quad \text{where } x_a\sim y_a \text{ for nodal pairs } \{x_a,y_a\} \in D.
	\]
	In other words, the moduli space $\cS^\text{uc}_{A,g,k}(ft_k^*p)$ is the universal curve over $\cS_{A,g,k-1}(p)$.
	In particular, it follows that given a perturbed solution in $\cS^\text{uc}_{A,g,k}(ft_k^*)$ we may move the $k$th-marked freely and still have a perturbed solution.

	Consider the first assertion, and suppose the converse, i.e.,
	\[\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; [\dmlog_{g,k}]) \neq 0.\]
	Without loss of generality, we may assume that $\cX_i\subset M$ are submanifold representatives of the homology classes $\alpha_i$.
	As noted in \S\ref{subsec:intersection-numbers} we may assume that
	$(ev\times \pi) |_{\cS_{A,g,k-1}(p)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1})$;
	since the ``submanifolds'' $M$ and $\dmexp_{g,k}$ already span their respective components it necessarily follows that
	$(ev\times \pi) |_{\cS^\text{uc}_{A,g,k}(ft_k^*p)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1} \times M \times \dmlog_{g,k})$.
	If the polyfold GW-invariant is nonzero, the intersection
	\[
		(ev \times \pi)(\cS^\text{uc}_{A,g,k}(ft_k^*(p))) \cap (\cX_1\times \cdots \times \cX_{k-1} \times M\times \dmlog_{g,k}) \neq \emptyset
	\]
	must consist of finitely many isolated points.
	However, the $k$th-marked point is unconstrained and so any intersection point can \textit{never} be isolated.
	This is a contradiction.

	We prove the second assertion.
	Intuitively, the canonical section $s_i$ forces the $k$th-marked point to lie on a component together with the $i$th-marked point; hence the constraint at the $i$th-marked point automatically constrains the $k$th-marked point.
	The map $ft_k: \cS^\text{uc}_{A,g,k} (ft_k^*p)\to \cS_{A,g,k-1}(p)$ then gives a bijection between the points of intersection.

	To elaborate, let $\cX_i\subset M$ be submanifold representatives of the homology classes $\alpha_i$, and let $\cB\subset \dmlog_{g,k-1}$ be a suborbifold representative of the homology class $\beta$.
	The canonical section $s_i$ is a smooth embedding of $\dmlog_{g,k-1}$ into $\dmlog_{g,k}$.  It follows that the homology class $s_{i*} \beta \in H_*(\dmlog_{g,k};\Q)$ is represented by the suborbifold  $s_i(\cB)\subset \dmlog_{g,k}$.
	We may perturb the suborbifold $\cB$ such that $\pi|_{\cS_{A,g,k-1}(p)} \pitchfork \cB$;
	then using the fact that $\cS^\text{uc}_{A,g,k}(ft_k^*(p))$ is the universal curve over $\cS_{A,g,k-1}(p)$ one can see that $\pi|_{\cS_{A,g,k-1}(p)} \pitchfork \cB$ implies that $\pi|_{\cS^\text{uc}_{A,g,k}(ft_k^*p)} \pitchfork s_i (\cB)$.
	We may also perturb the submanifold $\cX_1 \times \cdots \times \cX_{k-1}$ such that
	$ev|_{\pi^{-1}(\cB)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1})$ and $ev|_{\pi^{-1}(s_i(\cB))} \pitchfork(\cX_1 \times \cdots \times \cX_{k-1})$.

	It therefore follows that we have transversality with the perturbed GW-moduli spaces,
	\begin{itemize}
		\item $(ev \times \pi) |_{\cS_{A,g,k-1}(p)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1} \times \cB)$,
		\item $(ev \times \pi) |_{\cS^\text{uc}_{A,g,k}(ft_k^*(p))} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1}\times M \times s_i(\cB))$.
	\end{itemize}
	The map $ft_k$ gives a bijection between the finite intersection points; after taking into account orientation and weights the intersection numbers will be the same, hence
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_{k-1},[M]; s_{i*}\beta) = \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta).
	\]
\end{proof}

\begin{axiom*}{Divisor axiom}
	Suppose $(A,g,k)$ is not basic.
	If $\deg (\alpha_k) = 2n-2$ then
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \PD (ft_k^* \PD (\beta))) = (A\cdot \alpha_k ) \ \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta),
	\]
	where $A\cdot \alpha_k$ is given by the homological intersection product.
\end{axiom*}
\begin{proof}
	Without loss of generality, we may assume that $\cX_i\subset M$ are submanifold representatives of the homology classes $\alpha_i$ and $\cB\subset \dmlog_{g,k-1}$ is a suborbifold representative of the homology class $\beta$.
	The map $ft_k :\dmlog_{g,k} \to \dmlog_{g,k-1}$ is a submersion thus $ft_k^{-1} (\cB) \subset \dmlog_{g,k}$ is also a suborbifold and moreover $[ft_k^{-1} (\cB)]=\PD (ft_k^* \PD (\beta))$ (compare with the reasoning in the genus zero case discussed in \cite{MSbook}*{Lem.~7.5.5}).

	Without loss of generality we may assume that
	\[(ev\times \pi)|_{\cS_{A,g,k-1}(p)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1} \times \cB);\]
	the intersection consists of a finite set of perturbed solutions $[\Sigma,j,M,D,u]\in \cS_{A,g,k-1}(p)$.
	It follows that
	\[
		(ev_1\times \cdots \times ev_{k-1} \times \pi) |_{\cS^\text{uc}_{A,g,k}(ft_k^*p)} \pitchfork (\cX_1 \times \cdots \times \cX_{k-1} \times ft_k^{-1}(\cB))
	\]
	and the preimage $(ev_1\times \cdots \times ev_{k-1} \times \pi)^{-1}(\cX_1 \times \cdots \times \cX_{k-1} \times ft_k^{-1}(\cB))$ consists of the universal curves $\Sigma / \sim$ over the finite intersection points $[\Sigma,j,M,D,u]\in \cS_{A,g,k-1}(p)$.
	The evaluation map at the $k$th-marked point restricted to this preimage may be identified with the stable map considered on the universal curve, i.e.,
	\[u:\Sigma/\sim \ \to M.\]

	Let $\cX_k\subset M$ be a submanifold representative of the homology class $\alpha_k$; we may perturb $\cX_k$ so that it is transverse to the finitely many maps $u : \Sigma /\sim\  \to M$.  By the assumption $\deg (\alpha_k) = 2n-2$, the intersection will be a finite set of points.  The intersection number $u|_{\Sigma / \sim} \cdot \cX_k$ is then equal to the homological intersection product $A \cdot \alpha_k$.

	We have $(ev\times \pi)|_{\cS^\text{uc}_{A,g,k}(ft_k^*p)} \pitchfork (\cX_1\times \cdots \times \cX_k \times ft_k^{-1}(\cB))$.  The intersection of $\cX_k$ with the image of the universal curve $\Sigma / \sim$ contributes the additional factor $A \cdot \alpha_k$ over an intersection point $[\Sigma,j,M,D,u]\in \cS_{A,g,k-1}(p)$.  Therefore,
	\[
		\GW_{A,g,k} (\alpha_1,\ldots,\alpha_k; \PD (ft_k^* \PD (\beta))) = (A\cdot \alpha_k ) \ \GW_{A,g,k-1} (\alpha_1,\ldots,\alpha_{k-1};\beta).
	\]
\end{proof}

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{divisor.eps}
	\caption{Divisor axiom}
\end{figure}

Recall from the introduction that we can write the Poincar\'e dual of the diagonal $\Delta \subset M\times M$ as
$\PD([\Delta]) = \sum_\nu e_\nu \otimes e^\nu$
for a homogeneous basis $\{e_\nu \} \in H^*(M;\Q)$ with dual basis with respect to Poincar\'e duality $\{e^\nu \} \in H^*(M;\Q)$.

\begin{axiom*}{Splitting axiom}
	Fix a partition $S_0 \sqcup S_1 =\{1,\ldots, k\}$.
	Let $k_0 := \sharp S_0$, $k_1 := \sharp S_1$ and let $g_0$, $g_1 \geq 0$ such that $g = g_0 + g_1$,
	and $k_i + g_i \geq 2$ for $i=0,1$.
	Consider the natural map
	\[\phi_S : \dmspace_{k_0+1 , g_0}\times \dmspace_{k_1+1 , g_1} \to \dmspace_{g,k}\]
	which identifies the last marked point of a stable noded Riemann surface in $\dmspace_{k_0+1 , g_0}$ with the first marked point of a stable noded Riemann surface in $\dmspace_{k_1+1, g_1}$, and which maps the first $k_0$ marked points of $\dmspace_{g_0,k_0+1}$ to marked points indexed by $S_0$ and likewise maps the last $k_1$ marked points of $\dmspace_{g_1,k_1+1}$ to marked points indexed by $S_1$.
	Then
	\begin{align*}
		 & \GW_{A,g,k} (\alpha_1, \ldots, \alpha_k; \phi_{S*} (\beta_0\otimes \beta_1) ) =
		(-1)^{N(S;\alpha)} \sum_{A_0+A_1 = A}	\sum_\nu                                     \\
		 & \qquad
		\GW_{A_0,g_0,k_0+1} (\{\alpha_i\}_{i\in S_0}, \PD (e_\nu) ; \beta_0)
		\cdot
		\GW_{A_1,g_1,k_1+1} (\PD (e^\nu), \{\alpha_j\}_{j\in S_1} ; \beta_1)
	\end{align*}
	where $N(S;\alpha)=\sharp \{j<i \mid i\in S_0, j\in S_1, \deg(\alpha_i)\deg(\alpha_j)\in 2\Z +1 \}$.
\end{axiom*}
\begin{proof}
	Without loss of generality, we may assume that $S_0$ consists of the first $k_0$ points of $\{1,\ldots, k\}$ ordered linearly, and $S_1$ consists of the last $k_1$ points of $\{1,\ldots, k\}$ ordered linearly. When this is the case, $N(S;\alpha_i)=0$.
	The general case reduces to this case through the symmetry axiom by considering the permutation
	$\sigma: S_0 \sqcup S_1 \to \{1,\ldots, k\}$
	which sends $S_0$ to $\{1,\ldots,k_0\}$ and $S_1$ to $\{k_0+1,\ldots,k_0+k_1\}$ preserving the relative ordering. This moreover explains the presence of the sign correction.


	Observe that $[\Delta] = \sum_\nu \PD(e_\nu) \otimes \PD(e^\nu)$, and therefore interpreting the polyfold GW-invariants as intersection numbers we may write
	\begin{equation}
		\begin{split}
			\label{eq:split-1}
			 & \sum_\nu
			\GW_{A_0,g_0,k_0+1} (\{\alpha_i\}_{i\in S_0}, \PD (e_\nu) ; \beta_0)
			\cdot
			\GW_{A_1,g_1,k_1+1} (\PD (e^\nu), \{\alpha_j\}_{j\in S_1} ; \beta_1)                            \\
			 & \phantom{\sum_\nu}
			= (ev \times ev'\times \pi \times \pi') |_{(\cS_{A_0,g_0,k_0+1} \times \cS_{A_1,g_1,k_1+1})(p)} \\
			 & \phantom{\sum_\nu = }
			\cdot ( \{\cX_i\}_{i\in S_0}\times \Delta \times \{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1).
		\end{split}
	\end{equation}
	We consider the following inclusion and marked point identifying maps as described in \S\ref{subsec:inclusion-marked-point-identifying-maps} defined on the split GW-polyfolds of \S\ref{subsec:other-gw-polyfolds}:
	\[
		\begin{tikzcd}
			\displaystyle{\bigsqcup_{A_0+A_1 = A}} \cZ_{A_0,g_0,k_0+1} \times \cZ_{A_1,g_1,k_1+1}	&	\\
			\displaystyle{\bigsqcup_{A_0+A_1 = A}} \cZ_{A_0+A_1,S}	\arrow[u, hook, "i"] \arrow[r, "\phi_S"] & \cZ_{A,g,k}
		\end{tikzcd}
	\]
	We may pullback a perturbation via the inclusion $i: \cZ_{A_0+A_1,S} \hookrightarrow \cZ_{A_0,g_0,k_0+1} \times \cZ_{A_1,g_1,k_1+1}$; since the evaluation map is a submersion we may also assume this perturbation is chosen such that
	\[ev_{k_0+1}\times ev'_{1} : (\cS_{A_0,g_0, k_0+1} \times \cS_{A_1,g_1,k_1+1}) (p) \to M\times M\]
	is transverse to the diagonal $\Delta\subset M\times M$.

	The map $i: \cS_{A_0+A_1,S} (i^*p) \hookrightarrow (\cS_{A_0,g_0, k_0+1} \times \cS_{A_1,g_1,k_1+1}) (p)$ gives an identification of $\cS_{A_0+A_1,S} (i^*p)$ with $(ev_{k_0+1}\times ev'_{1})^{-1} (\Delta)$.
	After perturbation of the remaining representing submanifolds/suborbifolds we assert that the following intersection numbers are equal:

	\begin{equation}\label{eq:split-2}
		\begin{split}
			 & (ev \times ev'\times \pi \times \pi') |_{(\cS_{A_0,g_0,k_0+1} \times \cS_{A_1,g_1,k_1+1})(p)}           \\
			 & \qquad \cdot ( \{\cX_i\}_{i\in S_0}\times \Delta \times \{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1) \\
			 & \qquad = (ev\times \pi)|_{\cS_{A_0+A_1,S} (i^*p)}
			\cdot ( \{\cX_i\}_{i\in S_0}\times\{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1)
		\end{split}
	\end{equation}

	On the other hand, we may also pullback a perturbation via the marked point identifying maps $\sqcup \phi_S: \bigsqcup_{A_0+A_1 = A} \cZ_{A_0+A_1,S} \rightarrow \cZ_{A,g,k}$.
	We therefore consider the following commutative diagram:
	\[
		\begin{tikzcd}
			&  & M^k \\
			\displaystyle{\bigsqcup_{A_0+A_1 = A}} \cS_{A_0+A_1,S}(\phi_S^* q) \arrow[r, "\sqcup \phi_S"'] \arrow[d, "\pi"'] \arrow[rru, "ev"] & \cS_{A,g,k}(q) \arrow[d, "\pi"] \arrow[ru, "ev"'] &  \\
			\dmlog_{g_0,k_0+1}\times \dmlog_{g_1,k_1+1} \arrow[r, "\phi_S"'] & \dmlog_{g,k}. &
		\end{tikzcd}
	\]
	We may now perturb the representing submanifolds $\cX_i$ and representing suborbifolds $\cB_0$, $\cB_1$ such that
	$(ev\times \pi) |_{\cS_{A_0+A_1,S}(\phi_S^* q)} \pitchfork ( \{\cX_i\}_{i\in S_0}\times\{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1)$.
	The map $\sqcup \phi_S$ gives a restriction to the finite points of intersection
	\[\bigsqcup_{A_0+A_1 = A} (ev\times \pi)^{-1} ( \{\cX_i\}_{i\in S_0}\times\{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1) \subset \bigsqcup_{A_0+A_1 = A}\cS_{A_0+A_1,S}(\phi_S^* q)\] and
	\[(ev\times \pi)^{-1} (\cX_1 \times \cdots \times \cX_k \times \phi_s(\cB_0\times \cB_1)) \subset \cS_{A,g,k}(q).\]
	We would like to claim that this map is a bijection.
	The concern is that different decompositions $A_0+A_1 = A$, $A'_0+ A'_1 = A$ may share a common decomposition, resulting in a multiple points mapping to the same point.
	To prevent this, the representing submanifolds and representing suborbifolds should be perturbed to be transverse to all further decompositions of $A$; for dimension reasons, the intersection points with a further decomposition will then be empty.


	We must make note of an important subtlety. Due to the fact that $\pi$ is not a submersion, we can never achieve transversality of the map $ev\times \pi : \cS_{A,g,k}(q) \to M^k \times \dmlog_{g,k}$ with the suborbifold $\cX_1 \times \cdots \times \cX_k \times \phi_S(\cB_0\times \cB_1)$ through choice of perturbation $q$. %
	(Of course, we can find a representative in the same homology class of the suborbifold $\phi_S(\cB_0\times \cB_1)$ such that we \textit{will} have transversality, but then we lose the relationship between $\cB_0\times \cB_1$ and $\phi_S(\cB_0\times \cB_1)$.)

	However, even though the intersection is not transverse, the intersection does consist of a finite set of points.
	Comparing the branched integrals of the Poincar\'e duals at these finite points of intersection we obtain the equality
	\begin{equation}
		\label{eq:split-3}
		\begin{split}
			 & \sum_{A_0+A_1 = A} \int_{\cS_{A_0+A_1,S}(\phi_S^* q)} ev^* \{\PD[\cX_i]\}_{i\in S_0} \wedge ev^* \{\PD[\cX_j]\}_{j\in S_1} \wedge \pi^* \PD [\cB_0 \times \cB_1] \\
			 & \qquad = \int_{\cS_{A,g,k}(q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\phi_S(\cB_0\times \cB_1)].
		\end{split}
	\end{equation}
	Combining equations \eqref{eq:split-1}, \eqref{eq:split-2}, and \eqref{eq:split-3} we obtain
	\begin{align*}
		 & \sum_{A_0+A_1 = A}	\sum_\nu
		\GW_{A_0,g_0,k_0+1} (\{\alpha_i\}_{i\in S_0}, \PD (e_\nu) ; \beta_0)
		\cdot
		\GW_{A_1,g_1,k_1+1} (\PD (e^\nu), \{\alpha_j\}_{j\in S_1} ; \beta_1)                                                                                     \\
		 & \qquad= \sum_{A_0+A_1 = A}
		\left(
		\begin{array}{l}
				(ev \times ev'\times \pi \times \pi') |_{(\cS_{A_0,g_0,k_0+1} \times \cS_{A_1,g_1,k_1+1})(p)} \\
				\qquad\cdot ( \{\cX_i\}_{i\in S_0}\times \Delta \times \{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1)
			\end{array}
		\right)
		\\
		 & \qquad= \sum_{A_0+A_1 = A} (ev\times \pi)|_{\cS_{A_0+A_1,S} (i^*p)} \cdot ( \{\cX_i\}_{i\in S_0}\times\{\cX_j\}_{j\in S_1} \times \cB_0 \times \cB_1) \\
		 & \qquad= \sum_{A_0+A_1 = A} \int_{\cS_{A_0+A_1,S}(\phi_S^* q)}
		\left(
		\begin{array}{l}
				ev^* \{\PD[\cX_i]\}_{i\in S_0} \wedge ev^* \{\PD[\cX_j]\}_{j\in S_1} \\
				\qquad \wedge \pi^* \PD [\cB_0 \times \cB_1]
			\end{array}
		\right)
		\\
		 & \qquad= \int_{\cS_{A,g,k}(q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\phi_S(\cB_0\times \cB_1)]                   \\
		 & \qquad= \GW_{A,g,k} (\alpha_1, \ldots, \alpha_k; \phi_{S*} (\beta_0\otimes \beta_1) )
	\end{align*}

\end{proof}

\begin{axiom*}{Genus reduction axiom}
	Consider the natural map
	\[\psi: \dmspace_{g-1,k+2} \to \dmspace_{g,k}\]
	which identifies the last two marked points of a stable noded Riemann surface, increasing the arithmetic genus by one.
	Then
	\[
		2 \cdot \GW_{A,g,k} (\alpha_1, \ldots, \alpha_k; \psi_* \beta) = \sum_\nu \GW_{A,g-1,k+2} (\alpha_1,\ldots,\alpha_k, \PD (e_\nu) , \PD (e^\nu) ; \beta).
	\]
\end{axiom*}
\begin{proof}
	Again, $[\Delta]= \sum_\nu \PD(e_\nu) \otimes \PD(e^\nu)$, and therefore interpreting the polyfold GW-invariants as intersection numbers we may write
	\begin{equation}\label{eq:gr-1}
		\begin{split}
			 & \sum_\nu \GW_{A,g-1,k+2} (\alpha_1,\ldots,\alpha_k, \PD (e_\nu) , \PD (e^\nu) ; \beta)                                                           \\
			 & \qquad = (ev_1 \times \cdots \times ev_{k+2}\times \pi) |_{\cS_{A,g-1,k+2}(p)} \cdot (\cX_1\times \cdots \times \cX_k \times \Delta \times \cB).
		\end{split}
	\end{equation}
	We consider the following inclusion maps and marked point identifying maps as described in \S\ref{subsec:inclusion-marked-point-identifying-maps} defined on the genus GW-polyfolds of \S\ref{subsec:other-gw-polyfolds}:
	\[
		\begin{tikzcd}
			\cZ_{A,g-1,k+2} 		&	\\
			\cZ^\text{g}_{A,g-1,k+2}	\arrow[u, hook, "i"] \arrow[r, "\psi"] & \cZ_{A,g,k}
		\end{tikzcd}
	\]
	We may pullback a perturbation via the inclusion $i: \cZ^\text{g}_{A,g-1,k+2} \hookrightarrow \cZ_{A,g-1,k+2}$; we may also assume this perturbation is chosen such that
	\[ev_{k+1}\times ev_{k+2} : \cS_{A,g-1, k+2}(p) \to M\times M\]
	is transverse to the diagonal $\Delta\subset M\times M$.
	Consider the following commutative diagram:
	\[
		\begin{tikzcd}
			&  & M^{k} \\
			\cS^\text{g}_{A,g-1,k+2}(i^* p) \arrow[r, hook, "i"'] \arrow[d, "\pi"'] \arrow[rru, "ev"] & \cS_{A,g-1,k+2}(p) \arrow[d, "\pi"] \arrow[ru, "ev"'] &  \\
			\dmlog_{g-1,k+2} \arrow[r, "\id"'] & \dmlog_{g-1,k+2}. &
		\end{tikzcd}
	\]
	Observe that the map $i: \cS^\text{g}_{A,g-1,k+2}(i^* p) \hookrightarrow \cS_{A,g-1,k+2}(p)$ gives an identification of $\cS^\text{g}_{A,g-1,k+2}(i^*p)$ with $(ev_{k+1}\times ev_{k+2})^{-1} (\Delta)$.
	The associated intersection numbers are equal:
	\begin{equation}
		\begin{split}
			\label{eq:gr-2}
			 & (ev_1 \times \cdots \times ev_{k+2}\times \pi) |_{\cS_{A,g-1,k+2}(p)} \cdot (\cX_1\times \cdots \times \cX_k \times \Delta \times \cB)    \\
			 & \qquad =(ev_1 \times \cdots \times ev_k \times \pi)|_{\cS^\text{g}_{A,g-1,k+2}(i^*p)} \cdot (\cX_1\times \cdots \times \cX_k \times \cB).
		\end{split}
	\end{equation}

	On the other hand, we may also pullback a perturbation via the marked point identifying map $\psi: \cZ^\text{g}_{A,g-1,k+2} \to \cZ_{A,g,k}$.
	We therefore consider the following commutative diagram:
	\[
		\begin{tikzcd}
			&  & M^{k} \\
			\cS^\text{g}_{A,g-1,k+2}(\psi^* q) \arrow[r, "\psi"'] \arrow[d, "\pi"'] \arrow[rru, "ev"] & \cS_{A,g,k}(q) \arrow[d, "\pi"] \arrow[ru, "ev"'] &  \\
			\dmlog_{g-1,k+2} \arrow[r, "\psi"'] & \dmlog_{g,k}. &
		\end{tikzcd}
	\]
	We may now perturb the representing submanifolds $\cX_i$ and the representing suborbifold $\cB$ such that
	$(ev\times \pi) |_{\cS^\text{g}_{A,g-1,k+2}(\psi^* q)} \pitchfork (\cX_1 \times \cdots \times \cX_k \times \cB)$.
	The marked point identifying map $\psi$ gives a two-to-one map between the finite points of intersection
	\[(ev\times \pi)^{-1} (\cX_1 \times \cdots \times \cX_k \times \cB) \subset \cS^\text{g}_{A,g-1,k+2}(\psi^* q)\]
	and
	\[(ev\times \pi)^{-1} (\cX_1 \times \cdots \times \cX_k \times \psi(\cB)) \subset \cS_{A,g,k}(q).\]
	It is two-to-one since by exchanging the marked points $z_{k+1}$ and $z_{k+2}$ we obtain distinct stable curve solutions which map to the same stable curve after identifying these marked points, compare with the discussion in \S\ref{subsec:inclusion-marked-point-identifying-maps}.

	We again must make note of an important subtlety. Due to the fact that $\pi$ is not a submersion, we can never achieve transversality of the map $ev\times \pi : \cS_{A,g,k}(q) \to M^k \times \dmlog_{g,k}$ with the suborbifold $\cX_1 \times \cdots \times \cX_k \times \psi(\cB)$ through choice of perturbation $q$.
	(Again, we can find a representative in the same homology class of the suborbifold $\psi(\cB)$ such that we \textit{will} have transversality, but then we lose the relationship between $\cB$ and $\psi(\cB)$.)

	However, even though the intersection is not transverse, the intersection does consist of a finite set of points.
	Comparing the branched integrals of the Poincar\'e duals at these finite points of intersection we obtain the equality
	\begin{equation}
		\begin{split}
			\label{eq:gr-3}
			 & \int_{\cS^\text{g}_{A,g-1,k+2}(\psi^* q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\cB]
			\\
			 & \qquad= 2 \cdot \int_{\cS_{A,g,k}(q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\psi(\cB)].
		\end{split}
	\end{equation}
	Combining equations \eqref{eq:gr-1}, \eqref{eq:gr-2}, and \eqref{eq:gr-3} we obtain
	\begin{align*}
		 & \sum_\nu \GW_{A,g-1,k+2} (\alpha_1,\ldots,\alpha_k, \PD (e_\nu) , \PD (e^\nu) ; \beta)                                                         \\
		 & \qquad =(ev_1 \times \cdots \times ev_{k+2}\times \pi) |_{\cS_{A,g-1,k+2}(p)} \cdot (\cX_1\times \cdots \times \cX_k \times \Delta \times \cB) \\
		 & \qquad =(ev_1 \times \cdots \times ev_k \times \pi)|_{\cS^\text{g}_{A,g-1,k+2}(i^*p)} \cdot (\cX_1\times \cdots \times \cX_k \times \cB)       \\
		 & \qquad =\int_{\cS^\text{g}_{A,g-1,k+2}(\psi^* q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\cB]              \\
		 & \qquad =2\cdot \int_{\cS_{A,g,k}(q)} ev_1^* \PD[\cX_1] \wedge \cdots \wedge ev_k^* \PD[\cX_k] \wedge \pi^* \PD [\psi(\cB)]                     \\
		 & \qquad =2\cdot \GW_{A,g,k}(\alpha_1,\ldots,\alpha_k; \psi_*\beta).
	\end{align*}
\end{proof}
We prove that the pseudocycle genus-zero Gromov--Witten invariants are a strict subset of the more general polyfold Gromov--Witten invariants.

\section{Introduction}

In the decades since Gromov's seminal paper \cite{G}, Gromov--Witten invariants have remained a topic of lasting fascination in the symplectic geometry community.

The basic geometric idea of a GW-invariant is simple enough to grasp: given a symplectic manifold, it is the finite count of the $J$-holomorphic curves which, at a given marked point, pass through a specified submanifold of the symplectic manifold.
Due to the insights of Gromov, the space of $J$-curves can be given the structure of a compact topological space by adding additional nodal curves.
If we imagine, for a moment, that the relevant space of $J$-curves also has the structure of a \textit{compact manifold}, this finite count can be interpreted as an intersection number between the image of this compact manifold and the submanifolds of our symplectic manifold.
Thus the problem becomes: \textit{How can we give the space of $J$-curves the structure of something like a compact manifold, in particular, a space with sufficient structure for defining intersection numbers?}


If the Cauchy--Riemann section were completely transversal to the zero section, i.e., transversal when considered on all possible nodal strata of the space of $J$-curves,
then the top stratum of the space of $J$-curves would have the structure of a finite-dimensional manifold and all nodal strata would have the structure of manifolds with codimension at least $2$ relative to the top stratum.
Thus the space of $J$-curves would have the structure of a ``pseudocycle'', i.e., a space whose boundary (the nodal strata) would be \textit{invisible} from the point of view of homology.
Moreover, pseudocycles have sufficient structure for defining intersection numbers, as for dimension reasons the boundary will not contribute to the intersection number.

However, transversality of the Cauchy--Riemann section is often impossible to obtain through classical techniques, i.e., perturbation of an almost complex structure.
As a consequence, the nodal strata may have dimension larger than expected---indeed, larger than the dimension of the top stratum.
This situation is a fundamental obstacle to the rigorous definition of a GW-invariant; after all, for dimension reasons, any (nonzero) contribution to the intersection number from such a nodal stratum with large dimension would no longer be finite.

The pseudocycle approach to defining GW-invariants deals with this difficulty by imposing strict conditions on the symplectic manifold which disallows such phenomena in the nodal strata.
The ``semipositive'' condition was first introduced by McDuff in 1991 in \cite{mcduff1991symplectic}, and is specifically designed to guarantee that in the genus-zero case, the strata of nodal $J$-curves will have codimension at least $2$ relative to the dimension of the top stratum of non-noded simple $J$-curves.
Thus for semipositive symplectic manifolds, the space of genus-zero $J$-curves has the structure of a pseudocycle.
Around the end of 1993, GW-invariants for genus-zero were first rigorously defined for semipositive symplectic manifolds by Ruan--Tian in \cite{rt1995quatumcohomology}.
A complete description of the theory of pseudocycle GW-invariants is contained in \cite{MSbook}, and a detailed treatment of the theory of pseudocycles independent of symplectic geometry may be found in \cite{Z}.

The polyfold approach to defining GW-invariants is to achieve transversality of the Cauchy--Riemann section directly by means of an ``abstract perturbation''. This approach does not require any hypothesis on the symplectic manifold nor on the genus.
The resulting zero set of a perturbed Cauchy--Riemann section has a global smooth structure of a compact oriented ``weighted branched orbifold'', which is sufficient structure to define invariants.
Polyfold theory was used by Hofer--Wysocki--Zehnder in \cite{HWZGW} to give a well-defined GW-invariant for arbitrary genus and for general symplectic manifolds via the integration of differential forms.
This approach was extended by Schmaltz in \cite{schmaltz2019steenrod} to equivalently define the polyfold GW-invariants via intersection numbers.

In this paper, we show that these two approaches yield GW-invariants which are equal.

\begin{mainresult}
	For a given semipositive symplectic manifold, the pseudocycle genus-zero Gromov--Witten invariants are equal to the polyfold genus-zero Gromov--Witten invariants.
\end{mainresult}

Since the polyfold GW-invariants are also defined for general symplectic manifolds and for arbitrary genus, we have
\[
	\left\{ \begin{array}{c} \textit{pseudocycle} \\ \textit{Gromov--Witten} \\ \textit{invariants} \end{array} \right\}
	\subsetneq
	\left\{ \begin{array}{c} \textit{polyfold} \\ \textit{Gromov--Witten} \\ \textit{invariants} \end{array} \right\}.
\]

In \S\ref{sec:GW-invariants} we discuss the pseudocycle and polyfold approaches to GW\hyp{}invariants in greater detail.
In \S\ref{sec:the_abstract_comparison_thm} we prove an abstract comparison theorem which makes it possible to compare intersection numbers for pseudocycles with intersection numbers for compact oriented weighted branched orbifolds, and moreover allows us to show that the pseudocycle GW-invariants are equal to the polyfold GW-invariants in some situations.
In \S\ref{sec:pseudocycle-full-gw-invariant} we discuss the details of the complete definition of the pseudocycle GW-invariants which requires us to consider the space of $J$-curves of a graph as well as $J$-curves modeled on fixed trees.
In \S\ref{sec:polyfold_of_graphs} we show how the setup of $J$-curves of graphs modeled on fixed trees can be interpreted within polyfold theory.
In \S\ref{sec:equality_polyfold_GW_invariants} we prove that the variously defined polyfold GW-invariants are equal, thus completing the proof of our main result.
Finally in \S\ref{sec:the_mixed_GW-invariants_of_RT} we show that the mixed Gromov--Witten invariants of Ruan--Tian are equal to the correspondingly defined polyfold Gromov--Witten invariants.


\section{Gromov--Witten invariants}\label{sec:GW-invariants}

\subsection{What is a Gromov--Witten invariant?}

Let $(M,\ww)$ be a closed symplectic manifold of dimension $\dim M = 2n$, and let $J$ be a $\ww$-compatible almost complex structure.
For a spherical homology class $A\in H_2(M;\Z)$, for genus $g=0$, and for an integer $k\geq 3$, we consider the set of $J$-holomorphic curves:
\[
	\cM_{A,0,k} (J) :=
	\left\{
	\begin{array}{c}
		u: S^2 \to M \\
		\{z_1,\ldots,z_k\} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		\delbarj u = 0,
		u_* [S^2] = A, \\
		z_i \neq z_j \text{ if } i \neq j
	\end{array}
	\right\}
	\biggm/
	\text{PSL}(2,\C).
\]
Gromov proved this set has a natural compactification in \cite{G}, which was later refined into the stable map compactification of Kontsevich in \cite{Kstable}, and thus we may also consider its \text{compactification}, the \textbf{Gromov--Witten moduli space}:
\[
	\CM_{A,0,k} (J) := \cM_{A,0,k} (J) \sqcup \{\text{stable nodal $J$-holomorphic curves}\}.
\]
We seek to use this space to construct invariants of the symplectic manifold $M$.
To this end, we define the \textbf{evaluation map} which evaluates a stable curve on each marked point:
\[
	ev: \CM_{A,0, k} (J) \to M\times \cdots \times M.
\]
On the top stratum of non-noded stable $J$-holomorphic curves it is given by
\[
	ev\left([(u,z_1,\ldots,z_k)] \right): = (u(z_1),\ldots, u(z_k)).
\]

We also consider the \textbf{Grothendieck--Knudsen space}, the natural compactification of the space of configurations of $k$-marked points on a sphere modulo biholomorphic equivalence:
\[
	\dmspace_{0,k} := \overline{\{ \{z_1,\ldots,z_k\}\in S^2 \mid z_i\neq z_j \text{ if } i \neq j\} / \text{PSL}(2;\C) }.
\]
It is the special case for genus $g=0$ of the more general Deligne--Mumford spaces $\dmspace_{g,k}$.
In contrast to the Deligne--Mumford spaces (which are finite-dimensional oribfolds), the Grothendieck--Knudsen space is a finite\hyp{}dimensional manifold of dimension $\dim \dmspace_{0,k} = 2k-6$.
We may define a \textbf{projection map} from the GW-moduli space to the GK-space which forgets the curve which maps to $M$ and which stabilizes the resulting unstable domain components:
\[
	\pi: \CM_{A,0,k} (J) \to \dmspace_{0,k}.
\]
On the top stratum of non-noded stable $J$-holomorphic curves it forgets the map $u$ and is given by
\[
	\pi\left([(u,z_1,\ldots,z_k)]\right) := [(z_1,\ldots,z_k)].
\]

The traditional interpretation of a \textbf{Gromov--Witten invariant} is the (supposedly) finite count of $J$-holomorphic curves which at the $i$th-marked point pass through a submanifold $\cX_i \subset M$ and whose marked point configuration is restricted by the projection map to a submanifold $\cB \subset \dmspace_{0,k}$.

Such an intersection number should depend only on the homology classes of the submanifolds, and should be independent of the almost complex structure. This count can be packaged algebraically as a homomorphism:
\[
	\GW_{A,0,k} : H_*(M;\Q)^{\otimes k} \times H_*(\dmspace_{0,k};\Q) \to \Q.
\]

A foundational problem in symplectic geometry is to actually show that such a GW-invariant is \textit{well-defined}.
Ideally, we would like to define a GW-invariant rigorously via an intersection number:
\begin{align*}
	 & \GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\cB])                                                        \\
	 & \qquad = ``(ev\times \pi) (\CM_{A,0,k} (J)) \cdot (\cX_1\times \cdots \times \cX_k \times \cB) ",
\end{align*}
or as an integral:
\begin{align*}
	 & \GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\cB]) \\
	 & \qquad = ``\int_{\CM_{A,0,k}(J)}
	ev^* (\PD [\cX_1]\wedge \cdots \wedge \PD [\cX_k]) \wedge \pi^* \PD [\cB],"
\end{align*}
or as a pairing with a (virtual) fundamental class:
\begin{align*}
	 & \GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\cB])                                                                             \\
	 & \qquad = ``\left\langle  (ev\times\pi)_* [\CM_{A,0,k}(J)], \PD [\cX_1\times\cdots\times\cX_k\times\cB] \right\rangle".
\end{align*}
Such definitions require additional structure on the GW-moduli space; an intersection number requires tangent spaces and notions of transversal intersection, an integral requires smooth partitions of unity and notions of differential forms, and a (virtual) fundamental class requires a distinguished homology class on the topological space.

However, \textit{a priori}, the GW-moduli space only has the structure of a compact topological space, and this alone is insufficient to define any of the above. More structure is needed.


\subsection{Gromov--Witten invariants via pseudocycles}

A symplectic manifold $(M^{2n},\ww)$ is called \textbf{semipositive} if, for every $A\in \pi_2(M)$,
\begin{equation} \label{eq:semipositive}
	\ww(A) >0,\ c_1(A) \geq 3-n \quad \implies \quad c_1(A) \geq 0.
\end{equation}
As we will see, the semipositive condition allows for precise control on the dimension of the nodal $J$-curve strata of the GW-moduli spaces. This precise control allows us to give the GW-moduli spaces the structure of a \textit{pseudocycle}.

\subsubsection{Geometric approach to regularization}

To begin, we recall the so-called ``geometric approach'' to regularization of the GW-moduli space. This is the approach described in full detail in \cite{MSbook}.

Consider the Banach manifold
\[
	\cB^{m,q}_{A,0,k} :=
	\left\{
	\begin{array}{c}
		u: S^2 \to M \\
		\{z_1,\ldots,z_k\} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		u\in W^{m,q},\ u_* [S^2] = A \\
		z_i \neq z_j \text{ if } i\neq j
	\end{array}
	\right\}.
\]
Let $J$ be an almost complex structure; we can then consider a bundle $\cE^{m-1,q}$ whose fiber above a point $u \in \cB^{m,q}_{A,0,k}$ is
\[
	\cE^{m-1,q}_{u} := W^{m-1,q} (S^2, \Lambda^{0,1}\otimes_J u^*TM).
\]
We view the Cauchy--Riemann operator $\delbarj := \tfrac{1}{2} (du + J \circ du \circ i)$ as a section of this bundle, i.e.,
\[
	\begin{tikzcd}
		\cE^{m-1,q} \arrow[r] & \cB^{m,q}_{A,0,k} \arrow[l, bend right, swap, "\delbarj"]
	\end{tikzcd}
\]
The linearization of this section is a Fredholm operator of index $2n+2c_1(A)+2k$.

We denote the set of $J$-holomorphic maps by
\[
	\widetilde{\cM}_{A,0,k}(J) :=
	\left\{
	\begin{array}{c}
		u: S^2 \to M \\
		\{z_1,\ldots,z_k\} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		\tfrac{1}{2} (du + J \circ du \circ i) = 0 \\
		u_* [S^2] = A, z_i \neq z_j \text{ if } i \neq j
	\end{array}
	\right\}.
\]
It is identifiable with the zero set of the Cauchy--Riemann section, i.e., $\widetilde{\cM}_{A,0,k}(J) = \delbarjinv (0)$. It carries a natural reparametrization action by the group $\text{PSL}(2;\C)$. Consistent with our prior notation, we denote the quotient by
\[
	\cM_{A,0,k}(J) = \widetilde{\cM}_{A,0,k}(J) / \text{PSL}(2;\C).
\]
A $J$-holomorphic map is called \textbf{simple} if it is not a multiple cover. We denote the set of simple $J$-holomorphic maps by $\widetilde{\cM}^*_{A,0,k}(J)$ and we denote the set of simple $J$-holomorphic curves by $\cM^*_{A,0,k}(J) := \widetilde{\cM}^*_{A,0,k}(J) / \text{PSL}(2;\C)$.

Deep insight into this setup by Gromov in \cite{G} made possible the following:
\begin{itemize}
	\item The existence of regular almost complex structures such that the \\ Cauchy--Riemann section is transverse to the zero section at all simple maps $u\in \cB^{m,q}_{A,0,k}$. Hence by the implicit function theorem the set $\widetilde{\cM}^*_{A,0,k}(J)$ is a manifold of dimension $2n+2c_1(A)+2k$. After taking the quotient by the reparametrization action the set $\cM^*_{A,0,k}(J) := \widetilde{\cM}^*_{A,0,k}(J) / \text{PSL}(2;\C)$ is a manifold of dimension $2n+2c_1(A) +2k -6$.
	\item The set $\cM_{A,0,k}(J)$ may be compactified in a natural way into $\CM_{A,0, k}(J)$ by adding additional nodal curves; this is the stable map compactification of Kontsevich.
\end{itemize}

The GW-moduli space $\CM_{A,0,k}(J)$ is therefore a compact topological space, while the subset of simple non-noded curves $\cM^*_{A,0,k}(J) \subset \CM_{A,0,k}(J)$ has the structure of a (usually noncompact) manifold.

\subsubsection{Pseudocycles}

Given a smooth manifold $M$, we say an arbitrary subset $B\subset M$ has \textbf{dimension at most} $d$, written as $\dim B \leq d$, if there exists a $d$-dimensional manifold $N$ and a smooth map $g: N \to M$ such that $B \subset g(N)$.

Given a continuous map between topological spaces, $h: A\to B$, we define the \textbf{omega limit set} of $h$ as follows:
\[	\Omega_h := \bigcap_{ \substack{K \subset A, \\ K \text{ compact}}}	\overline{h(A\setminus K)}.	\]
A point $x$ belongs to $\Omega_h$ if and only if $x$ is a limit point for a sequence $h(z_i)$ where $z_i \in A$ does not converge \cite[Exer.~6.5.2. (i)]{MSbook}.
It follows that if $h$ can be continuously extended from $A$ to a larger compact topological space $\cA$ which contains $A$, then $\Omega_h \subset h(\cA \setminus A)$.


\begin{definition}
	Let $M$ be a smooth manifold. A smooth map
	\[f: V \to M\]
	is a $d$-dimensional \textbf{pseudocycle} if $V$ is an oriented $d$-dimensional manifold $V$ such that $f(V)$ has compact closure and such that $\dim \Omega_f \leq d - 2$.
\end{definition}

A pseudocycle $f:V \to M$ and a submanifold $X \subset M$ are \textbf{transverse}, written $f \pitchfork X$, if
\[
	\Omega_f\cap X = \emptyset
\]
and for all $x \in f^{-1}(X) \subset V$
\[
	Df_x (T_xV) \oplus T_{f(x)} X = T_{f(x)} M.
\]

Observe that if $f \pitchfork X$ then $f^{-1}(X)$ is a compact set, and hence when $\dim V + \dim X = \dim M$ then $f^{-1}(X)$ is also a finite set.
Thus we have a well-defined \textbf{intersection number}
\[
	f (V) \cdot X := \sum_{x \in f^{-1}(X)} \sign(x)
\]
where $\sign(x) = \pm 1$ is positive if $Df_x (T_xV) \oplus T_{f(x)} $ has the same orientation as $T_{f(x)} M$ and negative otherwise.
As it turns out, this intersection number depends only on the homology class of the submanifold and on the cobordism class of the pseudocycle.
Due to an oft cited result by Thom \cite[Thm.~II.1]{thom1954quelques}, given a homology class in $H_*(M;\Q)$ we can find a submanifold which represents this class; we can therefore find a basis for $H_*(M;\Q)$ consisting of representing submanifolds $X_i$, and can therefore write an arbitrary homology class as $\sum_i k_i [X_i]$ for rational coefficients $k_i\in \Q$.

\begin{definition}[{\cite[\S6.5]{MSbook}}]
	Given a pseudocycle $f: V\to M$ we can define a homomorphism by evaluating the intersection number with a basis of representing submanifolds and linear extension:
	\[
		\Phi_f : H_*(M;\Q) \to \Q, \qquad \sum_i k_i [X_i] \mapsto  \sum_i k_i (f(V) \cdot X_i).
	\]
\end{definition}

\subsubsection{The evaluation map on the Gromov--Witten moduli space is a pseudocycle}

The semipositive condition ensures the following: a nodal curve will not contain negative index domain components. Thus, we can control the dimension of the strata of the nodal tree compactification.

In the following situation the GW-moduli space has the structure of a pseudocycle.

\begin{theorem}[{\cite[Thm.~6.6.1]{MSbook}}]
	Let $A\in H_2(M;\Z)$ such that
	\begin{equation}\label{eq:A_equals_mB}
		A=mB,\ c_1(B)=0 \quad \implies \quad m=1,
	\end{equation}
	for any $m\in \Z^{\geq 0}$ and $B$ a spherical homology class. Then there exists a regular almost complex structure $J$ such that the evaluation map
	\[
		ev : \cM^*_{A,0,k} (J) \to M^k
	\]
	is a pseudocycle of dimension $2n+2c_1(A)+2k -6$. Furthermore, for different choices of $J$ the resultant pseudocycles are cobordant.
\end{theorem}

In the general case, there is still the possibility of both non-noded multiple covers in the top stratum, as well as multiple covers which occur as domain components of a nodal curve in the lower strata. Moreover, we will also wish to incorporate homology classes from the GK-space. To define pseudocycle GW-invariants in full generality, additional constructions are necessary, we discuss this in \S\ref{sec:pseudocycle-full-gw-invariant}.

Assuming that \eqref{eq:A_equals_mB} holds, we may define the \textbf{pseudocycle GW\hyp{}invariant} as the homomorphism
\begin{equation}\label{eq:pseudocycle-gw-invariant}
	\text{pseudocycle-}\GW_{A,0,k} : H_* (M;\Q)^{\otimes k} \to \Q
\end{equation}
via the intersection number of the pseudocycle $ev : \cM^*_{A,0,k} (J) \to M^k$ with a basis of representing submanifolds $\cX \subset M$:
\[
	\text{pseudocycle-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]) :=
	ev({\cM^*_{A,0,k}(J)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
\]
The invariant does not depend on the choice of regular almost complex structure $J$, nor on the choice of representing basis.


\subsection{Gromov--Witten invariants via polyfold theory}

We now recall the abstract perturbation scheme of polyfold theory used to define the polyfold GW-invariants.
Fix a homology class $A\in H_2(M;\Z)$, fix the genus $g=0$, and let $k\geq 0$ be the number of marked points.
Associated to $A,g,k$ we may write the \textbf{GW-polyfold} as the set
\begin{gather*}
	\cZ_{A,0,k} :=
	\left\{
	\begin{array}{c}
		u: S^2 \to M \\
		\{z_1,\ldots,z_k\} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		u \in W^{2,3}(S^2,M), \\ u_* [S^2] = A,\\
		z_i \neq z_j \text{ if } i \neq j
	\end{array}
	\right\}
	\biggm/
	\begin{array}{c}
		\phi \in \text{PSL}(2,\C) \\
		\phi(z_i) = z'_i
	\end{array}
	\\
	\bigsqcup \ \{\text{stable nodal curves}\}.
\end{gather*}
The top stratum consists of all stable non-noded curves, as opposed to only the curves which are $J$-holomorphic.
It carries a natural second countable, paracompact, Hausdorff topology and a natural ``scale smooth'' structure.

We can define a strong polyfold bundle $\cW_{A,0,k}$ whose fiber over a stable curve consists of complex anti-linear forms. Over the top stratum of non-noded curves we can write simply
\[
	(\cW_{A,0,k})_{[(u,z_1,\ldots, z_k)]} : = W^{2,2}(S^2, \Lambda^{0,1}\otimes_J u^*TM) / \text{PSL}(2,\C).
\]
In this context we may also view the Cauchy--Riemann operator as a sc-smooth proper Fredholm section of this bundle,
\[
	\begin{tikzcd}
		\cW_{A,0,k} \arrow[r] & \cZ_{A,0,k}. \arrow[l, bend right, swap, "\delbarj"]
	\end{tikzcd}
\]
The GW-moduli space, already the quotient of groups of automorphisms and compactified with nodal $J$-holomorphic curves, then appears as the compact zero set of this section,
\[
	\CM_{A,0,k}(J) = \delbarjinv (0) \subset \cZ_{A,0,k}.
\]
\begin{theorem}[Polyfold regularization theorem, {\cite[Thm.~15.3.7, Cor.~15.3.10]{HWZbook}}]
	There exists a class of $\ssc^+$-multisections $p$ such that the perturbed multisection $\delbarj+p$ is transverse to the zero section, and thus the perturbed zero set
	\[\CM_{A,0,k}(p):=(\delbarj + p)^{-1}(0)\]
	has the structure of a compact oriented ``weighted branched orbifold''.

	Furthermore, different choices of $\ssc^+$-multisections result in perturbed zero sets which are cobordant:
	given $\ssc^+$-multisections $p_1$, $p_2$ there exists a compact oriented weighted branched orbifold $\cB$ with boundary:
	\[
		\partial \cB = -\CM_{A,0,k}(p_1) \sqcup \CM_{A,0,k}(p_2).
	\]
\end{theorem}

\subsubsection{Weighted branched orbifolds at the local level}

We don't really want to give the complete definition of a weighted branched orbifold; to describe the global smooth structure we would need to introduce the modern language of ep-groupoids, and this would take us too far afield, see the exposition in \cite{HWZbook} or \cite{schmaltz2019steenrod} for details as needed.
In order to define intersection numbers it is enough to understand weighted branched orbifolds on a local level.

A \textbf{weighted branched orbifold} is a topological space $\cS$ which can be described locally as follows.
Given a point $x\in \cS$ there exists:
\begin{itemize}
	\item a collection of open subsets $U_i \subset \R^n$ called \textbf{local branches} together with positive rational weights $w_i$, indexed by a finite set $i\in I$,
	\item an ambient open set\footnote{This set has the structure of a $\ssc$-retract.} $V$ such that the local branches are properly embedded via inclusion maps
	      $U_i \hookrightarrow V$;
	      we identify $U_i$ with its image in $V$ and so we can write without ambiguity $U_i \subset V$ and $\cup_{i\in I} U_i \subset V$,
	\item a finite group $G$ which acts on $V$ by homeomorphisms and such that $\cup_{i\in I} U_i$ is invariant under this action,
	\item a quotient map $\pi: \cup_{i\in I} U_i  \to (\cup_{i\in I} U_i) / G$ defined as usual via the group action by $G$ on $\cup_{i\in I} U_i$,
	\item a local homeomorphism
	      \[
		      \phi: (\cup_{i\in I} U_i) / G \to \cS
	      \]
	      such that $\hat{x} := (\phi\circ \pi )^{-1}(x)$ lies on every branch, i.e., $\hat{x} \in U_i$ for all $i\in I$.
\end{itemize}
Let $M$ be a manifold. A continuous map $f:\cS \to M$ is smooth if and only if the composition on every local branch $f\circ \phi \circ \pi: U_i \to M$ is smooth.

We say that $f$ is \textbf{transverse} to a submanifold $X\subset M$, written $f \pitchfork X$, if for every $x \in f^{-1} (X) \subset \cS$, and for every $\hat{x}$ on some branch $U_i$ which maps via $\phi\circ \pi$ to $x$, we require
\[D(f\circ \phi \circ \pi)_{\hat{x}} U_i \oplus T_{f(x)} X = T_{f(x)} M.\]
By \cite[Lem.~3.12]{schmaltz2019steenrod} when $\dim \cS + \dim X = \dim M$ the points $x \in f^{-1}(X)$ are isolated, and hence if $\cS$ is compact, $f^{-1}(X)$ consists of a finite set of points.

We may then define the \textbf{intersection number} as
\[
	f(\cS) \cdot X := \sum_{x \in f^{-1}(X)} \left(	\frac{1}{\sharp \bm{G}^{\textrm{eff}}(\hat{x})}\sum_{i\in I}	\sign (\hat{x}) w_i \right)
\]
where $\bm{G}^\text{non-eff} := \{	g \in \bm{G}	\mid	g (V) = V	\}$ and $\bm{G}^\text{eff} := \bm{G} / \bm{G}^\text{non-eff}$.
(It is of course possible that at a point $x \in \cS$ there is no branching and only a trivial group action; the intersection number at such a point reduces to the usual formula for an intersection number.)
As one would expect, this intersection number is independent of the cobordism class of the weighted branched orbifold.

As in the pseudocycle approach, this intersection number can be used to define a homomorphism on the rational homology $H_*(M; \Q)$ of a manifold $M$.
\begin{definition}[{\cite[Def.~3.13]{schmaltz2019steenrod}}]
	Given a smooth map on a compact oriented weighted branched orbifold $f:\cS \to M$ we can define a homomorphism via intersection numbers with submanifolds as
	\[
		\Psi_f : H_* (M;\Q) \to \Q, \qquad \sum_i k_i [X_i] \mapsto \sum_i k_i (f(\cS) \cdot X_i).
	\]
\end{definition}

\subsubsection{The polyfold GW-invariants as intersection numbers}

Although originally defined in \cite{HWZGW} in terms of the branched integration of $\ssc$-smooth differential forms, in \cite{schmaltz2019steenrod} it was proved that the polyfold GW-invariants may equivalently be defined in terms of intersection numbers.

The \textbf{polyfold GW-invariant} is the homomorphism
\begin{equation}\label{eq:polyfold-gw-invariant}
	\text{polyfold-}\GW_{A,0,k} : H_* (M;\Q)^{\otimes k} \to \Q
\end{equation}
defined via the intersection number of a weighted branched orbifold with a basis of representing submanifolds $\cX \subset M$:
\[
	\text{polyfold-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]) :=
	ev({\CM_{A,0,k}(p)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
\]
The invariant does not depend on the choice of abstract perturbation, nor on the choice of representing basis.

We will also wish to consider GW-invariants with contributions from the homology groups of the GK-space. In the polyfold case, we may do this immediately as follows. We define the \textbf{full polyfold GW-invariant} as the homomorphism
\begin{equation}\label{eq:full-polyfold-gw-invariant}
	\text{polyfold-}\GW_{A,0,k} : H_* (M;\Q)^{\otimes k} \otimes H_* (\dmspace_{0,k}; \Q) \to \Q
\end{equation}
via the intersection number of a weighted branched orbifold with a basis of representing submanifolds $\cX \subset M$ and with a basis of representing submanifolds $\cB \subset \dmspace_{0,k}$:
\begin{align*}
	 & \text{polyfold-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\cB])                                                \\
	 & \qquad :=	(ev\times \pi )({\CM_{A,0,k}(p)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
\end{align*}
The invariant does not depend on the choice of abstract perturbation, nor on the choice of representing bases. It agrees with \eqref{eq:polyfold-gw-invariant} in the case that $\cB = \dmspace_{0,k}$.


\section{The abstract comparison theorem}\label{sec:the_abstract_comparison_thm}

\subsection{Pseudocycles versus weighted branched orbifolds}

A pseudocycle has a top stratum covered by a single manifold; the dimensions of the lower strata are controllable, but there is, \textit{a priori}, no smooth structure in neighborhoods of these strata.

In contrast, weighted branched orbifolds may contain possible branching on the top stratum; the lower strata may contain orbifold singularities in addition to branching phenomena. Crucially, weighted branched orbifolds are smooth geometric spaces and the lower strata have local smooth structure everywhere; it is possible to consistently define notions of integration as in \cite{HWZint} or intersection number as in \cite{schmaltz2019steenrod}.

Pseudocycles and weighted branched orbifolds are fundamentally different geometric objects.
Equality of the pseudocycle and polyfold GW-invariants should not be taken for granted.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{fig-pseudocycle_vs_orbifold.eps}
	\caption{A pseudocycle versus a weighted branched orbifold}
\end{figure}

\subsection{Statement and proof of the abstract comparison theorem}

The pseudocycle and polyfold approach to regularization mesh together in the following description.
The Cauchy--Riemann operator defines a $\ssc$-smooth proper Fredholm section of the GW-polyfold:
\[
	\begin{tikzcd}
		\cW_{A,0,k} \arrow[r] & \cZ_{A,0,k}. \arrow[l, bend right, swap, "\delbarj"]
	\end{tikzcd}
\]
In the case $A=mB,\ c_1(B)=0 \implies m=1$, there exists an almost complex structure $J$ such that $\delbarj$ is transverse to the zero section for all simple non-noded stable curves; hence $\cM^*_{A,0,k}(J)$ is a manifold of dimension $\ind \delbarj = 2n+2c_1(A)+2k -6$. Furthermore, the image of the evaluation map restricted to the nonsimple/nodal stable curves has dimension at most $\ind \delbarj - 2$.
Abstracted, we offer the following theorem.

\begin{theorem}[Abstract comparison theorem]\label{thm:comparison-thm}
	Consider a strong polyfold bundle $\cW$ over a polyfold $\cZ$ and a $\ssc$-smooth proper Fredholm section $s$:
	\[
		\begin{tikzcd}
			\cW \arrow[r] & \cZ. \arrow[l, bend right, swap, "s"]
		\end{tikzcd}
	\]
	Denote the compact solution set as $\cM := s^{-1}(0)$.

	Let $M$ be a smooth manifold and let $f: \cZ \to M$ be a $\ssc$-smooth map.
	Suppose that there exists an open subset $\cZ^* \subset \cZ$ such that:
	\begin{itemize}
		\item $s|_{\cZ^*}\pitchfork 0$,
		\item $\dim f(\cM \setminus \cM^*) \leq \ind s -2$, where $\cM^* := \cM \cap \cZ^*$.
	\end{itemize}
	(This directly implies that there exists an open subset $\cZ^* \subset \cZ$ such that $f: \cM^* \to M$, where $\cM^* := \cM \cap \cZ^*$, is a pseudocycle of dimension $\ind s$.)

	Then, given any submanifold $X \subset M$ of dimension $\dim X = \dim M - \dim \cM^*$ there exists an abstract perturbation $p$ of the section $s$ such that the intersection number of the pseudocycle $f:\cM^* \to M$ with $X$ and the intersection number of the compact weighted branched orbifold $\cM(p)$ with $X$ are equal, i.e.,
	\[
		\underbrace{f(\cM^*)}_{\text{pseudocycle}} \cdot\ X
		\quad=
		\underset{\substack{  \text{compact weighted}\quad \\ \text{branched orbifold}\quad }}{f(\underbrace{\cM(p)}) \cdot X.}
	\]
\end{theorem}
\begin{proof}
	Without loss of generality, we may assume that we have perturbed $X$ so that it is transverse to $\cM^*$ and such that $X\cap f(\cM \setminus \cM^*) = \emptyset$.

	Note that $f^{-1}(X)$ and $\cM \setminus \cM^*$ are closed subsets of $\cZ$; and moreover that $f^{-1} (X)\cap (\cM \setminus \cM^*) = \emptyset$. Since polyfolds are normal topological spaces, we can find a neighborhood $\cU$ of $\cM \setminus \cM^*$ such that $f^{-1}(X) \cap \cU = \emptyset$.

	By assumption, $s$ is already transverse on the compliment of $\cU$; hence we may restrict the support of any regularizing abstract perturbation to $\cU$.
	Any possible branching/isotropy phenomena of the resulting weighted branched orbifold $\cM(p)$ will therefore be restricted to $\cU$, and moreover $\cM(p)$ and $\cM^*$ are identical outside of $\cU$. It follows that all points of intersection with $X$ must lie outside of $\cU$. Hence the points of intersection for $\cM^*$ with $X$ and $\cM(p)$ with $X$ are equal, and hence the intersection numbers for $\cM^*$ considered as a pseudocycle or $\cM(p)$ considered as a weighted branched orbifold are also equal.
\end{proof}

\begin{figure}[ht]
	\centering
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[width=\textwidth]{fig-picture_proof_1.eps}
		\caption{The preimage $f^{-1}(X)$ is disjoint from the lower dimensional strata $\mathcal{M} \setminus \mathcal{M}^*$.\\ \mbox{} \\}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[width=\textwidth]{fig-picture_proof_2.eps}
		\caption{We may find an open neighborhood $\mathcal{U}$ of the lower dimensional strata, such that the neighborhood remains disjoint from $f^{-1}(X)$.}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\includegraphics[width=\textwidth]{fig-picture_proof_3.eps}
		\caption{We may choose a regular perturbation $p$ with support contained within $\mathcal{U}$. The points of intersection of $\mathcal{M}(p)$ and $X$ are still $f^{-1}(X)$.}
	\end{subfigure}
	\caption{Picture proof of the abstract comparison theorem}
\end{figure}

We may immediately apply the abstract comparison theorem to see that for any collection of submanifolds $\cX_i \subset M$ such that $\sum_{i=1}^k (2n - \dim \cX_i) = 2n+2c_1(A)+2k -6 $ we have
\[
	\underbrace{ev(\cM^*_{A,0,k}(J))}_{\text{pseudocycle}} \cdot (\cX_1 \times \cdots \times \cX_k)
	\quad= \quad
	\underset{\substack{  \text{compact weighted} \\ \text{branched orbifold} }}{ev(\underbrace{\CM_{A,0,k}(p)})} \cdot (\cX_1 \times \cdots \times \cX_k)
\]
and thus we obtain the following corollary.

\begin{corollary}
	Let $(M,\ww)$ be a semipositive symplectic manifold.
	Let $A\in H_2(M;\Z)$ such that
	\[
		A=mB,\ c_1(B)=0 \quad \implies \quad m=1.
	\]
	for $m\in \Z^{\geq 0}$ and $B$ a spherical homology class. Then the pseudocycle \eqref{eq:pseudocycle-gw-invariant} and polyfold Gromov--Witten invariants \eqref{eq:polyfold-gw-invariant} for the class $A$ are equal,
	\[
		\text{pseudocycle-}\GW_{A,0,k} = \text{polyfold-}\GW_{A,0,k}.
	\]
\end{corollary}


\section{The pseudocycle approach to defining the full Gromov--Witten invariants}\label{sec:pseudocycle-full-gw-invariant}

In order to completely define the full GW-invariant via the pseudocycle approach, we must now deal with two problems:

\begin{problem}\label{prob:problem1}
The case $A=mB$, $c_1(B)=0$, $m >1$. In this case, it is no longer possible to control the dimension of the nonsimple non-noded elements in the GW-moduli space.
\end{problem}

\begin{problem}\label{prob:problem2}
Contributions from homology classes $B\in H_*(\dmspace_{0,k};\Q)$. In general, it is not possible to show that the map
\[
	ev \times \pi : \CM_{A,0,k} (J) \to M^k \times \dmspace_{0,k}
\]
is a pseudocycle, so the natural approach of defining the GW-invariant as an intersection number with a submanifold $\cX_1 \times \cdots \times \cX_k \times \cB$ is not possible.
\end{problem}

The pseudocycle approach deals with these problems with the following solutions:

\begin{solution}
	Allow more general perturbation of the almost complex structure. In particular, allow the almost complex structure to vary with the domain, i.e., consider families of the form $\{J_z\}_{z\in S^2}$.
\end{solution}
\begin{solution}
	Restrict the GW-moduli space to fixed tree types $T$, corresponding to submanifolds of the GK-space $\cB_T\subset \dmspace_{0,k}$ which generate the homology of $H_*(\dmspace_{0,k};\Q)$. The restriction to such a tree yields a GW-moduli space $\CM_T(J)$ identifiable with the preimage of $\cB_T$ via $\pi: \CM_{A,0,k}(J) \to \dmspace_{0,k}$, i.e., $\CM_T(J) = \pi^{-1} (\cB_T)$.
\end{solution}

\subsection{Domain dependent perturbation and graphs}\label{subsec:domain-dependent-perturbation}

Consider a smooth family $\{J_z\}_{z\in S^2}$ of $\ww$-compatible almost complex structures which depend on a point of the domain $S^2$. Solutions of the Cauchy--Riemann operator become
\begin{equation}\label{eq:domain-dependent-cr}
	\tfrac{1}{2}(du + J_z(u(z)) \circ du \circ i) = 0.
\end{equation}

It is meaningful to consider solutions to a domain dependent almost complex structure in a global setting as \textit{graphs}.
Define a product manifold and product almost complex structure as follows:
\[
	\widetilde{M} := S^2 \times M, \qquad \widetilde{J}(z,x) : = i \oplus J_z(x).
\]
We then observe that $u: S^2 \to M$ is a solution of \eqref{eq:domain-dependent-cr} if and only if its graph
\[\widetilde{u}: S^2 \to \widetilde{M},\qquad \widetilde{u}(z) :=(z,u(z))\]
is $\widetilde{J}$-holomorphic, i.e., $\delbar_{\widetilde{J}} \widetilde{u} =0$.

Let $\widetilde{A} := [S^2 \times \text{pt}] + \iota_* A \in H_2(\widetilde{M};\Z)$ where $A\in H_2(M;\Z)$ and $\iota : M \to \widetilde{M},\ x \mapsto (\text{pt},x)$.
Consider the associated GW-moduli space $\CM_{\widetilde{A},0,k} (\widetilde{J})$.
The usual proofs of transversality and compactness carry forward, even with the additional requirement that one consider almost complex structures on $\widetilde{M}$ which split with respect to the factors, i.e., are of the form $\widetilde{J}:= i \oplus J_z$.
Notice however that the expected dimension of the graph GW-moduli space $\CM_{\widetilde{A},0,k} (\widetilde{J})$ is $2n+2c_1(A) +2k$ while the expected dimension of the usual GW-moduli space $\CM_{A,0,k}(J)$ is $2n+2c_1(A)+2k -6$.
To define GW-invariants via graphs in such a way that they will also agree with the pseudocycle GW-invariants \eqref{eq:pseudocycle-gw-invariant} it is necessary to fix the first three marked points; on the top stratum we may do this directly and write
\[
	\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J})
	:=
	\left\{
	\hspace{-4pt}
	\begin{array}{c}
		\tilde{u}: S^2 \to \widetilde{M} \\
		\{z_1,\ldots,z_k\} \in S^2
	\end{array}
	\hspace{-4pt}
	\middle|
	\hspace{-4pt}
	\begin{array}{c}
		\delbar_{\widetilde{J}} \widetilde{u} = 0,\ \tilde{u}_* [S^2] = \widetilde{A}, \\
		z_i \neq z_j \text{ if } i \neq j,                                             \\
		z_1 =0, \ z_2 = 1,\ z_3 = \infty
	\end{array}
	\hspace{-4pt}
	\right\}
	\hspace{-3pt}
	\biggm/
	\hspace{-3pt}
	\text{PSL}(2,\C).
\]
Consider the map
\begin{equation}\label{eq:theta-fixes-marked-points}
	\Theta : \CM_{\widetilde{A},0,k} (\widetilde{J})\xrightarrow{ev_1\times ev_2 \times ev_3} \widetilde{M}\times \widetilde{M}\times \widetilde{M} \xrightarrow{p_1\times p_1 \times p_1} S^2 \times S^2 \times S^2.
\end{equation}
where $p_1 : \widetilde{M} = S^2 \times M \to S^2$ is the projection onto the first factor.
The natural compactification of $\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J})$ is precisely equal to the preimage of $(0,1,\infty) \in S^2\times S^2\times S^2$, i.e.,
\[
	\CM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J}) = \Theta^{-1} (0,1,\infty).
\]
Finally, observe that for a generic almost complex structure $\widetilde{J}$ the top stratum of the GW-moduli spaces will consist only of simple curves; the domain dependent perturbation generically kills the symmetry for multiple covers. In other words, generically we have $\cM_{\widetilde{A},0,k}^* (\widetilde{J}) = \cM_{\widetilde{A},0,k} (\widetilde{J})$ and $\cM_{\widetilde{A},0,k}^{*(0,1,\infty)} (\widetilde{J}) = \cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J})$.

\begin{theorem}[{\cite[Thm.~6.7.1]{MSbook}}]
	There exists a regular almost complex structure on $\widetilde{M}$ of the form $\widetilde{J}= i \oplus J_z$ such that the evaluation map
	\[
		ev:\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J}) \to M^k
	\]
	is a pseudocycle of dimension $2n+2c_1(A)+2k-6$. Furthermore, for different choices of regular almost complex structure the resultant pseudocycles are cobordant.

	Finally, in the case \eqref{eq:A_equals_mB}, i.e., \[A =mB,\ c_1(B)=0 \implies m=1\] for any $m\in \Z^{\geq 0}$, the pseudocycle $\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J})$ is cobordant to the usual GW-pseudocycle $\cM^*_{A,0,k}(J)$.
\end{theorem}

It is important to understand both the significance and reasoning behind this last statement, i.e., that these differently defined GW-pseudocycles are cobordant.
Assuming the prior hypothesis \eqref{eq:A_equals_mB}, and assuming that $J$ is regular, we may define a diffeomorphism between the top stratum of the moduli spaces (which are finite-dimensional manifolds) as follows:
\begin{align}
	\Psi: \cM^*_{A,0,k}(J) & \to \cM_{\widetilde{A},0,k}^{*(0,1,\infty)} (i\oplus J) \label{eq:inclusion-map-top-stratum-gw-moduli} \\
	[(u,z_1,\ldots,z_k)]   & \mapsto [\left((\id, u\circ \phi^{-1} ), \phi(z_1),\ldots, \phi(z_k) \right)] \nonumber
\end{align}
where $\phi :S^2 \to S^2$ is the unique M\"obius transformation such that $\phi(z_1) = 0,\ \phi(z_2) = 1,\ \phi(z_3) = \infty$.
Moreover, this map $\Psi$ commutes with the evaluation maps, thus giving an identification between these moduli spaces considered as pseudocycles.
From here, one can then choose a path between $i \oplus J$ and any regular $i\oplus J_z$ to obtain a cobordism between pseudocycles, justifying the last statement above.

Using the above theorem, we may take the previously defined pseudocycle GW-invariant \eqref{eq:pseudocycle-gw-invariant} and extend it to all spherical homology classes $A\in H_2(M;\Z)$ via the graph GW-moduli spaces by taking the intersection number of the pseudocycle $ev:\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J}) \to M^k$ with a basis of representing submanifolds $\cX \subset M$:
\begin{equation}\label{eq:pseudo-graph-gw}
	\text{pseudocycle-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]) :=
	ev(\cM_{\widetilde{A},0,k}^{(0,1,\infty)} (\widetilde{J})) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
\end{equation}

\subsection{Fixing the tree type via a submanifold of the Grothendieck--Knudsen space}\label{subsec:fixing_the_tree_type}

In order to allow for contributions to the GW-invariant from homology classes $B\in H_*(\dmspace_{0,k};\Q)$ we now define GW-invariants for fixed tree type.

Let $k\geq 3$. A \textbf{$k$-labeled tree} consists of a tree $T$ (which consists of a set of vertices $V$ and edges $E$) together with a labeling of the vertices, $\Lambda : \{1,\ldots, k\} \to V$.
A $k$-labeled tree is \textbf{stable} if each vertex $\alpha \in T$ satisfies
\[
	\# \Lambda^{-1}(\alpha) + \# \{\beta \in T \mid \alpha E \beta \} \geq 3,
\]
in other words, the number of labels on $\alpha$ and the number of edges with a vertex at $\alpha$ is at least $3$.

We can restrict the GK-space $\dmspace_{0,k}$ to the subset of stable noded Riemann surfaces which are modeled on such a stable $k$-labeled tree $T$; we denote this as $\cM_{0,T}$. The natural compactification, $\CM_{0,T}$, is a closed submanifold of $\dmspace_{0,k}$.
Keel showed that these submanifolds generate the rational homology of $\dmspace_{0,k}$.

\begin{theorem}[{\cite{keel1992intersection}}]\label{thm:homology-gk-space}
	The homology classes $[\CM_{0,T}]$ form a basis for the rational homology groups $H_*(\dmspace_{0,k};\Q)$.
\end{theorem}

We may restrict the GW-moduli space to fixed tree types as follows. Consider the projection map
\[
	\pi: \CM^{(0,1,\infty)}_{\widetilde{A},0,k}(\widetilde{J}) \to \dmspace_{0,k}
\]
and consider the preimage
\[
	\cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J}):= \pi^{-1}(\cM_{0,T}).
\]
One may check that the natural Gromov compactification of this moduli space, $\CM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J})$, is compatible with compactification of $\CM_{0,T}$ via the projection map in the sense that $\CM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J})= \pi^{-1}(\CM_{0,T})$.
We call $\CM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J})$ the \textbf{GW-moduli space of stable curves modeled on a stable $k$-labeled tree $T$}.

\begin{theorem}[{\cite[Thm.~6.7.11]{MSbook}}]\label{thm:tree-pseudocycle}
	There exists a regular almost complex structure of the form $\widetilde{J}=i\oplus J_z$ such that the evaluation map
	\[
		ev: \cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J}) \to M^k
	\]
	is a pseudocycle of dimension $2n+2c_1(A)+2k -6 - 2e(T)$, where $e(T)$ is the number of edges of the tree $T$. Furthermore, for different choices of $\widetilde{J}$ the resultant pseudocycles are cobordant.
\end{theorem}

Combining theorems~\ref{thm:homology-gk-space} and \ref{thm:tree-pseudocycle} we may define the \textbf{full pseudocycle GW-invariant} as the homomorphism
\begin{equation}\label{eq:full-pseudo-gw-invariant}
	\text{pseudocycle-}\GW_{A,0,k} : H_* (M;\Q)^{\otimes k} \otimes H_* (\dmspace_{0,k}; \Q) \to \Q
\end{equation}
by considering a basis of representing submanifolds $\cB_T \subset \dmspace_{0,k}$ of fixed tree type, and then evaluating the intersection number of the pseudocycle $ev : \cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J}) \to M^k$ with a basis of representing submanifolds $\cX \subset M$:
\begin{align*}
	 & \text{pseudocycle-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]; [\cB_T])                                                                            \\
	 & \qquad :=	ev\left(\cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J})\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
\end{align*}
The invariant does not depend on the choice of regular almost complex structure $\widetilde{J}$.

The geometric meaning of this definition is essentially the same as before; the GW-invariant is the signed count of the finite points of intersection of the GW-moduli space with the submanifolds $\cX_i \subset M$ and the submanifold $\cB_T\subset \dmspace_{0,k}$.
Indeed, observe the finite sets of points of intersection are identical, i.e.,
\begin{align}
	 & (ev\times\pi)\left(\cM^{(0,1,\infty)}_{\widetilde{A},0,k} (\widetilde{J})\right) \cap \left(\cX_1 \times\cdots\times \cX_k\times \cB_T \right) \label{eq:not_a_pseudocycle} \\
	 & \qquad = ev\left(\cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J})\right) \cap \left(\cX_1 \times\cdots\times \cX_k \right) \nonumber
\end{align}
which is due to the identification
\[
	\cM^{(0,1,\infty)}_{\widetilde{A},0,k} \big|_T (\widetilde{J}) = \pi^{-1}\left(  \cM^{(0,1,\infty)}_{\widetilde{A},0,k} (\widetilde{J}) \right).
\]
However as we observed in Problem~\ref{prob:problem2}, we cannot expect that $ev \times \pi$ is a pseudocycle and hence the intersection number for the left-hand side of equation~\eqref{eq:not_a_pseudocycle} does not make sense. Restricting our moduli spaces to trees allows us to consider a situation where a pseudocycle intersection number can be defined.


\section{The Gromov--Witten polyfold of graphs of stable curves}\label{sec:polyfold_of_graphs}

In the previous section we examined the pseudocycle approach to defining the full GW-invariants.
In this section we mimic these constructions in the context of polyfold theory.

\subsection{The Gromov--Witten polyfold of graphs}

We now recast the global setup of the ``Cauchy--Riemann section as a graph'' in the language of polyfolds.
As before, we consider a product symplectic manifold with a spherical homology class
\[
	\widetilde{M} = S^2 \times M, \qquad \widetilde{A} = [S^2 \times \text{pt}] + \iota_* A \in H_2(\widetilde{M};\Z).
\]
The GW-polyfold of graphs is simply the usual GW-polyfold associated to this data, i.e.,
$\cZ_{\widetilde{A},0,k}$. For a product almost complex structure $\widetilde{J} = i \oplus J_z$ we can also define a strong polyfold bundle and use the Cauchy--Riemann operator to define a $\ssc$-smooth proper Fredholm section $\delbar_{\widetilde{J}}$ of index
\[
	\ind \delbar_{\widetilde{J}} = 2n +2c_1(A) + 2k.
\]
As in \S\ref{subsec:domain-dependent-perturbation}, we will fix the first three marked points in order to get comparable GW-invariants.
To do this, we extend the map $\Theta$ from equation~\eqref{eq:theta-fixes-marked-points} to the GW-polyfold, and so consider the composition
\[
	\hat{\Theta}: \cZ_{\widetilde{A},0,k} \xrightarrow{ev_1\times ev_2 \times ev_3} \widetilde{M}\times \widetilde{M}\times \widetilde{M} \xrightarrow{p_1\times p_1\times p_1} S^2 \times S^2 \times S^2.
\]
By \cite[Prop.~3.3]{schmaltz2019axioms}, evaluation maps on GW-moduli spaces are $\ssc$-smooth submersions; the projection to the first factor $p_1 : \widetilde{M}= S^2\times M \to S^2$ is also a smooth submersion. Therefore the map $\hat{\Theta}$ is a $\ssc$-smooth submersion.
In order to give the preimage
\begin{equation}\label{eq:GW-polyfold_with_fixed_marked_points}
	\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}: = \hat{\Theta}^{-1}(0,1,\infty)
\end{equation}
a smooth structure we may invoke a result of Filippenko, who proved a general transverse preimage theorem for polyfold theory.
Thus by \cite[Thm.~1.5]{filippenko2018constrained}, without loss of generality\footnote{Technically, to get a polyfold structure on a transverse preimage we must concern ourselves with the grading of polyfolds and must shift the levels of the polyfold up by 1. While important to be aware of such modifications to the abstract framework this does not alter our current discussion.}, we obtain a polyfold structure on $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$, which we call the \textbf{GW-polyfold of graphs with three fixed marked points}.
By this theorem, we also obtain a strong polyfold bundle over $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$ (given by the restriction to this subpolyfold) and a $\ssc$-smooth proper Fredholm section $\delbar_{\widetilde{J}}|_{\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}}$ of index
\[
	\ind \delbar_{\widetilde{J}}|_{\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}} = 2n +2c_1(A)+2k-6.
\]
After perturbation of this section, we obtain a \textbf{perturbed graph GW-moduli space} $\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)$ which has the structure of a compact oriented weighted branched orbifold.
We may then define an analogous \textbf{polyfold graph GW-invariant} via the intersection number with this perturbed graph GW-moduli space:
\begin{equation}\label{eq:polyfold-graph-gw-invariants}
	\text{polyfold-graph-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]) :=
	ev({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \right);
\end{equation}
we may allow contributions from homology classes in $\dmspace_{0,k}$ and thus consider also:
\begin{align}\label{eq:full-polyfold-graph-gw-invariants}
	 & \text{polyfold-graph-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]; [\cB])                                                                                         \\
	 & \qquad	:=	(ev\times \pi)\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB \right). \nonumber
\end{align}
We may immediately apply the abstract comparison theorem~\ref{thm:comparison-thm} to see that
\[
	\underbrace{ev(\cM^{*(0,1,\infty)}_{\widetilde{A},0,k}(\widetilde{J}))}_{\text{pseudocycle}} \cdot (\cX_1 \times \cdots \times \cX_k)
	\quad= \quad
	\underset{\substack{  \text{compact weighted} \\ \text{branched orbifold} }}{ev\big(\underbrace{\CM^{(0,1,\infty)}_{\widetilde{A},0,k}(p)}\big)} \cdot (\cX_1 \times \cdots \times \cX_k)
\]
and thus obtain the following corollary.

\begin{corollary}
	For any homology class $A\in H_2(M;\Z)$ the extended pseudocycle GW-invariants \eqref{eq:pseudo-graph-gw} and the polyfold graph GW-invariants \eqref{eq:polyfold-graph-gw-invariants} are equal.
\end{corollary}

\subsection{Fixing the tree type of the Gromov--Witten polyfold of graphs}

We now discuss how to fix the tree type of the graph GW-polyfold, mimicking the setup of \S\ref{subsec:fixing_the_tree_type}.
Given a stable $k$-labeled tree $T$, we associate the submanifold $\CM_{0,T} \subset \dmspace_{0,k}$, and consider the projection map
\[
	\pi : \cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \to \dmspace_{0,k};
\]
we may restrict the GW-polyfold to the tree $T$ by taking the preimage of $\CM_{0,T}$:
\begin{equation}\label{eq:GW-polyfold_restricted_to_tree}
	\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T := \pi^{-1} (\CM_{0,T}).
\end{equation}
Once we give this a polyfold structure, we will call this the \textbf{GW-polyfold of graphs with three fixed marked points and which is restricted to a fixed tree}.

Ideally we would give this subset a polyfold structure via the transverse preimage theorem of Filippenko as above, however this is not possible because in general the projection map is not a submersion, nor is it transverse to the submanifold $\CM_{0,T}$, see \cite[Prob.~4]{schmaltz2019axioms}. The linearization of $\pi$ vanishes on the tangent planes of the gluing parameters, while the tangent planes to the gluing parameters are also complementary to the tangent spaces of $\CM_{0,T}$. Hence we cannot in general obtain transversality without perturbing the submanifold $\CM_{0,T}$.

We may still give $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ a polyfold structure, however.
Due to the explicit structure of the submanifold $\CM_{0,T}$, one can similarly construct a polyfold structure on $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$. For example, local uniformizers may be constructed explicitly by requiring that the gluing parameters which correspond to the edges of the tree $T$ are $0$.

Another possible approach to give $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ a polyfold structure is the method used to prove \cite[\S2.3, Thm.~4.7]{schmaltz2019axioms}.
The idea is that we consider a disjoint union of polyfolds modeled on fixed trees but without any incidence relation between the vertices of an edge. We then take the preimage of the diagonal under the evaluation map, which then enforces the desired incidence relation. Moreover, this preimage will have the structure of a polyfold by the transverse preimage theorem.
Explicitly, we consider a $k$-labeled tree $\widetilde{T}$ and a decomposition of $\widetilde{A} = \sum_{\alpha \in \widetilde{T}} A_\alpha$ such that each vertex $\alpha \in T$ satisfies the usual GW-stability conditions:
\[
	\# (\text{marked points, edges at } \alpha) \geq 3 \quad \text{or} \quad \langle[\ww],A_\alpha\rangle >0.
\]
We require that after forgetting the components $A_\alpha$ and contracting unstable vertices, we obtain our original tree $T$.
To each vertex we then associate a GW-polyfold $\cZ_{A_\alpha,0,k_\alpha}$ where $k_\alpha$ is the number of labels at the vertex $\alpha$ in addition to the number of edges at the vertex $\alpha$.
We then consider the map
\[
	\prod_{\alpha E \beta} (ev_{k_\alpha} \times ev_{k_\beta}) : \bigsqcup_{\ast \in \widetilde{T}} \cZ_{A_\ast,0,k_\ast} \to  (M\times M)^{\# E}
\]
We can recover the incidence relation for the edges by taking the preimage of the diagonal $\Delta^{\#E} \subset (M\times M)^{\# E}$.
Thus,
\[
	\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T = \left(\prod_{\alpha E \beta} (ev_{k_\alpha} \times ev_{k_\beta}) \right)^{-1} \left(\Delta^{\#E}\right)
\]
As we have noted, evaluation maps are $\ssc$-smooth submersions, and hence by the transverse preimage theorem we conclude that $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ has a polyfold structure.

Either way, $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ is a polyfold, the Cauchy--Riemann operator restricted to $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ is a $\ssc$-smooth proper Fredholm section of index $2n+2c_1(A)+2k - 6 -e(T)$, and we may define polyfold graph GW-invariants for the fixed tree $T$ via the intersection number:
\begin{align}\label{eq:polyfold-graph-tree-gw-invariants}
	 & \text{polyfold-fixed-tree-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\CM_{0,T}])                                                                \\
	 & \qquad	:=	ev\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \right). \nonumber
\end{align}
Once again applying the abstract comparison theorem~\ref{thm:comparison-thm} we see that
\[
	\underbrace{ev(\cM^{(0,1,\infty)}_{\widetilde{A},0,k}\big|_T (\widetilde{J}))}_{\text{pseudocycle}} \cdot (\cX_1 \times \cdots \times \cX_k)
	= \underset{\substack{  \text{compact weighted} \\ \text{branched orbifold} }}{ev \big(\underbrace{{\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (p)}}\big)} \cdot (\cX_1 \times \cdots \times \cX_k)
\]
and thus obtain the following corollary.

\begin{corollary}
	The full pseudocycle GW-invariant \eqref{eq:full-pseudo-gw-invariant} is equal to the polyfold GW-invariant defined via fixed tree types \eqref{eq:polyfold-graph-tree-gw-invariants}.
\end{corollary}


\section{Equality of the various polyfold Gromov--Witten invariants}\label{sec:equality_polyfold_GW_invariants}

At this point, we have entered a pattern.
In order to define a GW-invariant in all situations and with contributions from the homology classes of the GK-space, the pseudocycle approach has made tweaks and modifications to the definition of a GW-invariant.
At every step, we have mimicked these modified constructions in the language of polyfold theory, and used the abstract comparison theorem to prove that a particular pseudocycle GW-invariant is equal to the corresponding modified polyfold GW-invariant.
All that remains is to unify these differing polyfold GW-invariants and show that they are all equal to the polyfold GW-invariant introduced at the beginning.

To begin, let us recall the definitions of the various GW-polyfolds we have encountered thus far.

\begin{enumerate}[label = (\Roman*)]
	\item\label{GW_polyfold_I}
	      The GW-polyfold of stable curves which map to the symplectic manifold $M$, and which are of class $A$, genus $0$, and with $k$ marked points:
	      \begin{gather*}
		      \cZ_{A,0,k} =
		      \left\{
		      \begin{array}{c}
			      u: S^2 \to M \\
			      \{z_1,\ldots,z_k\} \in S^2
		      \end{array}
		      \middle|
		      \begin{array}{c}
			      u \in W^{2,3}(S^2,M), \\ u_* [S^2] = A,\\
			      z_i \neq z_j \text{ if } i \neq j
		      \end{array}
		      \right\}
		      \biggm/
		      \begin{array}{c}
			      \phi \in \text{PSL}(2,\C) \\
			      \phi(z_i) = z'_i
		      \end{array}
		      \\
		      \bigsqcup \ \{\text{stable nodal curves}\}.
	      \end{gather*}
	      The perturbed GW-moduli space is given by
	      \[
		      \CM_{A,0,k}(p) = (\delbarj +p)^{-1}(0) \subset \cZ_{A,0,k}.
	      \]
	      The GW-invariants \eqref{eq:full-polyfold-gw-invariant} are defined as either
	      \begin{align*}
		       & \text{polyfold-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]) \\
		       & \qquad =
		      ev({\CM_{A,0,k}(p)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
	      \end{align*}
	      or with contributions from homology classes in $H_*(\dmspace_{0,k};\Q)$ as
	      \begin{align*}
		       & \text{polyfold-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\cB])                                               \\
		       & \qquad	=	(ev\times \pi )({\CM_{A,0,k}(p)}) \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB\right).
	      \end{align*}

	\item\label{GW_polyfold_II}
	      The GW-polyfold of graphs with three fixed marked points, i.e., the GW-polyfold of stable curves which map to the symplectic manifold $\widetilde{M} = S^2 \times M$, and which are of class $\widetilde{A} = [S^2 \times \text{pt}] + \iota_* A]$, genus $0$, and with $k$ marked points, where in addition we fix the first three marked points at $0,1,\infty$ via \eqref{eq:GW-polyfold_with_fixed_marked_points}:
	      \begin{gather*}
		      \cZ_{\widetilde{A},0,k}^{(0,1,\infty)} =
		      \left\{
		      \hspace{-4pt}
		      \begin{array}{c}
			      \tilde{u}: S^2 \to \widetilde{M} \\
			      \{z_1,\ldots,z_k\} \in S^2
		      \end{array}
		      \hspace{-4pt}
		      \middle|
		      \hspace{-4pt}
		      \begin{array}{c}
			      \tilde{u} \in W^{2,3}(S^2,\widetilde{M}), \\
			      \tilde{u}_* [S^2] = \widetilde{A},        \\
			      z_i \neq z_j \text{ if } i \neq j,        \\
			      z_1 = 0,\ z_2 = 1,\ z_3 = \infty
		      \end{array}
		      \hspace{-4pt}
		      \right\}
		      \hspace{-4pt}
		      \biggm/
		      \hspace{-6pt}
		      \begin{array}{c}
			      \phi \in \text{PSL}(2,\C) \\
			      \phi(z_i) = z'_i
		      \end{array}
		      \\
		      \bigsqcup \ \{\text{stable nodal curves}\}.
	      \end{gather*}
	      The perturbed GW-moduli space is given by
	      \[
		      \CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p) = \big(\delbar_{\widetilde{J}}|_{\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}} + p \big)^{-1} (0) \subset \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}
	      \]
	      for an almost complex structure of the form $\widetilde{J} = i \oplus J_z$. The GW-invariants are defined by \eqref{eq:polyfold-graph-gw-invariants} as
	      \begin{align*}
		       & \text{polyfold-graph-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k])                                                              \\
		       & \qquad	=	ev\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
	      \end{align*}
	      or by \eqref{eq:full-polyfold-graph-gw-invariants} with contributions from homology classes in $H_*(\dmspace_{0,k};\Q)$, as
	      \begin{align*}
		       & \text{polyfold-graph-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k]; [\cB])                                                                              \\
		       & \qquad	=	(ev\times \pi)\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \times \cB \right).
	      \end{align*}

	\item\label{GW_polyfold_III}
	      The GW-polyfold of graphs with three fixed marked points and which is restricted to a fixed tree, i.e., the GW-polyfold of stable curves which map to the symplectic manifold $\widetilde{M}$, and which are of class $\widetilde{A}$, genus $0$, and with $k$ marked points, where in addition we fix the first three marked points at $0,1,\infty$ via \eqref{eq:GW-polyfold_with_fixed_marked_points}, and where we restrict to a fixed tree $T$ via \eqref{eq:GW-polyfold_restricted_to_tree}:
	      \begin{gather*}
		      \cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T
		      \hspace{-3pt}
		      =
		      \hspace{-3pt}
		      \left\{
		      \hspace{-6pt}
		      \begin{array}{c}
			      \tilde{u}: S^2 \to \widetilde{M} \\
			      \{z_1,\ldots,z_k\} \in S^2
		      \end{array}
		      \hspace{-5pt}
		      \middle|
		      \hspace{-5pt}
		      \begin{array}{c}
			      \tilde{u} \in W^{2,3}(S^2,\widetilde{M}), \\
			      \tilde{u}_* [S^2] = \widetilde{A},        \\
			      z_i \neq z_j \text{ if } i \neq j,        \\
			      z_1 = 0, z_2 = 1, z_3 = \infty,           \\
			      \pi([\tilde{u},z_1,\ldots,z_k]) \in \CM_{0,T}
		      \end{array}
		      \hspace{-6pt}
		      \right\}
		      \hspace{-5pt}
		      \biggm/
		      \hspace{-8pt}
		      \begin{array}{c}
			      \phi \in \text{PSL}(2,\C) \\
			      \phi(z_i) = z'_i
		      \end{array}
		      \\
		      \bigsqcup \ \{\text{stable nodal curves}\}.
	      \end{gather*}
	      It is a subpolyfold of $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$. The perturbed GW-moduli space is given by
	      \[
		      \CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T(p) = \bigm(\delbar_{\widetilde{J}}|_{\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T} + p \bigm)^{-1} (0) \subset \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T.
	      \]
	      By considering different trees and with associated GW-polyfolds of this type, the GW-invariants are defined by \eqref{eq:polyfold-graph-tree-gw-invariants} as
	      \begin{align*}
		       & \text{polyfold-fixed-tree-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\CM_{0,T}])                                                      \\
		       & \qquad	:=	ev\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \right).
	      \end{align*}
\end{enumerate}

We prove that all of these polyfold GW-invariants are equal to the original polyfold GW-invariant \eqref{eq:full-polyfold-gw-invariant}, here corresponding to \ref{GW_polyfold_I}.
In \S\ref{subsec:naturality_of_polyfold_GW-invariants} we prove that the above invariants \ref{GW_polyfold_I} are equal to the invariants \ref{GW_polyfold_II}, and in \S\ref{subsec:submanifold_GK-space_versus_restriction_to_fixed_tree} we prove that invariants \ref{GW_polyfold_II} are equal to the invariants \ref{GW_polyfold_III}.

\subsection{Naturality of polyfold invariants for the Gromov--Witten polyfold of graphs}\label{subsec:naturality_of_polyfold_GW-invariants}

We prove that the polyfold GW-invariants \ref{GW_polyfold_I} are equal to the polyfold graph GW-invariants \ref{GW_polyfold_II}.
We have defined two distinct polyfolds which model the GW-moduli space of stable curves in slightly different ways.
To prove they are equal, we need to invoke the abstract methods of \cite{schmaltz2019naturality} concerned with showing that polyfold invariants are	\emph{natural}, and do not depend on how a moduli space is modeled.

\subsubsection{A natural inclusion map between polyfolds}
First, we need to define a natural inclusion map
\[
	I : \cZ_{A,0,k} \hookrightarrow \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}
\]
which extends the map $\Psi: \cM^*_{A,0,k}(J) \to \cM_{\widetilde{A},0,k}^{*(0,1,\infty)} (i\oplus J)$ considered in \S\ref{subsec:domain-dependent-perturbation}.
We begin by giving alternative descriptions of the GW-polyfolds from that of \cite{HWZGW} to place a greater emphasis on the tree structure of a nodal curve.
To do this, we decompose the GW-polyfold $\cZ_{A,0,k}$ into a disjoint union over GW-stable labeled trees,
\[
	\cZ_{A,0,k} = \bigsqcup_T \cZ_T.
\]
Consider a tree $T$ whose vertices are labeled by a decomposition of the homology class $A$ and by the number of marked points $k$, i.e.,
\[
	A = \sum_{\alpha\in T} A_\alpha, \qquad k = \sum_{\alpha\in T} k_\alpha
\]
where $\langle [\ww], A_\alpha \rangle \geq 0$ and $k_\alpha \geq 0$ for all $\alpha \in T$.
We say such a labeled tree is \textbf{GW-stable} if it satisfies
\[
	k_\alpha + \# \{\beta \mid \alpha E \beta\} \geq 3 \quad \text{or} \quad \langle [\ww], A_\alpha \rangle \neq 0 \quad \text{for all}\quad \alpha \in T.
\]
Given such a tree we now consider $\cZ_T$, the set stable curves and which is restricted to a fixed tree $T$ \emph{without degeneration}, defined as follows:
\begin{gather*}
	\cZ_T :=
	\left\{
	\begin{array}{c}
		u_\alpha: S^2 \to M                 \\
		\{z_1,\ldots,z_{k_\alpha}\} \in S^2 \\
		\{z_\beta\}_{\alpha E \beta} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		u_\alpha \in W^{2,3}(S^2,M),             \\ (u_\alpha)_* [S^2] = A_\alpha,\\
		u_\alpha (z_\beta) = u_\beta (z_\alpha), \\
		\text{marked, nodal pts distinct}
	\end{array}
	\right\}_{\alpha \in T}
	\biggm/
	G_T,
\end{gather*}
where $G_T$ consists of tuples $(f, \{\phi_\alpha\}_{\alpha \in T})$ where $f:T\to T$ is a tree isomorphism and $\phi_\alpha :S^2 \to S^2$ are M\"obius transformations which both preserve the marked points (with orderings) and nodal points.
Notice that the above definition of $\cZ_T$ does not contain further degeneration of a stable curve into nodal stable curves which are not modeled on the tree $T$.

We may similarly decompose the GW-polyfold of graphs with three fixed marked points $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$.
To begin, observe that any decomposition of $\widetilde{A} = [S^2 \times \text{pt}] + \iota_* A$ must be of the form
\[
	\widetilde{A} = [S^2\times \text{pt}] + \sum_{\alpha} \iota_* A_\alpha, \quad \text{where} \quad \langle [\ww], A_\alpha \rangle \geq 0,
\]
thus we consider a GW-stable labeled tree $T$ with a distinguished vertex $\Delta \in T$ labeled by $[S^2 \times \text{pt}]$ and $k_\Delta$.
Next, we distinguish by $\alpha_0,\alpha_1,\alpha_\infty \in T$ the vertices which contain the first three marked points, which we denote as $z_0,z_1,z_\infty$. (These vertices need not be distinct.)
Recall that we fix these marked points by means of the map $\Theta$; thus we must have
\begin{equation}\label{eq:constraint}
	p_1 (\tilde{u}_{\alpha_0} (z_0)) = 0, \quad p_1(\tilde{u}_{\alpha_1}(z_1)) = 1, \quad  p_1(\tilde{u}_{\alpha_\infty}(z_\infty)) = \infty.
\end{equation}
With these considerations in mind, we may write $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} = \bigsqcup_T \cZ^{(0,1,\infty)}_T$ where
\begin{align*}
	\cZ^{(0,1,\infty)}_T :=
	 & \left\{
	\begin{array}{c}
		\tilde{u}_\Delta: S^2 \to \widetilde{M} \\
		\{z_1,\ldots,z_{k_\Delta}\} \in S^2     \\
		\{z_\beta\}_{\Delta E \beta} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		\tilde{u}_\alpha \in W^{2,3}(S^2,\widetilde{M}),         \\
		(\tilde{u}_\Delta)_*[S^2] = [S^2\times \text{pt}],       \\
		\tilde{u}_\Delta (z_\beta) = \tilde{u}_\beta (z_\Delta), \\
		\text{marked, nodal pts distinct},                       \\
		\eqref{eq:constraint} \text{ if } \Delta = \alpha_0,\ \alpha_1, \text{ or } \alpha_\infty
	\end{array}
	\right\}
	\bigsqcup
	\\
	 & \left\{
	\begin{array}{c}
		\tilde{u}_\alpha: S^2 \to \widetilde{M} \\
		\{z_1,\ldots,z_{k_\alpha}\} \in S^2     \\
		\{z_\beta\}_{\alpha E \beta} \in S^2
	\end{array}
	\middle|
	\begin{array}{c}
		\tilde{u}_\alpha \in W^{2,3}(S^2,\widetilde{M}),         \\
		(\tilde{u}_\alpha)_*[S^2] = \iota_* A_\alpha,            \\
		\tilde{u}_\alpha (z_\beta) = \tilde{u}_\beta (z_\alpha), \\
		\text{marked, nodal pts distinct},                       \\
		\eqref{eq:constraint} \text{ if } \alpha = \alpha_0,\ \alpha_1, \text{ or } \alpha_\infty
	\end{array}
	\right\}_{\alpha \in T\setminus \Delta}
	\hspace{-20pt}
	\biggm/
	G_T,
\end{align*}
where $G_T$ consists of tuples $(f, \{\phi_\alpha\}_{\alpha \in T})$ where $f:T\to T$ is a tree isomorphism (which necessarily fixes the vertex $\Delta$) and $\phi_\alpha :S^2 \to S^2$ are M\"obius transformations which preserve the marked points (with orderings) and nodal points.

Having presented these decompositions, we may now turn to the problem of how to define the desired natural inclusion map.
We assert that any such inclusion map should restrict to our above decompositions, i.e., we should have a well-defined restriction $I |_{\cZ_T} : \cZ_T \hookrightarrow \cZ_T^{(0,1,\infty)}$.
To define such a restriction, we must answer the following questions:
\begin{itemize}
	\item Given a stable curve in $\cZ_T$, what node should map to the node distinguished by the vertex $\Delta \in T$ in $\cZ_T^{(0,1,\infty)}$?
	\item Given a collection of maps $u_\alpha: S^2 \to M$, $\alpha \in T$ with nodal constraints, how should one associate a collection of maps $\tilde{u}_{\beta} : S^2 \to \widetilde{M}$, $\beta \in T$ with nodal constraints which moreover fixes the first three marked points?
\end{itemize}

\subsubsection{Aside on basic graph theory}\label{subsubsec:graph-theory}
Let $T$ be a tree. Given any two vertices $\alpha, \beta \in T$ there exists a unique path between these vertices, which we denote by $[\alpha,\beta]$. The following observation is immediate.
\begin{proposition}[{\cite[Exer.~D.2.4]{MSbook}}]\label{prop:basic_graph_theory}
	Given three (not necessarily distinct) vertices on a tree, $\alpha, \beta, \gamma \in T$, the intersection of connecting paths $[\alpha,\beta] \cap [\beta,\gamma] \cap [\alpha,\gamma]$ consists of a single vertex, which we denote by $\Delta\in T$.
\end{proposition}

\begin{figure}[ht]
	\centering
	\includegraphics{fig-distinguished_vertex.eps}
	\caption{The distinguished vertex $\Delta$}
\end{figure}

We also introduce the following definition in order to decompose a tree. Given a tree $T$, fix a vertex $\delta \in T$. For every adjacent vertex $\alpha \in T$ which satisfies $\delta E \alpha$, we associate the subtree $T_\alpha$ defined by the union of all paths which start at $\delta$ and which pass through $\alpha$, i.e.,
\[
	T_\alpha := \bigcup \{[\delta, \gamma] \mid \gamma \in T, \ \alpha \in [\delta, \gamma] \}.
\]
Therefore having fixed a vertex $\delta$, we may then decompose the tree $T$ as follows:
\[
	T = \bigcup_{\{\alpha \mid \delta E\alpha \}} T_\alpha.
\]
This decomposition satisfies $T_\alpha \cap T_{\alpha'} = \delta$ for all $\alpha,\alpha'\in T$ such that $\delta E\alpha$, $\delta E \alpha'$, and $\alpha \neq \alpha'$.

\subsubsection{The inclusion map on the top stratum}

The top stratum of both GW-polyfolds corresponds to the trivial tree consisting of a single vertex, $T = \{ * \}$.
We define the inclusion map $I|_{\cZ_{*}} : \cZ_{*} \hookrightarrow \cZ_{*}^{(0,1,\infty)}$ by
\[ I([(u,z_1,\ldots,z_k)]) = [\left((\id, u\circ \phi^{-1} ), \phi(z_1),\ldots, \phi(z_k) \right)]	\]
where $\phi :S^2 \to S^2$ is the unique M\"obius transformation such that $\phi(z_1) = 0,\ \phi(z_2) = 1,\ \phi(z_3) = \infty$.
We can view this as the natural extension of the diffeomorphism \eqref{eq:inclusion-map-top-stratum-gw-moduli} considered on the unperturbed GW-moduli spaces.

\subsubsection{The inclusion map on a fixed tree}

We now define $I$ for a fixed tree in the decomposition, yielding a well-defined restriction
\[
	I|_{\cZ_T}: \cZ_T \hookrightarrow \cZ_T^{(0,1,\infty)}.
\]
Denote by $\alpha_0,\alpha_1,\alpha_\infty \in T$ the vertices which contain the first three marked points.
By Prop.~\ref{prop:basic_graph_theory} may associate a vertex $\Delta\in T$ such that  $[\alpha_0,\alpha_1] \cap [\alpha_0,\alpha_\infty] \cap [\alpha_1,\alpha_\infty] = \Delta$.
For every marked point, there are two possibilities:
\begin{enumerate}
	\item the marked point lies on the component $\Delta$, or
	\item there is a unique vertex adjacent to $\Delta$ which lies on the unique path from $\Delta$ to the marked point.
\end{enumerate}
Thus, for the first three marked points we may denote by $z_{\beta_0}, z_{\beta_1}, z_{\beta_\infty} \in S^2$ for either the marked point itself, or the nodal point associated to the vertex adjacent to $\Delta$ on the path from $\Delta$ to the marked point.

We define $I$ on the distinguished vertex $\Delta$ by:
\[
	\left\{
	\begin{array}{c}
		u_\Delta: S^2 \to M                 \\
		\{z_1,\ldots,z_{k_\Delta}\} \in S^2 \\
		\{z_\beta\}_{\Delta E\beta}\in S^2
	\end{array}
	\right\}
	\mapsto
	\left\{
	\begin{array}{c}
		(\id, u_\Delta\circ \phi^{-1}) :S^2 \to S^2\times M \\
		\{\phi(z_1),\ldots,\phi(z_{k_\Delta})\} \in S^2     \\
		\{\phi(z_\beta)\}_{\Delta E\beta}\in S^2
	\end{array}
	\right\}
\]
where $\phi :S^2 \to S^2$ is again the unique M\"obius transformation such that $\{z_{\beta_0}, z_{\beta_1}, z_{\beta_\infty} \} \mapsto \{0,1,\infty\}$.
If we decompose the tree as $T = \cup_{\{ \gamma \mid \Delta E \gamma \}} T_\gamma$, then any other vertex $\alpha$ must lie on a subtree $T_\gamma$ for some vertex $\gamma$ adjacent to $\Delta$. We define $I$ on the vertex $\alpha$ by:
\[
	\left\{
	\begin{array}{c}
		u_\alpha: S^2 \to M                 \\
		\{z_1,\ldots,z_{k_\alpha}\} \in S^2 \\
		\{z_\beta\}_{\alpha E\beta}\in S^2
	\end{array}
	\right\}
	\mapsto
	\left\{
	\begin{array}{c}
		(\phi(z_\gamma), u_\alpha) :S^2 \to S^2\times M \\
		\{z_1,\ldots,z_{k_\alpha}\} \in S^2             \\
		\{z_\beta\}_{\alpha E\beta}\in S^2
	\end{array}
	\right\}.
\]
Here $z_\gamma \in S^2$ is the nodal point associated to the vertex $\Delta$ coming from the edge relation $\Delta E \gamma$, thus satisfying $u_\Delta(z_\gamma) = u_\gamma(z_\Delta)$.

Some explanation is in order. For every vertex $\alpha$, $\alpha \neq \Delta$ on the subtree $T_\gamma$, given a map $u_\alpha$ we associate a map to the fiber $\{\phi(z_\gamma)\} \times M \subset S^2 \times M$. As a consequence, the nodal constraints are satisfied. To see this, observe that given two distinct vertices $\alpha, \beta \in T$ with $\alpha E \beta$ there are two possibilities:
\begin{enumerate}
	\item $\alpha, \beta \neq \Delta$. Then $\alpha,\ \beta$ belong to the same subtree $T_\gamma$ for some $\gamma \in T$.
	\item $\alpha = \Delta$ or $\beta = \Delta$.
\end{enumerate}
From this observe the nodal constraints in the domain imply the nodal constraints in the image:
\begin{enumerate}
	\item $u_\alpha(z_\beta) = u_\beta(z_\alpha)$ implies $(\phi(z_\gamma), u_\alpha(z_\beta)) = (\phi(z_\gamma), u_\beta(z_\alpha))$,
	\item $u_\Delta(z_\alpha) = u_\alpha(z_\Delta)$ implies $(\id, u_\Delta \circ \phi^{-1}) (\phi(z_\alpha)) = (\phi(z_\alpha), u_\alpha (z_\Delta))$.
\end{enumerate}
Finally note that by the definition of $\phi$, the subtrees which contain the first three marked points, $T_{\beta_0}, T_{\beta_1}, T_{\beta_\infty}$, all map to the fibers $\{0\} \times M, \{1\} \times M, \{\infty\} \times M$. Hence observe that the constraint \eqref{eq:constraint} is satisfied.

We have only described the inclusion map on the underlying sets of the GW-polyfolds. We assert that this map is in fact $\ssc$-smooth; this can be explicitly checked according to the usual description of a local uniformizer for the GW-polyfolds as in \cite{HWZGW}.

\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.8]{fig-map_on_graphs.eps}
	\caption{The inclusion map on a fixed tree}
\end{figure}

\subsubsection{Commutative diagrams of maps between polyfolds and naturality of polyfold invariants}

Having defined the above inclusion map, we may consider the following commutative diagrams.
\[\begin{tikzcd}
		\cW_{A,0,k} \arrow[r, hook] \arrow[d, "\delbarj \quad"'] & \cW_{\widetilde{A},0,k}^{(0,1,\infty)} \arrow[d, "\quad \delbar_{i\oplus J}"] &  \\
		\cZ_{A,0,k} \arrow[r, hook, "I"] \arrow[u, bend left] & \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}
		\arrow[u, bend right] &
	\end{tikzcd}\]
in addition to a commutative diagram:
\[\begin{tikzcd}
		&  & M^k \times \dmlog_{0,k} \\
		\cZ_{A,0,k} \arrow[r, hook, "I"'] \arrow[rru, "ev\times\pi"] & \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}
		\arrow[ru, "ev\times\pi"'] &
	\end{tikzcd}
\]
One should immediately note that $\cW_{A,0,k}$ is not the pullback bundle of $\cW_{\widetilde{A},0,k}^{(0,1,\infty)}$; it does not contain any anti-linear sections in the directions of the component $S^2$ of $S^2\times M$.

The critical hypothesis for asserting the naturality of polyfold invariants in \cite{schmaltz2019naturality} is the existence of a ``intermediary subbundle'' \cite[Def.~3.15]{schmaltz2019naturality}.

\begin{proposition}
	The strong polyfold subbundle $\cW_{TM} \subset \cW_{\widetilde{A},0,k}$ is an intermediary subbundle.
\end{proposition}
\begin{proof}
	Given a map $\tilde{u}:S^2 \to S^2\times M$ we have a splitting of complex vector bundles $\tilde{u}^*{T(S^2\times M)} = \tilde{u}^*TS^2 \oplus \tilde{u}^* TM$.
	Likewise, given a stable curve $[\tilde{u}_\alpha]\in \cZ_{\widetilde{A},0,k}$ we have a splitting of the strong polyfold bundle $\cW_{\widetilde{A},0,k} = \cW_{TS^2}\oplus \cW_{TM}$. We may decompose the fiber over the top stratum of non-noded curves as:
	\[
		(\cW_{\widetilde{A},0,k})_{[\tilde{u}]} = W^{2,2}(S^2, \Lambda^{0,1}\otimes_i \tilde{u}^* TS^2) \hspace{-2pt} \oplus \hspace{-2pt} W^{2,2}(S^2, \Lambda^{0,1}\otimes_J \tilde{u}^* TM) \hspace{-1pt}  / \hspace{-1pt} \text{PSL}(2;\C).
	\]
	The linearization of $\delbar_{i\oplus J}$ is surjective onto the first factor.
	We can therefore find a collection of vectors within $\cW_{TM}$ which span the cokernel of the linearization of $\delbar_{i\oplus J}$.
	For details on this, see furthermore \cite[pg.~173]{MSbook}.
\end{proof}

We may therefore apply \cite[Thm.~1.3]{schmaltz2019naturality}, and obtain the following theorem implying the polyfold GW-invariants \ref{GW_polyfold_I} and \ref{GW_polyfold_II} are equal.

\begin{theorem}\label{thm:GW_I_equals_GW_II}
	The polyfold GW-invariants associated to the GW-polyfolds $\cZ_{A,0,k}$ and $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$ are equal with or without contributions from homology classes in the GK-space, i.e.,
	\[
		\text{polyfold-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k]) = \text{polyfold-graph-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k]),
	\]
	or given $[\cB] \in H_*(\dmspace_{0,k};\Q)$,
	\[
		\text{polyfold-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k],[\cB]) = \text{polyfold-graph-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k],[\cB]).
	\]
\end{theorem}

\subsection{Intersection number with a submanifold in the Grothendieck--Knudsen space versus restriction to a fixed tree type}\label{subsec:submanifold_GK-space_versus_restriction_to_fixed_tree}

We prove that the polyfold graph GW-invariants \ref{GW_polyfold_II} with contributions from a homology class in the GK-space are equal to the polyfold graph GW-invariants \ref{GW_polyfold_III} restricted to a corresponding fixed tree type.

Let $T$ be a stable $k$-labeled tree. To this tree, we associate the submanifold $\CM_{0,T} \subset \dmspace_{0,k}$, in addition to the GW-polyfold of graphs restricted to the tree, $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T \subset \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$.

We have a natural inclusion map between GW-polyfolds:
\[
	\iota: 	\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T \hookrightarrow \cZ_{\widetilde{A},0,k}^{(0,1,\infty)}.
\]
Via \cite[Thm.~1.7]{schmaltz2019naturality} we may pullback an abstract perturbation and thus obtain a well-defined restriction between perturbed GW-moduli spaces:
\[
	\iota: \CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (\iota^* p) \hookrightarrow \CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p).
\]
Moreover, $\iota$ is a homeomorphism onto $\pi^{-1}(\CM_{0,T}) \subset \CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)$.
Given a collection of submanifolds $\cX_i \subset M$ we may perturb them so that they are transverse to both of these GW-moduli spaces, i.e,
\[
	ev\left( \CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (\iota^* p) \right) \pitchfork (\cX_1\times \cdots \times \cX_k),
\]
and
\[
	ev\left( \CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p) \right) \pitchfork (\cX_1\times \cdots \times \cX_k).
\]
We may observe that the map $\iota$ then gives a bijection between the following points of intersection:
\[
	\iota:ev^{-1}(\cX_1\times \cdots \times \cX_k) \xrightarrow{\sim} (ev\times \pi)^{-1}(\cX_1\times \cdots \times \cX_k\times \CM_{0,T}).
\]
If we assume that $\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (\iota^* p)$ and $\cX_1\times \cdots \times \cX_k$ are of complementary dimension in $M^k$ then due to transversality the above map is a bijection between finite sets.

Here we must make note of an important subtlety. Due to the fact that $\pi$ is not a submersion, we cannot achieve transversality of the map
\[
	ev\times \pi : \CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p) \to M^k\times \dmspace_{0,k}
\]
with the product submanifold $\cX_1\times \cdots \times \cX_k \times \CM_{0,T} \subset M^k\times \dmspace_{0,k}$ without additional perturbation of the submanifold $\CM_{0,T} \subset \dmspace_{0,k}$. However if we perturb $\CM_{0,T}$ we lose the identification of the above sets of intersection.

However, even though this intersection is not transverse, it consists of a finite set of points which counted appropriately should still give the correct intersection count. It is simple enough to make this intuition rigorous; use the equivalent definition of a polyfold GW-invariant as a branched integral; comparing the branched integrals of the Poincar\'e duals of the submanifolds at the finite intersection points via the bijection $\iota$ we see that:
\begin{align*}
	 & \text{polyfold-fixed-tree-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k];[\CM_{0,T}])                                                                  \\
	 & \qquad = 	ev\left({\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (\iota^* p)}\right) \cdot \left(\cX_1 \times\cdots\times \cX_k \right)     \\
	 & \qquad = \int_{\CM_{\widetilde{A},0,k}^{(0,1,\infty)}\big|_T (\iota^* p)} ev^* (\PD [\cX_1]\wedge \cdots \wedge \PD [\cX_k])                \\
	 & \qquad = \int_{{\CM_{\widetilde{A},0,k}^{(0,1,\infty)}(p)}} ev^* (\PD [\cX_1]\wedge \cdots \wedge \PD [\cX_k]) \wedge \pi^* \PD [\CM_{0,T}] \\
	 & \qquad = \text{polyfold-graph-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k];[\CM_{0,T}]).
\end{align*}
We have therefore proved the following.

\begin{theorem}
	The polyfold GW-invariants associated to the GW-polyfolds $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)}$ and $\cZ_{\widetilde{A},0,k}^{(0,1,\infty)} \big|_T$ are equal, i.e.,
	\begin{align*}
		 & \text{polyfold-graph-}\GW_{A,0,k} ([\cX_1],\ldots,[\cX_k];[\CM_{0,T}])              \\
		 & \qquad= \text{polyfold-fixed-tree-}\GW_{A,0,k}([\cX_1],\ldots,[\cX_k];[\CM_{0,T}]).
	\end{align*}
\end{theorem}

\section{The mixed Gromov--Witten invariants of Ruan--Tian}\label{sec:the_mixed_GW-invariants_of_RT}

As a final application, we show that the mixed GW-invariants introduced by Ruan--Tian in \cite{rt1995quatumcohomology} are also equal to the polyfold GW-invariants.

As usual, we suppose that $(M,\ww)$ is a semipositive symplectic manifold of dimension $2n$.
Fix a set of pairwise distinct marked points $\bm{x} := \{x_1,\ldots, x_k\} \in S^2$ for $k \geq 3$.
From the start, we will use domain dependent perturbations of the almost complex structure, as we wish to define invariants for multiple covers as described in Problem~\ref{prob:problem1}.
We can describe a GW-moduli space with fixed marked points directly, but it will prove helpful to instead fix the first $k$ marked points by taking a preimage.

Consider the map
\[
	\pi : \CM_{\widetilde{A},0,k+l} (\widetilde{J}) \to \dmspace_{0,k},
\]
which on the top stratum of non-noded stable $\widetilde{J}$-holomorphic curves forgets the map $\tilde{u}$ and the last $l$ marked points, i.e.,
\[
	[(\tilde{u}, y_1, \ldots, y_k, z_1, \ldots, z_l)] \mapsto [(y_1, \ldots, y_k)].
\]
The collection of fixed marked points $\bm{x}$ determines a point in the top stratum of the GK-space $[(x_1,\ldots,x_k)] \in \dmspace_{0,k}$ which we denote by $[\bm{x}]$.
We define the \textbf{GW-moduli space with $k$ fixed marked points and $l$ free marked points} by:
\[
	\CM_{\widetilde{A},0,k+l} (\bm{x}; \widetilde{J}) := \pi^{-1}([\bm{x}]) \subset \CM_{\widetilde{A},0,k+l} (\widetilde{J}).
\]
Via \cite[Thm.~6.7.11]{MSbook}, there exist regular almost complex structure on $\widetilde{M}$ of the form $\widetilde{J}=i\oplus J_z$ such that the evaluation map
\[
	ev: \cM_{\widetilde{A},0,k+l} (\bm{x}; \widetilde{J}) \to M^k \times M^l
\]
is a pseudocycle of dimension $2n + 2c_1(A) + 2l - 2k$. And as expected, different choices of regular almost complex structure and of fixed marked points yield cobordant pseudocycles.

The \textbf{pseudocycle mixed GW-invariant} is then the homomorphism
\[
	\Phi_{A,0,k,l} : H_*^{\otimes (k+l)} (M;\Q) \to \Q
\]
defined by taking the intersection number of the above pseudocycle with a basis of representing submanifolds of $M$:
\begin{align*}
	 & \Phi_{A,0,k,l} ([A_1],\ldots,[A_k],[B_1],\ldots,[B_l])                                                                                              \\
	 & \qquad = ev\left(\cM_{\widetilde{A},0,k,l} (\bm{x}; \widetilde{J})\right) \cdot ( A_1 \times \cdots \times A_k \times B_1 \times \cdots \times B_l)
\end{align*}

We now describe the polyfold analog to this setup.
Consider the map
\[
	\pi : \cZ_{\widetilde{A},0,k+l} \to \dmlog_{0,k}.
\]
Although as we have already remarked this map is not a $\ssc$-submersion, it is transverse to the point $[\bm{x}]$. Therefore by \cite[Thm.~1.5]{filippenko2018constrained} the preimage
\[
	\cZ_{\widetilde{A},0,k + l}(\bm{x}) := \pi^{-1} ([\bm{x}])
\]
has a polyfold structure. We call this polyfold the \textbf{mixed GW-polyfold}.
Applying the abstract comparison theorem~\ref{thm:comparison-thm} to the perturbed GW-moduli space associated to this polyfold we see that
\begin{align}
	 & \underbrace{ev(\cM_{\widetilde{A},0,k}(\bm{x};\widetilde{J}))}_{\text{pseudocycle}} \cdot (A_1 \times \cdots \times A_k \times B_1\times \cdots \times B_l) \label{eq:mixed_pseudocycle_polyfold} \\
	 & \qquad = \quad
	\underset{\substack{  \text{compact weighted}                                                                                                                                                        \\ \text{branched orbifold} }}{ev \big(\underbrace{{\CM_{\widetilde{A},0,k+l} (\bm{x}; p)}}\big)} \cdot (A_1 \times \cdots \times A_k \times B_1\times \cdots \times B_l). \nonumber
\end{align}

\subsection{Comparing the polyfold Gromov--Witten invariants and the polyfold mixed Gromov--Witten invariants}

Consider a map which forgets the last $l$ marked points of the GK-space, i.e.,
\[
	ft : \dmspace_{0,k+l} \to \dmspace_{0,k}.
\]
Observe that $\bm{x}$ determines a point $[(x_1,\ldots,x_k)] \in \dmspace_{0,k}$ which we denote by $[\bm{x}]$. The above map is a submersion, and hence the preimage $\CM_{0,\bm{x}} := ft^{-1}([\bm{x}])$ is a submanifold of $\dmspace_{0,k+l}$.
We will show that the polyfold mixed GW-invariants are equal to the usual polyfold GW-invariants when restricted to the homology class $[\CM_{0,\bm{x}}] \in H_*(\dmspace_{0,k+l}; \Q)$.

To show this relation, we use can a similar approach as in \S\ref{subsec:naturality_of_polyfold_GW-invariants} to define a $\ssc$-smooth inclusion
\[
	\iota : \cZ_{\widetilde{A},0,k + l}(\bm{x}) \hookrightarrow \cZ_{\widetilde{A},0,k+l}^{(0,1,\infty)}.
\]
And just as in \S\ref{subsec:naturality_of_polyfold_GW-invariants} we may decompose these GW-polyfolds into a disjoint union over trees and describe the inclusion map on each component.

Consider the composition
\begin{equation}
	\label{eq:ft_circ_pi}
	ft \circ \pi : \cZ_{\widetilde{A},0,k+l}^{(0,1,\infty)} \to \dmspace_{0,k}
\end{equation}
and observe the following: the map $\iota$ gives an identification between the polyfold $\cZ_{\widetilde{A},0,k+l}(\bm{x})$ and the preimage $(ft \circ \pi)^{-1} ([\bm{x}]) =  \pi^{-1}(\CM_{0,\bm{x}}) \subset \cZ_{\widetilde{A},0,k+l}^{(0,1,\infty)}$.

Unlike in \S\ref{subsec:submanifold_GK-space_versus_restriction_to_fixed_tree}, one may observe that the map~\eqref{eq:ft_circ_pi} is in fact transverse to the point $[\bm{x}] \in \dmspace_{0,k}$, hence also $\pi\left(\cZ_{\widetilde{A},0,k+l}^{(0,1,\infty)}\right) \pitchfork \CM_{0,\bm{x}} $.
Moreover, given a collection of submanifolds $A_i, B_j \subset M$, we assert that
\[
	ev\left(\cZ_{\widetilde{A},0,k + l}(\bm{x}) \right)\pitchfork (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l)
\]
and
\[
	(ev\times \pi)\left(\cZ_{\widetilde{A},0,k+l}^{(0,1,\infty)}\right) \pitchfork (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l \times \CM_{0,\bm{x}}).
\]
Via \cite[Prop.~3.10]{schmaltz2019steenrod} we therefore have the freedom to choose abstract perturbations which yield perturbed GW-moduli spaces which are will also be transversal to these submanifolds.
Thus we may pullback an abstract perturbation and obtain a well-defined restriction between perturbed GW-moduli spaces:
\[
	\iota : \CM_{\widetilde{A},0,k+l}(\bm{x};\iota^*p) \hookrightarrow \CM_{\widetilde{A},0,k+l}^{(0,1,\infty)}(p).
\]
such that moreover
\[
	ev\left(\CM_{\widetilde{A},0,k+l}(\bm{x};\iota^*p)\right)\pitchfork (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l)                                            \\
\]
and
\[
	(ev\times \pi)\left(\CM_{\widetilde{A},0,k+l}^{(0,1,\infty)}(p)\right) \pitchfork (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l \times \CM_{0,\bm{x}}).
\]
We may use a polyfold change of variables theorem \cite[Thm.~2.47]{schmaltz2019naturality} to conclude
\begin{align}
	 & ev\left(\CM_{\widetilde{A},0,k+l}(\bm{x};\iota^*p)\right)\cdot (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l), \label{eq:mixed_versus_graph}                          \\
	 & \qquad = (ev\times \pi)\left(\CM_{\widetilde{A},0,k+l}^{(0,1,\infty)}(p)\right) \cdot (A_1\times \cdots \times A_k\times B_1\times \cdots\times B_l \times \CM_{0,\bm{x}}). \nonumber
\end{align}
Combining equations~\eqref{eq:mixed_pseudocycle_polyfold} and \eqref{eq:mixed_versus_graph} with Theorem~\ref{thm:GW_I_equals_GW_II} we conclude:

\begin{theorem}
	Fixing a collection of marked points $\bm{x}$ corresponds to pairing with the homology class $[\CM_{0,\bm{x}}] \in H_*(\dmspace_{0,{k+l}};\Q)$.
	The pseudocycle mixed GW-invariants are related to the polyfold GW-invariants via the equation:
	\begin{align*}
		 & \Phi_{A,0,k,l} ([A_1],\ldots,[A_k],[B_1],\ldots,[B_l])                                           \\
		 & \qquad= \text{polyfold-}\GW_{A,0,k+l} ([A_1],\ldots,[A_k],[B_1],\ldots,[B_l], [\CM_{0,\bm{x}}]).
	\end{align*}
\end{theorem}

\section*{Acknowledgments}
The author thanks Benjamin Filippenko for discussions explaining his work on a general transverse preimage theorem for polyfold theory.
The author also thanks {\"O}zlem Y{\"o}nder for her help with the illustrations.
Given a compactly supported area-preserving diffeomorphism of the disk, we prove an integral formula relating the asymptotic action to the asymptotic winding number. As a corollary, we obtain a new proof of Fathi's integral formula for the Calabi homomorphism on the disk.

\section{Introduction.}

Let $\phi: \D \rightarrow \D$ be a  diffeomorphism of the disk $\D\subset \R^2$ compactly supported on the interior and preserving the standard area form $\omega_0 = dx\wedge dy$. If $\lambda$ is any primitive of $\omega_0$, we can define the \textit{action} $a_{\phi,\lambda}(z)$ of a point $z\in \D$ with respect to $\lambda$ as the value at $z$ of the unique primitive of the exact form $\phi^* \lambda - \lambda$ that vanishes near the boundary of $\D$. Equivalently, if one sees $\phi$ as the time-one map of the isotopy $\phi^t$ that is obtained by integrating the vector field coming from a compactly supported time-dependent Hamiltonian $(z,t) \mapsto H_t(z)$, the action has the expression
\[
	a_{\phi,\lambda}(z) = \int_{\{t\mapsto \phi^t(z)\}} \lambda + \int_0^1 H_t(\phi^t(z))\, dt.
\]
See Section \ref{AWCs} below for precise definitions and sign conventions. In general, the value $a_{\phi,\lambda}(z)$ depends on the choice of the primitive $\lambda$, but it is independent of $\lambda$ at fixed points of $\phi$. The integral of $a_{\phi,\lambda}$ over the disk, which we denote by
\[
	\mathcal{C}(\phi) := \int_\D a_{\lambda,\phi} \,\omega_0,
\]
is also independent of the choice of $\lambda$. The real valued function $\phi\mapsto \mathcal{C}(\phi)$ is a homomorphism on $\text{Diff}_c(\D, \omega_0)$, the group of  area-preserving diffeomorphisms of $\D$ compactly supported on the interior and is named \textit{Calabi homomorphism} after \cite{Cal}.

In this note, we define the \textit{asymptotic action} of $\phi$ as the limit
\[
	a_{\phi}^{\infty}(z) := \lim_{n\rightarrow \infty} \frac{a_{\phi^n,\lambda}(z)}{n}.
\]
Indeed, a simple application of Birkhoff's ergodic theorem implies that the above limit exists for almost every $z\in \D$ and defines a $\phi$-invariant integrable function $a_{\phi}^{\infty}$, whose integral over $\D$ coincides with the integral of $a_{\phi,\lambda}$. In particular, if $z$ is a $k$-periodic point of $\phi$, then the above limit exists and coincides with the average action of the orbit of $z$:
\[
	a_{\phi}^{\infty}(z) = \frac{1}{k} \sum_{j=0}^{k-1} a_{\phi,\lambda}(\phi^j(z)).
\]
As the notation suggests, the asymptotic action $a_{\phi}^{\infty}$ is independent of the primitive $\lambda$ and hence can be expected to capture dynamical properties of $\phi$.


If $x$ and $y$ are distinct points of $\D$, the \textit{winding number} $W_{\phi}(x,y)$ is defined as the winding number of the curve
\[
	[0,1] \mapsto \mathbb{S}^1, \qquad t\mapsto \frac{\phi^t(y)-\phi^t(x)}{\|\phi^t(y)-\phi^t(x)\|} = e^{i\theta(t)},
\]
i.e.
\[
	W_{\phi}(x,y):= \frac{\theta(1)-\theta(0)}{2\pi}.
\]
In the definition, we have used a Hamiltonian isotopy $\phi^t$ joining the identity to $\phi$, but the fact that the space $\text{Diff}_c(\D, \omega_0)$ is contractible implies that the value of $W_{\phi}(x,y)$ does not depend on the choice of the isotopy. The \textit{asymptotic winding number} of the pair $(x,y)$ can now be defined as the ergodic limit
\[
	W_{\phi}^{\infty}(x,y) := \lim_{n\rightarrow \infty} \frac{W_{\phi^n}(x,y)}{n},
\]
which again exists for almost every pair $(x,y)$ in $\D\times \D$ and defines an integrable function $W_\phi^{\infty}$ on $\D\times \D$ that is invariant under the action of $\phi\times \phi$ and whose integral over $\D\times \D$ coincides with the integral of $W_{\phi}$.  Moreover, if $x$ is a $k$-periodic point of $\phi$ then the limit defining $W_{\phi}^{\infty}(x,y)$ exists for almost every $y\in \D$.

The main result of this note is the following formula relating the asymptotic action and the asymptotic winding number.

\begin{thm}
	\label{main-thm}
	If $\phi: \D \rightarrow \D$ is a compactly supported diffeomorphism of the disk $\D$ preserving the standard area form $\omega_0=dx\wedge dy$, then the identity
	\[
		a_{\phi}^{\infty}(x) = \int_{\D} W_\phi^{\infty} (x,y) \,\omega_0(y)
	\]
	holds for every $x$ in a subset $\Omega$ of $\D$ that has full measure and contains all periodic points of $\phi$.
\end{thm}

By integrating this identity over $\Omega$, and by using the fact that the integrals of the ergodic limits $a_{\phi}^{\infty}$ and $W_{\phi}^{\infty}$ agree with those of the functions $a_{\phi,\lambda}$ and $W_{\phi}$, we obtain as an immediate corollary the following result, which is originally due to Fathi \cite{FATHI}.

\begin{cor}
	\label{cor:fathi}
	The Calabi homomorphism on $\text{Diff}_c(\D, \omega_0)$ can be expressed by the double integral
	\[
		\mathcal{C}(\phi)=\int_{\D\times\D\setminus \Delta}W_\phi(x, y) \, \omega_0(x) \wedge \omega_0(y).
	\]
\end{cor}

Other proofs of this corollary are known. In \cite{GamGhys}, Gambaudo and Ghys give two algebraic proofs of it, one of which uses the fact that every homomorphism from $\text{Diff}_c(\D, \omega_0)$ into $\R$ is a multiple of the Calabi homomorphism. The latter fact is a deep result of Banyaga, see \cite{Banyaga76}. An elementary proof of Corollary \ref{cor:fathi} using complex analysis is presented by Shelukhin in \cite{Shel}.
Our  proof of Theorem \ref{main-thm} uses elementary results about intersection numbers between curves and surfaces in dimension three.

\medskip

\paragraph{\bf Aknowledgements:} I thank Jordan Payette for thorough comments on the first version of this paper. The author is supported by the SFB/TRR 191 `Symplectic Structures in Geometry,  Algebra and Dynamics',  funded by the DFG.

\section{Action,  Winding and the Calabi homomorphism}
\label{AWCs}

Denote by $\omega_0:= dx\wedge dy$ the standard area form on $\R^2$ and by $\D\subset \R^2$ the unit disk. The symbol $ \text{Diff}_c(\D, \omega_0)$ denotes  the group of
smooth diffeomorphisms of $\D$ compactly supported on the interior and  that preserve $\omega_0$. The group $ \text{Diff}_c(\D, \omega_0)$ is contractible, see e.g. \cite{Smale59}, \cite{Banyaga}.

\subsection{Action of disk diffeomorphisms.}
Take $\phi \in \text{Diff}_c(\D, \omega_0)$ and let $\lambda$ be a smooth primitive of $\omega_0$ on $\D$. Since $\phi$ preserves $\omega_0$,  the 1-form $\phi^* \lambda - \lambda$ is closed and hence exact on $\D$.
\begin{defn}


	The {\em action} of $\phi$ with respect to $\lambda$ is the unique smooth function
	\[
		a_{\phi, \lambda} : \D \rightarrow \R
	\]
	such that
	\begin{equation}
		\label{uno}
		da_{\phi,\lambda}  = \phi^* \lambda - \lambda,
	\end{equation}
	and
	\begin{equation}
		\label{due}
		a_{\phi,\lambda} (z) = 0,
	\end{equation}
	for every $z\in \partial \D$.
\end{defn}

The existence of the function $a_{\phi,\lambda}$ satisfying (\ref{uno}) and (\ref{due}) follows from the fact that any primitive of $\phi^*\lambda-\lambda$ is constant on $\partial \D $ because $\phi_{|\partial \D}= \mathrm{id}.$

\begin{lem}
	\label{formule}
	Let $ { \phi}$ and $ {\psi}$ be elements of $\mathrm{Diff}_c(\D, \omega_0)$. Let $\lambda$ be a smooth primitive of $\omega_0$ and let $u$ be a smooth real function on $\D$. Then:
	\begin{enumerate}[(i)]
		\item $a_{ { \phi}, \lambda+du} = a_{ { \phi}, \lambda} + u\circ  \phi - u$.
		\item $a_{ {\psi}\circ  { \phi}, \lambda} = a_{ {\psi}, \lambda} \circ  \phi + a_{ { \phi},  \lambda} = a_{ {\psi}, \lambda} + a_{ { \phi}, \psi^* \lambda}$.
		\item $a_{ { \phi}^{-1}, \lambda} = - a_{ { \phi}, \lambda} \circ  \phi^{-1} = - a_{ { \phi}, ( \phi^{-1})^*\lambda}$.
	\end{enumerate}
\end{lem}

\begin{proof}
	The first claim follow from the identities
	\[
		\phi^* (\lambda + du) - (\lambda + du) = d a_{ { \phi}, \lambda} +  \phi^* (du) - du = d(a_{ { \phi}, \lambda}+u\circ  \phi - u),
	\]
	and
	\[
		a_{ { \phi}, \lambda}(z) + u( \phi(z)) - u(z)=u( \phi(z)) - u(z)=0, \qquad \forall z\in\partial\D.
	\]
	The first identity in (ii) follows from
	\[
		(\psi\circ  \phi)^* \lambda - \lambda =  \phi^*(\psi^* \lambda - \lambda) +  \phi^* \lambda - \lambda =  \phi^*(da_{ {\psi}, \lambda}) + d a_{ { \phi}, \lambda} = d ( a_{ {\psi}, \lambda} \circ  \phi + a_{ { \phi}, \lambda} ),
	\]
	and
	\[
		a_{ { \phi}, \lambda} (z) + a_{ {\psi}, \lambda} ( \phi(z))=0, \qquad  \forall z\in\partial\D.
	\]
	The second identity in (ii) follows from
	\[
		(\psi\circ  \phi)^* \lambda - \lambda =  \phi^*(\psi^* \lambda) - \psi^* \lambda + \psi^* \lambda - \lambda = d( a_{ { \phi}, \psi^* \lambda} + a_{ {\psi}, \lambda}),
	\]
	and
	\[
		\begin{split}
			a_{ {\psi}, \lambda}(z) + a_{ { \phi}, \psi^* \lambda}(z)=0,  \qquad \forall z\in\partial\D.
		\end{split}
	\]
	The two formulas in (iii) follow from those in (ii) applied to the case $ {\psi}= { \phi}^{-1}$,  because $a_{\mathrm{id}, \lambda}=0$ for every $\lambda$.
\end{proof}

\begin{rem}
	Statement (i) in the lemma above implies that the value of $a_{\phi,\lambda}(z)$ is independent of the primitive $\lambda$ if $z\in \D$ is a fixed point of $\phi$.
\end{rem}

It is convenient to read the action also in terms of  the Hamiltonian formalism. Let $H:\D\times[0,1] \rightarrow \R$,  $H_t(z)=H(z,t)$ be  a smooth time-dependent Hamiltonian that vanishes near $\partial \D \times [0,1]$. Consider  its  time-dependent Hamiltonian vector field $X_t$, which is  defined by the condition
\begin{equation}
	\label{hamilt}
	\omega_0(X_{t}, \cdot) = dH_t(\cdot).
\end{equation}
We denote by $\phi^t$ its non-autonomous flow, i.e.\ the isotopy that is defined by
\[
	\frac{d}{dt}\phi^t=X_{t}\circ \phi^t, \qquad \phi^0 = \mathrm{id}.
\]
Any $\phi$ in  $\text{Diff}_c(\D, \omega_0)$ is the time-one map $\phi=\phi^1$ of an isotopy $\phi^t$ as above, which we shall call Hamiltonian isotopy.

\begin{prop}
	If $\phi$, $\phi^t$ and $H$ are as above, then
	\begin{equation}\label{actionH}
		a_{\phi, \lambda}(z)=\int_{ \{ t\rightarrow \phi^t(z) \} }\lambda + \int_0^1 H_t(\phi^t(z))dt.
	\end{equation}
\end{prop}

\begin{proof}
	Let $\gamma:[0, 1]\rightarrow \D$ be a smooth path such that $\gamma(0)=z$ and $\gamma(1)\in \partial \D$. Define the smooth map
	\[
		\psi: [0, 1]^2 \rightarrow \D,  \qquad \psi(s, t) := \phi^t(\gamma(s)).
	\]
	We compute the integral of $\psi^*\omega_0$ on $[0, 1]^2$ in two different ways. The first computation gives us:
	\[
		\begin{split}
			\int_{[0, 1]^2} \psi^* \omega & = \int_{[0, 1]^2} \omega_0(\phi^t(\gamma(s)))\left[ \frac{\partial}{\partial s} \phi^t(\gamma(s)),  X_{t} (\phi^t(\gamma(s))) \right] \,  ds \,  dt \\ &=-  \int_{[0, 1]^2} dH_t(\phi^t(\gamma(s)))\left[ \frac{\partial}{\partial s} \phi^t(\gamma(s)) \right]\,  ds\,  dt \\ &=-  \int_0^1 \left( \int_0^1 \frac{\partial}{\partial s} H_t(\phi^t(\gamma(s)))\,  ds \right)\,  dt \\ &= - \int_0^1 \left( H_t(\phi^t(\gamma(1))) - H_t(\phi^t(z)) \right)\,  dt = \int_0^1 H_t(\phi^t(z))\,  dt.
		\end{split}
	\]
	The second computation uses Stokes' theorem and the fact that ${\phi^t}|_{\partial\D}= \mathrm{id}$:
	\[
		\begin{split}
			\int_{[0, 1]^2} \psi^* \omega_0 & = \int_{[0, 1]^2} \psi^* d\lambda = \int_{[0, 1]^2} d\psi^* \lambda = \int_{\partial [0, 1]^2} \psi^* \lambda \\ &= \int_{\gamma} \lambda + \int_{\{t\mapsto \phi^t(\gamma(1))\}} \lambda - \int_{\phi\circ \gamma} \lambda - \int_{\{t\mapsto \phi^t(z)\}}\lambda  \\ &=  - \int_{\gamma} ( \phi^* \lambda - \lambda) - \int_{\{t\mapsto \phi^t(z)\}} \lambda\\ &= - \int_{\gamma} da_{\phi, \lambda} - \int_{\{t\mapsto \phi^t(z)\}} \lambda\\ &= a_{\phi, \lambda}(z) - \int_{\{t\mapsto \phi^t(z)\}}\lambda.
		\end{split}
	\]
	The desired formula for $a_{\phi, \lambda}(z)$ follows by comparing the above two identities.

\end{proof}


\subsection{The Calabi Homomorphism.}


\begin{defn}
	The Calabi homomorphism is the map
	\[
		\mathcal{C}:\text{Diff}_c(\D, \omega_0) \rightarrow  \R
	\]
	defined by
	\[
		\mathcal{C}(\phi)=\int_{\D}a_{\phi,  \lambda}\, \omega_0.
	\]
\end{defn}

The first thing we remark is that this map is well defined, meaning that it does not depend on the choice of the primitive of $\omega_0$. This follows  from Lemma \ref{formule}(i) and the fact that $\phi$ is an area preserving diffeomorphism.

Next we should prove that it is in fact a homomorphism. This is the following:
\begin{prop}
	If $ \phi, \psi \in \text{Diff}_c(\D, \omega_0)$ then  $\mathcal{C}(\phi \circ \psi)=\mathcal{C}(\phi)+\mathcal{C}(\psi)$.
\end{prop}

\begin{proof}

	From Lemma \ref{formule}(ii) we have $$a_{\phi \circ \psi,  \lambda}=a_{\psi, \phi^*\lambda}+a_{\phi, \lambda}, $$ and  integrating on both sides we get the desired result.

\end{proof}



\begin{rem}
	We can express $\mathcal{C}(\phi)$ also in terms of a defining Hamiltonian. If $H: \D\times [0,1] \rightarrow \R$ is a time-dependent Hamiltonian vanishing near $\partial \D\times [0,1]$ such that the time-one map of the corresponding Hamiltonian isotopy is $\phi$, then $\mathcal{C}(\phi)$ is given by the formula
	\[
		\mathcal{C}({\phi}) = 2 \int_{\D \times [0,1]} H(z,t)\,  \omega_0 \wedge dt.
	\]
	The proof of this equality can found in \cite{MS}[Lemma 10.27] or with the above notation in \cite{ABHS3}[Prop 2.7] in the more general setting of Hamiltonian diffeomorphisms of $\D$ that are not necessarily compactly supported. It can be used  for instance,  to show that the Calabi homomorphism  is not continuous in the $\text{C}^0$-topology. This can be done by constructing radially defined Hamiltonians using bump functions with fixed non-zero  integral and whose time one-maps converge to the identity, as shown in \cite{GamGhys}.
\end{rem}




\subsection{Winding and Intersection numbers for disk Diffeomorphisms.} \label{wiidd}
Let $\phi\in \text{Diff}_c(\D, \omega_0)$  and let $\phi^t$ be a Hamiltonian isotopy  such that $\phi^0=\mathrm{id}$ and $\phi^1=\phi$.

\begin{defn}
	The \textit{winding number} $W_\phi(x, y)$ of a pair of distinct  points $x,y\in \D$ is the real number
	\[
		W_\phi(x, y):=\frac{{\theta}(1)-{\theta}(0)}{2\pi},
	\]
	where $\theta: [0,1] \rightarrow \R$ is a continuous function such that
	\begin{equation}\label{star}
		\frac{\phi^t(y)-\phi^t(x)}{||\phi^t(y)-\phi^t(x)||}=e^{i\theta(t)}.
	\end{equation}
\end{defn}

The value of $W_\phi(x, y)$ does not depend on the isotopy joining $\phi$ to the identity. This holds because $\text{Diff}_c(\D,\omega_0)$ is contractible and in particular any two paths joining $\phi$ to the identity are homotopic, which implies that the winding number is the same. The map $W_\phi$ is smooth and bounded on $(\D\times\D)\setminus \Delta$, where $\Delta$ denotes the diagonal $\{(x, x)|x\in \D \} $ in $\D\times\D$ (see \cite{GamGhys}).



We want to define another relevant quantity and for this we need to work with intersection numbers in dimension three.

To begin with, consider an embedded compact oriented curve $\Gamma \subset \D\times [0,1]$. If $ S \subset \D\times [0,1]$ is a compact co-oriented surface, that is, the normal bundle $\mathcal{N}S$ is oriented, then an intersection point $p\in S\cap \Gamma$ is called transverse  if  $$ T_p \Gamma \oplus T_p S=T_p (\D\times [0,1]). $$
A transverse intersection point $p$ is called positive if the orientation of $T_p\Gamma$ coincides with the orientation of $\mathcal{N}_p S$ and otherwise is called negative. Assume that $\Gamma$ is everywhere transverse to $S$. Then the set $\Gamma\cap S$ is finite and we denote by $I_+(\Gamma,S)$ the number of positive intersections and $I_-(\Gamma,S)$ the number of negative intersections. The difference of these two numbers defines the intersection number of $\Gamma$ and $S$:
\[
	I(\Gamma,S) := I_+(\Gamma,S) - I_-(\Gamma,S) \in \mathbb{Z}.
\]

Let  $\phi\in \text{Diff}_c(\D, \omega_0)$ and $\{\phi^t\}_{t\in [0, 1]}$ be a Hamiltonian isotopy  that connects the identity to $\phi$. Given $x\in \D$, we denote by $\Gamma_{\phi}(x)$ the embedded curve
\[
	\Gamma_{\phi}(x) := \{ (\phi^t(x),t) \mid t\in [0,1] \} \subset \D \times [0,1]
\]
with its natural orientation. Fix an element  $e\in \partial\D$ and for every $x \text{ in the interior of } \D$  consider the compact surface
\[
	S^e_\phi(x)\subset \D\times [0,1]
\]
that is obtained by connecting each point $(\phi^t(x),t)$ of $\Gamma_{\phi}(x)$ to the boundary point $(e,t)$ by a line segment. In other words, $S^e_\phi(x)$ is parametrized by the smooth embedding
\begin{align}{\label{reparS}}
	\Psi :[0, 1] \times  [0, 1] & \rightarrow \D  \times [0, 1],
	                            & (t,r) \mapsto (\phi^t(x) + r(e-\phi^t(x)), t)
\end{align}
{
which induces an orientation on $S$.   We consider the disk and real line as having their canonical orientations and the ambient space $\mathbb{D}\times[0,1]$ the induced product orientation.
}
The vector
\begin{equation}
	\label{co-orientation}
	(i(e-\phi^t(x)),0 )\in T_{\Psi(t,r)}(\D\times[0,1]),
\end{equation}
where $i$ denotes the counterclockwise rotation by $\pi/2$ on $\R^2$, is everywhere transverse to $S_\phi^e(x)$ and hence defines a co-orientation of this surface.
	{We note that this co-orientation coincides with that induced by the above mentioned orientations on $S_\phi^e(x)$ and
		$\mathbb{D}\times[0,1]$:  Indeed, it suffices to check this at a single point, and we observe that at the point $(e,0)\in S_\phi^e(x)\subset\mathbb{D}\times[0,1]$,
		the basis $\{\partial_t\Psi, \partial_r\Psi, \big(i(e-\phi^t(x)),0\big)\}$ equals $\{(0,1),\big(e-\phi^t(x),0\big),\big(i(e-\phi^t(x)),0\big) \}$ which has the same orientation as $\{\big(e-\phi^t(x),0\big),\big(i(e-\phi^t(x)),0\big),(0,1)\}$ which is clearly positive.
	}

If $x$ is an interior point of $\D$ and $y\neq x$ is another point in $\D$, then we define the intersection number of $x \text{ and } y$ as
\[
	I^e_\phi(x, y):=  I(\Gamma_{\phi}(y), S^e_\phi(x)),
\]
whenever $\Gamma_{\phi}(y)$ meets $S^e_\phi(x)$ transversely.
\begin{figure}[ht]
	\centering
	\scalebox{.8}{\includegraphics{MapTor.eps}}
	\caption{$I(\Gamma_{\phi}(y), S^e_\phi(x))=0$.}
	\label{fig:my_label}
\end{figure}\\

\begin{rem} Given $x\neq y$ as above, it follows from Sard's theorem  that the set of points $e\in \partial\D$ for which $\Gamma_{\phi}(y)$ is transverse to $S^e_{\phi}(x)$ has full Lebesgue measure. Furthermore, even though the definition above depends on the choice of the element $e\in \partial\D$, a different choice of $e$ changes the value of $I_{\phi}^e(x,y)$ by at most one. This follows from Proposition \ref{Bound1} below.
\end{rem}

Next we relate the winding number and the intersection number.

\begin{prop}\label{Bound1}
	Let $x\in \mathrm{int}(\D)$, $y\in \D\setminus \{x\}$ and $e\in \partial \D$ be such that $\Gamma_{\phi}(y)$ meets $S^e_{\phi}(x)$ transversally. Then
	\begin{equation}\label{ineq1}
		\Big|W_\phi(x, y)-I^e_\phi(x, y)\Big|\leq \frac{3}{2}
	\end{equation}
\end{prop}

{
\begin{rem}
	Although we will not use this fact, the constant $\frac{3}{2}$ in (\ref{ineq1}) is optimal.
\end{rem}
}

\begin{proof}
	For every $t\in [0,1]$, we can push out the trajectory of $y$ in $\D\times [0,1]$ to the boundary of the cylinder in the following way: consider the curve
	$\beta:[0,1]\rightarrow \partial\D \times[0,1]$ defined by  $\beta(t)=(h_t(\phi^t(y)),t) $ where $h_t:\D\to \partial\D$ maps  each ray from $\phi^t(x)$ to its intersection with $\partial\D$.  More precisely, every $z\neq \phi^t(x)$ in $\D\setminus\{\phi^t(x)\}$ can be written as $z=\phi^t(x)+r e^{i\alpha}$ where
	\[
		r=|z-\phi^t(x)| \text{ and } e^{i\alpha}:=\frac{z-\phi^t(x)}{|z-\phi^t(x)|},
	\]
	and we set
	\[
		h_t(z):=\phi^t(x)+R e^{i\alpha},
	\]
	where
	\[
		R =\max\{s>0|\, ||\phi^t(x)+se^{i\alpha(z) }|| \leq 1 \}.
	\]
	The winding of this new trajectory on $\partial\D$  is given by $$w_\phi(x,y)=\frac{\sigma(1)-\sigma(0)}{2\pi}$$
	where $$e^{i \sigma(t)}=h_t(\phi^t(y)).$$
	Since the absolute value of the angle between the vectors $\phi^t(y)-\phi^t(x)$ and $h_t(\phi^t(y))$ is not larger than $\frac{\pi}{2}$, the lifts $\sigma$ as above and $\theta$ as in (\ref{star}) can be chosen so that $|\theta(t)-\sigma(t)|\leq\frac{\pi}{2} $. It follows that
	\begin{equation}\label{twowindings}
		|w_\phi(x,y)-W_\phi(x,y)|\leq \frac{1}{2}.
	\end{equation}


	\medskip
	Next, we consider  the curve $
		\eta:[0, 1]  \rightarrow \partial\mathbb{D}$,
	\[
		t \rightarrow \eta(t):=h_t(\phi^t(y)),
	\]
	and extend it to a closed curve $\hat{\eta}: [0,2] \rightarrow \partial\mathbb{D}$ in such a way that $\hat{\eta}((1,2))$ does not contain $e$. The absolute value of the winding number of the curve $\hat{\eta}|_{[1,2]}$ does not exceed one.
	We now lift $\hat{\eta}$ to a self-map of $\partial\mathbb{D}$:
	\[
		f:\partial\mathbb{D} \rightarrow \partial\mathbb{D}, \qquad e^{ 2 \pi i t} \mapsto \hat{\eta}(2t).
	\]

	The oriented degree of this map coincides with its winding number, which differs from the winding number $w_\phi(x,y)$ exactly by the winding number of $\hat{\eta}|_{[1,2]}$, and hence
	\[
		|w_\phi(x,y)-\deg(f)|\leq 1.
	\]
	On the other hand, our transversality assumption implies that $e$ is a regular value for the map $f$, so the oriented degree of this map can be computed as
	\[
		\deg(f)=\sum_{q\in f^{-1}(e)}\sgn(f'(q)),
	\]
	but the latter sum gives us precisely $I_{\phi}^e(x,y)$. This fact, together with (\ref{twowindings}), yields (\ref{ineq1}).
\end{proof}

In order to state the next result, we need to fix some notation and recall some basic facts about the oriented degree for smooth maps between surfaces. Let  $M$ and $N$ be two oriented surfaces (possibly with boundary), with $M$ compact, and let $f:M\to N$ be a smooth map. We set
\[
	N_{\text{reg}}(f) :=\{y\in N |\, y \text{ is a regular value of } f\}.
\]
Then $N\setminus{N_{\text{reg}}(f)}$ has measure zero. For every $y\in N_{\text{reg}}(f)\setminus f(\partial M)$ the set $f^{-1}(y)$ is finite and the degree of $f$ relative to $y$ is the integer
\begin{equation}\label{Def:degree}
	\deg(f,M,y)=\sum_{x\in f^{-1}(y)}\sgn \det df(x) \in \mathbb{Z}.
\end{equation}
Furthermore, the function $y\mapsto\deg(f,M,y)$ extends to a locally constant function on $N\setminus{f(\partial M)}$, and for $\eta$ any $2$-form on $N$ we have the identity
\begin{equation}\label{degreeProperty}
	\int_M f^*\eta=\int_N \deg(f,M,y)\, \eta(y).
\end{equation}


We shall now show that $I_\phi^e(x,y)$ coincides with the degree of a  suitable map between two oriented surfaces. Let $x\in \D$ and $e\in\partial\D$ be as above and  consider  the smooth map
\[
	\rho:S_\phi^e(x) \to        \D, \qquad \rho(z,t):=(\phi^t)^{-1}(z).
\]
Note that the boundary of $S_\phi^e(x)$ consists of the two curves $\Gamma_{\phi}(x)$ and $\Gamma_{\phi}(e)=\{e\}\times [0,1]$ and of the line segments $[x,e]\times \{0\}$ and $[\phi(x),e]\times \{1\}$. The curves $\Gamma_{\phi}(x)$ and $\Gamma_{\phi}(e)$ are mapped into $x$ and $e$ by $\rho$, whereas $[x,e]\times \{0\}$ and $[\phi(x),e]\times \{1\}$ are mapped into $[x,e]$ and $\phi^{-1}([\phi(x),e])$, respectively. We conclude that
\[
	\rho(\partial S_{\phi}^e(x)) = [x,e] \cup \phi^{-1}([\phi(x),e]).
\]
In the following result, the disk $\D$ is given its standard orientation and the surface $S_\phi^e(x)$ the orientation that is induced by the parametrization (\ref{reparS}), meaning that
\begin{equation}
	\label{oriented-basis}
	\partial_t \Psi(t,r) = \bigl( (1-r) X_t(\phi^t(x)),1\bigr), \qquad \partial_r \Psi(t,r) = \bigl( e-\phi^t(x),0 \bigr)
\end{equation}
is a {positively} oriented basis of $T_{\Psi(t,r)} S_\phi^e(x)$, for every $(t,r)\in [0,1]\times [0,1]$.   {With respect to these orientations the degree of the map $\rho$ is well
		defined and at regular values is given by the formula (\ref{Def:degree}).    Recall that the intersection number $I_\phi^e(x,y)$ of the curve $\Gamma_{\phi}(y)$ with the surface $S_\phi^e(x)$
		is defined with respect to the co-orientation in (\ref{co-orientation}).}


\begin{lem}\label{transverseregular}
	The point $y\in \D$ is a regular value for $\rho$ if and only if the curve $\Gamma_\phi(y)$ meets $S_\phi^e(x)$ transversally. %
		{Moreover, whenever $y$ is a regular value for $\rho$,} we have the identity
	\begin{equation}
		\deg(\rho,S_\phi^e(x),y)=I_\phi^e(x,y).
	\end{equation}
\end{lem}
\begin{proof}
	Set for simplicity $S:= S_\phi^e(x)$. The map $\rho$ is the restriction to the surface $S$ of the map
	\[
		\tilde{\rho} : \D \times [0,1] \rightarrow \D, \qquad (z,t) \mapsto (\phi^t)^{-1}(z).
	\]
	The restriction of $\tilde{\rho}$ to $\D \times \{t\}$ is a diffeomorphism for every $t\in [0,1]$ and hence $\tilde{\rho}$ is a submersion. The inverse image of each $y\in \D$ by $\tilde{\rho}$ is the curve
	\[
		\tilde{\rho}^{-1}(y) = \Gamma_{\phi}(y),
	\]
	and hence if $\tilde{\rho}(z,t)=y$ we have
	\begin{equation}
		\label{line}
		\ker d\tilde{\rho}(z,t) = T_{(z,t)} \Gamma_\phi(y) = \R \tilde{X}(z,t),
	\end{equation}
	where
	\[
		\tilde{X}(z,t) := \bigl( X_t(z),1 \bigr).
	\]
	These considerations imply that $(z,t)\in S$ belongs to $\rho^{-1}(y)$ if and only if $\Gamma_\phi(y)$ and $S$ meet at $(z,t)$.    Fix such a point $(z,t)\in \Gamma_\phi(y)\cap S$.
	Then the range of $d\rho(z,t)$ equals the range of $d\tilde{\rho}(z,t)|_{T_{(z,t)}S}$ which is surjective if and only if it coincides with the range of $d\tilde{\rho}(z,t)$,
	which, since the latter is a submersion, is the case if and only if the kernel of $d\tilde{\rho}(z,t)$ is transverse to $T_{(z,t)}S$.   From (\ref{line}), this shows that $y\in \D$ is a regular value for
	$\rho$ if and only if the curve $\Gamma_\phi(y)$ meets $S$ transversally.

	To prove the second part of the Lemma, we fix a regular value $y\in \D$ for $\rho$ and we fix a point
	\[
		(z,t)\in \rho^{-1}(y) = \Gamma_\phi(y) \cap S.
	\]
	We wish to prove that this intersection point is positive if and only if $d\rho(z,t)$ is orientation preserving.  Once this is proven, the last claim of the Lemma follows from the formula
	(\ref{Def:degree}) for the degree with respect to a regular value.

	Recall $\Psi$ the parametrization of $S$ given by (\ref{reparS}).   This gives us the basis
	\[
		(v,1):=\partial_t\Psi(t,r)=\Big((1-r)X_t(\phi^t(x)),1\Big)\qquad (u,0):=\partial_r\Psi(t,r)=\Big(e-\phi^t(x),0\Big)
	\]
	for the tangent space $T_{\Psi(t,r)}S$, while  $T_{\Psi(t,r)}\Gamma_\phi(y)$ is generated by the non-zero vector
	\[
		(w,1):=\Big(X\big(\phi^t(x) + r(e-\phi^t(x))\big),1\Big).
	\]

	The co-orientation of $S$ at $(z,t)$ is given as in (\ref{co-orientation}) by the vector $(iu,0)$.   The intersection at $\Psi(t,r)$ is by definition positive, precisely
	when the two co-orientations $(iu,0)$ and $(w,1)$ of $T_{\Psi(t,r)}S$ agree.   In other words, precisely when
	the two bases $\big((v,1),(u,0),(w,1)\big)$ and $\big((v,1),(u,0),(iu,0)\big)$ determine the same orientation for $ T_{(z,t)}{(\D\times[0,1])}$.
		{By the discussion following (\ref{co-orientation}) the latter is the standard orientation on $\D\times[0,1]$.}
	Hence it is enough to prove that $\big((v,1),(u,0),(w,1)\big)$ is a positive basis if and only if $d\rho(z,t)$ is orientation preserving with respect to the basis
	$\big((v,1),(u,0)\big)$ for $T_{\Psi(t,r)}S$.    The basis $\bigl((v,1),(u,0),(w,1)\bigr)$ is positive if and only if the following determinants are positive
	\[
		\det\left(  \begin{array}{cc} v  & 1  \\ u  & 0 \\ w & 1 \end{array} \right) =  \det \left(  \begin{array}{cc} v-w  & 0 \\ u & 0 \\ w & 1 \end{array} \right) =  \det \left(  \begin{array}{cc} v-w   \\ u  \end{array} \right).
	\]
	Since $\phi$ is isotopic to the identity, so $d(\phi^t)^{-1}(z,t)$ must be symplectic and therefore
	\[
		\det \left(  \begin{array}{cc} v-w   \\ u  \end{array} \right) = \det \left(  \begin{array}{cc}  d(\phi^t)^{-1}(z,t)[v-w]   \\  d(\phi^t)^{-1}(z,t)[u]  \end{array} \right)= \det d\hat{\rho}(t,r)
	\]
	where $\det d\hat{\rho}(t,r)$ is taken with respect to the standard basis of $\R^2$ and the basis $\partial_t,\partial_r$ of $T_{(t,r)}[0,1]^2$.
	The last equality above follows from the computation of the tangent map $d\hat{\rho}(t,r):T_{(t,r)}[0,1]^2 \to T_y \D$ as
	\begin{align*}
		d\hat{\rho}(t,r)[\partial_{r}] & =d(\phi^t)^{-1}\big(\phi^t(x) + r(e-\phi^t(x))\big)[e-\phi^{t}(x)]                    \\
		                               & =d(\phi^t)^{-1}(z,t)[u],                                                              \\
		d\hat{\rho}(t,r)[\partial_t]   & =-X\left((\phi^t)^{-1}\big(\phi^t(x) + r(e-\phi^t(x))\big)\right)                     \\
		                               & \hspace{50pt}+(1-r)d(\phi^t)^{-1}\big(\phi^t(x) + r(e-\phi^t(x))\big)[X(\phi^{t}(x))] \\
		                               & =d(\phi^t)^{-1}\big(\phi^t(x) + r(e-\phi^t(x))\big)[-X(\phi^t(x) + r(e-\phi^t(x))     \\
		                               & \hspace{183pt} +(1-r)X(\phi^{t}(x))]                                                  \\
		                               & = d(\phi^t)^{-1}(z,t)[v-w].
	\end{align*}
	Since $d\hat{\rho}(t,r)$ is orientation preserving if and only if $d\rho(z,t)$ also is, we conclude $\tilde{X}(z,t)$  positively intersects $S$ at $(z,t)$ if and only if  $d\rho(z,t)$ is orientation preserving.
\end{proof}
\begin{rem}
	\label{ae}
	The above lemma and Sard's theorem imply that $\Gamma_\phi(y)$ meets $S_\phi^e(x)$ transversally for almost every $y\in \D$. Together with the properties of the oriented degree mentioned above, this lemma  implies also that the function $I_\phi^e(x,\cdot)$ extends to a locally constant function on $\D \setminus ([x,e] \cup \phi^{-1}([\phi(x),e]))$. Of course, this extension could also be obtained by defining the intersection number of an oriented curve and a co-oriented surface without assuming transversality, but just the condition that there are no intersections on either of the two boundaries, by the usual perturbation argument. Actually, we shall not need this extension of the function $y\mapsto I_{\phi}^e(x,y)$: It will be enough to know that it is well-defined for almost every $y\in \D$ and that the bound of Proposition \ref{Bound1} and the identity of Lemma \ref{transverseregular} hold.
\end{rem}

\section{Asymptotic Action \& Asymptotic winding number.}
In this section we define the asymptotic versions of the action and winding number introduced in the previous section.These definitions build on Birkhoff's ergodic theorem, which we shall use in the following form.

\begin{thm*}[Birkhoff's Ergodic Theorem]
	If $\varphi$ is an endomorphism of a finite measure space $(\Omega, \mathcal{A}, \mu)$ and if $f\in
		L^1(\Omega,\mathcal{A},\mu)$, then the averages
	\[
		A_n f=\frac{1}{n}\sum_{i=0}^{n-1}f\circ \varphi^i
	\]
	converge $\mu-$a.e. and in $L^1(\Omega,\mathcal{A},\mu)$ to some $\varphi$-invariant function $\Bar{f}$. Furthermore for each $\varphi$-invariant $A\in \mathcal{A}$
	\begin{equation}
		\int_{A}\Bar{f}d\mu=\int_A fd\mu.
	\end{equation}
\end{thm*}
\subsection{Asymptotic Action}
In our setup we will work with the space $(\D, \mathcal{B}, \mu)$ where $\mathcal{B}$ is the Borel $\sigma$-algebra on $\D$ and $\mu$ is the Lebesgue measure.
\begin{defn}
	Let $\phi \in \text{Diff}_c(\D, \omega_0)$ and let $\lambda$ be a smooth primitive of $\omega_0$ on $\D$. With $a_{\phi, \lambda}$ as presented before  we define the {\em asymptotic action} of $\phi$ with respect to $\lambda$ as the limit
	\[
		a^\infty_{\phi, \lambda}(z)=\lim_{n\rightarrow\infty}\frac{a_{\phi^n, \lambda}(z)}{n}.
	\]
	By Lemma \ref{formule}(ii) we can write
	\begin{equation}
		\label{AdditiveAction}
		\frac{a_{\phi^n, \lambda}(z)}{n}=\frac{1}{n}\sum_{j=0}^{n-1}a_{\phi, \lambda}(\phi^j(z))
	\end{equation}
	and then taking $n\to \infty$ and applying Birkhoff's ergodic theorem  we can ensure that the limit $a^\infty_{\phi, \lambda}(z)$ exists for almost every $z\in \D$. Furthermore, Birkhoff's theorem guarantees that
	\begin{equation}\label{BirkAction}
		\int_{\D}a^\infty_{\phi, \lambda}(z)\, \omega_0(z)=\int_\D a_{\phi, \lambda}(z)\, \omega_0(z).
	\end{equation}
\end{defn}
The first thing to remark is that the asymptotic action does not depend on the primitive $\lambda$ of $\omega_0$.
\begin{prop}
	The asymptotic action $a^\infty_{\phi, \lambda}$ is independent of the primitive $\lambda$ of $\omega_0$.
\end{prop}
\begin{proof}
	Let $\lambda+du$ be another primitive of $\omega$. Then by Lemma \ref{formule}(i) the action with respect to this primitive is
	$$a_{\phi, \lambda+du}=a_{\phi, \lambda}+u\circ \phi-u.$$
	We can now check the Birkhoff sum up to a finite order
	$$\sum_{j=0}^{n-1} a_{\phi,  \lambda+du}(\phi^j(z))=\sum_{j=0}^{n-1} a_{\phi,  \lambda}(\phi^j(z)+\sum_{j=0}^{n-1} (u\circ \phi -u)(\phi^j(z)).$$
	Note that the last term on the right hand side is a telescopic sum of the form $$\sum_{j=0}^{n-1} \bigl( u(\phi^{j+1}(z))-u(\phi^{j}(z)) \bigr) =u(\phi^{n}(z))-u(z), $$
	and this is uniformly bounded for all $n$. Therefore when taking the Birkhoff average,  this last term goes to zero i.e.
	$$\lim_{n\rightarrow \infty}\frac{1}{n}\sum_{j=0}^{n-1} a_{\phi,  \lambda}(\phi^j(z))=\lim_{n\rightarrow \infty}\frac{1}{n}\sum_{j=0}^{n-1} a_{\phi,  \lambda+du}(\phi^j(z)).$$
	This shows that $a_{\phi, \lambda}^\infty(z)$ does not depend on the primitive $\lambda$. More precisely, the existence and value of the limit of $a_{\phi^n,\lambda}(z)/n$ do not depend on the primitive $\lambda$.
\end{proof}

This lets us write from now on the asymptotic action as $a_\phi^\infty$. It readily follows from (\ref{AdditiveAction}) that if $z$ is a $k$-periodic point of the map $\phi$, then the asymptotic action of $\phi$ coincides with the average action of the orbit of $z$:
\begin{equation}
	\label{actionPeriodic}
	a_{\phi}^{\infty}(z) = \frac{1}{k} \sum_{j=0}^{k-1} a_{\phi,\lambda}(\phi^j(z)).
\end{equation}
The average action of periodic points is the object of study of \cite{Hut}, in which Hutchings proves the existence of periodic points of $\phi$ whose action satisfies suitably bounds in terms of $\mathcal{C}(\phi)$.

\subsection{Asymptotic  Winding number.}\label{awn}
In the same way as with the action we now consider the asymptotic winding number.
\begin{defn}
	The {\em asymptotic winding number} of $\phi\in \text{Diff}_c(\D, \omega_0)$ is the limit
	\[
		W^\infty_\phi(x, y)=\lim_{n\rightarrow\infty} \frac{W_{\phi^n}(x, y)}{n}.
	\]

\end{defn}
To guarantee its existence we  can also  use Birkhoff's ergodic theorem. This time we take $$(Q:=\D\times \D ,\, \mathcal{B}(\D\times\D),\, \mu_Q :=\mu\oplus \mu)$$ with the action of $\phi_Q:=(\phi, \phi) $. For $x\neq y$ in $\D$ the winding number satisfies
\[
	W_{\phi^n}(x, y)=\sum_{j=0}^{n-1}W_\phi(\phi_Q^j(x, y)),
\]
and hence the time average
\begin{align*}
	W_\phi^\infty(x, y)= & \lim_{n\rightarrow \infty}\frac{W_{\phi^n}(x, y)}{n} \\=&\lim_{n\rightarrow \infty}\frac{1}{n}\sum_{j=0}^{n-1}W_\phi(\phi_Q^j(x, y))
\end{align*}
exists for $\mu_Q$-a.e $(x, y)\in \D\times\D $.  Furthermore  Birkhoff's theorem ensures that the time and space averages coincide i.e.
\begin{equation}
	\label{intW}
	\int_{\D\times\D}W^\infty_\phi(x, y)\, \omega_0(x) \wedge \omega_0(y)=\int_{\D\times\D}W_\phi(x, y) \, \omega_0(x) \wedge \omega_0(y).
\end{equation}
In particular $W_\phi^\infty$ is an integrable function and hence by the theorem of Fubini-Tonelli we obtain that the integral
\begin{equation}\label{windingIntegral}
	\int_{\D}W_\phi^\infty(x, y) \, \omega_0(y)
\end{equation}{}
is well-defined for almost every $x\in \D$ and defines an integrable function of $x$.

\begin{rem}
	\label{periodic}
	If $x$ is a $k$-periodic point of $\phi$, then the sequence of functions
	\[
		y \mapsto \frac{W_{\phi}^n(x,y)}{n}
	\]
	converges to $W_{\phi}^{\infty}(x,y)$ for almost every $y\in \D$ and in $L^1(\D)$. Indeed, the identity
	\[
		W_{\phi^{kh}}(x,y) = \sum_{j=0}^{h-1} W_{\phi^k}(\phi^{kj}(x),\phi^{kj}(y)) = \sum_{j=1}^{h-1} W_{\phi^k}(x,\phi^{kj}(y))
	\]
	shows that this function of $y$ is the Birkhoff sum of the function $y\mapsto W_{\phi^k}(x,y)$ with respect to the map $\phi^k$. By Birkhoff's ergodic theorem, there is an integrable function $w:\D \rightarrow \R$ such that
	\[
		\frac{W_{\phi^{kh}}(x,y)}{h} \rightarrow w(y)
	\]
	for almost every $y\in \D$ and in $L^1(\D)$. Together with the uniform bound
	\[
		\left| W_{\phi^{k \lceil \frac{n}{k} \rceil}} (x,y) - W_{\phi^n}(x,y) \right| = \left| \sum_{j=n}^{k \lceil \frac{n}{k} \rceil - 1} W_{\phi}(\phi^j(x),\phi^j(y)) \right| \leq k \|W_{\phi}\|_{\infty},
	\]
	this implies that the sequence of functions
	\[
		y \mapsto \frac{W_{\phi}^n(x,y)}{n}
	\]
	converges to $W_{\phi}^{\infty}(x,y):= w(y)/k$ for almost every $y\in \D$ and in $L^1(\D)$.
\end{rem}

\section{Main results}

Let $\phi\in \text{Diff}_c(\D, \omega_0)$ and let $\phi^t$ be a Hamiltonian isotopy such that $\phi^0=\mathrm{id}$ and $\phi^1=\phi$. We fix $x$ in the interior of $\D$, a point $e\in \partial \D$ and we define the surface $S^e_\phi(x)\subset \D\times [0,1]$ as in (\ref{reparS}). Given $y\in \D \setminus \{x\}$ such that the curve $\Gamma_\phi(y) = \{(\phi^t(y),t) \mid t\in [0,1]\}$ meets $S^e_\phi(x)$ transversally, we denote by $I_\phi^e(x,y)$ the intersection number of $\Gamma_\phi(y)$ with $S^e_\phi(x)$, as in Section \ref{wiidd}. As observed in Remark \ref{ae}, $I_\phi^e(x,\cdot)$ is defined on a full measure subset of $\D$.

\begin{prop}
	\label{actionvsintersection}

	The action of $x$ with respect to a primitive $\lambda$ of $\omega_0$ and the intersection numbers $I^e_\phi(x,\cdot)$ are related by the identity
	\begin{equation}\label{actionvsInt}
		a_{\phi,\lambda}(x)=\int_\D I_\phi^e(x,y)\, \omega_0(y)-\int_{[e,x]}\lambda+\int_{[e,\phi(x)]}\lambda,
	\end{equation}
	where $[e,x]$ and $[e,\phi(x)]$ denote oriented line segments in $\D$.
\end{prop}

\begin{proof}Let $H_t$ be the time-dependent compactly supported Hamiltonian that defines the isotopy $\phi^t$ and denote by $X_t$ its Hamiltonian vector field. We lift the differential forms $\lambda$ and $\omega_0$ and the vector field $X_t$ to corresponding objects on the three-manifold $\D\times [0,1]$:
	\begin{align*}
		\Tilde{\lambda}  & :=\lambda+H_t dt,                          \\
		\Tilde{\omega}_0 & :=d\tilde{\lambda}=\omega_0+dH_t\wedge dt, \\
		\tilde{X}        & :=X_t+\partial_t.
	\end{align*}
	Note that $\tilde{X}$ is an autonomous vector field on $\D\times [0,1]$ and
	\begin{align}
		\imath_{\tilde{X}}{\Tilde{\omega}_{0}} & = \imath_{(X_t+\partial_t)}[ \omega_0+dH_t \wedge dt)]\nonumber                                                              \\
		                                       & = \imath_{X_t}\omega_0+\imath_{X_t}(dH_t \wedge dt)+\imath_{\partial_t}\omega_0+\imath_{\partial_t}(dH_t \wedge dt)\nonumber \\
		                                       & =dH_t+0 + 0 - dH_t = 0.\label{E:flow invariant}
	\end{align}
	In particular, using also the fact that $\Tilde{\omega}_0$ is closed, we have
	\[
		L_{\tilde{X}} \Tilde{\omega}_0 = d \imath_{\tilde{X}} \Tilde{\omega}_0  + \imath_{\tilde{X}} d \Tilde{\omega}_0  = 0,
	\]
	and hence $\Tilde{\omega}_0$ is invariant with respect to the local flow of $\tilde{X}$, which we denote by $\tilde{\phi}$. Note that
	\[
		\tilde{\phi}^t(z,0) = (\phi^t(z),t) \qquad \forall z\in \D, \; t\in [0,1].
	\]
	{Note that (\ref{E:flow invariant}) together with the fact that $\tilde{\omega}_0$ is closed, also shows that $\tilde{\omega}_0$ is invariant with respect to any reparametrization of this local flow.}
	The map
	\[
		\rho: S^e_\phi(x) \rightarrow \D, \qquad (z,t) \mapsto (\phi^t)^{-1}(z),
	\]
	from Section \ref{wiidd} maps each $(z,t)\in S^e_\phi(x)$ into the unique point $y\in \D$ such that $(y,0)$ is on the backward orbit of $(z,t)$ by $\tilde{\phi}$. In other words, this map has the form
	\begin{equation*}
		\rho(p)=\pi \circ \tilde{\phi}^{-\tau(p)}(p),
	\end{equation*}
	where $\pi: \D \times [0,1]\rightarrow \D$ and $\tau: \D \times [0,1] \rightarrow [0,1]$ are the two projections.
	We set $\psi(p) := \tilde{\phi}^{-\tau(p)}(p)$ and we compute its differential
	\[
		d\psi(p)[u]=d\tilde{\phi}^{-\tau(p)}(p)[u]- d\tau(p)[u]\tilde{X}(\tilde{\phi}^{-\tau(p)}(p)), \qquad \forall u\in T_p S^e_\phi(x).
	\]
	Notice that $\rho=\pi\circ \psi$ and $\pi^*\omega_0=\tilde{\omega}_0-dH_t\wedge dt$. These two identities let us compute the pullback of the form $\omega_0$ by the map $\rho$ at some point $p\in S^e_{\phi}(x)$: for every $u,v\in T_p S^e_{\phi}(x)$ we have
	\begin{align*}
		\rho^*\omega_0(p)[u,v] & =(\psi^*\pi^*\omega_0)(p)[u,v]                                                                                           \\
		                       & =\psi^*(\tilde{\omega}_0-dH_t\wedge dt)(p)[u,v]                                                                          \\
		                       & =\psi^*\tilde{\omega}_0(p)[u,v]-\psi^*(dH_t\wedge dt)(p)[u,v]                                                            \\
		                       & =\tilde{\omega}_0(\psi(p))\big[d\psi(p)[u],d\psi(p)[v]\big]{-}dH_0(\psi(p)) \wedge dt \big[d\psi(p)[u],d\psi(p)[v]\big].
	\end{align*}
	The fact that the flow $\tilde{\phi}$ and reparametrizations of it preserve the form $\Tilde{\omega_0}$ implies that $\psi^*\Tilde{\omega}_0 = \Tilde{\omega}_0$, and hence the first term in the last expression equals $\tilde{\omega}_0(p)[u,v]$. On the other hand, the second term in the last expression vanishes, because the vectors $d\psi(p)[u]$ and $d\psi(p)[v]$ belong to the space $T_{\psi(p)}\D \times \{0\}$, on which $dt$ vanishes. We conclude that
	\[
		\rho^*\omega_0=\tilde{\omega}_{0} |_{S^e_\phi(x)}.
	\]
	By Stokes' theorem and (\ref{actionH}) we obtain the identity
	\begin{equation}{\label{1}}
		\begin{split}
			\int_{S^e_\phi(x)}\rho^*\omega_0 &=\int_{S^e_\phi(x)}\tilde{\omega}_0 = \int_{\partial S^e_\phi(x)}\tilde{\lambda}\\ &= \int_{\partial S^e_\phi(x)} (\lambda + H_t \, dt) = a_{\phi,\lambda}(x)+\int_{[e,x]}\lambda-\int_{[e,\phi(x)]}\lambda. \end{split}
	\end{equation}
	On the other hand, equation (\ref{degreeProperty}) and Lemma \ref{transverseregular} yield
	\begin{equation}{\label{2}}
		\int_{S^e_\phi(x)}\rho^*\omega_0=\int_\D\deg(\rho,S^e_\phi(x),y)\, \omega_0(y)=\int_\D I_\phi^e(x,y)\, \omega_0(y).
	\end{equation}
	The desired identity (\ref{actionvsInt}) follows from  (\ref{1}) and (\ref{2}).

\end{proof}


\begin{rem}
	In the particular case of a fixed point $x\in \D$ of $\phi$, the formula of Proposition \ref{actionvsintersection} reduces to the identity
	\[
		a_{\phi,\lambda}(x)=\int_\D I_\phi^e(x,y)\omega_0(y).
	\]

\end{rem}

We can finally prove Theorem \ref{main-thm} from the Introduction.

\begin{proof}[Proof of Theorem \ref{main-thm}]
	By applying Proposition \ref{actionvsintersection} to the map $\phi^n$ we obtain the identity
	\begin{equation*}
		\frac{a_{\phi^n,\lambda}(x)}{n}=\frac{1}{n}\int_\D I_{\phi^n}^{e}(x,y)\, \omega_0(y)-\frac{1}{n}\int_{[e,x]}\lambda+\frac{1}{n}\int_{[e,\phi^n(x)]}\lambda.
	\end{equation*}
	for every $x$ in $\D$. The last two integrals are uniformly bounded in $x\in \D$ and $n\in \mathbb{N}$. Together with the bound from Proposition \ref{Bound1} applied to $\phi^n$, we deduce the bound
	\begin{equation}
		\label{est}
		\frac{a_{\phi^n,\lambda}(x)}{n}-\frac{1}{n}\int_\D W_{\phi^n}(x,y)\, \omega_0(y) = O \left( \frac{1}{n} \right)
	\end{equation}
	uniformly in $x\in \D$. The set $\Omega$ consisting of all points $x\in \D$ for which the sequence $a_{\phi,\lambda}(x)/n$ converges to $a_\phi^{\infty}(x)$ and the integrals of $W_{\phi^n}(x,\cdot) \omega_0/n$ converge to the integral of $W_\phi^{\infty}(x,\cdot)$ has full measure in $\D$. Taking the limit in (\ref{est}) we obtain the identity
	\begin{equation}
		\label{last}
		a_\phi^{\infty}(x) = \int_\D W_\phi^{\infty}(x,y)\, \omega_0(y)
	\end{equation}
	for every $x\in \Omega$.   The set $\Omega$ contains all periodic points of $\phi$ thanks to the identity (\ref{actionPeriodic}) and Remark \ref{periodic}.
\end{proof}

Fathi's formula stated as Corollary \ref{cor:fathi} in the Introduction now follows by integrating (\ref{last}) over the full measure set $\Omega$ and using the identities (\ref{BirkAction}) and (\ref{intW}).
Embedded contact homology (ECH) is a kind of Floer homology for
contact three-manifolds.  Taubes has shown that ECH is isomorphic to
a version of Seiberg-Witten Floer homology (and both are
conjecturally isomorphic to a version of Heegaard Floer homology).
This isomorphism allows information to be transferred between
topology and contact geometry in three dimensions.  In the present
article we first give an overview of the definition of embedded
contact homology.  We then outline its applications to
generalizations of the Weinstein conjecture, the Arnold chord
conjecture, and obstructions to symplectic embeddings in four
dimensions.

\section{Embedded contact homology}

\subsection{Floer homology of 3-manifolds}
\label{sec:floer}

There are various kinds of Floer theory that one can associate to a
closed oriented $3$-manifold with a spin-c structure.  In this article
we regard a {\em spin-c structure\/} on a closed oriented 3-manifold
$Y$ as an equivalence class of oriented $2$-plane fields on $Y$ (i.e.\
oriented rank $2$ subbundles of the tangent bundle $TY$), where two
oriented $2$-plane fields are considered equivalent if they are
homotopic on the complement of a ball in $Y$.  The set of spin-c
structures on $Y$ is an affine space over $H^2(Y;\Z)$, which we denote
by $\Spinc(Y)$.  A spin-c structure $\frak{s}$ has a well-defined
first Chern class $c_1(\frak{s})\in 2H^2(Y;\Z)$.  A {\em torsion\/}
spin-c structure $\frak{s}$ is one for which $c_1(\frak{s})$ is
torsion in $H^2(Y;\Z)$.

One version of Floer theory for spin-c $3$-manifolds is the {\em
		Seiberg-Witten Floer cohomology\/}, or {\em monopole Floer
		cohomology\/}, as defined by Kronheimer-Mrowka \cite{km}.  There are
two basic variants of this theory, which are different only for
torsion spin-c structures; the variant relevant to our story is
denoted by $\widehat{HM}^*(Y,\frak{s})$.  Very roughly, this is the
homology of a chain complex which is generated by $\R$-invariant
solutions to the Seiberg-Witten equations on $\R\times Y$, and whose
differential counts non-$\R$-invariant solutions to the Seiberg-Witten
equations on $\R\times Y$ which converge to two different
$\R$-invariant solutions as the $\R$ coordinate goes to $+\infty$ or
$-\infty$.  This cohomology is a relatively $\Z/d$-graded $\Z$-module,
where $d$ denotes the divisibility of $c_1(\frak{s})$ in
$H^2(Y;\Z)/\op{Torsion}$.

The Seiberg-Witten Floer cohomology $\widehat{HM}^*(Y,\frak{s})$ is
conjecturally isomorphic to a second kind of Floer theory, the {\em
		Heegaard Floer homology\/} $HF^+_*(-Y,\frak{s})$ defined by
Ozsv\'{a}th-Szab\'{o} \cite{os}.  The latter, roughly speaking, is
defined by taking a Heegaard splitting of $Y$, with Heegaard surface
$\Sigma$ of genus $g$, and setting up a version of Lagrangian Floer
homology in $\op{Sym}^g\Sigma$ for two Lagrangians determined by the
Heegaard splitting.  Although the definitions of Seiberg-Witten Floer
theory and Heegaard Floer theory appear very different, there is
extensive evidence that they are isomorphic, and a program for proving
that they are isomorphic is outlined in \cite{lee}.

Seiberg-Witten and Heegaard Floer homology have had a wealth of
applications to three-dimensional topology.  The present article is
concerned with a third kind of Floer homology, called ``embedded
contact homology'' (ECH), which is defined for contact
3-manifolds.  Because ECH is defined directly in terms of contact
geometry, it is well suited to certain applications in this area.

\subsection{Contact geometry preliminaries}

Let $Y$ be a closed oriented 3-manifold.  A {\em contact form\/} on
$Y$ is a $1$-form $\lambda$ on $Y$ such that $\lambda\wedge
	d\lambda>0$ everywhere. The contact form $\lambda$ determines a
2-plane field $\xi=\Ker(\lambda)$, oriented by $d\lambda$; an oriented
$2$-plane field obtained in this way is called a {\em contact
		structure\/}.  The contact form $\lambda$ also determines a vector
field $R$, called the {\em Reeb vector field\/}, characterized by
$d\lambda(R,\cdot)=0$ and $\lambda(R)=1$.

Two basic questions are: First, given a closed oriented 3-manifold
$Y$, what is the classification of contact structures on $Y$ (say, up
to homotopy through contact structures)?  Second, given a contact
structure $\xi$, what can one say about the dynamics of the Reeb
vector field for a contact form $\lambda$ with $\Ker(\lambda)=\xi$?
The first question is a subject of active research which we will not
say much about here, except to note that a fundamental theorem of
Eliashberg \cite{elot} implies that every closed oriented 3-manifold
has a contact structure, in fact a unique ``overtwisted'' contact
structure in every homotopy class of oriented 2-plane fields.  (A
contact structure $\xi$ on a 3-manifold $Y$ is called {\em
		overtwisted\/} if there is an embedded disk $D\subset Y$ such that
$TD|_{\partial D} = \xi|_{\partial D}$.)  For more on this topic see
e.g.\ \cite{geiges}.

To discuss the second question, we need to make some definitions.
Given a closed oriented 3-manifold with a contact form, a {\em Reeb
		orbit\/} is a periodic orbit of the Reeb vector field $R$, i.e.\ a
map $\gamma:\R/T\Z\to Y$ for some $T>0$, such that
$\gamma'(t)=R(\gamma(t))$.  Two Reeb orbits are considered equivalent
if they differ by reparametrization.  If $\gamma:\R/T\Z\to Y$ is a
Reeb orbit and if $k$ is a positive integer, the {\em $k^{th}$
		iterate\/} of $\gamma$ is defined to be the pullback of $\gamma$ to
$\R/kT\Z$.  Every Reeb orbit is either embedded in $Y$, or the
$k^{th}$ iterate of an embedded Reeb orbit for some $k>1$.  Given a
contact structure $\xi$, one can ask: What is the minimum number of
embedded Reeb orbits that a contact form $\lambda$ with
$\Ker(\lambda)=\xi$ can have?  Must there exist Reeb orbits with
particular properties?  Some questions of this nature are discussed in
\S\ref{sec:gw} below.

Continuing with the basic definitions, if $\gamma$ is a Reeb orbit as
above, then the linearization of the Reeb flow near $\gamma$ defines
the {\em linearized return map\/} $P_\gamma$, which is an automorphism
of the two-dimensional symplectic vector space
$(\xi_{\gamma(0)},d\lambda)$.  The Reeb orbit $\gamma$ is called {\em
		nondegenerate\/} if $P_\gamma$ does not have $1$ as an eigenvalue.
If $\gamma$ is nondegenerate, then either $P_\gamma$ has eigenvalues
on the unit circle, in which case $\gamma$ is called {\em elliptic\/};
or else $P_\gamma$ has real eigenvalues, in which case $\gamma$ is
called {\em hyperbolic\/}.  These notions do not depend on the
parametrization of $\gamma$.  We say that the contact form $\lambda$
is {\em nondegenerate\/} if all Reeb orbits are nondegenerate.  For a
given contact structure $\xi$, this property holds for ``generic''
contact forms $\lambda$.

To a nondegenerate Reeb orbit $\gamma$ and a trivialization $\tau$ of
$\gamma^*\xi$, one can associate an integer $\op{CZ}_\tau(\gamma)$
called the {\em Conley-Zehnder index\/}.  Roughly speaking this
measures the rotation of the linearized Reeb flow around $\gamma$ with
respect to $\tau$.  In particular, if $\gamma$ is elliptic, then the
trivialization $\tau$ is homotopic to one with respect to which the
linearized Reeb flow around $\gamma$ rotates by angle $2\pi\theta$ for
some $\theta\in\R\setminus\Z$, and
\[
	\op{CZ}_\tau(\gamma) = 2\floor{\theta} + 1,
\]
where $\floor{\cdot}$ denotes the greatest integer function.

\subsection{The ECH chain complex}
\label{sec:ECC}

With the above preliminaries out of the way, we can now define the
embedded contact homology of a closed oriented 3-manifold $Y$ with a
nondegenerate contact form $\lambda$.

To start, define an {\em orbit set\/} to be a finite set of pairs
$\alpha=\{(\alpha_i,m_i)\}$, where the $\alpha_i$'s are distinct
embedded Reeb orbits, and the $m_i$'s are positive integers, which one
can regard as ``multiplicities''.  The orbit set is called {\em
		admissible\/} if $m_i=1$ whenever the Reeb orbit $\alpha_i$ is
hyperbolic.  The homology class of the orbit set $\alpha_i$ is defined
by $[\alpha]\eqdef \sum_im_i\alpha_i\in H_1(Y)$.  Given $\Gamma\in
	H_1(Y)$, we define the ECH chain complex $C_*(Y,\lambda,\Gamma)$ to be
the free $\Z$-module generated by admissible orbit sets $\alpha$ with
$[\alpha]=\Gamma$.  As explained in \S\ref{sec:index} below, this chain
complex has a relative $\Z/d$-grading, where $d$ denotes the
divisibility of $c_1(\xi)+2\op{PD}(\Gamma)$ in
$H^2(Y;\Z)/\op{Torsion}$.  We sometimes write a generator $\alpha$ as
above using the multiplicative notation
$\alpha=\prod_i\alpha_i^{m_i}$, although the chain complex grading and
differential that we will define below are not well behaved with
respect to this sort of ``multiplication''.

To define the differential on the chain complex, choose an almost
complex structure $J$ on $\R\times Y$ such that $J$ sends $\partial_s$
to the Reeb vector field $R$, where $s$ denotes the $\R$ coordinate;
$J$ is $\R$-invariant; and $J$ sends the contact structure $\xi$ to
itself, rotating positively with respect to $d\lambda$.  For our
purposes a {\em $J$-holomorphic curve\/} in $\R\times Y$ is a map
$u:\Sigma\to\R\times Y$ where $(\Sigma,j)$ is a punctured compact (not
necessarily connected) Riemann surface, and $du\circ j=J\circ du$.  If
$\gamma$ is a Reeb orbit, a {\em positive end\/} of $u$ at $\gamma$ is
an end of $\Sigma$ on which $u$ is asymptotic to $\R\times\gamma$ as
$s\to+\infty$; a {\em negative end\/} is defined analogously with
$s\to-\infty$.  If $\alpha=\{(\alpha_i,m_i)\}$ and
$\beta=\{(\beta_j,n_j)\}$ are two orbit sets with $[\alpha]=[\beta]\in
	H_1(Y)$, let $\mc{M}^J(\alpha,\beta)$ denote the moduli space of
$J$-holomorphic curves as above with positive ends at covers of
$\alpha_i$ with total covering multiplicity $m_i$, negative ends at
covers of $\beta_j$ with total covering multiplicity $n_j$, and no
other ends.  We declare two such $J$-holomorphic curves to be
equivalent if they represent the same {\em current\/} in $\R\times Y$.
For this reason we can identify an element of $\mc{M}^J(\alpha,\beta)$
with the corresponding current in $\R\times Y$, which we typically
denote by $C$.  Note that since $J$ is assumed to be $\R$-invariant,
it follows that $\R$ acts on $\mc{M}^J(\alpha,\beta)$ by translation
of the $\R$ coordinate on $\R\times Y$.

To each $J$-holomorphic curve $C\in\mc{M}^J(\alpha,\beta)$ one can
associate an integer $I(C)$, called the ``ECH index'', which is
explained in \S\ref{sec:index} below.  The differential on the ECH
chain complex counts $J$-holomorphic curves with ECH index $1$, modulo
the $\R$ action by translation.  Curves with ECH index $1$ have
various special properties (assuming that $J$ is generic).  Among
other things, we will see in Proposition~\ref{prop:Rinv} below that if
$I(C)=1$ then $C$ is embedded in $\R\times Y$ (except that $C$ may
contain multiply covered $\R$-invariant cylinders), hence the name
``embedded'' contact homology.  In addition, one can use
Proposition~\ref{prop:Rinv} to show that if $J$ is generic, then the
subset of $\mc{M}^J(\alpha,\beta)$ consisting of $J$-holomorphic
curves $C$ with $I(C)=1$ has finitely many components, each an orbit
of the $\R$ action.

Now fix a generic almost complex
structure $J$.  One then defines the differential $\partial$ on the
ECH chain complex $C_*(Y,\lambda,\Gamma)$ as follows: If $\alpha$ is
an admissible orbit set with $[\alpha]=\Gamma$, then
\[
	\partial\alpha \eqdef \sum_\beta \sum_{\left\{C\in\mc{M}^J(\alpha,\beta)/\R\mid
		I(C)=1\right\}}\varepsilon(C)\cdot \beta.
\]
Here the first sum is over admissible orbit sets $\beta$ with
$[\beta]=\Gamma$.  Also $\varepsilon(C)\in\{\pm1\}$ is a sign,
explained in \cite[\S9]{obg2}; the signs depend on some orientation
choices, but the chain complexes for different orientation choices are
canonically isomorphic to each other.  It is shown in \cite{obg1,obg2}
that $\partial^2=0$.  The homology of this chain complex is the {\em
		embedded contact homology\/} $ECH(Y,\lambda,\Gamma)$.

Although the differential $\partial$ depends on the choice of $J$, the
homology of the chain complex does not.  This is a consequence of the
following much stronger theorem of Taubes \cite{e1,e234}, which was
conjectured in \cite{t3}, and which relates ECH to Seiberg-Witten
Floer cohomology.  To state the theorem, observe that the contact
structure $\xi$, being an oriented $2$-plane field, determines a
spin-c structure $\frak{s}_\xi$, see \S\ref{sec:floer}.  We then have:

\begin{theorem}[Taubes]
	\label{thm:echswf}
	\label{thm:e} There is an isomorphism of relatively $\Z/d$-graded $\Z$-modules
	\begin{equation}
		\label{eqn:echswf}
		ECH_*(Y,\lambda,\Gamma)\simeq
		\widehat{HM}^{-*}(Y,\frak{s}_\xi+\op{PD}(\Gamma)).
	\end{equation}
\end{theorem}

Here $d$ denotes the divisibility of
\[
	c_1(\xi)+2\op{PD}(\Gamma) = c_1(\frak{s}_\xi+\op{PD}(\Gamma))
\]
in $H^2(Y;\Z)/\op{Torsion}$.  Note that both sides of
\eqref{eqn:echswf} are conjecturally isomorphic to the Heegaard Floer
homology $HF^+_*(-Y,\frak{s}_\xi + \op{PD}(\Gamma))$.

\begin{remark}
	Both sides of the isomorphism \eqref{eqn:echswf} in fact have absolute
	gradings by homotopy classes of oriented $2$-plane fields
	\cite{ir,km}, and it is reasonable to conjecture that the isomorphism
	\eqref{eqn:echswf} respects these absolute gradings.
\end{remark}

\begin{remark}
	In particular, Theorem~\ref{thm:echswf} implies that, except for
	possible grading shifts, ECH depends only on the 3-manifold $Y$ and
	not on the contact structure.  This is in sharp contrast to the
	symplectic field theory of Eliashberg-Givental-Hofer \cite{egh}
	which, while also defined in terms of Reeb orbits and holomorphic
	curves, is highly sensitive to the contact structure.  In
	particular, the basic versions of symplectic field theory are
	trivial for overtwisted contact structures in three dimensions, see
	\cite{yau,bn}.  On the other hand, while ECH itself does not depend
	on the contact structure, it contains a canonical element which does
	distinguish some contact structures, see \S\ref{sec:empty}.
\end{remark}

\subsection{The ECH index}
\label{sec:index}
To complete the description of the ECH chain complex, we now outline
the definition of the ECH index $I$; full details may be found in
\cite{pfh2,ir}.  This is the subtle part of the definition of ECH, and
we will try to give some idea of its origins.  Meanwhile, on a first
reading one may wish to skip ahead to the examples and applications.

\subsubsection{Four-dimensional motivation}
To motivate the definition of the ECH index, recall that Taubes's
``SW=Gr'' theorem \cite{swgr} relates the Seiberg-Witten invariants of
a closed symplectic 4-manifold $(X,\omega)$, which count solutions to
the Seiberg-Witten equations on $X$, to a ``Gromov invariant'' which
counts certain $J$-holomorphic curves in $X$.  Here $J$ is an
$\omega$-compatible almost complex structure on $X$.  The definition
of ECH is an analogue of Taubes's Gromov invariant for a contact
manifold $(Y,\lambda)$.  Thus Theorem~\ref{thm:echswf} above is an
analogue of SW=Gr for the noncompact symplectic 4-manifold $\R\times
	Y$.

For guidance on which $J$-holomorphic curves in $\R\times Y$ to count,
let us recall which $J$-holomorphic curves are counted by Taubes's
Gromov invariant of a closed symplectic 4-manifold $(X,\omega)$.  Let
$C$ be a $J$-holomorphic curve in $(X,\omega)$, and assume that $C$ is
not multiply covered.  If $J$ is generic, then the moduli space of
$J$-holomorphic curves near $C$ is a manifold, whose dimension is a
topological quantity called the {\em Fredholm index\/} of $C$, which
is given by
\begin{equation}
	\label{eqn:ind4}
	\op{ind}(C) = -\chi(C) + 2 c_1(C).
\end{equation}
Here $c_1(C)$ denotes $\langle c_1(TX),[C]\rangle$, where $TX$ is
regarded as a rank $2$ complex vector bundle via $J$.  In addition, we
have the {\em adjunction formula\/}
\begin{equation}
	\label{eqn:adj4}
	c_1(C) = \chi(C) + C\cdot C - 2\delta(C).
\end{equation}
Here $C\cdot C$ denotes the self-intersection number of the homology
class $[C]\in H_2(X)$.  In addition $\delta(C)$ is a count of the
singularities of $C$ with positive integer weights, see
\cite[\S7]{mw}, so that $\delta(C)\ge 0$ with equality if and only if
$C$ is embedded.  Now let us define an integer
\begin{equation}
	\label{eqn:I4}
	I(C) \eqdef c_1(C) + C\cdot C.
\end{equation}
Then equations \eqref{eqn:ind4}, \eqref{eqn:adj4}, and \eqref{eqn:I4}
above imply that
\begin{equation}
	\label{eqn:ii4}
	\op{ind}(C)\le I(C),
\end{equation}
with equality if and only if $C$ is embedded.  Taubes's Gromov
invariant counts holomorphic currents $C$ with $I(C)=0$, which are
allowed to be multiply covered (but which are not allowed to contain
multiple covers of spheres of negative self-intersection).  Using
\eqref{eqn:ii4}, one can show that if $J$ is generic, then each such
$C$ is a disjoint union of embedded curves of Fredholm index zero,
except that torus components may be multiply covered.  (Multiply
covered tori are counted in a subtle manner explained in \cite{gr}.)

\subsubsection{The three-dimensional story}
\label{sec:index3}

We now consider analogues of the above formulas \eqref{eqn:ind4},
\eqref{eqn:adj4}, and \eqref{eqn:I4} in $\R\times Y$, where
$(Y,\lambda)$ is a contact 3-manifold.  These necessarily include ``boundary
terms'' arising from the ends of the $J$-holomorphic curves.

Let $C\in\mc{M}^J(\alpha,\beta)$ be a $J$-holomorphic curve as in
\S\ref{sec:ECC}, and assume that $C$ is not multiply covered.  It
follows from the main theorem in \cite{dragnev} that if $J$ is
generic, then $\mc{M}^J(\alpha,\beta)$ is a manifold near $C$, whose
dimension can be expressed, similarly to \eqref{eqn:ind4}, as
\begin{equation}
	\label{eqn:ind3}
	\op{ind}(C) = -\chi(C) + 2c_1(C,\tau) +
	\op{CZ}_\tau^0(C).
\end{equation}
Here $c_1(C,\tau)$ denotes the ``relative first Chern class'' of $\xi$
over $C$ with respect to a trivialization $\tau$ of $\xi$ over the
Reeb orbits $\alpha_i$ and $\beta_j$.  This is defined by
algebraically counting the zeroes of a generic section of $\xi$ over
$C$ which on each end is nonvanishing and has winding number zero with
respect to the trivialization $\tau$.  The relative first Chern class
$c_1(C,\tau)$ depends only on $\tau$ and on the relative homology
class of $C$.  Also $\op{CZ}_\tau^0$ denotes the sum, over all the
positive ends of $C$, of the Conley-Zehnder index with respect to
$\tau$ of the corresponding (possibly multiply covered) Reeb orbit,
minus the analogous sum over the negative ends of $C$.

Second, the adjunction formula \eqref{eqn:adj4} is now replaced by the
	{\em relative adjunction formula\/}
\begin{equation}
	\label{eqn:adj3}
	c_1(C,\tau) = \chi(C) + Q_\tau(C) + w_\tau(C) - 2\delta(C).
\end{equation}
Here $Q_\tau(C)$ is a ``relative intersection pairing'' defined in
\cite{pfh2,ir}, which is an analogue of the integer $C\cdot C$ in the
closed case, and which depends only on $\tau$ and the relative
homology class of $C$. Roughly speaking, it is defined by
algebraically counting interior intersections of two generic surfaces
in $[-1,1]\times Y$ with boundary
$\{1\}\times\alpha-\{-1\}\times\beta$ which both represent the
relative homology class of $C$ and which near the boundary have a
special form with respect to the trivialization $\tau$.  As before,
$\delta(C)$ is a count of the singularities of $C$ with positive
integer weights (which is shown in \cite{siefring} to be finite in
this setting).  Finally, $w_\tau(C)$ denotes the {\em asymptotic
		writhe\/} of $C$; to calculate it, take the intersection of $C$ with
$\{s\}\times Y$ where $s>>0$ to obtain a disjoint union of closed
braids around the Reeb orbits $\alpha_i$, use the trivializations
$\tau$ to draw these braids in $\R^3$, and count the crossings with
appropriate signs; then subtract the corresponding count for $s<<0$.

Next we need a new ingredient, which is the following bound on the
asymptotic writhe:
\begin{equation}
	\label{eqn:wb}
	w_\tau(C) \le \op{CZ}_\tau(\alpha) - \op{CZ}_\tau(\beta) - \op{CZ}_\tau^0(C).
\end{equation}
Here
\[
	\op{CZ}_\tau(\alpha) \eqdef
	\sum_i\sum_{k=1}^{m_i}\op{CZ}_\tau(\alpha_i^k),
\]
where $\op{CZ}_\tau(\gamma^k)$ denotes the Conley-Zehnder index with
respect to $\tau$ of the $k^{th}$ iterate of $\gamma$.  To prove the
writhe bound \eqref{eqn:wb}, one first needs to understand the
structure of the braids that can arise from the ends of a holomorphic
curve; roughly speaking these are iterated nested cablings of torus
braids, with certain bounds on the winding numbers.  One then needs
some combinatorics to bound the writhes of these braids in terms of
the Conley-Zehnder indices.  The writhe bound was proved in an
analytically simpler situation in \cite{pfh2}; the asymptotic analysis
needed to carry over the proof to the present setting was carried out
by Siefring \cite{siefring}; and an updated proof is given in
\cite{ir}.

Finally, by analogy with \eqref{eqn:I4}, define the {\em ECH index\/}
\begin{equation}
	\label{eqn:I3}
	I(C) \eqdef c_1(C,\tau) + Q_\tau(C) + \op{CZ}_\tau(\alpha) - \op{CZ}_\tau(\beta).
\end{equation}
One can check that this formula, like the formulas above, does not
depend on the choice of trivialization $\tau$.  It now follows from
\eqref{eqn:ind3}, \eqref{eqn:adj3}, \eqref{eqn:wb}, and \eqref{eqn:I3}
that the {\em index inequality\/}
\begin{equation}
	\label{eqn:ii}
	\op{ind}(C) \le I(C)
\end{equation}
holds, with equality only if $C$ is embedded.

Recall that we have been assuming in the preceding discussion that $C$ is not
multiply covered.  Without this assumption, one still has the
following proposition, which describes the $I=1$ curves which the ECH
differential counts.

\begin{proposition}
	\label{prop:Rinv}
	\cite[Cor.\ 11.5]{t3}
	Suppose $J$ is generic, and let $C$ be any $J$-holomorphic curve in
	$\mc{M}^J(\alpha,\beta)$, possibly multiply covered.  Then:
	\begin{description}
		\item{(a)}
		      $I(C)\ge 0$, with equality if and only if $C$ is $\R$-invariant (as a
		      current).
		\item{(b)}
		      If $I(C)=1$, then $C=C_0\sqcup C_1$, where $I(C_0)=0$, and $C_1$ is
		      embedded and has $\op{ind}(C_1)=I(C_1)=1$.
	\end{description}
\end{proposition}

It may be illuminating to recall the proof here.
As a current, $C$ consists of distinct, irreducible,
non-multiply-covered holomorphic curves $C_1,\ldots,C_k$, covered with
positive integer multiplicities $d_1,\ldots,d_k$.  For simplicity let
us restrict attention to the case when none of the curves $C_i$ is an
$\R$-invariant cylinder.  Let $C'$ be the
holomorphic curve consisting of the union, over $i=1,\ldots,k$, of
$d_i$ different $\R$-translates of $C_i$.  We then have
\begin{equation}
	\label{eqn:Rinv}
	\sum_{i=1}^kd_i\op{ind}(C_i) = \op{ind}(C') \le I(C')  =
	I(C),
\end{equation}
with equality only if the holomorphic curves $C_i$ are embedded and
disjoint.  Here the equality on the left holds because the Fredholom
index is additive under unions, the inequality in the middle is the
index inequality \eqref{eqn:ii} applied to the non-multiply-covered
curve $C'$, and the equality on the right holds because the ECH index
of a holomorphic curve depends only on its relative homology class.
Now since $J$ is generic, and since we made the simplifying assumption
that $C_i$ is not $\R$-invariant, we have $\op{ind}(C_i)>0$ for each
$i$.  We can then read off the conclusions of the proposition in this
case from the inequality \eqref{eqn:Rinv}.

\subsubsection{Grading} The ECH index is also used to define the relative
grading on the ECH chain complex, as follows.  Note that the
definition of the ECH index $I(C)$ depends only on the relative
homology class of $C$, and indeed it makes perfect sense to define
$I(Z)$ as in \eqref{eqn:I3} where $Z$ is any relative homology class
of $2$-chain in $Y$ (not necessarily arising from a $J$-holomorphic
curve) with $\partial Z = \sum_i m_i\alpha_i - \sum_j n_j\beta_j$.  If
$Z'$ is another such relative homology class, then $Z-Z'\in H_2(Y)$,
and one has the {\em index ambiguity formula\/}
\[
	I(Z)-I(Z') = \langle c_1(\xi) + 2\op{PD}(\Gamma),Z-Z'\rangle.
\]
We now define the grading difference between two generators $\alpha$
and $\beta$ to be the class of $I(Z)$ in $\Z/d$, where $Z$ is any
relative homology class as above.  The index ambiguity formula shows
that this is well defined, and by definition the differential
decreases the relative grading by $1$.

\subsubsection{Incoming and outgoing partitions and admissibility}
\label{sec:tr}
We now make some technical remarks which will not be needed in the
rest of this article, but which address some frequently asked
questions regarding the definition of ECH.

The first remark is that embeddedness of $C$ is not sufficient for
equality to hold in \eqref{eqn:ii}, unless all of the multiplicities
$m_i$ and $n_j$ equal $1$. A curve $C$ in $\mc{M}^J(\alpha,\beta)$ has
positive ends at covers of $\alpha_i$ with some multiplicities
$q_{i,k}$ whose sum is $\sum_kq_{i,k}=m_i$. If equality holds in
\eqref{eqn:ii}, then the unordered list of multiplicities
$(q_{i,1},q_{i,2},\ldots)$ is uniquely determined by $\alpha_i$ and
$m_i$, and is called the ``outgoing partition''
$P^{\op{out}}_{\alpha_i}(m_i)$.  Likewise the covering multiplicities
associated to the ends of $C$ at covers of $\beta_j$ must comprise a
partition called the ``incoming partition''
$P^{\op{in}}_{\beta_j}(n_j)$.  See e.g.\ \cite[\S4]{ir} for details.
To give the simplest example, if $\gamma$ is an embedded elliptic Reeb
orbit such that the linearized Reeb flow around $\gamma$ with respect
to some trivialization rotates by an angle in the interval $(0,\pi)$,
then $P^{\op{out}}_\gamma(2)=(1,1)$, while
$P^{\op{in}}_{\gamma}(2)=(2)$.

In general, if $\gamma$ is an embedded elliptic Reeb orbit and if $m>1$,
then the incoming and outgoing partitions $P^{\op{in}}_\gamma(m)$ and
$P^{\op{out}}_\gamma(m)$ are always different.  This fact makes the
proof that $\partial^2=0$ quite nontrivial.

On the other hand, suppose $\gamma$ is a hyperbolic embedded Reeb
orbit.  If the linearized return map has positive eigenvalues then
\begin{equation}
	\label{eqn:ph}
	P^{\op{in}}_\gamma(m) = P^{\op{out}}_\gamma(m)=(1,\ldots,1).
\end{equation}
If the linearized return map has negative eigenvalues then
\begin{equation}
	\label{eqn:nh}
	P^{\op{in}}_\gamma(m)=P^{\op{out}}_\gamma(m)=\left\{\begin{array}{cl}
		(2,\ldots,2),   & \mbox{$m$ even}, \\
		(2,\ldots,2,1), & \mbox{$m$ odd}.
	\end{array}
	\right.
\end{equation}
This is one reason why the generators of the ECH chain complex in
\S\ref{sec:ECC} are required to be {\em admissible\/} orbit sets: one
can show using \eqref{eqn:ph} and \eqref{eqn:nh} that if one tries to
glue two $I=1$ holomorphic curves along an inadmissible orbit set,
then there are an even number of ways to glue, which by \cite{bm}
count with cancelling signs.  Thus one must disallow inadmissible
orbit sets in order to obtain $\partial^2=0$.  A similar issue arises
in the definition of symplectic field theory \cite{egh}, where ``bad''
Reeb orbits must be discarded.

\subsection{Example: the ECH of an ellipsoid}
\label{sec:ellipsoid}

We now illustrate the above definitions with what is probably the
simplest example of ECH.  Consider $\C^2=\R^4$ with coordinates
$z_j=x_j+iy_j$ for $j=1,2$.  Let $a,b$ be positive real numbers with
$a/b$ irrational, and consider the ellipsoid
\begin{equation}
	\label{eqn:ellipsoid}
	E(a,b) \eqdef \left\{(z_1,z_2)\in\C^2\;\bigg|\;\frac{\pi|z_1|^2}{a} +
	\frac{\pi|z_2|^2}{b} \le 1\right\}.
\end{equation}
We now compute the embedded contact homology of $Y=\partial E(a,b)$,
with the contact form
\begin{equation}
	\label{eqn:lambda}
	\lambda\eqdef\frac{1}{2}\sum_{j=1}^2 (x_jdy_j-y_jdx_j)
\end{equation}
(and of course with $\Gamma=0$).

The Reeb vector field on $Y$ is given by
\[
	R = \frac{2\pi}{a}\frac{\partial}{\partial\theta_1} +
	\frac{2\pi}{b}\frac{\partial}{\partial\theta_2}
\]
where $\partial/\partial\theta_j\eqdef x_j\partial_{y_j} -
	y_j\partial_{x_j}$.  Since $a/b$ is irrational, it follows that there
are just two embedded Reeb orbits $\gamma_1$ and $\gamma_2$, given by
the circles where $z_2=0$ and $z_1=0$ respectively.  These Reeb
orbits, as well as their iterates, are nondegenerate and elliptic.
Indeed there is a natural trivialization $\tau$ of $\xi$ over each
$\gamma_i$ induced by an embedded disk bounded by $\gamma_i$.  With
respect to this trivialization, the linearized Reeb flow around
$\gamma_1$ is rotation by angle $2\pi a/b$, while the linearized Reeb
flow around $\gamma_2$ is rotation by angle $2\pi b/a$.

The generators of the ECH chain complex have the form
$\alpha=\gamma_1^{m_1}\gamma_2^{m_2}$ where $m_1,m_2$ are nonnegative
integers.  We now compute the grading.  The relative $\Z$-grading has
a distinguished refinement to an absolute grading in which the empty
set of Reeb orbits (given by $m_1=m_2=0$ above) has grading $0$.  An
arbitrary generator $\alpha$ as above then has grading
\[
	I(\alpha) = c_1(\alpha,\tau) + Q_\tau(\alpha) + \op{CZ}_\tau(\alpha),
\]
where $c_1(\alpha,\tau)$ denotes the relative first Chern class of
$\xi$ over a surface bounded by $\alpha$, and $Q_\tau(\alpha)$ denotes
the relative intersection pairing of such a surface.  Computing using
the above trivialization $\tau$, one finds, see \cite[\S4.2]{wh}, that
\[
	\begin{split}
		c_1(\alpha,\tau)     & = m_1+m_2,                            \\
		Q_\tau(\alpha)       & = 2m_1m_2,                            \\
		\op{CZ}_\tau(\alpha) & = \sum_{k=1}^{m_1}(2\floor{ka/b}+1) +
		\sum_{k=1}^{m_2}(2\floor{kb/a}+1).
	\end{split}
\]
Therefore
\begin{equation}
	\label{eqn:lattice}
	I(\alpha) = 2\left(m_1+m_2+m_1m_2 + \sum_{k=1}^{m_1}\floor{ka/b} +
	\sum_{k=1}^{m_2}\floor{kb/a}\right).
\end{equation}
In particular, all generators have even grading, so the
differential vanishes, and to determine the homology we just have to
count the number of generators with each grading.

Now if the ECH of $\partial E(a,b)$ is to agree with
$\widehat{HM}^{-*}$ and $HF_*^+$ of $S^3$, then we should get
\begin{equation}
	\label{eqn:agree}
	ECH_*(\partial E(a,b),\lambda,0) \simeq \left\{\begin{array}{cl} \Z, &
             *=0,2,4,\ldots,
             \\ 0, & \mbox{otherwise}.
	\end{array}\right.
\end{equation}
It is perhaps not immediately obvious how to deduce this from
\eqref{eqn:lattice}.  The trick is to interpret the right hand side of
\eqref{eqn:lattice} as a count of lattice points, as follows.  Let $T$
denote the triangle in $\R^2$ bounded by the coordinate axes, together
with the line $L$ through the point $(m_1,m_2)$ of slope $-a/b$.  Then
we observe that
\[
	I(\alpha) = 2\left(\left|T\cap\Z^2\right|-1\right).
\]
Now if one moves the line $L$ up and to the right, keeping its slope
fixed, then one hits all of the lattice points in the nonnegative
quadrant in succession, each time increasing the number of lattice
points in the triangle $T$ by $1$.  It follows that the ECH chain
complex has one generator in each nonnegative even grading, so
\eqref{eqn:agree} holds.

Usually direct calculations of ECH are not so easy because there are
more Reeb orbits, and one has to understand the holomorphic curves.
But for certain simple contact manifolds this is possible; for example
the ECH of standard contact forms on $T^3$ is computed in \cite{t3},
and these calculations are generalized to $T^2$-bundles over $S^1$ in
\cite{lebow}.

\begin{remark}
	For some mysterious reason, lattice point counts such as the one in
	equation \eqref{eqn:lattice} arise repeatedly in ECH in different
	contexts.  For example one lattice point count comes up in the
	combinatorial part of the proof of the writhe bound \eqref{eqn:wb},
	and in determining the ``partition conditions'' in
	\S\ref{sec:tr}, see \cite[\S4.6]{ir}.  Another lattice
	point count appears in the combinatorial description of the ECH
	chain complex for $T^3$ in \cite[\S1.3]{t3}.
\end{remark}

\subsection{Some additional structures on ECH}

ECH has various additional structures on it.  We now describe those
structures that are relevant elsewhere in this article.

\subsubsection{The $U$ map}
On the ECH chain complex there is a degree $-2$ chain map
\[
	U: C_*(Y,\lambda,\Gamma) \longrightarrow C_{*-2}(Y,\lambda,\Gamma),
\]
see e.g.\ \cite[\S2.5]{wh}.  This is defined similarly to the
differential $\partial$, but instead of counting $I=1$ curves modulo
translation, one counts $I=2$ curves that are required to pass through
a fixed, generic point $z\in\R\times Y$.  This induces a well-defined
map on homology
\[
	U: ECH_*(Y,\lambda,\Gamma) \longrightarrow
	ECH_{*-2}(Y,\lambda,\Gamma).
\]
Taubes \cite{e5} has shown that this map agrees with an analogous map
on $\widehat{HM}^{-*}$, and it conjecturally agrees with the $U$ map
on $HF^+_*$.  The $U$ map plays a crucial role in the applications to
generalizations of the Weinstein conjecture discussed in
\S\ref{sec:gw} below.

\subsubsection{Filtered ECH}
\label{sec:filtered}
If $\alpha=\{(\alpha_i,m_i)\}$ is a
generator of the ECH chain complex, define its {\em symplectic
		action\/}
\[
	\mc{A}(\alpha) \eqdef \sum_im_i\int_{\alpha_i}\lambda.
\]
It follows from Stokes's theorem and the conditions on the almost
complex structure $J$ that the differential $\partial$ decreases the
symplectic action, i.e.\ if $\langle \partial\alpha,\beta\rangle\neq 0$
then $\mc{A}(\alpha)>\mc{A}(\beta)$.  Given $L\in\R$, we then define
$ECH^L(Y,\lambda,\Gamma)$ to be the homology of the subcomplex of
$C_*(Y,\lambda,\Gamma)$ spanned by generators with symplectic action
less than $L$.  We call this {\em filtered ECH\/}; it is shown in
\cite{cc} that this does not depend on the choice of almost complex
structure $J$.  However, unlike the usual ECH, filtered ECH is not
invariant under deformation of the contact form; see \S\ref{sec:eo}
for some examples.  Filtered ECH has no obvious direct counterpart in
Seiberg-Witten or Heegaard Floer homology, but it plays an important
role in the applications in \S\ref{sec:cc} and \S\ref{sec:eo} below.

\subsubsection{Cobordism maps}
\label{sec:cobordism}
Let $(Y_+,\lambda_+)$ and $(Y_-,\lambda_-)$ be closed oriented
3-manifolds with nondegenerate contact forms. An {\em exact symplectic cobordism\/} from
$(Y_+,\lambda_+)$ to $(Y_-,\lambda_-)$ is a compact symplectic
4-manifold $(X,\omega)$ with boundary $\partial X = Y_+ - Y_-$, such
that there exists a $1$-form $\lambda$ on $X$ with $d\lambda=\omega$
on $X$ and $\lambda|_{Y_\pm}=\lambda_\pm$.  It is shown in \cite{cc}
that an exact symplectic cobordism as above induces maps on filtered
ECH,
\[
	\Phi^L(X,\omega): ECH^L(Y_+,\lambda_+;\Z/2) \longrightarrow
	ECH^L(Y_-,\lambda_-;\Z/2),
\]
satisfying various axioms.  Here $ECH(Y_\pm,\lambda_\pm;\Z/2)$ denotes
the ECH with $\Z/2$ coefficients, summed over all $\Gamma\in H_1(Y)$,
and regarded as an ungraded $\Z/2$-module.  One axiom is that if
$L<L'$ then the diagram
\[
	\begin{CD}
		ECH^L(Y_+,\lambda_+;\Z/2) @>{\Phi^L(X,\omega)}>>
		ECH^L(Y_-,\lambda_-;\Z/2)\\
		@VVV @VVV\\
		ECH^{L'}(Y_+,\lambda_+;\Z/2) @>{\Phi^{L'}(X,\omega)}>>
		ECH^{L'}(Y_-,\lambda_-;\Z/2)
	\end{CD}
\]
commutes, where the vertical arrows are induced by inclusion of chain
complexes.  Thus the direct
limit
\begin{equation}
	\label{eqn:dl}
	\Phi(X,\omega)\eqdef \lim_{L\to\infty}\Phi^L(X,\omega):
	ECH(Y_+,\lambda_+;\Z/2) \longrightarrow ECH(Y_-,\lambda_-;\Z/2)
\end{equation}
is well-defined.  Another axiom is that this direct limit agrees with
the map $\widehat{HM}^{*}(Y_+;\Z/2)\to \widehat{HM}^*(Y_-;\Z/2)$ on
Seiberg-Witten Floer cohomology induced by $X$, under the isomorphism
\eqref{eqn:echswf}.  Here we are considering Seiberg-Witten Floer
cohomology with $\Z/2$ coefficients, summed over all spin-c structures.

\begin{remark}
	The cobordism maps $\Phi^L(X,\omega)$ are defined in \cite{cc} using
	Seiberg-Witten theory and parts of the isomorphism
	\eqref{eqn:echswf}.  It would be natural to try to give an
	alternate, more direct definition of the cobordism maps
	$\Phi^L(X,\omega)$ by counting $I=0$ holomorphic curves in the
	``completion'' of $X$ obtained by attaching symplectization ends.
	Note that by Stokes's theorem and the exactness of the cobordism,
	such a map would automatically respect the symplectic action
	filtrations.  However there are technical difficulties with defining
	cobordism maps this way, because the compactified $I=0$ moduli
	spaces include broken holomorphic curves which contain multiply
	covered components with negative ECH index.  (There is no analogue
	in this setting of Proposition~\ref{prop:Rinv}, whose proof made
	essential use of the $\R$-invariance of $J$.)  Examples show that
	such broken curves must sometimes make contributions to the
	cobordism map, but it is not known how to define the contribution in
	general.  Fortunately, the Seiberg-Witten definition of
	$\Phi^L(X,\omega)$ is sufficient for the applications considered
	here.
\end{remark}

\subsubsection{The contact invariant}
\label{sec:empty}
The {\em empty set\/} is a legitimate generator of the ECH chain
complex.  By the discussion in \S\ref{sec:filtered} it is a cycle, and
we denote its homology class by
\[
	c(\xi) \in ECH_0(Y,\lambda,0).
\]
This depends only on the contact structure, although not just on the
3-manifold $Y$.  Indeed the cobordism maps in \S\ref{sec:cobordism}
can be used to show that $c(\xi)$ is nonzero if there is an exact
symplectic cobordism from $(Y,\xi)$ to the empty set.  On the other
hand the argument in the appendix to \cite{yau} implies that
$c(\xi)=0$ if $\xi$ is overtwisted.  Some new families of contact
3-manifolds with vanishing ECH contact invariant are introduced by
Wendl \cite{wendl}.  It is shown by Taubes \cite{e5} that $c(\xi)$
agrees with an analogous contact invariant in Seiberg-Witten Floer
cohomology, and both conjecturally agree with the contact invariant in
Heegaard Floer homology \cite{oscontact}.

\subsection{Analogues of ECH in other contexts}

One can also define a version of ECH for sutured
3-manifolds with contact structures adapted to the sutures, see
\cite{cghh}.  This conjecturally agrees with the sutured Floer
homology of Juh\'{a}sz \cite{juhasz} and with the sutured version of
Seiberg-Witten Floer homology defined by Kronheimer-Mrowka \cite{km}.

There is also an analogue of ECH, called ``periodic Floer homology'',
for mapping tori of area-preserving surface diffeomorphisms, see e.g.\
\cite{pfh3,lt}.

We remark that no analogue of ECH is currently known for contact
manifolds of dimension greater than three.  In higher dimensions one
expects that if $J$ is generic then all non-multiply-covered
$J$-holomorphic curves are embedded, see \cite{oz}.  In addition no
good analogue of Seiberg-Witten theory is known in higher dimensions.

\section{Applications}

Currently all applications of ECH make use of Taubes's isomorphism
\eqref{eqn:echswf}, together with known properties of Seiberg-Witten
Floer homology, to deduce certain properties of ECH which then have
implications for contact geometry.  It is an interesting open problem
to establish the relevant properties of ECH without using
Seiberg-Witten theory.

\subsection{Generalizations of the Weinstein conjecture}
\label{sec:gw}

The {\em Weinstein conjecture\/} in three dimensions asserts that for
any contact form $\lambda$ on a closed oriented 3-manifold $Y$, there
exists a Reeb orbit.  Many cases of this were proved by various
authors, see e.g.\ \cite{h,ach,ch}, and the general case was proved by
Taubes \cite{tw}.  Indeed the three-dimensional Weinstein conjecture
follows immediately from the isomorphism \eqref{eqn:echswf}, together
with a theorem of Kronheimer-Mrowka \cite{km} asserting that
$\widehat{HM}^*$ is always infinitely generated for torsion spin-c
structures.  The reason is that if there were no Reeb orbit, then the
ECH would have just one generator: the empty set of Reeb orbits.
However to prove the Weinstein conjecture one does not need to use the
full force of the isomorphism \eqref{eqn:echswf}; one just needs a way
of passing from Seiberg-Witten Floer generators to ECH generators,
which is what \cite{tw} establishes.

In \cite{wh} we make heavier use of the isomorphism \eqref{eqn:echswf}
to prove some stronger results.  For example:

\begin{theorem}
	\label{thm:elliptic}
	Let $\lambda$ be a nondegenerate contact form on a closed oriented
	connected 3-manifold $Y$ such that all Reeb orbits are elliptic.
	Then there are exactly two embedded Reeb orbits, $Y$ is a sphere or
	a lens space, and the two embedded Reeb orbits are the core circles
	of a genus $1$ Heegaard splitting of $Y$.
\end{theorem}

The idea of the proof is as follows.  Since all Reeb orbits are
elliptic, a general property of the ECH index \cite[Prop.\
	1.6(c)]{pfh2} implies that all ECH generators have even grading, so
the ECH differential vanishes.  Since $\widehat{HM}^*$ is nonvanishing
for only finitely many spin-c structures, it follows that all Reeb
orbits represent torsion homology classes.  Estimating the number of
ECH generators in a given index range then shows that there are
exactly two embedded Reeb orbits; otherwise there would be either too
few or too many generators to be consistent with the growth rate of
$\widehat{HM}^*$.  Next, known properties of $\widehat{HM}^*$ imply
that the $U$ map is an isomorphism when the grading is sufficiently
large.  This provides a large supply of $I=2$ holomorphic curves in
$\R\times Y$.  By careful use of the adjunction formula
\eqref{eqn:adj3} one can show that at least one of these holomorphic
curves includes a non-$\R$-invariant holomorphic cylinder.  By
adapting ideas from \cite{hwz3}, one can show that this holomorphic
cylinder projects to an embedded surface in $Y$ which generates a
foliation by cylinders of the complement in $Y$ of the Reeb orbits.
This foliation then gives rise to the desired Heegaard splitting.

Theorem~\ref{thm:elliptic} is used in \cite{wh} to extend the
Weinstein conjecture to ``stable Hamiltonian structures'' (a certain
generalization of contact forms) on 3-manifolds that are not torus
bundles over $S^1$.

In addition, a slight refinement of the proof of
Theorem~\ref{thm:elliptic} in \cite{wh} establishes:

\begin{theorem}
	Let $Y$ be a closed oriented 3-manifold with a nondegenerate contact
	form $\lambda$.  If $Y$ is not a sphere or a lens space, then there
	are at least $3$ embedded Reeb orbits.
\end{theorem}

In fact, examples of contact forms with only finitely many embedded
Reeb orbits are hard to come by, and to our knowledge the following
question is open:

\begin{question}
	Is there any example of a contact form on a closed connected oriented 3-manifold
	with only finitely many embedded Reeb orbits, other than contact forms
	on $S^3$ and lens spaces with exactly two embedded Reeb orbits?
\end{question}

It is shown in \cite{hwz} that for a large class of contact forms on
$S^3$ there are either two or infinitely many embedded Reeb orbits.
It is shown in \cite{ch}, using linearized contact homology, that many
contact structures on 3-manifolds (namely those supported by an open
book decomposition with pseudo-Anosov monodromy satisfying a certain
inequality) have the property that for any contact form, there are
infinitely many free homotopy classes of loops that must contain an
embedded Reeb orbit.

\subsection{The Arnold chord conjecture}
\label{sec:cc}

A {\em Legendrian knot\/} in a contact 3-manifold $(Y,\lambda)$ is a
knot $K\subset Y$ such that $TK\subset \xi|_K$.  A {\em Reeb chord\/}
of $K$ is a Reeb trajectory starting and ending on $K$, i.e.\ a path
$\gamma:[0,T]\to Y$ for some $T>0$ such that $\gamma'(t)=R(\gamma(t))$
and $\gamma(0),\gamma(T)\in K$.  The following theorem, proved in
\cite{cc}, is a version of the Arnold chord conjecture \cite{arnold}.
(This was previously known in some cases from \cite{abbas,mohnke}.)

\begin{theorem}
	Let $Y_0$ be a closed oriented 3-manifold with a contact form $\lambda_0$,
	and let $K$ be a Legendrian knot in $(Y_0,\lambda_0)$.  Then $K$ has a
	Reeb chord.
\end{theorem}

The idea of the proof is follows.  Following Weinstein
\cite{weinstein}, one can perform a ``Legendrian surgery'' along $K$
to obtain a new contact manifold $(Y_1,\lambda_1)$, together with an
exact symplectic cobordism $(X,\omega)$ from $(Y_1,\lambda_1)$ to
$(Y_0,\lambda_0)$.  If $K$ has no Reeb chord, and if $\lambda_0$ is
nondegenerate, then one can carry out the Legendrian surgery
construction so that $\lambda_1$ is nondegenerate and, up to a given
action, the Reeb orbits of $\lambda_1$ are the same as those of
$\lambda_0$.  Using this observation, one can show that if $K$ has no
Reeb chord and if $\lambda_0$ is nondegenerate, then the cobordism map
\begin{equation}
	\label{eqn:ni}
	\Phi(X,\omega): ECH(Y_1,\lambda_1;\Z/2) \longrightarrow
	ECH(Y_0,\lambda_0;\Z/2)
\end{equation}
from \S\ref{sec:cobordism} is an isomorphism.  Note that this is what
one would expect by analogy with a very special case of the work of
Bourgeois-Ekholm-Eliashberg \cite{bee}, which studies the behavior of
linearized contact homology under Legendrian surgery, possibly in the
presence of Reeb chords.

But the map
\eqref{eqn:ni} cannot be an isomorphism.  The reason is that as
shown in \cite{km}, the corresponding map on Seiberg-Witten Floer
cohomology fits into an exact triangle
\[
	\cdots\to
	\widehat{HM}^*(Y_0;\Z/2) \to \widehat{HM}^*(Y_1;\Z/2)\to
	\widehat{HM}^*(Y_2;\Z/2) \to \widehat{HM}^*(Y_0;\Z/2) \to \cdots
\]
where $Y_2$ is obtained from $Y_0$ by a different surgery along $K$.
However, as noted before, Kronheimer-Mrowka showed that
$\widehat{HM}^*(Y_2;\Z/2)$ is infinitely generated.  This
contradiction proves the chord conjecture when $\lambda_0$ is nondegenerate.

To deal with the case where $\lambda_0$ is degenerate, one can use
filtered ECH to show that in the nondegenerate case, there exists a
Reeb chord with an upper bound on the length, in terms of a
quantitative measure of the failure of the map \eqref{eqn:ni} to be an
isomorphism.  For example, if $\lambda_0$ is nondegenerate and if
\eqref{eqn:ni} is not surjective, then there exists a Reeb chord of
action at most $A$, where $A$ is the infimum over $L\in\R$ such that
the image of $ECH^L(Y_0,\lambda_0;\Z/2)$ in $ECH(Y_0,\lambda_0;\Z/2)$
is not contained in the image of the map \eqref{eqn:ni}.  One can show
that this upper bound on the length of a Reeb chord is suitably
``continuous'' as one changes the contact form.  A compactness
argument then finds a Reeb chord in the degenerate case.

\subsection{Obstructions to symplectic embeddings}
\label{sec:eo}

ECH also gives obstructions to symplectically embedding one compact
symplectic 4-manifold with boundary into another.  We now explain how
this works in the case of ellipsoids as in \eqref{eqn:ellipsoid}, with
the standard symplectic form $\omega=\sum_{j=1}^2dx_jdy_j$ on $\R^4$.

Given positive real numbers $a,b$, and given a positive integer $k$,
define $(a,b)_k$ to be the $k^{th}$ smallest entry in the array
$(ma+nb)_{m,n\in\N}$.  Here in the definition of ``$k^{th}$ smallest''
we count with repetitions.  For example if $a=b$ then
\[
	((a,a)_1,(a,a)_2,\ldots) = (0,a,a,2a,2a,2a,3a,3a,3a,3a,\ldots).
\]
We then have:

\begin{theorem}
	\label{thm:eo}
	If there is a symplectic embedding of $E(a,b)$ into $E(c,d)$, then
	\begin{equation}
		\label{eqn:eo}
		(a,b)_k \le (c,d)_k
	\end{equation}
	for all positive integers $k$.
\end{theorem}

To prove this, one can assume without loss of generality that $a/b$
and $c/d$ are irrational and that there is a symplectic embedding
$\varphi:E(a,b) \to \op{int}(E(c,d))$.  Now consider the 4-manifold
$X=E(c,d)\setminus\op{int}(\varphi(E(a,b)))$.  One can show that $X$
defines an exact symplectic cobordism from $\partial E(c,d)$ to
$\partial E(a,b)$, where the latter two 3-manifolds are endowed
with the contact form \eqref{eqn:lambda}.  Since $X$ is diffeomorphic
to the product $[0,1]\times S^3$, the induced map from the
Seiberg-Witten Floer cohomology of $\partial E(c,d)$ to that of
$\partial E(a,b)$ must be an isomorphism.  Recall from \eqref{eqn:dl}
that this map is the direct limit of maps on filtered ECH.  Since the
ECH differentials vanish, it follows that for each $L\in\R$, the
number of ECH generators of $\partial E(c,d)$ with action less than
$L$ does not exceed the number of ECH generators of $\partial E(a,b)$
with action less than $L$.  Since the embedded Reeb orbits in
$\partial E(a,b)$ have action $a$ and $b$, and the embedded Reeb
orbits in $\partial E(c,d)$ have action $c$ and $d$, it follows that
\begin{equation}
	\label{eqn:eo2}
	\left|\left\{(m,n)\in\N^2\mid cm+dn<L\right\}\right| \le
	\left|\left\{(m,n)\in\N^2\mid am+bn < L\right\}\right|.
\end{equation}
The statement that the above inequality holds for all $L\in\R$ is
equivalent to \eqref{eqn:eo}.

For example, if $L$ is large with respect to $a,b,c,d$, then the
inequality \eqref{eqn:eo2} implies that
\[
	\frac{L^2}{2cd} \le \frac{L^2}{2ab} + O(L).
\]
We conclude that $ab\le cd$, which is simply the condition that the
volume of $E(a,b)$ is less than or equal to the volume of $E(c,d)$,
which of course is necessary for the existence of a symplectic embedding.  But
taking suitable small $L$ often gives stronger conditions.

The amazing fact is that, at least for the problem of embedding
ellipsoids into balls, the obstruction in Theorem~\ref{thm:eo} is
sharp.  Namely, for each positive real number $a$, define $f(a)$ to be
the infimum over all $c\in\R$ such that $E(a,1)$ symplectically embeds
into the ball $E(c,c)$.  It follows from Theorem~\ref{thm:eo} that
\begin{equation}
	\label{eqn:f}
	f(a) \ge \sup_{k=2,3,\ldots}\frac{(a,1)_k}{(1,1)_k}.
\end{equation}
On the other hand, McDuff-Schlenk \cite{ms} computed the function $f$
explicitly, obtaining a complicated answer involving Fibonacci
numbers.  Using the result of this calculation, they checked that the
opposite inequality in \eqref{eqn:f} holds.

\begin{question}
	Is there a direct explanation for this?  Does this generalize?  For
	example, does $E(a,b)$ symplectically embed into
	$E(c+\epsilon,d+\epsilon)$ for all $\epsilon>0$ if
	$(a,b)_k\le(c,d)_k$ for all positive integers $k$?
\end{question}

By more involved calculations, one can use ECH to find explicit (but
subtle, number-theoretic) obstructions to symplectic embeddings
involving other simple shapes such as four-dimensional polydisks.  A
systematic treatment of the symplectic embedding obstructions arising
from ECH is given in \cite{qech}.
We give a detailed proof of the homological Arnold conjecture for nondegenerate periodic Hamiltonians on general closed symplectic manifolds $M$ via a direct Piunikhin-Salamon-Schwarz morphism. Our constructions are based on a coherent polyfold description for moduli spaces of pseudoholomorphic curves in a family of symplectic manifolds degenerating from $\CP^1\times M$ to $\C^+ \times M$ and $\C^-\times M$,
as developed by Fish-Hofer-Wysocki-Zehnder as part of the Symplectic Field Theory package.
To make the paper self-contained we include all polyfold assumptions, describe the coherent perturbation iteration in detail, and prove an abstract regularization theorem for moduli spaces with evaluation maps relative to a countable collection of submanifolds.

The 2011 sketch of this proof was joint work with Peter Albers, Joel Fish.

\section{Introduction}

Let $(M,\omega)$ be a closed symplectic manifold and $H:S^1\times M \to \R$ a periodic Hamiltonian function. It induces a time-dependent Hamiltonian vector field $X_H: S^1\times M\to \rT M$ given by $\omega(X_H(t,x), \cdot)=\rd H(t, \cdot)$.  We denote the set of contractible periodic orbits by
\begin{equation}\label{eq:PH}
	\cP(H) := \bigl\{ \g:S^1 \to M \,\big|\, \dot\g(t) = X_H(t,\g(t)) {\rm \,\, and \,\,} \g {\rm \,\, is \,\, contractible} \bigr\}
\end{equation}
and note that periodic orbits can be identified with the fixed points of the time
$2\pi$ flow $\phi^{2\pi}_H :M\to M$ of $X_H$.
(Here we choose the convention $S^1=\R/2\pi\Z$, i.e.\ period $2\pi$, for ease of notation later on.)
We call this Hamiltonian system nondegenerate if
$\phi^{2\pi}_H \times \id_M$ is transverse to the diagonal and hence cuts out the fixed points transversely. In particular, this guarantees a finite set of periodic orbits.
Arnold \cite{arnold} conjectured in the 1960s that the minimal number of critical points of a Morse function on $M$ is also a lower bound for the number of periodic orbits of a nondegenerate Hamiltonian system as above.
In this strict form, the Arnold conjecture has been confirmed for Riemann surfaces \cite{eliashberg-arnold} and tori \cite{CZ}.
A weaker form is accessible by Floer theory, introduced by Floer \cite{f2,f3} in the 1980s. It constructs a chain complex generated by $\cP(H)$ that can be compared with the Morse complex generated by the critical points of a Morse function.
When Floer homology is well-defined, it is usually independent of the Hamiltonian, and on a compact symplectic manifold can in fact be identified with Morse homology, which is also independent of the Morse function and computes the singular homology.
Using this approach, the following nondegenerate homological form of the Arnold conjecture was first proven by Floer \cite{f1,f4} in the absence of pseudoholomorphic spheres.

\begin{thm} \label{thm:arnold}
	Let $(M,\omega)$ be a closed symplectic manifold and $H:S^1\times M \to \R$ a nondegenerate periodic Hamiltonian function. Then
	$$ \textstyle
		\# \cP(H) \;\geq\;  \sum_{i=0}^{\dim M} \dim H_i(M;\Q).
	$$
\end{thm}

Floer's proof was later extended to general closed symplectic manifolds \cite{HS,Ono,FO,LT}, and in the presence of pseudoholomorphic spheres of negative Chern number requires abstract regularizations of the moduli spaces of Floer trajectories since perturbations of the geometric structures may not yield regular moduli spaces; see e.g.\ \cite{MWsmooth}.
Further generalizations and alternative proofs have been published in the meantime, using a variety of regularization methods.
The purpose of this note is to provide a general and maximally accessible proof of Theorem~\ref{thm:arnold} -- using an abstract perturbation scheme provided by the polyfold theory of Hofer-Wysocki-Zehnder \cite{HWZbook}, following an approach by Piunikhin-Salamon-Schwarz \cite{PSS} based on \cite{schwarz-thesis}, and building on polyfold descriptions of Gromov-Witten moduli spaces \cite{hwz-gw} as well as their degenerations in Symplectic Field Theory \cite{egh,fh-sft-full}.


\begin{rmk} \label{rmk:disclosure} \rm
	Since the polyfold descriptions of SFT moduli spaces \cite{fh-sft}--\cite{fh-sft-full} are not completely published, we formulate them as Assumptions~\ref{ass:pss}, \ref{ass:iota,h}, \ref{ass:iso}.
	While these descriptions of four kinds of moduli spaces and their relations involve a lot of structures (bundles, sections, evaluation maps, and compatible immersions from Cartesian products to boundaries), they will be familiar from classical descriptions of moduli spaces of pseudoholomorphic curves.
	Our assumptions in polyfold theoretic terms formalize the well known fact that the moduli spaces have local descriptions in terms of Fredholm sections and gluing theorems, which polyfold theory interprets as global smooth structure within an appropriately generalized differential geometry.
	Indeed, transition maps between the natural infinite dimensional local models fail to be classically differentiable for only two reasons which polyfold theory resolves as explained in e.g.\ \cite[\S2]{usersguide} and \cite[\S2.1]{hwz-gw}:
	Actions of reparameterization groups satisfy the new notion of scale-smoothness for maps between Banach spaces. Neighbourhoods of maps with broken or nodal domains are given local polyfold models as the image of a retraction (modulo a finite group action in the case of isotropy), which becomes scale-smooth after adjusting the smooth structure near nodal curves in Deligne-Mumford spaces.
	With this understood, there is little doubt in the existence of polyfold descriptions for moduli spaces. The much more audacious claim of polyfold theory is the existence of an abstract perturbation scheme for moduli spaces that are described as zero set of a scale-smooth section over a polyfold. However, this claim is fully substantiated in \cite{HWZbook}.
	So the goal of this paper is to demonstrate the use of this abstract perturbation scheme once polyfold descriptions for the basic building blocks of moduli spaces are given.

	We moreover chose this structure to give an example of how rigorous and transparent proofs can be written at a time when parts of their foundation are unpublished or in question.
\end{rmk}



To describe our proof,
let $CF=\oplus_{\g\in\cP(H)} \L \la \g \ra$ be the Floer chain group of the Hamiltonian $H$ with coefficients in the Novikov field $\L$ (see \S\ref{sec:Novikov}).
Let $(CM, \rd)$ be the Morse complex with coefficients in $\L$ associated to a Morse function $f:M\to\R$ and a suitable metric on $M$
(see \S\ref{sec:Morse}).
Then we will prove the following in Lemma~\ref{lem:pss-novikov}, Definition~\ref{def:iota,h}, and Lemmas~\ref{lem:iota chain}, \ref{lem:iota triangular}, \ref{lem:h chain}.

\begin{thm} \label{thm:main}
	There exist $\L$-linear maps $PSS:CM \to CF$, $SSP: CF \to CM$, $\iota:CM \to CM$, and $h:CM \to CM$ such that the following holds.
	\begin{enumilist}
		\item
		$\iota$ is a chain map, that is $\iota \circ \rd = \rd \circ \iota$.
		\item
		$\iota$ is a $\L$-module isomorphism.
		\item
		$h$ is a chain homotopy between $SSP\circ PSS$ and $\iota$, that is
		$\iota  - SSP\circ PSS  = \rd \circ h + h \circ \rd$.
	\end{enumilist}
\end{thm}

Here we view the Floer chain group $CF$ as a vector space over $\Lambda$ -- not as a chain complex, and in particular do not consider a Floer differential. Thus we are neither constructing  a Floer homology for $H$, nor identifying it with the Morse homology of $f$. However, the algebraic structures in Theorem~\ref{thm:main} suffice to deduce the homological Arnold conjecture for the Hamiltonian $H$ as follows.

\begin{proof}[Proof of Theorem~\ref{thm:arnold}]
	Denote the sum of the Betti numbers $k := \sum_{i=0}^{\dim M} \dim H_i(M;\Q)$. Let $(CM_{\Q}, \rd_{\Q})$ be the Morse complex over $\Q$ as defined in \S\ref{sec:Morse}. Then
	by the isomorphism of singular and Morse homology there exist $c_1,\ldots,c_k \in CM_{\Q}$ that are cycles, $\rd_\Q c_i=0$, and linearly independent in the Morse homology over $\Q$.
	Since the Morse differential $\rd:CM\to CM$ is given by $\L$-linear extension of $\rd_\Q$ from $CM_{\Q} \subset CM$ the chains $c_1,\ldots,c_k \in CM$ are also cycles $\rd c_i = \rd_\Q c_i = 0$ and linearly independent in the Morse homology over $\L$.
	By Theorem~\ref{thm:main}~(i),(ii), $\iota$ induces an isomorphism $H\iota:HM\to HM$ on homology.
	This in particular implies that $[\iota(c_1)],\ldots,[\iota(c_k)]\in HM$ are also linearly independent in homology, that is for any $\lambda_1, \ldots,\lambda_k\in\Lambda$ we have
	\begin{equation} \label{eq:independence}
		\textstyle
		\sum_{i=1}^k \lambda_i \cdot \iota(c_i) \;\in\; \im\rd \qquad\Longrightarrow\qquad \lambda_1=\ldots=\lambda_k = 0 .
	\end{equation}

	We now show that $PSS(c_1),\ldots, PSS(c_k) \in CF$ are $\Lambda$-linearly independent, proving $\#\cP(H) \geq k$ since the elements of $\cP(H)$ generate $CF$ by definition. This proves the theorem.

	Let $\lambda_1, \ldots,\lambda_k\in\Lambda$ be a tuple such that
	$$\textstyle
		\sum_{i=0}^k \lambda_i \cdot PSS(c_i) = 0.
	$$
	Then we deduce from Theorem~\ref{thm:main}~(iii) that
	\begin{align*}
		\textstyle
		\sum_{i=0}^k \lambda_i \cdot \iota(c_i)
		 & \;=\; \textstyle
		\sum_{i=0}^k \lambda_i \cdot \bigl(  SSP\bigl(PSS(c_i)\bigr) + \rd h(c_i) + h(\rd c_i) \bigr) \\
		 & \;=\; \textstyle
		SSP\Bigl( \sum_{i=0}^k \lambda_i \cdot PSS (c_i ) \Bigr)  \;+\;  \sum_{i=0}^k \lambda_i \cdot \rd h(c_i)  \;=\; \textstyle
		\rd  \Bigl( \sum_{i=0}^k \lambda_i \cdot h(c_i)  \Bigr),
	\end{align*}
	which implies $\l_1 = \ldots = \l_k = 0$ by \eqref{eq:independence}.
\end{proof}

This algebraically minimalistic approach of deducing the homological Arnold conjecture from the existence of maps $PSS$ and $SSP$ whose composition is chain homotopic to an isomorphism on the Morse complex was developed in 2011 discussions of the second author, Peter Albers, and Joel Fish with Mohammed Abouzaid and Thomas Kragh.
These were prompted by our observation that proofs of ``Floer homology equals Morse homology'' require equivariant transversality which is generally obstructed  -- even for equivariant sections of finite rank bundles.
Thus our goal was a proof using the least amount of geometric insights or new abstract tools.
Beyond this we expect the \cite{PSS}-approach to yield an isomorphism between Floer and Morse homology, and spectral invariants \cite{schwarz-spec} on all closed symplectic manifolds,
using refinements of polyfold theory described in Remark~\ref{rmk:equivariant}.

\smallskip

To maximize accessibility we begin with reviews of the pertinent facts on the Novikov field, \S\ref{sec:Novikov}, and Morse trajectories, \S\ref{sec:Morse}.
The proof of Theorem~\ref{thm:main} then proceeds by constructing the $PSS$ and $SSP$ maps in \S\ref{sec:PSS} from curves in $\C^\pm \times M$, constructing the isomorphism $\iota$ and chain homotopy $h$ in \S\ref{sec:iota,h} from curves in $\CP^1 \times M$ and its degeneration into $\C^-\times M$ and $\C^+ \times M$, and proving their algebraic relations in \S\ref{sec:algebra} by constructing coherent perturbations.
We give a detailed account of these iterative constructions in the proofs of Lemma~\ref{lem:iota chain} and \ref{lem:h chain}. While these results should be contained in \cite{fh-sft-full}, neck-stretching is not addressed in \cite{fh-sft}, and it seemed timely to give the proof in a case whose structure is vastly simplified by the absence of trivial cylinders compared with \cite[\S 3.5]{fh-sft}.
To strike a balance between technical details and maximal accessibility, we have clearly labeled all such technical work. Readers willing to view polyfold theory as a black box can save 20 pages by skipping these parts.
For readers new to polyfold theory we provide in Appendix~\ref{sec:polyfold} a summary of all notions and facts that are necessary for the present application. Here we moreover establish in Theorem~\ref{thm:transversality} a relative perturbation result that should be of independent interest: It allows one to bring moduli spaces with an evaluation map into general position to a countable collection of submanifolds.
We combine this result with \cite{Ben-fiber} to construct polyfold descriptions of the \cite{PSS} moduli spaces as fiber products of SFT moduli spaces with the Morse trajectory spaces constructed in \cite{W-Morse}.



\begin{rmk} \rm \label{rmk:equivariant}
	(i)
	There are essentially two approaches to the general Arnold conjecture as stated in Theorem~\ref{thm:arnold}. The first -- developed by \cite{f4} and used verbatim in \cite{HS,Ono,FO,LT} -- is to establish the independence of Floer homology from the Hamiltonian function, and to identify the Floer complex for a $\cC^2$-small $S^1$-invariant Hamiltonian $H:M\to\R$ with the Morse complex for $H$. This requires $S^1$-equivariant transversality to argue that isolated Floer trajectories must be $S^1$-invariant, hence Morse trajectories.
	A conceptually transparent construction of equivariant and transverse perturbations -- under transversality assumptions at the fixed point set which are met in this setting -- can be found in \cite{zhengyi-quotient}, assuming a polyfold description of Floer trajectories.

	\medskip\noindent(ii)
	The second approach to Theorem~\ref{thm:arnold} by \cite{PSS} is to construct a direct isomorphism between the Floer homology of the given Hamiltonian and the Morse homology for some unrelated Morse function. Two chain maps $PSS: CM \to CF$, $SSP: CF \to CM$ between the Morse and Floer complexes are constructed from moduli spaces of once punctured perturbed holomorphic spheres with one marking evaluating to the unstable resp.\ stable manifold of a Morse critical point, and with the given Hamiltonian perturbation of the Cauchy-Riemann operator on a cylindrical neighbourhood of the puncture. Then gluing and degeneration arguments are used to argue that both $PSS\circ SSP $ and $SSP\circ PSS$ are chain homotopic to the identity, and hence $SSP$ is the inverse of $PSS$ on homology.
	However, sphere bubbling can obstruct these arguments: In the first chain homotopy it creates an ambiguity in the choice of nodal gluing when the intermediate Morse trajectory shrinks to zero length.
	(We expect to be able to avoid this by arguing that ``index 1 solutions generically avoid codimension 2 strata'' -- another classical fact in differential geometry that should generalize to polyfold theory.)
	The second chain homotopy is as claimed in Theorem~\ref{thm:main}~(iii) but with $\iota=\id$, which requires arguing that the only isolated holomorphic spheres with two marked points evaluating to an unstable and stable manifold are constant.
	This again requires $S^1$-equivariant transversality (which we expect to be able to achieve with the techniques in \cite{zhengyi-quotient}).

	\medskip\noindent(iii)
	Theorem~\ref{thm:main} is proven by following the  \cite{PSS}-approach as above but avoiding the use of new polyfold technology such as equivariant or strata-avoiding perturbations. In particular, $\iota$ is the map that results from counting holomorphic spheres that intersect an unstable and stable manifold; its invertibility is deduced from an ``upper triangular'' argument.


	\medskip\noindent(iv)
	The techniques in this paper -- combining existing perturbation technology with the polyfold descriptions of SFT moduli spaces -- would also allow one to define the Floer differential, prove $\rd^2=0$, establish independence of Floer homology from the Hamiltonian (and other geometric data), and prove that $PSS$ and $SSP$ are chain maps.
	Then the chain homotopy between $SSP\circ PSS$ and the isomorphism $\iota$ implies that $PSS$ is injective and $SSP$ surjective on homology. However, proving that $PSS$ and $SSP$ are isomorphisms
	on
	homology, or directly identifying the Floer complex of a small $S^1$-invariant Hamiltonian with its Morse complex, requires the techniques discussed in (ii).

	Moreover, a proof of independence of Floer homology from the choice of abstract perturbation would require a study of the algebraic consequences of self-gluing Floer trajectories in expected dimension $-1$ during a homotopy of perturbations, as developed in the $A_\infty$-setting in \cite{jiayong}.
\end{rmk}





\noindent
{\it
	We thank Peter Albers and Joel Fish for helping develop the outline of this project -- and Edi Zehnder for asking the initial question.
	The project was further supported by various discussions with Mohammed Abouzaid, Helmut Hofer, Thomas Kragh, Kris Wysocki, and Zhengyi Zhou.
	Crucial financial support was provided by NSF grants DMS-1442345 and DMS-1708916.
}

\section{The Novikov field}
\label{sec:Novikov}

We use the following Novikov field $\Lambda$ associated to the symplectic manifold $(M,\omega)$. Let $H_2(M)$ denote integral homology and consider the map $\o : H_2(M) \rightarrow \mathbb{R}$ given by the pairing $\o(A) := \langle \o,A \rangle$ for $A \in H_2(M)$. The image of this pairing is a finitely generated additive subgroup of the real numbers denoted
$$\G \,:=\; \im \o \;=\; \o(H_2(M)) \;\subset\; \mathbb{R}.$$
The \emph{Novikov field} $\Lambda$ is the set of formal sums
$$\textstyle
	\lambda = \sum_{r \in \G} \lambda_{r} T^{r},$$
where $T$ is a formal variable, with rational coefficients $\lambda_r \in \mathbb{Q}$ which satisfy the finiteness condition
$$
	\forall c\in \R \qquad
	\# \{ r \in \G \,\, | \,\, \lambda_r \neq 0,\, r \leq c \} < \infty .
$$
The multiplication is given by
$$\textstyle
	\lambda \cdot \mu \;=\;
	\left( \sum_{r \in \G} \lambda_r T^{r} \right)
	\cdot \left( \sum_{s \in \G} \mu_s T^{s}  \right)
	\;:=\; \sum_{t \in \G} \left(
	\sum_{r+s=t}
	\lambda_r \mu_s  \right) T^{t} .
$$

This defines a field $\Lambda$ by \cite[Thm.4.1]{HS} and the discussion preceding the theorem in \cite[\S4]{HS}, the key being that $\G$ is a finitely generated subgroup of $\mathbb{R}$.

We will moreover make use of the following generalization of the invertibility of triangular matrices with nonzero diagonal entries.

\begin{lem} \label{lem:invertibilitymatrixnovikov}
	Let $M=(\lambda^{ij})_{1\leq i,j \leq \ell} \in\Lambda^{\ell\times \ell}$ be a square matrix with entries $\lambda^{ij}\in\Lambda$ in the Novikov field. Suppose that $\lambda^{ij} = \sum_{r\in \G, r\geq 0} \lambda^{ij}_r T^r$ with $\lambda^{ij}_0 = 0$ for $i\neq j$ and $\lambda^{ii}_0 \neq 0$. Then $M$ is invertible.
\end{lem}
\begin{proof}
	Since $\Lambda$ is a field, invertibility of $M$ is equivalent to $\det(M) \neq 0$. Write $\det(M) = \sum_{r \in \G} \mu_rT^r \in \Lambda$ for some $\mu_r \in \mathbb{Q}$. It suffices to show that $\mu_0 \neq 0$.

	We proceed by induction on the size of the matrix $M$. In the $\ell=1$ base case, when $M$ is a $1 \times 1$ matrix $M = [\lambda^{11}]$, we have $\det(M) = \lambda^{11}=\sum_{r\in \G} \mu_r T^r$ with $\mu_r=\lambda^{11}_r$ so $\mu_0 = \lambda^{11}_0 \neq 0$.

	Now suppose that $M$ is size $\ell \times \ell$ for some $\ell > 1$ and inductively assume that, for any size $(\ell - 1) \times (\ell-1)$ matrix $N$ satisfying the hypotheses of the lemma, we have $\det(N) = \sum_{r \in \G} \mu^N_r T^r$ with $\mu^N_0 \neq 0$. For $1 \leq j \leq
		\ell$, let $C_{1 j}$ denote the matrix obtained by deleting the first row and $j$-th column of $M$. Then $N := C_{11}$ is an $(\ell - 1) \times (\ell-1)$ matrix that satisfies the hypotheses of the lemma, and the cofactor expansion of the determinant yields
	$$\textstyle
		\det(M) \;=\; \lambda^{11}  \det(N) \;+\; \sum_{j=2}^\ell (-1)^{1+j} \lambda^{1j}  \det(C_{1j}).
	$$
	By hypothesis, all entries of $M$ are of the form $\lambda^{ij} = \sum_{r \geq 0} \lambda^{ij}_r T^r$. Since the determinants $\det(N)$ and $\det(C_{1j})$ are polynomials of those entries, they are of the same form -- with zero coefficients for $T^r$ with $r < 0$. Since we moreover have $\lambda^{1j}_0 = 0$ for $j \geq 2$ by hypothesis, it follows that the constant term (i.e. the coefficient on $T^0$) of $\lambda^{1j}\det(C_{1j})$ is $0$. Hence the constant term of $\det(M)=\sum \mu_r T^r$ is $\mu_0 = \lambda_0^{11} \cdot \mu_0^N$, where $\mu_0^N \neq 0$ by induction and $\lambda_0^{11} \neq 0$ by hypothesis. This implies $\det(M)= \mu_0 + \ldots \neq 0$ and thus finishes the proof.
\end{proof}



\section{The Morse complex and half-infinite Morse trajectories}
\label{sec:Morse}

This section reviews the construction of the Morse complex as well as the compactified spaces of half-infinite Morse trajectories which will appear in all our moduli spaces.

\subsection{Euclidean Morse-Smale pairs}

The Morse complex can be constructed for any Morse-Smale pair of function and metric on a closed smooth manifold $M$ (and more general spaces). However, we will also work with half-infinite Morse trajectories, and to obtain natural manifold with boundary and corner structures on these, we will restrict ourselves to the following special setting.

\begin{dfn} \label{def:ems}
	A {\bf Euclidean Morse-Smale pair} on a closed manifold $M$ is a pair $(f,g)$ consisting of a smooth function $f\in\cC^\infty(M,\R)$ and a Riemannian metric $g$ on $M$ satisfying a normal form and transversality condition as follows.
	\begin{enumerate}
		\item
		      For every critical point $p\in{\rm Crit}(f)$ of index $|p|\in\N_0$ there exists a local chart $\phi$ to a neighbourhood of $0\in\R^n$ such that
		      \begin{align*}
			      \phi^* f  (x_1,\ldots,x_n) & \;=\; f(p) - \half( x_1^2 + \ldots + x_{|p|}^2 ) + \half ( x_{|p|+1}^2 + \ldots + x_n^2 ) , \\
			      \phi^* g                   & \;=\; \rd x_1 \otimes \rd x_1 + \ldots + \rd x_n \otimes \rd x_n .
		      \end{align*}
		\item
		      For every pair of critical points $p,q\in{\rm Crit}(f)$ the intersection of unstable and stable manifolds is transverse, $W^-_p \pitchfork W^+_q $.
	\end{enumerate}
\end{dfn}

\begin{rmk}\rm  \label{rmk:Euclidean}
	Euclidean Morse-Smale pairs exist on every closed manifold, and for any given Morse function. Indeed, given any Morse function $f$ and metric $g$,
	there are arbitrarily $C^0$-small perturbations $g'$ of $g$ in any neighborhood of the critical points of $f$ such that $(f,g')$ satisfies Definition~\ref{def:ems}(i); see e.g.\ \cite[Prp.1]{bh}. Furthermore, any $L^2$-generic perturbation $g''$ of $g'$ on annuli around the critical points yields a pair $(f,g'')$ that additionally satisfies Definition~\ref{def:ems}(ii) and hence is a Euclidean Morse-Smale pair; see e.g.\ \cite[Prp.2]{bh} or \cite[Prp.2.24]{schwarz}.
\end{rmk}

\subsection{The Morse complex} \label{ssec:CM}

For distinct critical points $p_-\neq p_+\in{\rm Crit}(f)$ the space of unbroken Morse trajectories (which are necessarily nonconstant) is
\begin{align}
	\cM(p_-,p_+) & := \bigl\{ \t:\R\to M \,\big|\, \dot{\t}=-\nabla f(\t) ,
	\lim_{s\to\pm\infty}\t(s)=p_\pm  \bigr\} / \R  \label{eq:inftraj}       \\  \nonumber
	             & \cong \bigl(W^-_{p_-}\cap W^+_{p_+}\bigr) / \R
	\quad\cong\; W^-_{p_-}\cap W^+_{p_+} \cap f^{-1}(c) .
\end{align}
It is canonically identified with the intersection of unstable and stable manifold modulo the $\R$-action given by the flow of $-\nabla f$, or their intersection with a level set for any regular value $c\in (f(p_+),f(p_-))$. Both formulations equip it with a canonical smooth structure of dimension $|p_-| - |p_+| - 1$, see e.g.\ \cite[\S2.4.1]{schwarz}.
Moreover, any choice of orientation of the unstable manifolds $W^-_{p}$ for all $p\in{\rm Crit}(f)$
induces orientations on the trajectory spaces $\cM(p_-,p_+)$ by e.g.\ \cite[\S3.4]{Weber}.
Then the Morse chain complex of $(f,g)$ is obtained by counting (with signs induced by the orientations) the zero dimensional spaces of unbroken trajectories,
\begin{equation} \label{eq:MorseDiff}
	CM_\Q := \bigoplus_{p\in {\rm Crit}(f)} \Q \la p \ra , \qquad\qquad
	d_\Q \; \la p_- \ra := \sum_{ |p_+|= |p_-|-1 }  \# \cM(p_-,p_+) \; \la p_+ \ra  .
\end{equation}
It computes the singular homology of $M$; see e.g.\ \cite[\S4.3]{schwarz}.
More precisely, the Morse complex is graded
$CM_\Q=\bigoplus_{i=0,\ldots,\dim M} C_i M$ by Morse indices $C_i M=\bigoplus_{|p|=i} \Q \la p \ra$, and with $d_i:= d_\Q|_{C_iM}$ we have $H_i(M;\Q) \cong \ker d_i / \im d_{i+1}$.

The PSS and SSP morphisms will be constructed on the Morse complex with coefficients in the Novikov field $\Lambda$ from Section~\ref{sec:Novikov},
\begin{equation} \label{eq:CM}
	\textstyle
	CM \;=\; CM_\Lambda \,:=\; CM_\Q \otimes \Lambda \;=\;  \bigoplus_{p\in {\rm Crit}(f)} \Lambda \la p \ra ,
\end{equation}
with differential $d=d_\Lambda$ the $\Lambda$-linear extension of $d_\Q$ (defined as above on generators).
This complex is naturally graded with differential of degree 1,
\begin{equation} \label{eq:CMgraded}
	\textstyle
	C_*M \;=\; \bigoplus_{i=0}^{\dim M} C_i M, \qquad C_iM = \bigoplus_{|p|=i} \Lambda \la p \ra , \qquad
	d:C_i M\to C_{i-1}M.
\end{equation}


\subsection{Compactified spaces of Morse trajectories} \label{ssec:Morse}

Our construction of moduli spaces will also make use of the following spaces of half-infinite unbroken Morse trajectories for $p_\pm\in{\rm Crit}(f)$
\begin{align*}
	\cM(M,p_+) & \,:=\; \bigl\{ \t: \phantom{-} [0,\infty) \to M \,\big|\, \dot{\t}=-\nabla f(\t), \lim_{s\to\infty\phantom{-}}\t(s)=p_+  \bigr\}  , \\
	\cM(p_-,M) & \,:=\; \bigl\{ \t: (-\infty,0] \to M \,\big|\, \dot{\t}=-\nabla f(\t), \lim_{s\to-\infty}\t(s)=p_-  \bigr\}  .
\end{align*}
These will be equipped with smooth structures of dimension
$\dim \cM(M,p_+) = \dim M - |p_+|$ resp.\ $\dim \cM(p_-,M) = |p_-|$ by the evaluation maps
$$
	\ev : \cM(M,p_+) \to M ,  \quad \t \mapsto \t(0),  \qqquad
	\ev : \cM(p_-,M) \to M , \quad  \t \mapsto \t(0) ,
$$
which identify the trajectory spaces with the unstable and stable manifolds
$\cM(M,p_+) \cong W^+_{p_+}$ resp.\ $\cM(p_-,M) \cong W^-_{p_-}$.
Note that these spaces contain constant trajectories at a critical point, $\{\tau\equiv p_+\} \in \cM(M,p_+)$ and $\{\tau\equiv p_-\} \in \cM(p_-,M)$.
To compactify these trajectory spaces in a manner compatible with Morse theory, we cannot simply take the closure of the unstable or stable manifold $W^\pm_{p_\pm}\subset M$, but must add broken trajectories involving the bi-infinite Morse trajectories.
The bi-infinite trajectories from \eqref{eq:inftraj} which appear in such a compactification are always nonconstant, i.e.\ between distinct critical points $p_-\neq p_+$. So, unlike constant half-infinite length trajectories, our constructions will not involve constant bi-infinite trajectories, and we simplify subsequent notation by setting $\cM(p,p):=\emptyset$ for all $p\in{\rm Crit}(f)$.
With that we first introduce spaces of $k$-fold broken half- or bi-infinite Morse trajectories for $k\in\N_0$ and $p_\pm\in\Crit(f)$,
\begin{align}
	\bM(M,p_+)_k   & := \textstyle
	\bigcup_{p_1,\ldots, p_k\in{\rm Crit}(f)}
	\cM(M,p_1)\times \cM(p_1,p_2) \ldots \times \cM(p_k,p_+), \nonumber      \\
	\bM(p_-,M)_k   & := \textstyle
	\bigcup_{p_1,\ldots, p_k\in{\rm Crit}(f)}
	\cM(p_-,p_1)\times \cM(p_1,p_2) \ldots \times \cM(p_k,M), \label{eq:bMk} \\
	\bM(p_-,p_+)_k & := \textstyle
	\bigcup_{p_1,\ldots, p_k\in{\rm Crit}(f)}
	\cM(p_-,p_1)\times \cM(p_1,p_2) \ldots \times \cM(p_k,p_+).  \nonumber
\end{align}
Now the compactifications of the spaces of half- or bi-infinite Morse trajectories are given by
$$
	\bM(M,p_+) := \bigcup_{k\in\N_0} \bM(M,p_+)_k , \quad
	\bM(p_-,M) :=  \bigcup_{k\in\N_0} \bM(p_-,M)_k , \quad
	\bM(p_-,p_+) := \bigcup_{k\in\N_0} \bM(p_-,p_+)_k ,
$$
with topology given by the Hausdorff distance between the images of the broken or unbroken trajectories. Compactness of these spaces is proven analogously to the bi-infinite Morse trajectory spaces in e.g.\ \cite[Prp.3]{bh}, using \cite[Lemma~3.5]{W-Morse}. Moreover, \cite[Lemma~3.3]{W-Morse} shows that the evaluation maps extend continuously to
\begin{align} \label{eval}
	\ev \,:\; \bM(M,p_+) \to M , \quad & \bigl(\t_0,[\t_1], \phantom{\ell} \ldots \phantom{\ell} ,[\t_k]) \mapsto \t_0(0) , \\
	\ev \,:\; \bM(p_-,M) \to M , \quad & \bigl([\t_0],\ldots,[\t_{k-1}],\t_k)  \mapsto \t_k(0) . \nonumber
\end{align}
Smooth structures on these spaces are obtained by the following variation of a folk theorem, which is proven in \cite{W-Morse}, using techniques similar to those of \cite{bh} for the bi-infinite trajectory spaces.

\begin{thm} \label{thm:Morse}
	Let $(f,g)$ be a Euclidean Morse-Smale pair and $p_\pm\in\Crit(f)$.
	Then $\bM(M,p_+)$, $\bM(p_-,M)$, and $\bM(p_-,p_+)$ are compact, separable metric spaces and carry the structure of a smooth manifold with corners of dimension
	$\dim\bM(M,p_+)=\dim M - |p_+|$, $\dim\bM(p_-,M)=|p_-|$, and $\dim\bM(p_-,p_+)=|p_-|-|p_+|-1$.
	Their $k$-th boundary stratum is $\partial_k\bM(\ldots)=\bM(\ldots)_k$.
	Moreover, the evaluation maps \eqref{eval} are smooth.
\end{thm}

For reference, we recall the definition of a manifold with (boundary and) corners and its strata.

\begin{dfn} \label{def:corners}
	A {\bf smooth manifold with corners} of dimension $n\in\N_0$ is a second countable Hausdorff space $M$ together with a maximal atlas of charts $\phi_\iota:M\supset U_\iota \to V_\iota\subset [0,\infty)^n$ (i.e.\ homeomorphisms between open sets such that $\cup_\iota U_\iota = M$) whose transition maps are smooth.

	For $k=0,\ldots,n$ the $k$-th boundary stratum $\partial_k M$ is the set of all $x\in M$ such that for some (and hence every) chart the point $\phi_\iota(x)\in [0,\infty)^n$ has $k$ components equal to $0$.
\end{dfn}

\begin{rmk} \rm \label{rmk:MorseOrient}
	\begin{enumilist}
		\item
		To orient the Morse trajectory spaces in Theorem~\ref{thm:Morse} we fix a choice of orientation on each unstable manifold $W^-_{p}\cong \cM(p,M)$ for $p\in{\rm Crit}(f)$, and orient $W^+_p\cong\cM(M,p)$ such that $\rT_p M = \rT_p W^- \oplus \rT_p W^+$ induces the orientation on $M$ given by the symplectic form.
		This also induces orientations on $\cM(p_-,p_+)= W^-_{p_-}\cap  W^+_{p_+} / \R$ that are coherent (by e.g.\ \cite[\S3.4]{Weber}) in the sense that the top strata of the oriented boundaries of the compactified Morse trajectory spaces are products $\partial_1\bM(\cdot, \cdot)=\bigcup_{q\in{\rm Crit}(f)} o(\cdot,q,\cdot) \cM(\cdot,q)\times \cM(q,\cdot)$ with  universal signs $o(\cdot,q,\cdot)=\pm 1$. We compute the relevant cases: For $\cM(M,q)\times \cM(q,p_+)\hookrightarrow\partial_1\bM(M,p_+)$ with $\dim\cM(q,p_+)=0$ the sign is $o(M,q,p_+)=(-1)^{|p_+|+1}$.
		Indeed, a point in $\cM(q,p_+)$ is positively oriented if $\rT W^-_q \cong \la -\nabla f \ra \times {\rm N} W^+_{p_+}$. Here we identify ${\rm N}_{p_+} W^+_{p_+} \cong \rT_{p_+} W^-_{p_+}$, and the outer normal direction is represented by $ \nabla f$, so that the sign arises from
		\begin{align*}
			\rT W^-_{p_+} \times \rT W^+_{p_+}
			 & \;\cong\;  \rT W^-_q \times \rT W^+_q
			\;\cong\;
			\la -\nabla f \ra \times {\rm T} W^-_{p_+} \times \rT W^+_q \\
			 & \;\cong\;
			\rT W^-_{p_+} \times  \la (-1)^{1+ |p_+|} \nabla f \ra \times \rT W^+_q \times \rT \cM(q,p_+) .
		\end{align*}
		Similarly, for $\cM(p_-,q)\times \cM(q,M)\hookrightarrow\partial_1\bM(p_-,M)$ with $\dim \cM(p_-,q) = 0$ the sign is $o(p_-,q,M)=+1$ since $-\nabla f$ is an outer normal and $\rT W^-_{p_-} \cong \la -\nabla f \ra \times \rT W^-_{q}$ when $\rT \cM(p_-,q)=+ \{0\}$.

		\item
		For computational purposes in \S\ref{ssec:iso} we determine the fiber products of the compactified Morse trajectory spaces of critical points $p_-,p_+\in\Crit(f)$ with the same Morse index $|p_-|=|p_+|$,
		\begin{align*}
			\bM(p_-,M) \leftsub{\ev}{\times}_\ev \bM(M,p_+)
			 & \;=\;
			\left\{ (\ul\tau^- , \ul\tau^+ ) \in  \bM(p_-,M) \times \bM(M,p_+)
			\,\left|\, \ev(\ul\tau^-)= \ev(\ul\tau^+) \right. \right\}      \\
			 & \;=\; \begin{cases}
				         \quad \emptyset                      & ; p_-\neq p_+ , \\
				         (\tau^-\equiv p_-, \tau^+\equiv p_+) & ; p_-= p_+ .
			         \end{cases}
		\end{align*}
		To verify this recall that the compactifications $\bM(p_-,M)$ and $\bM(M,p_+)$ are constructed in \eqref{eq:bMk} via broken flow lines involving bi-infinite Morse trajectories in $\cM(p_i,p_{i+1})$, which are (defined to be) nonempty only for $|p_i|>|p_{i+1}|$. So we have
		$\cM(p_-,p_1)\times \ldots \times\cM(p_k,M)\subset \bM(p_-,M)$ only for $|p_k|<|p_-|$
		and $\cM(M,p_1)\times \ldots \times\cM(p_k,p_+)\subset \bM(M,p_+)$ only for $|p_1|>|p_+|$,
		and thus the image of the evaluation maps are contained in unions of unstable/stable manifolds
		$$ \textstyle
			\ev(\bM(p_-,M)) \;\subset\; W^-_{p_-} \cup \bigcup_{|q_-|<|p_-|} W^-_{q_-},
			\qquad
			\ev(\bM(M,p_+)) \;\subset\; W^+_{p_+} \cup \bigcup_{|q_+|>|p_+|} W^+_{q_+} .
		$$
		Since the intersections $W^-_{q_-}\cap W^+_{q_+}$ are transverse by the Morse-Smale condition, they can be nonempty only for $|q_-|+ \dim M - |q_+| \geq \dim M$. So this intersection is empty whenever $|q_+|>|q_-|$.
		Thus for $|q_-|<|p_-|=|p_+|<|q_+|$ in the above images we have empty intersections $W^-_{q_-}\cap W^+_{q_+}=\emptyset$ as well as $W^-_{q_-}\cap W^+_{p_+}=\emptyset$ and $W^-_{p_-}\cap W^+_{q_+}=\emptyset$.
		This proves
		$\ev(\bM(p_-,M))\cap \ev(\bM(M,p_+)) =  W^-_{p_-} \cap W^+_{p_+}$,
		and for $p_-\neq p_+$ this intersection is empty by transversality in \eqref{eq:inftraj}.
		Lastly, for $p_\pm=p$ we have
		$W^-_{p} \cap W^+_{p} = \{p\}$ since gradient flows do not allow for nontrivial self-connecting trajectories.
		This proves $\bM(p,M) \leftsub{\ev}{\times}_\ev \bM(M,p) = \{ (p,p) \}$.
	\end{enumilist}
\end{rmk}


\section{The PSS and SSP maps}
\label{sec:PSS}

In this section we construct the PSS and SSP morphisms in Theorem~\ref{thm:main} between Morse and Floer complexes.
As in the introduction, we fix a closed symplectic manifold $(M,\omega)$ and a smooth function $H:S^1\times M \to \R$. This induces a time-dependent Hamiltonian vector field $X_H:S^1\to \G(\rT M)$, which we assume to be nondegenerate. Thus it has a finite set of contractible periodic orbits, denoted by $\cP(H)$ as in \eqref{eq:PH}.
We moreover pick a Morse function $f:M\to\R$ and denote its -- again finite -- set of critical points by ${\rm Crit}(f)$. Then we will work with the Floer and Morse complexes over the Novikov field from Section~\ref{sec:Novikov},
$$
	CF=\oplus_{\g\in\cP(H)} \L \la \g \ra, \qquad\qquad CM=\oplus_{p\in {\rm Crit}(f)} \L \la p \ra ,
$$
and construct the $\L$-linear maps $PSS:CM \to CF$, $SSP: CF \to CM$ from moduli spaces which we introduce in \S\ref{ssec:moduli}. We provide these moduli spaces with a compactification and polyfold description in \S\ref{ssec:poly}, and in \S\ref{ssec:construct} rigorously construct the PSS/SSP map by using polyfold perturbations to obtain well defined (but still choice dependent) counts of compactified-and-perturbed moduli spaces.

\subsection{The Piunikhin-Salamon-Schwarz moduli spaces} \label{ssec:moduli}

To construct the moduli spaces, we need to make further choices as follows.
\begin{itemlist}
	\item
	Let $J$ be an $\omega$-compatible almost complex structure on $M$.

	Then the Cauchy-Riemann operator on maps $u: \Sigma \to M$ parametrized by a Riemann surface $\Sigma$ with complex structure $j$
	is $\dbar_J u := \frac 12 \bigl( \rd u + J(u) \circ \rd u \circ j\bigr)\in\Om^{0,1}(\Sigma,u^*\rT M)$.
	\item
	Let $g$ be a metric on $M$ such that $(f,g)$ is a Euclidean Morse-Smale pair as in Definition~\ref{def:ems}. It exists by Remark~\ref{rmk:Euclidean}.
	\item
	Let $\beta: [0,\infty) \to [0,1]$ be a smooth cutoff function with $\beta|_{[0,1]}\equiv 0$, $\beta'\geq 0$, and $\beta|_{[e,\infty)}\equiv 1$.

	Then we define the anti-holomorphic vector-field-valued 1-form
	$Y_H\in \Om^{0,1}(\C, \G(\rT M))$ in polar coordinates
	$$
		Y_H(re^{i\theta},x) := \tfrac 12 \beta(r) \bigl( J X_H(\theta,x) \, r^{-1} \rd r + X_H(\theta,x) \, \rd\theta  \bigr) .
	$$
	In the notation of \cite[\S8.1]{MS}, we have $Y_H=-(X_{H_\beta})^{0,1}$ given by the anti-holomorphic part of the 1-form with values in Hamiltonian vector fields $X_{H_\beta}$ which arises from the 1-form with values in smooth functions $H_\beta\in\Om^1(\C,\cC^\infty(M))$ given by
	$H_\beta (r e^{i\theta}) = \beta(r) H (\theta,\cdot) \rd\theta$.

	The vector-field-valued 1-form $Y_H$ encodes the Floer equation on both the positive cylindrical end $\{z\in \C\,|\, |z|\geq e\}\cong [1,\infty)\times S^1$ and the negative end $\{|z|\geq e\}\cong (-\infty,-1]\times S^1$ (where $\beta\equiv 1$) as follows:
	The reparametrization $v(s,t):= u(e^{\pm(s+it)})$ of a map $u: \C \to M$ satisfies the Floer equation $(\partial_s + J \partial_t) v(s,t) = J X_H(t,v(s,t))$ iff $\dbar_J u (z) = Y_H(z,u(z))$.

	\item
	For each $\g \in \cP(H)$,  fix a smooth disk
	$u_{\g} : D^2 \rightarrow M$ with $u_{\g}|_{\partial D^2}(e^{it}) = \g(t)$.

	We denote the oriented complex plane by $\mathbb{C}^{+}:=(\mathbb{C}, i)=\C$, and denote its reversed complex structure and orientation by $\mathbb{C}^{-}:=(\mathbb{C}, - i)$.
	Then for $u : \C^{\pm} \rightarrow M$ with $\lim_{R\rightarrow \infty} u(Re^{\pm i t}) = \g(t)$, denote by $u \# u_{\g} : \CP^1 \rightarrow M$ the continuous map given by gluing $u$ to $u_{\gamma}^{\pm}$ (where the $\pm$ denotes the orientation of $D^2$). By abuse of language, we will call $A:=[u \# u_{\g}] = (u \# u_{\g})_*[\CP^1] \in H_2(M)$ the homology class represented by $u$.
	Moreover, we denote by $\Ti u_\g: D^2 \to D^2\times M$ the graph of $u_\g$. Then the graph $\Ti u : \C \rightarrow \C\times M, z\mapsto (z,u(z))$ glues with $\Ti u_\g^{\pm}$ to a continuous map representing $[\Ti u \# \Ti u_{\g}] = \Ti A:= [\CP^1] + A \in H_2(\CP^1\times M)$, or more precisely $\Ti A = [\CP^1]\times[{\rm pt}] + [{\rm pt}]\times A$.
	Now the condition $[v \# \Ti u_{\g}] = \Ti A$ makes sense for other maps $v : \C \rightarrow \C\times M$ with the same asymptotic behaviour, and we say $v$ represents $\Ti A$.
	In fact, we will suppress the notation $\Ti A$ and label spaces with $A$ -- as this specifies the topological type of $v$.
\end{itemlist}

\medskip\noindent
Given such choices, the (choice-dependent) morphisms $PSS:CM \to CF$ and $SSP: CF \to CM$
will be constructed from the following moduli spaces for critical points $p\in{\rm Crit}(f)$, periodic orbits $\g\in\cP(H)$, and $A \in H_2(M)$
\begin{align*}
	\cM(p,\g; A) & := \bigl\{  u : \C^+ \to M \;\big|\; u(0)\in W^-_p , \; \dbar_J u = Y_H(u) \phantom{\ell}, \;\lim_{\scriptscriptstyle R\to\infty\phantom{-} } u(Re^{it})=\g(t) , \; [u \# u_{\g}] =A  \bigr\} , \\
	\cM(\g,p; A) & := \bigl\{ u : \C^- \to M \;\big|\; u(0)\in W^+_p , \; \dbar_J u = Y_H(u), \;\lim_{\scriptscriptstyle R\to\infty} u(Re^{-it})=\g(t) , \; [u \# u_{\g} ]=A \bigr\}.
\end{align*}
Each of these moduli spaces can be described as the zero set of a Fredholm section
$\dbar_J - Y_H : \cB_\pm \to \cE_\pm$. Here the Banach manifolds $\cB_\pm$ are given by a weighted Sobolev closure of the set of smooth maps $u: \C^{\pm} \to M$ representing the homology class $A$ with point constraint $u(0) \in W^\mp_p$ and satisfying a decay condition $\lim_{R \rightarrow \infty}u(Re^{\pm it})=\g(t)$, but not necessarily satisfying the perturbed Cauchy-Riemann equation $\dbar_J u = Y_H(u)$.
Then $\dbar_J - Y_H$ is a Fredholm section of index
\begin{align}\label{PSS index}
	I(p,\g;A) & = \phantom{-} CZ(\g) + 2c_1(A) - \tfrac{\dim M}{2} + |p| ,  \\
	I(\g,p;A) & = -CZ(\g) + 2c_1(A) + \tfrac{\dim M}{2}  - |p| ,  \nonumber
\end{align}
where $CZ(\g)$ is the Conley-Zehnder index with respect to a trivialization of $u_{\g}^*\rT M$ as in e.g.\ \cite{schwarz-thesis}, $c_1(A)$ is the first Chern class of $(TM,J)$ paired with $A$, and $|p|$ is the Morse index of $p \in {\rm Crit}(f)$.

If the moduli spaces were compact oriented manifolds, then we could define $PSS$ (and analogously $SSP$) by a signed count of the index $0$ solutions,
$$\textstyle
	PSS \la p \ra := \# \cM(p,\g; A) \cdot T^{\o(A)} \la \g \ra ,
$$
where the sum is over $\g\in \cP(H)$ and $A\in H_2(M)$ with $I(p,\g;A)=0$.
In many cases -- if sphere bubbles of negative Chern number can be excluded -- this compactness and regularity can be achieved by a geometric perturbation of the equation, e.g.\ in the choice of almost complex structure.
In general, obtaining well defined ``counts'' of the moduli spaces requires an abstract regularization scheme. We will use polyfold theory to replace ``$\# \cM(p,\g; A)$'' by a count of $0$-dimensional perturbed moduli spaces. In the presence of sphere bubbles with nontrivial isotropy, the perturbations will be multi-valued, yielding rational counts.

\begin{rmk} \rm \label{rmk:pss-energy}
	Compactness, or rather Gromov-compactifications, of the moduli spaces $\cM(p,\g; A)$ and $\cM(\g,p; A)$ will result from energy estimates \cite[Remark~8.1.7]{MS} for solutions of $\dbar_J u = Y_H(u)$,
	\begin{equation} \label{eq:pss-energy}
		\textstyle
		E(u) \,:=\; \frac 12 \int_\C |\rd u + X_{H_\beta}(u) |  \;\leq\;
		\int_\C u^*\omega + \|R_{H_\beta}\| \;\leq\; \omega([u\#u_\g]) + K .
	\end{equation}
	Here the curvature
	$R_{H_\beta} \dvol_\C = \rd H_\beta + \tfrac 12 { H_\beta\wedge H_\beta } =  \beta' \,  H \, \rd r \wedge \rd \theta$ has finite Hofer norm
	$$\textstyle
		\| R_{H_\beta}\| = \int_C ( \max R_{H_\beta} - \max R_{H_\beta} ) = \int_0^\infty \int_{S^1} |\beta'(r)| ( \max_{x\in M} H(\theta,x) -  \min_{x\in M} H(\theta,x) ) \,  \rd\theta \, \rd r
	$$
	since $\beta'$ has compact support in $[1,e]$.
	Since moreover $\cP(H)$ is a finite set, we obtain the above estimate with a finite constant
	$K := \| R_{H_\beta} \| +\max_{\g\in\cP(H)} \int_{D^2} u_\gamma^* \omega$.
	Thus the energy of the perturbed pseudoholomorphic maps in each of our moduli spaces will be bounded since we fix $[u\#u_\g]=A$.

	Now SFT-compactness \cite{sft-compactness} asserts that for any $C>0$ the set of solutions of bounded energy $\{  u : \C \to M \,| \, \dbar_J u = Y_H(u) , \lim_{\scriptscriptstyle R\to\infty} u(Re^{\pm it})=\g(t) , E(u)\leq C  \}$ is compact up to breaking and bubbling.
	This compactness will be stated rigorously in polyfold terms in Assumption~\ref{ass:iota,h}~(ii).
\end{rmk}


\subsection{Polyfold description of moduli spaces} \label{ssec:poly}

We will obtain a polyfold description for the moduli spaces in \S\ref{ssec:moduli} by a fiber product construction motivated by the natural identifications
\begin{equation}\label{eq:Mfiber}
	\cM(p,\g; A) \cong \cM(p,M) \leftsub{\ev}\times_{\ev} \cM^- (\g; A),
	\qquad
	\cM(\g,p; A) \cong \cM^+ (\g; A) \leftsub{\ev}\times_{\ev} \cM(M,p) .
\end{equation}
This couples the half-infinite Morse trajectory spaces from \S\ref{ssec:Morse} with a space of perturbed pseudoholomorphic maps
\begin{align}
	\cM^\pm(\g; A) & := \bigl\{ u : \C^{\pm} \to M  \;\big|\;  \dbar_J u = Y_H(u) , \; \lim_{\scriptscriptstyle R\to\infty} u(Re^{\pm it})=\g(t) , \; [u\# u_\g]=A \bigr\},  \label{HOLmod}
\end{align}
via the evaluation maps \eqref{eval} and
\begin{align}
	\label{HOLeval}
	\ev & : \cM^\pm(\g; A) \to M, \quad u \mapsto u(0).
\end{align}
More precisely, the general approach to obtaining counts or more general invariants from moduli spaces such as \eqref{eq:Mfiber} is to replace them by compact manifolds -- or more general `regularizations' which still carry `virtual fundamental classes').
Polyfold theory offers a universal regularization approach after requiring a compactification $\cM(\ldots)\subset\bM(\ldots)$ of the moduli space and a description of the compact moduli space $\bM(\ldots)=\sigma^{-1}(0)$ as zero set of a sc-Fredholm section $\sigma:\cB(\ldots)\to\cE(\ldots)$ of a strong polyfold bundle. For an introduction to the language \cite{HWZbook} used here see Appendix \S\ref{sec:polyfold}.

The Morse trajectory spaces are compactified and given a smooth structure in Theorem~\ref{thm:Morse}. The Gromov compactification and perturbation theory for \eqref{HOLmod} will be achieved by identifying theses spaces with moduli spaces that appear in Symplectic Field Theory (SFT) as introduced in \cite{egh}, compactified in \cite{sft-compactness, CM-SFT-compactness}, and given a polyfold description in \cite{fh-sft-full}.
Here we identify $u:\C\to M$ with the map to its graph $\Ti u : \C \to \C\times M, z \mapsto (z,u(z))$ as in \cite[\S8.1]{MS} to obtain a homeomorphism (in appropriate topologies) $\cM^\pm(\g; A) \cong \Ti\cM^\pm_{\rm SFT}(\Ti \g; A)/{\rm Aut}(\C^\pm)$
to an SFT moduli space for the symplectic cobordism\footnote{For definitions of these notions see \cite[\S2]{CM-SFT-compactness}.
	For $\C\times M$ the positive symplectization end is $\R^+\times S^1\times M \to \C\times M, (r, \theta , x) \mapsto ( e^{r+i\theta}, x)$. After reversing orientation on $\C$ there is an analogous negative end $\R^-\times S^1\times M \hookrightarrow \C^-\times M$.} $\C^\pm\times M$ between $\emptyset$ and $S^1\times M$. Here $S^1 \times M$ is equipped with the stable Hamiltonian structure
$(\pm\rd t,\omega + dH_t \wedge dt)$ whose Reeb field $\pm \partial_t + X_{H_t}$ has simply covered Reeb orbits\footnote{Here we have implicitly chosen asymptotic markers that fix a parametrization of each Reeb orbit.} given by the graphs $\tilde{\g} : t \mapsto (\pm t,\g(t))$ of the
periodic orbits $\g \in \cP(H).$
Moreover, ${\rm Aut}(\C^\pm)$ is the action of biholomorphisms $\phi:\C\to\C$ by reparametrization $v\mapsto v\circ\phi$ on the SFT space for an almost complex structure $\Ti J_H^\pm$ on $\C^\pm\times M$ induced by $J$, $X_H$, and $j=\pm i$ on $\C^\pm$,
$$
	\widetilde\cM^\pm_{\rm SFT}(\Ti\g; A) := \bigl\{ v : \C^\pm \to \C^\pm\times M  \;\big|\;  \dbar_{\Ti J^\pm_H} v = 0 , \; v(Re^{\pm it}) \sim \Ti\g_R(t) , \;  [v\#\Ti u_\g]=[\CP^1] + A \bigr\}   .
$$
More precisely, the asymptotic requirement is $d_{\C\times M}\bigl( v(Re^{\pm i(t + t_0)}) , \Ti\g_R(t) \bigr) \to 0$ for some $t_0 \in S^1$ as $R\to \infty$ for the graphs $\Ti\g_R(t) = ( Re^{\pm it} , \g(t) )$ of the orbit $\g$ parametrized by $S^1 \cong \{|z|=R\}\subset\C^\pm$.

To express the evaluation \eqref{HOLeval} in SFT terms note that a holomorphic map in the given homology class intersects the holomorphic submanifold $\{0\}\times M$ in a unique point\footnote{For solutions in $\widetilde\cM^\pm_{\rm SFT}(\Ti\g; A)$ this follows from
	$\pr_{\C^\pm}\circ v : \C^\pm \to \C^\pm$ being an entire function with a pole of order $1$ at infinity (prescribed by the asymptotics). For ${\Ti J^\pm_H}$-holomorphic curves in the compactification, it follows from positivity of intersections, see e.g.\ \cite[Prop.7.1]{CM}.
}, so we can fix the point $0\in\C^\pm$ in the domain where this intersection occurs and rewrite the moduli space $\cM^\pm(\g; A) \cong  \bigl\{ v \in \widetilde\cM^\pm_{\rm SFT}(\Ti\g; A) \;\big|\; v(0)\in \{0\}\times M \bigr\}/{\rm Aut}(\C^\pm,0)$ with a slicing condition and quotient by the biholomorphisms which fix $0\in\C^\pm$.
Thus we rewrite \eqref{eq:Mfiber} into the fiber products over $\C^\pm\times M$
\begin{align}\label{eq:MfiberSFT}
	\cM(p,\g; A) & \;\cong\; \cM(p,M) \; \leftsub{\{0\}\times \ev}\times_{\ev^+} \; \cM^+_{\rm SFT} (\g; A),          \\
	\cM(\g,p; A) & \;\cong\; \cM^-_{\rm SFT} (\g; A) \; \leftsub{\ev^-}\times_{\{0\}\times\ev} \; \cM(M,p)  \nonumber
\end{align}
using evaluation maps on the SFT moduli space with one marked point
\begin{align}
	\ev^\pm \;:\;  \cM^\pm_{\rm SFT}(\g; A) \,:=\; \quo{\widetilde\cM^\pm_{\rm SFT}(\Ti\g; A)}{{\rm Aut}(\C^\pm,0)}
	\;\to\; \C^\pm \times M, \qquad [v] \;\mapsto\;  v(0) .  \label{SFTeval}
\end{align}
Now we will obtain a polyfold description of the PSS/SSP moduli spaces \eqref{eq:MfiberSFT} by the slicing construction of \cite{Ben-fiber} applied to polyfold descriptions of the SFT-moduli spaces $\cM^\pm_{\rm SFT}(\Ti\g; A)$ (compactified as space of pseudoholomorphic buildings with one marked point).
This result is outlined in \cite{fh-sft}, but to enable a self-contained proof of our results, we formulate it as assumption, where we use
$$
	\overline{\C^\pm} \,:=\; \C^\pm \cup S_1 \; \cong\; \{z\in\C^\pm  \,|\, |z|\leq 1\}
$$
as target factor for a simplified evaluation map, as explained in the following remark.



\begin{rmk}\rm \label{rmk:evaluation drama}
	Note that the compactified moduli space $\bM^\pm_{\rm SFT}(\g; A)$ -- in view of the noncompact target $\C^\pm \times M$ -- contains broken curves $\ul v : \Sigma = \C^\pm \sqcup \R\times S^1 \sqcup \ldots \sqcup \R\times S^1 \to \Sigma\times M$. We do not need a precise description of this compactification (beyond the fact that it exists and is cut out by a sc-Fredholm section), but it affects the formulation of the evaluation maps $[\ul v , z_0] \mapsto \ul v(z_0)$ for a marked point $z_0\in\Sigma$ that $\ul v$ might map to a cylinder factor $\R\times S^1 \times M \subset \Sigma \times M$.
	We will simplify the resulting sc$^\infty$ evaluation with varying target -- being developed in \cite{fh-sft-full} -- to a continuous evaluation map
	$\overline\ev^\pm: \bM^\pm_{\rm SFT}(\g; A) \to \overline{\C^\pm}$ into the compactified target $\overline{\C^\pm}$.

	For that purpose we topologize $\overline{\C^\pm}\cong\{ |z|\leq 1 \}$ as a disk via a diffeomorphism $\C^\pm \to  \{|z|< 1\}$, $r e^{i\theta} \mapsto f(r) e^{i\theta}$ induced by a diffeomorphism $f:[0,\infty) \to [0,1)$ that is the identity near $0$, and its extension to a homeomorphism $\overline{\C^\pm}\to\{|z|\leq 1\}$ via $S^1=\qu{\R}{2\pi\Z} \to \{ |z|=1\}, \theta \mapsto e^{\pm i\theta}$.
	Then for any marked point $z_0\in\R\times S^1$ on a cylinder we project the evaluation $\ul v(z_0)\in\R\times S^1\times M$ to $S^1\times M= \partial\,\ov{\C^\pm}\times M$ by forgetting the $\R$-factor. The resulting simplified evaluation map will be unchanged and thus still sc$^\infty$ when restricted to the open subset $(\overline\ev^\pm)^{-1}(\C^\pm\times M)$ of the ambient polyfold -- as stated in (iii) below. This open subset inherits a scale-smooth structure, and still contains some broken curves -- just not those on which the marked point leaves the main component.
	This suffices for our purposes since the fiber product construction uses the evaluation map only in an open set of curves $[\ul v , z_0]$ with $\ul v(z_0)\approx 0 \in \C^\pm$.
\end{rmk}

In Assumption~\ref{ass:pss}, Remark~\ref{rmk:ass}, and Lemma~\ref{lem:PSS poly} we introduce some of the polyfolds under construction in \cite{fh-sft-full} and their expected properties. To describe these objects we introduce a significant amount of notation. A summary of the types of curves in each polyfold and subsets thereof is displayed in Table~\ref{tab:asspolyfolds} for the reader's convenience.

\begin{ass} \label{ass:pss}
	There is a collection of oriented sc-Fredholm sections of strong polyfold bundles $\s_{\rm SFT}: \cB^\pm_{\rm SFT}(\g; A)\to \cE^\pm_{\rm SFT}(\g;A)$ and continuous maps ${\ov\ev^\pm: \cB^\pm_{\rm SFT}(\g;A)\to \overline{\C^\pm} \times M}$, indexed by $\g\in\cP(H)$ and $A\in H_2(M)$, with the following properties.
	\begin{enumilist}
		\item
		The sections have Fredholm index $\text{\rm ind}(\s_{\rm SFT}) = CZ(\g) + 2c_1(A) + \tfrac{\dim  M}{2} + 2$ on $\cB^+_{\rm SFT}(\g; A)$, resp.\ $\text{\rm ind}(\s_{\rm SFT}) = - CZ(\g) + 2c_1(A) + \tfrac{\dim M}{2} + 2$ on $\cB^+_{\rm SFT}(\g; A)$.
		\item
		Each zero set
		$\bM^\pm_{\rm SFT}(\g; A):=\s_{\rm SFT}^{-1}(0)$ is compact, and given any $C\in\R$ there are only finitely many $A\in H_2(M)$ with $\omega(A)\leq C$ and nonempty zero set $\s_{\rm SFT}^{-1}(0)\cap \cB^\pm_{\rm SFT}(\g; A)\neq\emptyset$.
		\item
		The sections $\s_{\rm SFT}$ have tame sc-Fredholm representatives in the sense of \cite[Def.5.4]{Ben-fiber}, and the evaluation maps $\ov\ev^\pm$ restrict on the open subsets
		$\cB^{\pm,\C}_{\rm SFT}(\g;A) := (\ov\ev^\pm)^{-1}(\C^\pm\times M) \subset \cB^\pm_{\rm SFT}(\g;A)$ to sc$^\infty$ maps $\ev^\pm : \cB^{\pm,\C}_{\rm SFT}(\g;A) \to \C^\pm\times M$,
		which are $\s_{\rm SFT}$-compatibly submersive in the sense of Definition~\ref{def:submersion}. Finally, this open subset contains the interior,
		$\partial_0\cB^\pm_{\rm SFT}(\g;A)\subset\cB^{\pm,\C}_{\rm SFT}(\g;A)$.
	\end{enumilist}
\end{ass}


\begin{rmk} \label{rmk:ass} \rm
	\begin{enumilist}
		\item
		The polyfolds, bundles, and sections in Assumption~\ref{ass:pss} are constructed for a closely analogous situation (considering curves in $\R\times Q$, with e.g.\ $Q=S^1\times M$) in \cite[\S 3]{fh-sft}, so -- while not needed for our proof -- we state the following properties for intuition:

		\smallskip\noindent
		{\it
		Equivalence classes under reparametrization of ${\rm Aut}(\C^\pm,0)$ of smooth maps $v: \C^\pm \to \C^\pm\times M$ that satisfy $v(Re^{\pm it})=\bigl(Re^{\pm it}, \g(t)\bigr)$ for sufficiently large $R>1$ and represent the class $[v\#\Ti u_\g]= [\CP^1] + A$ form a dense subset $\cB^\pm_{\rm dense}(\g;A)\subset \cB^\pm_{\rm SFT}(\g;A)$ contained in the interior.
		On this subset, the section is $\s_{\rm SFT}([v]) = [(v, \dbar_{\Ti J_H^\pm} v)]$
		and $\ov\ev^\pm([v])$ is evaluation as in \eqref{SFTeval}.
		The intersection of $\s_{\rm SFT}^{-1}(0)$ with this dense subset is contained in the moduli space $\cM^\pm_{\rm SFT}(\g; A)$ from \eqref{SFTeval}.  The full moduli space $\cM^\pm_{\rm SFT}(\g; A)$ is obtained by enlarging $\cB^\pm_{\rm dense}(\g;A)$ to include equivalence classes with $\sup_{t\in S^1} d_{\C\times M}\bigl( v(Re^{\pm it}) , (Re^{\pm it}, \g(t)) \bigr)\to 0$ as $R\to\infty$.  However, only classes with specific exponential decay of this quantity and related derivatives are contained in $\cB^\pm_{\rm SFT}(\g;A)$.
		}
		\smallskip



		\item The sc-smooth structure, sc-Fredholm property, and compactness is stated in \cite[Thm.3.4]{fh-sft}. The proof of polyfold and bundle structure outlined in \cite[\S 7--11]{fh-sft} extends the construction of Gromov-Witten polyfolds in \cite{hwz-gw} by local models for punctures and neck-stretching from \cite[\S 3]{fh-2}, using the implanting method in \cite[\S 3,\S 5]{fh-1}. These constructions automatically satisfy the tameness assumed in (iii).
		The nonlinear Fredholm property needs to be proven globally -- in close analogy to \cite{hwz-gw}. The Fredholm index stated in (i) is computed in a local chart, where the linearized section coincides with a restriction of the classical linearized Cauchy-Riemann operator to a local slice to the reparametrization action. The compactness properties follow from SFT-compactness of the moduli spaces \cite{sft-compactness} since the topology on the polyfolds given in \cite[\S 3.4]{fh-sft} generalizes the notion of SFT-convergence.
		Orientations are constructed in \cite[\S 15]{fh-sft}.
		Sc-smoothness of the evaluation maps is proven analogously to \cite[Thm.1.8]{hwz-gw}, and their submersion property in (iii), which is used to construct fiber products in Lemma~\ref{lem:PSS poly}, is proven as in \cite[Ex.5.1]{Ben-fiber}.

		\item
		We also expect the existence of a direct polyfold description of the moduli space \eqref{HOLmod} in terms of a collection of sc-Fredholm sections $\s: \cB^\pm(\g; A)\to \cE^\pm(\g;A)$ with the same indices, and submersive sc$^\infty$ maps ${\ev^\pm: \cB^\pm(\g;A)\to M}$ with the following simplified properties.

		\smallskip\noindent
		{\it
			The smooth maps $u: \C \to M$ which equal $u(Re^{\pm it})= \g(t)$ for sufficiently large $R>1$ and represent the class $A$ form a dense subset of $\cB^\pm(\g; A)$ that is contained in the interior. On this subset, the section is $\s(u) =  \dbar_{J} u - Y_H(u)$, and the evaluation is $\ev^\pm(u)=u(0)$.
			The intersection of $\s^{-1}(0)$ with this dense subset is contained in the moduli space $\cM^\pm(\g; A)$ from \eqref{HOLmod}.
			The full moduli space $\cM^\pm(\g; A)$ is obtained by enlarging the dense subset to include maps with $\sup_{t\in S^1} d_{M}\bigl( u(Re^{\pm it}) , \g(t) \bigr)\to 0$ as $R\to\infty$.  However, only maps with specific exponential decay of this quantity and related derivatives are contained in $\cB^\pm(\g;A)$.
		}

		\smallskip

		While such a construction should follow from the same construction principles as in \cite{fh-sft}, there is presently no writeup beyond \cite{W-Fred}, which proves the Fredholm property in a model case. Alternatively, one could abstractly obtain this construction from restricting the setup in Assumption~\ref{ass:pss} to subsets consisting of maps of the form $v(z)=(z, u(z))$.
		Thus there would be no harm in using this property as intuitive guide for following our work with the abstract setup.
	\end{enumilist}
\end{rmk}


Given one or another polyfold description of the naturally identified moduli spaces \eqref{HOLmod} or \eqref{SFTeval} and corresponding evaluation maps, we will now extend the identifications \eqref{eq:Mfiber} or  \eqref{eq:MfiberSFT} to a fiber product construction of polyfolds which will contain these PSS/SSP moduli spaces. For $p\in{\rm Crit}(f)$, $\g\in\cP(H)$, and $A\in H_2(M)$ we define the topological spaces
\begin{align}
	\tilde{\cB}^+(p,\g; A) & := \bigl\{ (\ul{\t},\ul{v})\in\bM(p,M) \times \cB^+_{\rm SFT}(\g;A)  \,\big|\, ( 0 , \ev(\ul{\t}) ) = \ov\ev^+(\ul{v}) \bigr\} \nonumber             \\
	                       & \;= \bigl\{ (\ul{\t},\ul{v})\in\bM(p,M) \times \cB^{+,\C}_{\rm SFT}(\g;A)  \,\big|\, ( 0 , \ev(\ul{\t}) ) = \ev^+(\ul{v}) \bigr\}, \label{eq:Bfiber} \\
	\tilde{\cB}^-(\g,p; A) & := \bigl\{ (\ul{v},\ul{\t})\in  \cB^-_{\rm SFT}(\g;A) \times \bM(M,p)  \,\big|\, (0 , \ev(\ul{\t})) = \ov\ev^-(\ul{v}) \bigr\}  \nonumber            \\
	                       & \;= \bigl\{ (\ul{v},\ul{\t})\in  \cB^{-,\C}_{\rm SFT}(\g;A) \times \bM(M,p)  \,\big|\, (0 , \ev(\ul{\t})) = \ev^-(\ul{v}) \bigr\}.  \nonumber
\end{align}
We will use \cite{Ben-fiber} to equip these spaces with natural polyfold structures and show that the pullbacks of the sections $\sigma_{\rm SFT}$ by the projections to $\cB^\pm_{\rm SFT}(\g;A)$ yield sc-Fredholm sections whose zero sets are compactifications of the PSS/SSP moduli spaces.
This will require a shift in levels which is of technical nature as each $m$-level $\cB_m\subset\cB$ contains the dense ``smooth level'' $\cB_\infty\subset\cB_m$, which itself contains the moduli space $\bM=\s^{-1}(0)\subset\cB_\infty$; see Remark~\ref{rmk:levels}.



\begin{lem} \label{lem:PSS poly}
	For any $p\in{\rm Crit}(f)$, $\g\in\cP(H)$, and $A\in H_2(M)$ there exist open subsets $\cB^+(p,\g; A)  \subset \tilde{\cB}^+(p,\g; A)_1$ and $\cB^-(\g,p; A) \subset \tilde{\cB}^-(\g,p; A)_1$ which contain the smooth levels $\tilde{\cB}^\pm(\ldots;A)_\infty$ of the fiber products \eqref{eq:Bfiber} and inherit natural polyfold structures.
	The smooth level of their interior is\footnote{
		Here we can only make statements about the smooth level because we do not know what points of other levels are included in the fiber products. This is sufficient for applications as the zero set of any sc-Fredholm section (and its admissible perturbations) is contained in the smooth level.
	}
	\begin{align*}
		\partial_0\cB^+(p,\g; A)_\infty & \;=\; \cM(p,M) \; \leftsub{\{0\}\times\ev}{\times_{\ev^+}} \; \partial_0\cB_{\rm SFT}^{+,\C}(\g; A)_\infty  , \qqquad \\
		\partial_0\cB^-(\g,p; A)_\infty & \;=\; \partial_0\cB_{\rm SFT}^{-,\C}(\g; A)_\infty \; \leftsub{\ev^-}{\times_{\{0\}\times\ev}}\;  \cM(M,p)  .
	\end{align*}
	Moreover, pullback of the sc-Fredholm sections of strong polyfold bundles $\sigma^\pm_{\rm SFT}: \cB^\pm_{\rm SFT}(\g;A) \to \cE^\pm_{\rm SFT}(\g; A)$ under the projection $\cB^\pm(\ldots; A) \to \cB^\pm_{\rm SFT}(\ldots; A)$ induces sc-Fredholm sections of strong polyfold bundles $\s^+_{(\g,p; A)}: \cB^+(\g,p;A) \to \cE^+(\g,p;A)$ resp.\  $\s^-_{(p,\g; A)}: \cB^-(p,\g;A) \to \cE^-(p,\g;A)$ of index $I(p,\g; A)$ resp.\ $I(\g,p; A)$ given in \eqref{PSS index}.
	Their zero sets contain\footnote{
		As in Remark~\ref{rmk:ass}, this identification is stated for intuition and will ultimately not be used in our proofs. }
	the moduli spaces from \S\ref{ssec:moduli},
	\begin{align*}
		{\s^+_{(p,\g; A)}}\!\!^{-1}(0) & \;=\; \bM(p,M) \;\leftsub{\{0\}\times\ev}{\times_{\ov\ev^+}} \; {\s_{\rm SFT}^+}^{-1}(0)  \;\supset\; \cM(p,\g; A),
		\qquad                                                                                                                                               \\
		{\s^-_{(\g,p; A)}}\!\!^{-1}(0) & \;=\;  {\s_{\rm SFT}^-}^{-1}(0)\; \leftsub{\ov\ev^-}{\times_{\{0\}\times\ev}} \; \bM(M,p) \;\supset\; \cM(\g,p; A).
	\end{align*}
	Finally, each zero set ${\s^\pm_{(\ldots;A)}}\!\!^{-1}(0)$ is compact, and given any $p\in\Crit(f)$, $\g\in\cP(H)$, and $C\in\R$, there are only finitely many $A\in H_2(M)$ with  $\omega(A)\leq C$ and nonempty zero set ${\s^\pm_{(\ldots;A)}}\!\!^{-1}(0)\neq\emptyset$.
\end{lem}

\begin{proof}
	We will follow \cite[Cor.7.3]{Ben-fiber} to construct the PSS polyfold, bundle, and sc-Fredholm section $\s^+_{p,\g;A}$ in detail, and note that the construction of the SSP section $\s^-_{\g,p;A}$ is analogous.

	Consider an ep-groupoid representative $\cX = (X,{\bf X})$ of the polyfold $\cB^+_{\rm SFT}(\g;A)$ with source and target maps denoted $s,t : {\bf X} \rightarrow X$ together with a strong bundle $P : W \rightarrow X$ over the $M$-polyfold $X$ and a structure map $\mu : {\bf X} \leftsub{s}\times_{P} W \rightarrow X$ such that the pair $(P,\mu)$ is a strong bundle over $\cX$ representing the polyfold bundle $\cE^+_{\rm SFT}(\g;A) \rightarrow \cB^+_{\rm SFT}(\g;A)$. In addition, consider a sc-Fredholm section functor $S_{\rm SFT} : X \rightarrow W$ of $(P,\mu)$ that represents $\s^+_{\rm SFT}$. The ep-groupoid $\cX$ and the bundle $(P,\mu)$ are tame, since they represent a tame polyfold and a tame bundle, respectively. Moreover, $S_{\rm SFT}$ is a tame sc-Fredholm section in the sense of \cite[Def.5.4]{Ben-fiber} by Assumption~\ref{ass:pss}(iii).

	We view the Morse moduli space $\bM(p,M)$ as the object space of an ep-groupoid with morphism space another copy of $\bM(p,M)$ and with unit map a diffeomorphism; that is, the only morphisms are the identity morphisms. The unique rank-$0$ bundle over $\bM(p,M)$ is a strong bundle in the ep-groupoid sense, and the zero section of this bundle is a tame sc-Fredholm section functor.
	Next, note that $\tilde{\cB}^+(p,\g; A) \subset \bigl\{ (\ul{\t},\ul{v})\in\bM(p,M) \times |X|  \,|\, \ov\ev^+(\ul{v})\in \{0\}\times M \bigr\} \subset \bM(p,M) \times |X^\ev|$
	is represented within the open subset $X^\ev:=(\ov\ev^+)^{-1}(\C \times M)\subset X$ and the corresponding full ep-subgroupoid $\cX^\ev$ of $\cX$, which represent the open subset $\cB^{+,\C}_{\rm SFT}(\g,A)\subset |X|$,
	and by Assumption~\ref{ass:pss}(iii) the restricted evaluation $\ev^+ : X^\ev \rightarrow \C\times M$ is sc$^\infty$ and $S_{\rm SFT}$-compatibly submersive (see Definition~\ref{def:submersion}).
	Denote by $\ev_0: \bM(p,M) \rightarrow \C\times M, \ul\tau\mapsto (0,\ev(\ul\tau))$ the product of the trivial map to $0\in\C$ and the Morse evaluation map.
	We claim that the product map $\ev_0 \times \ev^+ : \bM(p,M) \times X^\ev \rightarrow (\C\times M) \times (\C\times M)$ is $S_{\rm SFT}$-compatibly transverse to the diagonal $\Delta \subset (\C \times M) \times (\C\times M)$.
	Indeed, given $(\ul{\t},\ul{v}) \in (\ev_0 \times \ev^+)^{-1}(\Delta)$ let
	$L \subset \rT_{\ul{v}}^RX^{\ev}$ be a sc-complement of the kernel of the linearization of $\ev^+$ at some $\ul{v} \in X^{\ev}_{\infty}$ that satisfies the conditions for $S_{SFT}$-compatible submersivity
	in Definition~\ref{def:submersion} w.r.t.\ a coordinate change $\psi^{ev}$ on a chart of $X^{\ev}$.
	Then the subspace $\{0\} \times L \subset \rT^R_{\ul{\t}}\overline{\cM}(p,M) \times \rT^R_{\ul{v}}X^{\ev}$ satisfies the conditions for $S_{\rm SFT}$-compatible transversality of $\ev_0 \times \ev^+$ with $\Delta$ at $(\ul{\t},\ul{v})$ w.r.t.\ the product change of coordinates $\id\times\psi^\ev$ in a product chart on the Cartesian product $\overline{\cM}(p,M) \times X^{\ev}$.
	(See \cite[Lem.7.1,~7.2]{Ben-fiber} for a discussion of the sc-Fredholm property on Cartesian products.)


	Next, note that $\bM(p,x) \leftsub{\ev_0}{\times_{\ev^+}} X^\ev_{\infty}$ represents the smooth level of the fiber product topological space $\tilde{\cB}^+(p,\g; A)$.
	So \cite[Cor.7.3]{Ben-fiber} yields an open neighbourhood $X' \subset \bM(p,M) \leftsub{\ev_0}{\times_{\ev^+}} X^\ev_1$ containing the smooth level $\bM(p,x) \leftsub{\ev_0}{\times_{\ev^+}} X^\ev_{\infty}$ such that the full subcategory $\cX' := (X',{\bf X}')$ of $\bM(p,M) \times \cX^\ev_1$ is a tame ep-groupoid and the pullbacks of $(P,\mu)$ and $S_{\rm SFT}$ to $\cX'$ are a tame bundle and tame sc-Fredholm section.
	Here we used the fact that the smooth level $\bM(p,x)_\infty=\bM(p,x)$ of any finite dimensional manifold is the manifold itself; see Remark~\ref{rmk:levels}.

	The tame ep-groupoid $\cX'$ yields the claimed polyfold $\cB^+(p,\g;A):=|\cX'|$, and similarly the pullbacks of $(P,\mu)$ and $S_{\rm SFT}$ through the projection $X' \rightarrow X_1$ define the claimed bundle and sc-Fredholm section $\s^+_{(p,\g;A)} : \cB^+(p,\g;A) \rightarrow \cE^+(p,\g;A)$. The identification of the interior $\partial_0\cB^+(p,\g;A)_\infty$ follows from the degeneracy index formula $d_{\cX'}(x_1,x_2) = d_{\bM(p,M)}(x_1) + d_{\cX}(x_2)$ in \cite[Cor.7.3]{Ben-fiber} and the interior of the Morse trajectory spaces $\partial_0 \bM(p,M) = \cM(p,M)$ from Theorem~\ref{thm:Morse}.

	The index formula in \cite[Cor.7.3]{Ben-fiber} yields $\text{\rm ind}(\s^+_{(p,\g;A)}) = \text{\rm ind}(\s_{\rm SFT}) + |p| - \dim(\C\times M) = I(p,\g;A)$ since $\dim \bM(p,M) = |p|$ and $\text{\rm ind}(\s_{\rm SFT}) = CZ(\g) + 2c_1(A) + \frac 12 \dim M + 2$.

	Finally, the zero set ${\s^+_{(p,\g;A)}}^{-1}(0)$ is
	the fiber product of the zero sets as claimed, as these are contained in the smooth level, and
	the restriction to $\ov\ev^{-1}(\{0\}\times M)$ already restricts considerations to the domain $X^\ev$ from which the fiber product polyfold is constructed.
	Moreover, ${\s^+_{(p,\g;A)}}^{-1}(0)$ is compact as in \cite[Cor.7.3]{Ben-fiber}, since both $\bM(p,M)$ and ${\s^+_{\rm SFT}}^{-1}(0)$ are compact
	and both $\ev_0$ and $\ov\ev^+$ are continuous. The final statement then follows from Assumption~\ref{ass:pss}(ii).
\end{proof}



\begin{table}
	\centering
	\begin{tabular}{||c | c | c ||}
		\hline
		Notation                                                                                          & Description                                                                               & Definition \\ [0.5ex]
		\hline\hline
		$\cB^\pm_{\rm dense}(\g;A)$                                                                       & \thead{elements are equivalence classes under reparameterization by ${\rm Aut}(\C^\pm,0)$              \\ of smooth maps $v: \C^\pm \to \C^\pm\times M$ that satisfy $v(Re^{\pm it})=\bigl(Re^{\pm it}, \g(t)\bigr)$ \\ for sufficiently large $R>1$ and represent the class $[v\#\Ti u_\g]= [\CP^1] + A$ }
		                                                                                                  & Remark~\ref{rmk:ass}                                                                                   \\
		\hline
		$\cB^\pm_{\rm SFT}(\g; A) $                                                                       & \thead{
		a polyfold with dense subset $\cB^\pm_{\rm dense}(\g;A)$, which contains the                                                                                                                               \\ SFT-compactification $\bM^\pm_{\rm SFT}(\g; A)$
			of the moduli space in \eqref{SFTeval}}
		                                                                                                  & \thead{Assumption~\ref{ass:pss},                                                                       \\ Remark~\ref{rmk:ass}} \\
		\hline
		$\cB^{\pm,\C}_{\rm SFT}(\g;A)$                                                                    & \thead{the open subset of $\cB^\pm_{\rm SFT}(\g; A)$ containing the curves whose                       \\ evaluation   at
			a marked point lands in $\mathbb{C}^{\pm} \times M$
		rather than                                                                                                                                                                                                \\ in a broken off cylinder $\R\times S^1\times M$; see Remark~\ref{rmk:evaluation drama} }
		                                                                                                  & \thead{Assumption~\ref{ass:pss}(iii)
		}                                                                                                                                                                                                          \\
		\hline
		$\tilde{\cB}^+(p,\g; A)$                                                                          & \thead{elements are pairs of a half-infinite broken Morse trajectory                                   \\ starting from the critical point $p$ and a curve in $\cB^{+,\C}_{\rm SFT}(\g;A)$, \\
			whose evaluation agrees with the end point of the Morse trajectory}
		                                                                                                  & \eqref{eq:Bfiber}                                                                                      \\
		\hline
		$ \tilde{\cB}^-(\g,p; A)$                                                                         & \thead{elements are pairs of a half-infinite broken Morse trajectory                                   \\ ending at the critical point $p$ and a curve in $\cB^{-,\C}_{\rm SFT}(\g;A)$, whose \\
			evaluation agrees with the starting point of the Morse trajectory}
		                                                                                                  & \eqref{eq:Bfiber}                                                                                      \\
		\hline
		$\cB^+(p,\g; A)$                                                                                  & \thead{open subset of $\tilde{\cB}^+(p,\g; A)_1$ containing $\cM(p,\g; A)$                             \\ over which the section $\s^+_{(p,\g;A)}$ is sc-Fredholm \\
		(possibly smaller than $\tilde{\cB}^+(p,\g; A)_1$ due to shrinking in \cite[Cor.7.3]{Ben-fiber})} & Lemma~\ref{lem:PSS poly}                                                                               \\
		\hline
		$ \cB^-(\g,p; A)$                                                                                 & \thead{open subset of $\tilde{\cB}^-(\g,p; A)_1$ containing $\cM(\g,p; A)$                             \\ over which the section $\s^-_{(p,\g;A)}$ is sc-Fredholm}  & Lemma~\ref{lem:PSS poly} \\ [1ex]
		\hline
	\end{tabular}
	\caption{
		Summary of the polyfolds and their subsets introduced in this section
	}
	\label{tab:asspolyfolds}
\end{table}

\subsection{Construction of the morphisms} \label{ssec:construct}


To construct the $\L$-linear maps PSS and SSP in Theorem~\ref{thm:main} with relatively compact notation we index all moduli spaces from \S\ref{ssec:moduli} by the two sets
\begin{align*}
	\cI^+ & \,:=\; \bigl\{ \alpha=(p,\g;A) \,\big|\,
	p\in{\rm Crit}(f) , \g\in\cP(H) , A\in H_2(M) \bigr\},                                                    \\
	\cI^- & \,:=\;  \bigl\{ \alpha=(\g,p;A) \,\big|\, p\in{\rm Crit}(f) , \g\in\cP(H) , A\in H_2(M) \bigr\} .
\end{align*}
To simplify notation we then denote $\cI:=\cI^-\cup\cI^+$ and drop the superscripts from the polyfolds $\cB(\alpha)=\cB^\pm(\alpha)$.
Since Lemma~\ref{lem:PSS poly} provides each moduli space $\cM(\alpha)$ for $\alpha\in \cI$ with a compactification and polyfold description $\cM(\alpha)\subset\sigma_{\alpha}^{-1}(0)$, we can apply \cite[Theorems~18.2,18.3,18.8]{HWZbook} to obtain admissible regularizations of the moduli spaces, and counts of the 0-dimensional perturbed solution spaces \cite[\S15.4]{HWZbook}, in the following sense. Here we denote by $\Q^+:=\Q\cap[0,\infty)$ the groupoid with only identity morphisms.


\begin{cor}  \label{cor:regularize}
	\begin{enumilist}
		\item
		For every $\alpha\in \cI$, choice of neighbourhood of the zero sets $\sigma_{\alpha}^{-1}(0)\subset \cV_{\alpha}\subset \cB(\alpha)$, and choice of sc-Fredholm section functor $S_{\alpha}: \cX_{\alpha} \to \cW_{\alpha}$ representing $\sigma_{\alpha}|_{\cV_{\alpha}}$, there exists a pair $(N_\alpha,\cU_\alpha)$ controlling compactness in the sense of Definition~\ref{def:control} with $|S_{\alpha}^{-1}(0)|\subset |\cU_{\alpha}| \subset \cV_{\alpha}$.

		For $\alpha\in\cI$ with $\sigma_\alpha^{-1}(0)=\emptyset$ we can choose $\cU_{\alpha}=\emptyset$.
		\item
		For every collection $(N_{\alpha}, \cU_{\alpha})_{\alpha\in \cI}$ of
		pairs controlling compactness, there exists a collection $\underline\kappa = \bigl( \kappa_{\alpha}:\cW_{\alpha}\to\Q^+\bigr)_{\alpha \in\cI}$ of $(N_{\alpha}, \cU_{\alpha})$-admissible sc$^+$-multisections in the sense of \cite[Definitions~13.4,15.5]{HWZbook}
		that are in general position relative to $(S_\alpha)_{\alpha\in\cI}$ in the sense that each pair $(S_\alpha,\kappa_\alpha)$ is in general position as per \cite[Def.15.6]{HWZbook}.

		Here admissibility in particular implies $\kappa_\alpha\circ S_\alpha |_{\cX_\alpha\less\cU_\alpha} \equiv 0$ and thus $\kappa_\alpha\circ S_\alpha\equiv 0$ when $\sigma_\alpha^{-1}(0)=\emptyset$.
		\item
		Every collection $\underline\kappa$ of admissible sc$^+$-multisections in general position  from (ii) induces a collection of compact, tame, branched ep$^+$-groupoids
		$\bigl(\kappa_{\alpha}\circ S_{\alpha}: \cX_{\alpha} \to \Q^+\bigr)_{\alpha\in\cI}$. In particular, each perturbed zero set
		$$
			Z^{\underline\kappa}(\alpha)\,:=\; \bigl|\{x\in X_{\alpha} \,|\, \kappa_{\alpha}(S_{\alpha}(x))>0\} \bigr|  \;\subset\; |\cU_\alpha| _\infty \;\subset\; |\cX_{\alpha}|_\infty  \;\cong\; \cB(\alpha)_\infty
		$$
		is compact, contained in the smooth level,
		and carries the structure of a weighted branched orbifold of dimension $I(\alpha)$ as in \eqref{PSS index}.
		Moreover, the inclusion in $|\cU_\alpha|$ and general position of $\ul\kappa$ implies that for $I(\alpha)<0$ or $\sigma_\alpha^{-1}(0)=\emptyset$ the perturbed zero set $Z^{\underline\kappa}(\alpha)=\emptyset$ is empty.
		\item
		For $\alpha\in\cI$ with Fredholm index $I(\alpha)=0$ and $\kappa_\alpha: \cW_{\alpha}\to\Q^+$ as in (ii) the perturbed zero set is contained in the interior $Z^{\underline\kappa}(\alpha)\subset\partial_0\cB(\alpha)_\infty$ and yields a well defined count
		$$\textstyle
			\# Z^{\underline\kappa}(\alpha) \,:=\; \sum_{|x|\in Z^{\underline\kappa}(\alpha)}
			\; o_{\s_\alpha}(x) \; \kappa_{\alpha}(S_{\alpha}(x))
			\;\;\in\;\Q .
		$$
		Here $o_{\s_\alpha}(x)\in \{\pm 1\}$ is determined by the orientation of $\s_\alpha$ as in \cite[Thm.6.3]{HWZbook}.
		If $|\cU_\alpha|\cap\partial\cB(\alpha)=\emptyset$ then this count is independent of the choice of admissible sc$^+$-multisection $\k_\alpha$.
		\item
		For every $\alpha\in\cI$ with Fredholm index $I(\alpha)=1$ and $\kappa_\alpha: \cW_{\alpha}\to\Q^+$ as in (ii) the boundary of the perturbed zero set is given by its intersection with the first boundary stratum of the polyfold,
		$$
			\partial Z^{\underline\kappa}(\alpha) \;=\;  Z^{\underline\kappa}(\alpha)  \cap \partial_1\cB(\alpha)_\infty .
		$$
		With orientations $o_{\s_\alpha|_\partial\cB(\alpha)}(x)\in \{\pm 1\}$ induced by the boundary restriction $\sigma_\alpha|_{\cB(\alpha)}$ this implies
		$$\textstyle
			\# \partial Z^{\underline\kappa}(\alpha) \,=\; \sum_{|x|\in \partial Z^{\underline\kappa}(\alpha)}
			\; o_{\s_\alpha|_{\partial\cB(\alpha)}}(x)\;\kappa_{\alpha}(S_{\alpha}(x))
			\;\;=\; 0.
		$$
	\end{enumilist}
\end{cor}


\begin{rmk} \label{rmk:PSS orient} \rm
	\begin{enumilist}
		\item
		The statements in (iv) and (v) of Corollary~\ref{cor:regularize} require orientations of the sections $\s_\alpha$ for $\alpha\in\cI$. By the fiber product construction in Lemma~\ref{lem:PSS poly} they do indeed inherit orientations from the orientations of the Morse trajectory spaces in Remark~\ref{rmk:MorseOrient}, the orientations of $\s_{\rm SFT}^\pm$ given in Assumption~\ref{ass:pss}, and an orientation convention for fiber products.

		In practice, we will construct the perturbations $\ul\k$ in Corollary~\ref{cor:regularize} by pullback of perturbations $\ul \lambda=(\lambda^\pm_{\g,A})_{\g\in\cP, A\in H_2(M)}$ of the oriented SFT-sections $\s_{\rm SFT}^\pm$. Thus it suffices to specify the orientations of the regularized zero sets, which is implicit in their identification with transverse fiber products of oriented spaces over the oriented manifold $M$,
		\begin{align*}
			Z^{\ul\k}(p,\g; A) \;=\; \bM(p,M) \; \leftsub{\ev_0}{\times_{\ev^+}} \; Z^{\ul\l}(\g;A)  , \qquad
			Z^{\ul\k}(\g,p; A) \;=\; Z^{\ul\l}(\g; A) \; \leftsub{\ev^-}{\times_{\ev_0}}\;  \bM(M,p)  .
		\end{align*}
		Orientations of the boundary restrictions in (v) are then induced by the orientations of $Z^{\ul\k}(\alpha)$, via oriented isomorphisms of the tangent spaces $\R\nu(z) \times \rT_z \partial Z^{\ul\k}(\alpha) \cong  \rT_z  Z^{\ul\k}(\alpha)$, where $\nu(z)\in  \rT_z  Z^{\ul\k}(\alpha)$ is an exterior normal vector at $z\in \partial Z^{\ul\k}(\alpha)$.

		\item
		Note that the counts in part (iv) of this Corollary may well depend on the choice of the multi-valued perturbations $\kappa_\alpha$ -- unless the ambient polyfold has no boundary, $\partial\cB(\alpha)=\emptyset$.
		Indeed, although the moduli space $\cM(\alpha)$ is expected to have dimension $0$, it may not be cut out transversely from the ambient polyfold $\cB(\alpha)$, and moreover it may not be compact. Assumption~\ref{ass:pss} provides an inclusion in a compact set $\cM(\alpha)\subset\sigma_{\alpha}^{-1}(0)$, and the perturbation theory for sc-Fredholm sections of strong bundles then associates to $\sigma_{\alpha}^{-1}(0)$ a perturbed zero set $Z^{\underline\kappa}(\alpha)\subset \cB(\alpha)$ with weight function $\kappa_\alpha\circ S_\alpha:  Z^{\underline\kappa}(\alpha) \to \Q\cap (0,\infty)$. This process generally adds points on the boundary $\sigma_{\alpha}^{-1}(0)\less \cM(\alpha)\subset \cB(\alpha) \less \partial_0\cB(\alpha)$, which may or may not persist under variations of the perturbation $\kappa_\alpha$.
	\end{enumilist}
\end{rmk}


The following construction of morphisms will depend on the choices of perturbations and orientation convention (see the previous remark) as well as geometric data fixed in \S\ref{ssec:moduli}, and possibly the choice of polyfold construction in Assumption~\ref{ass:pss} and ep-groupoid representation in Remark~\ref{rmk:polyfolds}.
The algebraic properties in Theorem~\ref{thm:main} will be achieved in \S\ref{sec:algebra} -- for any given choice of geometric data -- by particular choices of ep-groupoids and perturbations $\underline\kappa^\pm$, and an overall sign adjustment.



\begin{dfn} \label{def:PSS}
	Given collections $\underline\kappa^\pm=( \kappa^\pm_{\alpha} )_{\alpha \in\cI^\pm}$ of admissible sc$^+$-multisections in general position as in Corollary~\ref{cor:regularize}, we define the maps $PSS_{\underline\kappa^+}:CM \to CF$ and $SSP_{\underline\kappa^-}: CF \to CM$ to be the $\Lambda$-linear extension of
	$$
		PSS_{\underline\kappa^+} \la p \ra := \hspace{-5mm} \sum_{\begin{smallmatrix}
				\scriptstyle  \g, A  \\ \scriptscriptstyle I(p,\g;A)=0  \end{smallmatrix} }  \hspace{-4mm}
		\# Z^{\underline\kappa^+}(p,\g;A)  \cdot T^{\o(A)} \la \g \ra , \qquad
		SSP_{\underline\kappa^-} \la \g \ra := \hspace{-5mm}\sum_{\begin{smallmatrix}
				\scriptstyle  p, A \\ \scriptscriptstyle I(\g,p;A)=0  \end{smallmatrix} }  \hspace{-4mm}
		\# Z^{\underline\kappa^-}(\g,p;A) \cdot T^{\o(A)} \la p \ra.
	$$
\end{dfn}

\begin{lem} \label{lem:pss-novikov}
	The maps $PSS_{\underline\kappa^+}:CM \to CF$ and $SSP_{\underline\kappa^-}: CF \to CM$ in Definition~\ref{def:PSS} are well defined, i.e.\ the coefficients take values in the Novikov field $\Lambda$ defined in \S\ref{sec:Novikov}.
\end{lem}
\begin{proof}
	To prove that $PSS_{\underline\kappa^+}$ is well defined we need to check finiteness of the following set for any $p\in\Crit(f)$, $\g\in\cP(H)$, and $c\in\R$,
	$$\textstyle
		\Bigl\{ r\in \omega(H_2(M)) \cap (-\infty,c]  \;\Big|\;  \sum_{\begin{smallmatrix}
				\scriptstyle  A\in H_2(M) \\ \scriptstyle \omega(A)=r
			\end{smallmatrix}}
		\# Z^{\underline\kappa^+}(p,\g;A) \neq 0  \Bigr\}  .
	$$
	Here $\o : H_2(M) \rightarrow \mathbb{R}$ is given by pairing with the symplectic form on $M$, and recall from Lemma~\ref{lem:PSS poly} that there are only finitely many homology classes $A\in H_2(M)$ with $\omega(A) \leq c$ and $\sigma_\alpha^{-1}(0)\neq\emptyset$.
	On the other hand, the perturbations $\ul\kappa^+$ were chosen in Corollary~\ref{cor:regularize} (iii),(iv) so that $\# Z^{\underline\kappa^+}(\ldots; A) = 0$ whenever $\sigma_\alpha^{-1}(0)=\emptyset$. Thus there are in fact only finitely many $A\in H_2(M)$ with $\omega(A) \leq c$ and $\# Z^{\underline\kappa^+}(\ldots; A) \neq 0$, which proves the required finiteness.
	The proof for $SSP_{\underline\kappa^-}$ is analogous.
\end{proof}




\section{The chain homotopy maps}
\label{sec:iota,h}

In this section we construct $\L$-linear maps $\iota:CM \to CM$ and $h:CM \to CM$ on the Morse complex over the Novikov field $\Lambda$ given in \eqref{eq:CM}, which appear in Theorem~\ref{thm:main}.
For that purpose we again fix a choice of geometric data as in \S\ref{ssec:moduli} to construct moduli spaces in \S\ref{ssec:iota-mod} and \S\ref{ssec:h-mod}. We equip these with polyfold descriptions in \S\ref{ssec:polyh}, and define the maps $\iota, h$ for admissible regular choices of perturbations in Definitions~\ref{def:iota,h}.
To obtain the algebraic properties claimed in Theorem~\ref{thm:main}~(i)--(iii) we will then construct particular ``coherent'' choices of perturbations in \S\ref{sec:algebra}.

\subsection{Moduli spaces for the isomorphism $\boldsymbol{\iota}$}\label{ssec:iota-mod}

We will construct $\iota:CM \to CM$ from the following moduli spaces for critical points $p_-,p_+\in{\rm Crit}(f)$,  $A \in H_2(M)$, using the almost complex structure $J$ and the unstable/stable manifolds (see \S\ref{ssec:Morse}) of the Morse-Smale pair $(f,g)$ chosen in \S\ref{ssec:moduli},
\begin{equation} \label{iotamod}
	\cM^\iota(p_-,p_+; A) := \bigl\{ u: \CP^1 \to M \,\big|\, u([1:0])\in W^-_{p_-} , \; u([0:1])\in W^+_{p_+} , \; \dbar_J u = 0 , \; [u]=A \bigr\} .
\end{equation}
Note that a cylinder acts on this moduli space by reparametrization with biholomorphisms of $\CP^1$ that fix the two points $[1:0],[0:1]$. However, we do not quotient out this symmetry so describe these moduli spaces as the zero set of a Fredholm section over a Sobolev closure of the set of smooth maps $u: \CP^1 \to M$ in the homology class $[u]=A$ satisfying the point constraints $u([1:0])\in W^-_{p_-}$ and $u([0:1])\in W^+_{p_+}$.
This determines the Fredholm index as
\begin{equation}\label{iota index}
	I^\iota(p_-,p_+;A) \; =\;  2c_1(A) + |p_-| - |p_+|.
\end{equation}
As in \S\ref{ssec:poly} we will obtain a compactification and polyfold description of this moduli space by identifying it with a fiber product of Morse trajectory spaces and a space of pseudoholomorphic curves, in this case the space of parametrized $J$-holomorphic spheres with evaluation maps for $z_0\in\CP^1$,
$$
	\ev_{z_0} \,:\; \cM(A) := \bigl\{  u : \CP^1 \rightarrow  M \,\big|\, \dbar_J u =0  , [u]=A \bigr\}
	\;\to\; M , \qquad u \mapsto u(z_0).
$$
With this we can describe the moduli space \eqref{iotamod} as fiber product with the half-infinite Morse trajectory spaces from \S\ref{ssec:Morse}, using $z_0^+:=[1:0]$ and $z_0^-:=[0:1]$
\begin{equation}\label{iota-fiber}
	\cM^\iota(p_-,p_+; A) \; \cong\;  \cM(p_-,M) \; \leftsub{\ev}{\times}_{\ev_{z^+_0}} \; \cM(A) \; \leftsub{\ev_{z^-_0}}{\times}_{\ev} \; \cM(M,p_+).
\end{equation}
Note here that we are not working with a Gromov-Witten moduli space, as we do not quotient by ${\rm Aut}(\CP^1)$.
This is due to the chain homotopy in Theorem~\ref{thm:main}~(iii), which will result from identifying a compactification of $\cM(A)$ with a boundary of the neck-stretching moduli space $\cM_{\rm SFT}(A)$ in \eqref{SFTstretchmod} that appears in Symplectic Field Theory \cite{egh}.
For that purpose we identify a solution $u:\CP^1\to M$ with the map to its graph $\Ti u : \CP^1 \to \CP^1 \times M, z \mapsto (z,u(z))$ as in \cite[\S8.1]{MS}. This yields is a bijection (and homeomorphism in appropriate topologies)
$$
	\cM(A) \;\cong\; \frac{\widetilde\cM_{\rm GW}([\CP^1]+ A) := \bigl\{ v : \CP^1 \to \CP^1\times M  \;\big|\;  \dbar_{\Ti J} v = 0 , \;  [v]=[\CP^1]+ A \bigr\}}{{\rm Aut}(\CP^1)}
$$
between the Cauchy-Riemann solution space for $M$ and the Gromov-Witten moduli space  for $\CP^1\times M$ in class $[\CP^1] + A$ for the split almost complex structure $\Ti J:=i \times J$ on $\CP^1\times M$. To transfer the evaluation maps at $z^+_0=[1:0]$ and $z_0^-=[0:1]$ we keep track of these as (unique) marked points mapping to $\{z_0^\pm\}\times M$ and thus replace \eqref{iota-fiber} by a fiber product over $\CP^1\times M$,
\begin{equation}\label{iota-fiber-SFT}
	\cM^\iota(p_-,p_+; A) \; \cong\;  \cM(p_-,M) \; \leftsub{\{z^+_0\}\times\ev}{\times}_{\ev^+} \; \cM_{\rm GW}(A) \; \leftsub{\ev^-}{\times}_{\{z^-_0\}\times\ev} \; \cM(M,p_+).
\end{equation}
This uses the evaluation maps from a Gromov-Witten moduli space with two marked points,
\begin{equation}
	\ev^\pm \;:\; \cM_{\rm GW}(A) := \quotient{\widetilde\cM_{\rm GW}([\CP^1]+ A)}{{\rm Aut}(\CP^1,z_0^-,z_0^+)}
	\;\to\; \CP^1\times M , \qquad
	[v] \;\mapsto\;  v(z_0^\pm)  ,  \label{eq:GWeval}
\end{equation}
where ${\rm Aut}(\CP^1,z_0^-,z_0^+)$ denotes the set of biholomorphisms $\phi:\CP^1\to\CP^1$ which fix $\phi(z_0^\pm)=z_0^\pm$.
The polyfold setup in \cite[Theorems~1.7,1.10,1.11]{hwz-gw} for Gromov-Witten moduli spaces now provides a strong polyfold bundle $\cE_{\rm GW}(A)\to \cB_{\rm GW}(A)$, and oriented sc-Fredholm section $\s_{\rm GW}: \cB_{\rm GW}(A)\to \cE_{\rm GW}(A)$ that cuts out a compactification $\bM_{\rm GW}(A)=\s_{\rm GW}^{-1}(0)$ of $\cM_{\rm GW}(A)$.
Here a dense subset of the base polyfold $\cB_{\rm GW}(A)$ consists of ${\rm Aut}(\CP^1,z_0^-,z_0^+)$-orbits of smooth maps $v: \CP^1 \to \CP^1\times M$ in the homology class $[v]=[\CP^1]+A$, which implicitly carries the two marked points $z_0^\pm\in\CP^1$. Nodal curves in $\bM_{\rm GW}(A)$ then explicitly come with the data of two marked points on their domain.
On the dense subset the section is given by $\s_{\rm GW}([v]) =[(v,\dbar_{\Ti J} v)]$.
The setup in \cite[Theorem~1.8]{hwz-gw} moreover provides sc$^\infty$ evaluation maps $\ev^\pm : \cB_{\rm GW}(A) \to \CP^1\times M$ at the marked points, which on the dense subset are given by $\ev^\pm([v])=v(z^\pm_0)$.

Thus we have given each factor in the fiber product \eqref{iota-fiber-SFT} a compactification\footnote{The term 'compactification' applied to spaces of pseudoholomorphic curves is always to be understood as Gromov-compactification, as $\cM_{\rm GW}(A)\subset \bM_{\rm GW}(A)$ may not be dense.} that is either a manifold with corners given by the compactified Morse trajectory spaces in Theorem~\ref{thm:Morse}, or the compact zero set $\bM_{\rm GW}(A)=\s_{\rm GW}^{-1}(0)$ of a sc-Fredholm section.
In \S\ref{ssec:polyh} we will combine the polyfold description of the Gromov-compactification of \eqref{eq:GWeval} with an abstract construction of fiber products in polyfold theory \cite{Ben-fiber} to obtain compactifications and polyfold descriptions of the moduli spaces. Then the construction of $\iota:CM\to CM$ proceeds as in \S\ref{ssec:construct}. The algebraic properties of $\iota$ in Theorem~\ref{thm:main}~(i) and (ii) will follow from the boundary stratifications of the Morse trajectory spaces $\bM(p_-,M)$ and $\bM(M,p_+)$ since the ambient polyfold $\cB_{\rm GW}(A)$ has no boundary. However, this requires specific ``coherent'' choices of perturbations in \S\ref{sec:algebra}.


\begin{rmk} \rm \label{rmk:iota-energy}
	Gromov-compactifications of the moduli spaces $\cM^\iota(p_-,p_+; A)$ will result from the energy identity \cite[Lemma~2.2.1]{MS} for solutions of $\dbar_J u = 0$,
	\begin{equation} \label{eq:iota-energy}
		\textstyle
		E(u) \,:=\; \frac 12 \int_\C |\rd u |^2  \;=\; \int_{\CP^1} u^*\omega \;=\; \omega([u])  .
	\end{equation}
	This fixes the energy of solutions on each solution space $\cM(A)$, and Gromov compactness asserts that $\{u : \CP^1 \to M \,| \, \dbar_J u =0 , E(u)\leq C  \}$ is compact up to bubbling for any $C>0$.

	Another consequence of \eqref{eq:iota-energy} is that for $\omega(A)\leq 0$ we have no solutions $\cM(A)=\emptyset$ except for $A=0\in H_2(M)$ when the solution space is the space of constant maps
	$$
		\cM(0) \;=\; \{ u\equiv x \,|\, x\in M\} \;\simeq\; M,
	$$
	which is compact and cut out transversely.

	Translated to graphs in $\CP^1\times M$ with two marked points, this means $\bM_{\rm GW}(0)\simeq \CP^1\times\CP^1\times M$ by adding two marked points in the domain. That is, $(z^-, z^+,x)\in \CP^1\times\CP^1\times M$ corresponds to the (equivalence class of) graphs $\Ti u_x: z\mapsto (z,x)$ with two marked points $z^-,z^+\in\CP^1$. For $z^-\neq z^+$ this tuple can be reparametrized to the fixed marked points $z^-_0,z^+_0\in\CP^1$ and then represents an ${\rm Aut}(\CP^1,z^-_0,z^+_0)$-orbit.
	For $z^-=z^+$ the tuple $(z^-, z^+,x)$ corresponds to a stable map in $\bM_{\rm GW}(0)$, given by the graph $\Ti u_x$ with a node at $z^-=z^+$ attached to a constant sphere with two distinct marked points.
	This will be stated in polyfold terms in Assumption~\ref{ass:iota,h}~(ii).
\end{rmk}


\subsection{Moduli spaces for the chain homotopy $\boldsymbol{h}$} \label{ssec:h-mod}

To construct the moduli spaces from which we will obtain $h:CM \to CM$, we again use the almost complex structure $J$ and Morse-Smale pair $(f,g)$ chosen in \S\ref{ssec:moduli}. In addition, we fixed an anti-holomorphic vector-field-valued 1-form $Y_H\in \Om^{0,1}(\C, \G(\rT M))$ that arises from the fixed Hamiltonian function $H:S^1\times M\to\R$ and a choice of smooth cutoff function $\beta: [0,\infty) \to [0,1]$ with $\beta|_{[0,1]}\equiv 0$, $\beta'\geq 0$, and $\beta|_{[e,\infty)}\equiv 1$.
Gluing this 1-form to another copy of $Y_H$ over $\C^-$ with neck length $R>0$ in exponential coordinates yields the anti-holomorphic vector-field-valued 1-form $Y_H^R\in \Om^{0,1}(\CP^1, \G(\rT M))$ that vanishes near $[1:0],[0:1]$ and on $\CP^1\less\{[1:0],[0:1]\} = \{ [1:r e^{i\theta}] \,|\, (r,\theta)\in (0,\infty) \times S^1 \}$ is given by
$$
	Y^R_H([1:re^{i\theta}],x) := \tfrac 12 \beta_R(r) \bigl( J X_H(\theta,x) \, r^{-1} \rd r + X_H(\theta,x) \, \rd\theta  \bigr) .
$$
Here $\beta_R(r):= \beta(re^{\frac R2}) \beta(r^{-1} e^{\frac R2})$ is a smooth cutoff function $\beta_R: (0,\infty) \to [0,1]$ that is identical to $1$ on $[e^{1-\frac{R}{2}} , e^{\frac{R}{2}-1}]$ and identical to $0$ on $(0,e^{-\frac R2}) \cup (e^{\frac R2},\infty)$.
Now perturbing the Cauchy-Riemann operator on $\CP^1$ by $Y_H^R$ yields the following moduli spaces for critical points $p_-,p_+\in{\rm Crit}(f)$,  $A \in H_2(M)$, and $R \in [0,\infty)$,
$$
	\cM_R(p_-,p_+; A) := \bigl\{ u: \CP^1 \to M \;\big|\; u([1:0])\in W^-_{p_-} , \; u([0:1])\in W^+_{p_+} , \;\dbar_{J} u = Y_H^R(u) , \; [u]=A \bigr\},
$$
and we will construct $h$ from their union
\begin{equation} \label{hmod} \textstyle
	\cM(p_-,p_+;A) := \bigsqcup_{R \in [0,\infty)} \cM_R(p_-,p_+;A).
\end{equation}

\begin{rmk} \rm
	Each vector-field-valued 1-form $Y_H^R=-(X_{H^R_\beta})^{0,1}$ is in the notation of \cite[\S8.1]{MS} induced from the 1-form with values in smooth functions $H^R_\beta\in\Om^1(\CP^1,\cC^\infty(M))$ given by $H^R_\beta (r e^{i\theta}) = \beta_R(r) H (\theta,\cdot) \rd\theta$.
	It is constructed so that it has the following properties:
	\begin{enumilist}
		\item
		For $R=0$ we have $Y^0_H\equiv 0$ so that the moduli space $\cM_0(p_-,p_+; A)=\cM^\iota(p_-,p_+; A)$ is the same moduli space \eqref{iotamod} from which $\iota$ will be constructed.

		\item
		The restriction of any solution $u\in\cM_R(p_-,p_+;A)$ to the middle portion $\{[1:z]\in\CP^1 \,|\, e^{1-\frac R2} < |z|< e^{\frac R2-1}\}\cong (1-\frac R2,\frac R2-1)\times S^1$ satisfies the Floer equation $\partial_s v + J \partial_t v = J X_H(t,v)$  after reparametrization $v(s,t):= u([1:e^{s+it}])$.

		\item
		The shifts $u_-(z):=u([1: e^{- \frac R2} z])$ and $u_+(z):=u([e^{\frac R2} z : 1])=u([1: e^{\frac R2} z^{-1} ])$ of any solution $u\in\cM_R(p_-,p_+;A)$, restricted to $\{z\in \C \,|\, |z| < e^{R-1} \}$,
		satisfy $\dbar_{J} u_\pm = Y_H(u_\pm)$ as in the PSS/SSP moduli spaces in \S\ref{ssec:moduli}.
	\end{enumilist}
\end{rmk}


The moduli space $\cM(p_-,p_+;A)$ is the zero set of a Fredholm section over a Banach manifold $[0,\infty) \times \cB$, where $\cB$ is the same Sobolev closure as in \S\ref{ssec:iota-mod} of the set of smooth maps $u: \C\mathbb{P}^1 \to M$ in the homology class $[u]=A$ satisfying the point constraints $u([1:0])\in W^-_{p-}$ and  $u([0:1]) \in W^+_{p_+}$.
Restricted to $\{0\}\times\cB$ this is the Fredholm section that cuts out $\cM^\iota(p_-,p_+;A)$ in \eqref{iotamod} with $\Ti J_H^0=\Ti J$.
This determines the Fredholm index as
\begin{equation}\label{h index}
	I(p_-,p_+;A) \, :=\; I^\iota(p_-,p_+;A) + 1 \; =\; 2c_1(A) + |p_-| - |p_+| + 1.
\end{equation}
Towards a compactification and polyfold description of these moduli spaces we again -- as in \S\ref{ssec:poly}, \S\ref{ssec:iota-mod}, \cite[\S8.1]{MS} -- identify a solution $u:\CP^1\to M$ with the map to its graph.
Moreover, we again fix marked points $z_0^+=[1:0]$, $z_0^-=[0:1]$ to implement evaluation maps to express the conditions $u(z_0^\mp)\in W^\pm_{p_\pm}$.
This yields a homeomorphism (in appropriate topologies) between the moduli space \eqref{hmod} and the fiber product over $\CP^1\times M$ with the half-infinite Morse trajectory spaces from \S\ref{ssec:Morse},
\begin{equation}\label{h-fiber}
	\cM(p_-,p_+; A) \; \cong\;  \cM(p_-,M) \; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ev^+} \; \cM_{\rm SFT}(A) \; \leftsub{\ev^-}{\times}_{\{z_0^-\}\times\ev} \; \cM(M,p_+).
\end{equation}
Compared with \eqref{iota-fiber-SFT} this replaces the Gromov-Witten moduli space in \eqref{eq:GWeval} with a family of moduli spaces for almost complex structures $\Ti J_H^R$ on $\CP^1\times M$ arising from $Y_H^R$ for $R\in[0,\infty)$,
\begin{equation}
	\cM_{\rm SFT}(A) \,:=\;  \bigsqcup_{R \in [0,\infty)} \quo{\bigl\{ v: \CP^1 \to \CP^1\times M  \;\big|\;  \dbar_{\Ti J^R_H} v = 0 , [v]=[\CP^1]+ A \bigr\}}{{\rm Aut}(\CP^1,z_0^-,z_0^+)}  .  \label{SFTstretchmod}
\end{equation}
Here, again, we implicitly include the two marked points $z_0^\pm\in\CP^1$.
Then, for $R\to\infty$, the degeneration of the PDE $ \dbar_{\Ti J^R_H} v = 0$ is the ``neck stretching''\footnote{Strictly speaking, $R \in [0,2]$ parametrizes a family of Gromov-Witten moduli spaces for varying almost complex structure. At $R = 2$, the manifold $S^1 \times M$ with its stable Hamiltonian structure (see \S\ref{ssec:poly}) embeds as a stable hypersurface in $\CP^1 \times M$. Then $R \in [2,\infty)$ parametrizes the SFT neck-stretching.} considered more generally in Symplectic Field Theory \cite{egh}. The evaluation maps from \eqref{eq:GWeval} directly generalize to
\begin{equation}
	\ev^\pm\;:\; \cM_{\rm SFT}(A)
	\;\to\; \CP^1\times M , \qquad
	[v] \;\mapsto\;  v(z_0^\pm)  . \label{SFTstretchEval}
\end{equation}
Now, as in \S\ref{ssec:iota-mod}, each factor in the fiber product \eqref{h-fiber} has natural compactifications -- either the compactified Morse trajectory spaces from Theorem~\ref{thm:Morse}, or the compact zero set $\bM_{\rm SFT}(A)=\s_{\rm SFT}^{-1}(0)$ of a sc-Fredholm section that we will introduce in \S\ref{ssec:polyh}. Combined with the construction of fiber products in polyfold theory \cite{Ben-fiber} this will yield compactifications and polyfold descriptions of the moduli spaces \eqref{hmod}, and the construction of $h:CM\to CM$ then again proceeds as in \S\ref{ssec:construct}.
Establishing the algebraic properties in Theorem~\ref{thm:main} relating $h$ with $\iota$ and $SSP\circ PSS$ will moreover require an in-depth discussion of the boundary stratification of the polyfold domains $\cB_{\rm SFT}(A)$ of these sections, and ``coherent'' choices of perturbations in \S\ref{sec:algebra}.



\begin{rmk} \rm \label{rmk:h-energy}
	Gromov-compactifications of the moduli spaces $\cM(p_-,p_+; A)$ will result from energy estimates \cite[Remark~8.1.7]{MS} for solutions of $\dbar_J u = Y_H^R(u)$,
	\begin{equation} \label{eq:h-energy}
		\textstyle
		E_R(u) \,:=\; \frac 12 \int_{\CP^1} |\rd u + X_{H^R_\beta}(u) |  \;\leq\;
		\int_{\CP^1} u^*\omega + \|R_{H^R_\beta}\| \;=\; \omega([u]) + 2 \|H(\theta,\cdot)\| .
	\end{equation}
	Here
	$R_{H^R_\beta} \dvol_{\CP^1} = \rd H^R_\beta + \tfrac 12 { H^R_\beta\wedge H^R_\beta } =  \beta_R' \,  H \, \rd r \wedge \rd \theta$ has uniformly bounded Hofer norm
	$$\textstyle
		\| R_{H^R_\beta}\|  \;=\; \int_{\CP^1} ( \max R_{H^R_\beta} - \max R_{H^R_\beta} )  \;=\; \int_0^\infty \int_{S^1} |\beta_R'(r)| \|H(\theta,\cdot)\| \, \rd\theta \, \rd r \;=\; 2 \|H(\theta,\cdot)\|,
	$$
	where $\|H(\theta,\cdot)\|:= \max_{x\in M} H(\theta,x) -  \min_{x\in M} H(\theta,x)$ and
	$\beta_R\in\cC^\infty((0,\infty),[0,1])$ is constant except
	\begin{align*}
		\beta_R|_{[e^{-\frac R2}, e^{1-\frac{R}{2}}]} \,:\; r \mapsto \beta(r e^{\frac R2})
		\quad\text{with}\quad & \tfrac{\rd}{\rd r} \beta_R \geq 0 \quad\text{and}\quad\textstyle
		\int_{e^{-\frac R2}} ^{e^{1-\frac{R}{2}}} \bigl| \tfrac{\rd}{\rd r} \beta_R \bigr|\, \rd r = \beta(e) - \beta(1) = 1 , \\
		\beta_R|_{[e^{\frac{R}{2}-1},e^{\frac R2}]} \,:\; r \mapsto  \beta(r^{-1} e^{\frac R2})
		\quad\text{with}\quad & \tfrac{\rd}{\rd r} \beta_R \leq 0 \quad\text{and}\quad\textstyle
		\int_{e^{\frac R2 - 1}} ^{e^{\frac{R}{2}}} \bigl| \tfrac{\rd}{\rd r} \beta_R \bigr|\, \rd r = - \bigl( \beta(1) - \beta(e) \bigr) = 1 .
	\end{align*}
	This proves \eqref{eq:h-energy}, and thus establishes energy bounds on the perturbed pseudoholomorphic maps in each of our moduli spaces, where we fix $[u]=A$.
	Now SFT-compactness \cite{sft-compactness} asserts that for any $C>0$ the set of solutions of bounded energy $\bigsqcup_{R\in[0,\infty)}\{  u : \CP^1 \to M \,| \, \dbar_J u = Y^R_H(u) , E_R(u)\leq C  \}$ is compact up to breaking and bubbling.
	This compactness will be stated rigorously in polyfold terms in Assumption~\ref{ass:iota,h}~(ii).
\end{rmk}



\subsection{Construction of the morphisms} \label{ssec:polyh}

In this section we construct the $\L$-linear maps $\iota:CM \to CM$ and $h:CM \to CM$ analogously to \S\ref{ssec:construct} by first obtaining compactifications and polyfold descriptions for the moduli spaces in \S\ref{ssec:iota-mod} and \S\ref{ssec:h-mod} as in \S\ref{ssec:poly}.
This construction is motivated by the fiber product descriptions of the moduli spaces in \eqref{iota-fiber-SFT}, \eqref{h-fiber}, which couple Morse trajectory spaces from \S\ref{ssec:Morse} with moduli spaces of pseudoholomorphic curves in $\CP^1\times M$ via evaluation maps \eqref{eq:GWeval}, \eqref{SFTstretchEval}. Polyfold descriptions of these moduli spaces and their properties are stated in the following Assumption~\ref{ass:iota,h} for reference, with proofs in \cite{hwz-gw} resp.\ outlined in \cite{fh-sft}.
A summary of the types of curves in each polyfold and subsets thereof is displayed in Table~\ref{tab:asspolyfolds2}.
Here we formulate the evaluation map in the context of neck stretching, as explained in the following remark, using a splitting of the sphere as topological space with smooth structures on the complement of the equator
$$
	\overline{\CP^1_\infty} \,:=\; \overline{\C^+} \cup_{S^1} \overline{\C^-} \;\cong\;
	\C^+ \sqcup S^1 \sqcup \C^- ,
$$
using the topologies and smooth structures on $\ov{\C^\pm} = \C^\pm \sqcup S^1 \cong \{z\in\C^\pm \,|\, |z|\leq 1\}$ from Remark~\ref{rmk:evaluation drama}.

\begin{rmk}\rm \label{rmk:drama2}
	(i)
	Recall from \S\ref{ssec:iota-mod} that we denote by $\cB_{\rm GW}(A)$ a Gromov-Witten polyfold of curves in class $[\CP^1] + A\in H_2(\CP^1\times M)$ with $2$ marked points. These are determined by $A\in H_2(M)$ as we model graphs of maps $\CP^1\to M$, but should not be confused with a polyfold of curves in $M$. In particular, $\cB_{\rm GW}(A)$ never contains constant maps and hence is well defined for $A=0$.
	The properties of the Gromov-Witten moduli spaces for $\o(A)\leq 0$ are spelled out abstractly in Assumption~\ref{ass:iota,h}(ii) below; for the geometric meaning see Remark~\ref{rmk:iota-energy}.

	\medskip\noindent (ii)
	The SFT polyfolds $\cB_{\rm SFT}(A)$ will similarly describe curves in class $[\CP^1] + A$ in a neck stretching family of targets $(\CP^1_R \times M)_{R\in[0,\infty]}$ as in \cite[\S3.4]{sft-compactness}, given by
	$$
		\CP^1_R := \quotient{ D_+ \sqcup E_R \sqcup D_- }{\sim_R} \qquad\text{with}\qquad
		E_R = \begin{cases}
			[-R,R]\times S^1                                  & ; R<\infty, \\
			[0,\infty)\times S^1 \sqcup (-\infty,0]\times S^1 & ; R=\infty.
		\end{cases}
	$$
	Here we identify the boundaries of the closed unit disks $D_\pm = \{z\in\C  \,|\, |z|\leq 1\}$ with the boundary components of the necks $E_R$ via
	$$
		\partial D_\pm \in e^{i\theta}  \;\sim_R\;
		\left. \begin{cases}
			(\pm R, e^{\pm i\theta}) & ; R<\infty \\
			(0_\pm, e^{\pm i\theta}) & ; R=\infty
		\end{cases} \right\}
		\in \partial E_R ,
	$$
	where we denote $0_+:= 0 \in [0,\infty)$ and $0_-:= 0 \in (-\infty,0]$ so that $\partial E_\infty = \{0_+\}\times S^1 \sqcup \{0_-\}\times S^1$.
	To describe convergence and evaluation maps we also embed each $\CP^1_R \subset \overline{\CP^1_\infty}=\C^+\sqcup S^1 \sqcup \C^-$ by
	\begin{align*}
		\quotient{D_+ \sqcup [-R,0)\times S^1}{\sim_R} \;\cong\; \quotient{D_+ \sqcup [0,\infty)\times S^1}{\sim_\infty}  \; & =: \,  \C^+  , \\
		\quotient{D_- \sqcup (0,R]\times S^1}{\sim_R} \;\cong\; \quotient{D_- \sqcup (-\infty,0] \times S^1}{\sim_\infty}    & =:\, \C^- ,
		\qquad
		E_R \supset \{0\}\times S^1 \;\cong\; S^1 \subset  \overline{\CP^1_\infty} .
	\end{align*}
	For $R=0$ this is to be understood as $\CP^1_0=\qu{D_+\sqcup D_-}{\partial D_+\sim\partial D_-}$ with $D_\pm \less  \partial D_\pm \cong \C^\pm$, and for all $R<\infty$ we view the resulting homeomorphism $\CP^1_R\cong\ov{\CP^1_\infty}\cong\CP^1$ as identifying the standard marked points $\CP^1\ni z_0^+=[1:0] \cong 0\in \C^+$ and $\CP^1\ni z_0^-=[0:1] \cong 0\in \C^-$.
	When these embeddings are done via linear shifts $[-R,-1) \cong [0,R-1)$ and $(1,R] \cong (1-R,0]$ extended by a smooth family of diffeomorphisms $[-1,0)\cong [R-1,\infty)$ and $(0,1] \cong (-\infty, 1-R]$,
	then the pullback of the almost complex structures $\Ti J_H^R$ on $\CP^1_R\times M$
	converges for $R\to\infty$ in $\cC^\infty_{\rm loc}\bigl((\ov{\CP^1_\infty}\less S^1)\times M\bigr)$ to the almost complex structures $\Ti J_H^+, \Ti J_H^-$ on $\C^+ \times M \;\sqcup\; \C^-\times M = \CP^1_\infty \times M \subset \ov{\CP^1_\infty} \times M$,
	which are used in the construction of the PSS and SSP moduli spaces in \S\ref{ssec:poly}.
	Moreover, this allows us to extend the evaluation maps from \eqref{SFTstretchEval} to continuous maps $\ov\ev^\pm : \bM_{\rm SFT}(A) \to \ov{\CP^1_\infty}\times M$ on the compactified SFT moduli space. At $R=\infty$ this involves pseudoholomorphic buildings in $\C^+\times M \;\sqcup\; \R\times S^1\times M \ldots  \;\sqcup\; \R\times S^1\times M  \;\sqcup\; \C^-\times M$, and for any marked point with evaluation into a cylinder $\R\times S^1\times M$ we project the result to $S^1\times M\subset \ov{\CP^1_\infty}\times M$ by forgetting the $\R$-component.

	Finally, this formulation with $\ov{\CP^1_\infty}=\ov{\C^+}\cup_{S^1}\ov{\C^-}$ will allow us to compare the evaluation at $R=\infty$ with the product of the evaluations
	$\ov\ev^\pm : \bM^\pm_{\rm SFT}(\g;A) \to \ov{\C^\pm}\times M$
	constructed in Remark~\ref{rmk:evaluation drama}.
	While this will be stated rigorously only in Assumption~\ref{ass:iso}~(iii)(c), note here that we should expect three top boundary strata of an ambient polyfold at $R=\infty$, corresponding to the distribution of marked points on the curves in $\C^+\times M \;\sqcup\; \C^-\times M$.
	For the fiber product construction, only the boundary components with one marked point in each factor are relevant -- in fact only those with marked points near $z_0^+\cong 0 \in \C^+$ and $z_0^-\cong 0 \in \C^-$. Thus we will work with the open subset $(\ov\ev^+)^{-1}(\C^+\times M)\cap (\ov\ev^-)^{-1}(\C^-\times M)$ where the two evaluations for any $R\in[0,\infty]$ are constrained to take values in the open sets given by $\C^\pm \subset \ov{\CP^1_\infty}$.
\end{rmk}



\begin{ass} \label{ass:iota,h}
	There is a collection of oriented sc-Fredholm sections of strong polyfold bundles
	$\s_{\rm GW}: \cB_{\rm GW}(A)\to \cE_{\rm GW}(A)$ and
	$\s_{\rm SFT}: \cB_{\rm SFT}(A)\to \cE_{\rm SFT}(A)$ indexed by $A\in H_2(M)$, sc$^\infty$ maps $\ov\ev^\pm: \cB_{\rm GW}(A)\to \CP^1\times M$, and continuous maps $\ov\ev^\pm: \cB_{\rm SFT}(A)\to \ov{\CP^1_\infty}\times M$ with the properties:
	\begin{enumilist}
		\item
		The sections have Fredholm indices $\text{\rm ind}(\s_{\rm GW}) = 2c_1(A) + \dim M + 4$ on $\cB_{\rm GW}(A)$ resp.\ $\text{\rm ind}(\s_{\rm SFT}) = 2c_1(A) + \dim M + 5$ on $\cB_{\rm SFT}(A)$.
		\item
		Each zero set $\bM_{\rm GW}(A):=\s_{\rm GW}^{-1}(0)$ and $\bM_{\rm SFT}(A):=\s_{\rm SFT}^{-1}(0)$ is compact, and given any $C\in\R$ there are only finitely many $A\in H_2(M)$ with nonempty zero set $\bM_{\rm GW}(A)\neq\emptyset$ resp.\ $\bM_{\rm SFT}(A)\neq\emptyset$.
		Moreover, for $\omega(A)\leq 0$ we have $\bM_{\rm GW}(A)=\emptyset$ except for $A=0\in H_2(M)$ when $\s_{\rm GW}|_{\cB_{\rm GW}(0)}\pitchfork 0$ is in general position with zero set $\bM_{\rm GW}(0)\simeq\CP^1\times\CP^1\times M$ identified by
		$$
			\cB_{\rm GW}(0) \;\supset\; \s_{\rm GW}^{-1}(0) \;=\; \bM_{\rm GW}(0) \;\overset{\ov\ev^+\times\ov\ev^-}{\longrightarrow}\; \bigl\{ (z^+,x, z^-, x) \,\big|\, z^-,z^+\in\CP^1, x\in M \bigr\} .
		$$
		\item
		The polyfolds $\cB_{\rm GW}(A)$ have no boundary, $\partial\cB_{\rm GW}(A)=\emptyset$.
		For $\cB_{\rm SFT}(A)$ there is a natural inclusion $[0,\infty) \times\cB_{\rm GW}(A) \subset \cB_{\rm SFT}(A)$ that covers the interior $\partial_0\cB_{\rm SFT}(A) = (0,\infty) \times\cB_{\rm GW}(A)$ and identifies the boundary $\partial \cB_{\rm SFT}(A)$ to consist of the disjoint sets
		$\{0\} \times\cB_{\rm GW}(A)$ and $\lim_{R\to\infty} \{R\} \times\cB_{\rm GW}(A)$ of $\cB_{\rm SFT}(A)$.
		Moreover, this inclusion identifies the section $\sigma_{\rm GW}$ and evaluation maps $\ov\ev^\pm$ with the restricted section $\s_{\rm SFT}|_{\{0\} \times\cB_{\rm GW}(A)}$ and evaluations $\ov\ev^\pm|_{\{0\} \times\cB_{\rm GW}(A)}$.
		(A description of the relevant $R=\infty$ parts of the boundary $\partial \cB_{\rm SFT}(A)$ is given in Assumption~\ref{ass:iso}.)

		\item The sections $\s_{\rm GW}$ and $\s_{\rm SFT}$ have tame sc-Fredholm representatives in the sense of \cite[Def.5.4]{Ben-fiber}.
		The product of evaluation maps $\ov\ev^+\times\ov\ev^-: \cB_{\rm GW}(A) \to \CP^1\times M\times \CP^1\times M$ is $\s_{\rm GW}$-compatibly submersive in the sense of Definition~\ref{def:submersion}. On the open subset
		$$
			\cB^{+,-}_{\rm SFT}(A) \,:=\; (\ov\ev^+)^{-1}(\C^+\times M)\cap  (\ov\ev^-)^{-1}(\C^-\times M) \;\subset\;
			\cB_{\rm SFT}(A)
		$$
		the evaluation maps $\ov\ev^\pm: \cB_{\rm SFT}(A) \to \ov{\CP^1_\infty}\times M$
		restrict to a $\s_{\rm SFT}$-compatibly submersive map
		\begin{equation}\label{eq:SFTevalB}
			\ev^+\times \ev^- \,:\;
			\cB^{+,-}_{\rm SFT}(A)  \; \to \;  \C^+\times M\times \C^-\times M  .
		\end{equation}
		On this domain intersected with $\{0\}\times\cB_{\rm GW}(A)\subset\partial_1\cB_{\rm SFT}(A)$, this map coincides with the Gromov-Witten evaluations $\ov\ev^+\times \ov\ev^-$ viewed as maps
		$$
			\ev^+\times \ev^-  \,:\;   \cB^{+,-}_{\rm GW}(A)  \; \to \;  \C^+\times M\times \C^-\times M ,
		$$
		where we identify $\C^+\sqcup\C^- = \CP^1 \less S^1$ and restrict to the domain
		$$
			\{0\}\times \cB^{+,-}_{\rm GW}(A) \,:=\;
			\bigl(\{0\}\times\cB_{\rm GW}(A)\bigr) \cap \cB^{+,-}_{\rm SFT}(A)
			\;=\; \{0\}\times \bigl( (\ov\ev^+)^{-1}(\C^+\times M)\cap  (\ov\ev^-)^{-1}(\C^-\times M) \bigr) .
		$$
	\end{enumilist}
\end{ass}

\begin{rmk} \label{rmk:ass2} \rm
	\begin{enumilist}
		\item
		While not needed for our proof, we state the following properties for intuition:

		\smallskip\noindent
		{\it
		The ${\rm Aut}(\CP^1,z_0^-,z_0^+)$-orbits of smooth maps $v: \CP^1 \to \CP^1\times M$ which represent the class $[\CP^1]+ A$ form a dense subset $\cB_{\rm dense}(A)\subset \cB_{\rm GW}(A)$. On this subset, the section is given by $\s_{\rm GW}([v]) =  [(v,\dbar_{\Ti J} v)]$.
		Moreover, $[0,\infty)\times \cB_{\rm dense}(A) \subset \cB_{\rm SFT}(A)$ is a dense subset that intersects the boundary $\partial\cB_{\rm SFT}(A)$ exactly in $\{0\}\times \cB_{\rm dense}(A)$, and on which the section is given by $\s_{\rm SFT}(R,[v]) = [(v, \dbar_{\Ti J_H^R} v )]$.
		On these dense subsets, $\ov\ev^\pm([v])$ resp.\ $\ov\ev^\pm(R,[v])$ is the evaluation as in \eqref{SFTstretchEval}.

		The intersection of the zero sets with the dense subsets
		$\s_{\rm GW}^{-1}(0)\cap \cB_{\rm dense}(A) \cong \cM_{\rm GW}(A)$
		and
		$\s_{\rm SFT}^{-1}(0)\cap [0,\infty) \times \cB_{\rm dense}(A) \cong \cM_{\rm SFT}(A)$
		are naturally identified with the Gromov-Witten moduli space \eqref{eq:GWeval} and
		SFT moduli space in \eqref{SFTstretchmod}.
		}
		\smallskip

		\item

		The polyfold description $\s_{\rm GW}: \cB_{\rm GW}(A)\to \cE_{\rm GW}(A)$ is developed for the homology classes $[\CP^1]+ A\in H_2(\CP^1\times M)$ in \cite{hwz-gw}, with the submersion property shown in \cite[Ex.5.1]{Ben-fiber}. The properties for $\omega(A)\leq 0$ in
		Assumption~\ref{ass:iota,h}~(ii)
		follow from the fact that nonconstant pseudoholomorphic curves have positive symplectic area, and linear Cauchy-Riemann operators on trivial bundles (arising from linearization at constant maps) are surjective.
		The construction of $\s_{\rm SFT}$ starts by recognizing that the family of almost complex manifolds in Remark~\ref{rmk:drama2}~(ii) for $R<\infty$ is equivalent to a degeneration of the almost complex structure on $\CP^1\times M$ along the equator $S^1\subset\CP^1$. This can be described by an $R$-dependent bundle and section over $[0,\infty)\times \cB_{\rm GW}(A)$. The construction for $R\to\infty$ then proceeds analogous to \cite[\S 3]{fh-sft}, with buildings consisting of a top and bottom floor curve in $\C^\pm\times M$ and intermediate floors given by curves in $\R\times S^1\times M$. Thus
		Assumption~\ref{ass:iota,h}~(iii)
		and the compatibility with $\cB_{\rm GW}(A)$ in (iv) hold by construction.
		The polyfold and bundle structure are again obtained as in \cite{fh-sft} by extending the constructions in \cite{hwz-gw} with local models for punctures and neck-stretching from \cite[\S 3]{fh-2}, using the implanting method in \cite[\S 3,\S 5]{fh-1}. The remaining properties are proven as outlined in Remark~\ref{rmk:ass}~(ii).
	\end{enumilist}
\end{rmk}




Given any such polyfold descriptions of the moduli spaces of pseudoholomorphic curves, we now extend the fiber product descriptions of the moduli spaces
$$
	\cM^{(\iota)}(p_-,p_+; A) \;\cong\;  \cM(p_-,M)\; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ev^+} \cM_{\rm GW / SFT}(A) \leftsub{\ev^-}{\times}_{\{z_0^-\}\times\ev} \;\cM(M,p_+)
$$
in \S\ref{ssec:iota-mod} and \S\ref{ssec:h-mod} to obtain ambient polyfolds which contain compactifications of the moduli spaces.
Towards this we define for each $p_-,p_+\in{\rm Crit}(f)$ and $A\in H_2(M)$ the topological spaces
\begin{align*}
	\tilde{\cB}^\iota(p_-,p_+; A) & \,:=\; \left\{ (\ul{\t}_-, \ul{v} ,\ul{\t}_+) \in \bM(p_-,M) \times \, \cB_{\rm GW}(A) \, \times \bM(M,p_+)  \,\big|\,
	( z_0^\pm , \ev(\ul{\t}_\pm) ) = \ov\ev^\pm(\ul{v})  \;  \right\}                                                                                                                                                                \\
	                              & \,\phantom{:}=\; \left\{ (\ul{\t}_-, \ul{v} ,\ul{\t}_+) \in \bM(p_-,M) \times \, \cB^{+,-}_{\rm GW}(A) \, \times \bM(M,p_+)  \,\big|\, ( 0 , \ev(\ul{\t}_\pm) ) = \ev^\pm(\ul{v})  \;  \right\}, \\
	\tilde{\cB}(p_-,p_+; A)       & \,:=\; \left\{ (\ul{\t}_-, \ul{w},\ul{\t}_+)\in \bM(p_-,M) \times \cB_{\rm SFT}(A)\times \bM(M,p_+)  \,\big|\,
	( z_0^\pm ,\ev(\ul{\t}_\pm) )  = \ov\ev^\pm(\ul{w}) \right\}                                                                                                                                                                     \\
	                              & \,\phantom{:}=\; \left\{ (\ul{\t}_-, \ul{w},\ul{\t}_+)\in \bM(p_-,M) \times \cB^{+,-}_{\rm SFT}(A)\times \bM(M,p_+)  \,\big|\,  (0,\ev(\ul{\t}_\pm) )  = \ev^\pm(\ul{w})  \right\},
\end{align*}
where the last equality stems from the identification at the end of Remark~\ref{rmk:drama2}~(ii).
Then the abstract fiber product constructions in \cite{Ben-fiber} will be used as in Lemma~\ref{lem:PSS poly} to obtain the following polyfold description for compactifications of the moduli spaces in \S\ref{ssec:iota-mod} and \S\ref{ssec:h-mod}.


\begin{lem} \label{lem:iota,h poly}
	Given any $p_-,p_+\in{\rm Crit}(f)$ and $A\in H_2(M)$, there exist open subsets $\cB^\iota(p_-,p_+; A) \subset \tilde{\cB}^\iota(p_-,p_+; A)_1$ and $\cB(p_-,p_+; A) \subset \tilde{\cB}(p_-,p_+; A)_1$ which contain the smooth levels $\tilde{\cB}^{(\iota)}(p_-,p_+;A)_\infty$ of the fiber products and inherit natural polyfold structures with smooth level of the interior
	\begin{align*}
		\partial_0\cB^\iota(p_-,p_+; A)_\infty & \;=\; \cM(p_-,M) \; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ev^+} \;  \cB^{+,-}_{\rm GW}(A)_\infty \; \leftsub{\ev^-}{\times}_{\{z_0^-\}\times\ev} \;  \cM(M,p_+) ,            \\
		\partial_0\cB(p_-,p_+; A)_\infty       & \;=\; \cM(p_-,M) \; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ev^+} \;  \partial_0\cB^{+,-}_{\rm SFT}(A)_\infty \; \leftsub{\ev^-}{\times}_{\{z_0^-\}\times\ev} \; \cM(M,p_+)  ,
	\end{align*}
	and a scale-smooth inclusion
	$$
		\phi_\iota \,:\; \cB^\iota(p_-,p_+; A) \;\hookrightarrow\; \cB(p_-,p_+; A), \qquad
		(\ul{\t}_-, \ul{v},\ul{\t}_+) \;\mapsto\; (\ul{\t}_-, 0,\ul{v},\ul{\t}_+) .
	$$
	Moreover, pullback of the sections and bundles $\sigma_{\rm GW/SFT}: \cB_{\rm GW/SFT}(A) \to \cE_{\rm GW/SFT}(A)$ under the projection $\cB(p_-,p_+; A) \to \cB_{\rm GW/SFT}(A)$ induces sc-Fredholm sections of strong polyfold bundles $\s_{(p_-,p_+; A)}: \cB(p_-,p_+;A) \to \cE(p_-,p_+;A)$ of index $I(p_-,p_+; A)$ as in \eqref{h index} and
	$\s^\iota_{(p_-,p_+; A)}: \cB^\iota(p_-,p_+;A) \to \cE^\iota(p_-,p_+;A)$ of index $I^\iota(p_-,p_+; A)=I(p_-,p_+; A)-1$ as in \eqref{iota index}.
	Further, these are related via the inclusion $\phi_\iota$ by natural orientation preserving identification
	$\s^\iota_{(p_-,p_+; A)}\cong\phi_\iota^*\s_{(p_-,p_+; A)}$.

	The zero sets of these sc-Fredholm sections contain\footnote{
		As in Remark~\ref{rmk:ass}, this identification is stated for intuition and will ultimately not be used in our proofs.}
	the moduli spaces from \S\ref{ssec:iota-mod} and \S\ref{ssec:h-mod},
	\begin{align*}
		{\s^\iota_{(p_-,p_+; A)}}^{-1}(0) & \;=\;
		\bM(p_-,M) \; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ov\ev^+} \;  \s_{\rm GW}^{-1}(0)
		\; \leftsub{\ov\ev^-}{\times}_{\{z_0^-\}\times\ev} \;  \bM(M,p_+)
		\;\supset\; \cM(p_-,p_+; A),              \\
		{\s_{(p_-,p_+; A)}}^{-1}(0)
		                                  & \;=\;
		\bM(p_-,M) \; \leftsub{\{z_0^+\}\times\ev}{\times}_{\ov\ev^+} \;  \s_{\rm SFT}^{-1}(0) \; \leftsub{\ov\ev^-}{\times}_{\{z_0^-\}\times\ev} \; \bM(M,p_+)
		\;\supset\; \cM^\iota(p_-,p_+; A) .
	\end{align*}
	Finally, each zero set $\s^{(\iota)}_{(p_-,p_+; A)}\,\!\! ^{-1}(0)$ is compact,
	and given any $p_\pm\in\Crit(f)$ and $C\in\R$, there are only finitely many $A\in H_2(M)$ with $\omega(A)\leq C$ and nonempty zero set ${\s^{(\iota)}_{(p_-,p_+; A)}} \,\!\! ^{-1}(0)\neq\emptyset$.
\end{lem}

\begin{proof}
	The inclusion $\phi_{\i}$ is sc$^\infty$ since the map $\cB_{\rm GW}(A) \hookrightarrow \cB_{\rm SFT}(A), \ul{v} \mapsto (0,\ul{v})$ is a sc$^\infty$ inclusion by Assumption~\ref{ass:iota,h}~(iii).
	Apart from further relations involving $\phi_\iota$, the proof is directly analogous to the fiber product construction in Lemma~\ref{lem:PSS poly}, using Assumption~\ref{ass:iota,h} -- in particular the sc$^\infty$ and $\s_{\rm SFT}$-compatibly submersive evaluation map \eqref{eq:SFTevalB} on the open subset $\cB^{+,-}_{\rm SFT}(A)\subset \cB_{\rm SFT}(A)$.
	This yields polyfold structures on open sets $\cB^{\i}(p_-,p_+;A)\subset \tilde{\cB}^\iota(p_-,p_+; A)_1$ and $\cB(p_-,p_+;A)\subset \tilde{\cB}(p_-,p_+; A)_1$ as well as the pullback sc-Fredholm sections $\s_{(p_-,p_+;A)}=\pr_{\rm SFT}^*\s_{\rm SFT}$ and $\s^\iota_{(p_-,p_+;A)}=\pr_{\rm GW}^*\s_{\rm GW}$ under the projections $\pr_{\rm GW/SFT} : \cB^{(\i)}(p_-,p_+;A) \rightarrow \cB_{\rm GW/SFT}(A)$.
	Here we have $\pr_{\rm GW} = \pr_{\rm SFT} \circ \phi_{\i}$, so the bundle $\cE^\iota(p_-,p_+;A)=\pr_{\rm GW}^*\cE_{\rm GW}(A)$ and section $\s^\iota_{(p_-,p_+;A)}=\pr_{\rm GW}^*\s_{\rm GW}$ are naturally identified with the pullback bundle $\phi_\iota^*\cE(p_-,p_+;A) = \pr_{\rm GW}^*\cE_{\rm SFT}(A)|_{\{0\}\times\cB_{\rm GW}(A)}$ and section
	$\phi_\iota^*\s_{(p_-,p_+;A)} = \pr_{\rm GW}^*\s_{\rm SFT}|_{\{0\} \times\cB_{\rm GW}(A)}$ using Assumption~\ref{ass:iota,h}~(iii).
	Finally, the index of the induced section $\s_{(p_-,p_+;A)}$, and similarly of $\s^\iota_{(p_-,p_+;A)}$, is computed by \cite[Cor.7.3]{Ben-fiber} as
	\begin{align*}
		\text{\rm ind}(\s_{(p_-,p_+;A)}) & \;=\;
		\text{\rm ind}(\s_{\rm SFT}) + \dim \bM(p_-,M) + \dim \bM(M,p_+) - 2 \dim(\CP^1\times M)             \\
		                                 & \;=\; 2c_1(A) + \dim M + 5 + |p_-| + \dim M - |p_+| -4 - 2 \dim M \\
		                                 & \;=\; 2c_1(A) + |p_-|  - |p_+| + 1
		\;=\; I(p_-,p_+;A) .
	\end{align*}

	\vspace{-5mm}

\end{proof}

\begin{table}
	\centering
	\begin{tabular}{||c | c | c ||}
		\hline
		Notation                                         & Description                                                                                           & Definition \\ [0.5ex]
		\hline\hline
		$\cB_{\rm dense}(A)$                             & \thead{elements are equivalence classes under reparameterization by                                                \\ ${\rm Aut}(\CP^1,z_0^-,z_0^+)$ of smooth maps $\CP^1 \to \CP^1\times M$ in class $[\CP^1] + A$ }
		                                                 & \thead{Remark~\ref{rmk:ass2} (i)}                                                                                  \\
		\hline
		$\cB_{\rm GW}(A)$                                & \thead{a polyfold with dense subset $\cB_{\rm dense}(A)$, which contains the                                       \\ Gromov-compactification $\bM_{\rm GW}( A)$ of the moduli space in \eqref{eq:GWeval}}
		                                                 & \thead{Assumption~\ref{ass:iota,h} }                                                                               \\
		\hline
		$\cB_{\rm SFT}(A)$                               & \thead{a polyfold with dense subset $[0,\infty)\times \cB_{\rm dense}(A)$, which contains the                      \\ SFT-compactification $\bM_{\rm SFT}( A)$ of the moduli space in \eqref{SFTstretchmod} }
		                                                 & \thead{Assumption~\ref{ass:iota,h}
		}                                                                                                                                                                     \\
		\hline
		$\cB_{\scriptscriptstyle \rm GW / SFT}^{+,-}(A)$ & \thead{the open subsets of $\cB^\pm_{\rm \scriptscriptstyle GW / SFT}(A)$ containing the curves whose              \\ evaluation at two marked point lands in $\mathbb{C}^{\pm} \times M$; see Remark~\ref{rmk:drama2}}
		                                                 & \thead{Assumption~\ref{ass:iota,h} (iv)}                                                                           \\
		\hline
		$\tilde{\cB}^\iota(p_-,p_+; A)$                  & \thead{elements are triples of two half-infinite broken Morse trajectories from                                    \\ $p_-$ and to $p_+$  and a curve in $\cB_{\rm GW}(A)$ whose evaluations at the \\ marked points agrees with the endpoints of the Morse trajectories} & \thead{before Lemma~\ref{lem:iota,h poly}}\\
		\hline
		$\tilde{\cB}(p_-,p_+; A)$                        & \thead{elements are triples of two half-infinite broken Morse trajectories from                                    \\ $p_-$ and to $p_+$  and a curve in $\cB_{\rm SFT}(A)$ whose evaluations at the \\ marked points agrees with the endpoints of the Morse trajectories} & \thead{before Lemma~\ref{lem:iota,h poly}}\\
		\hline
		$\cB^\iota(p_-,p_+; A)$                          & \thead{open subset of $\tilde{\cB}^\iota(p_-,p_+; A)_1$ containing $\cM^\iota(p_-,p_+; A)$                         \\ over which $\s^\iota_{(p_-,p_+;A)}$ is sc-Fredholm }  & \thead{Lemma~\ref{lem:iota,h poly}} \\ [1ex]
		\hline
		$\cB(p_-,p_+; A)$                                & \thead{open subset of $\tilde{\cB}(p_-,p_+; A)_1$ containing $\cM(p_-,p_+; A)$                                     \\ over which $\s_{(p_-,p_+;A)}$ is sc-Fredholm }  & \thead{Lemma~\ref{lem:iota,h poly}} \\ [1ex]
		\hline
	\end{tabular}
	\caption{Summary of the polyfolds and their subsets introduced in this section
	}
	\label{tab:asspolyfolds2}
\end{table}


Given this compactification and polyfold description of the moduli spaces $\cM(\alpha)\subset\sigma_{\alpha}^{-1}(0)$ and $\cM^\iota(\alpha)\subset {\sigma^\iota_{\alpha}}^{-1}(0)$ for all tuples in the indexing set
$$
	\cI\,:=\; \bigl\{ \alpha=(p_-,p_+;A) \,\big|\, p_-,p_+\in\Crit(f), A\in H_2(M) \bigr\} ,
$$
we can again apply \cite[Theorems~18.2,18.3,18.8]{HWZbook} to the sc-Fredholm sections $\sigma_\alpha$ and $\sigma_\alpha^\iota$ and
obtain Corollary~\ref{cor:regularize} verbatim for these collections of moduli spaces.
In \S\ref{sec:algebra} we will moreover make use of the fact that $\sigma_\alpha^\iota=\phi_\iota^*\sigma_\alpha$ arises from restriction of $\sigma_\alpha$, so admissible perturbations of $\sigma_\alpha$ pull back to admissible perturbations of $\sigma_\alpha^\iota$.
For now, we choose perturbations independently and thus as in Definition~\ref{def:PSS} obtain perturbation-dependent, and not yet algebraically related, $\Lambda$-linear maps.


\begin{dfn} \label{def:iota,h}
	Given admissible sc$^+$-multisections
	$\underline\kappa=( \kappa_{(p_-,p_+;A)} )_{p_\pm\in\Crit(f), A\in H_2}$
	in general position to $(\sigma_{(p_-,p_+;A)} )$ and
	$\underline\kappa^\iota=( \kappa^\iota_{(p_-,p_+;A)} )_{p_\pm\in\Crit(f), A\in H_2}$
	in general position to $(\sigma^\iota_{(p_-,p_+;A)} )$ as in Corollary~\ref{cor:regularize},
	we define the maps $h_{\ul\kappa}:CM \to CM$ and  $\iota_{\ul\kappa^\iota}:CM \to CM$ to be the $\Lambda$-linear extensions of
	$$
		h_{\underline\kappa} \la p_- \ra := \hspace{-4mm} \sum_{\begin{smallmatrix}
				\scriptstyle  p_+, A  \\ \scriptscriptstyle I(p_-,p_+;A)=0
			\end{smallmatrix} }  \hspace{-4mm}
		\# Z^{\underline\kappa}(p_-,p_+;A)  \cdot T^{\o(A)} \la p_+ \ra
		, \qquad
		\iota_{\underline\kappa^\iota} \la p_- \ra := \hspace{-4mm} \sum_{\begin{smallmatrix}
				\scriptstyle  p_+, A  \\ \scriptscriptstyle I^\iota(p_-,p_+;A)=0
			\end{smallmatrix} }  \hspace{-4mm}
		\# Z^{\underline\kappa^\iota}(p_-,p_+;A)  \cdot T^{\o(A)} \la p_+ \ra .
	$$
\end{dfn}

The proof that the coefficients of these maps lie in the Novikov field $\Lambda$ is verbatim the same as Lemma~\ref{lem:pss-novikov}, based on the compactness properties in Lemma~\ref{lem:iota,h poly}.


\begin{rmk} \label{rmk:iota,h orient} \rm
	The determination in Corollary~\ref{cor:regularize} of $\# Z^{\underline\kappa}(p_-,p_+;A), \# Z^{\underline\kappa^\iota}(p_-,p_+;A) \in \Q$ that is used in Definition~\ref{def:iota,h} requires an orientation of the sections $\s_{(p_-,p_+;A)}$ and $\s^\iota_{(p_-,p_+;A)}$. As in Remark~\ref{rmk:PSS orient} this is determined via the fiber product construction in Lemma~\ref{lem:iota,h poly} from the orientations of the Morse trajectory spaces in Remark~\ref{rmk:MorseOrient}~(i) and the orientations of $\s_{\rm GW}, \s_{\rm SFT}$ given in Assumption~\ref{ass:iota,h}.
	In practice, we will construct the perturbations $\ul\k,\ul\k^\iota$ by pullback of perturbations $\ul \lambda=(\lambda_A)_{A\in H_2(M)}$ of the SFT-sections $\s_{\rm SFT}$ and their restriction $\ul \lambda^\iota$ to $\{0\}\times\cB_{\rm GW}(A)\subset\partial \cB_{\rm SFT}(A)$. So we can specify the orientations of the regularized zero sets by expressing them as transverse fiber products of oriented spaces over $\CP^1\times M$ or $\C^\pm \times M$,
	\begin{align*}
		Z^{\ul\k^{\iota}}(p_-,p_+;A) & \;=\; \bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ov\ev^+} \;  Z^{\ul\l^\iota}(A)
		\; \leftsub{\ov\ev^-}{\times}_{\ev_0^-} \;  \bM(M,p_+) ,                                                                                                                                                   \\
		                             & \;=\; \bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \;  \bigl( Z^{\ul\l^\iota}(A) \cap \cB^{+,-}_{\rm GW}(A) \bigr) \; \leftsub{\ev^-}{\times}_{\ev_0^-} \;  \bM(M,p_+) , \\
		Z^{\ul\k}(p_-,p_+;A)         & \;=\; \bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \;  \bigl( Z^{\ul\l}(A) \cap \cB^{+,-}_{\rm SFT}(A) \bigr) \; \leftsub{\ev^-}{\times}_{\ev_0^-} \;  \bM(M,p_+) ,
	\end{align*}
	using $\ov\ev^\pm: \cB_{\rm GW}(A)\to\CP^1\times M$ resp.\
	$\ev^\pm: \cB^{+,-}_{\rm GW/SFT}(A)\to\C^\pm\times M$
	and the Morse evaluations
	$\ev_0^\pm: \bM(\ldots) \to \CP^1\times M, \ul\tau\mapsto (z_0^\pm, \ev(\ul\tau) )$
	resp.\
	$\ev_0^\pm: \bM(\ldots) \to \C^\pm\times M, \ul\tau\mapsto (0, \ev(\ul\tau) )$.
\end{rmk}



\section{Algebraic relations via coherent perturbations}
\label{sec:algebra}

In this section we prove parts (i)--(iii) of Theorem~\ref{thm:main}, that is the algebraic properties which relate the maps $PSS:CM\to CF$, $SSP:CF\to CM$ constructed in \S\ref{sec:PSS}, and the maps $\iota:CM\to CM$, $h:CM\to CM$ constructed in \S\ref{sec:iota,h}.
More precisely, we will make so-called ``coherent'' choices of perturbations
in \S\ref{ssec:chain}, \S\ref{ssec:iso}, and \S\ref{ssec:homotopy} which guarantee that
(i) $\iota$ is a chain map, (ii) $\iota$ is a $\L$-module isomorphism, and (iii) $h$ is a chain homotopy between the composition $SSP\circ PSS$ and $\iota$.

\subsection{Coherent polyfold descriptions of moduli spaces}  \label{ssec:coherent}

The general approach to obtaining not just counts as discussed in \S\ref{ssec:poly} but well-defined algebraic structures from moduli spaces of pseudoholomorphic curves is to replace them by compact manifolds with boundary and corners (or generalizations thereof which still carry `relative virtual fundamental classes') in such a manner that their boundary strata are given by Cartesian products of each other.
In the context of polyfold theory, this requires a description of the compactified moduli spaces $\bM(\alpha)=\sigma_\alpha^{-1}(0)$ as zero sets of a ``coherent collection'' of sc-Fredholm sections $\bigl(\sigma_\alpha:\cB(\alpha)\to\cE(\alpha)\bigr)_{\alpha\in\cI}$ of strong polyfold bundles.
Here ``coherence'' indicates a well organized identification of the boundaries $\partial\cB(\alpha)$ with unions of Cartesian products of other polyfolds in the collection $\cI$, which is compatible with the bundles and sections.

As a first example, the moduli spaces $\cM^\iota(p_-,p_+;A)$ in \S\ref{ssec:iota-mod} which yield the map $\iota:CM \to CM$ are given polyfold descriptions $\s^\iota_{(p_-,p_+; A)}: \cB^\iota(p_-,p_+;A) \to \phi_\iota^* \cE(p_-,p_+;A)$ in Lemma~\ref{lem:iota,h poly} that arise as fiber products with polyfolds $\cB_{\rm GW}(A)$ without boundary. Thus their coherence properties stated below follow from properties of the fiber product in \cite{Ben-fiber} and the boundary stratification of the Morse trajectory spaces in Theorem~\ref{thm:Morse}.
We state this result to illustrate the notion of coherence. The full technical statement -- on the level of ep-groupoids and including compatibility with bundles and sections -- can be found in the second bullet point of Lemma~\ref{lem:iota chain}.


\begin{lem} \label{lem:iota boundary}
	For any $p_\pm\in{\rm Crit}(f)$ and $A\in H_2(M)$ the smooth level of the first boundary stratum of the fiber product $\cB^\iota(p_-,p_+; A)$ in Lemma~\ref{lem:iota,h poly} is naturally identified with
	$$
		\partial_1\cB^\iota(p_-,p_+; A)_\infty \;\cong\; \bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cB^\iota(q,p_+; A)_\infty
		\quad
		\sqcup  \bigcup_{q\in{\rm Crit}(f)} \partial_0\cB^\iota(p_-,q; A)_\infty \times \cM(q,p_+).
	$$
\end{lem}



\begin{proof}
	By the fiber product construction \cite[Cor.7.3]{Ben-fiber} of $\cB^{\i}(p_-,p_+;A)$ in Lemma~\ref{lem:iota,h poly}, the degeneracy index
	satisfies $d_{\cB^{\i}(p_-,p_+;A)}(\ul{\t}^-,\ul{v},\ul{\t}^+) = d_{\bM(p_-,M)}(\ul{\t}^-) + d_{\cB_{\rm GW}(A)}(\ul{v}) + d_{\bM(M,p_+)}(\ul{\t}^+)$, and the smooth level is
	$\cB^{\i}(p_-,p_+;A)_\infty =
		\bM(p_-,M) \; \leftsub{\{z_0^-\}\times\ev}{\times}_{\ev^-} \;  \cB_{\rm GW}^{+,-}(A)_\infty \; \leftsub{\ev^+}{\times}_{\{z_0^+\}\times\ev} \;  \bM(M,p_+)$.
	The polyfold $\cB_{\rm GW}(A)$ and its open subset $\cB_{\rm GW}^{+,-}(A)$ are boundaryless by Assumption~\ref{ass:iota,h}~(iii), which means $d_{\cB_{\rm GW}(A)}=d_{\cB_{\rm GW}^{+,-}(A)} \equiv 0$. Hence we have $d_{\cB^{\i}(p_-,p_+;A)}(\ul{\t}^-,\ul{v},\ul{\t}^+) = 1$ if and only if $\ul{\t}^- \in \partial_1 \bM(p_-,M)$ and $\ul{\t}^+ \in \partial_0 \bM(M,p_+)$ or the other way around. These two cases are disjoint but analogous, so it remains to show that the first case consists of points in the union $\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cB^\iota(q,p_+; A)_{\infty}$. For that purpose recall the identification $\partial_1 \bM(p_-,M)= \bigcup_{q\in{\rm Crit}(f)} {\cM}(p_-,q) \times {\cM}(q,M)$ in Theorem~\ref{thm:Morse}, which is compatible with the evaluation $\ev: {\cM}(p_-,q) \times {\cM}(q,M) \to M, (\tau_1,\tau_2) \mapsto \ev(\tau_2)$ by construction, and thus
	\begin{align*}
		 &
		\partial_1\bM(p_-,M) \; \leftsub{\{z_0^-\}\times\ev}{\times}_{\ev^-} \;  \cB_{\rm GW}^{+,-}(A)_\infty \; \leftsub{\ev^+}{\times}_{\{z_0^+\}\times\ev} \;  \partial_0\bM(M,p_+)                                                       \\
		 & \quad =
		\Bigl(\textstyle \bigcup_{q\in{\rm Crit}(f)} {\cM}(p_-,q) \times {\cM}(q,M) \Bigr) \; \leftsub{\{z_0^-\}\times\ev}{\times}_{\ev^-} \;  \cB_{\rm GW}^{+,-}(A)_\infty \; \leftsub{\ev^+}{\times}_{\{z_0^+\}\times\ev} \;  \cM(M,p_+)   \\
		 & \quad =
		\textstyle \bigcup_{q\in{\rm Crit}(f)} {\cM}(p_-,q) \times  \Bigl( {\cM}(q,M) \; \leftsub{\{z_0^-\}\times\ev}{\times}_{\ev^-} \;  \cB_{\rm GW}^{+,-}(A)_\infty \; \leftsub{\ev^+}{\times}_{\{z_0^+\}\times\ev} \;  \cM(M,p_+) \Bigr) \\
		 & \quad = \textstyle \bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cB^\iota(q,p_+; A)_{\infty}
	\end{align*}
	Here we also used the identification of the interior smooth level in Lemma~\ref{lem:iota,h poly}.
\end{proof}




Next, the polyfold description in Lemma~\ref{lem:iota,h poly} for the moduli spaces  $\cM(p_-,p_+;A)$ in \S\ref{ssec:h-mod}, which yield the map $h:CM \to CM$, are obtained as fiber products of the Morse trajectory spaces with polyfold descriptions $\s_{\rm SFT}: \cB_{\rm SFT}(A)\to \cE_{\rm SFT}(A)$ of SFT moduli spaces given in \cite{fh-sft-full}.
We will state as assumption only those parts of their coherence properties that are relevant to our argument in \S\ref{ssec:homotopy} for the chain homotopy $\iota - SSP\circ PSS = \rd \circ h + h \circ \rd$. Here the contributions to $\rd \circ h + h \circ \rd$ will arise from boundary strata of the Morse trajectory spaces, whereas $\iota - SSP\circ PSS$ arises from the following identification of the boundary of the polyfold $\cB^{+,-}_{\rm SFT}(A)$, which is given as open subset of $\cB_{\rm SFT}(A)$ in Assumption~\ref{ass:iota,h}~(iv).
\footnote{See also the end of Remark~\ref{rmk:drama2}~(ii) for the motivation of $\cB^{+,-}_{\rm SFT}(A)$ as open subset that intersects the boundary strata
	$\lim_{R\to\infty} \{R\} \times\cB_{\rm GW}(A)\subset\partial\cB_{\rm SFT}(A)$ in the buildings which have one marked point in each of the components mapping to $\C^\pm\times M$, and no marked points mapping to intermediate cylinders $\R\times S^1\times M$.}

\begin{rmk} \rm \label{rmk:face}
	In the following we will use the word ``face'' loosely for Cartesian products of polyfolds such as
	$\cF=\cB^+_{\rm SFT} (\g;A_+)\times \cB^-_{\rm SFT} (\g; A_-)$ and their immersions into the boundary of another polyfold such as $\partial\cB^{+,-}_{\rm SFT}(A)$. We also refer to the image of the immersion $\cF \hookrightarrow \partial\cB^{+,-}_{\rm SFT}(A)$ as a face of $\cB^{+,-}_{\rm SFT}(A)$. Compared with the formal definition of faces in \cite[Definitions~2.21,11.1,16.13]{HWZbook}, ours are disjoint unions of faces.
	They describe the interaction between the moduli spaces - roughly speaking:
	\begin{enumilist}
		\item
		The $R\to\infty$ boundary parts of $\cB_{\rm SFT}(A)$ in which the marked points separate are covered by immersions of products of the PSS and SSP polyfolds. This structure arises from generalizing the SFT compactification in \cite{sft-compactness} to buildings of not necessarily holomorphic maps. The parts of the boundary described here are given by buildings whose top and bottom floors are given by maps to $\C^\pm\times M$ and intermediate floors given by maps to $\R\times S^1\times M$. The immersions then arise from stacking a building in $\cB^+_{\rm SFT}(\g;A_+)$ (with top floor in $\C\times M$) on top of a building in $\cB^-_{\rm SFT}(\g;A_-)$ (with bottom floor in $\C^-\times M$). Here a lack of injectivity arises at buildings with middle floors in $\R\times S^1\times M$ from ambiguity in splitting such building into two parts.

		\item
		The immersions restrict to a disjoint cover of the top boundary stratum of $\cB^{+,-}_{\rm SFT}(A)$ by embeddings. This restriction is given by the buildings with a single floor -- guaranteeing injectivity by avoiding the ambiguous middle floors in $\R\times S^1\times M$.
		\item
		The immersions are compatible -- simply by construction -- with the evaluation maps, bundles, and sections for the boundary components at $R=\infty$, and the boundary $\cB_{\rm GW}(A)$ at $R=0$.
	\end{enumilist}

\end{rmk}

\begin{ass}\label{ass:iso}
	The collection of oriented sc-Fredholm sections of strong polyfold bundles
	$\s^\pm_{\rm SFT}: \cB^{\pm}_{\rm SFT}(\g; A)\to \cE^\pm_{\rm SFT}(\g;A)$,
	$\s_{\rm GW}: \cB_{\rm GW}(A)\to \cE_{\rm GW}(A)$,
	$\s_{\rm SFT}: \cB_{\rm SFT}(A)\to \cE_{\rm SFT}(A)$
	for $\g\in\cP(H)$ and $A\in H_2(M)$
	together with the evaluation maps $\ov\ev^\pm: \cB^{\pm}_{\rm SFT}(\g;A)\to \ov{\C^\pm} \times M$,
	$\ov\ev^\pm: \cB_{\rm GW}(A)\to \CP^1 \times M$,
	$\ov\ev^\pm: \cB_{\rm SFT}(A)\to \ov{\CP^1_\infty} \times M$,
	and their sc$^\infty$ restrictions on open subsets,
	$\ev^\pm: \cB^{\pm,\C}_{\rm SFT}(\g;A)\to \C^\pm \times M$,
	$\ev^\pm: \cB^{+,-}_{\rm GW/SFT}(A)\to \C^\pm \times M$
	from Assumptions~\ref{ass:pss}, \ref{ass:iota,h} has the following coherence properties.
	\begin{enumilist}
		\item For each $\g \in \cP(H)$ and $A_-,A_+ \in H_2(M)$ such that $A_- + A_+ = A$, there is a sc$^\infty$ immersion
		$$
			l_{\g,A_{\pm}} \,:\; \cB^+_{\rm SFT}(\g;A_+) \times \cB^-_{\rm SFT}(\g;A_-) \;\rightarrow\; \partial \cB_{\rm SFT}(A)
		$$
		whose restriction to the interior $\partial_0\cB^+_{\rm SFT}(\g;A_+) \times \partial_0\cB^-_{\rm SFT}(\g;A_-)\subset \cB^{+,\C}_{\rm SFT}(\g;A_+) \times \cB^{-,\C}_{\rm SFT}(\g;A_-)$ is an embedding into the boundary of the open subset $\cB^{+,-}_{\rm SFT}(A) \subset \cB_{\rm SFT}(A)$.
		They map into the limit set $\lim_{R\to\infty} \{R\} \times\cB_{\rm GW}(A)$ from Assumption~\ref{ass:iota,h}(iii), so cover most of the boundary\footnote{
			The extra boundary faces of $\cB_{\rm SFT}(A)$ arise from both marked points mapping to the same component in the $R\to\infty$ neck stretching limit. These will not be relevant to our construction of coherent perturbations.
		}
		$$
			\partial\cB_{\rm SFT}(A) \;\supset\; \{0\}\times \cB_{\rm GW}(A)  \;\; \sqcup \;\;
			\textstyle\bigcup_{\begin{smallmatrix}
					\scriptscriptstyle \g \in \cP(H)\\
					\scriptscriptstyle A_- + A_+ = A\\
				\end{smallmatrix}} l_{\g,A_{\pm}}\bigl( \cB^{+}_{\rm SFT}(\g;A_+) \times \cB^{-}_{\rm SFT}(\g;A_-) \bigr).
		$$

		\item
		The union of the images $l_{\g,A_{\pm}}\bigl(\cB^{+,\C}_{\rm SFT}(\g;A_+) \times \cB^{-,\C}_{\rm SFT}(\g;A_-)\bigr)\subset\partial \cB^{+,-}_{\rm SFT}(A)$ for all admissible choices of $\g,A_{\pm}$ is the intersection of $\cB^{+,-}_{\rm SFT}(A)$ with $\lim_{R\to\infty} \{R\} \times\cB_{\rm GW}(A)\subset\partial \cB_{\rm SFT}(A)$, i.e.\
		\begin{align*} \textstyle
			\partial\cB^{+,-}_{\rm SFT}(A)            & \;=\; \{0\}\times \cB^{+,-}_{\rm GW}(A)  \;\; \sqcup \;\;
			\partial^{R=\infty}\cB^{+,-}_{\rm SFT}(A),                                                            \\
			\text{where}\qquad\quad
			\partial^{R=\infty}\cB^{+,-}_{\rm SFT}(A) & \;=\; \textstyle
			\bigcup_{\begin{smallmatrix}
					         \scriptscriptstyle \g \in \cP(H)\\
					         \scriptscriptstyle A_- + A_+ = A\\
				         \end{smallmatrix}} l_{\g,A_{\pm}}\bigl( \cB^{+,\C}_{\rm SFT}(\g;A_+) \times \cB^{-,\C}_{\rm SFT}(\g;A_-) \bigr).
		\end{align*}
		When restricted to the interiors, this yields a disjoint cover of the top boundary stratum,
		$$ \textstyle
			\partial_1\cB^{+,-}_{\rm SFT}(A) \;=\; \{0\}\times \cB^{+,-}_{\rm GW}(A)  \;\; \sqcup \;\;
			\bigsqcup_{\begin{smallmatrix}
					\scriptscriptstyle \g \in \cP(H)\\
					\scriptscriptstyle A_- + A_+ = A\\
				\end{smallmatrix}} l_{\g,A_\pm}\bigl( \partial_0\cB^+_{\rm SFT} (\g;A_+)\times \partial_0\cB^-_{\rm SFT} (\g; A_-) \bigr).
		$$

		\item The immersions $l_{\g,A_\pm}$ are compatible with the evaluation maps, bundles, and sections -- as required for the construction \cite{fh-sft-full} of coherent perturbations for SFT, that is:
		\begin{itemize}
			\item[(a)]
			      The boundary restriction of the evaluation maps $\ov\ev^\pm|_{\{0\}\times \cB_{\rm GW}(A)\subset\partial\cB_{\rm SFT}(A)}$ coincides with the Gromov-Witten evaluation maps $\ov\ev^\pm:\cB_{\rm GW}(A)\to \ov{\CP^1_\infty}$, and the same holds for their sc$^\infty$ restriction
			      $\ev^+\times \ev^-|_{\{0\}\times \cB^{+,-}_{\rm GW}(A)\subset\partial\cB^{+,-}_{\rm SFT}(A)}
				      = \ev^+\times \ev^- : \cB^{+,-}_{\rm GW}(A) \to \C^+ \times M\times \C^-\times M$ with values in $\C^\pm\subset\ov{\CP^1_\infty}=\C^+\sqcup S^1 \sqcup \C^-$.
			      The restriction of $\ov\ev^\pm:\cB_{\rm SFT}(A)\to \ov{\CP^1_\infty}$ to each boundary face $\im l_{\g,A_\pm}\subset\partial\cB_{\rm SFT}(A)$ takes values in $\ov{\C^\pm}\subset \ov{\CP^1_\infty}$, and its pullback under $l_{\g,A_\pm}$ coincides with
			      $\ov\ev^\pm: \cB^\pm_{\rm SFT} (\g;A_\pm) \to \ov{\C^\pm}\times M$.
			      Moreover, pullback of the restricted sc$^\infty$ evaluations $\ev^+\times\ev^-:\cB^{+,-}_{\rm SFT}(A)\to \C^+\times M\times\C^-\times M$ under $l_{\g,A_\pm}$ coincides with
			      $\ev^+\times\ev^-: \cB^{+,\C}_{\rm SFT} (\g;A_+)\times \cB^{-,\C}_{\rm SFT} (\g; A_-) \to \C^+\times M \times  \C^-\times M$.
			\item[(b)]
			      The restriction of $\sigma_{\rm SFT}$ to $\cF=\{0\}\times \cB_{\rm GW}(A) \subset \partial\cB_{\rm SFT}(A)$ equals to $\sigma_{\rm GW}$ via a natural identification $\cE_{\rm SFT}(A)|_\cF \cong \cE_{\rm GW}(A)$. This identification reverses the orientation of sections.
			\item[(c)]
			      The restriction of $\sigma_{\rm SFT}$ to each face
			      $\cF=\cB^+_{\rm SFT} (\g;A_+)\times \cB^-_{\rm SFT} (\g; A_-)  \subset \partial\cB_{\rm SFT}(A)$ is related by pullback to $\s^+_{\rm SFT}\times \s^-_{\rm SFT}= \sigma_{\rm SFT}\circ l_{\g,A_\pm}$ via a natural identification $l_{\g,A_\pm}^*\cE_{\rm SFT}(A) \cong \cE^+_{\rm SFT} (\g; A_+) \times  \cE^-_{\rm SFT} (\g; A_-)$. This identification preserves the orientation of sections.
		\end{itemize}
	\end{enumilist}
\end{ass}



\subsection{Coherent perturbations for chain map identity} \label{ssec:chain}

In this section we prove Theorem~\ref{thm:main}~(i), that is we construct $\iota_{\ul\kappa^\iota}$ in Definition~\ref{def:iota,h} as a chain map on the Morse complex \eqref{eq:CM} with differential $d:CM\to CM$ given by \eqref{eq:MorseDiff}.
This requires the following construction of the perturbations $\ul\kappa^\iota$ that is coherent in the sense that it is compatible with the boundary identifications of the polyfolds $\cB^\iota(p_-,p_+;A)$ in Lemma~\ref{lem:iota boundary}.
Here we will indicate smooth levels by adding $\infty$ as superscript -- denoting e.g.\ $\cX^{\iota,\infty}_{p_-,p_+; A}$ as the smooth level of an ep-groupoid representing $\cB^\iota(p_-,p_+;A)_\infty$.

\begin{lem} \label{lem:iota chain}
	There is a choice of $( \kappa^\iota_\alpha )_{\alpha\in\cI}$ in Corollary~\ref{cor:regularize} for $\cI=\{(p_-,p_+;A)\,|\, p_\pm\in\Crit(f), A\in H_2(M) \}$ that is coherent
	w.r.t.\ the identifications in Lemma~\ref{lem:iota boundary} in the following sense.
	\begin{itemlist}
		\item
		Each $\kappa_{\alpha}^\iota:\cW^\iota_{\alpha}\to\Q^+$ for $\alpha\in\cI$ is an admissible sc$^+$-multisection of a strong bundle $P_\alpha: \cW^\iota_{\alpha} \to \cX^\iota_{\alpha}$ that is in general position to a sc-Fredholm section functor $S^\iota_{\alpha}: \cX^\iota_{\alpha} \to \cW^\iota_{\alpha}$ which represents $\sigma^\iota_{\alpha}|_{\cV_{\alpha}}$ on an open neighbourhood $ \cV_{\alpha}\subset \cB^\iota(\alpha)$ of the zero set $\sigma_{\alpha}^{-1}(0)$.
		\item
		The identification of top boundary strata in Lemma~\ref{lem:iota boundary} holds for the representing ep-groupoids,
		$$\textstyle
			\partial_1\cX^{\iota,\infty}_{p_-,p_+; A} \;\cong\; \bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cX^{\iota,\infty}_{q,p_+; A} \quad \sqcup \quad \bigcup_{q\in{\rm Crit}(f)} \partial_0\cX^{\iota,\infty}_{p_-,q; A} \times \cM(q,p_+) ,
		$$
		and the oriented section functors $S^\iota_\alpha: \cX^\iota_\alpha \to \cW^\iota_\alpha$ are compatible with these identifications in the sense that the restriction of $S^\iota_{p_-,p_+; A}$ to any face $\cF^\infty_{(p_-,q_-),\alpha'} := \cM(p_-,q_-) \times \partial_0\cX^{\iota,\infty}_{\alpha'} \subset  \partial_1\cX^{\iota,\infty}_{p_-,p_+; A}$ resp.\
		$\cF^\infty_{\alpha',(q_+,p_+)}:= \partial_0\cX^{\iota,\infty}_{\alpha'} \times \cM(q_+,p_+)\subset  \partial_1\cX^{\iota,\infty}_{p_-,p_+; A}$ for another $\alpha'\in\cI$ coincides on the smooth level with the pullback $S^\iota_\alpha|_{\cF^\infty}=\pr_{\cF}^*S^\iota_{\alpha'}|_{\cF^\infty}$ of $S^\iota_{\alpha'}$ via the projection
		$\pr_{\cF}:  \cF=\cF_{(p_-,q_-),\alpha'} := \cM(p_-,q_-) \times \partial_0\cX^{\iota}_{\alpha'}  \to \cX^{\iota}_{\alpha'}$
		resp.\
		$\pr_{\cF}:  \cF=\cF_{\alpha',(q_+,p_+)}:= \partial_0\cX^{\iota}_{\alpha'} \times \cM(q_+,p_+)
			\to \cX^{\iota}_{\alpha'}$.
		\item
		Each restriction $\kappa_{\alpha}^\iota|_{P_\alpha^{-1}(\cF^\infty)}$ to a face
		$\cF^\infty=\cF^\infty_{(p_-,q_-),\alpha'}$ resp.\ $\cF^\infty=\cF^\infty_{\alpha',(q_+,p_+)}$ is given by pullback $\kappa_{\alpha}^\iota|_{P_\alpha^{-1}(\cF^\infty)}=\kappa^\iota_{\alpha'}\circ \pr_\cF^*$ via the identification $P_\alpha^{-1}(\cF^\infty)\cong \pr_\cF^*\cW^\iota_{\alpha'}|_{\partial_0\cX^{\iota,\infty}_{\alpha'}}$ and natural map $\pr_\cF^*: \pr_\cF^*\cW^\iota_{\alpha'} \to \cW^\iota_{\alpha'}$.
	\end{itemlist}
	For any such choice of $\underline\kappa^\iota=( \kappa^\iota_\alpha )_{\alpha\in\cI}$, the resulting map $\iota_{\underline\kappa^\iota}:CM \to CM$  in Definition~\ref{def:iota,h} satisfies
	$\iota_{\underline\kappa^\iota} \circ \rd + \rd \circ \iota_{\underline\kappa^\iota} = 0$.
	By setting $\iota\la p\ra :=(-1)^{|p|} \iota _{\underline\kappa^\iota}\la p\ra$
	we then obtain a chain map $\iota:C_*M\to C_*M$, that is $\iota \circ \rd = \rd \circ \iota$.
\end{lem}

\begin{proof}
	We will first assume the claimed coherence and discuss the algebraic consequences up to signs, then construct the coherent data, and finally use this construction to compute the orientations.

	\medskip
	\noindent
	{\bf Construction of chain map:}
	Assuming $\iota_{\underline\kappa^\iota} \circ \rd + \rd \circ \iota_{\underline\kappa^\iota} = 0$, recall that $d$ decreases the degree on the Morse complex \eqref{eq:CMgraded} by $1$. Thus $\iota:C_*M\to C_*M$ defined as above satisfies for any $q\in{\rm Crit}(f)$
	\begin{align*}
		( \iota \circ \rd - \rd \circ \iota ) \la q \ra
		\;=\;
		(-1)^{|q|-1} \iota_{\underline\kappa^\iota} ( \rd \la q \ra )  -  \rd (  (-1)^{|q|} \iota_{\underline\kappa^\iota} \la q \ra )
		\;=\;
		(-1)^{|q|-1} \bigl( \iota_{\underline\kappa^\iota} \circ \rd  +  \rd \circ \iota_{\underline\kappa^\iota} \bigr) \la q \ra
		\;=\;0 .
	\end{align*}
	By $\Lambda$-linearity this proves $\iota\circ \rd = \rd\circ\iota$ on $C_*M$.

	\medskip
	\noindent
	{\bf Proof of identity:}
	To prove $\iota_{\underline\kappa^\iota} \circ \rd + \rd \circ \iota_{\underline\kappa^\iota} = 0$ note that both $\iota_{\underline\kappa^\iota}$ and $\rd$ are $\L$-linear, so the claimed identity is equivalent to the collection of identities $(\iota_{\underline\kappa^\iota} \circ \rd) \la p_-\ra + (\rd \circ \iota_{\underline\kappa^\iota}) \la p_-\ra = 0$ for all generators $p_-\in{\rm Crit}(f)$.
	That is we wish to verify
	$$
		\sum_{\begin{smallmatrix}
				\scriptstyle q, p_+, A  \\ \scriptscriptstyle I^\iota(q,p_+;A)=0  \\ \scriptscriptstyle |q|=|p_-|-1
			\end{smallmatrix} }
		\hspace{-4mm}
		\#\cM(p_-,q) \cdot \#Z^{\ul\kappa^\iota}(q,p_+; A) \cdot T^{\o(A)} \la p_+ \ra
		\; + \; \hspace{-5mm}
		\sum_{\begin{smallmatrix}
				\scriptstyle  q, p_+, A  \\ \scriptscriptstyle I^\iota(p_-,q;A)=0   \\ \scriptscriptstyle |p_+|=|q|-1
			\end{smallmatrix} }
		\hspace{-4mm}
		\#Z^{\ul\kappa^\iota}(p_-,q; A) \cdot \#\cM(q,p_+) \cdot T^{\o(A)} \la p_+ \ra
		\; = 0.
	$$
	Here, by the index formula \eqref{iota index}, both sides can be written as sums over $p_+\in\Crit(f)$ and $A\in H_2(M)$ for which $I^\iota(p_-,p_+;A)=1$. Then it suffices to prove for any such pair $\alpha=(p_-,p_+;A)$ with $I^\iota(\alpha)=1$
	\begin{equation} \label{iota claim} \textstyle
		\sum_{|q|=|p_-|-1}  \#\cM(p_-,q) \cdot \#Z^{\ul\kappa^\iota}(q,p_+; A) \;\; + \;\;
		\sum_{|q|=|p_+|+1} \#Z^{\ul\kappa^\iota}(p_-,q; A) \cdot \#\cM(q,p_+) \;\; = \;\; 0 .
	\end{equation}
	This identity will follow by applying Corollary~\ref{cor:regularize}~(v) to the sc$^+$-multisection $\kappa_{\alpha}:\cW^\iota_{\alpha}\to\Q^+$.
	Its perturbed zero set is a weighted branched $1$-dimensional orbifold $Z^{\ul\kappa^\iota}(\alpha)$,
	whose boundary is given by the intersection with the smooth level\footnote{
		Here and in the following we suppress indications of the smooth level, as the perturbed zero sets automatically lie in the smooth level; see Remark~\ref{rmk:levels}.
	}
	of the top boundary stratum $\partial_1\cB^\iota(\alpha) \cap \cV_{\alpha} = |{\partial_1\cX^\iota_{\alpha}}|$.
	By coherence (and with orientations discussed below) this boundary is
	\begin{align*}
		 & \partial Z^{\ul\kappa^\iota}(\alpha) \;=\; Z^{\ul\kappa^\iota}(\alpha) \cap |\partial_1\cX^\iota_{\alpha} |                              \\
		 & \;=\; \textstyle
		\bigcup_{q\in{\rm Crit}(f)} Z^{\ul\kappa^\iota}(\alpha) \cap  \bigl(\cM(p_-,q) \times |\partial_0\cX^\iota_{q,p_+; A}| \bigr)
		\;\sqcup\;
		\bigcup_{q\in{\rm Crit}(f)} Z^{\ul\kappa^\iota}(\alpha) \cap \bigl( |\partial_0\cX^\iota_{p_-,q; A}| \times \cM(q,p_+)\bigr)                \\
		 & \;=\; \textstyle
		\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \bigl( Z^{\ul\kappa^\iota}(q,p_+; A) \cap  |\partial_0\cX^\iota_{q,p_+; A}| \bigr)            \\
		 & \qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\quad
		\textstyle
		\sqcup\; \bigcup_{q\in{\rm Crit}(f)}  \bigl( Z^{\ul\kappa^\iota}(p_-,q; A) \cap |\partial_0\cX^\iota_{p_-,q; A}| \bigr) \times \cM(q,p_+) , \\
		 & \;=\; \textstyle
		\bigcup_{|q|=|p_-|-1} \cM(p_-,q) \times Z^{\ul\kappa^\iota}(q,p_+; A) \quad
		\sqcup \quad  \bigcup_{|q|=|p_+|+1}  Z^{\ul\kappa^\iota}(p_-,q; A) \times \cM(q,p_+) .
	\end{align*}
	Here the first summand of the third identification on the level of object spaces,
	\begin{align*}
		 & \bigl\{([\tau],x) \in \cM(p_-,q) \times \partial_0 X_{q,p_+; A} \subset \partial_1 X_{\alpha} \,\big|\, \kappa_{\alpha}(S^\iota_{\alpha}([\tau],x))>0 \bigr\} \\
		 & \cong
		\bigl\{([\tau],x) \in \cM(p_-,q) \times \partial_0 X_{q,p_+; A} \,\big|\, \kappa_{q,p_+; A}(S^\iota_{q,p_+; A}(x)) >0 \bigr\}                                    \\
		 & =
		\cM(p_-,q) \times \bigl\{ x \in \partial_0 X_{q,p_+; A} \,\big|\, \kappa_{q,p_+; A}(S^\iota_{q,p_+; A}(x)) >0  \bigr\},
	\end{align*}
	follows if we assume coherence of sections and multisections on the faces $\cF_{(p_-,q),\alpha'}\subset \partial_1 \cX^\iota_\alpha$,
	$$
		\kappa_{\alpha}(S^\iota_{\alpha} ([\tau],x))
		\;=\; \kappa_{\alpha}(S^\iota_{q,p_+; A}(x))
		\;=\; \kappa_{q,p_+; A}(S^\iota_{q,p_+; A}(x)) .
	$$
	The second summand is identified similarly by assuming coherence on the faces $\cF_{\alpha',(q_-,p_+)}\subset \partial_1 \cX^\iota_\alpha$.

	Finally, the fourth identification in $\partial Z^{\ul\kappa^\iota}(\alpha)$ for $\alpha=(p_-,p_+;A)$ with $I^\iota(\alpha)=1$ follows from index and regularity considerations as follows. Corollary~\ref{cor:regularize}~(iii),(iv) guarantees that the perturbed solution spaces $Z^{\ul\kappa^\iota}(\alpha')$ are nonempty only for Fredholm index $I^\iota(\alpha')\geq0$, and for $I^\iota(\alpha')=0$ are contained in the interior, $Z^{\ul\kappa^\iota}(\alpha')\subset\partial_0\cB(\alpha')$.
	The Morse trajectory spaces $ \cM(p_-,q)$ resp.\ $\cM(q,p_+)$ are nonempty only for $|p_-|-|q|\geq 1$ resp.\ $|q|- |p_+| \geq 1$, so the perturbed solution spaces in the Cartesian products have Fredholm index \eqref{iota index}
	$$
		I^\iota(q,p_+; A) = 2c_1(A) + |q| - |p_+|   = I^\iota(p_-,p_+;A) + |q| - |p_-| =  1 + |q| - |p_-| \leq 0,
	$$
	and analogously $I^\iota(p_-,q; A) = I^\iota(p_-,p_+; A) + |p_+|-|q| \leq 0$. By the above regularity of the perturbed solution spaces this implies that the unions on the left hand side of the fourth identification are over $|q|=|p_-|-1$ resp.\ $|q|=|p_+|+1$ as in \eqref{iota claim},
	and for these critical points we have the inclusions $Z^{\ul\kappa^\iota}(q,p_+; A) \subset \partial_0\cB(q,p_+; A)$ and $Z^{\ul\kappa^\iota}(p_-,q; A) \subset \partial_0\cB(p_-,q; A)$ that verify the equality.

	This finishes the identification of the boundary $\partial Z^{\ul\kappa^\iota}(\alpha)$. Now Corollary~\ref{cor:regularize}~(v) asserts that the sum of weights over this boundary is zero -- when counted with signs that are induced by the orientation of $Z^{\ul\kappa^\iota}(\alpha)$. So in order to prove the identity \eqref{iota claim} we need to compare the boundary orientation of $\partial Z^{\ul\kappa^\iota}(\alpha)$ with the orientations on the faces. We will compute the relevant signs  in \eqref{eq:orient-iota} below, after first making coherent choices of representatives $S^\iota_\alpha: \cX^\iota_\alpha \to \cW^\iota_\alpha$ of the oriented sections $\s^\iota_\alpha$, and
	constructing coherent sc$^+$-multisections $\kappa_{\alpha}^\iota:\cW^\iota_{\alpha}\to\Q^+$ for ${\alpha\in\cI}$.

	\medskip
	\noindent
	{\bf Coherent ep-groupoids, sections, and perturbations:}
	Recall that the fiber product construction in Lemma~\ref{lem:iota,h poly} defines each bundle $\cW^\iota_\alpha=\pr_\alpha^*\cW^{\scriptscriptstyle \rm GW}_A$ for $\alpha=(p_-,p_+;A)\in\cI$ as the pullback of a strong bundle $\cW^{\scriptscriptstyle \rm GW}_A\to\cX^{\scriptscriptstyle \rm GW}_A$ under a projection of ep-groupoids -- with abbreviated notation
	$\ev_0^\pm:=\{z_0^\pm\}\times\ev :\bM(\ldots) \to \CP^1\times M$ --
	$$
		\pr_{p_-,p_+;A}\, : \;
		\cX^\iota_{p_-,p_+;A} \;=\; \bM(p_-,M) \; \leftsub{\ev^-_0}{\times}_{\ov\ev^-} \; \cX^{\scriptscriptstyle \rm GW}_A \; \leftsub{\ov\ev^+}{\times}_{\ev^+_0} \; \bM(M,p_+) \;\;\longrightarrow\;\;\cX^{\scriptscriptstyle \rm GW}_A  .
	$$
	Moreover, the section $S^\iota_\alpha= S^{\scriptscriptstyle \rm GW}_A\circ \pr_\alpha$ is induced by the section $S^{\scriptscriptstyle \rm GW}_A:\cX^{\scriptscriptstyle \rm GW}_A\to\cW^{\scriptscriptstyle \rm GW}_A$ which cuts out the Gromov-Witten moduli space $\bM_{\rm GW}(A)=|(S^{\scriptscriptstyle \rm GW}_A)^{-1}(0)|$.
	Then the identification of the top boundary stratum proceeds exactly as the proof of Lemma~\ref{lem:iota boundary}.
	Coherence of the bundles and sections follows from coherence of the projections $\pr_\alpha: \cX^\iota_\alpha \to \cX^{\scriptscriptstyle \rm GW}_A$ in the sense that $\pr_\alpha|_{\cF^\infty}= \pr_{\alpha'}\circ \pr_{\cF}$
	for all smooth levels of faces $\cF\supset \cF^\infty\subset \partial_1\cX^\iota_\alpha$ and their projections
	$\pr_{\cF}:  \cF=\cF_{(p_-,q_-),\alpha'} \to \cX^\iota_{\alpha'}$ resp.\ $\pr_{\cF}:  \cF=\cF_{\alpha',(q_-,p_+)} \to \cX^\iota_{\alpha'}$.
	For example, the face $\cF=\cF_{(p_-,q_-),(q_-,p_+;A)}$ with $\cF^\infty\subset  \partial_1\cX^\iota_{p_-,p_+;A}$ identifies
	\begin{align*}
		\bigl( [\tau], (\tau_-,[\ul v],\tau_+) \bigr) & \;\in\; \cF^\infty_{(p_-,q_-),(q_-,p_+;A)}
		\;=\; \cM(p_-,q_-) \times \partial_0\cX^{\iota,\infty}_{q_-,p_+;A}                                                                                                                                                                                                       \\
		                                              & \;=\; \cM(p_-,q_-) \times \cM(q_-,M) \; \leftsub{\ev^-_0}{\times}_{\ov\ev^-} \; \cX^{\scriptscriptstyle \rm GW, \infty}_A \; \leftsub{\ov\ev^+}{\times}_{\ev^+_0} \; \cM(M,p_+)                                          \\
		\text{with}\qquad
		\bigl( ( [\tau], \tau_-) ,[\ul v],\tau_+ \bigr)
		                                              & \;\in\; \bM(p_-,M)_1 \; \leftsub{\ev^-_0}{\times}_{\ov\ev^-} \; \cX^{\scriptscriptstyle \rm GW , \infty}_A \; \leftsub{\ov\ev^+}{\times}_{\ev^+_0} \; \cM(M,p_+)  \;\subset\; \partial_1\cX^{\iota,\infty}_{p_-,p_+;A} ,
	\end{align*}
	and $\pr_{p_-,p_+;A}\bigl( ( [\tau], \tau_-) ,[\ul v],\tau_+ \bigr) = [\ul v]\in \cX^{\scriptscriptstyle \rm GW}_A$
	coincides with
	$(\pr_{q_-,p_+;A}\circ \pr_\cF) \bigl( [\tau], (\tau_-,[\ul v],\tau_+) \bigr)
		= \pr_{q_-,p_+;A} (\tau_-,[\ul v],\tau_+ ) =  [\ul v]\in \cX^{\scriptscriptstyle \rm GW}_A$.
	Now any choice of sc$^+$-multisections $(\l^{\scriptscriptstyle \rm GW}_A:\cW^{\scriptscriptstyle \rm GW}_A\to\Q^+)_{A\in H_2(M)}$ induces a coherent collection of sc$^+$-multisections $\bigl(\kappa^\iota_\alpha:= \l^{\scriptscriptstyle \rm GW}_A\circ \pr_\alpha^* : \pr_\alpha^*\cW^{\scriptscriptstyle \rm GW}_A\to\Q^+\bigr)_{\alpha\in\cI}$ by composition with the natural maps $\pr_\alpha^*: \pr_\alpha^*\cW^{\scriptscriptstyle \rm GW}_A \to \cW^{\scriptscriptstyle \rm GW}_A$ covering $\pr_\alpha: \cX^\iota_\alpha \to \cX^{\scriptscriptstyle \rm GW}_A$.
	Indeed, $\pr_\alpha|_{\cF}= \pr_{\alpha'}\circ \pr_{\cF}$ lifts to $\pr_\alpha^*|_{P_\alpha^{-1}(\cF^\infty)}= \pr_{\alpha'}^*\circ \pr_{\cF}^*$ so that
	$$
		\kappa_{\alpha}^\iota|_{P_\alpha^{-1}(\cF^\infty)}
		\;=\;  \l^{\scriptscriptstyle \rm GW}_A\circ \pr_\alpha^*|_{P_\alpha^{-1}(\cF^\infty)}
		\;=\; \l^{\scriptscriptstyle \rm GW}_A\circ \pr_{\alpha'}^*\circ \pr_{\cF}^*
		\;=\;\kappa^\iota_{\alpha'}\circ \pr_\cF^* .
	$$


	\medskip
	\noindent
	{\bf Construction of admissible Gromov-Witten perturbations:}
	It remains to choose the sc$^+$-multisections $(\l^{\scriptscriptstyle \rm GW}_A:\cW^{\scriptscriptstyle \rm GW}_A\to\Q^+)_{A\in H_2(M)}$ so that the induced coherent collection $\ul\kappa^\iota=\bigl(\l^{\scriptscriptstyle \rm GW}_A\circ \pr_\alpha^* \bigr)_{\alpha\in\cI}$ is admissible and in general position. To do so, for each $A \in H_2(M)$ we apply Theorem~\ref{thm:transversality} to the sc-Fredholm section functor $S^{\scriptscriptstyle\rm GW}_A : \cX^{\scriptscriptstyle\rm GW}_A \rightarrow \cW^{\scriptscriptstyle\rm GW}_A$, the sc$^\infty$ submersion $\ov\ev^- \times \ov\ev^+ : \cX^{\scriptscriptstyle\rm GW}_A \rightarrow \CP^1\times M \times \CP^1\times M$, and the collection of Cartesian products of stable and unstable manifolds $\{z_0^-\}\times W_{p_-}^- \times \{z_0^+\}\times W_{p_+}^+$ for all pairs of critical points $p_-,p_+ \in \Crit(f)$.

	After fixing a pair controlling compactness $(N_A,\cU_A)$ for each $A\in H_2(M)$, Theorem~\ref{thm:transversality} yields $(N_A,\cU_A)$-admissible sc$^+$-multisections $\l^{\scriptscriptstyle\rm GW}_A : \cW^{\scriptscriptstyle\rm GW}_A \rightarrow \mathbb{Q}^+$ in general position to $S_A^{\scriptscriptstyle\rm GW}$ for each $A\in H_2(M)$. Moreover, they can be chosen such that restriction of evaluations to the perturbed zero set
	$\ov\ev^- \times \ov\ev^+: Z^{\l_A^{\scriptscriptstyle\rm GW}}\to \CP^1\times M\times \CP^1 \times M$ is transverse to all of the products of unstable and stable submanifolds $\{z_0^-\}\times W_{p_-}^- \times \{z_0^+\}\times W_{p_+}^+$ for $p_-,p_+\in\Crit(f)$.
	Note that these embedded submanifolds cover the images of all evaluation maps on the compactified Morse trajectory spaces $\ev_0^-\times \ev_0^+: \bM(p_-,M)\times \bM(M,p_+) \to \CP^1\times M\times \CP^1\times M$, by construction of the evaluations $\ev:\bM(\ldots)\to M$ in \eqref{eval}, which determine $\ev_0^\pm(\ul\tau)=(z_0^\pm,\ev(\ul\tau))$.
	Thus we obtain transverse fiber products
	$\bM(p_-,M) \; \leftsub{\ev^-_0}{\times}_{\ov\ev^-} Z^{\l_A^{\scriptscriptstyle\rm GW}} \leftsub{\ov\ev^+}{\times}_{\ev^+_0} \; \bM(M,p_+)$ for every $\alpha\in\cI$.
	This translates into the pullbacks $\k^\iota_\alpha = \l^{\scriptscriptstyle \rm GW}_A\circ \pr_\alpha^*$ being in general position to the pullback sections $S^\iota_\alpha$ for $\alpha\in\cI$. Moreover, $\k^\iota_\alpha$ is admissible with respect to a pullback of $(N_A,\cU_A)$, so the perturbed zero set is a compact weighted branched orbifold for each $\alpha=(p_-,p_+;A)$,
	$$
		``\bigl|(S^\iota_\alpha + \kappa^\iota_\alpha)^{-1}(0)\bigr|\text{''} \;=\;
		Z^{\ul\kappa^\iota}(\alpha) \;=\;
		\bM(p_-,M) \; \leftsub{\ev^-_0}{\times}_{\ov\ev^-} Z^{\l_A^{\scriptscriptstyle\rm GW}} \leftsub{\ov\ev^+}{\times}_{\ev^+_0} \; \bM(M,p_+) .
	$$
	This finishes the construction of coherent perturbations.

	\medskip
	\noindent
	{\bf Computation of orientations:}
	To prove the identity \eqref{iota claim} it remains to compute the effect of the orientations in Remark~\ref{rmk:iota,h orient} on the algebraic identity in Corollary~\ref{cor:regularize}~(v) that arises from the boundary $\partial Z^{\ul\kappa^\iota}(\alpha)$ of the 1-dimensional weighted branched orbifolds arising from regularization of the moduli spaces with index $I^\iota(\alpha)=I^\iota(p_-,p_+;A)=1$. Here $Z^{\l_A^{\scriptscriptstyle\rm GW}}$ is of even dimension and has no boundary since the Gromov-Witten polyfolds in Assumption~\ref{ass:iota,h} have no boundary, and the index of $\s_{\rm GW}$ is even.
	For the Morse trajectory spaces, the boundary strata are determined in Theorem~\ref{thm:Morse}, with relevant orientations computed in Remark~\ref{rmk:MorseOrient}. Thus for $I^\iota(\alpha)=|p_-|-|p_+| +2c_1(A)=1$ we can compute orientations -- at the level of well defined finite dimensional tangent spaces at a solution; in whose neighbourhood the evaluation maps are guaranteed to be scale-smooth --
	\begin{align}
		\partial Z^{\ul\kappa^\iota}(\alpha) & \;=\;
		\partial_1\bM(p_-,M) \; \leftsub{\ev}{\times}_{\ev}\; Z^{\l_A^{\scriptscriptstyle\rm GW}}\; \leftsub{\ev}{\times}_{\ev} \; \partial_0\bM(M,p_+)  \nonumber                                                         \\
		                                     & \quad\sqcup\;
		(-1)^{\dim \bM(p_-,M)} \;
		\partial_0\bM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; Z^{\l_A^{\scriptscriptstyle\rm GW}}\; \leftsub{\ev}{\times}_{\ev} \; \partial_1\bM(M,p_+) \nonumber                                                         \\
		                                     & \;=\;
		\bigl( \textstyle\bigsqcup_{q\in\Crit f} \cM(p_-,q) \times \cM(q,M) \bigr) \; \leftsub{\ev}{\times}_{\ev}\; Z^{\l_A^{\scriptscriptstyle\rm GW}} \;\leftsub{\ev}{\times}_{\ev} \; \cM(M,p_+) \label{eq:orient-iota} \\
		                                     & \quad\sqcup\;
		(-1)^{|p_-| + |p_+|+1}
		\cM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; Z^{\l_A^{\scriptscriptstyle\rm GW}}\; \leftsub{\ev}{\times}_{\ev} \; \bigl( \textstyle \bigsqcup_{q\in\Crit f} \cM(M,q) \times \cM(q,p_+) \bigr) \nonumber            \\
		                                     & \;=\;
		\textstyle\bigsqcup_{q\in\Crit f} \cM(p_-,q) \times Z^{\ul\k^\iota}(q,p_+;A)
		\;\;\sqcup\;\;  \bigsqcup_{q\in\Crit f} Z^{\ul\k^\iota}(p_-,q;A) \times \cM(q,p_+) .  \nonumber
	\end{align}
	Here the signs in the first equality arise from the ambient Cartesian product
	$\partial ( \bM_-\times Z \times\bM_+) \subset (-1)^{\dim(\bM_-\times Z)}  \bM_-\times Z \times\bM_+$; in the second equality we used Remark~\ref{rmk:MorseOrient}; and in the final equality we use $|p_-|+|p_+|+1 \equiv I^\iota(\alpha)=1 \equiv 0$ modulo 2.
	This finishes the computation of the oriented boundaries $\partial Z^{\ul\kappa^\iota}(\alpha)$ for $I^\iota(\alpha)=1$ that proves \eqref{iota claim} and thus yields a chain map.
\end{proof}

\subsection{Admissible perturbations for isomorphism property} \label{ssec:iso}

In this section we prove Theorem~\ref{thm:main}~(ii), i.e.\ construct $\iota=(-1)^*\iota_{\ul\kappa^\iota}:C_*M\to C_*M$ in Definition~\ref{def:iota,h} and Lemma~\ref{lem:iota chain} as a $\L$-module isomorphism on the chain complex $CM=CM_\L$ over the Novikov field as in \eqref{eq:CM}.
This requires a construction of the perturbations $\ul\kappa^\iota$ that preserves the properties of the zero sets in Remark~\ref{rmk:iota-energy} for nonpositive symplectic area $\omega(A)\leq 0$.

\begin{lem} \label{lem:iota triangular}
	The coherent collection of sc$^+$-multisections $\ul\kappa^\iota$ in Lemma~\ref{lem:iota chain} can be chosen such that
	$\#Z^{\ul\kappa^\iota}(p_-,p_+;A)=0$ for $A\in H_2(M)\less\{0\}$ with $\o(A)\leq 0$, or for $A=0$ and $p_-\neq p_+$, and $\#Z^{\ul\kappa^\iota}(p,p;0)\neq 0$.
	As a consequence, $\iota=(-1)^*\iota_{\ul\kappa^\iota} : CM_{\L} \to CM_{\L}$ is a $\L$-module isomorphism.
\end{lem}

\begin{proof}
	The sc$^+$-multisections $\ul\kappa^\iota$ in Lemma~\ref{lem:iota chain} are obtained from choices of sc$^+$-multisections $(\kappa_A:\cW^\iota_A\to\Q^+)_{A\in H_2(M)}$ that are in general position to sc-Fredholm sections $S_A:\cX^{\scriptscriptstyle \rm GW}_A\to\cW_A$ which cut out the Gromov-Witten moduli space $\bM_{\rm GW}(A)=|S_A^{-1}(0)|$, and such that moreover the evaluation maps restricted to the perturbed zero sets, $\ov\ev^-\times\ov\ev^+: Z({\kappa_A}) \to \CP^1\times M\times \CP^1\times M$ are transverse to the unstable and stable manifolds $\{z^-_0\}\times W^-_{p_-}\times \{z^+_0\}\times W^+_{p_+}\subset \CP^1\times M\times \CP^1\times M$ for any pair of critical points $p_-,p_+\in\Crit(f)$.

	We will first consider $\alpha=(p_-,p_+;A)\in\cI$ for nontrivial homology classes $A\in H_2(M)\less\{0\}$ with nonpositive symplectic area $\o(A)\leq 0$. Recall from Remark~\ref{rmk:iota-energy} that these moduli spaces are empty $|S_A^{-1}(0)|=\emptyset$, so as in Corollary~\ref{cor:regularize} we can choose empty neighbourhoods $\emptyset =|\cU_A|\subset |\cX^{\scriptscriptstyle \rm GW}_A|$ to control compactness. Then the perturbed zero set
	$Z({\kappa_A})=|\{ x\in X_A \,|\, \kappa_A(S_A(x)) >0 \}| \subset |\cU_A|$ is forced to be empty, i.e.\ $\kappa_A\circ S_A \equiv 0$. This is an allowed choice in Lemma~\ref{lem:iota chain} since evaluation maps from an empty set are trivially transverse to any submanifold.
	This choice induces for any $p_\pm\in\Crit(f)$ in $\alpha=(p_-,p_+;A)$ an induced sc$^+$-multisection $\kappa^\iota_\alpha =\kappa_A\circ \pr_\alpha^*:\cW^\iota_\alpha\to\Q^+$. Its perturbed zero set is
	$$
		Z^{\kappa^\iota_\alpha}(\alpha) = \bigl| \bigl\{ (\ul\tau^- , x , \ul\tau^+ ) \in  X_{\alpha} \,\big|\,
		\kappa^\iota_{\alpha}\bigl( S^\iota_\alpha (\ul\tau^- , x , \ul\tau^+ ) \bigr) >0
		\bigr\} \bigr| =\emptyset
	$$
	since the coherence in Lemma~\ref{lem:iota chain} implies
	$\kappa^\iota_{\alpha}\circ S^\iota_{\alpha} = \kappa_A\circ \pr_\alpha^* \circ S^\iota_{\alpha} = \kappa_A\circ S_A \circ \pr_\alpha \equiv 0$, or more concretely
	$\kappa^\iota_{(p_-,p_+;A)}\bigl( S^\iota_{p_-,p_+;A} (\ul\tau^- , x , \ul\tau^+ ) \bigr)
		= \kappa_A(S_A(x)) = 0$.
	Thus we have ensured vanishing counts $\#Z^{\ul\kappa^\iota}(p_-,p_+;A)=0$ for $A\in H_2(M)\less\{0\}$ with $\o(A)\leq 0$ whenever $I^\iota(p_-,p_+;A)=0$.

	Next we consider $A=0\in H_2(M)$ and recall from Remark~\ref{rmk:iota-energy} and Assumption~\ref{ass:iota,h}~(ii) that the Gromov-Witten moduli space $\bM_{\rm GW}(0) = Z(\kappa_0)$ is already compact and transversely cut out. Thus the trivial sc$^+$-multisection
	$\kappa_0:\cW_0\to \Q^+$, given by $\kappa_0(0_x)=1$ on zero vectors $0_x\in (\cW_0)_x$ and $\kappa_0|_{(\cW_0)_x \less \{0_x\}} \equiv 0$, is an admissible sc$^+$-multisection in general position to $S_0:\cX^{\scriptscriptstyle \rm GW}_0\to \cW_0$.
	Recall moreover that the evaluation maps on the unperturbed zero set are
	$$
		\ov\ev^-\times \ov\ev^+ : Z(\k_0)\simeq \CP^1\times\CP^1\times M \to \CP^1\times M \times\CP^1\times M, \qquad (z^-,z^+,x)\mapsto (z^-,x,z^+,x) .
	$$
	In the $\CP^1$-factors this is submersive so transverse to the fixed points $(z_0^-,z_0^+)\in\CP^1\times\CP^1$.
	In the $M$-factors this is the diagonal map, which is transverse to the unstable and stable manifolds $W^-_{p_-}\times W^+_{p_+}\subset M\times M$ for any pair $p_-,p_+\in\Crit(f)$ by the Morse-Smale condition on the metric on $M$ chosen in \S\ref{sec:Morse}.
	Thus the trivial multisection $\kappa_0$ is in fact an allowed choice in Lemma~\ref{lem:iota chain}.
	Now with this choice, the tuples $(p_-,p_+;0)\in\cI$ for which we need to compute
	\begin{align*}
		\#Z^{\ul\kappa^\iota}(p_-,p_+;0) & \;=\;
		\#\ \left| \left\{ (\ul\tau^- , [v] , \ul\tau^+ ) \in  \bM(p_-,M) \times Z({\kappa_0}) \times \bM(M,p_+)
		\, \big|\, \bigl( z_0^\pm, \ev(\ul\tau^\pm) \bigr) = \ov\ev^\pm([v])  \right\} \right|                                      \\
		                                 & \;\cong\;  \#\ \left| \left\{ (\ul\tau^- , \ul\tau^+ ) \in  \bM(p_-,M) \times \bM(M,p_+)
		\,\left|\, \ev(\ul\tau^-)= \ev(\ul\tau^+) \right. \right\} \right|
	\end{align*}
	are those with $0=I^\iota(p_-,p_+;0)= 2 c_1(0) + |p_-| - |p_+|$, i.e.\ $|p_-|=|p_+|$.
	These are the fiber products identified in Remark~\ref{rmk:MorseOrient}~(ii) as either empty or a one point set,
	\begin{align*}
		\bM(p_-,M) \leftsub{\ev}{\times}_\ev \bM(M,p_+)
		\;=\; \begin{cases}
			      \quad \emptyset                      & ; p_-\neq p_+ , \\
			      (\tau^-\equiv p_-, \tau^+\equiv p_+) & ; p_-= p_+ .
		      \end{cases}
	\end{align*}
	Thus we have counts $\#Z^{\ul\kappa^\iota}(p_-,p_+;0)=0$ for $p_-\neq p_+$ and
	$\#Z^{\ul\kappa^\iota}(p,p;0) \neq 0$ for each $p\in\Crit(f)$.




	Finally, we will use these computations of $\#Z^{\ul\kappa}(p_-,p_+;A)$ for $\o(A)\leq 0$ to prove that the resulting map $\iota:=(-1)^* \iota_{\ul\kappa^\iota} : CM_{\L} \to CM_{\L}$ is a $\L$-module isomorphism. For that purpose we choose an arbitrary total order of the critical points $\Crit(f)=\{p_1, \ldots, p_\ell\}$ and for $i,j\in\{1,\ldots,\ell\}$ denote the coefficients of
	$\i(\langle p_j \rangle) = \sum_{i=1}^\ell \lambda^{ij} \langle p_i \rangle$ by $\lambda^{ij}  \in \Lambda$.
	We claim that the $(\ell \times \ell)$-matrix with entries $\lambda^{ij}=\sum_{r\in\G} \lambda^{ij}_r T^r$ satisfies the conditions of Lemma~\ref{lem:invertibilitymatrixnovikov}. To check this recall that we have by construction in Definition~\ref{def:iota,h} and change of signs in Lemma~\ref{lem:iota chain}
	$$ \textstyle
		\lambda^{ij}_r \;=\; \sum_{\begin{smallmatrix}
				A \in H_2(M) , \o(A)=r \\  I^\iota(p_j,p_i;A)=0  \end{smallmatrix} }
		\;(-1)^{|p_j|} \;\#Z^{\ul\k^\iota}(p_j,p_i; A) .
	$$
	For $r<0$ we obtain $\lambda^{ij}_r=0$ since each coefficient $\#Z^{\ul\k^\iota}(p_j,p_i; A)=0$ vanishes for $\o(A)=r<0$.
	For $r=0$ and $i\neq j$ we also have $\lambda^{ij}_0=0$ since $\#Z^{\ul\k^\iota}(p_j,p_i; A)=0$ also holds for $\o(A)=0$ and $p_j\neq p_i$. Finally, for $r=0$ and $i=j$ we use $\#Z^{\ul\k^\iota}(p_j,p_i; A)=0$ for $A\neq 0$ with $\o(A)=0$ to compute $\lambda^{ii}_0 = \#Z^{\ul\k^\iota}(p_j,p_i; 0) \neq 0$.
	This confirms that Lemma~\ref{lem:invertibilitymatrixnovikov} applies, and thus $\i\cong (\lambda_{ij})_{1\leq i,j\leq\ell}$ is invertible. This finishes the proof.
\end{proof}

\subsection{Coherent perturbations for chain homotopy} \label{ssec:homotopy}

In this section we prove Theorem~\ref{thm:main}~(iii) by constructing $h_{\ul\kappa}: CM \rightarrow CM$ in Definition~\ref{def:iota,h} as a chain homotopy between $SSP_{\ul\kappa^+} \circ PSS_{\ul\kappa^-}$ and $\iota_{\ul\kappa^\iota}$ from Definitions~\ref{def:PSS},\ref{def:iota,h}, with appropriate sign adjustments as in Lemma~\ref{lem:iota chain}.
This requires a coherent construction of perturbations $\ul\kappa,\ul\kappa^\iota,\ul\kappa^-,\ul\kappa^+$ over the indexing sets
\begin{align*}
	\cI=\cI^\iota & \,:=\;  \bigl\{ \alpha=(p_-,p_+,A) \,\big|\, p_-,p_+\in{\rm Crit}(f) , A\in H_2(M) \bigr\} ,      \\
	\cI^+         & \,:=\; \bigl\{ \alpha=(p,\g,A) \,\big|\, p\in{\rm Crit}(f) , \g\in\cP(H) , A\in H_2(M) \bigr\},   \\
	\cI^-         & \,:=\;  \bigl\{ \alpha=(\g,p,A) \,\big|\, p\in{\rm Crit}(f) , \g\in\cP(H) , A\in H_2(M) \bigr\} .\end{align*}
Here we will use notation from Lemma~\ref{lem:Cartesian} for Cartesian products of multisections.


\begin{lem} \label{lem:h chain}
	There is a choice of $\ul\kappa^+=(\kappa^+_\alpha)_{\alpha\in\cI^+},\ul\kappa^-=(\kappa^-_\alpha)_{\alpha\in\cI^-},\ul\kappa^\iota=(\kappa^\iota_\alpha)_{\alpha\in\cI},\ul\kappa=(\kappa_\alpha)_{\alpha\in\cI}$ in Definitions~\ref{def:PSS},\ref{def:iota,h} that is coherent in the following sense.
	\begin{enumilist}
		\item
		Each $\kappa_{\alpha}^{\cdots}:\cW_{\alpha}^{\cdots}\to\Q^+$ for $\alpha\in\cI^+\sqcup\cI^-\sqcup\cI^\iota\sqcup\cI$ is an admissible sc$^+$-multisection of a strong bundle $P^{\cdots}_\alpha: \cW^{\cdots}_{\alpha} \to \cX^{\cdots}_{\alpha}$ that is in general position to a sc-Fredholm section functor $S^{\cdots}_{\alpha}: \cX^{\cdots}_{\alpha} \to \cW^{\cdots}_{\alpha}$ which represents $\sigma^{\cdots}_{\alpha}|_{\cV^{\cdots}_{\alpha}}$ on an open neighbourhood $ \cV^{\cdots}_{\alpha}\subset \cB^{\cdots}(\alpha)$ of the zero set ${\sigma^{\cdots}_{\alpha}}^{-1}(0)$.
		The tuple $\ul\k^\iota=(\kappa^\iota_\alpha)_{\alpha\in\cI^\iota}$ satisfies the conclusions of Lemma~\ref{lem:iota chain} and \ref{lem:iota triangular}.
		\item
		The smooth level of the first boundary stratum of $\cX_{p_-,p_+, A}$ for every $(p_-,p_+,A)\in\cI$ is naturally identified -- on the level of object spaces, and compatible with morphisms -- with
		\begin{align}\textstyle  \nonumber
			\partial_1\cX_{p_-,p_+, A}^\infty & \;\cong\;
			\partial_0\cX^{\iota,\infty}_{p_-,p_+, A} \quad \sqcup \bigcup_{\g\in\cP(H), A=A_-+A_+}
			\partial_0\cX^{+,\infty}_{p_-,\g, A_+} \times  \partial_0\cX^{-,\infty}_{\g,p_+, A_-} \\
			                                  & \qquad\sqcup\quad
			\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cX^\infty_{q,p_+, A} \quad \sqcup \quad \bigcup_{q\in{\rm Crit}(f)} \partial_0\cX^\infty_{p_-,q, A} \times \cM(q,p_+) ,
			\label{eq:homotopy bdy}
		\end{align}
		and the oriented section functors $S_\alpha^{\cdots}$ are compatible with these identifications in the sense that the restriction of $S_{p_-,p_+, A}$ to any of these faces $\cF^\infty\subset \partial_1\cX^\infty_{p_-,p_+, A}$ is given by pullback $S_{p_-,p_+, A}|_{\cF^\infty}=\pr_\cF^*S_\cF$ of another sc-Fredholm section of a strong bundle over an ep-groupoid $S_\cF: \cX_\cF\to\cW_\cF$ given by
		$S_{q,p_+, A}$, $S_{p_-,q, A}$, $S^\iota_{p_-,p_+, A}$, resp.\
		$$
			S_\cF= S^+_{p_-,\g, A_+} \times S^-_{\g,p_+, A_-} \,:\;
			\cX^+_{p_-,\g, A_+} \times \cX^-_{\g,p_+, A_-}  \;\to\; \cW^+_{p_-,\g, A_+} \times \cW^-_{\g,p_+, A_-}
		$$
		via the projection $\pr_\cF: \cF\to \cX_\cF$ given by the natural maps
		\begin{align*}
			\cM(p_-,q) \times \partial_0\cX_{q,p_+, A} & \;\to\;\cX_{q,p_+, A} ,\qquad
			\partial_0\cX^\iota_{p_-,p_+, A}  \;\to\; \cX^\iota_{p_-,p_+, A},           \\
			\partial_0\cX_{p_-,q, A} \times \cM(q,p_+) & \;\to\; \cX_{p_-,q, A}, \qquad
			\partial_0\cX^+_{p_-,\g, A_+} \times  \partial_0\cX^-_{\g,p_+, A_-}  \;\to\;  \cX^+_{p_-,\g, A_+} \times  \cX^-_{\g,p_+, A_-} .
		\end{align*}

		\item
		Each restriction $\kappa_{\alpha}|_{P_\alpha^{-1}(\cF^\infty)}$ for $\alpha=(p_-,p_+,A)\in\cI$ to one of the faces $\cF^\infty\subset\partial_1\cX_\alpha$ is given via the identification $P_\alpha^{-1}(\cF^\infty)\cong \pr_\cF^*\cW_\cF|_{\partial_0\cX_\cF}$ and natural map $\pr_\cF^*: \pr_\cF^*\cW_\cF \to \cW_\cF$ by
		$$
			\kappa_{\alpha}|_{P_\alpha^{-1}(\cF^\infty)} \;=\;
			\begin{cases}
				\kappa_{q,p_+, A} \circ \pr_\cF^*
				 & \qquad\text{for}\;\; \cF=\cM(p_-,q) \times \partial_0\cX_{q,p_+, A} ,                          \\
				\kappa_{p_-,q, A} \circ \pr_\cF^*
				 & \qquad\text{for}\;\; \cF=\partial_0\cX_{p_-,q, A} \times \cM(q,p_+) ,                          \\
				\kappa^\iota_{p_-,p_+, A} \circ \pr_\cF^*
				 & \qquad\text{for}\;\; \cF=\partial_0\cX^\iota_{p_-,p_+, A}  ,                                   \\
				(\kappa^+_{p_-,\g, A_+}\cdot \kappa^-_{\g,p_+, A_-}) \circ \pr_\cF^*
				 & \qquad\text{for}\;\; \cF=\partial_0\cX^+_{p_-,\g, A_+} \times  \partial_0\cX^-_{\g,p_+, A_-} .\end{cases}
		$$
	\end{enumilist}
	For any such choice of $\underline\kappa^\iota=( \kappa^\iota_\alpha )_{\alpha\in\cI}$,
	the resulting maps $PSS_{\underline\kappa^+}, SSP_{\underline\kappa^-}, \iota_{\underline\kappa^\iota}, h_{\underline\kappa}$ in Definitions~\ref{def:PSS}, \ref{def:iota,h} satisfy
	$(-1)^{|p|}\iota_{\underline\kappa^\iota}\la p \ra  =  (-1)^{|p|} SSP_{\underline\kappa^-} \bigl( PSS_{\underline\kappa^+} \la p \ra \bigr)
		+ h_{\underline\kappa} ( \rd \la p \ra ) + \rd ( h_{\underline\kappa} \la p \ra )$,
	where $\rd$ is the Morse differential from \S\ref{sec:Morse}.
	By setting $\iota\la p\ra :=(-1)^{|p|} \iota_{\underline\kappa^\iota}\la p\ra$ as in Lemma~\ref{lem:iota chain},  $PSS\la p\ra :=(-1)^{|p|} PSS_{\underline\kappa^+}\la p\ra$, $SSP:=SSP_{\underline\kappa^-}$, and $h:=h_{\underline\kappa}$ we then obtain a chain homotopy between $\iota$ and $SSP \circ PSS$, that is $\iota - SSP \circ PSS = \rd \circ h + h \circ d$.
\end{lem}

\begin{proof}
	This proof is similar to Lemma~\ref{lem:iota chain}, with more complicated combinatorics of the boundary faces due to the boundary of $\cB_{\rm SFT}$ described in Assumption~\ref{ass:iso}, and presented in different order: We will first make the coherent constructions and then deduce the algebraic consequences.


	\medskip
	\noindent
	{\bf Coherent ep-groupoids and sections:}
	To construct coherent representatives $S_\alpha^{\cdots}: \cX_\alpha^{\cdots} \to \cW_\alpha^{\cdots}$ for $\alpha\in\cI^+\sqcup\cI^-\sqcup\cI^\iota\sqcup\cI$ as claimed in (ii) recall that the fiber product construction in Lemma~\ref{lem:iota,h poly} defines each bundle $\cW_\alpha=\pr_\alpha^*\cW^{\scriptscriptstyle \rm SFT}_A$ for $\alpha=(p_-,p_+,A)\in\cI$ as the pullback of a strong bundle $P_A:\cW^{\scriptscriptstyle \rm SFT}_A\to\cX^{\scriptscriptstyle \rm SFT}_A$ under the natural projection of ep-groupoids
	$$
		\pr_{p_-,p_+,A}\, : \;
		\cX_{p_-,p_+,A} \;=\; \bM(p_-,M) \; \leftsub{\ev^+_0}{\times}_{\ev^+} \; \cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev^-_0} \; \bM(M,p_+) \;\;\longrightarrow\;\;\cX^{\scriptscriptstyle \rm SFT}_A  .
	$$
	Here $\ev_0^\pm: \bM(\ldots) \to \C^\pm\times M, \ul\tau\mapsto (0, \ev(\ul\tau) )$ arise from Morse evaluation \eqref{eval}.
	The ep-groupoid $\cX^{\scriptscriptstyle \rm SFT}_A\subset\Ti\cX^{\scriptscriptstyle \rm SFT}_A$ is a  full subcategory -- determined by the open subset $\cB^{+,-}_{\rm SFT}(A)=(\ov\ev^+)^{-1}(\C^+\times M) \cap (\ov\ev^-)^{-1}(\C^-\times M) \subset\cB_{\rm SFT}(A)$ --
	of an ep-groupoid $\Ti\cX^{\scriptscriptstyle \rm SFT}_A$ from Assumption~\ref{ass:iota,h} that represents $\cB_{\rm SFT}(A)$ and thus contains the compactified SFT neck stretching moduli space $\bM_{\rm SFT}(A)=|(S^{\scriptscriptstyle \rm SFT}_A)^{-1}(0)|$ as zero set of a sc-Fredholm section $S^{\scriptscriptstyle \rm SFT}_A:\Ti\cX^{\scriptscriptstyle\rm SFT}_A\to \Ti\cW^{\scriptscriptstyle \rm SFT}_A$.
	We will work with both groupoids: Multisection perturbations are constructed over $\Ti\cX^{\scriptscriptstyle \rm SFT}_A$ since we need a compact zero set to specify the admissibility that guarantees preservation of compactness under perturbations -- both for $S^{\scriptscriptstyle \rm SFT}_A$ and its fiber product restrictions $S_\alpha$. On the other hand, $|\Ti\cX^{\scriptscriptstyle \rm SFT}_A|=\cB_{\rm SFT}(A)$ has more complicated boundary than $\cB^{+,-}_{\rm SFT}(A)$ -- due to the distribution of marked points into building levels -- and does not support a sc$^\infty$ evaluation map. Thus we discuss coherence only over subgroupoids $\cX^{\scriptscriptstyle \rm SFT}_A\subset\Ti\cX^{\scriptscriptstyle \rm SFT}_A$ with the boundary stratification of $\cB^{+,-}_{\rm SFT}(A)$, and which support sc$^\infty$ functors $\ev^\pm: \cX^{\scriptscriptstyle \rm SFT}_A\to\C^\pm\times M$ representing the evaluation maps \eqref{eq:SFTevalB}.
	Here we may even use subgroupoids $\cX^{\scriptscriptstyle \rm SFT}_A$ representing a smaller open subset $(\ov\ev^+)^{-1}(\D_r^+\times M) \cap (\ov\ev^-)^{-1}(\D_r^-\times M) \subset\cB_{\rm SFT}(A)$ of preimages of the disks $\D_r^\pm:=\{z\in\C^\pm\,|\, |z|<r\}\subset\C^\pm$, which contain the standard marked points $z_0^\pm\cong 0\in\C^\pm$.\footnote{These disks should not be confused with the closed disks $D_\pm$ in the construction of $\CP^1_R$, as e.g.\ $\D^+\subset \C^+ \cong (D_+\sqcup [-R,0)\times S^1)/\sim_R$ is a precompact subset of the first hemisphere in $\CP^1_R\cong \C^+\cup S^1 \cup \C^-$ for any $R\geq0$.}
	The polyfold structure on the fiber products $\cX_\alpha$ in Lemma~\ref{lem:iota,h poly} is independent of the choice of open neighbourhood in $\cB_{\rm SFT}(A)$ of the subset satisfying the fiber product condition.
	After obtaining the subgroupoid $\cX^{\scriptscriptstyle \rm SFT}_A\subset\Ti\cX^{\scriptscriptstyle \rm SFT}_A$ from such an open subset, we obtain the bundle $\cW^{\scriptscriptstyle \rm SFT}_A=\Ti \cW^{\scriptscriptstyle \rm SFT}_A|_{\cX^{\scriptscriptstyle \rm SFT}_A}$ and section $S^{\scriptscriptstyle \rm SFT}_A|_{\cX^{\scriptscriptstyle \rm SFT}_A}:\cX^{\scriptscriptstyle \rm SFT}_A\to \cW^{\scriptscriptstyle \rm SFT}_A$ by restriction.
	Finally, each section $S_\alpha= S^{\scriptscriptstyle \rm SFT}_A\circ \pr_\alpha$ is induced by the above projection $\pr_\alpha:\cX_\alpha\to \cX^{\scriptscriptstyle \rm SFT}_A\subset \Ti\cX^{\scriptscriptstyle \rm SFT}_A$.

	Next, restriction to the boundary faces given in Assumption~\ref{ass:iso}~(i) induces representatives $S^{\scriptscriptstyle \rm GW}_A : \Ti \cX^{\scriptscriptstyle \rm GW}_A\to \Ti \cW^{\scriptscriptstyle \rm GW}_A$ resp.\ $S^\pm_{\g,A_\pm}: \Ti \cX^\pm_{\g,A_\pm}\to \Ti \cW^\pm_{\g,A_\pm}$ of the sections $\s_{\rm GW}: \cB_{\rm GW}(A)\to \cE_{\rm GW}(A)$ resp.\ $\s_{\rm SFT}: \cB^\pm_{\rm SFT}(\g; A_{\pm})\to \cE^\pm_{\rm SFT}(\g;A_{\pm})$ from Assumption~\ref{ass:pss} resp.\ \ref{ass:iota,h}.
	Moreover, the boundary of the open subset $(\ov\ev^+\times \ov\ev^-)^{-1}(\D_r^+\times M \times \D_r^-\times M)$ for $0<r\leq \infty$ (with $\D^\pm_\infty:=\C^\pm$) yields subgroupoids $\cX^{\scriptscriptstyle \rm GW}_A \subset \Ti \cX^{\scriptscriptstyle \rm GW}_A$ representing $(\ov\ev^+\times \ov\ev^-)^{-1}(\D_r^+\times M \times \D_r^-\times M)\subset \cB_{\rm GW}(A)$ resp.\ $\cX^\pm_{\g,A_\pm}\subset\Ti \cX^\pm_{\g,A_\pm}$
	representing $(\ov\ev^\pm)^{-1}(\D_r^\pm\times M)\subset \cB^\pm_{\rm SFT}(A)$, along with restricted sections $S^{\scriptscriptstyle \rm GW}_A:\cX^{\scriptscriptstyle \rm GW}_A\to \cW^{\scriptscriptstyle \rm GW}_A=\Ti\cW^{\scriptscriptstyle \rm GW}_A|_{\cX^{\scriptscriptstyle \rm GW}_A}$ resp.\ $S^\pm_{\g,A_\pm}: \cX^\pm_{\g,A_\pm}\to \cW^\pm_{\g,A_\pm}=\Ti \cW^\pm_{\g,A_\pm}|_{\cX^\pm_{\g,A_\pm}}$.
	Then the evaluation maps restrict to sc$^\infty$ functors $\ev^\pm: \cX^{\scriptscriptstyle \rm GW}_A\to\D_r^\pm\times M$ resp.\ $\ev^\pm: \cX^\pm_{\g,A}\to\D_r^\pm\times M$, which yield -- again independent of $r>0$ -- the fiber product construction of $\cB^\pm(\alpha)$ in Lemma~\ref{lem:PSS poly}, and of $\cB^\iota(\alpha)$ in Lemma~\ref{lem:iota,h poly}.


	Now the identification of the top boundary strata $\partial_1\cX^\infty_{p_-,p_+,A}$ will proceed similar to the proof of Lemma~\ref{lem:iota boundary} with $\cB_{\rm GW}(A)$ replaced by $\cB^{+,-}_{\rm SFT}(A)$, apart from the fact that the SFT polyfold has boundary.
	This boundary is identified in Assumption~\ref{ass:iso}~(ii) as
	\begin{equation}\label{eq:SFTfaces} \textstyle
		\partial_1\cX^{\scriptscriptstyle \rm SFT}_A \;\cong\; \cX^{\scriptscriptstyle \rm GW}_A  \;\; \sqcup \;\;
		\bigsqcup_{\begin{smallmatrix}
				\scriptscriptstyle \g \in \cP(H)\\
				\scriptscriptstyle A_- + A_+ = A\\
			\end{smallmatrix}} \partial_0\cX^+_{\g,A_+} \times \partial_0\cX^-_{\g, A_-} .
	\end{equation}
	By the fiber product construction \cite[Cor.7.3]{Ben-fiber} of $\cB(p_-,p_+;A)$ in Lemma~\ref{lem:iota,h poly}, the degeneracy index satisfies $d_{\cB(p_-,p_+;A)}(\ul{\t}_-,\ul{u},\ul{t}_+) = d_{\overline{\cM}(p_-,M)}(\ul{\t}_-) + d_{\cB_{\rm SFT}(A}(\ul{u}) + d_{\overline{\cM}(M,p_+)}(\ul{\t}_+)$. Hence we have $d_{\cB(p_-,p_+;A)}(\ul{\t}_-,\ul{u},\ul{\t}_+) = 1$ if and only if the degeneracy index of exactly one of the three arguments $\ul{\t}_-,\ul{u},\ul{\t}_+$ is $1$ and the other two are $0$. This identifies $|\partial_1\cX_{p_-,p_+,A}|=\partial_1\cB(p_-,p_+; A)$ as in the first line of the displayed equation below.
	Then the subsequent identifications result by comparing the resulting expressions with the interiors in Lemma~\ref{lem:PSS poly}, \ref{lem:iota,h poly}. We obtain an identification that throughout is to be interpreted on the smooth level (as fiber product constructions drop some non-smooth points)
	\begin{align*}
		 & \partial_1\cX_{p_-,p_+, A} \;\cong\;  \phantom{\sqcup\;\;}
		\partial_0\bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \partial_1\cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \partial_0\bM(M,p_+) \\
		 & \phantom{\partial_1\cX^{\scriptscriptstyle \rm SFT}_{p_-,p_+, A} \;\cong\; } \sqcup\;\;
		\partial_1\bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \partial_0\cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \partial_0\bM(M,p_+)
		\\
		 & \phantom{\partial_1\cX_{p_-,p_+, A} \;\cong\; } \sqcup\;\;
		\partial_0\bM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \partial_0\cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \partial_1\bM(M,p_+) \\
		 & \quad\;=\;
		\cM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \cX^{\scriptscriptstyle \rm GW}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \cM(M,p_+)                                \\
		 & \quad\qquad\sqcup\;\; \textstyle\bigcup_{\begin{smallmatrix}
				                                            \scriptscriptstyle \g \in \cP(H)\\
				                                            \scriptscriptstyle A_- + A_+ = A\\
			                                            \end{smallmatrix}} \hspace{-2mm}
		\cM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \;  \partial_0\cX^+_{\g,A_+} \times \partial_0\cX^-_{\g,A_-} \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \cM(M,p_+)        \\
		 & \quad\qquad \sqcup\;\;
		\textstyle\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \cM(q,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \partial_0\cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \partial_0\bM(M,p_+)
		\\
		 & \quad\qquad\sqcup\;\; \textstyle\bigcup_{q\in{\rm Crit}(f)}
		\cM(p_-,M) \; \leftsub{\ev_0^+}{\times}_{\ev^+} \; \partial_0\cX^{\scriptscriptstyle \rm SFT}_A \; \leftsub{\ev^-}{\times}_{\ev_0^-} \; \cM(M,q) \times\cM(q,p_+)      \\
		 & \quad\;=\;
		\partial_0\cX^\iota_{p_-,p_+,A}
		\;\;\sqcup\;\; \textstyle\bigcup_{\begin{smallmatrix}
				                                  \scriptscriptstyle \g \in \cP(H)\\
				                                  \scriptscriptstyle A_- + A_+ = A\\
			                                  \end{smallmatrix}}
		\partial_0\cX^+_{p_-,\g,A_+} \times \partial_0\cX^-_{\g,p_+, A_-}                                                                                                      \\
		 & \quad\qquad\sqcup\;\;
		\textstyle\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times \partial_0\cX_{q,p_+, A}
		\quad
		\sqcup\;\;  \textstyle\bigcup_{q\in{\rm Crit}(f)} \partial_0\cX_{p_-,q, A} \times \cM(q,p_+).
	\end{align*}
	Here we also used the identification of evaluation maps in Assumption~\ref{ass:iso}~(iii)(a).
	Then compatibility in (ii) of the oriented section functors $S_\alpha^{\cdots}$ with the identification of these (smooth levels of) faces $\cF^\infty\subset\partial_1\cX^\infty_{p_-,p_+,A}$ follows from compatibility of $\pr_{p_-,p_+,A}: \cX_{p_-,p_+,A}\to \cX^{\scriptscriptstyle \rm SFT}_A$ with the projections $\pr^\pm_\alpha: \cX^\pm_\alpha \to \cX^\pm_{\gamma,A_\pm}$ for $\alpha\in\cI^\pm$ used in Lemma~\ref{lem:PSS poly} and $\pr^\iota_\alpha: \cX^\iota_\alpha \to \cX^{\scriptscriptstyle \rm GW}_A$ used in Lemma~\ref{lem:iota,h poly}. More precisely, $S_{p_-,p_+,A}|_{\cF^\infty}=\pr_\cF^*S_\cF$ follows from compatibility of the sections in Assumption~\ref{ass:iso}~(iii) and
	$$
		\pr_{p_-,p_+,A}|_{\cF^\infty} \;=\;
		\begin{cases}
			\pr^\iota_{p_-,p_+, A} \circ \pr_\cF
			 & \qquad\text{for}\;\; \cF=\partial_0\cX^\iota_{p_-,p_+, A}  ,                                   \\
			(\pr^+_{p_-,\g, A_-}\times \pr^-_{\g,p_+, A_+}) \circ \pr_\cF
			 & \qquad\text{for}\;\; \cF=\partial_0\cX^+_{p_-,\g, A_+} \times  \partial_0\cX^-_{\g,p_+, A_-} , \\
			\pr_{q,p_+, A} \circ \pr_\cF
			 & \qquad\text{for}\;\; \cF=\cM(p_-,q) \times \partial_0\cX_{q,p_+, A} ,                          \\
			\pr_{p_-,q, A} \circ \pr_\cF
			 & \qquad\text{for}\;\; \cF=\partial_0\cX_{p_-,q, A} \times \cM(q,p_+) .
		\end{cases}
	$$


	\medskip
	\noindent
	{\bf Construction of coherent perturbations:}
	Next, we construct admissible sc$^+$-multisections $\kappa_{\alpha}^{\cdots}:\cW_{\alpha}^{\cdots}\to\Q^+$ for $\alpha\in\cI^+\cup\cI^-\cup\cI^\iota\cup\cI$ as claimed in (i), i.e.\ in general position to the respective sections $S_{\alpha}^{\cdots}:\cX_{\alpha}^{\cdots}\to:\cW_{\alpha}^{\cdots}$, while also coherent as claimed in (iii).
	The existence of such coherent transverse perturbations will ultimately be guaranteed by an abstract perturbation theorem for coherent systems of sc-Fredholm sections. Since the SFT perturbation package \cite[\S 14]{fh-sft} has not yet been described for neck stretching,
	we give a detailed construction of the perturbations for our purposes.
	We proceed as in Lemma~\ref{lem:iota chain} and construct them all as pullbacks
	$\kappa^{\cdots}_\alpha:= \lambda^{\cdots}_A \circ (\pr^{\cdots}_\alpha)^*$ of a collection of sc$^+$-multisections on the SFT resp.\ Gromov-Witten polyfold bundles -- without Morse trajectories --
	$$
		\ul\lambda \;=\; \left(  \;\;
		\begin{aligned}
				 & \bigl( \lambda^+_{\g,A} : \Ti\cW^+_{\g,A}\to\Q^+ \bigr)_{\g\in\cP(H),A\in H_2(M)} \qquad
				 &                                                                                          & \bigl( \lambda^{\scriptscriptstyle \rm GW}_A : \Ti\cW^{\scriptscriptstyle \rm GW}_A\to\Q^+ \bigr)_{A\in H_2(M)}   \\
				 & \bigl( \lambda^-_{\g,A} : \Ti\cW^-_{\g,A}\to\Q^+ \bigr)_{\g\in\cP(H),A\in H_2(M)} \qquad
				 &                                                                                          & \bigl( \lambda^{\scriptscriptstyle \rm SFT}_A : \Ti\cW^{\scriptscriptstyle \rm SFT}_A\to\Q^+ \bigr)_{A\in H_2(M)}
			\end{aligned}
		\;\;
		\right).
	$$
	For this to induce a coherent collection of sc$^+$-multisections as required in (iii),
	\begin{align*}
		 & \bigl( \kappa^+_{p,\g,A}:=\lambda^+_{\g,A} \circ (\pr^+_{p,\g,A})^*  \bigr)_{(p,\g,A)\in\cI^+}, \qquad
		 &                                                                                                        & \bigl( \kappa^\iota_{p_-,p_+,A}:=\lambda^{\scriptscriptstyle\rm GW}_{A} \circ (\pr^\iota_{p_-,p_+,A})^*  \bigr)_{(p_-,p_+,A)\in\cI^\iota} , \\
		 & \bigl( \kappa^-_{\g,p,A}:=\lambda^-_{\g,A} \circ (\pr^-_{\g,p,A})^*  \bigr)_{(\g,p,A)\in\cI^-}, \qquad
		 &                                                                                                        & \bigl( \kappa_{p_-,p_+,A}:=\lambda^{\scriptscriptstyle\rm SFT}_{A} \circ (\pr_{p_-,p_+,A})^*  \bigr)_{(p_-,p_+,A)\in\cI},
	\end{align*}
	it suffices to pick $\ul\lambda$ compatible with respect to the faces of the SFT neck stretching polyfolds $\cX^{\scriptscriptstyle\rm SFT}_{A}$ in \eqref{eq:SFTfaces}. More precisely, using the natural identifications of bundles from Assumption~\ref{ass:iso}~(iii), we will construct $\ul\l$ coherent in the sense that -- for some choice of $r>0$ in the construction of
	$|\cX^\pm_{\g,A}| = (\ov\ev^\pm)^{-1}(\D_r^\pm\times M)\subset \cB^\pm_{\rm SFT}(\g;A)$ and $\cW^\pm_{\g,A}=\Ti\cW^\pm_{\g,A}|_{\cX^\pm_{\g,A}}$ -- we have
	\begin{align} \label{eq:coherent1}
		\lambda^{\scriptscriptstyle \rm SFT}_A(w)                           & \;=\; \lambda^{\scriptscriptstyle \rm GW}_A(w)
		\quad                                                               &                                                              & \forall \;
		w\in \Ti\cW^{\scriptscriptstyle \rm GW}_A ,                                                                                                     \\
		\lambda^{\scriptscriptstyle \rm SFT}_A ( (l_{\g,A_\pm})_*(w^+,w^-)) & \;=\;  \lambda^+_{\g,A_+}(w^+) \cdot \lambda^-_{\g,A_-}(w^-)
		\quad                                                               &                                                              & \forall \;
		(w^+,w^-) \in \cW^+_{\g, A_+} \times \cW^-_{\g, A_-},
		\label{eq:coherent2}
	\end{align}
	where $l_{\g,A_\pm}$ is the map defined in Assumption~\ref{ass:iso}(i).
	So to finish this proof it remains to choose the sc$^+$-multisections $\ul\lambda$ so that each induced sc$^+$-multisection in the induced coherent collection for $(\kappa^{\cdots}_\alpha)_{\alpha\in\cI^+\cup\cI^-\cup\cI^\iota\cup\cI}$ is admissible and in general position, while also satisfying the coherence requirements \eqref{eq:coherent1}, \eqref{eq:coherent2} and the
	requirements on $\ul\kappa^\iota$ in the proofs of Lemma~\ref{lem:iota chain} and \ref{lem:iota triangular}.
	The construction of coherent perturbations for the SFT polyfolds analogously to \cite[\S 14]{fh-sft} proceeds by first choosing coherent compactness controlling data, i.e.\ pairs $(N,\cU)$
	of auxiliary norms on all the bundles and saturated neighbourhoods of the compact zero sets in all the ep-groupoids $\Ti\cX^\pm_{\g,A} , \Ti\cX^{\scriptscriptstyle\rm GW}_A, \Ti\cX^{\scriptscriptstyle\rm SFT}_A$  (c.f.\ Definition~\ref{def:control}), which are compatible with the immersions to boundary faces in \eqref{eq:SFTfaces}.
	Then it constructs the perturbations $\l^{\scriptscriptstyle\rm GW}_A$ as in Lemma~\ref{lem:iota triangular} and also $\l^\pm_{\g,A_\pm}$ to be in general position, admissible w.r.t.\ the coherent data $(2 N, \cU)$, and coherent in the sense that continuous extension of \eqref{eq:coherent1}--\eqref{eq:coherent2} induces a well defined multisection ${\lambda^\partial_A: \Ti\cW^{\scriptscriptstyle\rm SFT}_A|_{\partial\cX^{\scriptscriptstyle\rm SFT}_A}\to \Q^+}$.
	Here coherence of the perturbations on the intersection of faces (see Remark~\ref{rmk:face}) is required to guarantee existence of scale-smooth extensions of $\lambda^\partial_A$ to multisections $\lambda^{\scriptscriptstyle\rm SFT}_A: \Ti\cW^{\scriptscriptstyle\rm SFT}_A\to \Q^+$.
	Coherence of the compactness controlling pairs guarantees that the multisection $\lambda^\partial_A$ over $\partial\cX^{\scriptscriptstyle\rm SFT}_A\subset \Ti\cX^{\scriptscriptstyle\rm SFT}_A$ satisfies the auxiliary norm bounds  $N(\lambda^\partial_A)\leq\frac 12$
	and support requirements that guarantee compactness for extensions $\lambda^{\scriptscriptstyle\rm SFT}_A$ of $\lambda^\partial_A$ with $N(\lambda^{\scriptscriptstyle\rm SFT}_A)\leq 1$ and appropriate support requirements.
	Moreover, we may choose each of the extensions $\lambda^{\scriptscriptstyle\rm SFT}_A$ using Theorem~\ref{thm:transversality} to ensure -- as in Lemma~\ref{lem:iota chain} -- that the induced multisections $\kappa^{\cdots}_\alpha$ are in general position as well. The latter will automatically be admissible with respect to pullback of the pair controlling compactness.
	In more detail (but without specifying the auxiliary norm bounds) the inductive construction of perturbations in \cite{fh-sft-full} -- simplified to the subset of SFT moduli spaces considered here -- proceeds as follows:



	\medskip\noindent{\bf Construction of $\boldsymbol{\lambda^{\scriptscriptstyle\rm GW}_A}$ and $\boldsymbol{\underline\kappa^\iota}$:}
	Since the Gromov-Witten ep-groupoids $\Ti\cX_A^{\scriptscriptstyle\rm GW}$ are boundaryless by Assumption~\ref{ass:iota,h}~(iii), the sc$^+$-multisections $\l^{\scriptscriptstyle\rm GW}_A$ can be chosen independently of all other multisections.
	So we construct $\l^{\scriptscriptstyle\rm GW}_A$ as in the proofs of Lemma~\ref{lem:iota chain} and \ref{lem:iota triangular}, to ensure that the conclusions in these lemmas hold, as required by (i).
	This prescribes \eqref{eq:coherent1} on the boundary face $\Ti\cX^{\scriptscriptstyle\rm GW}_A\subset \partial \Ti\cX^{\scriptscriptstyle\rm SFT}_A$.

	Moreover, recall that $\l^{\scriptscriptstyle\rm GW}_A$ is obtained by applying Theorem~\ref{thm:transversality} to the sc-Fredholm section functors $S_A^{\scriptscriptstyle\rm GW}$,
	the sc$^\infty$ submersion $\ov\ev^+ \times \ov\ev^- : \Ti\cX^{\scriptscriptstyle\rm GW}_A \rightarrow \CP^1\times M \times \CP^1\times M$, and the collection of Cartesian products of stable and unstable manifolds $\{z_0^+\}\times W_{p_-}^- \times \{z_0^-\}\times W_{p_+}^+$.
	As in the proof of Lemma~\ref{lem:iota chain} this ensures that the pullbacks $\ul\k^\i =(\k_{\alpha}^{\i}=\lambda^{\scriptscriptstyle\rm GW}_{A} \circ (\pr^\iota_\alpha)^*)_{\alpha \in \cI^{\i}}$ are in general position. Moreover, these pullbacks are admissible w.r.t.\ the pairs controlling compactness on $\cW^{\i}_{\alpha} \rightarrow \cX^{\i}_{\alpha}$ that result by pullback from the coherent compactness controlling pair on $\Ti\cW^{\scriptscriptstyle\rm GW}_A \rightarrow\Ti\cX^{\scriptscriptstyle\rm GW}_A$, which is constructed in a preliminary step as in \cite[\S 13]{fh-sft}.


	\medskip\noindent{\bf Coherence for $\boldsymbol{\lambda^\pm_{\gamma,A}}$:}
	The next step is to construct sc$^+$-multisections $\lambda^\pm_{\gamma,A}:\Ti\cW^\pm_{\g, A}\to\Q^+$ over the SFT ep-groupoids $\Ti\cX^\pm_{\g,A}$ of planes with limit orbit $\g\in\cP(H)$ from Assumption~\ref{ass:pss}, which then induce the perturbations $\underline\kappa^\pm$ for the $PSS/SSP$ moduli spaces. These constructions are independent of the choice of $\l^{\scriptscriptstyle\rm GW}_A$ since the corresponding boundary faces of $\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ do not intersect by Assumption~\ref{ass:iso}~(ii). However, to enable the subsequent construction of $\lambda^{\scriptscriptstyle\rm SFT}_A$ as extension of the boundary values prescribed in \eqref{eq:coherent1} and \eqref{eq:coherent2}, we need to make sure that each sc$^+$-multisection $(\lambda^+_{\gamma,A_+}\cdot \lambda^-_{\gamma,A_-})\circ (l_{\g,A_\pm})^{-1}_*$
	is well defined on the (open subset of) face $\cF_{\g,A_\pm}:= l_{\g,A_\pm}(\cX^+_{\g,A_+}\times \cX^-_{\g,A_-})\subset\partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ and
	coincides with the other sc$^+$-multisections $(\lambda^+_{\gamma',A'_+}\cdot \lambda^-_{\gamma',A'_-})\circ (l_{\g',A'_\pm})^{-1}_*$ on their intersection
	$\cF_{\g,A_\pm}\cap \cF_{\g',A'_\pm}$.
	Then this yields a well defined sc$^+$-multisection on $\bigcup \cF_{\g,A_\pm} = \partial \cX^{\scriptscriptstyle\rm SFT}_A\subset\partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$.
	To describe these intersections we note that \cite{fh-sft} constructs the ep-groupoids $\Ti\cX^\pm_{\g,A_\pm}$ with coherent boundaries -- involving ep-groupoids
	$(\cX^{\scriptscriptstyle\rm Fl}_{\g^-,\g^+,B})_{\g^\pm\in\cP(H),B\in H_2(M)}$ which contain the moduli spaces of Floer trajectories between periodic orbits $\g^\pm$, as well as further ep-groupoids for Floer trajectories carrying a marked point.
	We will avoid dealing with the latter by specifying values $r<\infty$ when pulling back perturbations from the ep-groupoids $\cX^\pm_{\g,A}\subset\Ti\cX^\pm_{\g,A}$ given by $|\cX^\pm_{\g,A}| = (\ov\ev^\pm)^{-1}(\D_r^\pm\times M)\subset \cB^\pm_{\rm SFT}(\g;A)$, as this will prevent the appearance of marked Floer trajectories even in the closure.
	For any fixed value $0<r\leq \infty$, the $j$-th boundary stratum is given by $j$ Floer trajectories breaking off,
	\begin{align} \label{eq:Xpmbdy}
		\partial_j \cX^+_{\g,A}     & \;= \textstyle\bigsqcup_{\begin{smallmatrix}
				                                                       \scriptscriptstyle \g^0,\ldots,\g^j=\g \in \cP(H)\\
				                                                       \scriptscriptstyle A_+ + B_1+\ldots + B_j = A
			                                                       \end{smallmatrix}}
		\partial_0\cX^+_{\g^0,A_+} \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1} \times \ldots \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^{j-1},\g^j,B_j} , \\
		\partial_{k-j} \cX^-_{\g,A} & \;= \textstyle\bigsqcup_{\begin{smallmatrix}
				                                                       \scriptscriptstyle \g=\g^j,\ldots,\g^k \in \cP(H)\\
				                                                       \nonumber
				                                                       \scriptscriptstyle B_{j+1}+\ldots+B_k + A_- = A
			                                                       \end{smallmatrix}}
		\partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^j,\g^{j+1},B_{j+1}} \times \ldots \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k} \times
		\partial_0\cX^-_{\g^k,A_-} .
	\end{align}
	Now, for example,
	$\partial_0 \cX^+_{\g^0,A_+}\times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B}
		\times\partial_0 \cX^-_{\g^1,A_-}$ is both a subset of
	$\partial_0 \cX^+_{\g^0,A_+} \times\partial_1 \cX^-_{\g^0,A_-+B} \subset \partial \bigl(\cX^+_{\g^0,A_+} \times \cX^-_{\g^0,A_-+B} \bigr)$
	and of $\partial_1 \cX^+_{\g^1,A_++B} \times\partial_0 \cX^-_{\g^1,A_-}\subset \partial \bigl(\cX^+_{\g^1,A_++B} \times \cX^-_{\g^1,A_-} \bigr)$, and the embeddings $l_{\g^0,A^0_\pm}$ and $\l_{\g^1,A^1_\pm}$ for the two splittings
	$A_+ + (A_-+B) = A^0_++A^0_- =A=A^1_++A^1_- =(A_++B)+A_-$ coincide under this identification.
	Generally, the boundary of the Floer ep-groupoids is given by broken trajectories, and this yields a disjoint cover of $\partial^{R=\infty}\cX^{\scriptscriptstyle\rm SFT}_A \subset \partial \cX^{\scriptscriptstyle\rm SFT}_A$,
	\begin{align*}
		\partial^{R=\infty}\cX^{\scriptscriptstyle\rm SFT}_A
		\;=\; \hspace{-2mm}\bigsqcup_{\begin{smallmatrix}
				                              \scriptscriptstyle \g^0,\ldots,\g^k \in \cP(H)\\
				                              \scriptscriptstyle A_+ + B_1 + \ldots + B_k + A_- = A
			                              \end{smallmatrix}} \hspace{-2mm}
		l_{\ul\g, A_\pm, \ul B}\bigl(
		\partial_0 \cX^+_{\g^0,A_+}\times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\times \ldots \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}
		\times
		\partial_0 \cX^-_{\g^k,A_-} \bigr) ,
	\end{align*}
	in which the embeddings $l_{\ul\g, A_\pm, \ul B}$ coincide with each of the embeddings
	$l_{\g^j,A^j_\pm}$ for $0\leq j\leq k$ and $A^j_+=A_++\sum_{i\leq j} B_i$, $A^j_-=A_- +\sum_{i>j} B_i$ -- when restricted to the subsets
	$$
		\partial_0 \cX^+_{\g^0,A_+}\times
		\partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\times \ldots \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}
		\times
		\partial_0 \cX^-_{\g^k,A_-}
		\;\subset\;
		\partial_j \cX^+_{\g^j,A^j_+}\times \partial_{k-j} \cX^-_{\g^j,A^j_-} .
	$$
	Now on these subsets we require coherence
	$\lambda^+_{\g^j,A^j_+} \cdot \lambda^-_{\g^j,A^j_-} = \lambda^+_{\g^{j'},A^{j'}_+} \cdot \lambda^-_{\g^{j'},A^{j'}_-}$ for all $0\leq j\neq j' \leq k$, as this is equivalent to \eqref{eq:coherent2} being well defined on $\im l_{\ul\g, A_\pm, \ul B} = \bigcap_{j=0}^k \cF_{\g^j,A^j_\pm}$.
	This will be achieved by constructing the sc$^+$-multisections $(\lambda^\pm_{\g,A_\pm})$ to have product structure on the boundary --
	where the bundles $P_{\g,A}:\cW^\pm_{\g,A}\to \cX^\pm_{\g,A}$ are restricted to various faces of $\partial\cX^\pm_{\g,A}$ --
	\begin{align} \label{eq:lambdapm}
		\lambda^+_{\g^j,A^j_+}\big|_{P_{\g^j,A^j_+}^{-1}\bigl(
		\cX^+_{\g^0,A_+}\times
		\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\times \ldots \times \cX^{\scriptscriptstyle\rm Fl}_{\g^{j-1},\g^j,B_j}
		\bigr)}
		 & =\;
		\lambda^+_{\g^0,A_+}\cdot
		\lambda^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\cdot \ldots \cdot \lambda^{\scriptscriptstyle\rm Fl}_{\g^{j-1},\g^j,B_j} , \\
		\nonumber
		\lambda^-_{\g^j,A^j_-}\big|_{
		P_{\g^j,A^j_-}^{-1}\bigl(
		\cX^{\scriptscriptstyle\rm Fl}_{\g^j,\g^{j+1},B_{j+1}}
		\times \ldots \times \cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}
		\times
		\cX^-_{\g^k,A_-}
		\bigr)}
		 & =\;
		\lambda^{\scriptscriptstyle\rm Fl}_{\g^j,\g^{j+1},B_{j+1}} \cdot
		\ldots \cdot\lambda^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}
		\cdot
		\lambda^-_{\g^k,A_-},
	\end{align}
	for a collection of sc$^+$-multisections $\lambda^{\scriptscriptstyle\rm Fl}_{\g^-,\g^+,B}: \cW^{\scriptscriptstyle \rm Fl}_{\g^-,\g^+,B} \to \Q$ over the Floer ep-groupoids $\cX^{\scriptscriptstyle\rm Fl}_{\g^-,\g^+,B}$.
	While this guarantees coherence on each overlap of embeddings $\im l_{\ul\g, A_\pm, \ul B} \subset \cF_{\g^j,A^j_\pm} \cap\cF_{\g^{j'},A^{j'}_\pm}$,
	$$
		\lambda^+_{\g^j,A^j_+} \cdot \lambda^-_{\g^j,A^j_-}
		\;=\;
		\lambda^+_{\g^0,A_+}\cdot
		\lambda^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\cdot \ldots \cdot \lambda^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_j}
		\cdot
		\lambda^-_{\g^k,A_-}
		\;=\; \lambda^+_{\g^{j'},A^{j'}_+} \cdot \lambda^-_{\g^{j'},A^{j'}_-} ,
	$$
	we are now faced with the challenge of satisfying the coherence conditions in \eqref{eq:lambdapm}.
	These conditions uniquely determine the boundary restrictions
	$\lambda^\pm_{\g,A_\pm}\big|_{P_{\g,A_\pm}^{-1}(\partial\cX^\pm_{\g,A_\pm})}$
	via the identification of the boundaries with Cartesian products of interiors in \eqref{eq:Xpmbdy}.
	Thus \eqref{eq:Xpmbdy} on Cartesian products involving boundary strata poses coherence conditions on the choice of $\lambda^{\scriptscriptstyle\rm Fl}_\beta$ for $\beta\in\cI^{\scriptscriptstyle\rm Fl}:= \cP(H)\times\cP(H)\times H_2(M)$.


	\medskip\noindent{\bf Construction of $\boldsymbol{\lambda^{\scriptscriptstyle\rm Fl}_{\gamma^-,\gamma^+,B}}$:}
	To achieve the coherence in \eqref{eq:lambdapm}, \cite{fh-sft-full} first constructs the sc$^+$-multisections $(\lambda^{\scriptscriptstyle\rm Fl}_\beta)_{\beta\in\cI^{\scriptscriptstyle\rm Fl}}$ by iteration over the maximal degeneracy $k_\beta:=\max\{k\in\N_0\,|\, (S^{\scriptscriptstyle\rm Fl}_\beta)^{-1}(0) \cap \partial_k \cX^{\scriptscriptstyle\rm Fl}_\beta \neq \emptyset\}$
	of unperturbed solutions (which is finite by Gromov compactness):
	We first consider classes $\beta$ with $k_\beta=-\infty$. For these,
	the section $S^{\scriptscriptstyle\rm Fl}_\beta$ has no zeros so is already transverse, so that $\lambda^{\scriptscriptstyle\rm Fl}_\beta$ can be chosen as the trivial perturbation. (The trivial multivalued section functor $\l:\cW\to\Q^+$ is given by $\l(0)=1$ and ${\l(w\neq 0)=0}$.)
	Next, we consider $\beta$ with $k_\beta=0$. For these,
	the section $S^{\scriptscriptstyle\rm Fl}_\beta$ has all zeros in the interior, so that $\lambda^{\scriptscriptstyle\rm Fl}_\beta$ can be chosen admissible and trivial on the boundary -- by applying Corollary~\ref{cor:regularize}~(i) with a neighbourhood of the unperturbed zero set in the interior, $|(S^{\scriptscriptstyle\rm Fl}_\beta)^{-1}(0)|\subset \cV_\beta \subset |\partial_0\cX^{\scriptscriptstyle\rm Fl}_\beta|$.
	Once the iteration has constructed $\lambda^{\scriptscriptstyle\rm Fl}_\beta$ for all $\beta$ with $k_\beta \leq n$ for some $n\in\N_0$, we proceed to consider
	$\beta=(\g^-,\g^+,B)\in\cI^{\scriptscriptstyle\rm Fl}$ with
	$k_\beta= n+1$.
	For these,
	the restriction $\lambda^{\scriptscriptstyle\rm Fl}_\beta|_{P_\beta^{-1}(\partial\cX^{\scriptscriptstyle\rm Fl}_\beta)}$ to the boundary $\partial\cX^{\scriptscriptstyle\rm Fl}_\beta = \bigcup_{\g^-=\g^0,\g^1,\ldots,\g^{k-1},\g^k=\g^+,B=B_1+\ldots+B_k} \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\times \ldots \times \partial_0\cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}$
	is prescribed by the previous iteration steps
	$\lambda^{\scriptscriptstyle\rm Fl}_\beta\big|_{P_\beta^{-1}(\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\ldots \times \cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k})} :=
		\lambda^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}
		\ldots \cdot \lambda^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}$
	on all boundary faces that contain unperturbed solutions in their closure. Indeed, existence of a solution in $\cX^{\scriptscriptstyle\rm Fl}_{\g^0,\g^1,B_1}\times \ldots \times\cX^{\scriptscriptstyle\rm Fl}_{\g^{k-1},\g^k,B_k}$ implies $k_{\g^{i-1},\g^i,B_i}\geq 0$ for $i=1,\ldots,k$, and the Cartesian product of solutions of maximal degeneracy yields $1 + k_{\g^0,\g^1,B_1} + \ldots + k_{\g^{k-1},\g^k,B_k} \leq k_\beta$. Thus these prescriptions are made for $0\leq k_{\g^{i-1},\g^i,B_i} \leq k_\beta - 1
		=n$, and
	on boundary faces with no solutions in their closure we prescribe the trivial perturbation throughout.

	This yields a well defined sc$^+$-multisection $\lambda^{\scriptscriptstyle\rm Fl}_\beta|_{P_\beta^{-1}(\partial\cX^{\scriptscriptstyle\rm Fl}_\beta)}$ by coherence in the prior iteration steps, so that $\lambda^{\scriptscriptstyle\rm Fl}_\beta$ can be constructed by applying the extension result \cite[Thm.15.5]{HWZbook} which provides general position and admissibility with respect to a pair controlling compactness that extends the pair which was chosen on the boundary in prior iteration steps.

	\medskip\noindent{\bf Construction of $\boldsymbol{\lambda^\pm_{\gamma,A}}$ and $\boldsymbol{\underline\kappa^\pm}$:}
	With the Floer perturbations in place, \cite{fh-sft-full} next constructs the collections of sc$^+$-multisections $(\lambda^\pm_{\gamma,A})_{\g\in\cP(H),A\in H_2(M)}$ to satisfy \eqref{eq:lambdapm} by iteration over degeneracy $k_{\gamma,A}:=\max\{k\in\N_0\,|\, (S^\pm_{\gamma,A})^{-1}(0) \cap \partial_k \Ti\cX^\pm_{\gamma,A} \neq \emptyset\}$. For $k_{\gamma,A}=-\infty$ one takes $\lambda^\pm_{\gamma,A}$ to be trivial. For $k_{\gamma,A}=0$ one applies Theorem~\ref{thm:transversality} to the sc-Fredholm section functor $S_{\g,A}^\pm:\Ti\cX_{\g,A}^\pm\to\Ti\cW_{\g,A}^\pm$, the map $\ov\ev^\pm : \Ti\cX^\pm_{\g,A} \to \ov{\C^\pm}\times M$, and the collection of stable resp.\ unstable manifolds $\{0\}\times W_p^\pm$ for all critical points $p \in \Crit(f)$. These satisfy the assumptions as the zero set $|(S_{\g,A}^\pm)^{-1}(0)|$ is compact and the preimages $(\ov\ev^\pm)^{-1}(\{0\}\times W_p^\pm)$ lie within the open subset $\cX^\pm_{\g,A}\subset\Ti\cX^\pm_{\g,A}$ on which $\ov\ev^\pm$ restricts to a sc$^\infty$ submersion $\ev^\pm : \cX^\pm_{\g,A} \to \C^\pm\times M$.
	We can moreover prescribe $\lambda^\pm_{\gamma,A}|_{P_{\g,A}^{-1}(\partial\Ti\cX^\pm_{\g,A})}$ to be trivial, since in the absence of solutions the trivial perturbation is in general position.
	Then Theorem~\ref{thm:transversality} provides $\lambda^\pm_{\gamma,A}$ that is supported in the interior and transverse to each submanifold $\{0\}\times W_p^\pm$ in the sense that these submanifolds are transverse to the evaluation from the perturbed zero set
	\begin{equation}\label{eq:transev}
		\ev^\pm \,: \;  \bigl| \{x\in \cX^\pm_{\gamma,A} \,|\, \l^\pm_{\gamma,A}(S^\pm_{\gamma,A}(x))>0\} \bigr| \;\to\; \C^\pm\times M .
	\end{equation}
	Now suppose that admissible $\lambda^\pm_{\gamma',A'}$ in general position have been constructed for $k_{\gamma',A'}\leq k\in\N_0$, and satisfy both the transversality in \eqref{eq:transev} and the coherence condition \eqref{eq:lambdapm} over the ep-groupoids $|\cX^\pm_{\g',A'}|=(\ov\ev^\pm)^{-1}(\D^\pm_{r_k}\times M)$ with $r_k:= 2+ 2^{-k}$.
	Then for $k_{\gamma,A}=k+1$ we will construct $\lambda^\pm_{\gamma,A}$ to satisfy \eqref{eq:lambdapm} over $(\ov\ev^\pm)^{-1}(\D^\pm_{r_{k+1}}\times M)$ by first noting that the previous iteration -- and requiring triviality on boundary faces without solutions -- determines a well defined sc$^+$-multisection $\lambda^\pm_{\gamma,A}|_{P_{\g,A}^{-1}(\partial\cX^\pm_{\gamma,A})}$ over the $r=r_k$ boundary $\partial\cX^\pm_{\gamma,A} \simeq \bigcup_{\g',A=A_\pm+B} \partial_0\cX^\pm_{\g',A_\pm} \times \cX^{\scriptscriptstyle\rm Fl}_{\g',\g,B}$.
	For faces (w.r.t.\ $\partial\cX^\pm_{\g,A}$) with solutions it is given by $\lambda^\pm_{\gamma,A}\big|_{P_{\g,A}^{-1}(\cX^\pm_{\g',A_\pm} \times \cX^{\scriptscriptstyle\rm Fl}_{\g',\g,B})} =
		\lambda^\pm_{\g',A_\pm} \times \lambda^{\scriptscriptstyle\rm Fl}_{\g',\g,B}$ where
	$k_{\gamma,A}\geq 1+ k_{\g',A_\pm} + k_{\g',\g,B}$.
	This is well defined at $(x^\pm,\ul x,\ul x')\in \partial_0\cX^\pm_{\g',A_\pm} \times \cX^{\scriptscriptstyle\rm Fl}_{\g',\g'',B'}\times \cX^{\scriptscriptstyle\rm Fl}_{\g'',\g,B-B'}$, which appears both as
	$(x^\pm, (\ul x,\ul x'))\in \partial_0\cX^\pm_{\g',A_\pm} \times \partial\cX^{\scriptscriptstyle\rm Fl}_{\g',\g,B}$ and
	$((x^\pm,\ul x),\ul x')\in \partial\cX^\pm_{\g'',A_\pm+B'} \times \cX^{\scriptscriptstyle\rm Fl}_{\g'',\g,B-B'}$,
	by the coherence of the Floer multisections and the prior iteration:
	For vectors in the respective fibers
	$(w^\pm, w, w') \in P_{\g',A_\pm}^{-1}(x^\pm) \times P_{\g',\g'',B'}^{-1}(\ul x) \times P_{\g'',\g,B-B'}^{-1}(\ul x')$ we have
	\begin{align*}
		\lambda^\pm_{\g',A_\pm}(w^\pm) \cdot \lambda^{\scriptscriptstyle\rm Fl}_{\g',\g,B}(w,w')
		 & \;=\; \lambda^\pm_{\g',A_\pm}(w^\pm) \cdot \lambda^{\scriptscriptstyle\rm Fl}_{\g',\g'',B'}(w) \cdot
		\lambda^{\scriptscriptstyle\rm Fl}_{\g'',\g,B-B'}(w')                                                   \\
		 & \;=\; \lambda^\pm_{\g'',A_\pm+B'}(w^\pm,w) \cdot
		\lambda^{\scriptscriptstyle\rm Fl}_{\g'',\g,B-B'}(w').
	\end{align*}
	Moreover, $\ev^\pm: |\{x\in \partial\cX^\pm_{\gamma,A} \,|\, \l^\pm_{\gamma,A}(S^\pm_{\gamma,A}(x))>0\}|\to \C^\pm\times M$ is transverse to the submanifolds $\{0\}\times W_p^\pm$.
	However, this defines an admissible sc$^+$-multisection in general position only over the open subset of the boundary $ \partial\cX^\pm_{\gamma,A} = (\ev^\pm)^{-1}(\D^\pm_{r_k}\times M)\cap \partial\Ti\cX^\pm_{\gamma,A}$.
	We multiply the given data by a scale-smooth cutoff function -- guaranteed by the existence of partitions of unity for the open cover $|\Ti\cX^\pm_{\g,A}|=(\ov\ev^\pm)^{-1}(\D^\pm_{r_k}\times M) \cup (\ov\ev^\pm)^{-1}((\ov{\C^\pm}\less\D^\pm_{r_{k+\frac 12}})\times M)$; see Remark~\ref{rmk:partitions} --
	to obtain an admissible sc$^+$-multisection $\l^\partial_{\g,A}: \Ti\cW^\pm_{\gamma,A}|_{\partial\Ti\cX^\pm_{\g,A}}\to\Q^+$ which coincides with the prescribed data -- thus in general position and with evaluation transverse to each $\{0\}\times W_p^\pm$ -- over the closed subset $(\ev^\pm)^{-1}(\ov{\D^\pm_{r_{k+1}}}\times M)\cap \partial \Ti\cX^\pm_{\gamma,A}$.
	Then $\lambda^\pm_{\gamma,A}:\Ti\cW^\pm_{\gamma,A}\to \Q^+$ is constructed with these given boundary values using Theorem~\ref{thm:transversality} to achieve not just general position but also transversality as in \eqref{eq:transev}.
	By admissibility of the prior iteration and coherence of the pairs controlling compactness, $\l^\pm_{\gamma,A}$ can moreover be chosen admissible.

	As required in the coherence discussion, this determines right hand sides of \eqref{eq:coherent2} which agree on overlaps of different immersions $l_{\g,A_\pm}(\cX^+_{\g,A_+}\times \cX^-_{\g,A_-})$ for $r=2$.
	Thus it constructs a well defined sc$^+$-multisection on $\partial^{R=\infty}\cX^{\scriptscriptstyle\rm SFT}_A =
		\bigcup l_{\g,A_{\pm}}(\cX^+_{\g,A_+} \times \cX^-_{\g,A_-}) \subset \partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ that is admissible and has evaluations transverse to the submanifolds $\{0\}\times W_{p_-}^-\times \{0\}\times W_{p_+}^+$ for all pairs $p_-,p_+\in\Crit(f)$.

	Moreover, for $\alpha \in \cI^\pm$ we obtain a pair controlling compactness by pullback of the coherent pairs constructed as in \cite[\S 13]{fh-sft} on the bundles $\cW^\pm_{\gamma,A}$.
	Then the pullback multisections $\ul\k^\pm=(\k_{\alpha}^\pm=\lambda^\pm_{\g,A} \circ (\pr^\iota_\alpha)^*)_{\alpha\in\cI^\pm}$ are sc$^+$, admissible w.r.t.\ the pullback pair, and in general position by the arguments in the proof of Lemma~\ref{lem:iota chain}.


	\medskip\noindent{\bf Construction of $\boldsymbol{\lambda^{\scriptscriptstyle\rm SFT}_A}$ and $\boldsymbol{\underline\kappa}$:}
	The above constructions determine the right hand sides in the coherence requirements $\l_A^{\scriptscriptstyle\rm SFT}|_{P_A^{-1}(\Ti\cX^{\scriptscriptstyle\rm GW}_A)}=\l_A^{\scriptscriptstyle\rm GW}$ over $\Ti\cX^{\scriptscriptstyle\rm GW}_A\subset \Ti\cX^{\scriptscriptstyle\rm SFT}_A$ in  \eqref{eq:coherent1}, as well as
	$\l_A^{\scriptscriptstyle\rm SFT}|_{P_A^{-1}(\cF_{\g,A_\pm}(2))}=(\lambda^+_{\gamma,A_+}\cdot \lambda^-_{\gamma,A_-})\circ (l_{\g,A_\pm})^{-1}_*$
	on $\bigcup_{\g\in\cP(H),A_-+A_+=A} \cF_{\g,A_\pm}(2) \subset\partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ in \eqref{eq:coherent2}, where we denote by
	$\cF_{\g,A_\pm}(r):= l_{\g,A_\pm}(\cX^+_{\g,A_+}\times \cX^-_{\g,A_-})\subset\partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ the image of the immersion $l_{\g,A_\pm}$ on the ep-groupoids representing $|\cX^\pm_{\g,A_\pm}| =(\ov\ev^{\pm})^{-1}(\D^\pm_r\times M)\subset\cB^\pm_{\scriptscriptstyle\rm SFT}(\g;A)$.
	By admissibility in the prior steps and existence of scale-smooth partitions of unity (see Remark~\ref{rmk:partitions}) these induce for every $A\in H_2(M)$ an admissible sc$^+$-multisection $\lambda^\partial_A: \Ti\cW^\pm_A|_{\partial\Ti\cX_A}\to\Q^+$ which coincides with the prescribed data
	over $\Ti\cX^{\scriptscriptstyle\rm GW}_A \sqcup \bigcup_{\g, A_\pm} \overline{\cF_{\g,A_\pm}(1)} \subset\partial\Ti\cX^{\scriptscriptstyle\rm SFT}_A$. Thus on this closed subset we have general position and transversality of the evaluation map
	\begin{equation}
		\ev^+\times \ev^- \,:\; \bigl| \{x\in \partial\cX^{\scriptscriptstyle\rm SFT}_A \,|\, \l^\partial_A(S^{\scriptscriptstyle\rm SFT}_A(x))>0\} \bigr| \;\to\; \C^+ \times M\times \C^-\times M
	\end{equation}
	to $\{0\}\times W_{p_-}^-\times \{0\}\times W_{p_+}^+$ for any pair of critical points $p_-,p_+\in\Crit(f)$.
	Then the admissible sc$^+$-multisection $\lambda^{\scriptscriptstyle\rm SFT}_A:\Ti\cW^{\scriptscriptstyle\rm SFT}_A\to \Q^+$ is constructed with these given boundary values -- and auxiliary norm and support prescribed by the coherent pairs controlling compactness -- using Theorem~\ref{thm:transversality} to achieve general position on all of $\Ti\cX^{\scriptscriptstyle\rm SFT}_A$ and extend transversality of the evaluation $\ev^+\times\ev^-$ to $\{0\}\times W_{p_-}^-\times \{0\}\times W_{p_+}^+$ to the entire perturbed zero set $|\{x\in\cX^{\scriptscriptstyle\rm SFT}_A \,|\, \l^{\scriptscriptstyle\rm SFT}_A(S^{\scriptscriptstyle\rm SFT}_A(x))>0\}|$,
	where $|\cX^{\scriptscriptstyle\rm SFT}_A| = (\ov\ev^+)^{-1}(\D^+_1\times M)\cap (\ov\ev^-)^{-1}(\D^-_1\times M)\subset\cB_{\scriptscriptstyle\rm SFT}(A)$.

	As in the proof of Lemma~\ref{lem:iota chain}, the transversality of the evaluation maps implies that the pullbacks  $\ul\k=(\k_{\alpha}=\lambda_{A} \circ (\pr^\iota_\alpha)^*)_{\alpha\in\cI}$ are in general position. They are also admissible with respect to the pullback of pairs controlling compactness. This finishes the construction of the sc$^+$-multisections claimed in (i) with the boundary restrictions required in (iii).




	\medskip
	\noindent
	{\bf Proof of identity:}
	By $\L$-linearity of all maps involved, it suffices to fix two generators $p_-,p_+\in{\rm Crit}(f)$ of $CM$ and check that $\iota_{\ul\k^\iota}\la p_- \ra$ and $(SSP_{\ul\k^-} \circ PSS_{\ul\k^+})\la p_- \ra + (-1)^{|p_-|} (\rd \circ h_{\ul\k})\la p_- \ra + (-1)^{|p_-|} (h_{\ul\k} \circ d) \la p_- \ra$ have the same coefficient in $\Lambda$ on $\la p_+\ra$. That is, we claim
	\begin{align*}
		\hspace{-3mm} \sum_{\begin{smallmatrix}
				                    A\in H_2(M)  \\ \scriptscriptstyle I^\iota(p_-,p_+;A)=0  \end{smallmatrix} }  \hspace{-5mm}
		\#Z^{\ul\k^\iota}(p_-,p_+; A) \cdot T^{\o(A)}
		 & \; =
		\hspace{-5mm}\sum_{\begin{smallmatrix}
				                   \g\in\cP(H), A_-,A_+\in H_2(M)  \\ \scriptscriptstyle I(p_-,\g;A_+)=I(\g,p_+;A_-)=0
			                   \end{smallmatrix} }
		\hspace{-10mm}
		\#Z^{\ul\k^+}(p_-, \g ; A_+) \; \#Z^{\ul\k^-}(\g, p_+; A_-) \cdot T^{\o(A_-) + \o(A_+)} \\
		 & \qquad + (-1)^{|p_-|}
		\sum_{\begin{smallmatrix}
				      q\in\Crit(f), A\in H_2(M) \\ \scriptscriptstyle I(p_-,q;A)= |q|-|p_+|-1= 0
			      \end{smallmatrix} }
		\hspace{-5mm}
		\#Z^{\ul\k}(p_-,q; A)  \; \#\cM(q,p_+) \cdot T^{\o(A)}                                  \\
		 & \qquad+ (-1)^{|p_-|}
		\sum_{\begin{smallmatrix}
				      q\in\Crit(f), A\in H_2(M) \\ \scriptscriptstyle |p_-|-|q|-1 = I(q,p_+;A)=0
			      \end{smallmatrix} }
		\hspace{-5mm}
		\#\cM(p_-,q)  \; \#Z^{\ul\k}(q,p_+; A) \cdot T^{\o(A)} .
	\end{align*}
	Here the sums on the right hand side are over counts of pairs of moduli spaces of index $0$.
	From \S\ref{sec:Morse} we have $\cM(q,p_+)=\emptyset$ for $|q|-|p_+|-1<0$ and $\cM(p_-,q)=\emptyset$ for $|p_-|-|q|-1<0$, and general position of the sc$^+$-multisections $\ul\k^{\cdots}$ as in Corollary~\ref{cor:regularize}~(iii) implies $Z^{\ul\k^{\cdots}}(\ldots)=\emptyset$ for $I(\ldots)<0$.
	Thus the right hand side can be rewritten as sum over pairs of moduli spaces with indices summing to zero, and by \eqref{PSS index}, \eqref{iota index}, \eqref{h index} this is moreover equivalent to
	\begin{align*}
		0 & \;=\; I{(p_-,\g;A_+)} + I{(\g,p_+;A_-)} \;=\; I^\iota(p_-,p_+;A_-+A_+) \;=\; I(p_-,p_+;A_-+A_+) - 1 , \\
		0 & \;=\; I{(p_-,q;A)} + |q|-|p_+|-1 \;=\; I(p_-,p_+;A) - 1 ,                                             \\
		0 & \;=\; |p_-|-|q|-1 + I{(q,p_+;A)} \;=\; I(p_-,p_+;A) - 1 .
	\end{align*}
	So all sums can be rewritten with the index condition $I(p_-,p_+;A) = 1$ for $A=A_-+A_+\in H_2(M)$, and since the symplectic area is additive $\o(A_-)+\o(A_+)=\o(A_-+A_+)$, it suffices to show the following identity for each $\alpha=(p_-,p_+; A) \in \cI$ with $I(p_-,p_+;A) = 1$,
	\begin{align} \nonumber
		(-1)^{|p_-|} \#Z^{\ul\k^\iota}(p_-,p_+; A)
		 & \; =\; (-1)^{|p_-|} \hspace{-4mm}
		\sum_{\begin{smallmatrix}
				      \scriptscriptstyle \g\in\cP(H) \\ \scriptscriptstyle A_-+A_+=A
			      \end{smallmatrix} } \hspace{-3mm}
		\#Z^{\ul\k^+}(p_-, \g ; A_+) \; \#Z^{\ul\k^-}(\g, p_+; A_-) \\
		 & \quad +   \hspace{-2mm}
		\sum_{q\in\Crit(f) } \hspace{-1mm}
		\#Z^{\ul\k}(p_-,q; A)  \; \#\cM(q,p_+)  \; + \hspace{-2mm}
		\sum_{q\in\Crit(f) } \hspace{-1mm} \#\cM(p_-,q)  \; \#Z^{\ul\k}(q,p_+; A)  .  \label{h claim}
	\end{align}
	This identity will follow from Corollary~\ref{cor:regularize}~(v) applied to the weighted branched $1$-dimensional orbifold $Z^{\ul\kappa}(\alpha)$ that arises from an admissible sc$^+$-multisection $\kappa_{\alpha}:\cW_{\alpha}\to\Q^+$.
	The boundary $\partial Z^{\ul\kappa}(\alpha)$ is given by the intersection with the top boundary stratum $\partial_1\cB(\alpha)\cap \cV_{\alpha} = |\partial_1\cX_{\alpha}|$, and will be determined here -- with orientations computed in \eqref{eq:orient} below.
	\begin{align*}
		 & \partial Z^{\ul\kappa}(\alpha) \;=\; Z^{\ul\kappa}(\alpha) \cap |\partial_1\cX_{\alpha} |                                                                                                                                                      \\
		 & \;=\;
		Z^{\ul\kappa}(\alpha) \cap   |\partial_0\cX^\iota_{p_-,p_+; A}|
		\quad \sqcup \bigcup_{\begin{smallmatrix}
				                      \scriptscriptstyle \g\in\cP(H) \\ \scriptscriptstyle A_-+A_+=A
			                      \end{smallmatrix} }
		Z^{\ul\kappa}(\alpha)  \cap  | \partial_0\cX^+_{p_-,\g; A_+} \times  \partial_0\cX^-_{\g,p_+; A_-} |                                                                                                                                              \\
		 & \qquad\sqcup
		\bigcup_{q\in{\rm Crit}(f)} Z^{\ul\kappa}(\alpha) \cap  \bigl( \cM(p_-,q) \times | \partial_0\cX_{q,p_+; A}| \bigr) \quad \sqcup\bigcup_{q\in{\rm Crit}(f)} Z^{\ul\kappa}(\alpha) \cap \bigl( |\partial_0\cX_{p_-,q; A}| \times \cM(q,p_+) \bigr) \\
		 & \;=\;
		Z^{\ul\kappa^\iota}(p_-,p_+;A)
		\quad \sqcup \bigcup_{\g\in\cP(H), A=A_-+A_+}
		Z^{\ul\kappa^+}(p_-,\g;A_+) \times Z^{\ul\kappa^-}(\g,p_+;A_-)                                                                                                                                                                                    \\
		 & \qquad\sqcup
		\bigcup_{q\in{\rm Crit}(f)} \cM(p_-,q) \times Z^{\ul\kappa}(q,p_+;A)
		\quad \sqcup\bigcup_{q\in{\rm Crit}(f)}  Z^{\ul\kappa}(p_-,q;A)  \times \cM(q,p_+).
	\end{align*}
	Here the second identity uses coherence of the ep-groupoid as in \eqref{eq:homotopy bdy}.
	The third identity follows from coherence of sections $S_\alpha^{\cdots}$ and sc$^+$multisections $\kappa_\alpha^{\cdots}$ stated in (ii), (iii), and the fact from Corollary~\ref{cor:regularize}~(iv) that perturbed zero sets $Z^{\ul\k^{\cdots}}(\alpha)\subset|\partial_0\cX^{\cdots}_\alpha|$ are contained in the interior of the polyfolds when the Fredholm index is $0$.
	For the second summand we moreover use Lemma~\ref{lem:Cartesian} which ensures that each restriction $\kappa_{\alpha}|_{P_\alpha^{-1}(\cF)}$ to a face
	$\cF= \partial_0\cX^+_{p_-,\g; A_+} \times  \partial_0\cX^-_{\g,p_+; A_-} \subset \partial_1\cX_{p_-,p_+; A}$, given by $\k^+_{p_-,\g; A_+} \cdot  \k^-_{\g,p_+; A_-}$, is in general position to the section $S^+_{p_-,\g; A_+} \times  S^-_{\g,p_+; A_-}$.
	Then its perturbed zero set $Z^{\ul\kappa^\iota}(p_-,p_+;A)\cap |\cF|$ is contained in the interior
	$ \partial_0 |\cX^+_{p_-,\g; A_+} \times \cX^-_{\g,p_+; A_-} | = | \partial_0\cX^+_{p_-,\g; A_+} \times  \partial_0\cX^-_{\g,p_+; A_-} |$ as the complement of the pairs of points $(x^+,x^-)$ with
	\begin{align*}
		0 \;=\; \kappa_{p_-,p_+;A}(S_{p_-,p_+;A}(x^+,x^-))
		 & \;=\;
		(\k^+_{p_-,\g; A_+} \cdot  \k^-_{\g,p_+; A_-})\bigl(
		(S^+_{p_-,\g; A_+} \times  S^-_{\g,p_+; A_-})(x^+,x^-)\bigr) \\
		 & \;=\;
		\k^+_{p_-,\g; A_+}( S^+_{p_-,\g; A_+}(x^+)) \cdot
		\k^-_{\g,p_+; A_-}(S^-_{\g,p_+; A_-}(x^-) ) .
	\end{align*}
	Since a product in $\Q^+=\Q\cap[0,\infty)$ is nonzero exactly when both factors are nonzero, this identifies the objects of the perturbed zero set of $\kappa_{p_-,p_+;A}$ with the product of perturbed zero objects for $\kappa^\pm$,
	\begin{align*}
		 & \bigl\{ (x^+,x^-) \in \cF \,\big|\, \kappa_{p_-,p_+;A}(S_{p_-,p_+;A}(x^+,x^-))>0 \bigr\}                      \\
		 & \;=\; \bigl\{ x^+ \in \cX^+_{p_-,\g; A_+} \,\big|\,  \k^+_{p_-,\g; A_+}( S^+_{p_-,\g; A_+}(x_+))   >0 \bigr\}
		\times
		\bigl\{ x^- \in \cX^-_{\g,p_+; A_-}  \,\big|\, \k^-_{\g,p_+; A_-}(S^-_{\g,p_+; A_-}(x^-) )  >0 \bigr\} .
	\end{align*}
	And the realization of this set is precisely $Z^{\ul\kappa^+}(p_-,\g;A_+) \times Z^{\ul\kappa^-}(\g,p_+;A_-)$, as claimed above.

	\medskip
	\noindent
	{\bf Computation of orientations:}
	To prove the identity \eqref{h claim} it remains to compute the effect of the orientations in Remark~\ref{rmk:iota,h orient} on the algebraic identity in Corollary~\ref{cor:regularize}~(v) that arises from the boundary $\partial Z^{\ul\kappa}(\alpha)$ of the 1-dimensional weighted branched orbifolds arising from regularization of the moduli spaces with index $I(\alpha)=I(p_-,p_+;A)=1$. Here $Z^{\l_A^{\scriptscriptstyle\rm SFT}}$ is of odd dimension
	with oriented boundary determined by the orientation relations in Assumption~\ref{ass:iso}~(iii)(b) and (c) as
	$$
		\partial_1 Z^{\l_A^{\scriptscriptstyle\rm SFT}} \;=\; Z^{\l_A^{\scriptscriptstyle\rm SFT}} \cap \partial_1 \cB_{\scriptscriptstyle\rm SFT}(A)
		\;=\; (-1) Z^{\l_A^{\scriptscriptstyle\rm GW}}
		\;\sqcup\; \textstyle
		\bigsqcup_{\begin{smallmatrix}
				\scriptscriptstyle \g \in \cP(H)\\
				\scriptscriptstyle A_- + A_+ = A\\
			\end{smallmatrix}}  Z^{\l_{\g,A_+}^+} \times Z^{\l_{\g,A_-}^-} .
	$$
	Moreover, the index of $\s_{\scriptscriptstyle\rm SFT}$ is $I(\alpha)=|p_-|-|p_+| +2c_1(A)+1=1$, so we compute orientations in close analogy to \eqref{eq:orient-iota} -- while also giving an alternative identification of the boundary components --
	\begin{align}
		\partial Z^{\ul\kappa}(\alpha) & \;=\;
		\partial_1\bM(p_-,M) \; \leftsub{\ev}{\times}_{\ev}\; Z^{\l_A^{\scriptscriptstyle\rm SFT}}\; \leftsub{\ev}{\times}_{\ev} \; \partial_0\bM(M,p_+)  \nonumber                                                        \\
		                               & \quad\sqcup\;
		(-1)^{\dim \bM(p_-,M)} \;
		\partial_0\bM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; \partial_1 Z^{\l_A^{\scriptscriptstyle\rm SFT}}\; \leftsub{\ev}{\times}_{\ev} \; \partial_0\bM(M,p_+) \nonumber                                             \\
		                               & \quad\sqcup\;
		(-1)^{\dim \bM(p_-,M)+1} \;
		\partial_0\bM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; \partial_0 Z^{\l_A^{\scriptscriptstyle\rm SFT}}\; \leftsub{\ev}{\times}_{\ev} \; \partial_1\bM(M,p_+) \nonumber                                             \\
		                               & \;=\;
		\bigl(\; \textstyle\bigsqcup_{q\in\Crit f} \cM(p_-,q) \times \cM(q,M) \;\bigr) \; \leftsub{\ev}{\times}_{\ev}\; Z^{\l_A^{\scriptscriptstyle\rm SFT}} \;\leftsub{\ev}{\times}_{\ev} \; \cM(M,p_+) \label{eq:orient} \\
		                               & \quad\sqcup\;
		(-1)^{|p_-| + |p_+|}
		\cM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; Z^{\l_A^{\scriptscriptstyle\rm SFT}}\; \leftsub{\ev}{\times}_{\ev} \; \bigl(\; \textstyle \bigsqcup_{q\in\Crit f} \cM(M,q) \times \cM(q,p_+) \;\bigr) \nonumber       \\
		                               & \quad\sqcup\;
		(-1)^{|p_-|} \;
		\cM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; \bigl(\; \textstyle\bigsqcup_{\g\in\cP(H),A=A_-+A_+}
		Z^{\l_{\g,A_+}^+} \times Z^{\l_{\g,A_-}^-} \; \bigr) \; \leftsub{\ev}{\times}_{\ev} \; \cM(M,p_+) \nonumber                                                                                                        \\
		                               & \quad\sqcup\;
		(-1)^{|p_-|+1} \;
		\cM(p_-,M) \; \leftsub{\ev}{\times}_{\ev} \; Z^{\l_A^{\scriptscriptstyle\rm GW}}\; \leftsub{\ev}{\times}_{\ev} \; \cM(M,p_+) \nonumber                                                                             \\
		                               & \;=\;
		\textstyle\bigsqcup_{q\in\Crit f} \cM(p_-,q) \times Z^{\ul\k}(q,p_+;A)
		\;\;\sqcup\;\;  \bigsqcup_{q\in\Crit f} Z^{\ul\k}(p_-,q;A)\times \cM(q,p_+) \nonumber                                                                                                                              \\
		                               & \quad
		\;\sqcup\;
		(-1)^{|p_-|} \; \textstyle\bigsqcup_{\g\in\cP(H),A=A_-+A_+}
		Z^{\ul\k^+}(p_-,\g;A_+) \times Z^{\ul\k^-}(\g,p_+;A_-) \nonumber                                                                                                                                                   \\
		                               & \quad\sqcup\;
		(-1)^{|p_-|+1} \; Z^{\ul\k^\iota}(p_-,p_+;A) .  \nonumber
	\end{align}
	This computation should be understood in a neighbourhood of a solution, so in particular with scale-smooth evaluation maps to $\C^\pm\times M$.
	Based on this, Corollary~\ref{cor:regularize}~(v) implies -- as claimed --
	\begin{align*}
		0 & \;=\; h_{\underline\kappa} ( \rd \la p_- \ra ) + \rd ( h_{\underline\kappa} \la p_- \ra ) +   (-1)^{|p_-|} SSP_{\underline\kappa^-} \bigl( PSS_{\underline\kappa^+} \la p_- \ra \bigr)
		- (-1)^{|p_-|}\iota_{\underline\kappa^\iota}\la p_- \ra                                                                                                                                    \\
		  & \;=\; \bigl(\; h \circ \rd + \rd \circ h  +   SSP\circ PSS - \iota \;\bigr) \la p_- \ra  .
	\end{align*}

	\vspace{-5mm}

\end{proof}






\appendix

\section{Summary of Polyfold Theory} \label{sec:polyfold}

This section gives an overview of the main notions of polyfold theory that are used in this paper.
The following language is used to describe settings with trivial isotropy.\footnote{Trivial isotropy would be guaranteed in our settings by an almost complex structure $J$ for which there are no nonconstant $J$-holomorphic spheres.}


\begin{rmk}  \rm \label{rmk:Mpolyfolds}
	\begin{itemlist}
		\item[(i)]
		An {\bf M-polyfold without boundary} is analogous to the notion of a Banach manifold: While the latter are locally homeomorphic to open subsets of a Banach space, an M-polyfold is locally homeomorphic to the image $\cO=\im\rho$ of a retract $\rho:U\to U$ of an open subset $U\subset E$ of a Banach space $E$. While $\rho$ is generally not classically differentiable, it is required to be scale-smooth (sc$^\infty$) with respect to a scale structure on $E$, which is indicated by $\E$.

		\item[(i')]
		An {\bf M-polyfold}, as defined in \cite[Def.2.8]{HWZbook}, is a paracompact Hausdorff space $X$ together with an atlas of charts $\phi_\iota: U_\iota \to \cO_\iota\subset [0,\infty)^{s_\iota}\times  \E^\iota$ (i.e.\ homeomorphisms between open sets $U_\iota\subset X$ and sc-retracts $\cO_\iota$ such that $\cup_\iota U_\iota = X$), whose transition maps are sc-smooth.

		For $k\in\N_0$ the $k$-th boundary stratum $\partial_k X$ is the set of all $x\in X$ of degeneracy index $d(x)=k$ given\footnote{
			The degeneracy index $d(x)\in\N_0$ in \cite[Def.2.13,Thm.2.3]{HWZbook} is a priori independent of the choice of chart $\phi_\iota$ only for points in a dense subset $X_\infty\subset X$ specified in Remark~\ref{rmk:levels}. With that $d(x):=\max\{\limsup d(x_i) \,|\, X_\infty\ni x_i \to x \} $ is well defined for all $x\in X$ and can also be computed in any fixed chart.
		}
		by the number of components equal to $0$ for the point in a chart $\phi_\iota(x)\in [0,\infty)^{s_\iota}\times \E^\iota$.
		In particular, $\partial_0 X$ is the interior of $X$.

		\item[(ii)]
		A {\bf strong bundle} over an M-polyfold $X$, as defined in \cite[Def.2.26]{HWZbook}, is a sc-smooth surjection $P:W\to X$ with linear structures on each fiber $W_x=P^{-1}(x)$ for $x\in X$, and an equivalence class of compatible strong bundle charts, which in particular encode a sc-smooth subbundle $W\supset W^1\to X$ whose fiber inclusions $W_x^1\hookrightarrow W_x$ are compact and dense.

		\item[(iii)]
		The notion of {\bf sc-Fredholm} for a scale smooth section $S:X\to W$ of a strong bundle in \cite[Def.3.8]{HWZbook} encodes elliptic regularity and a nonlinear contraction property \cite[Def.3.6,3.7]{HWZbook}. The latter is a stronger condition than the classical notion of linearizations being Fredholm operators, and is crucial to ensure an implicit function theorem; see \cite{counterex}.
	\end{itemlist}
\end{rmk}


A more detailed survey of these trivial isotropy notions can be found in \cite{usersguide}.
Then the generalization to nontrivial isotropy is directly analogous to the notion of smooth sections of orbi-bundles, in which orbifolds are realizations of \'etale proper groupoids \cite{moer}.

\begin{rmk} \rm  \label{rmk:polyfolds}
	A sc-Fredholm section $\sigma:\cB\to\cE$ of a strong polyfold bundle as introduced in \cite[Def.16.16,16.40]{HWZbook} is a map between topological spaces together with an equivalence class of sc-Fredholm section functors $s:\cX\to \cW$ of strong bundles $\cW$ over ep-groupoids $\cX$, whose realization $|s|:|\cX|\to|\cW|$ together with homeomorphisms $|\cX|:={\rm Obj}_{\cX} / {\rm Mor}_{\cX}\cong\cB$ and $|\cW|\cong\cE$ induces $\sigma$.
	To summarize these notions we use conventions of \cite{HWZbook} in denoting object and morphism spaces as ${\rm Obj}_\cX=X$ and ${\rm Mor}_\cX=\bX$. These will be equipped with M-polyfold structures, so that the $k$-th boundary stratum of a polyfold $\cB\cong|\cX|$ is given as $\partial_k\cB \cong \partial_k X / \bX \subset |\cX|$ for all $k\in\N_0$.


	\begin{itemlist}
		\item[(i)]
		An {\bf ep-groupoid} as in \cite[Def.7.3]{HWZbook} is a groupoid $\cX=(X,\bX)$ equipped with M-polyfold structures on the object and morphism sets such that
		all structure maps are local sc-diffeomorphisms and every $x\in X$ has a neighbourhood $V(x)$ such that $t:s^{-1}\bigl( {\rm cl}_X(V(x))\bigr) \to X$ is proper.
		As in \cite[\S7.4]{HWZbook} we require that the realization $|\cX|$ is paracompact and thus metrizable.

		\item[(ii)]
		A {\bf strong bundle} as in \cite[Def.8.4]{HWZbook} over the ep-groupoid $\cX$ is a pair $(P,\mu)$ of a strong bundle $P:W\to X$ and a strong bundle map $\mu:\bX\leftsub{s}{\times}_P W\to W$ so that $P$ lifts to a functor $\cP:\cW\to\cX$ from an ep-groupoid $\cW=(W,\bW)$ induced by $(P,\mu)$.
		Then $\cP$ restricts to a functor $\cW^1\to\cX$ on the full subcategory whose object space is the sc-smooth subbundle $W^1\subset W$.

		\item[(iii)]
		A  {\bf sc-Fredholm section functor} of the strong bundle $\cP:\cW\to \cX$
		as in \cite[Def.8.7]{HWZbook} is a functor $S:\cX\to \cW$ that is sc-smooth on object and morphism spaces, satisfies $\cP\circ S = \id_\cX$, and such that $S:X\to W$ is sc-Fredholm on the M-polyfold $X$.
	\end{itemlist}
\end{rmk}

Now a polyfold description of a compact moduli space $\bM$ is a sc-Fredholm section $\s:\cB\to\cE$ of a strong polyfold bundle with zero set $\s^{-1}(0)\cong \bM$.
The polyfold descriptions used in this paper are obtained as fiber products of existing polyfolds and sc-Fredholm sections over them. This requires a technical shift in levels described in the following remark, and a notion of submersion below.

\begin{rmk}\label{rmk:levels} \rm
	Polyfolds carry a level structure $\cB_\infty \subset \ldots \subset \cB_1 \subset \cB_0=\cB$ as follows:
	For any M-polyfold $X$, in particular the object space of the ep-groupoid representing $\cB=|\cX|$,
	a sequence of dense subsets $X_\infty \subset \ldots \subset X_1 \subset X_0= X$ is induced by the
	scale structures $\E^\iota=(E^\iota_m)_{m\in\N_0}$ of the charts,
	that is $X_m=\bigcup_{\iota} \phi_\iota^{-1}(\cO_\iota\cap \R^{s_\iota}\times E^\iota_m)$.
	Then $\cB_m:=\qu{X_m}{{\rm Mor}_\cX}$ is well defined since morphisms of $\cX$ -- locally represented by scale-diffeomorphisms -- preserve the levels on ${\rm Obj}_\cX=X$.

	The restriction $\sigma|_{\cB_m}$ of a sc-Fredholm section $\s:\cB\to\cE$ is again sc-Fredholm with values in $\cE_m$, and the choice of such a shift in levels is irrelevant for applications since the zero set $\s^{-1}(0)\subset\cB_\infty$ -- as well as the perturbed zero set for any admissible perturbation -- is always contained in the so-called ``smooth part'' that is densely contained in each level $\cB_\infty\subset\cB_m$.

	For a finite dimensional manifold or orbifold $M$ -- such as the Morse trajectory spaces in \S\ref{ssec:Morse} -- viewed as polyfold, the level structure is trivial $M_\infty=\ldots = M_1=M_0=M$.
\end{rmk}


\begin{dfn} \label{def:submersion} \cite[Def.5.9]{Ben-fiber}
	A sc$^\infty$ functor $f:\cX \to M$ from an ep-groupoid $\cX = (X, {\bf X})$ to a finite dimensional manifold $M$ is a {\bf submersion} if for all $x \in X_{\infty}$ the tangent map $\rD_x f : \rT^R_xX \rightarrow \rT_{f(x)}M$ is surjective, where $\rT^R_xX$ is the reduced tangent space \cite[Def.2.15]{HWZbook}.

	Consider in addition a sc-Fredholm section functor $S : \cX \rightarrow \cW$.
	Then the sc$^\infty$ functor $f : \cX \rightarrow M$ is {\bf $S$-compatibly submersive} if for all $x \in X_{\infty}$ there exists a sc-complement
	$L\subset \rT_x^RX$ of $\ker(\rD_xf) \cap \rT_x^RX$
	and a tame sc-Fredholm chart for $S$ at $x$ \cite[Def.5.4]{Ben-fiber}
	in which the change of coordinates $\psi : \cO \to [0,\infty)^s \times \R^{k-s} \times \mathbb{W}$ that puts $S$ in basic germ form -- which by tameness has the form $\psi(v,e) = (v,\overline{\psi}(e))$ for $(v,e)\in \cO \subset [0,\infty)^s \times \mathbb{E}$ and a linear sc-isomorphism $\overline{\psi}$ -- moreover satisfies $\overline{\psi}(L) \subset \{0\}^{k-s} \times \mathbb{W}$,
	where the chart identifies $L \subset \rT_x^RX\cong\rT_0^R\cO= \{0\} \times \mathbb{E}$.


	More generally, given a smooth submanifold $N \subset M$, the sc$^{\infty}$ functor $f$ is {\bf transverse} to $N$ if for all $x \in f^{-1}(N) \cap X_{\infty}$ we have $\rD_xf(\rT_x^RX) + \rT_{f(x)}N = \rT_{f(x)}M$, and $f$ is {\bf $S$-compatibly transverse} to $N$ if there exists a sc-complement $L$ of $(\rD_xf)^{-1}(\rT_{f(x)}(N)) \cap \rT_x^RX$ satisfying the above condition.
\end{dfn}

The purpose of giving a moduli space a polyfold description is to utilize the perturbation theory for sc-Fredholm sections over polyfolds, which allows to ``regularize'' the moduli space by associating to it a well defined cobordism class of weighted branched orbifolds.
(For a technical statement see Corollary~\ref{cor:regularize} and the references therein.)
Since the ambient space $|\cX|$ is almost never locally compact, this requires ``admissible perturbations'' of the section to preserve compactness of the zero set. This admissibility is determined by the following data introduced in \cite[Def.12.2,15.4]{HWZbook}.

\begin{dfn} \label{def:control}
	A {\bf saturated open subset} $\cU\subset \cX$ of an ep-groupoid $\cX=(X,\bX)$ is an open subset $\cU\subset X$ with $\pi^{-1}(\pi(\cU))=\cU$, where $\pi:X \to |\cX|=\qu{X}{\bX}$ is the projection to the realization.

	A {\bf pair controlling compactness} for a sc-Fredholm section $S:\cX\to\cW$ of a strong bundle $P:\cW\to\cX$ consists of an auxiliary norm $N:\cW[1]\to[0,\infty)$ (see \cite[Def.12.2]{HWZbook}) and a saturated open subset $\cU\subset \cX$ that contains the zero set $S^{-1}(0)\subset\cU$, such that $\bigl| \{ x\in \cU \,|\, N(S(x))\leq 1 \} \bigr| \subset |\cX|$ has compact closure.

	Given such a pair, a section $s:\cX\to\cW$ is {\bf $\boldsymbol{(N,\mathcal U)}$-admissible} if $N(s(x))\leq 1$ and $\supp s \subset \cU$.
\end{dfn}

The construction of perturbations moreover requires scale-smooth partitions of unity, which will be guaranteed by the following standing assumptions.

\begin{rmk}\label{rmk:partitions} \rm
	Throughout this paper we assume that the realizations $|\cX|$ of ep-groupoids are paracompact, and the Banach spaces $E$ in all M-polyfold charts are Hilbert spaces.
	This guarantees the existence of scale-smooth partitions of unity by \cite[\S5.5,\S7.5.2]{HWZbook}.
	In order to guarantee the same on every level $\cB_m$ as discussed in Remark~\ref{rmk:levels}, we moreover assume that each scale structure $\E=(E_m)_{m\in\N_0}$ consists of Hilbert spaces $E_m$.
	These assumptions hold in applications, such as the ones cited \cite{hwz-gw,fh-sft}.
	Then paracompactness and thus existence of scale-smooth partitions of unity on every level is guaranteed by \cite[Prop.7.12]{HWZbook}.
\end{rmk}


When discussing coherence of perturbations of a system of sc-Fredholm sections, the boundaries are described in terms of Cartesian products of polyfolds, bundles, and sections. So we will make use of Cartesian products of multivalued perturbations as follows, to obtain multisections over the boundary as summarized in the subsequent remark.



\begin{lem} \label{lem:Cartesian}
	Let  $S_1:\cX_1\to\cW_1$ and $S_2:\cX_2\to\cW_2$ be sc-Fredholm section of strong bundles $P_i:\cW_i\to\cX_i$ over ep-groupoids. Then the Cartesian product
	$\cX_1\times\cX_2$ is naturally an ep-groupoid and
	$(S_1\times S_2) : \cX_1\times\cX_2 \to \cW_1\times\cW_2$ is a sc-Fredholm section of the strong bundle $P_1\times P_2$.

	Moreover, if $\lambda_i:\cW_i\to\Q^+$ are sc$^+$-multisections for $i=1,2$, then there is a well defined sc$^+$-multisection $\lambda_1\cdot \lambda_2:\cW_1\times\cW_2\to\Q^+$ given by $(\lambda_1 \cdot \lambda_2)(w_1,w_2) = \lambda_1(w_1) \cdot \lambda_2(w_2)$. If, for $i = 1,2,$ the sections $\lambda_i$ are $(N_i,\cU_i)$-admissible for some fixed pair controlling compactness as in Definition~\ref{def:control}, then $\lambda_1 \cdot \lambda_2$ is $(\max(N_1,N_2),\cU_1 \times\cU_2)$-admissible.
	Finally, if $\lambda_i$ is in general position to $S_i$ for $i=1,2$ then $\lambda_1\cdot \lambda_2$ is in general position to $S_1\times S_2$.
\end{lem}
\begin{proof}
	A detailed treatment of sc-Fredholmness of the product section $S_1 \times S_2$ can be found in \cite[Lemma~7.2]{Ben-fiber}. The remaining statements follow easily from the definitions in \cite{HWZbook} (as do the statements in the first paragraph).

	Recall in particular from \cite[Def.13.4]{HWZbook} that a sc$^+$-multisection on a strong bundle $P:\cW\to\cX$ is a functor $\lambda:
		\cW\to\Q^+$ that is locally of the form $\lambda(w) = \sum_{\{ j \,|\, w = p_j(P(w))\}} q_j$, represented by  sc$^+$-sections $p_1,\ldots,p_k:\cV\to P^{-1}(\cV)$ (i.e.\ sc$^\infty$ sections of $\cW^1$; see \cite[Def.2.27]{HWZbook}) and weights $q_1,\ldots,q_k\in\Q\cap[0,\infty)$ with $\sum_j q_j = 1$.
	Then for local sections $p_j^i$ and weights $q_j^i$ representing $\lambda_i$ for $i=1,2$, the multisection $\lambda_1\cdot \lambda_2$ is locally represented by the sections $(p_j^1, p_{j'}^2)$ with weights $q_j^1q_{j'}^2$, and all admissibility and general position arguments are made at the level of these local sections.

	In particular, the $(N_i,\cU_i)$-admissibility can be phrased as the existence of local representations by sections with $N_i(p^i_j(x))\leq 1$ and $Z(S_i,p^i_j) := \{x\in \cV_i \,|\, \exists\, t\in[-1,1]: S_i(x) = t p^i_j(x) \}\subset\cU_i$. Then $(\max(N_1,N_2),\cU_1 \times\cU_2)$-admissibility uses the observation\\
	$\displaystyle \{(x_1,x_2) \,|\, \exists\, t\in[-1,1]: (S_1,S_2)(x_1,x_2) = t (p^1_j(x_1),p^2_{j'}(x_2)
		\} \subset Z(S_1,p^1_{j})  \times Z(S_2,p^2_{j'}) \subset\cU_1\times\cU_2 $.
\end{proof}


\begin{rmk}\rm \label{rmk:faces}
	Let $P : \cW\to\cX$ be a strong bundle over a tame ep-groupoid $\cX=(X,\bX)$. Then for every $x\in X_\infty$ there is a chart $\phi: U_x \to \cO$ from a locally uniformizing\footnote{
		A neighbourhood $U_x\subset X$ forms a local uniformizer as in \cite[Def.7.9]{HWZbook} if the morphisms between points in $U_x$ are given by a local action of the isotropy group $G_x$.
	}
	neighbourhood $U_x\subset X$ of $x$ to a sc-retract $\cO\subset[0,\infty)^n\times\E$, with $\phi(x)=0$ lying in the intersection of the $n$ local faces $\cF_k:=\phi^{-1}(\{ (\ul v,e) \in [0,\infty)^n\times\E\,|\, v_k=0 \})$ which cover the boundary $\partial X\cap U_x = \bigcup_{k=1}^n \cF_k$.

	Now a {\bf sc$\boldsymbol{^+}$-multisection over the boundary} is a functor $\lambda^{\partial} : P^{-1}(\partial \cX) \rightarrow \mathbb{Q}^+$ whose restriction $\lambda^{\partial}|_{ P^{-1}(\cF_k)}$ to each local face is a sc$^+$-multisection of the strong bundle $P^{-1}(\cF_k)\to\cF_k$.
	In the presence of a sc-Fredholm section $S:\cX\to\cW$, such a sc$^+$-multisection is {\bf in general position over the boundary} if for each intersection of faces $\cF_K:= \bigcap_{k\in K} \cF_k\subset \partial X$ the restriction of the perturbed multi-section $\lambda^\partial\circ S|_{\cF_K}: P^{-1}(\cF_K)\to\Q^+$ has surjective linearizations at all solutions.
	If, moreover, $(N,\cU)$ is a pair controlling compactness, then $\lambda^{\partial}$ is $(N,\cU)$-admissible if each restriction $\lambda^{\partial}|_{ P^{-1}(\cF_k)}$ is admissible w.r.t.\ the pair $(N|_{P^{-1}(\cF_k)},\cU\cap \cF_k)$.

	In our applications, as described in Assumption~\ref{ass:iso}, the local faces $\cF_k$ are images of open subsets of global face immersions $l_\cF : \cF \to \partial\cX$, where each $\cF$ is a Cartesian product of two polyfolds, and the restriction to the interior $l_\cF|_{\partial_0\cF}$ is an embedding into the top boundary stratum $\partial_1\cX$. The bundles over each face are naturally identified with the pullbacks $l_\cF^*\cW$, and then the pushforwards of sc$^+$-multisections $\lambda_\cF:l_\cF^*\cW \to \Q^+$ form a sc$^+$-multisection over the boundary $\lambda^{\partial} : P^{-1}(\bigcup \im\lambda_\cF) \rightarrow \mathbb{Q}^+$ if they agree on overlaps and self-intersections of the immersions $l_\cF$, at the boundary $\partial\cF$ of the faces.
	In this setting, general position of $\lambda^\partial$ is equivalent to general position of the multisections $\lambda_\cF$.
\end{rmk}



The following perturbation theorem allows us to refine the construction of coherent perturbations in  \cite{fh-sft} for the SFT moduli spaces such that moreover the evaluation maps from the perturbed solution sets are transverse to the unstable and stable manifolds in the symplectic manifold.
This is a generalization of the polyfold perturbation theorem over ep-groupoids and the extension of transverse perturbations from the boundary \cite[Theorems~15.4,15.5]{HWZbook} (with norm bound given by $h\equiv 1$ for simplicity).
Another version of this -- with the submanifolds representing cycles whose Gromov-Witten invariants are then obtained as counts -- also appears in \cite{wolfgang, wolfgangorbifold}.
We are working under the assumptions made in this section -- e.g.\ paracompactness -- without further mention.
The limitation to finitely many submanifolds in the extension result seems to be of technical nature; we expect that joint work of the first author with Dusa McDuff
-- on coherent finite dimensional reductions of polyfold Fredholm sections --
will establish the result for countably many submanifolds.


\begin{thm} \label{thm:transversality}
	Suppose $S:\cX\to\cW$ is a sc-Fredholm section functor of a strong bundle $P : \cW\to\cX$ over a tame ep-groupoid $\cX$ with compact solution set $|S^{-1}(0)| \subset |\cX|$,
	and let $(N,\cU)$ be a pair controlling compactness.
	Moreover, let $e:\cX\to M$ be a sc$^0$-map to a finite dimensional manifold $M$ which has a sc$^{\infty}$ submersive restriction $e|_{\cV} : \cV \rightarrow M$ on a saturated open set $\cV \subset \cX$.

	Then, for any countable collection of smooth submanifolds $(C_i \subset M)_{i\in I}$ with $e^{-1}\bigl( \,\overline{\cup_{i \in I}(C_i)} \,\bigr) \subset \cV$, there exists an $(N,\cU)$-admissible sc$^+$-multisection $\l:\cW\to\Q^+$ so that $(S,\lambda)$ is in general position (see \cite[Definition~15.6]{HWZbook}) and the restriction $e|_{Z^\lambda}:Z^\lambda \to M$ to the perturbed zero set $Z^\lambda=|\{x\in X \,|\, \l(S(x))>0\}|$ is in general position\footnote{
	General position to $C_i$ requires transversality to $C_i$ of each restriction $e|_{Z^\lambda\cap \cF_K}$ to the perturbed solution set within an intersection of local faces $\cF_K=\bigcap_{k\in K} \cF_k$ as defined in Remark~\ref{rmk:faces}, including for $\cF_\emptyset:=Z^\lambda$.
	} to the submanifolds $C_i$ for all $i\in I$.

	Moreover, suppose $I$ is finite and $\lambda^{\partial} : P^{-1}(\partial \cX) \rightarrow \mathbb{Q}^+$ for some $0<\alpha<1$ is an $(\frac 1\alpha N,\cU)$-admissible structurable sc$^+$-multisection in general position over the boundary
	such that the restriction $e|_{Z^\partial}: Z^\partial \to M$ to the perturbed zero set in the boundary $Z^{\partial} := |\{ x\in \partial\cX \,|\,  \lambda^{\partial}( S(x)) > 0 \}|$ is in general position\footnote{
	This requires general position of each restriction $e|_{Z^\lambda\cap \cF_k}$ to a local face $\cF_k\subset \partial\cX$ as defined in Remark~\ref{rmk:faces}.
	} to the submanifolds $C_i$ for all $i\in I$.
	Then $\lambda$ above can be chosen with $\lambda|_{P^{-1}(\partial \cX) } = \lambda^{\partial}$.
\end{thm}

\begin{proof}
	Our proof follows the perturbation procedure of \cite[Theorem~15.4]{HWZbook}, which proves the special case when there is no condition on a map $e : \cX \rightarrow M$, i.e.\ when $M = \{pt\}$ and $C_i = \{pt\}$. To obtain the desired transversality of $e$ to the submanifolds $C_i \subset \cM$ we will go through the proof and indicate adjustments in three steps:
	A local stabilization construction, which adds a finite dimensional parameter space to cover the cokernels near a point $x\in S^{-1}(0)$; a local-to-global argument which combines the local constructions into a global stabilization which covers the cokernels near $S^{-1}(0)$; and a global Sard argument which shows that regular values yield transverse perturbations.
	Within these arguments we need to consider restrictions to any intersection of faces to ensure general position to the boundary, use submersivity of $e$ to achieve transversality to the $C_i$, and work with multisections due to isotropy.
	The statement with prescribed boundary values $\lambda^{\partial}$ generalizes the extension result \cite[Theorem~15.5]{HWZbook}, which hinges on the fact that general position over the boundary persists in an open neighbourhood -- something that is generally guaranteed only for finitely many transversality conditions; see the end of this proof. The first step in any construction of perturbations is the existence of local stabilizations which cover the cokernels, as follows.

	\medskip
	\noindent
	{\bf Local stabilization constructions:}
	For every zero $x \in S^{-1}(0)$ of the unperturbed sc-Fredholm section
	we construct a finite dimensional parameter space $\mathbb{R}^l$
	for $l=l_x\in\N_0$ and sc$^+$-multisection
	\begin{align*}
		\tilde{\Lambda}^x \,:\; \mathbb{R}^l \times \cW & \rightarrow \mathbb{Q}^+
		, \qquad (t,w) \mapsto \Lambda^x_t(w)
	\end{align*}
	such that
	$\L^x_0$ is the trivial multisection, i.e.\ $\Lambda^x_0(0)=1$, $\Lambda^x_0(w)=0$ for $w\in \cW_x\less\{0\}$.
	This multisection $\tilde{\Lambda}^x$ is viewed as local perturbation near
	$(0,x)$ of a sc-Fredholm section functor $\ti S^x$ of a bundle $\ti P^x$,
	\begin{align*}
		\tilde{S}^x\,:\; \mathbb{R}^l \times \cX & \rightarrow \mathbb{R}^l \times \cW
		\qquad                                   & \tilde{P}^x \,: \; \mathbb{R}^l \times \cW & \rightarrow \mathbb{R}^l \times \cX \\
		(t,y)                                    & \mapsto (t,S(y))
		                                         & (t,w)                                      & \mapsto (t,P(w)) .
	\end{align*}
	It is constructed in \cite{HWZbook} to be structurable in the sense of \cite[Def.13.17]{HWZbook}, in general position
	in the sense that
	the linearization $\rT_{(\tilde{S}^x,\tilde{\Lambda}^x)}(0,x) : \rT_0\mathbb{R}^l \times \rT^R_x X \rightarrow W_x$ is surjective\footnote{
		This is shorthand for $\tilde S^x + p_j$ having surjective linearization for every section $p_j$ in a local representation of $\ti\L^x$ with $\ti S^x(0,x) = 0 = p_j(0,x)$, and restricted to the reduced tangent space $\rT^R_x X$.
	}
	and admissible in the sense that
	the domain support of $\tilde{\Lambda}^x$ is contained in
	$\cU$ and the auxiliary norm is bounded linearly, $N(\Lambda)(t,y)\leq c_x |t|$ for some constant $c_x$.
	In case $x \in \cV\cap S^{-1}(0)$ we refine this construction to require surjectivity of the restrictions
	\begin{equation} \label{eq:transverseonkernel}
		\rT_{(\tilde{S}^x,\tilde{\Lambda}^x)}(0,x)|_{\rT_0\mathbb{R}^l \times K_x} \,:\; \rT_0\mathbb{R}^l \times K_x \;\to\; W_x ,
	\end{equation}
	where $K_x := \ker (\rD_x e|_{\rT_x^R X} ) \subset \rT_x^R X$ is the kernel of the linearization
	$\rD_xe : \rT_x^R X \rightarrow \rT_{e(x)}M$ restricted to the reduced tangent space.
	For that purpose note that $e$ is sc$^\infty$ near $x$ by assumption, so has a well defined linearization, and since its codomain is finite dimensional, its kernel has finite codimension. Moreover $\im\rD_x S\subset W_x$ has finite codimension by the sc-Fredholm property of $S$, and the reduced tangent space $\rT_x^R X\subset\rT_x X$ has finite codimension by the definition of M-polyfolds with corners.
	Thus we can find finitely many vectors $w^1,\ldots,w^l \in W_x$ which together with $\rD_x S(K_x)$ span $W_x$. These vectors are extended to sc$^+$-sections of the form $p^j(t,y)=\sum t_j w^j(y)$, multiplied with sc$^\infty$ cutoff functions of sufficiently small support, and pulled back by local isotropy actions to construct the functor $\tilde{\Lambda}^x$ as in \cite[Thm.15.4]{HWZbook}.
	We claim that this yields the following local properties with respect to the sc$^\infty$ functor
	$$
		\ti e^x \,:\; \mathbb{R}^{l} \times \cV \to M, \qquad (t,y) \mapsto e(y) .
	$$


	\medskip
	\noindent
	\ul{Local stabilization properties:}
	{\it There exists $\epsilon_x > 0$ and a locally uniformizing
	neighborhood $Q(x) \subset X$ of $x$ whose closure is contained in $\cU$, such that
	\begin{equation} \label{eq:localorbifold}
		\Theta^x \,:\; \{ t\in\R^l \, | \, |t| < \epsilon_x \} \times Q(x) \;\to\; \Q^+, \qquad (t,y) \;\mapsto\;\Lambda_t^x \bigl( S(y) \bigr) = \ti\L^x(\ti S^x(t,y))
	\end{equation}
	is a tame ep$^+$-subgroupoid, and for $(t,y)\in\supp \Theta^x=\{(t,y)\,|\, \Theta^x(t,y)>0 \}\subset\R^l\times X$ the reduced linearizations $\rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}(t,y):= \rT_{(\tilde{S}^x,\tilde{\Lambda}^x)}(t,y)|_{\rT_t\R^l\times \rT_{y}^R X}$ are surjective.
	Moreover, if $x \in \cV$ then we may choose $Q(x) \subset \cV$ such that for all $(t,y) \in \supp \Theta^x$ we have surjections\footnote{
	As before, this is shorthand for surjectivity on each reduced tangent space
	$\ker \rD_{(t,y)}( \tilde{S}^x + p_j)|_{\rT_t\R^l\times \rT_{y}^R X}$.
	}
	\begin{equation*}
		\rD_{(t,y)}\ti e^x |_{N^x_{t,y}} \;:\; N^x_{t,y} := \ker \rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}(t,y) \; \to\; \rT_{e(y)}M .
	\end{equation*}
	In particular, the realization $|\supp \Theta^x|$ is a weighted branched orbifold and $\ti e^x$ induces a submersion $|\supp\Theta^x| \rightarrow M$ in the sense of Definition~\ref{def:submersion}.
	Moreover, for all $y \in S^{-1}(0)\cap U_x$ we have $(0,y)\in\supp \Theta^x$ so that the reduced linearizations
	$\rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}(0,y)$ and the restriction to their kernel $\rD_{(0,y)}\ti e^x |_{N^x_{0,y}}$ are surjective. These properties persist for $y\in S^{-1}(0)$ with $|y|\in|Q(x)|$.}


	\medskip
	The structure of $\supp \Theta^x$ and surjectivity of linearizations $\rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}$ follows from the local implicit function theorem \cite[Theorems~15.2,15.3]{HWZbook}.
	Then the kernels $N^x_{t,y} = \ker \rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}(t,y)$ represent the reduced tangent spaces at $|(t,y)|$ to the weighted branched orbifold $|\supp\Theta^x|$.
	Surjectivity of $\rD_{(0,x)}\ti e^x |_{N^x_{0,x}}$ holds since $\rD_{(0,x)}\ti e^x$ is surjective by assumption, and the preimage of any given vector in $\rT_{e(x)}M$ can be adjusted by vectors in $\ker\rD_{(0,x)}\ti e^x$ to lie in $N^x_{0,x} = \ker \rT^R_{(\tilde{S}^x,\tilde{\Lambda}^x)}(0,x)$, because $\rT_{(\tilde{S}^x,\tilde{\Lambda}^x)}(t,y)|_{\ker\rD_{(0,x)}\ti e^x}$ is surjective by  \eqref{eq:transverseonkernel}.
	Then $\ti e^x$ restricts to a map $|\supp\Theta^x| \rightarrow M$ that is classically smooth on each (finite dimensional) branch of $\supp\Theta^x$, and thus surjectivity of $\rD_{(t,y)}\ti e^x |_{N^x_{t,y}}$ is an open condition along each branch. Since $\supp \Theta^x$ is locally compact -- in particular with finitely many branches near $x$ -- we can then choose $\epsilon_x$ and $Q(x)$ sufficiently small to guarantee that each $\rD_{(t,y)}\ti e^x |_{N^x_{t,y}}$ is surjective. This proves submersivitiy in the sense of Definition~\ref{def:submersion}.


	\medskip
	\noindent
	{\bf From local to global stabilization:}
	In this portion of the proof, we proceed almost verbatim to the corresponding portion of \cite[Thm.15.4]{HWZbook}, with extra considerations to deduce submersivity of \eqref{eq:bigevsubmersive}.
	By assumption, $|S^{-1}(0)|$ is compact and $|e|: |\cX|\to M$ is continuous. Then $|S^{-1}(0)| \cap |e^{-1}(C)|$ is compact since $C:= \overline{\cup_{i \in I}(C_i)} \subset M$ is closed. We moreover have the identity $|S^{-1}(0) \cap e^{-1}(C)|= |S^{-1}(0)| \cap |e^{-1}(C)|$ since both sets are saturated.
	Thus we have an open covering $\bigl(|Q(x)|\bigr)_{x \in S^{-1}(0)\cap e^{-1}(C)}$ by the open subsets chosen above, and can pick finitely many points $x_1,\ldots,x_r  \in S^{-1}(0) \cap e^{-1}(C)$ to obtain a finite open cover $|S^{-1}(0) \cap e^{-1}(C)| \subset \bigcup_{i=1}^r |Q(x_i)|$.
	Then $|S^{-1}(0)| \less \bigcup_{i=1}^r |Q(x_i)|$ is compact, with open cover by $\bigl(|Q(x)|\bigr)_{x \in S^{-1}(0)}$, so we may pick further $x_{r+1},\ldots,x_k \in S^{-1}(0)$ to obtain the covers
	\begin{align} \label{eq:cover}
		 & \textstyle
		|S^{-1}(0)| \;\subset\; \bigcup_{i=1}^k |Q(x_i)|,
		\qquad\qquad\qquad\qquad
		|S^{-1}(0) \cap e^{-1}(C)| \;\subset\; \bigcup_{i=1}^r |Q(x_i)|, \\
		 & \textstyle \nonumber
		S^{-1}(0) \;\subset\; \tilde{Q} := \pi^{-1}\bigl(  \bigcup_{i=1}^k |Q(x_i)| \bigr) \;\subset\; \cU.
	\end{align}
	For each $x=x_i$ we constructed above a family of sc$^+$-multisections $\bigl(\Lambda_t^{x_i}: \cW\to\Q^+\bigr)_{t\in\R^{l_{x_i}}}$. These are summed up, using \cite[Def.13.11]{HWZbook}, to a sc$^+$-multisection
	\begin{align*}
		\tilde{\Lambda} \,:\; \mathbb{R}^{\tilde{l}} \times \cW \;\to\; \mathbb{Q}^+, \qquad
		\bigl(t=(t_1,\ldots,t_k) \,,\, w \bigr) \;\mapsto\; \Lambda_t(w) \,:=\; \big ( \Lambda^{x_1}_{t_1} \oplus \cdots \oplus \Lambda^{x_k}_{t_k} \big )(w)
	\end{align*}
	for $\tilde{l} := l_{x_1} + \cdots + l_{x_k}$.
	Here each $\Lambda_t : \cW \rightarrow \mathbb{Q}^+$ for $t\in\R^{\ti l}$ is a structurable sc$^+$-multisection by \cite[Prop.13.3]{HWZbook}.
	We view the multisection $\tilde{\Lambda}$ as global perturbation of a sc-Fredholm section functor $\ti S$ of a bundle $\ti P$,
	\begin{align*}
		\tilde{S}\,:\; \mathbb{R}^{\ti l} \times X & \rightarrow \mathbb{R}^{\ti l} \times \cW =: \ti\cW
		\qquad                                     & \tilde{P} \,: \; \mathbb{R}^{\ti l} \times \cW      & \rightarrow \mathbb{R}^{\ti l} \times \cX \\
		(t,y)                                      & \mapsto (t,S(y))
		                                           & (t,w)                                               & \mapsto (t,P(w)) ,
	\end{align*}
	and claim that $e:\cX\to M$ induces a submersion on its perturbed solution set in the following sense.

	\medskip
	\noindent
	\ul{Global stabilization properties:}
	{\it There exists $\epsilon_0 > 0$ such that for every $0<\epsilon < \epsilon_0$
	\begin{equation} \label{eq:stabilizedorbifold}
		\ti\Theta \,:\; \{ t\in\R^{\ti l} \, | \, |t| < \epsilon \} \times \cX \;\to\; \Q^+,
		\qquad (t,y) \;\mapsto\; \Lambda_t \bigl( S(y) \bigr) = \ti\L(\ti S(t,y))
	\end{equation}
	is a tame ep$^+$-subgroupoid with surjective reduced linearizations $\rT^R_{(\tilde{S},\tilde{\Lambda})}(t,y)$ for all $(t,y)\in\supp\ti \Theta$. In particular, the realization $|\supp \ti\Theta|$ is a weighted branched orbifold. Moreover, there is a neighbourhood $\cV'\subset\cX$ of $S^{-1}(0)\cap e^{-1}(C)$ such that
	\begin{equation} \label{eq:bigevsubmersive}
		\ti e |_{\supp\ti\Theta} \,:\; \supp\ti\Theta  \;\to\; M , \qquad (t,y) \mapsto e(y)
	\end{equation}
	satisfies $(\ti e |_{\supp\ti\Theta})^{-1}(C)\subset \R^{\ti l}\times\cV'$, and its restriction to
	$\supp\ti\Theta \cap (\R^{\ti l}\times\cV')$ is classically smooth and submersive as in Definition~\ref{def:submersion}.}

	\medskip
	Note that the auxiliary norm $N$ on $\cW$ pulls back to an auxiliary norm $\ti N$ on $\ti\cW$, and compactness of $\ti S$ is controlled in the sense that for any compact subset $K\subset \R^{\ti l}$ we have compactness of
	\begin{equation} \label{eq:controlcompfamily}
		\bigl| \{(t,x)\in K \times \cU \,|\, \ti N(\ti S(t,x) ) \leq 1\} \bigr|
		\;=\; K \times \bigl| \{(x \in \cU \,|\, N(S(x) ) \leq 1\} \bigr| \;\subset\; \R^{\ti l}\times |\cX|.
	\end{equation}
	Next, the restriction of $\ti\Lambda$ to each $\R^{l_{x_i}}\times X \hookrightarrow \R^{\ti l}\times X$ is the local perturbation $\ti\Lambda^{x_i}$ of $\ti S^{x_i}$, since we identify $\R^{l_{x_i}}\cong\{(t_1,\ldots,t_k)\in\R^{\ti l} \,|\, t_j=0 \;\forall j\neq i\}$ and each $\Lambda^{x_j}_0$ is trivial.
	In particular, $\Lambda_0$ is the trivial multisection, with $N(\Lambda_0)=0$.
	Moreover, we have an estimate $N(\Lambda_t)\leq c|t|$ that results from the linear estimates on each $\Lambda^{x_i}_t$. Now for $\epsilon_0\leq \frac 1c$ we can deduce compactness of the stabilized solution set as closed subset of \eqref{eq:controlcompfamily},
	\begin{equation} \label{eq:compactclosure}
		\ti Z  \,:= \; \bigl| \bigl\{ (t,x) \in \R^{\ti l} \times X \,\big| \, |t| \leq \epsilon_0,  \Lambda_t(S(x)) > 0 \bigr\} \bigr| .
	\end{equation}
	The next step is to argue that \eqref{eq:compactclosure} is smooth in a neighbourhood of $\ti Z \cap (\{0\} \times |\cX|) = \{0\} \times |S^{-1}(0)|$. Recall here that $\ti Q=\pi^{-1}(\bigcup_{i=1}^k |Q(x_i)|)\subset X$ is an open neighbourhood of $S^{-1}(0)$.
	So for any $x\in \tilde{Q}$ we can use the local properties of some $\ti\L^{x_i}$ with $|x|\in|Q(x_i)|$ to deduce surjectivity of $\rT^R_{(\tilde{S},\tilde{\Lambda})}(0,x)$.
	Then the local implicit function theorems \cite[Thms~15.2,15.3, Rmk.15.2]{HWZbook} yield an open neighbourhood $U(0,x) = \{ |t| < \epsilon'_x \} \times U(x)\subset\R^{\ti l} \times X$ of $(0,x)$ for some $0<\epsilon'_x<\epsilon_0$, and hence a saturated neighbourhood $\ti U(0,x) :=  \{ |t| < \epsilon'_x \} \times \pi^{-1}(|U(x)|) \subset\R^{\ti l} \times\cX$ such that $\ti\Theta|_{\ti U(0,x)} =\tilde{\Lambda} \circ \tilde{S}|_{\ti U(0,x)}$ is a tame branched ep$^+$-subgroupoid of $\tilde{U}(0,x)$. As a consequence, the orbit space of the support $\bigl|\supp \ti\Theta|_{\tilde{U}(0,x)}\bigr|$ is a weighted branched orbifold with boundary and corners.

	For $x \in S^{-1}(0) \less e^{-1}(C)$ we can moreover choose $U(x) \cap e^{-1}(C) = \emptyset$, since $|e^{-1}(C)|\subset|\cX|$ is closed.
	For $x \in S^{-1}(0) \cap e^{-1}(C)\subset\cV$ the covering \eqref{eq:cover} guarantees $|x|\in|Q(x_i)|$ for some $1\leq i \leq r$ with $Q(x_i)\subset\cV$ and we choose $U(x)\subset Q(x_i)$.
	This guarantees that the restriction of $\tilde{e} : \mathbb{R}^{\tilde{l}} \times X \to M, (t,y) \mapsto e(y)$ to $\ti U(0,x)$ is sc$^\infty$, and surjectivity of $\rD_{(0,x)}\ti e^{x_i} |_{\ker \rT^R_{(\tilde{S}^{x_i},\tilde{\Lambda}^{x_i})}(0,x)}$ implies surjectivity of $\rD_{(0,x)}\tilde{e}|_{N_{0,x}} : N_{0,x} \rightarrow \rT_{e(x)}M$ on $N_{0,x} := \ker \rT^R_{(\tilde{S},\tilde{\Lambda})}(0,x)$.
	Here $N_{0,x}$ represents the reduced tangent space at $|(0,x)|$ to the weighted branched orbifold $|\supp \ti\Theta|_{\tilde{U}(0,x)} |$.
	Now $\ti e|_{\supp\ti\Theta \cap \tilde{U}(0,x)} : \supp\ti\Theta|_{\tilde{U}(0,x)} \rightarrow M$ is classically smooth since it is a restriction of an sc$^\infty$ map to finite dimensions, and we have shown it to be submersive at $(0,x)$. Hence, by openness of submersivity along each corner stratum, and local compactness of $\supp\ti\Theta|_{\tilde{U}(0,x)}\subset\ti Z$ it follows that $\ti U(0,x)\subset\R^{\ti l}\times\cV$ can be chosen sufficiently small to ensure that $\ti e|_{\supp\ti\Theta \cap \tilde{U}(0,x)}$ is submersive as in Definition~\ref{def:submersion}.

	Now compactness of $|S^{-1}(0) \cap e^{-1}(C)|$ and $|S^{-1}(0)|$ again allows us to find finite covers
	\begin{align*}
		 & \textstyle
		|S^{-1}(0)| \;\subset\; \bigcup_{i=1}^{k'} |U(x'_i)|,
		\qquad\qquad\qquad\qquad
		|S^{-1}(0) \cap e^{-1}(C)| \;\subset\; \bigcup_{i=1}^{r'} |U(x'_i)|
	\end{align*}
	with $x'_i\in S^{-1}(0) \cap e^{-1}(C)$ for $i=1,\ldots,r'$ and $U(x'_i) \cap e^{-1}(C) = \emptyset$ for $r'<i\leq k'$.
	Then we have $\epsilon:=\min\{\epsilon'_{x'_1}, \ldots \epsilon'_{x'_{k'}}\}  > 0$, an open cover $S^{-1}(0) \subset \cA:= \pi^{-1}\bigl(\bigcup_{i=1}^{k'} |U(x'_i)|\bigr)$, and the functor $\{t \in \R^{\ti l} \, | \, |t| < \epsilon\} \times \cA \rightarrow \mathbb{Q}^+, (t,y) \mapsto \Lambda_t(S(y))$ is a tame branched ep$^+$-subgroupoid, since it is the restriction of $\ti\Theta=\tilde{\Lambda} \circ \tilde{S}$ to an open subset of $\bigcup_{i=1}^{k'}\tilde{U}(0,x'_i)$.
	Moreover, we claim that for a possibly smaller $0<\epsilon <\epsilon_0$ we have
	\begin{equation}\label{eq:claimA}
		(t,y) \in \{|t| < \epsilon\} \times X , \quad \ti\Theta(t,y) > 0 \qquad\Longrightarrow\qquad  y \in \cA .
	\end{equation}
	By contradiction, consider a sequence $\R^{\ti l} \ni t_n\to 0$, $y_n\in X$ with $\ti\Theta(t_n,y_n)>0$ but $y_n\in X\less \cA$. Then compactness of \eqref{eq:compactclosure} guarantees a convergent subsequence $|(t_n,y_n)|\to |(0,y_\infty)|\in\ti Z$, and since $\ti Z\cap \{0\}\times |\cX| = \{0\}\times |\supp \Lambda_0\circ S | = \{0\}\times |S^{-1}(0)|$ this contradicts the fact that $|y_n|\in|\cX|\less|\cA|$, where $|\cA|=\bigcup_{i=1}^{k'} |U(x'_i)|\subset|\cX|$ is an open neighbourhood of $|S^{-1}(0)|$.
	Thus we have shown \eqref{eq:claimA} and can deduce that
	$\tilde{\Theta} =\ti\L\circ \ti S : \{t \in \R^{\ti l} \, | \, |t| < \epsilon \} \times \cX \to \Q^+$
	is a tame branched ep$^+$-subgroupoid with $\supp \ti \Theta \subset \R^{\ti l} \times \cA$, and thus
	$\bigl|\supp \ti\Theta\bigr|\subset \R^{\ti l} \times\bigcup_{i=1}^{k'} |U(x'_i)|$ is a weighted branched orbifold with boundary and corners, as claimed.

	Moreover, from the properties of $\ti e|_{\supp\ti\Theta \cap \tilde{U}(0,x'_i)}$ for $i=1,\ldots,r'$ we know that the restriction of $\tilde{e}$ to $\supp \tilde{\Theta} \cap (\R^{\ti l}\times\cV')$ for $\cV':= \pi^{-1}\bigl(\bigcup_{i=1}^{r'} U(x'_i) \bigr) \subset \cV$ is classically smooth and submersive.
	Here we have $e^{-1}(C) \cap \cA\subset \cV'$ since $U(x_i)$ for $i>r'$ was chosen disjoint from $e^{-1}(C)$, and hence we have
	$$
		\bigl(\tilde{e}|_{\supp \tilde{\Theta}}\bigr)^{-1}(C) \;=\; \supp \tilde{\Theta} \cap \bigl( \R^{\ti l} \times e^{-1}(C)\bigr) \;\subset\; \R^{\ti l} \times \bigl( e^{-1}(C) \cap \cA \bigr)
		\;\subset\; \R^{\ti l} \times \cV',
	$$
	and thus $\tilde{e}|_{ \supp \tilde{\Theta}} : \supp \tilde{\Theta} \rightarrow M$ is classically smooth and submersive (in the sense of Definition~\ref{def:submersion}) in the open neighborhood $\supp \tilde{\Theta} \cap (\R^{\ti l} \times \cV')$ of $\bigl(\tilde{e}|_{\supp \tilde{\Theta}}\bigr)^{-1}(C_i) \subset \supp \tilde{\Theta}$ for all $i \in I$.


	\medskip
	\noindent
	{\bf Global transversality from regular values:} As we continue to follow the proof of \cite[Thm.15.4]{HWZbook}, we replace each application of the Sard theorem by countably many Sard arguments to obtain general position to the countably many submanifolds $C_i \subset M$ for $i\in I$.
	For that purpose we will consider various restrictions of the projection
	$$
		\supp \tilde{\Theta} = \bigl\{ (t,y) \in \R^{\ti l} \times \cX \, \big | \, |t| < \epsilon,\, \Lambda_t(S(y)) > 0 \bigr\} \;\to\; \R^{\ti l}, \qquad (t,y) \mapsto t .
	$$
	The global properties of $\ti\Theta$ imply that every $(t_0,y_0) \in \supp \tilde{\Theta}$ has a saturated open neighborhood
	$\ti U(t_0,y_0) = \{ t\in\R^{\ti l} \, | \, |t-t_0| < \delta\} \times \pi^{-1}(|U(y_0)|) \subset \R^{\ti l}\times \cX$
	satisfying the following:
	\begin{itemlist}
		\item
		$U(y_0)\subset X$ admits the natural action of the isotropy group $G_{y_0}$; see \cite[Thm.7.1]{HWZbook}, satisfies the properness property \cite[Def.7.17]{HWZbook},
		and has $d_{\cX}(y_0)$ local faces $\cF^{y_0}_1,\ldots,\cF^{y_0}_{d_{\cX}(y_0)}$ which contain $y_0$; see \cite[Def.2.21, Prop.2.14]{HWZbook}.
		\item
		The branched ep$^+$-subgroupoid $\supp\ti\Theta\cap \tilde{U}(t_0,y_0)$ has a local branching structure
		$$
			\ti\Theta(t,y) \;=\; \Lambda_t(S(y)) \;=\; \tfrac{1}{|J|} \cdot \bigl| \bigl\{j \in J \, | \, (t,y) \in M^{t_0,y_0}_j \bigr\} \bigr|,
		$$
		given by finitely many properly embedded submanifolds with boundary and corners $M^{t_0,y_0}_j\subset \tilde{U}(t_0,y_0)$, which intersect any intersection of local faces in a manifold with boundary and corners.
		\item
		On each branch $M^{t_0,y_0}_j$, the reduced linearizations $\rT^R_{(\tilde{S},\tilde{\Lambda})}(t,y)$ are surjective for all $(t,y) \in M^{t_0,y_0}_j$, and the restriction of $\tilde{e}|_{\supp\tilde{\Theta}}$ is a submersion
		$M^{t_0,y_0}_j \cap (\mathbb{R}^{\tilde{l}} \times \cV') \rightarrow M$ in general position to the boundary in the sense of Definition~\ref{def:submersion}.
		That is, $\rD_{(t,y)}\tilde{e}|_{N_{t,y}} : N_{t,y} \rightarrow \rT_{e(y)}M$ is surjective on $N_{t,y} := \ker \rT^R_{(\tilde{S},\tilde{\Lambda})}(t,y)$ for all $(t,y) \in M^{t_0,y_0}_j \cap (\R^{\ti l} \times \cV')$.
	\end{itemlist}

	\noindent
	There is a countable cover $\supp\tilde{\Theta}\subset \bigcup_{\beta\in\Z} \tilde{U}(t_{\beta},y_{\beta})$ indexed by $(t_{\beta},y_{\beta})_{\beta \in\Z} \subset \supp \tilde{\Theta}$, since $\R^{\ti l} \times X$ -- and hence its subspace $\supp\ti\Theta$ -- is second-countable, and every open cover of a second-countable space has a countable subcover.
	Moreover, for any given $\beta\in\Z$ there are finitely many choices $\ti\cF_K := \{ |t-t_0| < \delta\}  \times\bigcap_{k\in K}\cF^{y_{\beta}}_k \subset \tilde{U}(t_{\beta},y_{\beta})$ of intersections of finitely many local faces $K\subset\{1,\ldots,d_\cX(y_\beta)\}$, with $\ti\cF_\emptyset:= \tilde{U}(t_{\beta},y_{\beta})$.
	Finally, for each $\beta\in\Z$ and intersection of faces $\ti\cF_K$, there are finitely many smooth manifolds $\ti\cF_K \cap M^{t_\beta,y_\beta}_j$ indexed by $j \in J_\beta$.
	For each of these countably many choices, Sard's theorem asserts that
	$\ti\cF_K \cap M^{t_\beta,y_\beta}_j \to \R^{\ti l}$, $(t,y) \mapsto t$
	has an open and dense subset $R^\beta_{K,j} \subset\R^{\ti l}$ of regular values.
	Then, since $\R^{\ti l}$ is a Baire space, the set of common regular values $\cR_0:= \bigcap_{\beta\in\Z}\bigcap_{K,j} R^\beta_{K,j} \subset \mathbb{R}^{\tilde{l}}$ is still dense.
	For any $t_0 \in \cR_0$, the sc$^+$-multisection $\Lambda_{t_0} : \cW \rightarrow \mathbb{Q}^+$ is in general position by the usual linear algebra for each restriction of the linearized operators to intersections of faces:
	Consider $(t_0,x_0)\in\ti\cF_K \cap M^{t_\beta,y_\beta}_j \subset \supp\ti\Theta$ and a local section $S+p^j$ in the representation of $\ti\Theta=\ti\Lambda\circ\ti S$ with $M^{t_\beta,y_\beta}_j \subset (S+p^j)^{-1}(0)$. The surjective differential along this intersection of faces can be written as $\rD_{t_0,x_0}(S+p^j)|_{\ti\cF_K} = D \oplus L$, where $L$ is a bounded operator (arising from differentiating $p^j$ in the direction of $\R^{\ti l}$) and $D$ is the reduced linearization -- on the intersection of faces $\cF_K:= \bigcap_{k\in K}\cF^{y_{\beta}}_k \subset U(y_{\beta})\subset X$ -- of the section $S+p^j(t_0,\cdot)$ that is a part of the representation of $\Lambda_{t_0}\circ S$. Then regularity of $t_0$ implies surjectivity of the projection $\Pi:\ker(D\oplus L)\to \R^{\ti l}$, which in turn is equivalent to surjectivity of $D$; see e.g.\ \cite[Lemma~A.3.6]{MS}.

	Moreover, each $\Lambda_t$ for $|t| < \epsilon$ is $(N,\cU)$-admissible, thus any sufficiently small regular $t_0\in\cR_0$ yields an admissible  sc$^+$-multisection $\lambda := \Lambda_{t_0}$ in general position as in \cite[Thm.15.4]{HWZbook}.
	To prove our theorem, we have to moreover choose $t_0 \in \cR_0$ so that the restriction $e|_{Z^{\lambda}} : Z^{\lambda} \rightarrow M$ to the solution set $Z^{\lambda} = |\supp \lambda \circ S |$ is in general position to $C_i \subset M$ for all $i \in I$.
	For that purpose we consider the countably many projections
	\begin{equation}\label{eq:eCprojections}
		\tilde{e}^{-1}(C_i) \cap \ti\cF_K \cap M^{t_\beta,y_\beta}_j \;\to\; \mathbb{R}^{\tilde{l}},
		\qquad (t,x) \mapsto t
	\end{equation}
	for any $i\in I$, index $\beta\in\Z$ of the countable cover, intersection of local faces $\ti\cF_K$, and smooth branch $M^{t_\beta,y_\beta}_j\subset \supp \tilde{\Theta}\cap \ti U(t_\beta,y_\beta)$.
	Here we have $\tilde{e}^{-1}(C_i) \cap M^{t_\beta,y_\beta}_j \subset (\tilde{e}|_{\supp\ti\Theta})^{-1}(C)$, so that the restriction
	$\tilde{e}|_{\ti\cF_K \cap M^{t_\beta,y_\beta}_j} : \ti\cF_K\cap M^{t_\beta,y_\beta}_j \to M$
	is smooth and submersive in a neighborhood of $\tilde{e}^{-1}(C_i)$.
	In particular, it is transverse to $C_i$ so that there is a natural smooth structure on $\tilde{e}^{-1}(C_i) \cap \ti\cF_K \cap M^{t_\beta,y_\beta}_j$.
	Thus we can apply the Sard theorem to each \eqref{eq:eCprojections} to find open and dense subsets $T^{i,\beta}_{K,j} \subset\R^{\ti l}$ of regular values, and a dense set of common regular values $\cT_0:= \bigcap_{\beta\in\Z}\bigcap_{K,j} R^\beta_{K,j}\cap \bigcap_i T^{i,\beta}_{K,j} \subset \mathbb{R}^{\tilde{l}}$.
	Note that $\cT_0\subset \cR_0$, so sufficiently small $t_0\in\cT_0$ yield admissible  sc$^+$-multisections $\lambda:=\Lambda_{t_0}$ in general position.
	Moreover, general position of $e|_{Z^{\lambda}} : Z^{\lambda} \rightarrow M$ to $C_i$ at
	$x\in Z^\lambda \cap e^{-1}(C_i)$ means that the linearizations of $e|_{\cF_K\cap Z^\lambda}$ map onto $\qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$ for each intersection of local faces $\cF_K \subset U(y_{\beta})\subset X$ that contains $x$. Here the tangent spaces of $\cF_K\cap Z^{\lambda}$ at $x$ are given by those of $\ti\cF_K \cap M^{t_\beta,y_\beta}_j  \cap (\{t_0\}\times X)$ for each branch with $(t_0,x) \in M^{t_\beta,y_\beta}_j \subset\supp\ti\Theta$, so we need to ensure surjectivity of $\rD_{(t_0,x)}\ti e : \ker\Pi \to \qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$ on the kernel of the projection
	$\Pi: \rT_{(t_0,x)} \bigl( \ti\cF_K \cap M^{t_\beta,y_\beta}_j \bigr) \to \R^{\ti l}$.
	Here $\rD_{(t_0,x)}\ti e : \rT_{(t_0,x)} \bigl( \ti\cF_K \cap M^{t_\beta,y_\beta}_j \bigr) \to \rT_{e(x)} M$ is surjective (since $\ti e|_{\supp\ti\Theta}$ is submersive),
	and regularity $t_0\in T^{i,\beta}_{K,j}$ means that we have $\Pi \, (\rD_{(t_0,x)}\ti e)^{-1}(\rT_{e(x)} C_i) = \R^{\ti l}$, so for any $Y\in \rT_{e(x)} M$ we find $(T,X)\in \rT_{(t_0,x)} \bigl( \ti\cF_K \cap M^{t_\beta,y_\beta}_j \bigr)$ with $\rD_{(t_0,x)}\ti e (T,X) = Y$ and $(T,X')\in (\rD_{(t_0,x)}\ti e)^{-1}(\rT_{e(x)} C_i)$, so that $(0,X-X')\in\ker\Pi$ proves the required surjectivity $\rD_{(t_0,x)}\ti e (0,X-X') = Y - \rD_{(t_0,x)}\ti e (T,X') = [Y]\in \qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$.
	Thus this choice of sufficiently small $t_0\in\cT_0$ also guarantees general position of $e|_{Z^{\lambda}}$ to each of the countably many submanifolds $C_i$, which finishes the proof of the theorem when no boundary values are prescribed.


	\medskip
	\noindent
	{\bf Regular extension:}
	To prove the last paragraph of the theorem we consider a given $(\frac 1\alpha N,\cU)$-admissible structurable sc$^+$-multisection $\lambda^{\partial} : P^{-1}(\partial \cX) \rightarrow \mathbb{Q}^+$ that is in general position over the boundary, and with $e|_{Z^\partial}: Z^\partial = \supp \lambda^{\partial} \circ S|_{\partial \cX} \to M$ in general position to finitely many submanifolds $C_i$.
	Then we will adjust the above construction of $\lambda : \cW \rightarrow \mathbb{Q}^+$ to also satisfy $\lambda|_{P^{-1}(\partial \cX)} = \lambda^{\partial}$, by following the proof of the transversal extension theorem over ep-groupoids \cite[Thm.15.5]{HWZbook}.

	Since $\lambda^\partial$ is supported in $\cU\cap\partial\cX$ with $N(\lambda^\partial)(x)<\alpha$ for all $x\in\partial\cX$ we can find a continuous functor $h : \cX \rightarrow [0,1)$ supported in $\cU$ with $N(\lambda^{\partial})(x) < h(x) < \frac 12 N(\lambda^{\partial})(x) + \frac 12$ for all $x \in \partial \cX$. Then \cite[Thm.14.2]{HWZbook}
	yields a sc$^+$-multisection $\Lambda' : \cW \rightarrow \mathbb{Q}^+$ with $\Lambda'|_{P^{-1}(\partial \cX)} = \lambda^{\partial}$, domain support in $\cU$, and $N(\Lambda')(x) \leq h(x) \leq \frac{\alpha+1}2$ for all $x \in \cX$.
	This guarantees compactness of $|\supp\Lambda'\circ S|\subset|\cX|$ and regularity of $|\supp\Lambda'\circ S| \cap |\partial\cX| = |\supp\lambda^\partial\circ S|_{\partial\cX}|$.
	To obtain regularity in the interior we construct $\lambda = \Lambda'\oplus\Lambda_t$ by the above arguments with $S^{-1}(0)$ replaced by $\cS':=\supp\Lambda'\circ S \subset \cX$, noting that $|\cS'|\subset|\cX|$ is also compact.
	To achieve general position to the $C_i$ we need further adjustments.

	\medskip
	\noindent
	{\bf Local constructions relative to boundary values:}
	For interior points $x\in \cS'\cap\partial_0 \cX$ we construct $\ti\Lambda^x:\R^l \times\cW \to \Q^+$ with domain support in the interior $\R^l \times (\partial_0\cX \cap \cU)$ to cover the cokernels of $\rT^R_{(\tilde{S}^x,\tilde\Lambda')}$ for the stabilized multisection
	$\ti\Lambda':\R^l\times\cW\to\Q^+, (t,w) \mapsto \Lambda'(w)$.
	For $x\in \cS'\cap\partial\cX$ we need no stabilization by a $\R^l$ factor (i.e.\ take $l=0$) due to the general position of $\lambda^\partial$ at $x$. However, we only obtain general position to the $C_i$, rather than submersivity in the following claim.

	\medskip
	\noindent
	\ul{Local properties relative to boundary:}
	{\it For each $x\in\cS'$ there exists $l_x\in\N_0$ -- with $l_x=0$ for $x\in\cS'\cap\partial\cX$ -- and a locally uniformizing neighborhood $Q(x) \subset X$ of $x$ whose closure is contained in $\cU$, such that for some $\epsilon_x > 0$ we have a tame ep$^+$-subgroupoid
		$\Theta^x : \{ t\in\R^l \, | \, |t| < \epsilon_x \} \times Q(x) \to \Q^+$, $(t,y) \mapsto
			\bigl( \Lambda' \oplus \Lambda_t^x\bigr) ( S(y))$
		with surjective reduced linearizations,
		and thus a weighted branched orbifold $|\supp \Theta^x|$.
		Moreover, if $x \in \cS'\cap\cV$ then $\ti e^x$ induces a smooth map
		$|\supp\Theta^x| \rightarrow M$, which is in general position to $C_i$ for each $i\in I$.
	}

	\medskip
	The structure of $\Theta^x$ is established in \cite[Thm.15.5.]{HWZbook}, and the general position to each $C_i$ for $x\in\partial_0\cX$ follows from submersivity.
	To achieve general position to the $C_i$ for $x\in\partial\cX$, recall that $C= \overline{\cup_{i \in I}(C_i)} \subset M$ is closed, so for $x\notin e^{-1}(C)$ we can choose $Q(x)$ disjoint from $e^{-1}(C)$ so that general position to the $C_i\subset C$ is automatic.  For $x \in e^{-1}(C)\subset\cV$ we have $e : \supp\Theta^x \cap \partial\cX = \supp \lambda^\partial \circ S|_{\partial\cX} \to M$ in general position to each $C_i$ by assumption on $\lambda^\partial$. Moreover, we choose $Q(x)\subset\cV$ so that $e : Q(x) \cap \supp\Theta^x \to M$ is smooth, and thus general position to each $C_i$ extends to a neighbourhood $Q_i\subset\cX$ of $x$. Then $Q':=\bigcap_{i\in I} Q_i$ is a neighbourhood of $x$ since $I$ is finite, and we can replace $Q(x)$ by a uniformizing neighbourhood in $Q'$ to achieve general position to all $C_i$.

	\medskip
	\noindent
	{\bf From local to global relative to boundary:}
	This portion of the proof is started by picking a finite cover $|\cS'|\cap|\partial\cX| = |\supp \lambda^\partial\circ S|_{\partial\cX}| = \bigcup_{i=-k_\partial}^0 |Q(x_i)| \subset |\cX|$ by the above neighbourhoods for $x_i\in \cS' \cap \partial\cX$. Next we cover $|\cS'|\setminus \bigcup_{i=-k_\partial}^0 |Q(x_i)| \subset \bigcup_{i=1}^k |Q(x_i)|$ with neighbourhoods of  interior points $x_i\in\cS'\cap \partial_0\cX$ whose associated multisections $\Lambda^{x_i}$ are supported in the interior, $\text{dom-supp}\,\Lambda^{x_i}\subset \R^{l_x}\cap \partial_0\cX$.
	Then we define $\tilde{\Lambda} : \R^{\ti l} \times \cW \to\mathbb{Q}^+$ by $\ti\Lambda (t, w) := \Lambda_t(w) :=  \big (\Lambda' \oplus \Lambda^{x_1}_{t_1} \oplus \cdots \oplus \Lambda^{x_k}_{t_k} \big )(w)$. This multisection is constructed so that $\Lambda_0=\Lambda'$ and $\Lambda_t|_{P^{-1}(\partial\cX)}=\lambda^\partial$ for any $t\in\R^{\ti l}$. Moreover, the estimate $N(\Lambda_t)\leq N(\Lambda') + c|t| \leq \frac{1+\alpha}{2} + c|t|$ allows us to guarantee admissibility $N(\Lambda_t)\leq 1$ by choosing $|t|\leq \frac{1-\alpha}{2c}$. Then compactness of $\ti Z$ in \eqref{eq:compactclosure} follows as above, and its smoothness is established using a covering
	$|S^{-1}(0)| \subset \bigcup_{i=-k_\partial}^{k'} |U(x'_i)|$
	where $|U(x'_i)|$ for $i\leq 0$ arise from $x'_i\in\cS'\cap\partial\cX$ and cover a neighbourhood of $|\partial\cX|$.
	Moreover, $U(x'_i)\subset \R^{\ti l}\times Q(x'_i)$ can be chosen as in the prior proof of the local properties such that $\ti e|_{\supp\Theta} : U(x'_i) \rightarrow M$ is in general position to $C_i$ for each $i\in I$.
	This establishes the following.

	\medskip
	\noindent
	\ul{Global stabilization properties with fixed boundary values:}
	{\it There exists $\epsilon_0 > 0$ such that $\ti\Theta:= \ti\Lambda \circ \ti S : \{ |t| < \epsilon \} \times \cX \to \Q^+$ is a tame ep$^+$-subgroupoid with surjective reduced linearizations for every $0<\epsilon < \epsilon_0$.
	In particular, $|\supp\ti\Theta|$ is a weighted branched orbifold.
	Moreover, there is a neighbourhood $\cV'\subset\cX$ of $S^{-1}(0)\cap e^{-1}(C)$ such that
	$\ti e |_{\supp\ti\Theta} : \supp\ti\Theta \to M$ satisfies $(\ti e |_{\supp\ti\Theta})^{-1}(C)\subset \R^{\ti l}\times\cV'$, and its restriction to $\supp\ti\Theta \cap (\R^{\ti l}\times\cV')$ is classically smooth and in general position to each $C_i$.
	}


	\medskip
	\noindent
	{\bf Global transversality relative to boundary:}
	In this final step we use the fact that $\Lambda_t$ is $(N,\cU)$-admissible for $|t|\leq \frac{1-\alpha}{2c}$ and choose a common regular value of countably many projections as before.
	The only difference to the proof above is that the restriction of $\tilde{e}|_{\supp\tilde{\Theta}}$ to a branch $M^{t_0,y_0}_j \cap (\R^{\ti l}\times \cV') \rightarrow M$ is not necessarily submersive but still in general position to each of the $C_i$, that is
	$\rD_{(t,y)}\tilde{e}|_{N_{t,y}} : N_{t,y} \rightarrow \qu{\rT_{e(y)}M}{\rT_{e(y)}C_i}$ is surjective for each $i\in I$.
	When considering the projections \eqref{eq:eCprojections}, this suffices to obtain smooth structures on $\tilde{e}^{-1}(C_i) \cap \ti\cF_K \cap M^{t_\beta,y_\beta}_j$ for each branch and intersection of faces $\ti\cF_K$.
	Then general position of $e|_{Z^{\lambda}} : Z^{\lambda} \rightarrow M$ to $C_i$ at $x\in Z^\lambda \cap e^{-1}(C_i)$ for $\lambda =\Lambda_{t_0}$ with a regular value $t_0\in\R^l$ again requires surjectivity of $\rD_{(t_0,x)}\ti e : \ker\Pi \to \qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$ on the kernel of the projection
	$\Pi: \rT_{(t_0,x)} \bigl( \ti\cF_K \cap M^{t_\beta,y_\beta}_j \bigr) \to \R^{\ti l}$.
	To see that $[Y]\in\qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$ is in the image we use the above surjectivity of $\rD_{(t_0,x)}\tilde{e}|_{N_{t_0,x}}$ to find $(T,X)\in\rT_{(t_0,x)} \bigl( \ti\cF_K \cap M^{t_\beta,y_\beta}_j \bigr)$ with $\rD_{(t_0,x)}\tilde{e}(T,X) \in [Y]$. Then regularity of $t_0$
	yields $(T,X')\in (\rD_{(t_0,x)}\ti e)^{-1}(\rT_{e(x)} C_i)$, so that $(0,X-X')\in\ker\Pi$ solves
	$[\rD_{(t_0,x)}\ti e (0,X-X') ] = [Y - \rD_{(t_0,x)}\ti e (T,X')] = [Y] \in \qu{\rT_{e(x)} M}{\rT_{e(x)} C_i}$.
	This finishes the proof with prescribed boundary values.
\end{proof}
Polyfold theory is a systematic and efficient approach providing a language and a large body of results for dealing with larger classes of nonlinear elliptic equations involving compactness
(bubbling-off), smoothness (varying domains and targets) and (geometric) transversality issues.
The abstract theory, proposed in the series of papers \cite{HWZ2,HWZ3,HWZ3.5},\  
generalizes  differential geometry and  nonlinear Fredholm theory to a class of spaces which are much more general than (Banach) manifolds. These spaces may have (locally) varying dimensions and are described locally by retracts on scale Banach spaces, replacing the open sets of Banach spaces in the familiar local description of manifolds. The theory also allows to equip certain kinds of categories with smooth structures.
Current applications include the study of moduli spaces of pseudoholomorphic curves in symplectic geometry, f.e. the construction of Symplectic Field Theory (SFT),
see \cite{HWZ5,H2,FH2,FH3}.\par

The theory grew out of the attempts to find an appropriate framework to develop  SFT,  a general theory of symplectic invariants outlined in \cite{EGH}.
The SFT constructs invariants of symplectic cobordisms by analyzing the structure of solutions of elliptic partial differential equations  of Cauchy-Riemann type, from Riemann surfaces into compact symplectic manifolds.  The partial differential equations are defined on varying domains and map into varying targets. The occurring singular limits, like bubbling off phenomena, give rise to serious compactness and transversality problems. Yet, these phenomena are needed to derive the underlying rich algebraic structure of SFT. Therefore 
they have to be `embraced' and accurately accounted for. The analytical difficulties in dealing with SFT become apparent
in the series of papers \cite{H1,HWZ-Convex,HWZ-tight,HWZ7.1} culminating in the SFT-compactness paper \cite{BEHWZ}.\par



This book is written as a reference volume for polyfold theory and the accompanying Fredholm theory.  We do not give any applications, since they are developed elsewhere.
For example in \cite{FH2} the theory is used to develop methods to equip specific groupoidal categories with smooth structures and   to apply these ideas to construct the polyfolds of  SFT. Using the polyfold setup for SFT developed in \cite{FH2} the transversality 
from the present book is applied in \cite{FH3} to construct SFT. The publication \cite{HWZ5} illustrates the polyfold theory by its application to Gromov-Witten theory and makes  transparent how the theory deals with the occurring issues. Another application is given
in \cite{Suhr} to the Weinstein conjecture. The paper \cite{HWZ8.7} illustrates part of  the theory by examples relevant for applications. 

A reader who  understands the inner-workings of the machinery should feel comfortable to use more stream-lined versions, as for example developed in   \cite{FH2}, which exploit
the full strength of the material described here.
 It is clear that the polyfold theory, which grew out of the  structurally very rich SFT-example, also applies to other classes or families of nonlinear elliptic partial differential equations as well. \par

In Part I of this book, based on \cite{HWZ2,HWZ3},  we develop  the Fredholm theory in a class
of spaces called M-polyfolds.  These spaces can be viewed as a generalization of the notion of a manifold (finite or infinite dimensional).
In  Part II M-polyfolds, based on \cite{HWZ3.5},    will be generalized  to a class of spaces called ep-groupoids, which can be viewed as the polyfold generalization
of \'etale proper Lie groupoids. This generalization is useful in dealing with problems having local symmetries, which is needed
 in more  advanced applications.  
 In  Part III we develop, following  \cite{HWZ3,HWZ3.5,HWZ7,HWZ7err}, the Fredholm theory in ep-groupoids. Transversality and symmetry are antagonistic concepts, since perturbing a problem to achieve 
 transversality might not be possible when we also want to preserve the symmetries.  Although it  seems hopeless  in many cases to achieve transversality, there 
 is  a version of transversality theory over the rational numbers, which is based on a perturbation theory using set-valued perturbations.  Such an idea was introduced
 by Fukaya and Ono, \cite{FO}, in  their  Kuranishi framework for the Arnold conjectures. The use of set-valued operators in nonlinear analysis is older, and a description can be found in \cite{Zeidler}. 
 It seems that the latter was never used to develop a transversality theory in a context of symmetries. We merge these ideas into a nice formalism which was in a very special case
 suggested in \cite{CRS}.
 In some sense  the transversality theory in a symmetric setting replaces locally the equivariant problem by a symmetric weighted family of problems. \par
 
 
 
 A by-product of our considerations is a Fredholm theory,  generalizing what in classical terms would be 
 a Fredholm theory on (Banach) orbifolds with boundary with corners.
 In summary, Parts {I}-{III} describe a wide array of nonlinear functionalanalytic tools to study perturbation and transversality questions
for a large class of so-called Fredholm sections and Fredholm section functors in ep-groupoids.\par


The whole theory can be generalized even a step further to equip certain categories (groupoidal categories) with smooth structures and to develop a theory of Fredholm functors.  This is carried out in Part IV. 
An outline of such ideas in the case of Gromov-Witten theory is given in \cite{H2}. Another example is the construction of  SFT  which    most elegantly is described within such a framework. These ideas are carried out in \cite{FH2,FH3}.\par

The series of videos \cite{H-Video}, \cite{A_Video}, \cite{Wehrheim_video},  illustrate the motivation behind the polyfold theory. We also recommend \cite{FFGW} for the intuitive ideas involved in the polyfold theory.\par

Other approaches to the type of problems considered in  applications were put forward in \cite{FO,FOOO}, \cite{LiuT,LT},
\cite{McW,McW2,McW3,McW4},  \cite{Yang, Yang2}, and \cite{Pardon}.
Particularly the carefully written papers by McDuff and Wehrheim are a very good introduction to the finite-dimensional 
Kuranishi-type approaches. The work of Yang is concerned with showing the relationship between the polyfold and Kuranish type 
approaches.

\begin{partbacktext}
\part{Basic Theory in M-Polyfolds}
\noindent In Part I we introduce the notion of an sc-Banach space.  It can be viewed as a Banach space $E$ with an additional structure  provided by a compact scale of Banach spaces. 
Although such gadgets are known from interpolation theory the new viewpoint interprets them as some kind of smooth structure on $E$.  
Then we introduce a new notion of differentiability and the smooth maps in this context are called sc-smooth maps. There are many more sc-smooth maps
than in the usual context of classical differentiability, but still the maps have enough structure to recognize boundaries with corners, unlike homeomorphisms
which only recognize boundaries.  Also the chain rule holds
$$
T(g\circ f)=Tg\circ Tf,
$$
where $Tg$ and $Tf$ are well-defined tangent maps.
 Of particular interest are the sc-smooth maps $r:U\rightarrow U$ which satisfy $r\circ =r$.  They are called sc-smooth retractions.
 
If a subset $O$ of the sc-Banach space $E$  can be written as $O=r(U)$ for some sc-smooth retraction it turns out that the definition $TO:=Tr(TU)$ 
is independent of the sc-smooth retraction onto $O$ and defines what is called the tangent space.  At this point we can take the sc-smooth retracts $O$ as the local models for an extended differential geometry.
One should note that sc-smooth retractions also exist in the classical context, but their images are always submanifolds, so that taking them as local model gives nothing new.
In our context the sc-smooth retracts can be very general. For example there exist finite-dimensional ones with local varying dimensions, which however cannot be embedded smoothly 
into a  finite-dimensional vector spaces.
The new sc-smooth spaces which are build on the new local models are studied in detail.  They can be viewed as a generalization of the standard smooth manifolds.
We shall study sc-smooth subspaces and sc-smooth bundles.  It is clear that taking any classical text book on differentiable manifolds many of the concepts 
can be generalized, and that in addition new concepts arise.  

Since the notion of differentiability is rather weak smooth maps in general do not satisfy an implicit function theorem. However, we are able to identify a class
of smooth maps for which it holds. These will be the so called sc-Fredholm sections. We study these in detail, derive a perturbation and transversality theory
and develop a theory of orientation.  With all these ingredients we obtain the `Fredholm Package' which provides for a Sard-Smale type theory, but in the context 
of much more general spaces. The notion of smoothness is so general that in applications bubbling-off phenomena can be described within this abstract framework.  The basic core ideas go back to \cite{HWZ2,HWZ3}, and 
we refer the reader to \cite{HWZ8.7} and \cite{FFGW} for illustrations of the ideas in concrete contexts.


\end{partbacktext}


\chapter{Sc-Calculus}
The basic concept is the  sc-structure on a Banach space.

\section{Sc-Structures and Differentiability}
We begin with the  linear sc-theory. 
\begin{definition}\label{sc-structure}
A {\bf sc-structure}  \index{D- Sc-Structure} (or scale structure) on a  Banach space $E$ consists of 
a decreasing sequence $(E_m)_{m\geq 0}$ of Banach spaces,   
$$
E=E_0\supset E_1\supset E_2\supset \ldots  ,
$$
such that  the following two conditions are satisfied, 
\begin{itemize}
\item[(1)]\ The inclusion operators $E_{m+1}\rightarrow E_m$ are  compact.
\item[(2)]\ The intersection $E_\infty:=\bigcap_{i\geq 0} E_i$\index{$E_i,\ E_{\infty}$} is dense in every $E_m$.
\end{itemize}
\qed
\end{definition}

Sc-structures, where ``sc'' is short for scale, are known from  linear interpolation theory, see \cite{Tr}. However, our  interpretation is that of a smooth structure.    It should be noted that scales have been used in geometric settings
  before; see for example the work by D. Ebin,  \cite{Ebin},  and
  H. Omori, \cite{Omori}\footnote{The first author thanks T. Mrowka for pointing out these two references.}.
The latter of these is somewhat closer to the viewpoint in our paper.
  However Omori does not use \emph{compact} scales, and this turns out
  to be a crucial condition for our applications. 
Without the compactness assumption the maps we shall be considering do not satisfy the chain rule.
 Moreover, one does not obtain the
  new local models (the sc-smooth retracts)  for a generalized differential geometry in which 
  bubbling-off and trajectory-breaking is a smooth phenomenon.

In the following, a sc-Banach space or a sc-smooth Banach space stands for a Banach space equipped with a sc-structure.
A finite-dimensional Banach space $E$  has precisely one sc-structure, namely the constant structure $E_m=E$ for all $m\geq0$.  If $E$ is an infinite-dimensional Banach space, the constant structure is not a sc-structure, because it fails property (1).  We shall see that the sc-structure leads to interesting new phenomena in nonlinear analysis.



Points in $E_\infty$ are called {\bf smooth points}, points in $E_m$ are called points of {\bf regularity $m$}\index{Points of regularity $m$}. A subset $A$ of a sc-Banach space $E$ inherits a filtration  $(A_m)_{m\geq 0}$ defined by $A_m=A\cap E_m$. It is, of course, possible that $A_\infty=\emptyset $.   We adopt the convention that 
$A^k$ stands for the set $A_k$ equipped with the induced filtration  
$$(A^k_m)_{m\geq 0}=(A_{k+m})_{m\geq 0}.$$
The direct sum $E\oplus F$ of sc-Banach spaces is a sc-Banach space, whose sc-smooth structure is defined by $(E\oplus F)_m:=E_m\oplus F_m$ for  all $m\geq 0$.

\begin{example}\label{sc-example1}
An example of a sc-Banach space, which is relevant in applications, is as follows.  We choose a strictly increasing sequence $(\delta_m)_{m\geq 0}$  of real numbers starting with $\delta_0=0$.  
We consider the Banach spaces  (in fact Hilbert spaces)  $E=L^2(\R\times S^1)$ and  $E_m=H^{m,\delta_m}(\R\times S^1)$, where  the space  $H^{m,\delta_m}(\R\times S^1)$ consists of those  elements in $E$  having
 weak  partial derivatives up to order $m$ which, if  weighted by $e^{\delta_m |s|}$, belong to $E$.  Using Sobolev's compact embedding theorem for bounded domains and the assumption that the sequence $(\delta_m)$ is strictly increasing, one sees that the sequence $(E_m)_{m\geq 0}$ defines a  sc-structure on  $E$. 
 \qed
\end{example}




\begin{definition}  A linear operator $T\colon 
E\rightarrow F$ between sc-Banach spaces is called a {\bf sc-operator},  \index{D- Sc-operator}  if  $T(E_m)\subset F_m$ and the induced operators $T\colon 
E_m\rightarrow F_m$  are continuous for all $m\geq 0$.  A linear {\bf sc-isomorphism}\index{D- Sc-isomorphism}  is a bijective sc-operator whose  inverse is also a sc-operator. 
\qed
\end{definition}

A special class of linear sc-operators  are $\ssc^+$-operators,  defined as follows.
\begin{definition}\label{sc_plus_operators}
 A sc-operator $S\colon 
E\to F$ between sc-Banach spaces  is called a {\bf $\ssc^{\pmb{+}}$-operator}\index{D- Sc$^+$-operator},  if 
 $S(E_m)\subset F_{m+1}$  and  $S\colon 
E\rightarrow F^1$ is a sc-operator.
\qed
\end{definition}
In view of Definition \ref{sc-structure}, the inclusion operator $F_{m+1}\to F_m$ is compact, implying that a $\ssc^+$-operator $S\colon 
E\to F$ is a sc-compact operator  in the sense that  $S\colon 
E_m\to F_m$ is compact for every $m\geq 0$. Hence, given a sc-operator $T\colon 
E\rightarrow F$ and a sc$^+$-operator $S\colon 
E\rightarrow F$, the 
 operator $T+S$ can be viewed, on every level, as a  perturbation of $T$ by the compact operator $S$.
 

\begin{definition}\label{sc-subspace}
A subspace   $F$ of a sc-Banach space  $E$ is called a {\bf sc-subspace}\index{D- Sc-subspace}, provided $F$ is closed
and the sequence $(F_m)_{m\geq 0}$ given by  $F_m=F\cap E_m$ defines  a sc-structure on $F$.
\qed
\end{definition} 

A sc-subspace $F$ of the sc-Banach space $E$ has a sc-complement provided there exists an algebraic complement $G$ of $F$ so that $G_m=E_m\cap G$
defines an sc-structure on $G$, such  that on every level $m$ we have a topological direct sum 
$$E_m=F_m\oplus G_m.$$
Such a splitting $E=F\oplus G$\index{$E\oplus F$} is called a {\bf sc-splitting}\index{Sc-splitting}. 

The following result from \cite{HWZ2}, Proposition 2.7, 
will be used frequently.
\begin{proposition}\label{prop1}\index{P- Finite-dimensional sc-subspaces}
Let $E$ be a sc-Banach space. A finite-dimensional subspace $F$ of $E$  is a sc-subspace  if and only if $F$ belongs to $E_\infty$.
A finite-dimensional sc-subspace always  has a sc-complement.
\end{proposition}
\begin{proof}
If $F\subset E_\infty$, then $F_m:=F\cap E_m=F$ and $F$ is equipped with the constant sc-structure, so that $F$ is a sc-subspace of $E$. Conversely, 
if $F$ is a sc-subspace, then, by definition,  $F_\infty:=\bigcap_{m\geq 0}F_m=F\cap E_\infty$ is dense in $F$.  Consequently, $F=F_\infty\subset E_\infty$, since $F$ and $F_\infty$ are finite dimensional.  

Next,  let $e_1,\ldots , e_k$ be a basis for a finite-dimensional sc-subspace $F$. In view of the above discussion, $e_i\in E_\infty$. By the  Hahn-Banach theorem, the dual basis  can be extended to linear functionals $\lambda_1,\ldots ,\lambda_k$, which are continuous on $E$ and hence on $E_m$ for every $m$. The map $P\colon 
E\to E$,  defined by $P(x)=\sum_{1\leq i\leq k}\lambda_i(x)e_i$,  has its image in $F\subset E_\infty$. It induces a continuous map from $E_m$ to $E_m$,  and since $P\circ P=P$, it is a sc-projection. Introduce the closed subspace $G:=(\mathbbm{1}-P)(E)$ and let $G_m=G\cap E_m$. Then $E=F\oplus G$ and $G_{m+1}\subset G_m$.  The set $G_\infty:=\bigcap_{m\geq 0}G_m=G\cap E_\infty$ is also dense in $G_m$. Indeed, if $g\in G_m$, we find a sequence $f_n\in E_\infty$, such that $f_n\to g$ in $E_m$. Setting $g_n:=(\mathbbm{1}-P)(f_n)\in G_\infty$ we have $g_n\to (\mathbbm{1}-P)(g)=g$, as claimed.  Consequently, $(G_m)_{m\geq 0}$ defines a sc-structure on $G$ and the proof of the proposition is complete.
 \qed \end{proof}
Next we describe  the quotient construction in the sc-framework. 

\begin{proposition}\label{thm_quotient}\index{P- Sc-quotients}
Assume that $E$ is a sc-Banach space and $A\subset E$ a sc-subspace. Then $E/A$ equipped with the 
filtration $E_m/A_m$ is a sc-Banach space. Note that $E_m/A_m= \{ (x+ A)\cap E_m \,  \vert \, x\in E\}$.
\end{proposition}
\begin{proof}
By definition of a sc-subspace,  the filtration on $A$ is given by $A_m=A\cap E_m$ and $A_m\subset E_m$ is a closed subspace.
Hence 
$$
E_m/A_m = E_m/(A\cap E_m) = \{ (x + A)\cap E_m\, \vert \, x\in E_m\}.
$$
We identify an element $x+A_m$ in $E_m/A_m$ with the  element $x+A$ of  $E/A$, so that algebraically we can view
$E_m/A_m\subset E/A$.
The inclusion $E_{m+1}\rightarrow E_m$ is compact,  implying that the quotient map  $E_{m+1}\rightarrow E_m/A_m$ is compact.  We claim that the inclusion map 
$E_{m+1}/A_{m+1}\rightarrow E_m/A_m$ is compact. In order to show this, we take a sequence $(x_k+A_{m+1})\subset E_{m+1}/A_{m+1}$ satisfying 
$$
\norm{x_k+A_{m+1}}_{m+1}:=\inf \{ \abs{x+a|_{m+1}}\, \vert \, a\in A_{m+1}\}\leq 1, 
$$
and choose a sequence $(a_{k})$ in $A_{m+1}$ such that  $\abs{x_k+a_k}_{m+1}\leq 2$. 
We may assume, after taking a subsequence,  that $x_k+a_k\rightarrow x\in E_{m}$. 
The image of the sequence $(x_k+A_{m+1})$
under the inclusion $E_{m+1}/A_{m+1}\rightarrow E_m/A_m$ is the sequence $(x_k+a_k+A_m)$. Then
\begin{equation*}
\begin{split}
&\norm{(x_k+a_k+A_{m})-(x+A_m)}_m\\
&\quad =\norm{(x_k+a_k-x)+A_m}_m\\
&\quad =\inf\{\abs{x_k+a_k-x)+a}_m\, \vert \,  a\in A_m\}\\
&\quad\leq \abs{x_k+a_k-x}_m\to  0,
\end{split}
\end{equation*}
showing  that  the inclusion  $E_{m+1}/A_{m+1}\rightarrow E_m/A_m$ is compact. Finally let us show that $\bigcap_{j\geq 0} (E_j/A_j)$ is dense in every $E_m/A_m$.
Let us first note that $(E/A)_\infty:=\bigcap_{j\geq 0} (E_j/A_j)$ consists of all elements of the form $x+A_\infty$ with $x\in E_\infty$.
Since $E_\infty$ is dense in $E_m$,  the image under the continuous quotient map $E_m\rightarrow E_m/A_m$ is dense. This completes the proof of 
Proposition \ref{thm_quotient} 
\qed \end{proof}


A distinguished class of sc-operators is the class of sc-Fredholm operators.
\begin{definition}
A sc-operator $T\colon 
E\rightarrow F$  between sc-Banach spaces is called  {\bf sc-Fredholm}\index{D- Sc-Fredholm operator},  provided there exist sc-splittings $E=K\oplus X$ and $F=C\oplus Y$, having the following properties.
\begin{itemize}
\item[(1)]\ $K$ is the kernel of $T$ and is finite-dimensional.
\item[(2)]\  $C$ is finite-dimensional and  $Y$ is the image of $T$.
\item[(3)]\ $T\colon 
X\rightarrow Y$ is a sc-isomorphism.
\end{itemize}
\qed
\end{definition}
In view of Proposition \ref{prop1}  the definition implies that the kernel $K$ consists of smooth points and $T(X_m)=Y_m$ for all $m\geq 0$.  In particular,  we have the topological direct sums
$$
E_m=K\oplus X_m\quad  \text{and}\quad \ F=C\oplus T(E_m).
$$
The index of a sc-Fredholm operator $T$,  denoted by $\ind(T)$, is  as usual defined  by
$$
\ind (T)=\dim(K)-\dim(C).\index{$\ind (T)$}
$$
Sc-Fredholm operators have the following regularizing property.
\begin{proposition}\label{regular}\index{P- Regularizing property}
A sc-Fredholm operator  $T\colon 
E\rightarrow F$ is regularizing, i.e. if $e\in E$ satisfies $T(e)\in F_m$,  then $e\in E_m$.
\end{proposition}
\begin{proof}
By assumption,  $T(e)\in F_m=C\oplus T(X_m)$, so that $T(e)=T(x)+c$ for some $x\in X_m$ and $c\in C$.
Then $T(e-x)=c$ and $e-x\in E_0$. Since $T(E_0)\oplus C=F_0$ it follows that $c=0$ and $e-x\in  K\subset E_\infty$, implying that $x$ and $e$ are on the same level $m$. 
\qed \end{proof}

The following stability result will be crucial later on. The proof, reproduced in Appendix \ref{A1.0},  is taken from \cite{HWZ2},  Proposition 2.1.\begin{proposition}[Compact Perturbation]\label{prop1.21}\index{P- sc$^+$-perturbations}
Let $E$ and $F$ be sc-Banach spaces. If $T\colon 
E\rightarrow F$ is a
sc-Fredholm operator and $S\colon 
E\rightarrow F$ a sc$^+$-operator, then
$T+S$ is also a  sc-Fredholm operator.
\qed
\end{proposition}



The next concept will be crucial later on for the definition of boundaries.

\begin{definition}\label{partial_quadrant}
A {\bf partial quadrant} \index{D- Partial Quadrant}  
in a sc-Banach space $E$  is  a closed convex subset $C$ of $E$, 
such that  there exists a sc-isomorphism $T\colon 
E\rightarrow {\mathbb R}^n\oplus W$ satisfying   $T(C)=[0,\infty)^n\oplus W$.
\qed
\end{definition}


We now consider tuples $(U,C,E)$\index{$(U,C,E)$}, in which  $U$ is a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$.  
\begin{definition}\label{sc_continuous}
If  $(U, C, E)$ and $(U', C', E')$ are two such  tuples, then a  map $f\colon 
U\rightarrow U'$ 
is called {\bf  $\ssc^0$}  (or of {\bf class $\ssc^0$}, or {\bf sc-continuous}),  provided $f(U_m)\subset V_m$ and the induced maps $f\colon 
U_m\rightarrow V_m$ are  continuous for all $m\geq 0$. 
\qed
\end{definition}

\begin{definition}\label{sc-tangent}\index{D- Tangent tuple} 
The tangent $T(U,C,E)$ of the tuple  $(U,C,E)$ is defined as the tuple 
$$
T(U,C,E)=(TU,TC,TE)\index{$T(U,C,E)$}
 $$where
$$
TU=U^1\oplus E,\quad  TC=C^1\oplus E, \quad  \text{and}\quad  TE=E^1\oplus E.
$$
\qed
\end{definition}
Note that $T(U,C,E)$ is a tuple  consisting again  of a relatively open subset $TU$ in the  partial quadrant $TC$ in  the sc-Banach space $TE$.

Sc-differentiability is a  new notion of differentiability in sc-Banach spaces, which is considerably weaker than
the familiar  notion of Fr\'echet differentiability. The new notion of differentiability is the following.

\begin{definition}\label{scx}\index{D- Sc-differentiability}
We consider  two tuples $(U,C,E)$ and $(U',C',E')$  and a map $f\colon U\to U'$. The map $f$ is called $\pmb{\ssc^{1}}$ (or of {\bf class} $\pmb{\ssc^{1}}$)  provided
the following conditions are satisfied.
\begin{itemize}
\item[(1)]\ The map $f$ is $\ssc^0$.
\item[(2)]\ For every $x\in U_1$ there exists a bounded linear operator $Df(x)\colon E_0\to F_0$ such  that
for $h\in E_1$ satisfying  $x+h\in U_1$,
$$
\lim_{\abs{h}_1\rightarrow 0} \frac{ \abs{f(x+h)-f(x)-Df(x)h}_0}{\abs{h}_1}=0.
$$
\item[(3)]\ The map $Tf\colon TU\to TU'$,  defined by 
$$Tf(x,h)=(f(x),Df(x)h), \quad \text{$x\in U^1$ and $h\in E$}, $$
 is a  $\ssc^0$-map.
The map $Tf\colon TU\to TU'$ is called the {\bf tangent map} of $f$.
\end{itemize}
\qed
\end{definition}

\begin{remark}\index{R- Important remark about (non-)continuity of $Df(x)$} In general,  the map $U_1\to   \mathscr{L}(E_0,F_0)$, defined by $x\to  Df(x)$,  will not(!) be continuous, if the space of bounded linear operators is equipped with the operator norm. However,  if we equip it with the compact open topology it will be continuous. The $\ssc^1$-maps between finite dimensional Banach spaces are the familiar $C^1$-maps.
\qed
\end{remark}

Proceeding inductively,  we define  what it means for  the map $f$  to be  $\ssc^k$ or $\ssc^\infty$. Namely, a $\ssc^0$--map $f$ is said to be a $\ssc^2$--map, if  it is $\ssc^1$ and if  its tangent map $Tf\colon 
TU\to TV$ is  $\ssc^1$. By Definition \ref{scx} and Definition \ref{sc-tangent},  the  tangent map of $Tf$,
$$T^2f\colon 
=T(Tf)\colon 
T^2(U)=T(TU)\to T^2(V)=T(TV),$$
is of class $\ssc^0$.
If the tangent map $T^2f$  is $\ssc^1$, then $f$ is said to be $\ssc^3$,  and so on. The map $f$ is 
{\bf $\ssc^{\pmb{\infty}}$} or {\bf $\ssc$-smooth}, if it is $\ssc^k$ for all $k\geq 0$.
\begin{remark}\index{R- Possible generalizations of domains} \label{rem116}
The above consideration can be generalized. Instead of taking a partial quadrant $C$ one might take a closed convex partial cone $P$ with nonempty interior. This means $P\subset E$ is a closed subset, so that for a real number $\lambda\geq 0$ it holds $\lambda\cdot P\subset P$. Moreover $P$ is convex and has a nonempty interior. If then $U$ is an open subset of $P$ we can define the notion of being sc$^1$ as in the previous definition. The tangent map $Tf$ is then defined on $TP=P^1\oplus E$. We note that $TP$ is a closed cone with nonempty interior. In this context one should be able to deal with 
sc-Fedholm problems, on M-polyfolds with `polytopal' boundaries and even more general situations.
Many of the results in this book can be carried over to this generality as well, but one should check carefully which arguments carry over.
\qed
\end{remark}

\begin{remark}\index{R- Other notions of differentiability: ssc-smoothness}\label{rem117}
Let us mention that there is, of course, also a stronger notion of differentiability which resembles the classical notion.
Namely consider $f:U\rightarrow U'$, where $(U,C,E)$ and $(U',C',D')$  are as in Definition \ref{scx}. We say that $f$ is  ssc$^{1}$
provided id is sc$^0$ and for every $m$ the map $f:U_m\rightarrow U_m'$ is $C^1$, i.e. once continuously differentiable.
Similarly we can define being of class ssc$^k$ and ssc$^\infty$.  The theory associated to this notion of differentiability runs completely parallel 
to the study of classically smooth maps between Banach spaces and there are no surprises. This theory is, of course,  useful in applications as well. To work out the sc-results 
presented later on  in the ssc-framework is left to the reader. Note that {\bf ssc} stands for {\bf strong sc}.
\qed
\end{remark}

\section{Properties of Sc-Differentiability}

In this section we  shall discuss the relationship between the classical smoothness in the Fr\'echet sense and the sc-smoothness. The proofs of the following results can be found  in  \cite{HWZ8.7}.


\begin{proposition}[{\bf Proposition 2.1, \cite{HWZ8.7}}] \label{x1}\index{P- Sc-differentiability}
Let $U$ be a relatively open subset of a partial  quadrant in  a sc-Banach space $E$ and let $F$ be another $\ssc$-Banach space. 
Then a  $\ssc^0$-map $f\colon 
U\to F$ is of class $\ssc^1$  if and only if  the following conditions hold true.
\begin{itemize}\label{sc-100}
\item[(\em{1})]\ For every $m\geq 1$,  the induced map
$f\colon 
U_m\to  F_{m-1}$
is of class $C^1$. In particular,  the derivative  
$$
df\colon 
 U_m\to  \mathscr{L}(E_m,F_{m-1}),\quad x\mapsto df(x)
$$
is a  continuous map.
\item[(\em{2})]\ For every  $m\geq 1$ and every $x\in U_m$,  the bounded  linear operator
$df(x)\colon 
 E_m\to F_{m-1}$ has an extension to a bounded  linear operator $Df(x)\colon 
E_{m-1}\to F_{m-1}$. In addition, the map
\begin{equation*}
U_m\oplus  E_{m-1}\to  F_{m-1}, \quad  (x,h)\mapsto  Df(x)h
\end{equation*}
is continuous.
\end{itemize}
\qed
\end{proposition}

In particular, if $x\in U_\infty$ is  a smooth point in $U$  and $f\colon 
U\to F$ is a $\ssc^1$-map, then the linearization 
$$Df(x)\colon E\to F$$
is a sc-operator.

A  consequence of Proposition \ref{x1} is the following result about lifting the indices.
\begin{proposition}[{\bf Proposition 2.2, \cite{HWZ8.7}}] \label{sc_up}\index{P- Sc-differentiability under lifts}
Let  $U$  and $V$ be  relatively open subsets of partial quadrants in sc-Banach spaces, and let $f\colon 
U\rightarrow V$ be $\ssc^k$. 
Then $f\colon 
U^1\rightarrow V^1$ is also $\ssc^k$.
\qed
\end{proposition}


\begin{proposition}[{\bf Proposition 2.3, \cite{HWZ8.7}}] \label{lower}\index{P- Sc-smoothness versus $C^k$}
Let $U$ and $V$ be relatively open subsets of partial quadrants in sc-Banach spaces.
If $f\colon 
U\to  V$ is $\ssc^k$, then for every $m\geq 0$,  the map $f\colon 
U_{m+k}\to  V_m$ is of class $C^k$.  Moreover,  $f\colon 
U_{m+l}\to  V_m$ is of class $C^l$ for every $0\leq l\leq k$.
\qed
\end{proposition}

The next result is very useful in proving that a given map between sc-Banach spaces is sc-smooth.
\begin{proposition}[{\bf Proposition 2.4, \cite{HWZ8.7}}] \label{ABC-x}
Let $U$ be a relatively open subset of a partial  quadrant in  a sc-Banach space $E$ and let $F$ be another $\ssc$-Banach space. 
Assume that for every $m\geq 0$ and $0\leq l\leq k$,  the map $f\colon 
U\rightarrow V$  induces  a map
$$
f\colon 
U_{m+l}\rightarrow  F_m,
$$
which is of  class $C^{l+1}$. Then $f$ is $\ssc^{k+1}.$
\qed
\end{proposition}

In the case that the target  space $F= \R^N$, Proposition \ref{ABC-x} takes the following form.
\begin{corollary}[{\bf Corollary 2.5, \cite{HWZ8.7}}] \label{ABC-y}
Let $U$ be a  relatively open subset of a partial quadrant in a sc-Banach space and  $f\colon 
U\to  \R^N$. If 
for some $k$ and all $0\leq l \leq k$ the map $f\colon 
U_l \to  \R^N$ belongs to  $C^{l +1}$, then $f$ is $\ssc^{k+1}$.
\qed
\end{corollary}



\section{The Chain Rule and Boundary Recognition}\label{subsection_boundary_recognition}
The cornerstone of the sc-calculus, the chain rule, holds true.
\begin{theorem}[{\bf Chain Rule}]\label{sccomp}\index{T- Chain rule}
Let $U\subset C\subset E$ and $V\subset D\subset F$ and $W\subset Q\subset G$ be relatively open subsets
of partial quadrants in sc-Banach spaces and let $f\colon 
U\rightarrow V$ and $g\colon 
V\rightarrow W$ 
be $\ssc^1$-maps.
Then the composition $g\circ f\colon 
U\rightarrow W$ is also $\ssc^1$ and
$$
T(g\circ f) =(Tg)\circ (Tf).
$$
\qed
\end{theorem}
The result is  proved in \cite{HWZ2} as  Theorem 2.16 for open sets $U$, $V$ and $W$.
We give the adaptation to the somewhat more general setting here. The proof, which is given in Appendix \ref{A1.1},  is very close 
to the one in \cite{HWZ2} and does not require any new ideas.

\begin{remark}\index{R- Remark on chain rule}
The result is somewhat surprising, since differentiability is only guaranteed
under the loss of one level $U_1\rightarrow F_0$, so that one might expect
 for a composition a loss of two levels. However, one is saved
by the compactness of the embeddings $E_{m+1}\rightarrow E_m$.
\qed
\end{remark}

The next basic result concerns  the boundary recognition. Let $C$ be a partial quadrant in the  sc-Banach space  $E$. 
We choose a linear $\ssc$-isomorphism $T\colon 
E\to  \R^k\oplus W$ satisfying $T(C)=[0,\infty)^k\oplus W$. 
If $x\in C$,  then 
$$T(x)=(a_1, \ldots, a_k, w)\in [0,\infty )^k\oplus W,$$
and we define the integer $d_C(x)$ by 
$$
d_C(x)\colon 
=\#\{i\in \{1,\ldots, k\}\vert \, a_i=0\}.$$
\begin{definition}\label{degeneracy_index_1}\index{D- Degeneracy index}
The map $d_C\colon 
C\rightarrow {\mathbb N}$ is called the {\bf degeneracy index}.
\qed
\end{definition}

Points $x\in C$ satisfying $d_C(x)=0$\index{$d_C$} are interior points of $C$, the  points satisfying  $d_C(x)=1$ are honest boundary points, and the  points with $d_C(x)\geq 2$ are corner points. The size of the index gives the complexity of the corner.


It is not difficult to see that this definition is independent of  the choice of a sc-linear isomorphism $T$.
\begin{lemma}\label{corner_recognition_linear}
The  map  $d_C$  does not depend on the choice of a linear sc-isomorphism $T$.
\qed
\end{lemma}
The proof is given in Appendix \ref{A1.2}.


\begin{theorem}\label{ppp22}\index{T- Corner recognition}
Given the tuples $(U, C, E)$ and $(U', C', E')$ and a germ  $f\colon 
(U,x)\rightarrow (U',x')$ of a local sc-diffeomorphism satisfying $x'=f(x)$, then
$$d_C(x)=d_{C'}(f(x)).$$
\qed
\end{theorem}

The proof of a more general result is given in \cite{HWZ2}, Theorem 1.19. 
We  note that sc-smooth diffeomorphisms recognize  boundary points and corners, whereas
homeomorphisms recognize only  boundaries, but no corners.


\section{Appendix}
\subsection{Proof of the sc-Fredholm Stability Result}\label{A1.0}
\begin{proof}[Proposition \ref{prop1.21}]
Since $S\colon 
E_m\rightarrow F_m$ is compact for every level,  the operator 
$T+S\colon 
E_m\rightarrow F_m$ is Fredholm for every $m$. Denoting  by $K_m$ the
kernel of this operator,  we claim that $K_{m}=K_{m+1}$ for every $m\geq 0$. Clearly, $K_{m+1}\subseteq K_{m}$. If  $x\in K_m$,  then  $Tx=-Sx\in F_{m+1}$ and hence, by Proposition \ref{regular},
$x\in E_{m+1}$. Thus $x\in K_{m+1}$, implying  $K_m\subseteq K_{m+1}$, so that  $K_m=K_{m+1}$. Set $K=K_0$.  By
Proposition \ref{prop1}, $K$ splits the sc-space $E$,  since it is a
finite dimensional subset of $E_{\infty}$. Therefore, we have the
sc-splitting $E=K\oplus X$  for a suitable sc-subspace  $X$ of $E$. 


Next define $Y=(T+S)(E)=(T+S)(X)$ and $Y_m\colon 
=Y\cap F_m$ for $m\geq 0$.  Since $T+S\colon 
E\to F$ is Fredholm,  its  image $Y$ is closed.  We claim, that the set  $Y_\infty$, defined by $Y_\infty:=\bigcap_{m\geq 0}Y_m=Y\cap F_\infty$,  is dense in  $Y_m$ for every $m\geq 0$. Indeed, if $y\in Y_m$, then $y=(T+S)(e)$ for some $e\in E$. Since  by Proposition \ref{regular}, $T$ is regularizing, we conclude that $e\in E_m$. Since $E_\infty$ is dense in $E_m$,  there exists a sequence $(e_n)\subset E_\infty$ such that $e_n\to e$ in $E_m$. Then, setting $y_n:=(T+S)(e_n)\in Y_\infty$, we conclude that $y_n\to (T+S)(e)=y$, which shows that $Y_\infty$ is dense in $Y_m$.  Finally, we consider the projection map $p\colon 
F\to  F/Y$. Since $p$  is a continuous surjection onto a finite-dimensional space and $F_\infty$ is dense in $F$, it follows that $\ov{p(F_\infty)}=F/Y$.  Hence, we can choose  a basis in $F/Y$ whose representatives belong to $F_\infty$.  Denoting by  $C$ the span of these representatives, we obtain  $F_m=Y_m\oplus C$.   Consequently, we have a sc-splitting $F=Y\oplus C$ and the proof of Proposition \ref{prop1.21} is complete.
\qed \end{proof}

\subsection{Proof of the Chain Rule}\label{A1.1}
\begin{proof}[Theorem \ref{sccomp}]
The maps 
 $f\colon 
U_1\to F$ and $g\colon 
V_1\to G$  are of class $C^1$ in view of Proposition \ref{lower}. Moreover, $Dg(f(x))\circ Df(x)\in \mathscr{L}(E, G)$, if
$x\in U_1$. Fix $x\in U_1$ and 
 $h\in E_1$ sufficiently small satisfying $x+h\in U_1$ and  $f(x+h)\in V_1$.
Then, using  the postulated
properties of $f$ and $g$,
\begin{equation*}
\begin{split}
&g(f(x+h))-g(f(x))-Dg(f(x))\circ Df(x)h\\
&=\int_{0}^{1} Dg(tf(x+h)+(1-t)f(x))\ [f(x+h)-f(x)-Df(x)h] dt\\
&\phantom{=}+\int_{0}^{1}\bigl( [Dg(tf(x+h)+(1-t)f(x))-Dg(f(x))] \circ Df(x)h \bigr)dt.
\end{split}
\end{equation*}
The first integral after dividing by $\abs{h}_1$ takes the form
\begin{equation}\label{integral1}
\int_{0}^{1} Dg(tf(x+h)+(1-t)f(x)) \frac{f(x+h)-f(x)-Df(x)h}{\abs{h}_1}\  dt.
\end{equation}
For  $h\in E_1$ such that  $x+h\in U_1$ and $\abs{h}_1$ is small, we have that $tf(x+h)+(1-t)f(x)\in V_1$. Moreover, the maps
$
[0,1]\rightarrow F_1$ defined by $t\mapsto tf(x+h)+(1-t)f(x)
$
are continuous and converge in $C^0([0,1],F_1)$
to the constant map
$t\mapsto  f(x)$ as  $\abs{h}_1\rightarrow 0$.
Since $f$ is  of class $\ssc^1$, the quotient
 $$
a(h)\colon 
=\frac{ f(x+h)-f(x)-Df(x)h}{\abs{h}_1}$$
converges  to $0$ in $F_0$  as $\abs{h}_1\to 0$. Therefore, by the continuity assumption (3) in Definition \ref{scx},
 the map $$
(t,h)\mapsto  Dg(tf(x+h)+(1-t)f(x)) [a(h)],
$$
as a map from $[0,1]\times E_1$ into $G_{0}$, converges to $0$ as
$\abs{h}_1\to 0$  uniformly in $t$.
Consequently,   the expression in \eqref{integral1}  converges to $0$ in $G_0$ as $\abs{h}_1\to 0$, if  $x+h\in U_1$.
Next we 
consider the integral
\begin{equation}\label{integral2}
\int_{0}^{1} \bigl[  Dg(tf(x+h)+(1-t)f(x))-Dg(f(x))\bigr] \circ Df(x)
\frac{h}{\abs{h}_{1}}\ dt.
\end{equation}
By Definition \ref{sc-structure},  the inclusion operator $E_1\to E_0$ is compact,  so that 
the set of all $\frac{h}{\abs{h}_{1}}\in E_1$ has  a compact closure in $E_{0}$.  Therefore, since $Df(x)\in \mathscr{L}(E_{0}, F_{0})$ is a continuous map  by Definition \ref{scx},  the closure of
the set of all
$$
Df(x) \frac{h}{ \abs{h}_{1}}
$$
is compact  in $F_{0}$. Consequently, again by  Definition \ref{scx}, every sequence $(h_n)\subset E_1$, satisfying $x+h_n\in U_1$ and $\abs{h_n}_1\to 0$, possesses a subsequence having the property that the integrand of the integral in \eqref{integral2} converges to $0$ in $G_{0}$ uniformly in $t$. Hence, the integral \eqref{integral2} also  converges to $0$ in $G_0$, as $\abs{h}_1\to 0$ and  $x+h\in U_1$.  We
have proved  that
$$
\frac{\abs{g(f(x+h))-g(f(x))-Dg(f(x))\circ Df(x)h}_{0}}{\abs{h}_{1}}\rightarrow 0
$$
as $\abs{h}_1\to 0$  and  $x+h\in U_1$.   Consequently,  condition (2) of Definition \ref{scx} is satisfied for the composition $g\circ f$ with the linear operator
$$D(g\circ f)(x)=Dg(f(x))\circ Df(x)\in  \mathscr{L}(E_0, G_0),
$$
where $x\in U_1$. We conclude that the tangent map
$T(g\circ f)\colon 
TU\to TG$,
$$(x, h)\mapsto (\ g\circ f(x), D(g\circ f)(x)h\ )$$
is $\ssc$-continuous and, moreover,
$T(g\circ f)=Tg\circ Tf$. The proof of Theorem  \ref{sccomp} is complete.
\qed \end{proof}

\subsection{Proof Lemma \ref{corner_recognition_linear} }\label{A1.2}
\begin{proof}[Lemma \ref{corner_recognition_linear}]
We take a second sc-isomorphism  $T'\colon 
E\to \R^{k'}\oplus W'$,   satisfying $T'(C)=[0,\infty)^{k'}\oplus W'$ and first show  that $k=k'$. 
We consider the composition $S=T'\circ T^{-1}\colon 
\R^k\oplus W\to \R^{k'}\oplus W'$, where  $S$ is a sc-isomorphism, mapping 
$[0,\infty )^k\oplus W\to [0,\infty )^{k'}\oplus W'$. We claim that  $S(\{0\}^k\oplus W)=\{0\}^{k'}\oplus W'$.  Indeed,  suppose $S(0, w)=(a, w')$ for some $(a, w')\in [0,\infty)^{k'}\oplus W'$.
Then,  we conclude 
$$S(0, tw)= tS(0, w)=t(a, w')=(ta, tw')\in  [0,\infty)^{k'}\oplus W'$$
for all $t\in \R$.  Consequently, $a=0$. Hence, $S(\{0\}^k\oplus W)\subset \{0\}^{k'}\oplus W'$ and since $S$ is an isomorphim, we obtain equality of these sets.  
The set  $\{0\}^k\oplus W\equiv W$ has codimension $k$ in $\R^k\oplus W$, and since $S$ is an isomorphism  we have 
$$S(\R^k\oplus W)=S(\R^k\oplus \{0\})\oplus S(\{0\}^k\oplus W)=S(\R^k\oplus \{0\})\oplus ( \{0\}^{k'}\oplus W'),$$
so that the codimension of $ \{0\}^{k'}\oplus W'$ in $\R^{k'}\oplus W'$ is equal to $k$. On the other hand, this codimension is equal to $k'$. Hence $k'=k$, as claimed.
To prove our result, it now suffices  to show that if $x=(a, w)\in [0,\infty )^k\oplus W$ and $y=S(x)=(a', w')$, then 
\begin{equation}\label{independence_0}
\# I(x)=\# I' (y)
\end{equation}
where $I(x)$ is the set of indices $1\leq i\leq k$ for which $x_i=0$. The set $I'(y)$ is defined similarly. With $I(x)$ we associate the subspace $E_x$ of $\R^k\oplus W$, 
\begin{align*}
E_x&=\{(b, v)\in R^k\oplus W\vert \,\text{$b_i=0$ for all $i\in I(x)$}\}.
\end{align*}
The set $E'_{y}$ is defined analogously. Observe that $\# I(x)$ is equal to the codimension of $E_x$ in $\R^k\oplus W$.  In order to prove \eqref{independence_0}, it is enough to show that 
$S(E_x)\subset E'_y$. If this is the case, then,  since $S$ is an isomorphism, we obtain $S(E_x)=E'_y$,  which shows that the codimensions of $E_x$ and $E'_y$ in $\R^k\oplus W$ and $\R^{k'}\oplus W'$, respectively, are the same. Now, to see that $S(E_x)\subset E'_y$, we take $u=(b, v)\in E_x$ and note that $x+tu\in [0,\infty)\oplus W$ for $\abs{t}$ small. Then, 
$S(x+tu)=S(x)+tS(u)=y+tS(u).$ If $i\in I'(y)$, then $(S(x+tu))_i=y_i+t(S(u))_i=t(S(u))_i\in [0,\infty)^k\oplus W'$, which is only possible if  $(S(u))_i=0$.  Hence, $S(E_x)\subset E'_y$ and the proof is complete.
\qed \end{proof}


\chapter{Retracts}
The crucial  concept of this book is that of a sc-smooth retraction, which we  are going to introduce next.
\section{Retractions and Retracts}\label{section2.1}
In this subsection we introduce several basic  concepts.
\begin{definition} \label{sc-smooth_retraction}\index{D- Sc-smooth retraction}
We consider a tuple $(U, C, E)$ in which $U$ is a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$. A sc-smooth map $r\colon U\to U$ is called 
a {\bf sc-smooth retraction}  on $U$, if 
$$
r\circ r=r.
$$
\qed
\end{definition}

As a side remark, we observe that  if $U$ is an open subset of a Banach space $E$ and $r\colon U\rightarrow U$ is a $C^\infty$-map (in the classical sense) satisfying $r\circ r=r$, then the image of $r$ is a smooth submanifold of the Banach space $E$, as the following proposition shows. 


\begin{proposition}\label{smooth_retract}\index{Cartan's last theorem}
Let $r\colon 
U\to U$ be a $C^\infty$-retraction defined on an open subset $U$ of a Banach space $E$. Then $O:=r(U)$ is a $C^\infty$-submanifold of $E$. More precisely, for  every point $x\in O$,  there exist an open neighborhood  $V$ of $x$ and  an open neighborhood $W$  of $0$ in $E$, a splitting $E =R \oplus N$, and a smooth diffeomorphism 
$\psi \colon 
 V\to  W$  satisfying  $\psi (0)=x$ and 
$$\psi (O\cap V ) = R \cap W.$$
\qed
\end{proposition}
An elegant proof is due to Henri Cartan in \cite{H.Cartan}\footnote{The first author would like to thank E. Ghys for pointing out this reference during his visit at IAS in 2012. It seems that this is H. Cartan's last mathematical paper.}.


In sharp contrast to the conclusion of this proposition from classical differential geometry,  there are $\ssc^\infty$-retractions which have,  for example, locally varying finite dimensions, as we shall see later on. 
\begin{definition}\label{sc_smooth_retract}\index{D- Smooth retract}
A tuple $(O,C,E)$ is called a {\bf sc-smooth retract}, if there exists a relatively open subset $U$ of the partial quadrant $C$ and a  sc-smooth retraction $r\colon 
U\to U$ satisfying 
$$r(U)=O.$$
\qed
\end{definition}

In case $x\in U^1$ we deduce  from $r\circ r=r$ by the chain rule, 
$ Dr (r(x))\circ Dr(x)=Dr(x)$. Hence if $x\in O^1$, then $r(x)=x$ so that  $Dr (x)\circ Dr(x)=Dr(x)$ and $Dr(x)\colon E\to E$ is a projection.

\begin{proposition}\label{independent_of_retractions}\index{P- Intrinsic geometry of  retracts}
Let  $(O, C, E)$ be  a sc-smooth  retract and assume  that $r\colon 
U\to U$ and $r'\colon 
U'\to U'$ are two sc-smooth retractions defined on relatively open subsets $U$ and $U'$ of $C$  and satisfying $r(U)=r'(U')=O$. Then
$$Tr (TU)=Tr'(TU').$$
\end{proposition}
\begin{proof}
If $y\in U$, then there exists $y'\in U'$, so that $r(y)=r'(y')$.  Consequently, 
$r'\circ r(y)=r'\circ r'(y')=r'(y')=r(y)$, and hence $r'\circ r=r$.  Similarly, one sees that $r\circ r'=r'$.
If  $(x, h)\in Tr (TU)$,  then $(x, h)=Tr(y, k)$ for a pair  $(y, k)\in TU$.
Moreover,  $x\in O_1\subset U'_1$, so that $(x, h)\in TU'$.  From $r'\circ r=r$ it follows,  using the chain rule,  that
$$Tr'(x, h)=Tr' \circ Tr(y,k)=T(r'\circ r)(y, k)=Tr(y, k)=(x, h),$$
implying $Tr (TU)\subset Tr'(TU')$.  Similarly,  one shows that $Tr' (TU')\subset Tr(TU)$, and the proof of the proposition is complete.
\qed \end{proof}

Proposition \ref{independent_of_retractions} allows us  to  define the tangent of a sc-smooth retract  $(O,C,E)$\index{$(O,C,E)$} as follows.
\begin{definition}\index{D- Tangent of a retract}
The {\bf tangent of the sc-smooth retract}  $(O,C,E)$  is defined as the triple
$$
T(O,C,E)=(TO,TC,TE),\index{$T(O,C,E)$}
$$
in which $TC=C^1\oplus E$ is the tangent of the partial quadrant $C$, $TE=E^1\oplus E$,  and  $TO:= 
Tr(TU)$, where  $r\colon U\to U$ is any sc-smooth retraction onto $O$.
\qed
\end{definition}
We recall that, explicitly, 
$$
TO=Tr(TU)=Tr(U^1\oplus E)=\{(r(x), Dr(x)h)\, \vert \, x\in U^1, h\in E\}.
$$
Starting with a relatively open subset $U$ of a partial quadrant $C$ in $E$,  the tangent $TC$ of $C$  is a partial quadrant in $TE$, and $TU$ is a relatively open subset of $TC$.

In the following we shall quite often just write $O$ instead of $(O,C,E)$
and  $TO$ instead of $(TO,TC,TE)$. However, we would like to point out that the ``reference'' $(C,E)$ is important, since 
it is possible that $O$ is a sc-smooth retract with respect to some nontrivial $C$, but would not be a sc-smooth retract for $C=E$.

\begin{proposition}\label{preparation_retraction}\index{P- Tangent map}
Let $(O,C,E)$ and $(O',C',E')$  be sc-smooth retracts and let $f\colon 
O\rightarrow O'$  be a map. If  $r\colon 
U\to U$ and $s\colon 
V\to V$  are sc-smooth retractions onto $O$ for the triple $(O, C, E)$, then the following holds.
\begin{itemize}
\item[\em(1)]\  If $f\circ r\colon 
U\rightarrow E'$ is sc-smooth, then $f\circ s\colon 
V\rightarrow E'$ is sc-smooth, and vice versa.
\item[\em(2)]\ If  $f\circ r$ is sc-smooth, then  
$T(f\circ r)|TO=T(f\circ s)|TO$.
\item[\em(3)]\ The  tangent map $T(f\circ r)\vert TO$ maps $TO$ into $TO'$.
\end{itemize}
\end{proposition}
\begin{proof}
We assume that $f\circ r\colon 
U\to  E'$ is $\ssc^\infty$. Since  $s\colon 
V\to  U\cap V$ is $\ssc^\infty$, the chain rule implies that the composition $f\circ r\circ s\colon 
V\to  F$ is $\ssc^\infty$.
Using  the identity  $f\circ r\circ s=f\circ s$, we conclude that $f\circ s$ is $\ssc^\infty$. Interchanging the role of $r$ and $s$,  the first part of the lemma is proved.
If $(x, h)\in TO$, then $(x, h)=Ts (x, h)$ and using the identity $f\circ r\circ s=f\circ s$ and the chain rule, we conclude
\begin{equation*}
T(f\circ r)(x,h)=T(f\circ r)(Ts)(x,h)=T(f\circ r\circ s)(x,h)=T(f\circ s)(x,h)
\end{equation*}
Now we take any  sc--smooth retraction $\rho\colon 
U'\to  U'$ defined on a  relatively open subset $U$ of the  partial quadrant $C'$ in $E'$  satisfying $\rho(U')=O'$. Then $\rho\circ f= f$ so that $\rho\circ f\circ r=f\circ r$. Application of  the chain rule  yields the identity
$$
T(f\circ r)(x,h)=T(\rho\circ f\circ r)(x,h)=T\rho\circ T(f\circ r)(x,h)
$$
for all $(x, h)\in Tr(TU).$
Consequently, $T(f\circ r)\vert Tr(TU)\colon 
TO\to TO'$ and this map is  independent of the choice of a sc-smooth retraction onto $O$.
\qed \end{proof}

In view of  Proposition  \ref{preparation_retraction},  we can define the sc-smoothness of a map between sc-smooth retracts, as well as its tangent as follows.
\begin{definition}\label{tangent_retract}\index{D- Tangent map}
Let  $f\colon 
O\rightarrow O'$  be a map between sc-smooth retracts $(O,C,E)$ and $(O',C',E')$, and let  $r\colon 
U\to U$ be a sc-smooth retraction for   $(O, C, E)$. Then {\bf the  map $f$ 
is sc-smooth},  if  the  composition
$$
U\rightarrow E', \quad x\mapsto f\circ r(x)
$$
is sc-smooth.  In this case the {\bf tangent map} $Tf\colon 
TO\rightarrow TO'$ is defined by
$$
Tf\colon 
=T(f\circ r)\vert TO.\index{$Tf$}
$$
\qed
\end{definition}
Proposition  \ref{preparation_retraction} shows that   the definition does not depend on the choice of  the sc-smooth retraction $r$, as long as it retracts onto  $O$. With Definition \ref{tangent_retract}, the chain rule for sc-smooth maps between sc-smooth retracts  follows from Theorem \ref{sccomp}.
\begin{theorem}
Let $(O,C,E)$, $(O',C',E')$ and $(O'',C',E'')$ be two sc-smooth retracts and let $f\colon 
O\rightarrow O'$ and $g\colon 
O'\rightarrow O''$ be sc-smooth. Then $g\circ f\colon 
O\rightarrow O''$ is sc-smooth and $T(g\circ f)=(Tg)\circ (Tf)$.
\qed
\end{theorem}


If $f\colon O\to O'$ is a sc-smooth map between sc-smooth retracts as in Definition \ref{tangent_retract}, we abbreviate the linearization of $f$ at the point $o\in O^1=r(U^1)$ (on level $1$) by 
$$
Tf(o)=T(f\circ r)(o)\vert T_oO,
$$
so that 
$$Tf(o)\colon T_oO\to T_{f(o)}O'$$
is a continuous linear  map between the tangent spaces 
$T_oO=Dr(o)E$ and $T_{f(o)}O'=Dr'(f(o))E'$.


At this point, we have defined a new {\bf category ${\mathcal R}$}\index{${\mathcal R}$} whose  objects  are  sc-smooth
retracts $(O,C,E)$ and whose morphisms are sc-smooth maps 
$$
f\colon 
(O,C,E)\rightarrow (O',C',E')
$$
 between sc-smooth retracts.
The map $f$ is only defined between $O$ and $O'$, but the other data $(O,C,E)$ are  needed to define the differential geometric properties of $O$.

We also have a  well-defined functor, namely the {\bf tangent functor} \index{Tangent functor}
$$
T\colon 
{\mathcal R}\rightarrow {\mathcal R}.\index{$T\colon 
{\mathcal R}\rightarrow {\mathcal R}$}
$$
It maps  the object $(O,C,E)$ into its tangent $(TO,TC,TE)$ and the morphism
$f\colon 
(O,C,E)\rightarrow (O',C',E')$ into its tangent map $Tf$,
\begin{gather*}
Tf\colon 
(TO,TC,TE)\rightarrow (TO',TC',TE')\\
Tf(x,h)=(f(x),Df(x)h)\quad  \text{for all $(x,h)\in TO$.}
\end{gather*}
 The chain rule guarantees the functorial property 
 $$T(g\circ f)=(Tg)\circ (Tf).$$
 Clearly, this is enough to build a differential geometry  whose  local models
are sc-smooth retracts. The details will be carried out  in the next subsection. Let us note that $T(O,C,E)$ has evidently
more structure than $(O,C,E)$, for example $TO\rightarrow O^1$ seems to have some kind of bundle structure.
We shall discuss this briefly and 
 introduce another category of retracts. 
 
Consider a tuple $(U, C, E)$, where $U$ is a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$, and let $F$ be another sc-Banach space.
\begin{definition}\index{D- Bundle retraction}\index{D- Bundle model}
Let $p\colon 
U\oplus F\rightarrow U$ be a trivial sc-bundle  defined by the projection $p\colon 
U\oplus F\rightarrow U$ onto $U$, and let $R\colon 
U\oplus F\rightarrow U\oplus F$ be  a sc-smooth map of the form $R(u,v)=(r(u),\rho(u,v))$, satisfying $R\circ R=R$, and where $\rho(u,v)$ is linear in $v$. We call $R$ a {\bf sc-smooth  bundle retraction}  (covering the sc-smooth retraction $r$)
and $B=R(U\oplus F)$ the associated sc-smooth bundle retract, and denote by $p\colon 
B\rightarrow O$ the induced projection onto $O=r(U)$.   We shall refer to $p:B\rightarrow O$ as a {\bf sc-smooth bundle model} or {\bf sc-smooth bundle retract} and sometimes write $(B,C\oplus F,E\oplus F)$.
\qed
\end{definition}
Given two sc-smooth bundle retracts $p\colon 
B\rightarrow O$ and $p'\colon 
B'\rightarrow O'$,  a sc-smooth map $\Phi\colon 
B\rightarrow B'$
of the form $\Phi(u,v)=(a(u),\phi(u,v))$, where $\phi(u,v)$ is linear in $v$ and $p'\circ \Phi=p$ is called a {\bf sc-smooth (local) bundle map}.\index{D- Bundle map}


By $\mathcal{BR}$\index{$\mathcal{BR}$} we denote the category whose objects are sc-smooth bundle retracts and whose  morphisms are the sc-smooth bundle maps.
There is  a natural forgetful functor $\mathcal{BR}\rightarrow \mathcal{R}$, which on objects associates with the
bundle $B\xrightarrow{p}O$, the total space  $B$ and which views a bundle map $\Phi$ just as a sc-smooth map.


If $r\colon 
U\rightarrow U$ is a sc-smooth  retraction, then its  tangent map $Tr\colon 
TU\rightarrow TU$ is a sc-smooth bundle retraction. Moreover, the tangent map is a sc-smooth bundle map. Consequently,  the tangent functor can be  viewed as the functor 
 $$
 T\colon 
\mathcal{R }\rightarrow \mathcal{BR}.\index{$ T\colon 
\mathcal{R }\rightarrow \mathcal{BR}$}
 $$
The functor $T$  associates with  the object $(O,C,E)$\index{$(O,C,E)$} the triple $(TO,TC,TE)$\index{$T(O,C,E)$}, in which we  view $TE$  as the bundle $TE\rightarrow E^1$,
$TC$ as the bundle $TC\rightarrow C^1$,  and $TO$ as the bundle $TO\rightarrow O^1$. With a  sc-smooth map $f\colon 
(O,C,E)\rightarrow (O',C',E')$, the functor $T$  associates the 
sc-smooth bundle map $Tf$.

There is another class of retractions, called strong bundle retractions, which will be introduced in the later parts of Section \ref{SEC2.2}. 

\begin{remark}\index{R- Possible generalizations of domains}
Many of the aspects of the theory developed later on can be generalized as follows.
We take as local models $(O,C,E)$,
where $C$ is a closed convex set in the sc-Banach space $E$ with nonempty interior,  and $O\subset C$, so that there exists 
a relatively open subset $U\subset C$ with $O\subset U\subset C$ and an sc-smooth map $r:U\rightarrow U$ with $r\circ r=r$ and $O=r(U)$.
The fact that the interior of $C$ is open allows the necessary generalization of  the notion of sc-differentiability.
A particular case, which is of interest, is concerned 
with a situation described up to sc-isomorphism as follows. We assume that $E={\mathbb R}^n\oplus W$ and 
$C= D\oplus W$, where $D$ is the closed convex hull of a finite number of points in ${\mathbb R}^n$, so that $\text{int}(D)\neq \emptyset$.
We leave such generalizations to the reader.\qed
\end{remark}



\section{M-Polyfolds and Sub-M-Polyfolds}\label{SEC2.2}
We start with the following observation about sc-retractions and sc-retracts.

\begin{proposition}\label{new_retract_1}\index{P- Restrictions of retracts}
Let $(O, C, E)$ be a sc-smooth retract.
\begin{itemize}
\item[\em(1)]\ If $O'$ is an open subset of $O$, then $(O',C,E)$ is a sc-smooth retract.
\item[\em(2)]\ Let  $V$ be  an open subset of $O$ and $s\colon 
V\rightarrow V$  a sc-smooth map, satisfying  $s\circ s=s$.  If $O'=s(V)$, then $(O',C,E)$ is a sc-smooth retract.
\end{itemize}
\end{proposition}
\begin{proof}
(1)\, 
By assumption, there exists a sc-smooth retraction $r\colon 
U\to U$ defined on a relatively open subset $U$ of  the partial quadrant $C\subset E$, whose image is $O=r(U)$.  Since the map $r\colon 
U\rightarrow U$ is continuous,  the set $U':=r^{-1}(O')$ is an open subset of $U$ and, therefore, a relatively open subset of $C$.  Clearly,  $O'\subset U'$ 
and the restriction  $r'=r\vert U'$ defines a sc-smooth retraction $r'\colon 
U'\rightarrow U'$ onto  $r'(U')=O'$.
Consequently, the triple  $(O',C,E)$ is a sc-smooth retract, as claimed.\par

\noindent (2)\, The triple $(V, C, E)$ is, in view of (1),  a sc-smooth retract. Hence, there exists a sc-smooth retraction $r\colon U\to U$ onto $r(U)=V$, where $U\subset C\subset E$ 
We define the map $\rho\colon U\to U$ by 
$$\rho=s\circ r.$$
\par

Then $\rho$ is sc-smooth and $\rho\circ \rho=(s\circ r)\circ (s\circ r).$ If $x\in U$, then $r(x)\in V$, hence $s(r(x))\in V$ and consequently, $r(s(r(x))=s(r(x))$, so that 
$$r\circ \rho=\rho.$$
From $s\circ s=s$, we conclude that  $\rho\circ \rho=\rho$. Hence $\rho$ is a sc-smooth retraction onto the subset 
$$\rho(U)=s\circ r(U)=s(V)=O'.$$
We see that $(O', C, E)$ is a sc-smooth retract, as claimed.
\qed \end{proof}




In the following every sc-smooth map $r\colon 
O\rightarrow O$, defined on a sc-smooth retract  $O$ and satisfying $r\circ r=r$ will also be called a {\bf sc-smooth retraction}.
\begin{definition}\label{sc-charts}\index{D- Sc-charts}
Let $X$ be a topological space and $x\in X$.
{\bf A chart around $x$}  is a tuple $(V,\phi,(O,C,E))$,\index{$(V,\phi,(O,C,E))$} in which  $V\subset X$ is an open neighborhood of  $x$ in $X$, 
and $\phi\colon 
V\rightarrow O$ is a homeomorphism. Moreover, $(O,C,E)$ is a sc-smooth retract.
Two charts $(V,\phi,(O,C,E))$ and $(V',\psi,(O',C',E'))$ are called {\bf sc-smoothly compatible},  if  the transition maps 
$$\psi\circ\phi^{-1}\colon 
\phi(V\cap V')\rightarrow \psi(V\cap V')\quad \text{and}\quad \phi\circ \psi^{-1}\colon 
\psi(V\cap V')\rightarrow \phi(V\cap V')$$
are sc-smooth maps (in the sense of Definition \ref{tangent_retract}).
\qed
\end{definition}
Let us observe that $\phi(V\cap V')$ is an open subset of $O$ and so, in view of part (1) of Proposition  \ref{new_retract_1}, the tuple $(\phi(V\cap V'), C, E)$ is a sc-smooth retract.  So,  the above  transition maps are defined on  sc-smooth retracts.
\begin{definition}\label{sc_atlas}\index{D- Sc-smooth atlas}
{\bf A sc-smooth atlas} on the topological space $X$ consists
of a set of charts 
$$
(V,\varphi,(O,C,E)),
$$ 
such  that any two of them are sc-smoothly compatible and the open sets $V$ cover $X$.
Two {\bf sc-smooth atlases} on $X$  are said to be {\bf equivalent}, if their  union is again a  sc-smooth atlas.
\qed
\end{definition}


\begin{definition} \index{D- M-polyfold}
{\bf A M-polyfold} $X$  is a Hausdorff paracompact  topological
space equipped with an equivalence class of sc-smooth atlases.
\qed
\end{definition}

Analogous to the smoothness of maps between manifolds we shall define sc-smoothness of maps between M-polyfolds.

\begin{definition}
A  map $f\colon 
X\to Y$ between two M-polyfolds is called {\bf sc-smooth} \index{D- Sc-smooth map}
if its local coordinate representations are sc-smooth. In detail, this requires the following. If $f(x)=y$ and $(V,\varphi, (O, C, E))$ is a chart around $x$ belonging to the atlas of $X$  and 
$(V',\varphi', (O', C', E'))$ is a chart around $y$ belonging to the atlas of $Y$, so that $f(V)\subset V'$, then the map 
$$\varphi'\circ f\circ \varphi^{-1}\colon 
O\to O'$$
is a sc-smooth map between the sc-smooth retracts in the sense of Definition \ref{tangent_retract}.
\qed
\end{definition}
The definition does not depend on the choice of sc-smoothly compatible charts.



We recall that a Hausdorff topological space is paracompact, provided  every open cover of $X$ has an open locally finite refinement.  
It is a well-known fact,  that, given an open cover $\mathscr{U}={(U_i)}_{i\in I}$,  one can find a refinement $\mathscr{V}=(V_i)_{i\in I}$ satisfying  $V_i\subset U_i$  for all $i\in I$ (some  of the sets $V_i$ might be  empty). 




Given  a  M-polyfold $X$, we say that a point $x\in X$  is on the {\bf level $m$}\index{Level $m$ points}, if  there exists a chart $(V, \varphi, (O, C, E))$ around $x$, such that $\varphi(x)\in O_m$. Of course, this definition is independent of  the choice of a chart around $x$. We denote the collection of all points on the level $m$ by $X_m$.   The topology on $X_m$ is defined as follows.  We abbreviate by  $\mathscr{B}$ the collection of  all sets  $\varphi^{-1}(W)$, where $W$ is an open subset of $O_m:=O\cap E_m$ in the chart $(V, \varphi, (O, C, E))$ on $X$.  Then $\mathscr{B}$ is a basis for a topology on $X_m$.   With this topology, the set $V_m:=V\cap X_m$  is an open subset of $X_m$ and  $\varphi\colon 
V_m\to O_m$ is a homeomorphism, so that  the tuple $(V_m, \varphi, (O_m, C_m, E_m))$ is a chart on $X_m$. 
Any two such  charts are sc-smoothly compatible and  the collection of such charts is an atlas on $X_m$.
We shall see below that the topology on $X_m$ is Hausdorff and paracompact. Hence the above sc-smoothly compatible
charts define a M-polyfold structure on $X_m$. We shall denote $X_m$ with this M-polyfold structure by $X^m$\index{$X^m$}
\index{Raising the index of $X$} and say
that it is obtained from $X$ by {\bf raising the index by $m$}. 
Also note that the M-polyfold $X$ inherits from the charts the  filtration 
$$
X=X_0\supset X_1\supset \cdots \supset X_\infty=\bigcap_{i\geq 0}X_i.
$$



\begin{lemma}\label{inculsion_continuous}
The inclusion map $i:X_{m+1}\to X_m$ is continuous for all $m\geq 0$.
\end{lemma}
\begin{proof} 
In view of the definition of topologies on $X_{m}$ and $X_{m+1}$, it suffices to show, that if $(V, \varphi, (O, C, E))$ is a chart on $X$ and $W$ is an open subset of $O_m$, then $\varphi^{-1}(W)\cap X_{m+1}$ is open in $X_{m+1}$. If $x\in \varphi^{-1}(W)\cap X_{m+1}$, then $\varphi (x)\in W\cap O_{m+1}\subset W\cap E_{m+1}$. Since $W$ is open in $O_{m}$, there exists an open set  $W'$ in $E_m$, so that $W=W'\cap O$. Hence, $\varphi (x)\in  (W'\cap E_{m+1})\cap O=W''\cap O$, where $W''=W'\cap E_{m+1}$ is an open subset of $E_{m+1}$. Hence $W''\cap O$ is an open subset of $O_{m+1}$ and $ \varphi^{-1}(W)\cap X_{m+1}=\varphi^{-1}(W''\cap O)$,  proving our claim.
\qed \end{proof}

\begin{theorem}\label{X_m_paracompact}\index{T- Metrizability of $X_m$}
Let $X$ be a M-polyfold. For every $m\geq 0$, the space $X_m$ is metrizable and, in particular, paracompact. In addition, the space $X_\infty$ is metrizable.
\qed
\end{theorem}
The proof is  postponed to  Appendix \ref{A2.2}.

In order to define the tangent $TX$ of the M-polyfold $X$, we start with its  local description in a chart.
\begin{definition}[{\bf Tangent space $T_xO$}]\index{D- Tangent space}
Let $(O, C, E)$ be a retract and $T(O,C,E)=(TO,TC,TE)$ its tangent,  so that $p\colon 
TO\rightarrow O^1$ is the tangent bundle over $O$.
The {\bf tangent space} $T_xO$ at a point $x\in O^1$ is the pre-image $p^{-1}(x)$, which is a Banach space. Note that only in the case that $x$ is  a smooth point, the tangent space  $T_xO$ has a natural sc-structure.
\qed
\end{definition} 
In the case that $x\in O_1$,  the tangent space $T_xO$\index{$T_xO$} is the image of the projection $Dr(x)\colon 
E\rightarrow E$, where $r\colon 
U\rightarrow U$ is any sc-smooth retraction
associated with  $(O,C,E)$ satisfying $r(U)=O$.


Next we consider tuples  $(x, V, \varphi,(O,C,E),h)$, in which $x\in X_1$ is a point in the M-polyfold $X$ on  level $1$ and  $(V,\varphi,(O,C,E))$ is a chart around the point $x$. Moreover,  $h\in T_{\varphi (x)}O$. 
Two such tuples, 
$$
(x, V, \varphi,(O,C,E),h)\quad \text{and} \quad (x',V', \psi, (O',C',E'),h'),
$$
are called equivalent, if  
$$x=x'\quad  \text{and}\quad T(\varphi\circ\psi^{-1})(\psi (x))h'=h.$$ 
\begin{definition}\label{tangent_space}\index{D- Tangent space}
The {\bf tangent space $TX$  of $X$}  as a set, is the collection of all equivalence classes $[(x,V, \varphi,(O,C,E),h)]$.  
\qed
\end{definition}

If $x\in X_1$ is fixed, the tangent space $T_xX$ of the M-polyfold $X$ at the point $x \in X$ is the subset of equivalence classes
$$T_xX=\{[(x, \varphi, V, (O, C, E), h)]\ \vert \,  h\in T_{\varphi (x)}O\}.$$
It has the structure of a vector space defined by 
\begin{eqnarray*}
&\lambda\cdot [(x, \varphi, V, (O, C, E), h_1)]+
\mu\cdot [(x, \varphi, V, (O, C, E), h_2)]&\\
&=
[(x, \varphi, V, (O, C, E), (\lambda h_1+\mu h_2)],&
\end{eqnarray*}
 where $\lambda,\mu\in \R$ and $h_1,h_2\in T_{\varphi(x)}O$.
Clearly,
\begin{equation}\label{equation_tangent_bundle}
TX=\bigcup_{x\in X_1}\{x\}\times T_xX.
\end{equation}


To  define a topology on the tangent space $TX$,  we first fix a chart $(V,\varphi,  (O, C, E))$ on $X$ and associate with it a subset $TV$ of $TX$,  defined as   
$$TV:
=\{[(x, \varphi, V, (O, C, E), h)]\ \vert \, x\in V,\, h\in T_{\varphi (x)}O\}.$$

We introduce the {\bf tangent map}  $T\varphi\colon TV\to TO$\index{Tangent map}  by 
$$T\varphi ([(x, \varphi, V, (O, C, E), h)])=(\varphi (x), h),$$
where $h\in T_{\varphi(x)}O$. If  $x\in X_1$ is fixed, then the map
$$T\varphi\colon 
T_xV\to T_{\varphi (x)}O$$
is a linear isomorphism.
Therefore, $T_xX$, the tangent space at $x \in X_1$ inherits the Banach space structure from $T_{\varphi(x)} O \subset E = E_0$. If $x \in X_\infty$, the tangent space $T_xX$ is a sc-Banach space, because the tangent space at the smooth point $\varphi(x) \in O_\infty$ is a sc-Banach space.


If $W$ is an an open subset of $TO$,  we define  the subset $\wt{W}\subset TV$ by $\wt{W}:=(T\varphi )^{-1}(W).$  
We denote by  $\mathscr{B}$ the collection of all such sets  $\wt{W}$ obtained by taking all the charts  $(\varphi, V, (O, C, E))$  of the atlas and all open subsets $W$ of the corresponding tangents $TO$. 

\begin{proposition}\label{op}\mbox{}\index{P- Properties of $TX$}
The following holds.
\begin{itemize}
\item[\em(1)]\ The collection $\mathscr{B}$ defines a basis for a Hausdorff  topology on $TX$.  
\item[\em(2)]\ The projection $p\colon 
TX\to X^1$ is a continuous and an open map.
\item[\em(3)]\ With the topology defined by $\mathscr{B}$,  the tangent space $TX$ of the M-polyfold $X$  is metrizable and hence, in particular,  paracompact.
\end{itemize}
\qed
\end{proposition}
The proof is postponed to  Appendix \ref{A2.11}.
In view of our definition of the topology on $TX$, the map 
$T\varphi\colon 
 TV\to TO$, associated with the chart $(\varphi, V, (O, C, E))$,  is a homeomorphism. Moreover, given two such maps 
$$T\varphi \colon 
TV\to TO\quad \text{and}\quad T\varphi'\colon 
TV'\to TO', $$ the composition $T\varphi' \circ (T\varphi)^{-1}\colon 
 T\varphi (TV\cap TV')\to T\varphi' (TV\cap TV')$ is explicitly of the form 
\begin{equation}\label{transition_1}
T\varphi' \circ (T\varphi)^{-1}(a, h)=(\varphi'\circ \varphi^{-1}(a), 
D(\varphi'\circ \varphi^{-1})(a)\cdot h)=T(\varphi'\circ\varphi^{-1})(a,h).
\end{equation}
Since the transition map  $\varphi' \circ  \varphi^{-1}$ between sc-retracts is sc-smooth, the composition in \eqref{transition_1} is also sc-smooth. 
In addition, $(TO, TC, TE)$ is a sc-smooth retract. Consequently, the tuples $(TV, T\varphi,  (TO, TC, TE))$  define a sc-smooth atlas on $TX$. Since, as we have proved above, $TX$ is paracompact,  the tangent space $TX$ of the M-polyfold $X$ is also  a M-polyfold.  The projection map $p\colon 
TX\to X^1$  is locally built on the bundle retractions $TO\rightarrow O^1$,  and the transition maps of the charts
are sc-smooth bundle maps. Therefore, 
$$p\colon 
TX\rightarrow X^1$$ 
is a sc-smooth M-polyfold bundle.


The  M-polyfold is the notion of a smooth manifold in our extended universe.  If 
$X$ is a  M-polyfold,  which consists entirely of smooth points, then it  has a tangent space at every point. 
There are finite-dimensional examples. For example,  the  chap depicted in Figure \ref{fig:pict1} has a M-polyfold structure,
for which $X=X_\infty$. It illustrates, in particular, that M-polyfolds allow to describe in a smooth way geometric objects having locally varying dimensions.
 For details in the construction of the chap and further illustrations, we refer to \cite{HWZ8.7}, Section 1, in particular, Example 1.22.

\begin{figure}[htb]
\centering
\def\svgwidth{30ex}
\input{pict1.pdf_tex}
\caption{This chap has a  M-polyfold structure for which every point is smooth. }\label{fig:pict1}
\end{figure}



Next we introduce the notion of a sub-M-polyfold.

\begin{definition}\label{def_sc_smooth_sub_M_polyfold}\index{D- Sub-M-polyfold}
Let $X$ be a M-polyfold and let $A$ be a subset of $X$. The subset  $A$ is called a {\bf sub-M-polyfold} of $X$, 
if every $a\in A$ possesses  an open neighborhood $V$ and a sc-smooth retraction
$r\colon 
V\rightarrow V$, such that 
$$r(V)=A\cap V.$$
\qed
\end{definition}

\begin{proposition}\label{sc_structure_sub_M_polyfold}\index{P- Properties of sub-M-polyfolds}
A sub-M-polyfold $A$ of a  M-polyfold $X$ has, in a natural way, the structure of a  M-polyfold,
for which  the following holds. 
\begin{itemize}
\item[{\em (1)}]\ The inclusion map $i\colon A\rightarrow X$ is sc-smooth and a homeomorphism onto its image.
\item[{\em (2)}]\ For every $a\in A$ and every sc-smooth  retraction $r\colon V\rightarrow V$ satisfying  $r(V)=A\cap V$ and $a\in V$,
the map $i^{-1}\circ r\colon V\rightarrow A$ is sc-smooth.
\item[{\em (3)}]\ The tangent space $T_aA$ for a smooth $a\in A$ has a sc-complement in $T_aX$.
\item[{\em (4)}]\ If $a$ is a smooth point and $s\colon 
W\rightarrow W
$ is a sc-smooth retraction satisfying  $s(W)=W\cap A$ and $a\in W$, then the induced map
$W\rightarrow A$ is sc-smooth and $Ts(a)T_aX=T_aA$.
\end{itemize}
\end{proposition}
\begin{proof}
We  first define a sc-smooth atlas for $A$. We choose a point $a\in A$ and let $( \varphi, V, (O, C, E))$ be a chart of the M-polyfold $X$ around the point $a$.  By definition of a sub-M-polyfold,  there exists an open neighborhood $U$ of $a$ in $X$ and a sc-smooth retraction $r\colon 
U\to U$ satisfying  $r(U)=U\cap A$.  The set $W\subset X$, defined by  $W:=r^{-1}(U\cap V)\cap (U\cap V)$, is  open in $X$ and satisfies  $r(W)\subset W$ and $r(W)=W\cap A$. Hence, $\varphi (W)$ is an open subset of $O$, so that, in view of of part (1) 
Proposition  \ref{new_retract_1}, the tuple $(\varphi (W), C, E)$ is a sc-retract.  We may therefore  assume without loss of generality that $U=V=W$.  We define the sc-smooth map   $\rho\colon O\to O$ by 
$$\rho=\varphi\circ r\circ \varphi^{-1}.$$
From $r\circ r=r$ we deduce  $\rho\circ \rho=\rho$, so that $\rho$ is a sc-smooth retraction onto $\rho(O)=O'$. By the statement (2) in  Proposition  \ref{new_retract_1},  the triple $(O', C, E)$ is a sc-retract. Therefore there exists a relatively open subset $U'$ of the partial quadrant $C$ in $E$ and a sc-smooth retraction $r'\colon 
U'\to U'$ onto  $r'(U')=O'$.  Restricting the map $\varphi$ to $W\cap A$,  we set $\psi:=\varphi\vert W\cap A$ and compute,
$$\psi (W\cap A)=\varphi (W\cap A)=\varphi \circ r(W)=\varphi\circ r\circ \varphi^{-1}(O)=\rho(O)=O'.$$
Consequently,  
$$
\psi\colon 
 W\cap A\to O'$$
  is a homeomorphism and the triple  $( \psi, W\cap A, , (O', C, E))$ is a chart on $A$. 

In order to consider the chart transformation we take a second compatible chart $( \varphi', V', (\wh{O}, C', E'))$ of the M-polyfold $X$ around the point $a\in A$ and use it two construct the second chart $( \psi', W'\cap A, , (O'', C', E'))$ of $A$. 
We shall show that the second chart is compatible with the already constructed chart  $( \psi, W\cap A, , (O', C, E))$.  
The domain $\psi ((W\cap A)\cap (W'\cap A))$ of  the transition map 
\begin{equation}\label{transition_map_0}
\psi'\circ \psi^{-1}\colon 
\psi ((W\cap A)\cap (W'\cap A))\to \psi' ((W'\cap A)\cap (W\cap A))
\end{equation}
 is an open subset of $O'$, so that, in view of  (2) of Proposition \eqref{new_retract_1}, there exists a relatively open subset $U''\subset C$ and a sc-smooth retraction $s''\colon 
U''\to U''$ onto  $s''(U'')=\psi ((W\cap A)\cap (W'\cap A))$.  By construction,
 $$(\psi'\circ \psi^{-1})\circ s''=(\phi'\circ \phi^{-1})\circ s''.$$
 The chart transformation $\varphi'\circ \varphi^{-1}\colon 
O\to \wh{O}$ is sc-smooth so that by the chain rule 
the right-hand side is sc-smooth. Therefore, also the left-hand  is a sc-smooth map. So, in view of Definition \ref{tangent_retract} of a sc-smooth map between retracts, the transition map $\psi'\circ \psi^{-1}$ is sc-smooth.
  
We have shown that  the collection of charts $(\psi, W\cap A, (\psi (W\cap A), C, E))$  defines a sc-smooth atlas for $A$.  The sc-smooth structure on $A$  is defined by its equivalence class.


In order to prove the statement (2) in 
Proposition \ref{sc_structure_sub_M_polyfold} we use the above local coordinates, assuming, as above, that $U=V=W$. 
The inclusion map
$i\colon 
A\rightarrow X$ is, in the local coordinates, the inclusion 
$j\colon 
O'=r'(U')\to O$ which  is a  sc-smooth map since $r'\colon 
U'\to U'$ is a  sc-retraction. Conversely, the relations $\varphi\circ r\circ \varphi^{-1}(O)=O'$ and $U=\varphi^{-1}(O)$ show that the map
$i^{-1}\circ r\colon 
U\to A$ is sc-smooth because the retraction $r\colon 
U\to U$ is, by assumption, sc-smooth. This  proves  statement (2) of the proposition. 




In order to prove the statement (3) we work in local coordinates,  and assume that  $X$ is given by the triple $(O,C,E)$ in which $O=r(U)$ and $r\colon 
U\to U$ is a retraction of the relatively open subset $U$ of $C$ in $E$. Then  $A$ is a subset of $O$ having the property that every point $a\in A$ possesses  an open neighborhood $V$ in $O$ and a sc-smooth retraction $s\colon 
V\rightarrow V$ onto $s(V)=A\cap V$. We now assume that $a\in A$ is  a smooth point and introduce  the map $t=s\circ r\colon 
U\to U$. Then 
$t\circ t=t$ and $t$ is a sc-smooth retraction onto the set $V\cap A$. Hence the tangent space $T_aA$ is defined by 
$$T_aA=Dt(a)E=Ds(a)\circ Dr(a)E=Ds(a)T_aO.$$
From $r\circ t=r\circ s\circ r=s\circ r=t$ we conclude 
$Dr(a)\circ Dt(a)E=Dt(a)E$ and hence $Dt(a)E\subset T_aO.$
Therefore, 
\begin{equation*}
\begin{split}
T_aO=Dr(a)E&=Ds(a)\circ Dr (a)+(I-Ds(a))Dr(a)E\\
&=
(T_aA)\oplus (I-Ds(a))(T_aO).
\end{split}
\end{equation*}
This proves the statement (3).  Using the same arguments,  the statement (4) follows and the proof of Proposition \ref{sc_structure_sub_M_polyfold} is complete.
\qed \end{proof}

\section{Degeneracy Index and Boundary Geometry}
Abbreviating ${\mathbb N}=\{0,1,2,3,..\}$\index{${\mathbb N}$}
  we shall introduce on the  M-polyfold $X$ the map $d_X\colon 
X\rightarrow {\mathbb N}$, called degeneracy index,  as follows.
We first take a smooth chart  $(V,\phi,(O,C,E))$ around the point $x$ 
and define the integer 
$$
d(x, V,\phi,(O,C,E))= d_C(\phi(x)),\index{$d(x, V,\phi,(O,C,E))$}
$$
where $d_C$ is  the index defined in 
Section \ref{subsection_boundary_recognition}.
In  other words, we record how many vanishing coordinates the image point $\phi(x)$ has in the partial quadrant $C$.
\begin{definition}\label{M_polyfold_degeneracy _index}\index{D- Degeneracy index $d_X$}\index{$d_X$}
The {\bf degeneracy} $d_X(x)$ at the point $x\in X$ is the minimum of all numbers 
$d(x, V, \phi,(O,C,E))$, where $(V,\phi,(O,C,E))$ varies over all smooth charts around  the point $x$.
The {\bf degeneracy index}  of the M-polyfold $X$ is the map $d_X\colon 
X\rightarrow {\mathbb N}$.
\qed
\end{definition}

The next lemma is evident.
\begin{lemma}\index{L- Local property of $d_X$}
Every point $x\in X$ possesses an open neighborhood $U(x)$, such  that $d_X(y)\leq d_X(x)$ for all $y\in U(x)$. 
\qed
\end{lemma}

From the definitions one deduces immediately the following result.
\begin{proposition}\label{newprop2.24}\index{P- Diffeomorphism invariance of $d_X$}
If $X$ and $Y$ are M-polyfolds and if $ f\colon (U,x)\rightarrow (V,f(x))$ is a germ of sc-diffeomorphisms
around the points $x\in X$ and $f(x)\in Y$,  then $$d_X(x)=d_Y(f(x)).$$
\qed
\end{proposition}


The index $d_X$ quantifies to which extend a point $x$ has to be seen as a boundary point. A more degenerate point has a higher index.

\begin{definition}\label{boundary_M_polyfold}\index{D- Boundary of an M-polyfold}
The subset  $\partial X=\{x\in X\ |\ d_X(x)\geq 1\}$ of $X$  is called the {\bf boundary of $X$}.
A  M-polyfold $X$ for which $d_X\equiv 0$ is called
a  {\bf M-polyfold without boundary}. \qed
\end{definition}

The relationship between $d_A$ and $d_X$  where  $A$ is a sub-M-polyfold of $X$ is described in the following lemma.
\begin{lemma}\label{k^0}\index{L- $d_A$ versus $d_X$}
If $X$ is  a M-polyfold and $A\subset X$ a sub-M-polyfold of $X$,   then
$$
d_A(a)\leq d_X(a)
$$
for all $a\in A$.
\end{lemma}
\begin{proof}
We take a point $a\in A$ and choose a chart $(\varphi, V, (O, C, E))$ around the point $a$, belonging to the atlas for $X$ and satisfying 
$$d_X(a)=d(a, \varphi , V, (O, C, E)).$$
The integer on the right-hand side remains unchanged, if we take a smaller domain, still containing $a$,  and replace $O$ by its image. Then, arguing as in 
Proposition \ref{sc_structure_sub_M_polyfold}, we may assume, that the  corresponding chart of the atlas  for $A$ is $(\psi, V', (O', C, E))$, where we have abbreviated $V'=V\cap A$, $\psi=\varphi\vert {V'}$, and $O'=\psi (V')$.  Then, 
$$d(a, \psi, V', (O', C, E))=d(a, \varphi, V, (O, C, E))=d_X(a),$$
and hence, taking the minimum on the left-hand side,
$d_A(a)\leq d_X(a),$ as claimed in the lemma.
\qed \end{proof}

If $E={\mathbb R}^k\oplus W$ is the sc-Banach space and $C=[0,\infty)^k\oplus W$ the partial quadrant in $E$,  we   define the linear subspace $E_i$ of $E$ by
$$
E_i=\{(a_1,\ldots, a_k,w)\in {\mathbb R}^k\oplus W\ \vert \ a_i=0\}.\index{$E_i$}
$$
With a subset $I\subset \{1,\ldots ,k\}$,  we associate the subspace 
$$
E_I=\bigcap_{i\in I} E_i.\index{$E_I$}
$$
In particular, $E_{\emptyset}=E$, $E_{\{i\}}=E_i$, and $E_{\{1,\ldots , k\}}=\{0\}^k\oplus W\equiv W$.  If $x\in C$, we denote by $I(x)$ the  set 
of indices $ i\in \{1,\ldots ,k\}$ for which $x\in E_i.$ We 
abbreviate
$$
E_x:=E_{I(x)}.
$$
Associated with  $E_i$ we have the closed half space $H_i$,  consisting of all elements $(a,w)$ in $ {\mathbb R}^k\oplus W$, satisfying  $a_i\geq 0$, 
$$
H_i=\{(a_1,\ldots, a_k,w)\in E\ |\ a_i\geq 0\}.\index{$H_i$}
$$
If $x\in C$, we define  the partial cone $C_x$ in $E$ as 
$$
C_x=C_{I(x)}:=\bigcap_{i\in I(x)}H_i.\index{$C_x$}
$$
We observe that $E_x\subset C_x$.

As an illustration we take  the standard quadrant $C\subset {\mathbb R}^2$ consisting of all $(x,y)$ with $x,y\geq 0$.
Then $C_{(0,0)}=C$, $C_{(1,0)}=\{(x,y)\ |\ y\geq 0\}$, $C_{(0,1)}=\{(x,y)\ |\ x\geq 0\}$ and $C_{(1,1)}={\mathbb R}^2$.
Moreover $E_{(0,0)}=\{0\}$, $E_{(1,0)}={\mathbb R}\oplus \{0\}$,  $E_{(0,1)}=\{0\}\oplus {\mathbb R}$, and $E_{(1,1)}={\mathbb R}^2$.
One should view  $C_{(x,y)}$ as a partial quadrant in the tangent space $T_{(x,y)}C= {\mathbb R}^2$ and $E_{(x,y)}\subset C_{(x,y)}$
as the maximal linear subspace.

In the following we shall put some additional structure on a sc-smooth retract $(O,C,E)$, which turns out to be useful.
We call a subset $C$ of a Banach space (or sc-Banach space) 
a {\bf cone} \index{Cone}provided it is closed, convex, and satisfies ${\mathbb R}^+C=C$ and $C\cap (-C)=\{0\}$.
If all properties except the last one hold,  we call $C$  a {\bf  partial cone}.\index{Partial cone}
In the following considerations $E={\mathbb R}^k\oplus W$ and $C=[0,\infty)^k\oplus W$.
The aim of the following  is to extract some information from the geometry of a retract $(O,C,E)$.
\begin{definition}\label{reduced_cone_tangent}\index{D- Reduced tangent space}\index{D- Partial cone}
Let $(O,C,E)$ be a sc-smooth retract and let $x\in O_\infty$  be a smooth point in $O$. The {\bf partial cone} $C_xO$  at  $x$ is defined as the following subset of the tangent space at $x$, 
$$
C_xO:=T_xO\cap C_x,\index{$C_xO$}
$$
where $C_x=\bigcap_{i\in I(x)}H_i$.
The {\bf reduced tangent space}  $T^{\textrm{R}}_xO$ is defined as the following subset of the tangent space at $x$, 
$$
T_x^{\textrm{R}} O =T_xO\cap E_x.\index{$T_x^{\textrm{R}}O$}
$$
\qed
\end{definition}
\begin{remark}\index{R- Remark on $C_xO$}
We have the inclusions
$$
T^R_xO\subset C_xO\subset T_xO, 
$$
and naively one might expect that $C_xO$ is a partial quadrant in $T_xO$. However, this is in general not the case.
\qed
\end{remark}
The reduced tangent space and the partial cone are  characterized in the next lemma.
\begin{lemma}\label{characterization_reduced_tangent}\index{L- Reduced tangent}
Let $(O,C,E)$  be as described before  and let  $x\in O_\infty$ be a smooth point in $O$. Then the following holds, where the  $\varepsilon$ occurring in the definitions may depend on $\alpha$.
\begin{itemize}
\item[\em(1)]\ $T^{\textrm{R}}_xO=\textrm{cl}( \{ \text{$\dot{\alpha}(0)\vert \, \alpha\colon 
(-\varepsilon, \varepsilon)\to O$ is sc-smooth and $ \alpha(0)=x$}\} )$.
\item[\em(2)]\ $C_xO=\text{cl}( \{\text{$\dot{\alpha}(0)\vert \,  \alpha\colon 
[0, \varepsilon)\rightarrow O$ is sc-smooth and $ \alpha(0)=x$}\})$.
\item[\em(3)]\ $T_xO =C_xO-C_xO$.
\end{itemize}
Here $\dot{\alpha}(0)=\frac{d}{dt}\alpha (t)_{\vert t=0}$ stands for the derivative of the sc-smooth path $\alpha$ in the parameter $t$ varying in $(-\varepsilon, \varepsilon)$ resp. in $[0, \varepsilon)$.
\end{lemma}
\begin{proof}  We assume that $U\subset C$ is relatively open and $r:U\rightarrow U$ is a sc-smooth retraction with $O=r(U)$.
Let us denote for $x\in {\mathbb R}^k\oplus W$
by $x_1\ldots,x_k$ its  coordinates in ${\mathbb R}^k$.\par
 
(1)\,  We first  introduce the set  
\begin{equation}\label{set_gamma}
\Gamma= \{ \text{$\dot{\alpha}(0)\vert \, \alpha\colon 
(-\varepsilon, \varepsilon)\to O$ is sc-smooth and $ \alpha(0)=x$}\},
\end{equation}
and observe, that $\alpha ((-\varepsilon, \varepsilon))$ is contained in $ O_\infty$, and   $\dot{\alpha}(0)\in E_\infty$.
Since the closure of $(T^{\textrm{R}}_xO)_\infty$ is  equal to $T^{\textrm{R}}_xO$, it is enough to prove that  $(T^{\textrm{R}}_xO)_\infty\subset \Gamma$ and $\Gamma\subset (T^{\textrm{R}}_xO)_\infty$.  As for the  first inclusion,  we take $v\in (T^{\textrm{R}}_xO)_\infty$. Hence  $x+tv\in U$ for $\abs{t}$ small. This follows from the fact that for $i\in I(x)$,  we have $a_i=v_i=0$ and for $i\not \in I(x)$, we have $x_i>0$. Since $x$ and $v$ are smooth points, $x+tv\in U_\infty$. Then $\alpha (t)=r(x+tv)$ is defined for $\abs{t}$ small, takes values in $O_\infty$,  and $\alpha (0)=x$.  By the chain rule, 
$$\dot{\alpha}(0)=Dr(x)v=v,$$
since $v\in T_xO=\text{image of $Dr(x)$}$. Hence, $v\in \Gamma$ and $(T^{\textrm{R}}_xO)_\infty\subset \Gamma$, as claimed. Conversely,  if $\alpha\colon 
(-\varepsilon, \varepsilon)\to O$ is a  sc-smooth path  satisfying  $\alpha (0)=x$,   then $r(\alpha (t))=\alpha (t)$, so that, applying the chain rule, we find 
$$Dr(x)\dot{\alpha}(0)=\dot{\alpha} (0).$$
This shows that  $\dot{\alpha} (0)$ is a smooth point belonging to $T_xO$. If $i\in I(x)$, then $\alpha_i(0)=x_i=0$ and since 
$\alpha_i(t)\geq 0$ for all $t\in (-\varepsilon, \varepsilon)$, we conclude  that $\dot{\alpha}_i(0)=0$, so that 
$\dot{\alpha}(0)\in E_x$.  
Hence, 
$\dot{\alpha}(0)\in T_xO\cap E_x=T_x^{\textrm{R}}O$  
and since 
$\dot{\alpha}(0)$ 
is a smooth point, 
$\dot{\alpha}(0)\in (T_x^{\textrm{R}}O)_\infty$.  
Therefore,
 $\Gamma \subset (T_x^{\textrm{R}}O)_\infty$,  and the proof of (1) is complete.\par
 
(2)\, The proof is along the same line, except that considering a sc-smooth path $\alpha\colon 
[0,\infty)\to O,$ we conclude that $Dr(x)\dot{\alpha}(0)\in C_x$ and since $Dr(x)\dot{\alpha}(0)=\dot{\alpha}(0)$, we find that $C_xO$ is a subset of the right-hand side of (2). Conversely, we take a smooth point $v\in C_xO$ and consider the path $\alpha (t)=r(x+tv)$ defined for $t\geq 0$ small. Then, $\dot{\alpha}(0)=Dr(x)v$ belongs to the right-hand side of (2) and since $C_xO$ is closed, the result follows.\par

(3)\, Clearly, $C_xO-C_xO\subset T_xO$. Conversely, let $h\in T_xO$. Then $h=Dr(x)k$, where $k=(a, w)\in E.$  
If $i\in I(x)$, we set $$a_i^\pm=\frac{\abs{a_i}\pm a_i}{2}.$$ 

Then, $a_i^\pm\geq 0$ and $a_i=a^+_i-a^-_i$. Now we define elements $k^\pm\in E$ as follows.  First, $k^+=(b, w),$ where $b_i=a_i$ if $i\not \in I(x)$ and $b_i=a^+_i$ if $i\in I(x)$. The element $k^-$ is defined as $k^-=(c, 0),$ where $c_i=0$ if $i\not \in I(x)$ and $c_i=a_i^-$ if $i\in I(x)$. Then $k=k^+-k^-$ and if $h^\pm =Dr(x)k^\pm$, then, by (2), we have $h^\pm\in  C_xO$ and 
$h=h^+-h^-\in C_xO-C_xO$. The proof of (3) and hence the proof of Lemma \ref{characterization_reduced_tangent}  is complete.

\qed \end{proof}

From the characterization of $T_xO$ and $C_xO$ in 
Lemma \ref{characterization_reduced_tangent} we  deduce immediately the next  proposition,
where $(O,C,E)$ is as described before and similarly $(O',C',E')$ with $E'={\mathbb R}^{k'}\oplus W'$ and $C'=[0,\infty)^{k'}\oplus W'$ 
\begin{proposition}\label{reduced_tangent_under_sc_diff}
Let $(O,C,E)$ and $(O',C',E')$ be sc-smooth retracts as just described,   and let $x\in O_\infty$. If $f\colon 
(O,x)\rightarrow (O',f(x))$
is  a germ of a sc-diffeomorphism mapping $x\in O_\infty$ onto $f(x)=y\in O'_\infty$, then 
$$
Tf(x)T^{\textrm{R}}_xO= T^{\textrm{R}}_{y}O'\quad  \text{and}\quad Tf(x)C_xO= C_yO'.
$$
\qed
\end{proposition}
We note that in view of the previous proposition the definition of the spaces  $T^R_xO$ and $C_xO$ is natural
and they are respected by the tangent of a  local sc-diffeomorphism.  Hence we can define
for an arbitrary  sc-retract $(O,C,E)$ and a point $x\in O_\infty$ the {\bf reduced tangent}\index{Reduced tangent} $T^R_xO$ and the {\bf partial cone}\index{Partial cone} $C_xO$.
In case  there exists a linear sc-isomorphism  $S:T_xO\rightarrow {\mathbb R}^n\oplus W$ satisfying $S(C_x)=[0,\infty)^n\oplus W$ we shall call $C_x$ a {\bf partial quadrant}\index{Partial quadrant}.
\begin{remark}\index{R- Tameness and partial quadrants}
Later on we shall introduce the notion of a tame M-polyfold. In view of the following Theorem \ref{hofer} and the later Proposition \ref{tame_equality} the tameness
implies that for this particular case the partial cones are always partial quadrants.
\qed
\end{remark}


A sc-smooth retract $O$ associated with a triple 
$(O, C, E)$ is a M-polyfold and, recalling Definition \ref{M_polyfold_degeneracy _index}, its degeneracy index $d_O(x)$ at the point $x$ is the integer 
$$d_O(x)=\min d_{C'}(\varphi (x))$$
where the minimum is taken over all germs of sc-diffeomorphisms 
$$
\varphi\colon (O, x)\to (O', \varphi (x))
$$
 into sc-smooth retracts $O'$ associated with $(O', C', E')$. The integer $d_{C'}(\varphi (x))$ is introduced in 
Section \ref{subsection_boundary_recognition}.  


\begin{theorem}\label{hofer}\index{T- Basic properties of $d_O$}
Let  $(O,C,E)$ be a smooth retract and let $d_O$ be the degeneracy index of $O$. 
If $x\in O$ is a smooth point, we have the 
inequality
$$
\dim (T_xO/T^R_xO)\leq  d_O(x).
$$
Moreover, if
$\dim(T_xO/T^R_xO)=d_O(x)$, then 
$C_xO$ is a partial quadrant in $T_xO$. 
\end{theorem}
\begin{proof}
Let $x$ be a smooth point of the retract $O$. 
By 
Proposition \ref{reduced_tangent_under_sc_diff} 
the dimension of $T_xO/T^R_xO$ is preserved 
under germs of sc-diffeomorphisms.  Hence, in view of the definition of $d_O(x)$, we may assume, without loss of generality,  that
$$d_O(x)=d_C(x)\equiv d$$ 
Moreover, without loss of generality, we may  assume that $E=\R^k\oplus W$, 
$C=[0,\infty)^k\oplus W$
and $x=(0,\ldots ,0,x_{d+1},\ldots , x_k, w)$, where $x_i>0$ for $d+1\leq i\leq k$ and 
$w\in W$. We recall that if $v=(a, b, w)\in T_x^RO\subset \R^d\oplus R^{k-d}\oplus W$, then $a=0$,  and if $v=(a, b, w)\in C_xO$, then $a_i\geq 0$ for $1\leq i\leq d$.


In order to prove the first statement, we choose smooth vectors $v^1,\ldots v^l$ in $T_xO$ such that $(v^j+T_x^RO)_{1\leq j\leq l}$ are linearly independent in the vector space $T_xO/T_x^RO$. 
Representing $v^j=(a^j,b^j, w^j)\in \R^d\oplus R^{k-d}\oplus W$, we claim that the vectors $(a^j)_{1\leq j\leq l}$ are linearly independent in $\R^d$. 
Indeed, assuming  that  
$\sum_{j=1}^l\lambda_ja^j=0$, we have  
$$\sum_{j=1}^l\lambda_jv^j=\bigl(0, \sum_{j=1}^l\lambda_jb^j, \sum_{j=1}^l\lambda_jw^j\bigr)\in T^R_xO,$$
hence 
$$\sum_{j=1}^l\lambda_j\bigl(v^j+T_x^RO\bigr)=\bigl(\sum_{j=1}^l\lambda_jv^j\bigr)+T_x^RO=T_x^RO.$$
Since $(v^j+T_x^RO)_{1\leq j\leq l}$ 
are linearly independent  in $T_xO/T_x^RO$,  we conclude that $\lambda_1=\ldots =\lambda_l=0$, proving our claim. This implies that the vectors $a^1,\ldots ,a^l$ are linearly independent in $\R^d$. Therefore, $l\leq d$ and hence $\dim(T_xO/T^R_xO)\leq  d=d_O(x)$, proving the first statement of the theorem.

In order to prove the second statement, 
we assume that $\dim(T_xO/T^R_xO)=d_O(x)$. 
If now $(v^j+T^R_xO)_{1\leq j\leq d}$ is a basis of $T_xO/T^R_xO$, then  representing  $v^j=(a^j,b^j, w^j)\in T_xO\subset   \R^d\oplus \R^{k-d}\oplus W$ and arguing as above,   the vectors $a^j$ for $1\leq j\leq d$ form a basis of  $\R^d$. 
Consequently, the map 
$\Phi\colon 
T_xO/T^R_xO\to \R^d$, defined by 
$$\Phi (v+T^R_xO)=\Phi ((a, b, w)+T^R_xO)=a,$$
is a linear  isomorphism. Moreover, if $v=(a, b, w)\in C_xO$  so that $a_j\geq 0$ for $1\leq j\leq d$, then 
$$\Phi (v+T^R_xO)=\Phi ((a, b, w)+T^R_xO)\in [0,\infty)^d.$$

Denoting by $e^j$ for $1\leq j\leq d$ the standard basis of $\R^d$, we introduce $\Phi^{-1}(e^j)=\wh{v}^j+T^R_xO$. By definition, the vectors $v^j$ are of the form 
$\wh{v}^j=(e^j, \wh{b}^j, \wh{w}^j)$ and  are linearly independent in $\R^d\oplus \R^{k-d}\oplus W$.   
If now $v=(a, b, w)\in T_xO$, we have the decomposition 
\begin{equation*}
\begin{split}
v=(a, b, w)&=\sum_{j=1}^da_j\wh{v}^j+\bigl(v-\sum_{j=1}^da_j\wh{v}^j\bigr)
\end{split}
\end{equation*}
where  $a=(a_1,\ldots ,a_d)\in \R^d$. Since the second term  on the right-hand side belongs to $T_x^RO$,  we  have the following decompositions of the tangent space $T_xO$ and of $C_xO$,
\begin{align*}
T_xO=\R \wh{v}^1\oplus \ldots \oplus \R \wh{v}^d\oplus T_x^RO\quad \text{and}\quad 
C_xO=\R^+\wh{v}^1\oplus \ldots \oplus \R^+\wh{v}^d\oplus T_x^RO.
\end{align*}
Therefore, the map $T\colon T_xO\to \R^d\oplus T_xO$, defined  by 
$$T(\lambda_1\wh{v}^1,\ldots ,\lambda_d\wh{v}^d, w)=(\lambda_1, \ldots ,\lambda_d, w)$$
is a sc-linear isomorphism
satisfying $T(C_xO)=[0,\infty )^d\oplus T_x^RO$.
 Hence $C_xO$ is a partial quadrant in $T_xO$ and the second statement of Theorem \ref{hofer} is proved.  
\qed \end{proof}

The  partial quadrant $C$ in $E$ is the  image of the sc-smooth retraction $r=\mathbbm{1}_{C}\colon C\to C$. In particular, $C$ is a M-polyfold which we denote by $X_C$. 
In Section \ref{subsection_boundary_recognition}, we have defined the map $d_C\colon 
C\to \N$. Above, we have defined the degeneracy index $d_{X_C}\colon 
X_C\to \N$ of the M-polyfold $X_C$.   By definition, 
$d_{X_C}\leq d_C$ and we shall prove that $d_{X_C}=d_C$.  We may assume  without loss of generality
that $C=[0,\infty)^k\oplus W$ and $E={\mathbb R}^k\oplus W$.  For a smooth point $x\in C$ we have $T_xC=E$ and $T_x^RC=E_x$,  implying 
$\dim(T_xC/T_x^RC)=d_C(x)$. This, of course, also holds for any partial quadrant $C\subset E$. Hence, 
$$
d_C(x) = \dim(T_xX_C/T_x^RX_C)
$$
for a smooth point $x\in C$. From this we deduce  the following corollary of Theorem \ref{hofer}
\begin{corollary}\label{equality_of_d}\index{C- Computation of $d_{X_C}$}
Let $C$ be a partial quadrant in a sc-Banach space. Considering $C$ as a M-polyfold,  denoted by $X_C$,  we have the equality 
$$
d_C=d_{X_C}.
$$
\end{corollary}
\begin{proof}
Let us first take  a smooth point $x\in C$. In view of Theorem \ref{hofer}
$$
\dim(T_x X_C/T_x^R X_C)\leq d_{X_C}(x).
$$
Since $d_C(x)=\dim(T_x X_C/T_x^R X_C)$ as we have just seen,  it follows that $d_C(x)\leq d_{X_C}(x)$. By definition of  $d_{X_C}(x)$,  we always have the 
inequality $d_{X_C}(x)\leq d_C(x)$. Consequently,  
$$
d_{X_C}(x)=d_C(x)\quad  \text{if $x\in C_\infty$.}
$$
If $x\in C$ is arbitrary, we take  a sequence of smooth points $x_k\in C$ converging to $x$ and satisfying $d_C(x_k)=d_C(x)$. Hence, 
$$
d_C(x)=d_C(x_k) =d_{X_C}(x_k).
$$
In view of the definition of $d_{X_C}$ we  find a sc-diffeomorphism $f\colon 
U(x)\rightarrow O'$, where $U(x)\subset C$ is relatively open,  and $(O',C',E')$ is a sc-smooth retract, so that
$$
d_{X_C}(x)=d_{C'}(f(x)).
$$
Then $f(x_k)\rightarrow f(x)$ and trivially $d_{C'}(f(x_k))\leq d_{C'}(f(x))$ for large $k$. Hence, for large $k$, 
\begin{equation*}
\begin{split}
d_C(x)&=d_C(x_k)=d_{X_C}(x_k)\\
&=d_{X_{C'}}(f(x_k))\leq  d_{C'}(f(x_k))\leq d_{C'}(f(x)) =d_{X_C}(x).
\end{split}
\end{equation*}
Since $d_{X_C}(x)\leq d_C(x)$,  we  conclude 
$d_{X_C}(x)=d_C(x)$ and the proof of 
Corollary \ref{equality_of_d} is complete.
\qed \end{proof}
From now on we do not have to distinguish between  the index $d_C$  defined for partial quadrants and the degeneracy index $d_{X_C}$, 
where we view $C$ as a  M-polyfold.


\section{Tame M-polyfolds}\label {subsec_tame_m_polyfolds}
In order to define spaces whose boundaries have more structure, we introduce the notion of a tame M-polyfold
and of tame retractions and tame retracts. We start with some basic geometry.


Let $C\subset E$ be a partial quadrant in a sc-Banach space $E$. We begin with the particular case
$E={\mathbb R}^k\oplus W$ and $C=[0,\infty)^k\oplus W$.  We recall  the linear sc-subspace $E_i$ of codimension $1$ defined as  
\begin{equation}\label{k^4}
E_i=\{(a_1,\ldots, a_k,w)\in {\mathbb R}^k\oplus W\ \vert \,  a_i=0\}.
\end{equation}
Associated with  $E_i$, there is  the closed half space $H_i$  consisting of all elements $(a,w)$ in $ {\mathbb R}^k\oplus W$ satisfying  $a_i\geq 0$, 
\begin{equation}\label{k^5}
H_i=\{(a_1,\ldots, a_k,w)\in E\ |\ a_i\geq 0\}.
\end{equation}

In the general case of  a partial quadrant $C$ in $E$,  we can describe the above definitions in a more  intrinsic way as follows.
 We  consider the set $\{e\in C\,\vert \, d_C(e)=1\}$ of boundary points. This set has exactly $k$ connected components, which we denote by $A_1,\ldots ,A_k$. Each component $A_i$ lies in the smallest subspace $f_i$ of $E$ containing $A_i$. We call $f_i$ an {\bf extended face} and denote by ${\mathcal F}$ the set of all extended faces. The set ${\mathcal F}$ contains exactly $k$ extended faces. 
 Given an extended face $f\in {\mathcal F}$,  we denote  by $H_f$ the closed half subspace of $E$ which contains $C$.  
 In the special case $C=[0,\infty)^k\oplus W\subset \R^k\oplus W$, 
 the  extended  faces  $f_i$ are the subspaces $E_i$, and the half spaces $H_{f_i}$ are the half subspaces $H_i$. 
 
 If  $e\in C$,  we introduce the set of all extended faces containing $e$ by 
 $$ {\mathcal  F}(e)=\{f\in {\mathcal F} \vert \, e\in f\}.$$
Clearly, 
 $$d_C(e)=\# {\mathcal F}(e).$$
 \begin{definition}\label{new_def_2.33}
The {\bf partial quadrant $C_e$}\index{D- Partial quadrant $C_e$}  associated  with  $e\in C$ is defined as 
$$
C_e:= \bigcap_{f\in {\mathcal F}(e)} H_f.\index{$C_e$}
$$
The  {\bf minimal linear subspace}\index{D- Minimal linear subspace} associated with  $e\in C$ is defined by
$$
E_e:=\bigcap_{f\in {\mathcal F}(e)} f.\index{$E_e$}
$$
\qed
\end{definition}
Clearly, the following inclusions hold,
$$
E_e\subset C_e\subset E.
$$
For an interior point $x\in C$, i.e. a point satisfying $d_C(x)=0$, we set $E_e=C_e=E$.  The codimension of $E_e$  in $E$ is precisely $d_C(e)$.
The maximal value $d_{C_e}$ attains  is $d_C(e)$.

Next we introduce a special class of sc-smooth retracts. 
\begin{definition}[{\bf Tame sc-retraction}] \label{tame_retarctions}\index{D- Tame sc-smooth retraction}
Let $r\colon U\to U$ be a sc-smooth retraction defined on a relatively open subset $U$ of a partial quadrant $C$ in the sc-Banach space $E$.
The sc-smooth retraction  $r$ is  called a {\bf tame sc-retraction}, if  the following two conditions are satisfied.
\begin{itemize}
\item[(1)]\ \text{ $d_C(r(x))=d_C(x)$ for all  $x$ in $U$.}
\item[(2)]\ At every smooth point $x$ in $O:=r(U)$, there exists a sc-subspace $A\subset E$, such that $E=T_xO\oplus A$ and $A\subset E_x$. 
\end{itemize}
A sc-smooth retract $(O,C,E)$ is called a {\bf tame sc-smooth retract},  if $O$ is the image of a sc-smooth  tame
retraction.
\qed
\end{definition}

Let $x$ be a smooth point in the tame sc-retract $O$ and let $A\subset E_x$ be a sc-complement of the tangent space $T_xO$ as guaranteed by condition (2) in Definition \ref{tame_retarctions}, so that 
\begin{equation}\label{eq_T_oplus_A}
E=T_xO\oplus A.
\end{equation}
We recall that $T_xO=Dr(x)E$ and hence 
\begin{equation}\label{eq_T_oplus_A_1}
\begin{split}
E&=Dr(x)E+(\mathbbm{1}-Dr(x))E\\
&=T_xO+(\mathbbm{1}-Dr(x))E.
\end{split}
\end{equation}
Applying  the projection $\mathbbm{1}-Dr(x)$ to the equation \eqref{eq_T_oplus_A} and using that $(\mathbbm{1}-Dr(x))T_xO=0$, we obtain 

\begin{equation}\label{eq_T_oplus_A_2}
(\mathbbm{1}-Dr(x))E=(\mathbbm{1}-Dr(x))A.
\end{equation}

We claim that $(\mathbbm{1}-Dr(x))E\subset E_x$. In order to prove this claim we recall that $A\subset E_x$, so that, in view of \eqref{eq_T_oplus_A_2}, 
it is sufficient to prove that $Dr(x)E_x\subset E_x$.  We may assume that $E=\R^k\oplus W$ and $x=(0,\ldots ,0,x_{d+1},\ldots,x_k,w)$ with 
$x_{d+1},\ldots,x_k>0$. We choose a smooth point $y\in E_x$ so that $y=(0,\ldots,0,y_{d+1},\ldots,y_k,v)$. If $\abs{\tau}$ is small, then 
$x_\tau:=x+\tau y$ belongs to  the partial quadrant $C$ and has 
 the first $d$ coordinates vanishing. By condition (1) in Definition \ref{tame_retarctions} of a tame sc-retraction $r$, we have  $d_C(r(x+\tau y))=d_C(x+\tau y).$  Hence 
 the first 
 $d$ coordinates of $r(x+\tau y)$ 
 vanish, and from
 $$
 \dfrac{d}{d\tau}r(x+\tau y)\bigl\lvert_{\tau=0}=Dr(x)y
 $$
 we conclude that the first $d$ coordinates of $Dr(x)y$ 
 vanish.  The same is true if $y$ is on level $0$ in $E_x$. So, $Dr(x)E_x\subset E_x$ and hence, in view of \eqref{eq_T_oplus_A_2}, we have verified that $(\mathbbm{1}-Dr(x))E\subset E_x$, as claimed.
In view of  \eqref{eq_T_oplus_A_1}, we can therefore always assume, without loss of generality,  that in condition (2) of Definition \ref{tame_retarctions} the complement $A$ of $T_xO$ is equal to $A=(\mathbbm{1}-Dr(x))E$. 
Summarizing the discussion we have established the following proposition. 
\begin{proposition}\label{IAS-x}\index{P- Properties of tame retractions}
Let $U\subset C\subset E$ be a relatively open subset of a partial quadrant in a sc-Banach space and let $r\colon 
U\rightarrow U$  be 
a sc-smooth tame retraction. Then,  for every smooth point $x\in O=r(U)$,  the sc-subspace $(\mathbbm{1}-Dr(x))E$ is a subspace of $E_x$, so that in condition (2) of Definition \ref{tame_retarctions} we can take $A=(\mathbbm{1}-Dr(x))E$.
\qed
\end{proposition}

A particular example of sc-smooth retractions occurring in applications are splicings.
\begin{definition}\index{D- Splicings} 
A  sc-smooth  {\bf splicing} consists of the following data. A relatively open neighborhood  $V$ of $0$ in $[0,\infty)^k\times {\mathbb R}^{n-k}$
and a map which associates to $a\in V$ a sc-projection operator $\pi_a:E\rightarrow E$, where $E$ is an sc-Banach space so that 
 the map $V\times E\rightarrow E:(a,e)\rightarrow \pi_a(e)$ is sc-smooth. 
 \qed
 \end{definition}
 \begin{lemma}\index{L- Tameness of splicings}
 Let $V\ni a\rightarrow \pi_a$ be an sc-smooth splicing. Then 
 defining $U=V\times E$ and 
$r:U\rightarrow U$ by
$$
r(a,e)=(a,\pi_a(e))
$$
we obtain a sc-smooth tame retraction. 
\end{lemma}
\begin{proof}It is clear that with $D=[0,\infty)^k\times {\mathbb R}^{n-k}\times E$ the set $U$ is relatively open in $D$ 
and it holds that  
$d_D(a,e) = d_D(r(a,e))$.   Suppose $(a,e)$ is a smooth point in $O=r(U)$ implying that $\pi_a(e)=e$.
Then $T_{(a,e)}O$  consists of all $(b,k)$ with 
$$
k=\pi_{a}(k) +\sum_{i=1}^n (\partial (\pi_a(e))/\partial a_i)\cdot b_i.
$$
This in particular implies that 
\begin{eqnarray}\label{EQN209}
\sum_{i=1}^n (\partial (\pi_a(e))/\partial a_i)\cdot b_i\in  R(Id-\pi_a)=\ker(\pi_a).
\end{eqnarray}
Denote by $F$ the collection of all $(0,\ell)$ with $\pi_a(\ell)=0$ and observe that $F\subset \{0\}^n\times E\subset T^R_{(a,e)}(D)$.
If $(b,f)\in F\cap T_{(a,e)}O$ it follows that $b=0$ and $\pi_a(f)=f$ and $\pi_a(f)=0$, implying $(b,f)=(0,0)$.
On the other hand if $(b,f)\in T_{(a,e)}(U)=T_{(a,e)}(D)$, we can write,  abbreviating $\tau:= \sum_{i=1}^n (\partial (\pi_a(e))/\partial a_i)\cdot b_i$
$$
(b,f) = (b,  \pi_a(f) + \tau) + (0, (I-\pi_a)(f) - \tau).
$$
It holds $\pi_a((I-\pi_a)(f) - \tau)=-\pi_a(\tau)=0$ in view of (\ref{EQN209}), so that $(0, (I-\pi_a)(f) - \tau)\in F$. Further
$$
(Id-\pi_a)( \pi_a(f) + \tau)=\tau 
$$
showing that $ (b,  \pi_a(f) + \tau)\in T_{(a,e)}O$. Hence we have the sc-direct sum $T_{(a,e)}U= T_{(a,e)}O \oplus F$, with $F\subset T_{(a,e)}^R(U)$ implying that
$r$ is a tame sc-smooth retraction.
\qed \end{proof}
Next  discuss the tame sc-smooth retracts in more detail. 
\begin{proposition}\label{tame_equality}\index{P- Basic equality for tame retracts}
Let $(O,C,E)$ be a tame sc-smooth retract,  and let $x\in O_\infty$ be a smooth point of $O$.
Then, $T_x^{\textrm{R}}O$ is a sc-Banach space of codimension $d_O(x)$ in $T_xO$, so that 
\begin{equation}\label{opp}
\dim(T_xO/T^R_xO)=d_O(x). 
\end{equation}
In particular,   $C_xO$ is a partial quadrant in the tangent space $T_xO$.
In addition,  for every point $x\in O$, we have the equality
\begin{equation}\label{equality_d_O_and_d_C_1}
d_O(x)=d_C(x).
\end{equation}
\end{proposition}
\begin{proof}
We assume that $O=r(U)$ is the retract in $U\subset C\subset E$ associated to  the tame sc-retraction $r\colon 
U\to U$. Moreover, we may assume that $C=[0,\infty )^k\oplus W\subset E=\R^k\oplus W$. 

Then the  condition (2) of Definition \ref{tame_retarctions}  says that,  for every $x\in O_\infty$ there exists a sc-subspace $A$ of $E$, satisfying  $E=\text{im}\ Dr(x)\oplus A =T_xO\oplus A$ and $A\subset E_x$, where $E_x=E_{I(x)}$.  
Therefore, 
\begin{equation}\label{direct_sum_1}
E_x=(T_xO\oplus A)\cap E_x= (T_xO\cap E_x)\oplus (A\cap E_x)=T_x^{\textrm{R}}O\oplus A, 
\end{equation}
since  $A\subset E_x$. The space $E_x$ has codimension $d_C(x)$ in $E$, so that 
\begin{equation}\label{direct_sum_2}
d_C(x)=\dim\bigl(E/E_x \bigr)= \dim \bigl(T_xO\oplus A /T_x^{\textrm{R}}O\oplus A \bigr)=  \dim \bigl(T_xO /T_x^{\textrm{R}}O \bigr).
\end{equation}
Employing Theorem \ref{hofer},  we conclude from 
\eqref{direct_sum_2} that
$d_C(x)\leq d_O(x) $ for all $x\in O_\infty$.
By definition,  $d_O(x)\leq d_C(x)$ for all $x\in O$,  and hence, 
\begin{equation}\label{eq_d_C=d_O}
d_C(x)=d_O(x)\quad \text{if  $x\in O_\infty$.}
\end{equation}
Consequently, $\dim T_xO/T_x^RO=d_O(x)$. Employing 
Theorem \ref{hofer} once more, $C_xO$ is a partial quadrant in the tangent space $T_xO$.

It remains to prove that $d_O(x)=d_C(x)$ for all (not necessarily smooth) points $x\in O$. If $x=(a, w)\in O$,  we take a sequence $(w_j)\subset W_\infty$  converging to $w$  in $W$. 
Then the sequence $x_j\in O$, defined by $x_j=r(a, w_j)$, consists of smooth points and converges to $x$ in $E$.
Since, by assumption, the  retraction $r$ is tame, 
$$d_C(x_j)=d_C(r(a, w_j))=d_C(a, w_j)=d_C(a, w)=d_C(x)$$
and, using  \eqref{eq_d_C=d_O}, we conclude 
that $d_O(x_j)=d_C(x_j)=d_C(x).$
By definition of $d_O$, we find an open neighborhood $V'\subset O$ around $x$, such that 
$d_O(y)\leq d_O(x)$ for all $y\in V'$. Consequently, for large $j$,
$$d_O(x)\geq \lim_{j\to \infty}d_O(x_j)=d_C(x).$$
In view of $d_O(x)\leq d_C(x)$, we conclude 
$d_O(x)=d_C(x)$, and the proof of Proposition \ref{tame_equality} is complete.
\qed \end{proof}


Among all M-polyfolds, there is a distinguished class of M-polyfolds which are modeled on tame retracts.
These turn out to have an interesting and useful boundary geometry.

\begin{definition}\label{def_tame_m-polyfold}\index{D- Tame M-polyfold}
A  {\bf tame M-polyfold} $X$ is a M-polyfold which possesses an equivalent sc-smooth atlas whose charts are all modeled on {\bf tame} sc-smooth retracts.
\qed
\end{definition}
By Proposition \ref{reduced_tangent_under_sc_diff}, the following concepts for any M-polyfold  are well-defined and independent of the choice of the charts.



\begin{definition}\label{def_partial_cone_reduced_tangent}\index{D- Reduced tangent space}
Let $X$ be a  M-polyfold. For a smooth point $x\in X$,  the {\bf reduced tangent space $T^R_xX$}\index{$T^R_xX$}  is, by definition, the sc-subspace of the tangent space
$T_xX$   which, by definition,   is the preimage of $T_o^RO$ under any  chart $\psi\colon 
(V,x)\rightarrow (O,o)$, so that 
$$ 
T\psi(x) (T_x^RX) = T_o^RO = T_oO \cap E_o.
$$
 For a smooth point $x\in X$,  the {\bf partial cone} $C_xX$\index{Partial cone}\index{$C_xX$} is the closed convex subset of $T_xX$ which under a sc-smooth chart $\psi$ as above is mapped onto $C_oO$, i.e.
$$
T\psi(x)(C_xX) =  T_oO \cap C_o.
$$
\qed
\end{definition}

\begin{remark}\index{R- Tameness and partial quadrants}\label{tamecone}
From Proposition \ref{tame_equality} we conclude, if  
the M-polyfold $X$ is tame and if $x\in X$ is a smooth point, that $C_xX$ is a partial quadrant in the tangent space $T_xO$, and  we have the identity
$$
d_X(x)=\dim(T_xX/T_x^RX) = d_{C_xX}(0_x),
$$
where $0_x$ is the zero vector in $T_xX$.  
\qed
\end{remark}

We are going to show that the boundary of a tame M-polyfold has an additional structure. 
\begin{definition} \label{DEF248}\index{D- Face of an M-polyfold}\index{D- Face}
Let $X$ be a tame M-polyfold.
A {\bf face} $F$ of $X$  is the closure of a connected component in the subset $\{x\in X\ |\ d(x)=1\}$.
The  M-polyfold $X$ is called {\bf face-structured},  if every point $x\in X$ lies in exactly $d_X(x)$ many faces.
\qed
\end{definition}
Before we study faces in more detail we have a look at the local situation.
\begin{proposition}\label{PROP248} \index{P- Properties of tame $r$}
Assume that $E={\mathbb R}^k\oplus W$,  $C=[0,\infty)^k\oplus W$, $U\subset C$
is a relatively open subset  and $r:U\rightarrow U$ is a tame sc-smooth
retraction.  Suppose $U$ contains a point of the form $(0,w)$. Then the following holds.
\begin{itemize}
\item[{\em(1)}]\ The set $O=r(U)$ contains a smooth point of the form $(0,v)$.
\item[{\em(2)}]\ For a point $(0,v)\in O$  denote for $i=1,...,k$ by
$U_i$ the connected component in $U\cap E_i$ containing $(0,v)$. 
Then $r(U_i)\subset U_i$.
\item[{\em(3)}]\ For every $i=1,..,k$ the set $O\cap E_i$ contains points $y$  with $d_C(y)=1$
and these points form an open and dense subset of $O\cap E_i$.
\end{itemize}
\end{proposition}
\begin{proof}
(1) Since $d_C(0,w)=k$ we deduce that $d_C(r(0,w))=k$. This means $r(0,w)$ has the form $(0,v)$. Replacing
$w$ by a nearby smooth point we deduce that $O$ contains a smooth point of the form $(0,v)$.\par

(2)  Since $r(0,v)=(0,v)$, taking a nearby smooth $v'$ to $v$ the point $r(0,v')$ is smooth and close to $(0,v)$.
Since $d_C(r(0,v'))=d_C(0,v')=k$ it follows that $r(0,v')$ has the form $(0,w)$.
We also note that $(0,v)$ and $(0,w)$ belong both to $U_i$. Hence we may assume without loss of generality
that the given $(0,v)$ was already smooth.
By assumption $T_{(0,v)}O$ has an sc-complement contained 
in $\{0\}\oplus W$. This implies that we find smooth vectors of the form $e_1=(1,0,...,0,w_1),...,e_k=(0,...,1,w_k)$ in $T_{(0,v)}O$.
It holds
$$
Dr(0,v)(e_i)=e_i.
$$
Define $\wh{e}_i=\sum_{j\neq i}e_i$ which takes the form $(1,1,..,1,0,1,1,...1,q)$ for a smooth $q$
and $0$ occurs at the $i$-th coordinate. We note that for small $t\geq 0$ the point $(0,v)+t\wh{e}_i$ belongs to
$U\cap E_i$ and we can consider the path 
$$
t\rightarrow\Phi(t):= r((0,v)+t\wh{e}_i).
$$
We claim that for $t>0$ and small,  only the $i$-coordinate of $\Phi(t)$ vanishes.
We know that for $t>0$ small $d_C(\Phi(t))=d_C((0,v)+t\wh{e}_i)=1$. Consequently
precisely one of the first $k$ coordinates vanishes. We compute
\begin{eqnarray*}
\Phi(t)-(0,v)&=&\Phi(t)-\Phi(0)\\
&=&\int_0^t \left(Dr((0,v)+\tau \wh{e}_i)\wh{e}_i\right) d\tau \\
&=&t\cdot \wh{e}_i + \int_0^t \left((Dr((0,v)+\tau\wh{e}_i)-Dr(0,v))( \wh{e}_i) \right)d\tau\\
&+&  t \wh{e}_i  + t\delta(t),
\end{eqnarray*}
where $|\delta(t)|_0\rightarrow 0$. This implies that  the vanishing coordinate  must be the $i$-th one. 
This discussion shows that given $(0,v)$ in $O$ we can connect $(0,v)$ to a smooth $(0,v')$
via a path of the form $(0,v_t)$. Moreover, we have shown that there exists a smooth point
$(a,q)\in O$ with $a_i=0$ and $d_C(a,q)=1$ which moreover belongs to $U_i$. Given any other
point $(a',q')\in U_i$ we can connect it with $(a,q)$ by a continuous path $\gamma(t)\in U_i$
with $d_C(\gamma(t))=1$. Since $d_C(r(\gamma(t)))=1$ and the $i$-coordinate of $\gamma(0)$ vanishes
it has to vanish for all $t\in [0,1]$. This implies by a continuity argument that $r(U_i)\subset U_i$. \par

(3) Let $y\in O\cap E_i$. We can write $y=(a,w)$, where $a_i=0$. Moving $(a,w)$ slightly
to some $(b,v)$ with $v$ smooth and $b_i=0$, $b_j>0$ for $j\neq i$ we find arbitrarily close
to $(a,w)$ an element $r(b,v)$ of the form described.  Note that $d_C(r(b,v))=1$.
This shows that the desired elements are dense. The openness statement is trivial.
\qed \end{proof}




\begin{lemma}\label{ert}\index{L- Properties of tame $r$}
Let $(O,C,E)$ be a sc-smooth, tame retract and let ${\mathcal F}$ be the collection of extended faces,
associated with the partial quadrant  $C$.  Then the faces $F$  in $O$ are the connected components of the sets $f\cap O$, where 
$f\in {\mathcal F}$ are extended faces. The connected components of $f\cap O$ and $f'\cap O$,
containing a point $x \in O$, are equal if and  only if  $f=f'$.
\end{lemma}
\begin{proof}
By definition of $O$, the retract $O$ itself  is a tame M-polyfold. We denote by $U\subset  C\subset E$
the  relatively open subset in the  partial quadrant $C$, on which a tame sc-smooth retraction satisfies 
$r(U)=O$. Let $\wh{F}$ be a connected component
of the subset $\{x\in O\, \vert \, d_O(x)=1\}$. By Proposition \ref{tame_equality}, $d_O=d_C$ so that this set is  the same as a connected component
of $\{x\in O\, \vert \, d_C(x)=1\}$. If we look at  the isomorphic case $E={\mathbb R}^k\oplus W$, we see immediately, that there
exists an index  $i$, such  that $\wh{F}$
must lie in the subset of $C$, consisting of points $(a,w)$, for which $a_i=0$. We conclude that there exists
an extended face $f\in {\mathcal F}$, such that $\wh{F}\subset f$. Therefore, $\wh{F}$ is contained in a connected subset of $O\cap f$, 
and the closure of $\wh{F}$ in $O$ lies in $O\cap f$. This shows that a face of $O$ is contained in a connected component of some $O\cap f$.\par

Next we consider  a connected component $Q$ of $O\cap f$, where  $f$ is an extended face of $C$. Let $e\in Q$. By assumption, $e\in f$ and we can take a (suitable) vector $h\in f$ so small, that $e+th\in U\cap f$ for $t\in (0,1]$,
and such that  for $t\in (0,1]$ the points $e+th$ do not belong to any extended face other than $f$.
This follows from Proposition \ref{PROP248} and can be constructed explicitly, using the model $E={\mathbb R}^k\oplus W$ for $E$. Since the retraction $r$ is tame,  we have $d_{C}(r(e+th))=1$ for $t\in (0,1]$, and 
for $t\in (0,1]$ the points $r(e+th)$ belong
to the same connected component of $\{x\in O\ |\ d_O(x)=1\}$. Using  this argument repeatedly,
 we can connect any two points in $Q$ by a continuous path $\gamma\colon 
[0,1]\rightarrow Q$,
such that  the points $y\in \gamma(0,1)$ satisfy  $d_C(y)=1$. This implies that $Q$ is contained in the closure of a connected component $\wh{F}$ in $\{x\in X\ |\ d_O(x)=1\}$.\\
The discussion so far characterizes the faces of $O$ as the connected components of the sets $O\cap f$, where $f$ is some extended face.\par

The assertion that  connected components of $f\cap O$ and $f'\cap O$,
containing a point $x \in O$, are equal if and  only if  $f=f'$ is trivial. 
\qed \end{proof}


\begin{corollary}\label{cor_2.42}\index{C- Characterization of $d_O$ for tame $O$}
If  $(O,C,E)$ is a tame sc-smooth retract, then every point $x\in O$ lies in precisely $d_O(x)$ many faces.
 \end{corollary}
 \begin{proof}
 In view of Proposition \ref{tame_equality}, $d_O(x)=d_C(x)$, so that $x$ belongs to precisely $d:=d_C(x)$ extended faces $f\in {\mathcal F}(x)$, let us say, it belongs to the faces $f_1,\ldots ,f_d$ in the sc-Banach space $E=\R^k\oplus W$, defined as the subspaces $f_i=\{(a_1,\ldots, a_k, w)\vert \, a_i=0\}$, $1\leq i\leq d$. The point $x$ is represented  by $x=(0,\ldots ,0, a_{d+1}, \ldots, a_k, w)$, where 
 $a_j\neq 0$ for $d+1\leq j\leq k$. Let $r\colon 
U\to U$ be the tame  retraction onto $O=r(U)$. Then,  the paths $\gamma_i(t)$ in $O$ for $1\leq i\leq d$, starting at $\gamma_i(0)=x$ are  defined by $$
 \gamma_i(t) = r(t,\ldots ,t, a_i=0, t,\ldots, t, a_{d+1},\ldots ,a_k,w).
 $$
Because the retraction $r$ is tame we have, $d_C(\gamma_i(t))=1$ if $t>0$ and  the points $\gamma_i(t)$ belong to $f_i\cap O$, but not to any other face  $f_j\cap O$ with $j\neq i$. Hence, the connected components  of the sets $O\cap f_j$ containing $x$ for $1\leq j\leq d$ are all different. Of course, there cannot be additional components containing $x$.
 \qed \end{proof}
Corollary \ref{cor_2.42} implies immediately the following result.
\begin{proposition}\index{P- Number of local faces}
If  $X$ is  a tame M-polyfold, then every point $x\in X$ has an open neighborhood
$V$, so that $y\in V$ lies in precisely $d_X(y)$ many faces of $V$ and  $d_V(y)=d_X(y)$ for all $y\in V$.
In particular, globally, a point $x\in X$ lies in at most $d_X(x)$-many faces.
\qed
\end{proposition}

The following technical result turns out to be useful later on.  
 \begin{proposition}[Properties of faces]\label{FACE_X}\index{P- Properties of faces}
Let $(O,C,E)$ be a tame sc-smooth retract associated with the tame sc-smooth retraction $r\colon 
U\to U$ onto $O=r(U)$, and let $F$ be a face of $O$.  Then, there exists an open neighborhood $V^\ast$ of $F$ in $U$ and a sc-smooth retraction $s\colon 
V^\ast\rightarrow V^\ast$ onto  $s(V^\ast)=F$. Moreover, defining $V\subset O$
by $V=O\cap V^\ast$, the restriction $s\colon 
V\rightarrow V$ is a sc-smooth retraction onto  $s(V)=F$, so that $F$ is a sc-smooth  sub-M-polyfold of $O$.  Further, $F$ is tame, i.e. it admits a compatible sc-smooth atlas consisting of  tame local models.
In addition, 
$$
d_F(x)=d_O(x)-1\quad  \text{for all $x\in F$}.
$$
\end{proposition}
\begin{proof}
We may assume that $E={\mathbb R}^k\oplus W$ and $C=[0,\infty)^k\oplus W$. Let $U\subset C$ be a relatively open subset of the partial quadrant $C$ and let
$r\colon 
U\rightarrow U$ be a tame sc-smooth retraction onto $r(U)=O$. In view of Lemma \ref{ert}
we may assume, that our face $F$ is a connected component of $O\cap f_1$, where $f_1$ is the extended face consisting of those
points whose first coordinate vanishes. Consequently,  %
 for every  $(a,w)\in F$ we find an open  neighborhood
$U_{(a,w)}\subset U$ in $C$, such  that, if $(b, v)\in U_{(a, w)}$, then $r(0,b_2,\ldots ,b_k,v)$  has the first coordinate vanishing.
Taking the union of these neighborhoods, we find an open neighborhood $U^\ast$ of $F$ which is contained in $U$,
such that for every $(b,v)\in U^\ast$,  the point $(0,b_2,\ldots ,b_k,v)$ belongs to $ U$ and $r(0,b_2,\ldots ,b_k,v)$ has the first coordinate vanishing
and belongs to $F$.
Hence, we can define the sc-smooth map
$$
s\colon 
U^\ast\rightarrow U\quad \text{by}\quad s(b,v):=r(0,b_2,\ldots,b_k,v),
$$
which has its image in $F$, so that,  in view of $F\subset U$,  we may assume that
$$
s\colon 
U^\ast\rightarrow U^\ast.
$$
It follows that the face $F$ is a sc-smooth  sub-M-polyfold of $O$. 

We know that $F$ is a connected component of $f_1\cap O$.  We find an open neighborhood $V$
of $O$ in $f_1\cap C\subset f_1$, so that $r(V)=F$. Clearly,  $s=r\vert V\colon 
V\rightarrow V$ preserves $d_{C\cap f_1}$, since it preserves $d_C$ and $d_C=d_{C\cap f_1}+1$ on $C\cap f_1$.

If $x\in F$ is a smooth point, then $T_xF\subset T_xO$ is of codimension $1$ and hence has a complement
$P$ of dimension $1$, so that 
$$
T_xO=T_xF\oplus P.
$$
We know from Definition \ref{tame_retarctions}  of a tame retract that $T_xO$ has a sc-complement $A\subset E_x$ in $E$. Hence, 
$$
E=T_xO\oplus A = T_xF\oplus P\oplus A.
$$

In view of $P\cap f_1 = \{0\}$ and $T_xF \cap f_1 = T_xF$, we deduce
$$
f_1 = E \cap f_1 = (T_xF\oplus P \oplus A) \cap f_1 = T_xF \oplus (f_1 \cap A).
$$
Noting that $(f_1 \cap A) \subset (f_1 \cap E_x) = f_1$, the sc-smooth retraction $s \colon 
 V \rightarrow V$ onto $s(V) = F$ is tame. Since the last statement of Proposition \ref{FACE_X} is obvious, the  proof  of Proposition \ref{FACE_X} is complete.
\qed \end{proof}
In order to formulate another result along the same lines we first recall  that, given any point $x$ in a tame 
M-polyfold $X$,  we find an open neighborhood $U=U(x)$ such  that $U\cap X$ has precisely $d_X(x)$ many faces containing $x$. 

The local discussion can be summarized as follows.
\begin{proposition}\label{FACE_XXXX}
Given a tame M-polyfold $X$ every point $x$ has $d_X(x)$ many local faces containing $x$. The local faces are tame M-polyfolds
with $d_F(x)=d_X(x)-1$.  The intersection
of local faces $F_\sigma$ associated to a subset $\sigma$ of ${\mathcal F}_x$ is a tame M-polyfold of codimension $\#\sigma$
and $d_{F_\sigma}(x)=d_X(x)-\#\sigma$.
\qed
\end{proposition}

Finally we  sum up the discussion about faces in the following theorem.

\begin{theorem}\label{FACE_XX}\index{T- Faces as sub-M-polyfolds}
The interior of a face $F$ in a tame M-polyfold $X$ is a sc-smooth sub-M-polyfold of $X$.  If $X$ is face-structured, then every face $F$ is a sub-M-polyfold  and the induced M-polyfold structure is tame.
The inclusion map $i\colon F\rightarrow X$ satisfies $d_X(i(x)) = d_F(x)+1$. 
Every point $x\in X$ has an open neighborhood $U$ such that every point $y\in U$
lies in precisely $d_X(y)$-many faces of $U$. If $X$ is face-structured, then every point $x \in X$ lies in precisely 
$d_X(x)$-many global faces of $X$.
\qed
\end{theorem}



Later on we shall frequently use the following proposition about degeneracy index in fibered products.

\begin{proposition}\label{fibered-x}\index{P- Fibered products}
Let $f\colon  X\rightarrow Z$ be a local sc-diffeomorphism  and $g\colon 
Y\rightarrow Z$ a sc-smooth map.
Then the fibered product  $X{_{f}\times_g}Y$,  defined by
$$
X{_{f}\times_g}Y=\{(x,y)\in X\times Y \vert \, f(x)=g(y)\}, 
$$
is a sub M-polyfold of $X\times Y$. If $Y$ is tame, then also $X{_{f}\times_g}Y$ is tame and 
$$
d_{X{_{f}\times_g}Y}(x,y)=d_Y(y).
$$
If both $X$ and $Y$ are tame and both $f$ and $g$ are local sc-diffeomorphism, then 
$$
d_{X{_{f}\times_g}Y}(x,y)=\frac{1}{2} d_{X\times Y}(x,y)=\frac{1}{2}[d_X(x)+d_Y(y)] = d_X(x)=d_Y(y).
$$
\end{proposition}
\begin{proof}
Clearly the product $X\times Y$ is an M-polyfold,  and if both $X$ and $Y$ are tame, then  also $X\times Y$ is tame. 
To see that $X{_{f}\times_g}Y$ is a sub-M-polyfold of $X\times Y$, we take a point $(x,y)\in X{_{f}\times_g}Y$ and  fix  open neighborhoods $U$ of $x$ in $X$ and $W$ of  $f(x)$ in $Z$ so that $f\vert U\colon 
 U\rightarrow W$ is a sc-diffeomorphism. Next we choose an open neighborhood $V$ of $y$ in $Z$ such that $g(V)\subset W$. We define the map 
$R\colon 
U\times V\rightarrow U\times V$ by
$$
R(x',y') = ((f\vert U)^{-1}\circ g (y'),y'), 
$$
It is sc-smooth and satisfies $R\circ R =R$ and $R(U\times V) = (U\times V)\cap (X{_{f}\times_g}Y).$
Consequently, $X{_{f}\times_g}Y$ is a sub M-polyfold of $X\times Y$.   Next we assume, in addition,  that $Y$ is tame.  With the  point $(x,y)\in X{_{f}\times_g}Y$ and open sets $U$ and $V$ as above, we assume that $(V, \varphi', (O', C', E'))$  is a chart around $x$ such that $ (O', C', E')$ is a tame sc-smooth retract.
Then we define a map  $\Phi\colon 
(U\times V)\cap X{_{f}\times_g}Y\to O'$  by setting 
$$\Phi (x', y')=\varphi' (y').$$
The map $\Phi$ is injective since given a pair $(x', y')\in  X{_{f}\times_g}Y$, we have $x'=(f\vert U)^{-1}\circ g (y')$ and hence  $\Phi$ is homeomorphism onto $O'$.
So, the tuple 
$$
((U\times V)\cap X{_{f}\times_g}Y, \Phi, (O', C', E'))
$$
 is a chart on $X{_{f}\times_g}Y$ and any two such charts are sc-smooth compatible.  Consequently, 
 $ X{_{f}\times_g}Y$ is tame. 
To prove the formula for the degeneracy index, we 
consider the projection $\pi_2\colon 
 X{_{f}\times_g}Y\to X$, $(x, y)\to y$, onto the second  component.   In view of the above discussion, 
$\pi_2$ is a local sc-diffeomorphism and consequently preserves the degeneracy index.  
Hence  $d_{X{_{f}\times_g}Y}(x,y)=d_Y(y)$. 

If both $f$ and $g$ are sc-diffeomorphisms and $X$ and $Y$ are both tame, then it follows from the previous case that  $d_{X{_{f}\times_g}Y}(x,y)=d_X(x)$, so that 
$$d_{X{_{f}\times_g}Y}(x,y)=d_X(x)=d_Y(y).$$
Finally, since $X\times Y$ is tame, then  $d_{X\times Y}(x,y)=d_X(x)+d_Y(y)$, so that 
$$d_{X\times Y}(x,y)=d_X(x)+d_Y(y)=2d_X(x)=2d_Y(y)=2d_{X{_{f}\times_g}Y}(x,y),$$
for every $(x, y)\in X{_{f}\times_g}Y$.  The proof of Proposition \ref{fibered-x} is complete.
\qed \end{proof} 

\section{Strong Bundles}\label{section2.5_sb}
As a preparation for the study of sc-Fredholm sections in the next chapter we shall introduce in this section the notion of a strong bundle over a M-polyfold. 

As usual we shall first describe the new notion in local charts 
of a strong bundle and consider $U\subset C\subset E$, where $U$ is a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$. If $F$ is another sc-Banach space, we define the non- symmetric product
 $$
U\triangleleft F\index{$U\triangleleft F$}
$$
 as follows. As a set, $U\triangleleft F$ is the product $U\times F$, but it possesses  a double filtration
$(m,k)$ for $0\leq k\leq m+1$, defined by
$$
(U\triangleleft F)_{m,k}:=U_m\oplus F_k.
$$
We view $U\triangleleft F\rightarrow U$ as a trivial bundle. We define for $i=0,1$ 
the sc-manifolds $(U\triangleleft F)[i]$\index{$(U\triangleleft F)[i]$} by their filtrations
$$
((U\triangleleft F)[i])_{m}:= U_{m}\oplus F_{m+i},\quad m\geq 0.
$$
\begin{definition}\index{D- Strong bundle map}
\noindent A {\bf strong bundle map}
$\Phi\colon  U\triangleleft F\rightarrow U'\triangleleft F'$
is a map which preserves the double filtration and is of the form
$\Phi(u,h)=(\varphi(u),\Gamma(u,h))$,
where the map $\Gamma$ is linear in $h$. In addition,  for $i=0,1$,  the maps
$$
\Phi\colon 
(U\triangleleft F)[i]\rightarrow (U'\triangleleft F')[i]
$$
are  sc-smooth.\par

\noindent  A {\bf  strong bundle isomorphism}\index{D- Strong bundle isomorhism} is an  invertible strong bundle map whose inverse is also a strong bundle map.\par

\noindent  A {\bf  strong bundle retraction}  \index{strong bundle retraction} is a strong  bundle map
$R\colon 
U\triangleleft F\rightarrow U\triangleleft F$
satisfying, in addition,  $R\circ R=R$.  The map  $R$ has the form
$$
R(u,h)=(r(u),\Gamma(u,h)),
$$
where $r\colon 
U\rightarrow U$ is a sc-smooth retraction.  \par

\noindent A {\bf tame strong bundle retraction}\index{D- Tame strong bundle retraction}  is one for which the retraction $r$ is tame.  
\qed
\end{definition}
The condition $R\circ R=R$ of the retraction $R$ requires that 
$$\bigl( r(r(u)), \Gamma (r(u), \Gamma (u, h))\bigr)=
\bigl( r(u), \Gamma (u, h)\bigr).$$
Hence, if $r(u)=u$, then $\Gamma \bigl(u, \Gamma (u, h)\bigr)=\Gamma (u, h)$, and the bounded linear operator $h\mapsto \Gamma (u, h)\colon  F\to F$ is a projection. If $r(u)=u$ is, in addition, a smooth point, then the projection is a sc-operator.
\par


We continue to denote by $U\subset C\subset E$ a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$ and let $F$ be another sc-Banach space.
\begin{definition}\label{def_loc_strong_b_retract}\index{D- Strong local bundle}
A {\bf local  strong bundle retract}, denoted by 
$$
(K,C\triangleleft F, E\triangleleft F),\index{$(K,C\triangleleft F, E\triangleleft F)$}
$$
consists of a subset $K\subset C\triangleleft F$, which is the image,  
$K=R(U\triangleleft F)$, of a strong bundle retraction
$R\colon 
U\triangleleft F\rightarrow U\triangleleft F$
of the form $R(u, h)=(r(u),\Gamma (u, h)).$
Here, $r\colon 
U\to U$ is a sc-smooth retraction onto $r(U)=O$.
The local strong bundle retract $(K,C\triangleleft F, E\triangleleft F)$ will sometimes be abbreviated by 
$$
p\colon 
K\to O\index{$p\colon K\to O$}
$$
where $p$ is the map induced by the projection onto the first factor. If the strong bundle retraction $R$  is tame, the  local strong bundle retract is called a {\bf tame local strong bundle retract}. \index{D- Tame local strong bundle retract}
\qed
\end{definition}

The retract  $K$ inherits the {\bf double filtration}\index{Double filtration}  $K_{m,k}$\index{$K_{m,k}$} for $m\geq 0$ and $0\leq k\leq m+1$, defined by 
\begin{equation*}
\begin{split}
K_{m,k}&=K\cap (U_m \oplus F_k)\\
&=\{(u, h)\in U_m \oplus F_k\vert \, R(u, h)=(u, h)\}\\
&=\{(u, h)\in O_m \oplus F_k\vert \, \Gamma (u, h)=h\}.
\end{split}
\end{equation*}
The associated spaces $K[i]$, defined by 
$$
K[i]=K_{0,i},\quad i=0,1,\index{$K[i]$}
$$
are equipped with the filtrations
$$
K[i]_m=K_{m,m+i}
\quad \text{for all $m\geq 0$.}$$
The projection maps 
$p\colon  K[i]\to O$
are sc-smooth for $i=0,1$. In fact, $p:K[i]\rightarrow O$,  for $i=0,1$, is a  sc-smooth bundle.

\begin{definition}\label{def_section_loc_strong_bundle}\index{D- Section}
A {\bf section} of the local strong bundle retract $p\colon 
K\to O$ is a map $f\colon 
O\to K$ satisfying $p\circ f=\mathbbm{1}_O$.
The section $f$ is called {\bf sc-smooth}\index{Sc-smooth section}, if $f$ is a section of the bundle 
$$p\colon 
K(0)\to O.$$
The section $f$ is called  {\bf $\ssc^{\pmb{+}}$-smooth}, \index{D- Sc$^+$-section} if $f$ is a sc-smooth section of the bundle 
$$p\colon 
K(1)\to O.$$
\qed
\end{definition}
A section $f\colon 
O\to K$ is of the form $f(x)=(x, {\bf f}(x))\in O\times F$ and the map ${\bf f}\colon 
O\to F$ is called {\bf principal part of the section}\index{Principal part of a section}. We shall usually denote the principal part with the same letter as the section.

At this point, we can introduce the {\bf category $\mathcal{SBR}$}.\index{$\mathcal{SBR}$} Its  objects are the local,  strong bundle retractions $(K,C\triangleleft F,E\triangleleft F)$. The morphisms of the category   are maps
$\Phi\colon 
K\rightarrow K'$ between local strong bundle retracts, which are linear in the fibers and preserve the double filtrations. Moreover,  the induced maps 
$\Phi[i]\colon 
K[i]\rightarrow K'[i]$ are sc-smooth for $i=0,1$.
We recall that, by definition, {\bf the map $\Phi[i]\colon 
K[i]\rightarrow K'[i]$ between retracts is sc-smooth}, if the composition with the retraction,
$$(\Phi \circ R) \colon 
(U\triangleleft F)[i]\to (E'\triangleleft F')[i],$$
is sc-smooth.
There are  two forgetful functors 
$$
\text{forget}[i]\colon 
\mathcal{SBR}\rightarrow \mathcal{BR},
$$
into the category of  $\mathcal{BR}$ of sc-smooth bundle retractions introduced in Section \ref{section2.1}. They are defined by 
\begin{equation*}
\text{forget}[i](K)=K[i]
\end{equation*}
on the objects $K$ of the category, and 

\begin{equation*}
\text{forget}[i](\Phi)=\Phi[i]
\end{equation*}
on the morphisms between the objects.

We are in a position to introduce the notion of a strong bundle over a M-polyfold $X$. %
We consider a continuous surjective map
$$P\colon 
Y\to X$$
from the paracompact Hausdorff space $Y$ onto the M-polyfold $X$.  We assume, for every $x\in X$,  that  the fiber $P^{-1}(x)=Y_x$
has the structure of a Banachable  space.

\begin{definition}\label{def_strong_bundle_chart}\index{D- Strong bundle chart}
A {\bf strong bundle chart} for the bundle $P\colon 
Y\to X$ is a tuple
$$
(\Phi, P^{-1}(V), (K, C\triangleleft F,E\triangleleft F)),
$$
in which $(K, C\triangleleft F,E\triangleleft F)$ is a strong bundle retract, say $p:K\rightarrow O$. In addition, $V\subset X$ is an open subset of $X$, homeomorphic to the retract $O$ by a  homeomorphism $\varphi\colon 
V\to O$. In addition, 
$$\Phi\colon 
P^{-1}(V)\to K$$
is a homeomorphism from $P^{-1}(V)\subset Y$ onto the retract $K$, covering the homeomorphism $\varphi\colon 
V\to O$, so that the diagram 
\begin{equation*}
\begin{CD}
P^{-1}(V)@>\Phi>>K\\
@VPVV @VVpV \\
V@>\varphi>>O
\end{CD}
\end{equation*}
commutes. The map $\Phi$ has the property that,  in the fibers over $x\in V$,  the map $\Phi\colon 
P^{-1}(x)\to p^{-1}(\varphi (x))$ is a 
bounded linear isomorphism between Banach spaces.\par

\noindent {\bf Two strong bundle charts} $\Phi\colon 
P^{-1}(V)\to K$ and 
$\Phi'\colon 
P^{-1}(V')\to K'$,  satisfying $V\cap V'\neq \emptyset$ are 
{\bf compatible},\index{Compatibility of strong bundle charts} if the transition maps
$$
\Phi'\circ \Phi^{-1}[i]\colon 
\Phi (P^{-1}(V\cap V'))[i]\to 
\Phi' (P^{-1}(V\cap V'))[i]
$$
are sc-smooth diffeomorphisms for $i=0,1.$
\qed
\end{definition}
As usual, one now proceeds to define a strong  bundle atlas, consisting of compatible strong bundle charts covering $Y$ and the equivalence between two such atlases.
\begin{definition}\label{def_strong_bundle} \index{D- Strong bundle}
The continuous surjection 
$$
P\colon 
Y\to X
$$
from the paracompact Hausdorff space $Y$ onto the M-Polyfold $X$, equipped with an equivalence class of strong bundle atlases is called a {\bf strong bundle over the M-polyfold $X$}.
\qed
\end{definition}
Induced by the strong bundle charts, the M-polyfold $Y$ is equipped with a natural double filtration into subsets $Y_{m,k}$, $m\geq 0$ and $0\leq k\leq m+1$. Therefore, we can distinguish the underlying M-Polyfolds $Y[i]$ for $i = 0,1$ with the filtrations
$$
Y[i]_m = Y_{m,m+i}  ,  m \geq 0.
$$
The projections
$$
P[i] \colon 
 Y[i] \rightarrow X
$$
are sc-smooth maps between M-Polyfolds.
Correspondingly, we distinguish two types of sections of the strong bundle $P \colon 
 Y \rightarrow X$.

\begin{definition}\label{def_sc_inft_sections}
\noindent A section of the strong bundle $P \colon 
 Y \rightarrow X$ is a map $f \colon 
 X \rightarrow Y,$ satisfying $P\circ f = {\mathbbm 1}_X.$\\
 The section $f$ is called a {\bf sc-smooth section}\index{D- Sc-smooth section}, if $f$ is an sc-smooth section of the bundle
$$
P[0] \colon 
 Y[0] \rightarrow X.
$$
The section $f$ is called a ${\bf sc^+}$-{\bf section} of $P \colon 
 Y \rightarrow X$, \index{D- Sc$^+$-section} if $f$ is an sc-smooth section of the bundle
$$ 
P[1] \colon 
 Y[1] \rightarrow X.
$$
\qed
\end{definition}
If we say $f$ is an sc-section of $P:Y\rightarrow X$ we mean that it is an sc-smooth section of $Y[0]\rightarrow X$.
An sc$^+$-section or sc$^+$-smooth section of $P:Y\rightarrow X$ is an sc-smooth section of $Y[1]\rightarrow X$.

\begin{definition}[{\bf Pull-back bundle}]
Let $P\colon Y\to X$ be a strong bundle over the M-polyfold $X$ and let  $f\colon Z\to X$  be an sc-smooth map  from the M-polyfold $Z$ into $X$. The pull-back bundle of $f$,
$$P_f\colon f^\ast Y\to Z,$$ 
is defined by the set 
$f^\ast Y=\{(z, y)\in Z\times Y\, \vert \, P(y)=f(z)\}$
and the projection $P_f (z, y)=z$, so that with the projection 
$P'\colon f^\ast Y\to Y$, defined by $P'(z, y)=y$, the diagram 
\begin{equation*}
\begin{CD}
f^\ast Y@>P'>>Y\\
@VP_fVV @VVPV \\
Z@>f>>X
\end{CD}
\end{equation*}
commutes.
\end{definition}


As already shown in \cite{HWZ2}, Proposition 4.11, the strong bundle  structure of $P:Y\rightarrow X$ induces a natural strong bundle structure of the pull-back bundle $P_f$.
\begin{proposition}\label{pull_back_strong_bundle}\index{P- Pull-back of strong bundles}
The pull-back bundle $P_f\colon f^\ast Y\to Z$ 
carries a natural structure of a strong M-polyfold bundle over the  M-polyfold $Z$.
\qed
\end{proposition}
The easy proof is left to the reader.  
\section{Appendix}

\subsection{Proof of Proposition  \ref{smooth_retract}}\label{A2.1}
Let us recall the statement.\par

\noindent {\bf Proposition.} Let $r\colon 
U\to U$ be a $C^\infty$-retraction defined on an open subset $U$ of a Banach space $E$. Then $O:=r(U)$ is a $C^\infty$-submanifold of $E$. More precisely, for  every point $x\in O$,  there exist an open neighborhood  $V$ of $x$ and  an open neighborhood $W$  of $0$ in $E$, a splitting $E =R \oplus N$, and a smooth diffeomorphism 
$\psi \colon 
 V\to  W$  satisfying  $\psi (0)=x$ and 
$$\psi (O\cap V ) = R \cap W.$$
\begin{proof} 
The $C^\infty$-retraction $r$ satisfies $r\circ r=r$ and hence,  by the chain rule,  
$$Dr(r(x))\circ Dr(x)=Dr (x)\quad \text{for every $x\in U$}.$$
Therefore, if $r(x)=x$ 
 \begin{equation}\label{c_infty_retract_eq0}
 Dr (x)\circ Dr (x)=Dr(x)
  \end{equation}
and hence the bounded linear operator  $Dr(x)\in \mathscr{L}(E, E)$ is a projection at every point $x\in O$.

Now we take a point $x\in O=r(U)$ and,  for simplicity,  assume that $x=0$.  In view of \eqref{c_infty_retract_eq0}, the Banach space $E$ splits into $E=R\oplus N$, where 
\begin{align*}
R&=\text{range}\ Dr(0)=\text{ker}\ (\mathbbm{1}-Dr (0))\\
N&=\text{ker}\ Dr(0)=\text{range}\ (\mathbbm{1}-Dr (0)).
\end{align*}
According to the splitting $E=R\oplus N$, we use the equivalent norm $\abs{(a, b)}=\max\{\norm{a}, \norm{b}\}$. By $B(\varepsilon)$ we denote an open ball of radius $\varepsilon$ (with respect to the norm $\abs{\cdot }$) centered at the origin.

Now we introduce  the map $f\colon 
 (R\oplus  N)\cap U\to E$, defined   by 
$$f(a, b)=r(a)+(\mathbbm{1}-Dr(a))b.$$
At $(a, b)=(0, 0)$, we have $f(0, 0)=r(0)=0$ and 
$$Df(0, 0)[h, k]=h+k$$
for all $(h, k)\in R\oplus N.$ Consequently, in view of the inverse function theorem, $f$ is a local $C^\infty$-diffeomorphism, and we assume without loss of generality that $f$ is a diffeomorphism on $U$. 

We claim that there exists a positive number $\delta$,  such that, if 
 $f(a, b)\in O=r(U)$ for $(a, b)\in B(\delta)$, then $b=0$.   The proposition then follows by setting  $W=B(\delta)$, $V=f(W)$,  and defining  the map $\psi\colon 
W\to V$  by $\psi=(f\vert W)^{-1}$.
 
 
It remains to  prove the  claim that $b=0$.  Since  $r$ is smooth, we find a constant $\varepsilon>0$, such that  
 $B(2\varepsilon)\subset U$ and 
 \begin{equation}\label{c_infty_retract_eq1}
 \abs{Dr(x)-Dr(0)}<\frac{1}{3}\quad \text{for all $\abs{x}<\varepsilon$}.
 \end{equation}
Moreover,  since $r(0)=0$, there exists a constant $0<\delta <\frac{3}{4}\varepsilon$, such that 
  \begin{equation}\label{c_infty_retract_eq2}
 \abs{r(x)}<\varepsilon \quad \text{for all $\abs{x}<\delta$}.
 \end{equation}
If $x\in B(\delta)$, then for $ \abs{h}<\varepsilon$, 
 \begin{equation}\label{c_infty_retract_eq3}
  r(r(x)+h)=r(r(x))+Dr(r(x))h+o(h)=r(x)+Dr(r(x))h+o(h),
 \end{equation}
where $o(h)$  is an $E$-valued map satisfying $\frac{o(h)}{\abs{h}}\to 0$, as $\abs{h}\to 0$.
Taking a smaller $\varepsilon$, we may assume that 
 \begin{equation}\label{c_infty_retract_eq3a}
 \abs{o(h)}\leq \frac{\abs{h}}{2}\quad  \text{ for all $\abs{h}<\varepsilon. $}
 \end{equation}
Let  $x=(a, b)\in B(\delta)$  and $f(a, b)\in O$. This means that  
 \begin{equation}\label{c_infty_retract_eq4}
r\bigl(r(a)+(\mathbbm{1}-Dr(a))b\bigr)=r(a)+(\mathbbm{1}-Dr(a))b.
 \end{equation}
By \eqref{c_infty_retract_eq1} and the fact that, $Dr(0)b=0$ for  $b\in N$, the norm of  $(\mathbbm{1}-Dr(a))b$ for $\abs{a}<\delta$ can be estimated as 
\begin{equation}\label{c_infty_retract_eq5}
\abs{b-Dr(a))b}=\abs{b-\bigl(Dr(a))-Dr(0)\bigr)b} \leq \frac{4}{3}\abs{b}.
\end{equation}
Inserting $x=a$ and $h=(\mathbbm{1}-Dr(a))b$ into  \eqref{c_infty_retract_eq3} and using  the identity  
\eqref{c_infty_retract_eq4}, we obtain
\begin{equation}\label{c_infinity_retraction_eq7} 
Dr(r(a))h=h+o(h).
\end{equation}
The left-hand side is equal to 
\begin{equation*}\label{c_infinity_retraction_eq8} 
Dr(r(a))h=Dr(r(a))b-Dr(r(a))Dr(a)b=Dr(r(a))b-Dr(a)b,
\end{equation*}
and the right-hand side is equal to $h+o(h)=b-Dr(a))b+o(h)$,
so that 
\eqref{c_infinity_retraction_eq7}  takes the form 
\begin{equation}\label{c_infty_retract_eq10}
Dr(r(a))b=b+o(h).
\end{equation} 
Arguing by contradiction, we assume  that $b\neq 0$. Since   $\abs{r(a)}< \varepsilon$,  the norm of the left-hand side is, in view of  \eqref{c_infty_retract_eq1},  bounded from above by 
\begin{equation}\label{c_infty_retract_eq11}
\abs{Dr(r(a))b}=\abs{Dr(r(a))b-Dr(0)b}<\frac{1}{3}\abs{b}.
\end{equation} 
On the other hand, using \eqref{c_infty_retract_eq3a} and \eqref{c_infty_retract_eq5}, we estimate  the norm of the right-hand side  of \eqref{c_infty_retract_eq10} from below as  
\begin{equation}\label{c_infty_retract_eq12}
\abs{b+o(h)}\geq \abs{b}-\frac{1}{2}\abs{h} \geq   \abs{b}-\frac{2}{3}\abs{b}=\frac{1}{3}\abs{b}. 
\end{equation} 
Consequently, $\frac{1}{3}\abs{b}>\frac{1}{3}\abs{b}$ 
which is absurd. Therefore,  $b=0$ and the proof is complete.
\qed \end{proof}

\subsection{Proof of Theorem \ref{X_m_paracompact}}\label{A2.2}
We recall the statement of the result which we would like to prove.\par

\noindent{\bf Theorem.} 
Let $X$ be a M-polyfold. For every $m\geq 0$, the space $X_m$ is metrizable and, in particular, paracompact. In addition, the space $X_\infty$ is metrizable.
\par

We  make use of the following theorem of metrizability due to Yu. M. Smirnov \cite{Smirnov}.
\begin{theorem}[{\bf {Yu. M. Smirnov}}]\label{Smirnov}\index{T- Smirnov's metrizability theorem}
Let $X$ be a space that is paracompact Hausdorff, and assume that  every point has an open  neighborhood in $X$ that is metrizable. Then $X$ is metrizable.\end{theorem}

 Recall that a regular topological space is one where a closed subset $A$ and a point $p\not\in A$ can be separated by suitable open neighborhoods $U$ and $V$  of $A$ and $p$, respectively, i.e. $U\cap V=\emptyset$. 
Moreover, a regular Hausdorff space is what is called sometimes a $T_3$-space.  We also note that in \cite{Michael} the definition 
of paracompactness includes the property of being Hausdorff. For us paracompactness just means that for every open covering there exists 
a locally finite subcovering.  With these conventions the following quoted result is an obvious reformulation.
\begin{lemma}[\cite{Michael}, Lemma 1] \label{equivalent_definitions_paracompact}\index{L- Characterization of paracompactness}
A  regular Hausdorff space $X$ is paracompact, if and only if every open cover of $X$ has a locally finite refinement consisting of closed sets.
\qed
\end{lemma}

We shall use the above lemma in the proof of the following result.

\begin{proposition}\label{union_of_paracompact}\index{P- Paracompactness}
Let $Y$ be  a regular Hausdorff space, and let $(Y_i)_{i\in I}$ be a locally  finite family of closed subspaces  of $Y$, so that  $Y=\bigcup_{i\in I}Y_i$. If every subspace $Y_i$ is paracompact, then 
$Y$ is  paracompact.
\end{proposition}
\begin{proof}
Given an open cover  $\mathscr{U}=(U_j)_{j\in J}$ of $Y$,  it is, in view of 
Lemma \ref{equivalent_definitions_paracompact}, enough to show, that there exists a closed locally finite refinement 
$\mathscr{C}=(C_j)_{j\in J}$ of $\mathscr{U}$.  In order to prove this, we  consider for every $i$  the cover  $\mathscr{Y}_i=(Y_i\cap U_j)_{j\in J}$ of $Y_i$, consisting of open sets in $Y_i$.  Since $Y_i$ is paracompact, Lemma \ref{equivalent_definitions_paracompact} implies that there exists a closed locally finite refinement  $(C_j^i)_{j\in J}$ of  $\mathscr{Y}_i$.  The sets $C_j^i$ are closed in $Y$ and by  definition of refinement satisfy 
\begin{equation}\label{eq1}
C_j^i\subset Y_i\cap U_j\quad \text{and}\quad \bigcup_{j\in J}C^i_j=Y_i.
\end{equation}  
Now, for every $j\in J$,  we define the set
$$C_j:=\bigcup_{i\in I}C_j^i$$
and claim that the family $\mathscr{C}=(C_j)_{j\in J}$ is a closed locally finite refinement of $\mathscr{U}$.  We start with  showing that  $C_j$ is closed. Let 
 $x\in X\setminus C_j=\bigcap_{i\in I}(X\setminus C^i_j)$.   Since $(Y_i)_{i\in I}$ is locally finite,  we find  an open neighborhood  $V(x)$ of $x$ in $Y$, which  intersects $Y_i$ for at most finitely many indices $i$, say for $i$ belonging to the  finite subset $I'\subset I$. 
If $i\not \in I'$, then, by \eqref{eq1},  $V(x)\subset  Y\setminus Y_i\subset Y\setminus C_j^i$,  so that $V(x)\subset \bigcap_{i\not \in  I'}(Y\setminus Y_i).$  
Then the set $U(x)=V(x)\cap  \bigcap_{l\in I'}(Y\setminus C_j^i)$ is an open neighborhood of $x$ in $Y$ contained in $Y\setminus C_j$. This shows that  $C_j$ is closed as claimed.
That  $\mathscr{C}$ is a cover of $X$ and a refinement of $\mathscr{U}$ follows from  \eqref{eq1}, 
\begin{gather*}
\bigcup_{j\in J}C_j=\bigcup_{j\in J}\bigcup_{i\in I}C_j^i=\bigcup_{i\in I}\bigcup_{j\in J}C_j^i=\bigcup_{i\in I}Y_i=X\\
\intertext{and}
V_j=\bigcup_{i\in I}C_j^i\subset \bigcup_{i\in I}Y_i\cap U_j=U_j. 
\end{gather*}
It remains to show that $\mathscr{C}$ is locally finite.  Local finiteness of $(Y_i)_{i\in I}$ implies that a given point $x\in Y$ belongs to finitely many $Y_i$'s, say $x\in Y_i$, if and only if $i$ belongs to the finite subset  $I'\subset I$.  Moreover, there exists an open neighborhood $V(x)$ of $x$ in $Y$ intersecting at most finitely many $Y_i$'s. 
 Since $Y$ is regular, we can replace  $V(x)$  by  a smaller  open set intersecting only those $Y_i$'s whose indices $i$ belong to $ I'$.  Also,  $(C_j^i)_{j\in J}$ is a locally finite family in $Y_i$, so that  there exists an open neighborhood $V_i(x)$ of $x$ in $Y_i$ intersecting $C_j^i$  for, at most, finitely many indices $j$,  which belong to the finite subset $J_i\subset J$. Each $V_i(x)$ is of the form 
$V_i(x)=U_i(x)\cap Y_i$ for some open neighborhood $U_i(x)$ of $x$ in $Y$. Then $U(x)=V(x)\cap \bigcap_{i\in I'}U_i(x)$ is an open neighborhood of $x$ in $Y$  intersecting 
$Y_i$ only for $i\in I'$ and the set $U(x)\cap Y_i$ intersects  $C_j^i$ only for  $j\in J_i$.   This implies that  $U(x)$ can have a nonempty intersection with $C_j$ only for $j\in \bigcup_{i\in I'}J_i$.  Hence,  the family $\mathscr{C}=(C_j)_{j\in J}$ is locally finite,  and the proof is complete.  

\qed \end{proof}
Now we are ready to prove the theorem.
\begin{proof}[Theorem \ref{X_m_paracompact}]
We start with $m=0$ and take an atlas 
$$
(U^j, \varphi^j, (O^j, C^j, E^j))_{j\in J}.
$$  
Since $\varphi^j\colon 
U^j\to O^j$
 is a homeomorphism and $O^j$ is a metric space, $U^j$ is metrizable. 
Hence, $X$ is locally metrizable. Since by assumption, $X$ is Hausdorff and paracompact,  the Smirnov metrizability theorem implies that $X$ is metrizable. 

In order to prove that $X_m$ is metrizable for $m\geq 1$,  we fix $m\geq 1$  and consider the topological  space $X_m$.  Since by assumption, $X$ is Hausdorff,  given two distinct points $x$ and $x'$ in $X_m$, there exist  two disjoint open neighborhoods $U$ and $U'$ of $x$ and $x'$ in $X$.  Hence, the sets $U_m$ and $U'_m$ are disjoint open neighborhoods of $x$ and $x'$ in $X_m$, so that also $X_m$ is a  Hausdorff space. 
Moreover, the maps $\varphi\colon 
U_m\to O^j_m$ are homeomorphisms and since $O^j_m$ is a metric space, $U^j_m$ are metrizable. So,  $X_m$ is locally metrizable. To prove that $X_m$ is metrizable, it suffices to show, that, in view of the Smirnov metrizability theorem, $X_m$ is paracompact.  Using  the paracompactness  of $X$ and 
Lemma \ref{equivalent_definitions_paracompact}, we find a closed locally finite refinement $\mathscr{C}=(C_j)_{j\in J}$. In particular, $C_j\subset U_j$, so that $C^j_m\subset U^j_m$. Since $U^j_m$ is metrizable, it is also paracompact, so that $C^j_m$ is paracompact as a closed subspace of $U^j_m$.   Hence, $\mathscr{C}_m=(C^j_m)_{j\in J}$ is a locally  finite family of closed subsets of $X_m$ and each $C^j_m$ is paracompact. Thus,  by Proposition \ref{union_of_paracompact}, the space $X_m$ is paracompact, and since it is Hausdorff and locally metrizable, it is metrizable. 
Finally, choosing a metric $d_m$ defining the topology on $X_m$ , we set
$$
d(x,y)=\sum_{m=0}^{\infty} \frac{1}{2^m}\cdot  \frac{d_m(x,y)}{1+d_m(x,y)}.
$$
The metric $d$ defines the topology on $X_\infty$.
\qed \end{proof}

\subsection{Proof of Proposition \ref{op}}\label{A2.11}
We recall the statement of the proposition.\par

\noindent{\bf Proposition.}
The following holds.
\begin{itemize}
\item[(1)]\ The collection $\mathscr{B}$ defines a basis for a Hausdorff  topology on $TX$.  
\item[(2)]\ The projection $p\colon 
TX\to X^1$ is a continuous and an open map.
\item[(3)]\ With the topology defined by $\mathscr{B}$,  the tangent space $TX$ of the M-polyfold $X$  is metrizable and hence, in particular,  paracompact.
\end{itemize}
\begin{proof}
(1)\, In order to prove that $\mathscr{B}$ defines a basis for a topology on $TX$, we take two  sets   $\wt{W}_1$ and $\wt{W}_2$ in  $\mathscr{B}$ and assume that $\alpha=[(x, \varphi, V, (O, C, E), h)]\in \wt{W}_1\cap \wt{W}_2$. We claim that  there exists a set $\wt{W}\in \mathscr{B}$, satisfying  $\alpha\in \wt{W}\subset \wt{W}_1\cap \wt{W}_2.$ By definition,  $\wt{W}_i=(T\varphi_i)^{-1}(W_i)$, where $(\varphi_i, V_i, (O_i, C_i, E_i))$ is a chart and $W_i$ is an open subset of $TO_i$, containing 
$$
\alpha=[(x_i, \varphi_i, V_i, (O_i, C_i, E_i), h_i)]\quad \text{for $i=1,2$}.
$$
This means that 
\begin{equation}\label{basis_top_1}
x_i=x\quad \text{and}\quad h_i=T(\varphi_i \circ \varphi^{-1})(\varphi (x))h\quad \text{for $i=1,2$},
\end{equation}
and, moreover, $(\varphi_i (x_i), h_i)=(\varphi_i (x), h_i)\in W_i$. We define  
$$
W_i'= [ T(\varphi_i \circ \varphi^{-1})(\varphi (x))]^{-1}(W_i),
$$
 and observe that the $W_i$'s  are open subsets of $TO_i$. By \eqref{basis_top_1},  $(\varphi (x), h)\in W_1'\cap W_2'$ and if  $W=W'_1\cap W_2'$ and $\wt{W}=(T\varphi )^{-1}(W)$, then 
$$[(x, \varphi, V, (O, C, E), h)]\in \wt{W}\subset \wt{W}_1\cap \wt{W}_2.$$
Consequently, $\mathscr{B}$ defines a topology on $TX$. To prove that this topology is Hausdorff, we take two distinct elements 
$$
\alpha=[(x, \varphi, V, (O, C, E), h)]\quad \text{and}\quad \alpha'=[(x', \varphi', V', (O', C', E'), h')]
$$
in the tangent space $TX$.  Since $\alpha\neq \alpha'$, either $x\neq x'$ or if $x=x'$, then $h'\neq T(\varphi'\circ \varphi)^{-1}(\varphi (x))h.$ In the first case $x\neq x'$ we may replace $V$ and $V'$ by smaller open neighborhoods of $x$ and $x'$, so that $V\cap V'=\emptyset$, and then replace $(O, C, E)$, resp. $(O, C', E')$,  by the retracts $(\varphi (V), C, E)$, resp. $(\varphi'(V'), C', E')$. If $W$ (resp. $W'$)  is an open neighborhood of  $(\varphi (x), h)$ (resp. $(\varphi'(x'), h')$)  in $TO$ (resp. $TO'$), then $\wt{W}=(T\varphi)^{-1}(W)$ (resp. $\wt{W}'=(T\varphi')^{-1}(W')$ is an open neighborhood  
of $\alpha$ (resp. $\alpha'$) in $TX$ and  $\wt{W}\cap \wt{W'}=\emptyset$.  In the second case $x=x'$ and $h'\neq T(\varphi'\circ \varphi)^{-1}(\varphi (x))h$. We choose an open neighborhood 
 $W$ of $(\varphi' (x), h')$ in $TO'$ and an open neighborhood $W$ of $(\varphi (x), h)$ in $TO$, so that $W'\cap T(\varphi')^{-1}(W)=\emptyset$. 
  Then $\alpha\in \wt{W}=(T\varphi)^{-1}(W)$ and $\alpha'\in \wt{W'}= (T\varphi')^{-1}(W')$. Moreover, both sets are open  and their intersection is empty. Consequently, the topology defined by $\mathscr{B}$ is Hausdorff.\par
  
\noindent (2)\,   We start by proving that  $p\colon 
TX\to X^1$ is an open map. It suffices to show that $p(\wt{W})$ is open in $X^1$ for every element
 $\wt{W}\in\mathscr{B}.$
Let $(\varphi, V, (O, C, E))$ be a chart on $X$ and let $T\varphi\colon 
TV\to TO$ be the associated map defined above and introduce $\wt{W}=(T\varphi )^{-1}(W)$ for the open subset $W$ of $TO$. 
We denote by $\pi\colon 
TO\to O_1$ the projection onto the first factor. This map is continuous and open. Moreover,  
$$p(\wt{W})=\varphi^{-1}\circ \pi\circ (T\varphi)(\wt{W}).$$
Since, by construction, the map $T\varphi\colon 
TV\to TO$ is open and $\varphi\colon 
V\to O$ is a homeomorphism, the composition on the right hand side is an open subset of $X^1$. Hence, $p(\wt{W})$ is open in $X^1$ as claimed.

To show that the projection map  $p\colon TX\to X^1$ is continuous, it suffices to show, that given a chart $(V, \varphi, (O, C, E))$ on $X$ and an open subset $U$ of $X^1$, satisfying $U\subset V_1$, the preimage $p^{-1}(U)$ is open. For such a chart and open set $U$ we have 
$$p^{-1}(U)=(T\varphi )^{-1}\bigl((\varphi (U)\times E)\cap TO\bigr).$$
Since   $(\varphi (U)\times E)\cap TO$ is open in $TO$, the set on the left-hand side belongs to $\mathscr{B}$. Hence, the set $p^{-1}(U)$ is open, and the projection $p$ is continuous as claimed. \par

\noindent (3)\,  
We start with an atlas $\mathscr{V}=(V^j, \varphi^j, (O^j, C^j, E^j))_{j\in J}$, such  that the family $\mathscr{V}=(V^j)_{j\in J}$ of domains is an open,  locally finite cover of $X$.  The associated maps %
$T\varphi^j\colon 
TV^j\to TO^j$ are homeomorphisms, and since $TO^j$ is metrizable, the same holds for the open sets $TV^j$.  Hence, $TX$ is locally metrizable.  To show that $TX$ is metrizable, it remains  to show that $TX$ is paracompact.  By Theorem \ref{equivalent_definitions_paracompact}, there exists a closed, locally finite refinement $\mathscr{C}=(C^j)_{j\in J}$ of $\mathscr{V}$, so that $\mathscr{C}_1=(C^j_1)_{j\in J}$ is a closed, locally finite refinement of $\mathscr{V}_1=(V^j_1)_{j\in J}$.  The sets $K^j=TO\vert \varphi(C^j_1):=\bigcup_{x\in \varphi (C^j_1)}T_xO$ are closed in $TO$, so that 
the sets $\wt{K^j}:=(T\varphi^j)^{-1}(K^j)$ are closed subsets of $TV$. In particular, each $\wt{K^j}$ is paracompact as a closed subset of metrizable space.  Also, the family $(\wt{K^j})_{j\in J}$ is locally finite. Indeed, let $\alpha=[(x, V, \varphi, (O, C, E), h)]\in TX$. Then there exists an open neighborhood $U(x)$ of $x$ in $X_1$ intersecting at most finitely many $C^j_1$'s, say with indices $j$, belonging to a finite subset $J'\subset J$. Moreover, since $X_1$ is regular, $U(x)$ can be taken so small that also $x\in C^j_1$ for $j\in J'$. Then, setting $W(x):=TO\vert \varphi (U (x)):=\bigcup_{y\in \varphi (U(x))}T_yO$, the set $W(x)$ is an open subset of $TO$ and $\wt{W(x)}:=(T\varphi)^{-1}(W(x))$ intersects only those $\wt{K^j}$ whose indices $j$ belong to $J'$. 
Now applying  Proposition \ref{union_of_paracompact}, we conclude, that the tangent space $TX$ is paracompact and hence metrizable, in view of the Smirnov metrizability  theorem. This finishes the proof of the proposition.
\qed \end{proof}


\chapter{Basic Sc-Fredholm Theory}
In this chapter  we start with  the Fredholm theory in the sc-framework. Since sc-maps are more flabby than $C^\infty$-maps, we do not have an implicit function theorem for all sc-smooth maps.  However, for a restricted class, which occurs in the applications 
of the theory,  such a theorem is available. 





\section[Sc-Fredholm Sections]{Sc-Fredholm Sections and Some of the Main Results}
The section is devoted to the basic notions and the description of the results leading  to  implicit function theorems. Our overall goal is the notion of a sc-Fredholm section  of a %
strong bundle $P\colon Y\rightarrow X$, as defined in
 Definition \ref{def_strong_bundle}. 
Sometimes we need to require that the underlying M-polyfold  $X$ is a tame M-polyfold as defined in  
Definition \ref{def_tame_m-polyfold} in order to have good versions of the implicit function theorem near the boundary.
 The section will end with some useful implicit function theorems.
The more sophisticated perturbation and transversality results are described in a later section.


We start by introducing various types of germs in the sc-context. As usual we denote  by $E$ be a sc-Banach space and by $C\subset E$ a partial  quadrant of $E$.  The sc-Banach space $E$ is equipped with the filtration 
$$E_0=E\supset E_1\supset\cdots \supset E_\infty =\bigcap_{m\geq 0}E_m.$$


\begin{definition}\label{def_germ_nbgh}\index{ Sc-germ of neighborhoods}
A  {\bf sc-germ of neighborhoods around $0\in C$}, 
denoted by ${\mathcal O}(C,0)$,  is 
a decreasing sequence 
$$
U_0\supset U_1\supset U_2\supset \cdots 
$$
where $U_m$ is a relatively open neighborhoods of $0$ in 
$C\cap E_m$. \index{D- Tangent of ${\mathcal O}(C,0)$}\par

\noindent The {\bf tangent of ${\mathcal O}(C,0)$},  denoted by $T{\mathcal O}(C,0)$, is  the decreasing sequence \index{${\mathcal O}(C,0)$}\index{$T{\mathcal O}(C,0)$}
$$
U_1\oplus E_0\supset U_2\oplus E_1\supset\cdots \, 
$$
\qed
\end{definition}
A special example of a sc-germ of neighborhoods around $0\in C\subset E$ is  a relatively open neighborhood $U$ of $C$ containing $0$ which is equipped with the induced sc-structure defined by the filtration $U_m=U\cap E_m$, $m\geq 0$.  If $E$ is infinite dimensional, the sets $U_m$ is this example 
are not bounded in $E_m$, since the inclusions $E_m\to E_0$ are compact operators. 
Another example is the decreasing sequence $U_m=U
\cap B_{1/m}^{E_m}(0)$, where $B_{1/m}^{E_m}(0)$ is the open ball in $E_m$ centered at $0$ and radius $1/m$, presents a sc-germ of neighborhoods. Here the sets $U_m$ are bounded in $E_m$ for $m>0$. We point out that the size of the sets  $U_m$ in Definition \ref{def_germ_nbgh} does not matter. In the applications the size of $U_m$ quite often decreases rapidly.




\begin{definition}\label{germy}\index{D- Sc-mapping germ}
A  {\bf $\ssc^{\pmb{0}}$-germ} $f\colon {\mathcal O}(C,0)\rightarrow F$\index{$f\colon {\mathcal O}(C,0)\rightarrow F$} into the sc-Banach space $F$, is a continuous map
$f\colon U_0\rightarrow F$ such that $f(U_m)\subset F_m$ and
$f\colon U_m\rightarrow F_m$ is continuous.
A  {\bf $\ssc^{\pmb{1}}$-germ} $f\colon {\mathcal O}(C,0)\rightarrow F$ is a  $\ssc^0$-germ which is of class  $\ssc^1$ in the sense, that there exists 
for every $x\in U_1$  a bounded linear operator $Df(x)\in L(E_0,F_0)$ such that for $h\in U_1$ with $x+h\in U_1$, 
$$
\lim_{\abs{h}_1\rightarrow 0} \frac{\abs{f(x+h)-f(x)-Df(x)h}_0 }{\abs{h}_1}=0.
$$
Moreover,  $Tf\colon U_1\oplus E_0\rightarrow TF$,  defined by $Tf(x,h)=(f(x),Df(x)h)$,  satisfies $Tf(U_{m+1}\oplus E_m)\subset F_{m+1}\oplus F_m$ and
$$
Tf\colon T{\mathcal O}(C,0)\rightarrow TF\index{$Tf\colon T{\mathcal O}(C,0)\rightarrow TF$}
$$
is a $\ssc^0$-germ. We say $f$ is a $\ssc^2$-germ provided $Tf$ is  $\ssc^1$, etc.  If  the germ $f$ is a $\ssc^k$-germ for every $k$ we call it a sc-smooth germ.  
If we write $f\colon {\mathcal O}(O,0)\rightarrow (F,0)$ we indicate
that $f(0)=0$.
\qed
\end{definition}
We shall be mostly interested in $\ssc^\infty$-germs $f\colon {\mathcal O}(C,0)\rightarrow F$. \index{Sc$^\infty$-germs}

From Definition \ref{def_strong_bundle_chart} we recall the strong bundle chart $(\Phi, P^{-1}(V), K, U\triangleleft F)$ of a strong bundle $P\colon Y\to X$ over the M-polyfold $X$, illustrated by the commutative diagram
\begin{equation*}
\begin{CD}
P^{-1}(V)@>\Phi>>K\\
@VPVV @VVpV \\
V@>\varphi>>O .
\end{CD}\,
\end{equation*}
In the diagram, $V\subset X$ is an open set and the maps
$\Phi$ and $\varphi$  are homeomorphisms. Moreover, 
$K=R(U\triangleleft F)$ is the image of the strong bundle retraction $R$, and $O=r(U)$ is the image of the sc-smooth retraction $r\colon U\to U$ of the relatively open set $U$ of the the partial quadrant $C$ in the sc-Banach space $E$. 

\begin{definition}\index{D- Sc-section germ}
A {\bf sc-smooth section germ} $(f,x_0)$ of the strong bundle $P\colon Y\to X$ is a continuous section $f\colon V\rightarrow P^{-1}(V)$ defined on  a (sufficiently small) open neighborhood $V$ of the smooth point $x_0$,  for which the following holds.
There exists a strong bundle chart 
$(\Phi,  P^{-1}(V), (K, C\triangleleft F,E\triangleleft F))$  satisfying $\varphi (x_0)=0\in O$ in which the principal part $\wh{{\bm{f}}}$ of the local continuous section $\wh{f}=\Phi \circ f\circ \varphi^{-1}\colon O\to K$ has the property that the composition 
$$\wh{{\bm{f}}}\circ r\colon {\mathcal O}(C, 0)\to F$$
is a sc-smooth germ as defined in 
Definition \ref{germy}.
\qed
\end{definition}
To recall, the section $\wh{f}\colon  O\to K\subset U\triangleleft F$, as continuous section,  is  of the form $\wh{f}(p)=(p, \wh{\bm{f}}(p))$ for $p\in O$,  and $\wh{\bm{f}}\colon O\to F$ is called its {\bf principal part}.  The smoothness properties are concerned with the point $x_0$ and encapsulated in the behavior
of $\wh{\bm{f}}\circ r $ defined on a sc-germ of neighborhoods.  By abuse of the notation we shall often use the same letter for the principal part as for the section.



In the next step we introduce the useful  notion of a  filling of a  sc-smooth section germ $(f,0)$  of  a %
strong local bundle $K\rightarrow O$ near the given smooth point  $0$.  The notion of  a filling is a new concept specific to the world of retracts. In all known applications it deals successfully with bubbling-off phenomena and similar singular phenomena.




\begin{definition}[{\bf Filling}]\label{x-filling}\index{D- Filling}
We consider a %
strong local bundle $K\to O$. We recall that $K=R(U\triangleleft F)$  where  $U\subset C\subset E$ is a relatively open neighborhood  of $0$ in the partial quadrant $C$ of the  sc-Banach space $E$ and  $F$ is a sc-Banach space. Moreover,  $R$ is a strong bundle retraction of the form 
$$R(u, h)=(r(u), \rho(u)(h)), $$
covering the tame retraction $r\colon U\to U$ onto $O=r(U),$
and $\rho (u)\colon F\to F$ is a bounded linear operator.  
We  assume that $r(0)=0$. 
A sc-smooth section germ 
$(f, 0)$ of the bundle $K\to O$ possesses a  {\bf filling}\index{D- Filling of a sc-smooth section germ}
if there exists a  sc-smooth section germ $(g, 0)$ of the bundle $U\triangleleft F\to U$ extending $f$ and having  the following properties.
\begin{itemize}
\item[(1)]\ $f(x)=g(x)$  for $x\in O$ close to $0$.
\item[(2)]\ If $g(y)=\rho (r(y))g(y)$ for a point $y\in U$ near $0$, then $y\in O$.
\item[(3)]\ The linearization of the map
$
y\mapsto  [\mathbbm{1} -\rho(r(y))]\cdot g(y)
$
at the point $0$, restricted to $\ker(Dr(0))$, defines a topological linear  isomorphism
$$
\ker(Dr(0))\rightarrow \ker(\rho (0)).
$$
\end{itemize}
\qed
\end{definition}
The crucial property of a filler is the fact that the 
solution sets $\{y\in O\, \vert \, f(y)=0\}$ and $\{y\in U\, \vert \, g(y)=0\}$ coincide near $y=0$. 
Indeed, if $y\in U$ is a solution of the filled section $g$ so that $g(y)=0$, then it follows from (2) that $y\in O$ and from (1) that $f(y)=0$. The section $g$ is, however, much  easier to analyze than  the section $f$,  whose domain of definition has a rather complicated structure. It turns out that in the applications these extensions $g$ are surprisingly easy to  detect. In the Gromov-Witten theory and the SFT they  seem almost canonical.

 The condition (3) plays a role in the comparison of the linearizations $Df(0)$ and $Dg(0)$, assuming that $f(0)=0=g(0)$, as we are going to explain next.
 
 It  follows from the definition of a retract that
$\rho (r(y))\circ \rho (r(y))=\rho (r(y)).$ Hence, since $y=0\in O$ we have $r(0)=0$ and $\rho(0)\circ \rho(0)=\rho (0)$ so that $\rho (0)$ is a linear sc-projection in $F$ and we obtain the sc-splitting
$$
F=\rho (0)F\oplus (\mathbbm{1} -\rho (0))F.
$$
Similarly, it follows from $r(r(y))=r(y)$ for $y\in U$ that $Dr (0)\circ Dr (0)=Dr(0)$ so that $Dr (0)$ is a linear sc-projection in $E$ which gives rise to the sc-splitting
$$
\alpha \oplus \beta \in  E=Dr (0)E\oplus (\mathbbm{1} -Dr (0))E.
$$
We recall that the linearization $Tf(0)$  of the section $f\colon O\to K$ at $y=0=r(0)$ is defined as the restriction of the derivative $D(f\circ r)(0)$ of the map $f\circ r\colon U\to F$ to $T_0O$. From $\rho (r(y))f(r(y))=f(r(y))$ for $y\in U$  close to $0$,  we obtain, using $f(0)=0$,  by linearization 
at $y=0$ the relation $\rho (0)Tf(0)=Tf(0)$. From $g(r(y))=f(r(y))$ for $y\in U$ near $0$ we deduce $Tg(0)=Tf(0)$ on $T_0O$. 
 From the identity
 \begin{gather*}
(\mathbbm{1} -\rho (r(y))g(r(y))=0\quad \text{for $y\in U$ near $0$},
\end{gather*}
we deduce, using $g(0)=0$, the relation
$(\mathbbm{1} -\rho (0))Dg (0)\circ Dr(0)=0$. 
Hence  the matrix representation of $D g (0)\colon E\to F$ with respect to the above splittings of $E$ and $F$ looks as follows,$$
Dg(0)\begin{bmatrix}\alpha \\ \beta
\end{bmatrix}=
\begin{bmatrix}Tf (0)&\rho (0)Dg(0)({\mathbbm 1}-Dr(0))\\0&(\mathbbm{1} -\rho (0)) Dg (0)({\mathbbm 1}-Dr(0))\end{bmatrix}\cdot
\begin{bmatrix}\alpha\\ \beta
\end{bmatrix}.
$$
In view of property (3), the linear map $\beta \mapsto (\mathbbm{1} -\rho (0))\circ Dg (0)({\mathbbm 1}-Dr(0))\beta$ from $(\mathbbm{1} -Dr (0))E$ to $(\mathbbm{1} -D\rho(0))F$ is an isomorphism of Banach spaces. Therefore, 
$$
\text{kernel}\ Dg (0)=(\text{kernel}\ Tf (0))\oplus \{0\}.$$
Moreover the filler has the following additional properties.

\begin{proposition}[{\bf Filler}]\label{filler_new_1}\mbox{}\index{P- Properties of a filler} Assume $f$ has the filling $g$ and $f(0)=0$.
\begin{itemize}
\item[{\em (1)}]\ The operator $Tf(0)\colon Dr(0)E\to \rho (0)F$ is surjective if and only if the operator $Dg(0)\colon E\to F$ is surjective.
\item[{\em (2)}]\ $Tf(0)$ is a Fredholm operator (in the classical sense) if and only if $Dg(0)$ is a Fredholm operator and $\ind Tf(0)=\ind Dg(0)$.
\end{itemize}
\end{proposition}
\begin{proof}
(2)\, To simplify the notation we abbreviate the above matrix representing $Dg(0)$ by 
$$
Dg(0)=\begin{bmatrix}A&B\\0&C\end{bmatrix}
$$
and abbreviate the above splittings by $E=E_0\oplus E_1$ and $F=F_0\oplus F_1$.
The operators in the matrix are bounded between corresponding Banach spaces and $C\colon E_1\to F_1$ is an isomorphism of Banach spaces. Therefore, if $B=0$, the operator $A=Df(0)\colon E_0\to F_0$ is Fredholm if and only if the operator 
$$\begin{bmatrix}
A&0\\0&C\end{bmatrix}\colon E\to F
$$
is Fredholm in which case their indices agree. The statement (2) now follows from the composition formula
$$
\begin{bmatrix}
{\mathbbm 1}&BC^{-1}\\
0&{\mathbbm 1}
\end{bmatrix}
\begin{bmatrix}
A&0\\
0&C
\end{bmatrix}=
\begin{bmatrix}
A&B\\
0&C
\end{bmatrix}
$$
since the first factor is an isomorphism from $F$ to $F$, and hence has index equal to $0$,  and the Fredholm indices of a composition are additive. \\[0.5ex]
(1)\, The statement (1) is an immediate consequence of our assumption that $C$ is an isomorphism.
\qed \end{proof}

To sum up the role of a filler, instead of studying the solution set of the section $f\colon O\to K$ we can as well study the solution set of the filled section $g\colon U \to U\triangleleft F$, which is defined on the relatively open set $U$ of the partial quadrant $C$ in the sc-space $E$ and which, therefore,  is easier to analyze.
\begin{definition}[{\bf Filled version}]\label{filled_version_def}\index{D- Filled version}
If $f$ is a sc-smooth section of the %
strong bundle $P\colon Y\to X$ and $x_0\in X$ a smooth point, we 
 say that the {\bf section germ $(f, x_0)$ has a filling}, if there exists a strong bundle chart  as defined in 
 Definition \ref{def_strong_bundle_chart}, 
$$
\Phi\colon \Phi^{-1}(V)\to  K\quad  \text{covering $\varphi\colon (V,x_0)\mapsto  (O,0)$,}
$$
 where $K\rightarrow O$ is a %
  strong local bundle with $0\in O\subset U$,  such that the section germ $\Phi\circ  f\circ \varphi^{-1}\colon O\to K\subset (U\triangleleft F)$ has a filling 
 $g\colon U\to U\triangleleft F$ near $0$. 
 We shall refer to the section germ $(g, 0)$ as a 
{\bf filled version of $(f, x_0)$}.
\qed
\end{definition}


The next concept is that of a   basic germ.
\begin{definition}[{\bf Basic germ}]\label{BG-00x}\index{D- Basic germ}
Let $W$ be a sc-Banach space and $C=[0,\infty )^k\oplus \R^{n-k}\oplus W$ a partial quadrant. Then 
a {\bf basic germ} is a sc-smooth germ 
$$f\colon {\mathcal O}(C, 0)\rightarrow \R^N\oplus W,$$
satisfying $f(0)=0$ and having the following property.
If  $P\colon  \R^N\oplus W\to  W$ denotes the projection, 
the germ $P\circ f\colon {\mathcal O}(C,0)\rightarrow (W,0)$ has the form
$$
P\circ f(a,w)=w-B(a,w) 
$$
for $(a,w)\in ([0,\infty )^k\oplus \R^{n-k})\oplus W$ where $B(0,0)=0$. 
Moreover, for every $\varepsilon>0$ and  every integer $m\geq 0$, the estimate
$$
\abs{B(a,w)-B(a,w')}_m\leq \varepsilon\cdot \abs{w-w'}_m
$$
holds, if $(a, w)$ and $(a, w')$ are close enough to $(0,0)$ on level $m$.
\qed
\end{definition}


\begin{remark}\index{R- On the notion of basic class}
The notion of basic class was introduced in \cite{HWZ3} where, however, we did not require 
$f(0)=0$. Instead we required that $P\circ (f-f(0))$ has  a form as described in Definition \ref{oi}. The later developments convinced us that it is more convenient to require that $f(0)=0$. 
\qed
\end{remark}

\begin{lemma}\label{new_Lemma3.9}\index{L- Derivative of a basic germ}
Let $B\colon [0,\infty)^k\oplus \R^{n-k}\oplus W\to W$ be a sc-smooth germ around $0$ satisfying the properties described in Definition \ref{BG-00x}. Then 
for every $\varepsilon>0$ and $m\geq 0$,
\begin{equation}\label{est_second_der_B}
\abs{D_2B(a, w)\zeta}_m\leq \varepsilon\abs{\zeta}_m
\end{equation}
for all $\zeta\in W_m$, if $(a, w)\in E_{m+1}$ is close enough to $(0, 0)$ in $E_m$. In particular, 
$$D_2B(0, 0)=0.$$
\end{lemma}
\begin{proof}
Since $W_{m+1}\subset W_m$ is dense, it is sufficient to verify the estimate for $\zeta\in W_{m+1}$ satisfying $\abs{\zeta}_{m+1}=1$. For such a $\zeta$ we know  from the definition of the linearization,  recalling Proposition \ref{sc_up},  that $B(a, w)-B(a, w+t\zeta)-D_2B(a, w)(t\zeta)=o(t)$, where $w+t\zeta\in C$,  $\abs{o(t)/t}_m\to 0$ as $t\to 0$. Therefore, 
\begin{equation*}
\begin{split}
\abs{D_2B(a, w)\zeta}_m&=\abs{\dfrac{1}{t}D_2B(a, w)(t\zeta)}_m\\
&\leq \dfrac{1}{\abs{t}}\abs{B(a, w)-B(a, w+t\zeta)}_m+ \dfrac{1}{\abs{t}}\abs{o(t)}_m.
\end{split}
\end{equation*}
The first  term on the right hand side is estimated by $\varepsilon\abs{\zeta}_m$ if $(a, w)$ and $(a, w+t\zeta)$ are sufficiently small in $E_m$. Therefore, the estimate \eqref{est_second_der_B} follows as $t\to 0$.
\qed \end{proof}

We will see that basic germs have special properties as already the following application of Lemma \ref{new_Lemma3.9} demonstrates.
\begin{proposition}\label{Newprop_3.9}\index{P- Fredholm property of basic germs}
Let $f\colon [0,\infty)^k\oplus \R^{n-k}\oplus W=E \to \R^N\oplus W$ be a sc-smooth germ around $0$ of the form $f=h+s$ where $h$ is a basic  germ and $s$ a $\ssc^+$-germ. Then 
$$Df(0)\colon \R^n\oplus W\to \R^N\oplus W$$
is a sc-Fredholm operator and its index is equal to 
$$\ind Df(0)=n-N.$$
Moreover, for every $m\geq 0$,
$$Df(a, w)\colon \R^n\oplus W_m\to \R^N\oplus W_m$$ is a Fredholm operator having index $n-N$,  if $(a, w)\in E_{m+1}$ is sufficiently small in $E_m$.
\end{proposition}

\begin{proof}

With the sc-projection $P\colon \R^N\oplus W\to W$, the linearization of $f$ at the smooth point $0$, 
$Df(0)=P\circ Df(0)+({\mathbbm 1}-P)\circ Df(0)$, is explicitly given by the formula
\begin{equation*}
\begin{split}
Df(0)(\delta a, \delta w)&=\delta w-D_2B(0)\delta w-D_1B(0)\delta a\\
&\phantom{=}+({\mathbbm 1}-P)\circ Df(0)(\delta a, \delta w) +Ds(0)(\delta a, \delta w).
\end{split}
\end{equation*}
By Lemma \ref{new_Lemma3.9}, $D_2B(0)=0$. Therefore, the operator $Df(0)$ is a $\ssc^+$-perturbation of the operator 
\begin{equation}\label{new_equation_sc-pert}
\R^n\oplus W\to \R^N\oplus W, \quad (\delta a, \delta w)
\mapsto (0,\delta w).
\end{equation}
The operator \eqref{new_equation_sc-pert} is a sc-Fredholm operator whose 
kernel is equal to $\R^n$ and whose cokernel is $\R^N$, so that its Fredholm index is equal to $n-N$. 
Since $Df(0)$ is a $\ssc^+$-perturbation of a sc-Fredholm operator, it is also a   sc-Fredholm operator by Proposition \ref{prop1.21}. Because $\ssc^+$-operators are compact, if considered on the same level, the Fredholm index is unchanged and so, 
$\ind Df(0)=n-N$. 

The second statement follows from the fact that the linear operator 
$$
Df(a, w)\colon \R^n\oplus W_m\to \R^N\oplus W_m
$$
 is a compact perturbation of the operator 
\begin{equation}\label{new_equation_fredholm_pert}
(\delta a, \delta w)
\mapsto (0,({\mathbbm 1}-D_2B(a, w))\delta w).
\end{equation}
Choosing $0<\varepsilon <1$ in Lemma \ref{new_Lemma3.9}, the operator 
${\mathbbm 1}-D_2B(a, w)\colon W_m\to W_m$ is an isomorphism of Banach spaces if $(a, w)\in E_{m+1}$ is sufficiently small in $E_m$. Hence the operator \eqref{new_equation_fredholm_pert} is a Fredholm operator of index $n-N$ and the proposition follows.

\qed \end{proof}

Finally,  we are in a position to introduce the  sc-Fredholm germs.

\begin{definition}[{\bf sc-Fredholm germ}]\label{oi}\index{D- Sc-Fredholm germ}
Let $f$ be a sc-smooth section of the strong bundle $P\colon Y\to X$ over the %
M-polyfold $X$, and let $x_0\in X$ be a smooth point.  Then $(f,x_0)$ is a {\bf sc-Fredholm germ} provided it possesses  a filled version 
$$
(g,0)\colon {\mathcal O}(U,0)\to U\triangleleft F
$$
 according to Definition \ref{filled_version_def} and having the following property. 
There exists a local $\ssc^+$-section $s\colon U\to U\triangleleft F$ satisfying $s(0)=g(0)$ such that  the germ 
$(g-s,0)\colon {\mathcal O}(U,0)\to U\triangleleft (F,0)$
is conjugated to a basic germ. 
The last condition requires the existence of a strong bundle isomorphism  defined near $0\in U$ covering the sc-diffeomorphism 
$\psi$ such that the push-forward section 
$$
\Psi \circ (g-s)\circ \psi^{-1}
\colon {\mathcal O}(U',0) \to (U'\triangleleft F',(0,0))
$$
is a basic germ (near $0$).
\qed
\end{definition}
From Proposition \ref{Newprop_3.9} we deduce that the linearization $D(g-s)(0)$ at the point $0$ is a sc-Fredholm operator. Consequently,  $Dg(0)$ is a sc-Fredholm operator by Proposition \ref{prop1.21}, and so, the tangent map 
$Tf(x_0)\colon T_{x_0}X\to Y_{f(x_0)}Y$ is a linear sc-Fredholm operator having the same index as $Dg(0)$, namely $\ind Tf(x_0)=n-N$, in view of the properties of a filler in Proposition \ref{filler_new_1}.

\begin{remark}\index{R- Comments on the notion of sc-Fredholm germ}
The above definition of a sc-Fredholm germ looks  complicated; one first has to find a filled version, which then, after some correction by a $\ssc^+$-section, is conjugated to a basic germ.
It turns out that the definition of a sc-Fredholm germ is extremely practicable in the applications we have in mind. 
By experience one may say that the fillings, which are usually only needed
near data describing bubbling-off situations seem almost natural, i.e. ``if one sees one example one has seen them all''. 
Examples of fillings  in the  Gromov-Witten, SFT and Floer Theory can be found in  \cite{HWZ5,FH2}.
The subtraction of a suitable $\ssc^+$-section is in applications essentially the removing of lower order terms of a nonlinear differential operator
and therefore allows simplifications of the expressions before one tries to conjugate them to a basic germ.
 One also has to keep in mind that the sc-Fredholm theory is designed to cope with spaces whose tangent spaces have locally varying dimensions, on which, on the analytical side, one studies systems of partial differential equations on varying domains into varying codomains.  Later on 
we shall give criteria (which in practice are easy to check)  to verify  that a section is conjugated to a basic germ.
In \cite{FH2} a pre-Fredholm theory has been developed which allows to build complicated sc-Fredholm sections from simpler pieces.
\qed
\end{remark}

Sc-Fredholm germs possess a useful local compactness property.
\begin{theorem}[{\bf Local Compactness for sc-Fredholm Germs}] \label{compact-x}\index{T- Local compactness}
Let $f$ be a sc-smooth section of the %
strong bundle $P\colon Y\rightarrow X$, and $x_0\in X$  a smooth point. We assume that $(f,x_0)$ is a sc-Fredholm germ satisfying $f(x_0)=0$. Then there exist a nested sequence
of open neighborhood ${\mathcal O}(i)$ of $x_0$ in $X_0$,  for $i\geq 0$, 
$$
{\mathcal O}(0)\supset  {\mathcal O}(1)\supset \cdots  \supset {\mathcal O}(i)\supset   {\mathcal O}(i+1) \supset \cdots  \, ,
$$
such  that for every $i$ the $X_0$-closure 
 $\cl_{X_0}(\{x\in {\mathcal O}(i)\,  \vert \,  f(x)=0\})$ is a compact subset of $ X_i$.
 \qed
\end{theorem}
\begin{remark}\index{R- On $O(i)$}
We emphasize that the ${\mathcal O}(i)$ are open neighborhoods in $X$, i.e. on level $0$.
\qed
\end{remark}

Theorem \ref{compact-x} is an immediate consequence of 
Theorem \ref{save}, which will be introduced later,
and has the following corollary.
\begin{corollary}\index{C- Local compactness and regularity}
Let $f$ be a sc-smooth section of the %
strong bundle $P\colon Y\rightarrow X$, and $x_0\in X$  a smooth point. We assume that $(f,x_0)$ is a sc-Fredholm germ satisfying $f(x_0)=0$. 
If $(x_k)\subset X$ is a sequence satisfying   $f(x_k)=0$ and $x_k\rightarrow x$ in $X_0$,  then it follows, for every  given any $m\geq 0$, that 
$x_k\in X_m$ for $k$ large and $x_k\rightarrow x$ in $X_m$.
\qed
\end{corollary}
Next we give the basic definition of an sc-Fredholm section.

\begin{definition}[{\bf Sc-Fredholm section}]\index{D- Sc-Fredholm section}\label{DEFX3116}
A section  $f$ of the %
strong bundle $P\colon Y\rightarrow X$ over the M-polyfod $X$ is called  {\bf sc-Fredholm section}, if it has 
the following three properties.
\begin{itemize}
\item[(1)]\ $f$ is sc-smooth.
\item[(2)]\ $f$ is regularizing, i.e.,  if $x\in X_m$ and  $f(x)\in Y_{m,m+1}$, then $x\in X_{m+1}$.
\index{D- Regularizing section}
\item[(3)]\ The germ $(f,x)$ is a sc-Fredholm germ at  every smooth point $x\in X$.
\end{itemize}
\qed
\end{definition}


\begin{remark}\index{R- On the sc-implicit funtion theorem}
The  implicit function theorem,  introduced later on,  is applicable to sc-Fredholm sections and will lead to the following local  result near a smooth interior point $x_0\in X$ ( i.e.,  $d_X(x_0)=0$). Assuming that  $f(x_0)=0$  the linearization $f'(x_0)\colon T_{x_0}X\rightarrow Y_{x_0}$ 
is a sc-Fredholm operator. Moreover, if  $f'(x_0)$ is surjective, then the solution set
$\{x\in X\, \vert \, f(x)=0\}$ near $x_0$ has the structure of a finite dimensional smooth manifold (in the classical sense) whose dimension agrees with the Fredholm index.  Its smooth structure is in a canonical way  induced 
from the M-polyfold structure of $X$.
In case that $x$ is a boundary point, so that  $d_X(x)\geq 1$, we can only expect the solution set to be reasonable provided 
the kernel of $f'(x)$ lies in good position to the boundary of $X$ and the boundary $\partial X$ is sufficiently well-behaved.
In order that $\partial X$ is regular enough we shall require 
that $X$ is a tame M-polyfold,  so that we can ask  $\ker(f'(x))$ to be in good position to the partial quadrant $C_xX$ in $T_xX$, 
a  notion which we shall introduce later on.
\qed
\end{remark}


 If $P\colon Y\to X$ is a %
 strong bundle,  we denote by $\Gamma(P)$\index{$\Gamma(P)$} the vector space of sc-smooth sections; by  $\text{Fred}(P)$\index{$\text{Fred}(P)$} we denote the subset of $\Gamma(P)$ consisting of sc-Fredholm sections. Finally, by  
$\Gamma^+(P)$\index{$\Gamma^+(P)$} we denote  
the vector space of $\ssc^+$-sections as introduced in Definition 
\ref{def_sc_inft_sections}.
The following stability property   of a sc-Fredholm section will be crucial for the transversality theory.

\begin{theorem}[{\bf Stability under $\ssc^{\pmb{+}}$-perturbations}]\label{stabxx}  \index{T- Stability of sc-Fredholm sections}
Let $P\colon Y\rightarrow X$ be a  strong bundle over the %
M-polyfold $X$.
If  $f\in \Fred (P)$ and $s\in \Gamma^+(P)$, then $f+s\in \Fred (P)$.
\qed
\end{theorem}

In order to prove the theorem we need  two lemmata for local strong bundles. We recall  the local strong bundle retract  $(K, C\triangleleft F, E\triangleleft F)$ from  Definition \ref{def_loc_strong_b_retract}, consisting of the retract $K=R(U\triangleleft F)$, where $R\colon U\triangleleft F\to U\triangleleft F$ is a strong bundle retraction of the form 
$$R(u, h)=(r(u), \rho (u)h), $$
in which $r\colon U\to U$ is a smooth retraction onto $O=r(U)\subset  U$. We shall denote the principal parts  of the sections  of the 
bundles $U\triangleleft F\to U$ and $K\to O$  by bold letters.

\begin{lemma}\label{rio}
A $\ssc^+$-section $s\colon O\to K$ (as defined in Definition \ref{def_section_loc_strong_bundle}) possesses an extension to a $\ssc^+$-section 
$\wt{s}\colon U\to U\triangleleft F$, 
$\wt{s}(u)=(u, \wt{\bm{s}}(u))$, 
having the following properties.
\begin{itemize}
\item[{\em (1)}]\ $\wt{s}(u)=s(u)$ if $u\in O$.
\item[{\em (2)}]\  $R(r(u),\wt{\bm{s}}(u))=s(r(u))$ if $u\in U$.
\end{itemize} 
\end{lemma}
\begin{proof}
If $s\colon O\to K$  is given by $s(u)=(u, {\bm{s}}(u))$, $u\in O$, we define the section $\wt{s}\colon U\to U\triangleleft F$ by 
$$\wt{s}(u)=(u, \wt{\bm{s}}(u))=\bigl(u, {\bm{s}}(r(u))\bigr),\quad u\in U.$$
Clearly, $\wt{s}$ is a $\ssc^+$-section  of the bundle 
$U\triangleleft F\to U$ and we claim that its restriction to $O$ agrees with the section $s$. Indeed, if $u\in O$, 
then $r(u)=u$, implying $\wt{s}(u)=\wt{s}(r(u))=\bigl( r(u), {\bm{s}}(r\circ r(u))\bigr)=\bigl( r(u), {\bm{s}}(r(u))\bigr)=
\bigl(u, {\bm{s}}(u)\bigr)=s(u)$ as claimed.  Moreover, using that $s(u)=R(s(u))$ if $u\in O$,
$$R\bigl(r(u), \wt{\bm{s}}(u)\bigr)
=R\bigl(r(u), {\bm{s}}(r(u))\bigr)=R\bigl({ s}(r(u))\bigr)=s(r(u))$$
for $u\in U$.
\qed \end{proof}
\begin{lemma}\label{filler_extension_s}
Let $f\colon O\to K$ be a sc-smooth section of the (previous) local strong bundle retract, and let $s\colon O\to K$ be a $\ssc^+$-section. 
If $f$ possesses the filler $g\colon U\to U\triangleleft F$, then $f+s$ has the filler $g+\wt{s}\colon U\to U\triangleleft F$, where $\wt{s}$ is the extension of $s$ constructed in the previous lemma.
\end{lemma}
\begin{proof}
We have to verify that the section $g+\wt{s}$ meets the three conditions in Definition \ref{x-filling}. The properties  (1) and (2) for $g+\wt{s}$ follow immediately from the properties (1) and (2)   for the filler $g$ and the properties (1) and (2) for the section $\wt{s}$ in Lemma \ref{rio}. In order to verify property (3) of a filler we have to linearize the map 
$$u\mapsto [{\mathbbm 1}-\rho (r(u))](g(u)+\wt{s}(u))$$
at the point $u=0$. Since 
$\bigl({\mathbbm 1}-\rho (r(u))\bigr) \wt{s}(u)=
\bigl({\mathbbm 1}-\rho (r(u))\bigr) s(r(u))=0$ by property (2) of Lemma \ref{rio}, the linearization agrees with the linearization of the map $\bigl({\mathbbm 1}-\rho (r(u))\bigr) g(u)$ which satisfies the required property (3), since $g$ is a filler. The proof of Lemma \ref{filler_extension_s} is finished.
\qed \end{proof}

\begin{proof}[Theorem \ref{stabxx}]
Let $f$ be a sc-Fredholm section of the %
strong bundle $P\colon Y\to X$ and let $s\colon X\to Y$ be a $\ssc^+$-section of $P$. Then $f+s$ is a sc-smooth section which is also regularizing. It remains to verify that $(f+s, x)$ is a sc-Fredholm germ for every smooth point $x\in X$. By definition of being sc-Fredholm,
$(f, x)$ is a sc-Fredholm germ at the smooth point $x$. Therefore, there exists an open neighborhood $V$ of $x$ and a strong bundle chart 
$(V, P^{-1}(V), (K, C\triangleleft F,E\triangleleft F))$ as defined in Definition
 \ref{def_strong_bundle_chart} and satisfying $\varphi (x)=0\in O$, such that the local representation $\wt{f}=\Phi_\ast (f)=\Phi\circ f\circ \varphi^{-1}\colon O\to K$ of the section $f$ possesses a filled version $g\colon U\to 
U\triangleleft F$ around $0$,  which after subtraction of a suitable $\ssc^+$-section,  is conjugated to a basic germ around $0$. Define $t=\Phi_\ast (s)$. Then $t\colon O\to K$ is a $\ssc^+$-section. By Lemma \ref{rio}  
there is a particular $\ssc^+$-section $\wt{t}\colon U\to U\triangleleft F$ extending $t$. By Lemma \ref{filler_extension_s}, the section $g+\wt{t}\colon U\to U\triangleleft F$ is a filling of $\wt{f}+t$.
In view of the sc-Fredholm germ property, there exists a $\ssc^+$-section $t'$ satisfying $t'(0)=g(0)$ and such that $g-t'$ is conjugated to a basic germ. Now taking the $\ssc^+$-section $\wt{t}+t'\colon U\to U\triangleleft F$, we have $(g+\wt{t})(0)=(\wt{t}+t)(0)$. Moreover, $(g+\wt{t})-(\wt{t}+t')=g-t'$ which, as we already know, is conjugated to a basic germ. To sum up, we have verified that $(f+s, x)$ is a sc-Fredholm germ. This holds true for every smooth point $x\in X$. Consequently, the section $f+s$ is a Fredholm section and the proof of Theorem \ref{stabxx} is complete.
\qed \end{proof}

In order to formulate  a parametrized version of Proposition \ref{stabxx} 
we assume that $P\colon Y\rightarrow X$ is a  strong bundle and $f$ a sc-Fredholm section. The sc-smooth projection 
$$
\pi\colon \R^n\times X\rightarrow X,\quad  (r,x)\mapsto  x,
$$
pulls back the bundle $P$ to the  strong bundle   $\pi^\ast(P)\colon \pi^\ast Y\rightarrow \R^n\times X$.
The section $\wt{f}$ of $\pi^\ast(P)$,  defined by
$$
\wt{f}(r,x)=((r,x),f(x)), 
$$
 is a sc-Fredholm section as is readily verified.  
If $s_1,\ldots ,s_n$ are $\ssc^+$-sections of $P$, then $\wt{s}(r,x)\colon =\bigl( (r,x),\sum_{i=1}^n r_i\cdot s_i(x)\bigr)$ is a $\ssc^+$-section
 of  the pull back bundle $\pi^\ast(P)$ and,  by the stability 
 Theorem \ref{stabxx}, the section 
 $$
 (r,x)\mapsto \wt{f}(r,x)+\wt{s}(r,x)
 $$
 is a sc-Fredholm section of $\pi^\ast(P)$. Hence we have proved the following stability result.
 \begin{theorem}[{\bf Parameterized Perturbations}]\label{corro}\index{T- Parameterized perturbations}
 Let $P\colon Y\rightarrow X$ be a %
 strong bundle and $f$ a sc-Fredholm section. If  $s_1,\ldots ,s_n\in\Gamma^+(P)$, 
then the map
 $$
 \R^n\times X\rightarrow Y,\quad (r,x)\mapsto f(x)+\sum_{i=1}^n r_i\cdot s_i(x)
 $$
 defines a sc-Fredholm section of the bundle $\pi^\ast(P)\colon \pi^\ast Y\rightarrow \R^n\times X$.
 \qed
 \end{theorem}
This theorem and refined versions of the theorem play a role  in the perturbation and transversality theory. As already pointed out,  
the distinguished class of sc-Fredholm sections allows  to apply an implicit function theorem in the usual sense. 
We first formulate the  implicit function theorem at an interior point. 
\begin{theorem}[{\bf Implicit Function Theorem}]\label{implicit-x}\index{T- Implicit function theorem}
Assume that $P\colon Y\rightarrow X$ is a strong bundle over the  M-polyfold $X$ satisfying $d_X\equiv 0$,  and $f$ a sc-Fredholm section.
Suppose that $x_0\in X$ is a smooth point in $X$,  such  that $f(x_0)=0$. Then the linearization  $f'(x_0)\colon T_{x_0}X\rightarrow Y_{x_0}$  is a sc-Fredholm operator. If $f'(x_0)$  surjective,  
then there exists an open neighborhood $U$ of $x_0\in X$ such  that the solution set $S(f,U)=\{x\in U\, \vert \,  f(x)=0\}$ in $U$ has in a natural way the structure
of a smooth finite dimensional manifold whose dimension agrees with the Fredholm index.  In addition,  $U$ can be chosen  in such a way that the linearization $f'(y)\colon T_yX\rightarrow Y_y$ for $y\in S(f,U)$ is surjective  and  $\ker(f'(y))=T_yS(f,U)$ is the tangent space.
\qed
\end{theorem}
Theorem \ref{implicit-x} is an immediate consequence of Theorem \ref{IMPLICIT0} in Section \ref{ssec3.4}.
As we shall see, the smooth manifold structure on $S(f,U)$ is induced from the M-polyfold structure of $X$.
\begin{remark}\index{R- On the definition of sc-Fredholm section}\label{remark.3_20}
We should point out that in the original proof of Theorem \ref{IMPLICIT0} in \cite{HWZ3} (Theorem 4.6 and Proposition 4.7) the sc-Fredholm section is defined slightly differently, namely as follows. In \cite{HWZ3}
a sc-smooth section $f$ of the strong bundle $Y\to X$ is called sc-Fredholm, if it possesses around all smooth points of $X$ a filled version 
 $(g,0)$ such that $g-g(0)$ near $0$ is conjugated to a basic germ. It is, in this case, not true that $f+s$ is sc-Fredholm for $\ssc^+$-section $s$. However, by a nontrivial theorem in \cite{HWZ3} (Theorem 3.9), increasing the level, the section 
$(f+s)^1$ of the the strong bundle $Y^1\rightarrow X^1$ is sc-Fredholm. Although not harmful in practice,  this looks unsatisfactory. 


This is why we have introduced the new definition (Definition \ref{oi}) of sc-Fredholm, where we require for the filled version $(g, 0)$ that there exists a local $\ssc^+$-section $s\colon U\to U\triangleleft F$ such that $s(0)=g(0)$ and $g-s$ is locally conjugated to a basic germ.
If now $t$ is a $\ssc^+$-section, then the section $f+t$ of the bundle $Y\to X$ is automatically sc-Fredholm in view of Theorem \ref{stabxx}. 

The difficulty of the nontrivial theorem is now hidden in the proof of the implicit function theorem, which has to incorporate
the arguments of the nontrivial theorem. With the new definition, even if we want to study $f$ only, we have
only normal forms for the perturbed expression, which might be unrelated to our problem.  However, writing $f=(f-s) + s$, we know how $f-s$ looks like, and we know that $s$ is a compact perturbation of $f-s$.  We  combine  these facts to gain sufficient information about $f^1$ to determine, in view the regularizing property of sc-Fredholm sections, the solution set of $f$.
\qed
\end{remark}

Next we discuss some consequences of Theorem \ref{implicit-x}.  Considering a sc-Fredholm section $f$ of the 
strong bundle $Y\rightarrow X$ over the  M-polyfold $X$ having no boundary (i.e., $d_X\equiv 0$),
we assume, in addition,  that the M-polyfold $X$ admits a sc-smooth partition of unity.
Then there exists, for two given smooth points $x\in X$ and $e\in Y_x$, a $\ssc^+$-section $s$ supported near $x$ and satisfying $s(x)=e$.  For the easy proof we refer to \cite{HWZ3}. As we shall see later it suffices to assume the existence of sc-smooth bump functions instead of sc-smooth partitions of  unity.
If $f(x_0)=0$ and $f'(x_0)$ is not surjective, we find finitely many smooth elements $e_1,\ldots ,e_k\in Y_{x_0}$ satisfying $R(f'(x_0))\oplus \R e_1\oplus \cdots \oplus \R e_k=Y_{x_0}$. Taking  $\ssc^\infty$-sections $s_i$ satisfying $s_i(x_0)=e_i$, we define the map $\wt{f}\colon \R^k\oplus X\to Y$  by 
$$\wt{f}(r, x)=f(x)+\sum_{i=1}^k r_is_i(x).$$
The linearization of $\wt{f}$ at  the distinguished point $(0,x_0)\in  \R^k\oplus X$ is the continuous linear map 
$$
\wt{f}'(0, x_0)(h,u)= f'(x_0)u +\sum_{i=1}^k h_i e_i,
$$
which is surjective. By Theorem \ref{corro}  and Theorem \ref{IMPLICIT0} we find an open neighborhood $U$ of $(0,x_0)\in \R^k\oplus X$
such  that the solution set of $S(\wt{f}, U)=\{(r,x)\in U\, \vert \,  f(x)+\sum_{i=1}^k r_i\cdot s_i(x)=0\}$ is a smooth finite-dimensional manifold.
The trivial bundle $S(\wt{f},U)\times \R^k\rightarrow S(\wt{f},U)$ has the canonical section $(r,y)\mapsto r$. 
The zero set of this section is precisely the unperturbed solution set of $f(y)=0$ for $y\in U$.
If the solution set of $f(y)=0$, $y\in X$, is compact we can carry out the previous construction globally, which gives rise to  global finite-dimensional reduction. This will be discussed later on.





In order to formulate the boundary version of the implicit function theorem we start with some preparation.

\begin{definition}[{\bf In good position}] \label{mission1}\index{D- Good position}\index{D- Good complement}
Let $C\subset E$ be a partial quadrant in the sc-Banach space $E$ and $N\subset E$ be a finite-dimensional sc-subspace of $E$.  The subspace $N$ is in  {\bf good position to the partial quadrant $C$}, if the interior of $N\cap C$ in $N$  is non-empty, and if $N$ possesses a  sc-complement $P$, so that $E=N\oplus P$, having the following property. There exists  $\varepsilon>0$, such that 
for pairs $(n, p)\in N\times P$ satisfying $\abs{p}_{0}\leq \varepsilon\abs{n}_{0}$ the statements 
$n\in C$ and $n+p\in C$ are equivalent. We call such a sc-complement $P$ a {\bf good complement}.
\qed
\end{definition}

The choice of the right complement $P$ is important. One cannot take a random sc-complement of $N$, in general,  as Lemma 
\ref{cone1} demonstrates.


In view of Proposition \ref{prop1} the finite dimensional subspace $N$ in Definition \ref{mission1}, possessing the sc-complement $P$, is necessarily a smooth subspace. A finite dimensional subspace $N$ which is not necessarily smooth is called in good position to the partial quadrant $C$ in the sc-Banach space $E$ if there exists a (merely) topological complement $P$ in $E$ satisfying the requirements of Definition \ref{mission1} for some $\varepsilon>0$.





\begin{figure}[htb]
\centering
\def\svgwidth{65ex}
\input{pict3.pdf_tex}
\caption{In figure (a) $N$ is in good position to $C$ while in figure (b) $N$ is not in good position to $C$.}\label{fig:pict3}
\end{figure}


The following result  is taken from \cite{HWZ3}, Proposition 6.1. Its proof is reproduced in Appendix \ref{pretzel-A}.
\begin{proposition}\label{pretzel}\index{P- Good position and partial quadrants}
If  $N$ is a finite-dimensional sc-subspace in good position to the partial quadrant  $C$ in $E$, then
$N\cap C$ is a partial quadrant in $N$.
\qed
\end{proposition}


The boundary version of the implicit function theorem is formulated in the next theorem. The proof is again given later.

\begin{theorem}[{\bf Implicit Function Theorem: Boundary Case}]\label{bound}\index{T- Implicit function theorem {II}}
We assume that $P\colon Y\rightarrow X$ is a strong bundle over the tame M-polyfold $X$, and $f$ is a sc-Fredholm section.
Suppose that $x\in X$ satisfies $f(x)=0$ and the following two properties.
\begin{itemize}
\item[{\em (a)}]\ The linearisation $f'(x)\colon T_xX\rightarrow Y_x$ is surjective.
\item[{\em (b)}]\ The kernel $N$ of $f'(x)$ is in good position to the boundary of $X$, i.e. $N$ is in good position to the partial quadrant $C_xX$ in the tangent space $T_xX$.
\end{itemize}
Then there exists an open neighborhood $U$ of $x$ such  that the following holds.
\begin{itemize}
\item[{\em (1)}]\ The local solution set $S(f,U):=\{y\in U\ |\ f(y)=0\}$, which consists of smooth points, is a tame sub-M-polyfold of $X$. 
\item[{\em (2)}]\ The tame sub-M-polyfold $S(f,u)$ admits a uniquely determined sc-smooth equivalent structure as a smooth manifold with boundary with corners. 
\item[{\em (3)}]\ For every $z\in S(f,U)$ the linearization $f'(z):T_zX\rightarrow Y_z$ is surjective and $\ker(f'(z))=T_zS(f,U)$.
\end{itemize}
\qed
\end{theorem}
Theorem \ref{bound} is a consequence of Theorem \ref{IMPLICIT0} in Section \ref{ssec3.4}.
In the proof of Theorem \ref{bound} we shall describe the manifold structure on the solution space in  detail.
Here we just indicate  how it looks like.  Since $S(f,U)\subset X_\infty$ and $X$  is a tame M-polyfold, we can take for a point $y\in S(f,U)$
a sc-diffeomorphism $\Psi\colon U(y)\rightarrow O=O(0)$, where $(O,C,E)$ is a tame retract. Then if $t\colon V\rightarrow V$ satisfies
$O=t(V)$ we have the splitting $E=T_0O\oplus (({\mathbbm 1}-Dt(0))E)$, with $Y=({\mathbbm 1}-Dt(0))E$ contained in $T_0^RC$. 
Also the proof will show that $T_0O$ is finite-dimensional. Let $p=Dt(0)$ be the projection onto $T_0O$.
Then it will be shown that near $0$ the projection $p\colon {\mathcal U}'(0)\rightarrow {\mathcal V}(0)$ is a sc-diffeomorphism,
where ${\mathcal U}'$ is an open neighborhood of $0$ in $O$ and ${\mathcal V}$ is an open neighborhood of $0$ in $C_0O$.
Then, for ${\mathcal U}=\Psi^{-1}({\mathcal U}')$ the map
$$
{\mathcal U}\rightarrow {\mathcal V}, \quad  y\mapsto  p\circ \Psi(y)
$$
is a sc-diffeomorphism and its mage lies in an relatively open neighborhood of $0$ in the partial quadrant $C_0O$ in $T_0O$.
The associated transition maps for any two such sc-diffeomorphisms are (trivially) sc-diffeomorphisms between relatively open subsets in partial quadrants 
of finite-dimensional vector spaces. Hence they are classically smooth. This shows that the system of such sc-diffeomorphisms
defines a smooth atlas for the structure of a manifold with boundary with corners and by construction this structure is compatible with the existing 
M-polyfold structure on $S(f,U)$.



As a corollary of Theorem \ref{bound} we shall obtain the following result.
\begin{corollary}\index{C- Global implicit function theorem}
Let $P\colon Y\rightarrow X$ be  a strong bundle over the tame M-polyfold $X$ and $f$ be a sc-Fredholm section.
Suppose that for every $x\in X$ satisfying  $f(x)=0$ the linearisation $f'(x)\colon T_xX\rightarrow Y_x$ is surjective 
and the kernel of $f'(x)$ is in good position to the boundary of $X$ (the latter being an empty condition if $d_X(x)=0$). 
Then the solution set $M:=\{x\in X\ |\ f(x)=0\}\subset X$
is a  sub-M-polyfold of $X$ for which the induced structure is tame, and which, moreover,  admits  a sc-smoothly  equivalent structure as a smooth manifold with boundary with corners.
\qed
\end{corollary}

The remaining subsections are devoted to the proofs of the above  results. Since the Fredholm theory is one of the main parts 
of the polyfold theory and draws heavily on the possibilities offered  in the sc-smooth theory we shall carry out  the constructions in great detail.


\section{Subsets with Tangent Structure}
The solution sets of sc-Fredholm sections will come with a certain structure, which in the generic case will induce a natural smooth manifold 
on the solution set. This subsection studies this structure.  Recall the definition of a smooth finite-dimensional subspace $N$ in good position to the partial quadrant $C$ (Definition \ref{mission1}). For such a subspace, $N\cap C$ is a partial quadrant in $N$ (Proposition \ref{pretzel}).


\begin{definition}[{\bf $n$-dimensional tangent germ property}]\label{toast}\index{D- Tangent germ property}
We consider a tame M-polyfold $X$ and a subset $M\subset X$ of  $X$. The subset $M$ has the {\bf $\bm{n}$-dimensional tangent germ property}
provided the following holds.
\begin{itemize}
\item[(a)]\  $M\subset X_\infty$.
\item[(b)]\  Every point $x\in M$  lies in an open neighborhood $U\subset X$ of $x$ such that there exists a sc-smooth chart
$\varphi\colon (U,x)\rightarrow (O,0)$ onto a tame  retract  $(O,C,E)$. Moreover, there exists  a $n$-dimensional smooth subspace $N\subset E$ in good position to the partial quadrant $C$, which possesses a good complement $Y$ so that $E=N\oplus Y$.  In addition,  there exists a relatively open neighborhood $V$ of $0$ in the partial quadrant $N\cap C$  and a continuous map
$\delta\colon V\rightarrow Y$ having the following properties.
\begin{itemize}
\item[(1)]\ $\varphi(M\cap U) =\{v+\delta(v)\, \vert \, v\in V\}\subset N\oplus Y$.
\item[(2)]\ $\delta\colon {\mathcal O}(N\cap C,0)\rightarrow (Y,0)$ is a $\ssc^\infty$-germ satisfying  $\delta (0)=0$ and $D\delta(0)=0$.
\end{itemize}
\end{itemize}
\qed
 \end{definition}
 
 
 


\begin{figure}[htb]
\begin{centering}
\def\svgwidth{50ex}
\input{pict4.pdf_tex}
\caption{}\label{fig:pict4}
\end{centering}
\end{figure}


Recalling  the definition of a $\ssc^\infty$-germ (Definition \ref{germy}) we note that here $V$ is a relatively open neighborhood of $0$ in the partial quadrant $N\cap C$ where $N$ is a smooth  finite-dimensional space.
There exists a nested sequence $(V_m)$ of relatively open neighborhoods of $0$ in $N\cap C$, say $V=V_0\supset V_1\supset V_2\supset \ldots$,  such  that
$\delta(V_m)\subset Y_m$ and $\delta\colon V_m\rightarrow Y_m$ is continuous.  Denoting this sequence of neighborhoods by ${\mathcal O}(N\cap C,0)$, its tangent is the nested sequence 
$TV_1\supset TV_2\supset TV_2 \ldots $ denoted by $T{\mathcal O}(N\cap C,0)$.  If $x\in V_1$, then the map $D\delta(x)$ is defined, and since  $\delta$ is  a $\ssc^\infty$-germ, the tangent map 
 $T\delta\colon T{\mathcal O}(N\cap C,0)\rightarrow TY$  is again of class $\ssc^1$. Iteratively it follows that $T\delta$ is a $\ssc^\infty$-germ.
 

\begin{proposition}\index{P- Invariance of tangent germ property}
For a pair $(X,M)$ in which  $X$ is a tame M-polyfold and $M$ a subset of $X$,  the property that $M$ has the n-dimensional tangent germ property, 
is a sc-diffeomorphism invariant. More precisely, if $(X',M')$ is a second pair in which  $X'$ is a tame M-polyfold and $M'$ a subset of $X'$ and if $\psi\colon X\rightarrow X'$ is a sc-diffeomorphism satisfying $\psi(M)=M'$,  then $M'$ has the n-dimensional tangent germ property if and only if
$M$  has the n-dimensional tangent germ property.
\end{proposition}
\begin{proof}
We show that if $M\subset X$ has the n-dimensional tangent germ property, then $M'\subset X'$ has this property  too.
Since $M\subset X_\infty$ and $\psi$ is sc-smooth,  we see that $M'=\psi(M)\subset X'_\infty$. Let $m'\in M'$ and  choose a point  $m\in M$ satisfying $\psi(m)=m'$.
By assumption there exists a sc-smooth chart $\varphi\colon (U,m)\rightarrow (O,0)$, where $(O,C,E)$ is a tame retract. By assumption there exists
a smooth n-dimensional linear subspace $N$ in good position to $C$ with sc-complement $Y$ and a continuous map
$\delta\colon V\rightarrow Y$, where $V$ is a relatively open neighborhood of $0$ in $C_N: =C\cap N$, which satisfies
\begin{itemize}
\item  $\varphi(M\cap U)=\{v+\delta(v)\ |\ v\in V\}\subset N\oplus Y$.
\item  $\delta\colon {\mathcal O}(C_N,0)\rightarrow (Y,0)$ is a sc$^\infty$-germ satisfying $\delta (0)=0$ and $D\delta(0)=0$.
\end{itemize}
To deduce the corresponding construction for $(X',M')$ we define the open neighborhood $U'\subset X'$ of $m'=\psi (m)$ by $U'=\psi (U)$ and the sc-smooth chart by $\varphi'=\varphi\circ \psi^{-1}\colon (U', m')\to (O, 0)$. Then  
$$
\varphi'(U'\cap M') = \varphi(U\cap M) =\{v+\delta(v)\, \vert \, v\in V\}
$$
and the lemma follows.
\qed \end{proof}

The important aspect of the $n$-dimensional tangent germ property of a subset is the following result. 

\begin{theorem}\label{HKL}\index{T- Characterization of subsets with tangent germ property}
If  $X$ is a tame M-polyfold and $M\subset X$ a subset possessing the $n$-dimensional tangent germ property, then the following holds.
\begin{itemize}
\item[{\em (1)}]\ $M$ is a  sub-M-polyfold of $X$ whose  induced M-polyfold structure is tame.  Moreover,  the induced M-polyfold structure on M is sc-smoothly equivalent to a smooth structure  of a manifold with boundary with corners on $M$. 
\item[{\em (2)}]\ If  $x\in M$ is given, we denote by $U$,  $\varphi$, $N$, $V \subset N$, and $\delta\colon V\rightarrow Y$ the data described in condition (2) of Definition \ref{toast}.
Denoting  by $\pi\colon N\oplus Y\rightarrow N$ the sc-projection, the map $U\cap M\rightarrow V$, given by $y\mapsto  \pi\circ \varphi(y)$,  defines a smooth chart  on $M$ around the point $x$. 
\end{itemize}
\end{theorem}

\begin{proof}

We choose a point $x\in M$ and  find an open neighborhood $U\subset X$ of $x$ and a M-polyfold chart
$\varphi\colon (U,x)\rightarrow (O,0)$ onto the retract $(O, C,E)$  so that the set $M\cap U$ is represented as 
$$
\varphi(M\cap U)=\{v+\delta(v)\, \vert \,   v\in V\}\subset N\oplus Y.
$$
The map $\delta\colon V\to Y$ possesses all the properties listed in condition (2) of Definition \ref{toast}.  The map $\varphi\colon M\cap U\to V$  is of the form $\varphi (y)=v(y)+\delta (v(y))$.
With the sc-projection $\pi\colon N\oplus Y\to N$ onto $N$, the map 
\begin{equation}\label{edi}
\pi\circ \varphi\colon M\cap U\to V,\quad \pi\circ \varphi (y)=v(y)
\end{equation}
is continuous  and bijective onto $V$. It is the restriction of the sc-smooth map $\pi\circ \varphi\colon U\to N$, which maps the point $x\in M$ onto $0\in N$. Then the  inverse $\gamma$  of \eqref{edi},
$$
\gamma\colon V\rightarrow M\cap U,\quad  \gamma(v)=\varphi^{-1}(v+\delta(v))
$$
has its image in $X_\infty$ and,  as a map into any $X_m$,  has arbitrarily high regularity if only $v$ is close enough to $0$, depending on $m$. 

Next we shall show that the map $\gamma$ is $\ssc^\infty$ on all of $V$ and not only at the point $0\in V$. 


To this aim we choose a $v_0\in V$ and put  $x_0=\varphi^{-1}(v_0+\delta(v_0))$. By construction,  $x_0\in M$,  and by our assumption there is a sc-smooth chart $\psi\colon (U',x_0)\to (O', 0)$ satisfying 
$$\psi(M\cap U')=\{w+\tau (w)\, \vert\, w\in V'\}$$
where $V'$ is a relatively open neighborhood of $0$ in the smooth $n$-dimensional subspace $N'\subset E'$ possessing the tangent germ property. The map $\tau\colon V'\to Y'$ possesses the properties listed in condition (2) of Definition \ref{toast}. In particular, $\tau$ is a $\ssc^\infty$-germ at the point $w=0$.

For $v\in V$ near $v_0$ and $w\in V'$ near $0$ we consider the equation
\begin{equation}\label{edi1}
v=\pi\circ\varphi\circ \psi^{-1}(w+\tau(w)).
\end{equation}

If $v=v_0$, we have the solution $w=0$. Near $0$ the map $\tau$ possesses arbitrary high classical differentiability into any level. Linearizing the right-hand side of the equation at the point $0$, and recalling that $D\tau (0)=0$, we obtain the linear isomorphism 
$$h\mapsto \pi\circ T(\varphi\circ \psi^{-1})(0)h$$
from $N'$ onto $N$.  By the classically implicit function theorem we obtain a germ $v\mapsto w(v)$ for $v$ close to $v_0$ satisfying  $w(v_0)=0$ and solving the equation \eqref{edi1}. The germ has arbitrary high classical differentiability once we are close enough to $v_0$. Now consider the map 
\begin{equation}\label{edi2}
v\mapsto  \varphi\circ \psi^{-1}(w(v)+\tau(w(v))
\end{equation}
for $v$ near $v_0$. Since $v\mapsto w(v)$ has arbitrarily high differentiability at $v_0$ and $\tau$ is $\ssc^\infty$-germ near  $w=0$, we see that the map \eqref{edi2} has, into  any given level,  arbitrarily high differentiability for $v$ near $v_0$.  Consequently, the map is a $\ssc^\infty$-germ near $w=0$. The image of the map  lies in the infinity level. Applying the sc-projection  ${\mathbbm 1}-\pi\colon N\oplus Y\to Y$, we obtain the identity 
$$
\delta(v) =({\mathbbm 1}-\pi)\circ \varphi\circ \psi^{-1}(w(v)+\tau(w(v))
$$
which implies that $\delta$ is a $\ssc^\infty$-germ near $v_0$.
Since $v_0$ is arbitrary in $V$ we see that
$v\mapsto \delta(v)$
is a $\ssc^\infty$-germ around every $v_0\in V$ as we wanted to show. 

Moreover, we conclude that the map
$$
V\rightarrow X,\quad  v\rightarrow \varphi^{-1}(v+\delta(v))
$$
is an injective sc-smooth map whose image is equal to  $M\cap U$.


Next we shall verify that the set $M$ is a sub-M-polyfold of $X$ according to Definition \ref{sc_structure_sub_M_polyfold}.  By construction, we have, so far, at every point $x\in M$ an open neighborhood $U=U(x)\subset X$  and a sc-smooth chart $\varphi\colon U\rightarrow O$,
satisfying  $\varphi(x)=0$, where $(O,C,E)$ is a tame sc-smooth retract. Moreover,  recalling the sc-splitting 
 $
 E=N\oplus Y
 $
 there is  a relatively open neighborhood $V$ of $0$ in the partial quadrant $N\cap C$ of $N$ and a sc-smooth map
 $$
\text{$ \delta \colon V\rightarrow Y$ satisfying $\delta (0)=0$ and
 $D\delta (0)=0$}, 
 $$
 such that  $\varphi(M\cap U) =\{v+\varphi(v)\,  \vert \, v\in V\}$. The map $V\rightarrow U$, 
 $$
 v\mapsto \varphi^{-1}(v+\delta(v)), 
 $$
 is sc-smooth and injective.  The subset $\Sigma\subset C$, defined by 
 $$
 \Sigma=\{v+y\in C\, \vert \, v\in V,\ y\in Y\},
 $$
is relatively open in $C$ and contains $0$. Since $O$ is a tame retract,  there exist a relatively open subset $W$ of $C$ and a tame sc-smooth retraction $r\colon W\rightarrow  W$ onto $O=r(W)$. Consequently, in view of 
 $$
 r\colon r^{-1}(\Sigma\cap O)\rightarrow r^{-1}(\Sigma\cap O),
 $$
the subset $\Sigma\cap O$ is also a sc-smooth retract.  


By construction, $v+\delta (v)\in O$ and also $v+\delta (v)\in \Sigma$ and we define the map $t\colon \Sigma\cap O\rightarrow \Sigma\cap O$  by
 $$
 t(v+w)=v+\delta(v).
 $$
The map $t$ is sc-smooth 
 and satisfies $t\circ t=t$, so that  $t$ is a sc-smooth retraction defined on a relatively  open neighborhood of $0$ in $C$ 
 and $t(\Sigma\cap O) = \varphi(M\cap U).$ Therefore, the composition  $s=\varphi^{-1}\circ t\circ\varphi$ defines a sc-smooth retraction
\begin{equation}\label{edi3}
 s\colon U\rightarrow U
 \end{equation}
onto $M\cap U=s(U)$, proving that the subset $M$ is a sc-smooth sub-M-polyfold of $X$.

 The map $u\mapsto C\cap N$, $u\mapsto \pi\circ \varphi (s(u))$ is sc-smooth. Therefore, the map 
 $$M\cap U\to V,\quad m\mapsto \pi\circ \varphi (m)$$
 is a sc-smooth M-polyfold chart on $M$ for the induced M-polyfold structure. The image of the chart is the local model 
 $(V, N\cap C, N)$  so that the transition maps are classically smooth maps and define on $M$  the structure of a manifold with boundary with  corners. The proof of Theorem \ref{HKL} is complete.
 \qed \end{proof}


 As an aside we mention that, in general,  we can not find a local retraction $s$ in \eqref{edi3} which is  tame, as the 
example $X=[0,\infty)^2$ and $M=\{(x,x)\,  \vert , \ x\geq 0\}$ shows.
 
The strength  of the theorem stems  from the fact that in our sc-Fredholm theory the machinery produces subsets $M\subset X$, which have the $n$-dimensional tangent germ property. 
\section{Contraction  Germs}
The notion of a contraction germ is a slight modification of a basic germ. These germs are convenient for the proof of the implicit function theorem (Theorem \ref{newthm5.4}),  which is the main result of this section. It turns out that the local geometry of sc-Fredholm  germs are intimately related to contraction germs. In the generic case they are used to prove that the zero set of a sc-Fredholm section 
must have the n-dimensional tangent germ property. It follows that  the zero set  is  in a natural  way a smooth manifold with boundary with corners.




In the following we abbreviate by $\wt{C}$ the partial quadrant $\wt{C}=[0,\infty)^{k}\oplus \R^{n-k}$ in $\R^n$ so that 
$C=\wt{C}\oplus W$ is a partial quadrant in the sc-Banach space $E=\R^n\oplus W$.


 
\begin{definition}[$\ssc^0$-{\bf contraction germ} ] \label{BG}\index{D- Contraction germs}
A $\ssc^0$-germ 
$$
f\colon {\mathcal O}(C,0)\rightarrow ( W,0)
$$
  is called  a 
$\ssc^0$-{\bf contraction germ} if the following holds.
The germ $ f$
has the form
$$
 f(a,w)=w-B(a,w)
$$
for $(a,w)$ close to $(0,0)\in C$. Moreover, for every $\varepsilon>0$ and $m\geq 0$,  the estimate
$$
\abs{B(a,w)-B(a,w')}_m\leq \varepsilon\cdot \abs{w-w'}_m
$$
holds for all $(a,w),(a,w')$ on level $m$ sufficiently close to $(0, 0)$, depending on $\varepsilon$ and $m$.
\qed
\end{definition}




More precisely, the  $\ssc^0$-contraction germ requires for given $\varepsilon>0$,  that we can choose a perhaps smaller germ ${\mathcal O}(C,0)$ of neighborhoods 
$U_0\supset U_1\supset U_2\supset U_3\supset \ldots $ of the point $(0, 0)$ in $[0,\infty)^k\oplus \R^{n-k}\oplus W$ such that 
$
\abs{B(a,u)-B(a,v)}_m\leq \varepsilon \abs{u-v}_m
$
holds if $(a, u), (a, v)\in U_m$.

Starting on level $0$, 
the  parametrized version of Banach  fixed point theorem together with  $B(0,0)=0$, guarantee the existence of relatively open and connected neighborhood $V=V_0$ of $0$ in $[0,\infty)^k\oplus \R^{n-k}$  and  
a uniquely determined continuous map $\delta\colon V\rightarrow W_0$ satisfying  $\delta(0)=0$ and solving the equation
$$
\delta(a)=B(a,\delta(a))\quad \text{for all $a\in V$}.
$$
Going to level $1$ we find, again using the fixed point theorem, an 
 open neighborhood $V_1\subset V_0$ of $0$  and a continuous map $\delta_1\colon V_1\to W_1$ satisfying $\delta (0)=0$ and solving 
 the equation on level $1$. 
From the uniqueness of the solutions of the Banach fixed point problem we conclude that $\delta_1 =\delta\vert V_1$. Continuing  this way, we obtain a decreasing sequence 
of relatively open neighborhoods of $0$ in $[0,\infty)^{k}\times \R^{n-k}$, 
$$
V=V_0\supset V_1\supset V_2\supset \ldots 
$$
such that the continuous solution $\delta\colon V\to W$  satisfies 
$\delta(0)=0$ and $\delta (V_m)\subset W_m$ and $\delta\colon V_m\to W_m$ is continuous. 
In  other words,  we obtain  a $\ssc^0$-solution germ $\delta\colon {\mathcal O}([0,\infty)^k\oplus \R^{n-k},0)\rightarrow (W,0)$. 


Summarizing  the discussion we have proved the  following theorem from \cite{HWZ3}, Theorem 2.2.

\begin{theorem}[{\bf Existence}]\label{thm5.2}\index{T- Local solution germ}
A $\ssc^0$-contraction germ $f\colon {\mathcal O}(\wt{C}\oplus W,0)\rightarrow (W,0)$ admits a uniquely determined 
sc$^0$-solution germ 
$$
\delta\colon {\mathcal O}(\wt{C},0)\rightarrow (W,0)
$$
solving 
$$
f\circ \gr (\delta)=0.
$$
Here $\gr (\delta)$ is the associated graph germ $a\mapsto(a,\delta(a))$.
\qed
\end{theorem}



Our next aim is the regularity of the unique continuous solution germ $\delta$ of the equation $f(v, \delta (v))=0$ guaranteed by Theorem  \ref{thm5.2}, and we are going to prove that the solution germ $\delta$ is of class $\ssc^k$ if the given germ $f$ is of class $\ssc^k$. 
 By a somewhat tricky induction it turns out that we actually  only have to know that if  $f$ is  $\ssc^1$,  then the solution germ $\delta$ is 
 $\ssc^1$ as well. Here we shall make use of the following regularity result from \cite{HWZ3}, Theorem 2.3, which is the hard part of the regularity theory. 


\begin{theorem}\label{thm5.3}\index{T- Regularity of solution germ}
If the $\ssc^0$-contraction germ $f\colon \mo(\wt{C}\oplus  W,0)\rightarrow (
W,0)$ is of class $\ssc^1$, then the solution germ $\delta\colon \mo(\wt{C},
0)\to (W, 0)$ in Theorem \ref{thm5.2} is also of class  $\ssc^1$. 
\qed
\end{theorem}

Theorem \ref{thm5.3} shows that a $\ssc^0$-contraction germ $f$
of class $\ssc^1$ has a solution germ $\delta$ satisfying $f(v, \delta (v))=0$ which is 
also of class $\ssc^1$. We shall use this to verify by induction that $\delta$ is of class $\ssc^k$ if $f$ is of class $\ssc^k$.
We start with the following lemma. 

\begin{lemma}\label{newlemma5.4}\index{L- Higher regularity of solution germ}
Let $f\colon {\mathcal O}(\wt{C}\oplus W,0)\rightarrow (W,0)$ be 
a $\ssc^0$-contraction germ of class $\ssc^k$ where  $k\geq 1$.
Moreover, we assume that the solution germ $\delta$ is of class $\ssc^j$.
(By Theorem \ref{thm5.3}, $\delta$ is  at least of class $\ssc^1$.)
We define the germ $f^{(1)}$ by
\begin{equation*}
f^{(1)}\colon {\mathcal O}(T\wt{C}\oplus TW,0)\rightarrow TW,
\end{equation*}
\begin{equation}\label{germequation}
\begin{split}
f^{(1)}(v,b,u,w)&=\left(u-B(v,u),w-DB(v,\delta(v))\left(b,w\right)\right)\\
&=(u,w)-B^{(1)}(v,b,u,w),
\end{split}
\end{equation}
where the last line defines the map $B^{(1)}$. Then $f^{(1)}$ is an
$\ssc^0$-contraction germ and of class $\ssc^{\min\{k-1,j\}}$.
\end{lemma}
\begin{proof}
For $v$ small, the map $B^{(1)}$ has the contraction property with
respect to $(u, w)$.
 Indeed,  on the $m$-level of $(TW)_m=W_{m+1}\oplus W_m$, i.e.,
 for $(u, w)\in W_{m+1}\oplus W_m$,  we  estimate for given $\varepsilon>0$ and $v$ sufficiently small,
  \begin{equation*}
\begin{split}
&|B^{(1)}(v,b,u',w')-B^{(1)}(v,b,u,w)|_m\\
&\phantom{===}=|B(v,u')-B(v,u) |_{m+1}\\
&\phantom{=====}+
|DB(v,\delta(v))(b,w')-DB(v,\delta(v))(b,w)| _{m}\\
&\phantom{===}\leq \varepsilon |u'-u|_{m+1} + |D_2B(v,\delta(v))[w'-w] |_m,
\end{split}
\end{equation*}
which, using the estimate $\norm{D_2B(v, \delta (v))}_m\leq \varepsilon$ for the operator norm from Lemma \ref{new_Lemma3.9},  is estimated by
\begin{equation*}
\phantom{===}\leq \varepsilon \cdot \bigl(|
u'-u|_{m+1}+|w'-w|_m\bigr)= \varepsilon \cdot | (u', w')-(u,
w)|_m.
\end{equation*}
Consequently,  the  germ $f^{(1)}$ is an  $\ssc^0$-contraction germ.
If  now $f$ is of class $\ssc^k$ and $\delta$ of class $\ssc^j$,
then the germ $f^{(1)}$ is of class $\ssc^{\min\{k-1,j\}}$, as one
verifies by comparing the tangent map $Tf$ with the map $f^{(1)}$
and using the fact that the solution $\delta$ is of class $\ssc^j$.
By Theorem \ref{thm5.2}, the solution germ $\delta^{(1)}$ of
$f^{(1)}$ is at least of class $\ssc^0$. It solves the equation
\begin{equation}\label{chap5eq9}
f^{(1)}(v,b, \delta^{(1)}(v, b))=0.
\end{equation}
But also the tangent germ $T\delta$,  defined by $T\delta
(v,b)=(\delta (v), D\delta (v)b)$,  is a solution of \eqref{chap5eq9}.
From the uniqueness we conclude  that $\delta^{(1)}=T\delta $.
\qed \end{proof}

To prove higher regularity we will also make use of  the next lemma.
\begin{lemma}\label{newcontrlem}
Assume we are given a $\ssc^0$-contraction germ  $f$ of class
$\text{sc}^k$ and a solution germ $\delta$ of class $\ssc^j$
with $j\leq k$. Then  there exists a $\ssc^0$-contraction germ
$f^{(j)}$ of class $\ssc^{\min\{k-j, 1\}}$ having
$\delta^{(j)}:=T^j\delta$ as the solution  germ.
\end{lemma}
\begin{proof}
We prove the lemma by induction with respect to $j$. If $j=0$ and
$f$ is a $\ssc^0$-contraction germ of class $\ssc^k$, $k\geq 0$,
then we  set $f^{(0)}=f$ and $\delta^{(0)}=\delta$.  Hence the
result holds true if $j=0$. Assuming the result has been proved for
$j$,  we show it is true for $j+1$. Since $j+1\geq 1$ and $k\geq
j+1$,   the map $f^{(1)}$,  defined by \eqref{germequation},  is of
class $\ssc^{\min \{k-1, j+1\}}$ in view of Lemma \ref{newlemma5.4}.
Moreover, the solution germ $\delta^{(1)}=T\delta$  satisfies
$$
f^{(1)}\circ \gr (\delta^{(1)})=0,
$$
and is of class $\ssc^j$.  Since $\min \{k-1, j+1\}\geq j$, by  the
induction hypothesis there exists  a map
${(f^{(1)})}^{(j)}=:f^{(j+1)}$ of regularity class
$\min\{\min\{k-1,j+1\}-j,1\}=\min\{k-(j+1),1\}$ so that
$$
f^{(j+1)}\circ\gr ({(\delta^{(1)})}^{(j)})=0.
$$
Setting  $\delta^{(j+1)}={(\delta^{(1)})}^{(j)}=T^{j}(T\delta
)=T^{j+1}\delta$,   Lemma \ref{newcontrlem} follows.
\qed \end{proof}

The main result of this section is the following germ-implicit functions theorem.

\begin{theorem}[{\bf Germ-Implicit Function Theorem}] \label{newthm5.4}\index{T- Germ implicit function theorem}
If 
$$
f\colon \mo(\wt{C}\oplus {W},0)\to  ({ W},0)
$$
 is  an
$\text{sc}^0$-contraction germ which is, in addition, of class
$\ssc^k$, then the solution germ
$$\delta\colon  \mo(\wt{C},0)\rightarrow ({ W},0)$$
satisfying
$$f(v,\delta (v))=0$$
is also of class $\ssc^k$.
\qed
\end{theorem}


From Theorem \ref{newthm5.4}, using  Proposition \ref{sc_up} and \ref{lower}
and Proposition \ref{save}  we deduce the following properties of the section germ $\delta$ under the additional assumptions, that  $f$ is a sc-smooth germ.



\begin{corollary}\label{new_cor_3.33}\index{C- Classical smoothness properties of solution germs}
If the $\ssc^0$-contraction germ $f$ is a sc-smooth germ, there exists for every $m\geq 0$ and $k\geq 0$ a relatively open neighborhoods $V_{m, k}$ of $0$ in $\wt{C}$ such that 
\begin{itemize}
\item[{\em (1)}\ ]\ $\delta (V_{m, k})\subset W_m$.
\item[{\em (2)}\ ]\ $\delta\colon  V_{m, k}\to W_m$ is of class $C^k$.
\end{itemize}
In particular, the solution germ $\delta$ is sc-smooth at the smooth point $0$.
\qed
\end{corollary}


Theorem \ref{newthm5.4} will be one of the 
building blocks for all future versions of implicit function
theorems,  as well as for the transversality theory.

\begin{proof}[Theorem \ref{newthm5.4}]
Arguing by contradiction we assume that the solution germ $\delta$ is
of class $\text{sc}^j$ for some $j<k$ but not of class $\text{sc}^{j+1}$. In view of Lemma \ref{newcontrlem}, there exists an
$\text{sc}^0$-contraction germ $f^{(j)}$ of class $\text{sc}^{\min
\{k-j, 1\}}$ such  that  $\delta^{(j)}=T^j\delta$ satisfies
$$
f^{(j)}\circ \gr (\delta^{(j)})=0.
$$
Since also $k-j\geq 1$, it follows that $f^{(j)}$ is at least of
class $\text{sc}^1$. Consequently,  the solution germ $\delta^{(j)}$
is at least of class $\ssc^{1}$. Since
$\delta^{(j)}=T^j\delta$, we conclude that $\delta$ is at least of
class $\text{sc}^{j+1}$ contradicting our assumption. The proof of
Theorem \ref{newthm5.4} is complete.
\qed \end{proof}



\begin{remark}\index{R- On the properties of solution germs}\label{hofer-rem}
For  later use we reformulate Corollary \ref{new_cor_3.33} in quantitative terms. If $f$ is a $\ssc^0$-contraction germ which, in addition, is a sc-smooth germ satisfying $f(0)=0$. then the solution germ $\delta$ possesses the following properties of existence, uniqueness, and regularity. 

There exist monotone decreasing sequences  $(\varepsilon_i)$ for $i\geq 0$ and $(\tau_i)$ for $i\geq 0$ such that 
\begin{itemize}
\item[(1)]\ $\delta\colon \{a\in [0,\infty)^k\oplus \R^{n-k}\, \vert \, |a|_0\leq \varepsilon_0\}\rightarrow
\{w\in W\ |\ |w|_0\leq \tau_0\}$
is a continuous solution of $f(a, \delta (a))=0$ satisfying $\delta (0)=0$. 
 \item[(2)]\ If the solution  $f(a,w)=0$ satisfies  $|a|_0\leq \varepsilon_0$ and $|w|_0\leq \tau_0$, then $w=\delta(a)$.
\item[(3)]\ If  $|a|_0\leq \varepsilon_i$, then  $\delta(a)\in W_i$ and $|\delta(a)|_i\leq \tau_i$ for every  $i\geq 0$.
\item[(4)]\ The germ  $\delta\colon \{a\in [0,\infty)^k\oplus \R^{n-k} \, \vert \,  |a|_0\leq \varepsilon_i\}\rightarrow W_i$ is of class $C^i$,  for every $i\geq 0$.
\end{itemize}
\end{remark}


\section{Stability  of Basic Germs}

All the maps considered in the section are sc-smooth maps.  
Let us recall (from Definition \ref{BG-00x}) the notion of  a basic germ.
\begin{definition}[{\bf The basic class $\mathfrak{C}_{basic}$}]\index{D- Basic class}\index{$\mathfrak{C}_{basic}$} Let $W$ be a sc-Banach space.  
A {\bf basic germ} $f\colon {\mathcal O}([0,\infty)^k\oplus\R^{n-k}\oplus W,0)\rightarrow (\R^N\oplus W,0)$
is a sc-smooth germ having the property that the germ $P\circ f$ is a $\ssc^0$-contraction  germ, where 
$P\colon \R^N\oplus W\rightarrow W$ is the sc-projection. 
We denote the class of all basic germs by $\mathfrak{C}_{basic}$. 
\end{definition}
In view of Definition \ref{oi}, the basic germs are the local models for the germs of sc-Fredholm sections.



 \begin{theorem}[{\bf Weak Stability of Basic Germs}]\label{arbarello}\index{T- Weak stability of basic germs}
We consider a basic germ 
$$
f\colon {\mathcal O}(([0,\infty)^k\oplus \R^{n-k})\oplus W,0)\rightarrow (\R^N\oplus W,0), 
$$
which we can view as the principal part of a sc-smooth section of the obvious strong bundle. We assume that
$s$ is the principal part of a $\ssc^+$-section of the same bundle satisfying $s(0)=0$.  Then there exists a strong bundle isomorphism
$$
\Phi\colon U\triangleleft (\R^N\oplus W)\rightarrow U'\triangleleft (\R^{N'}\oplus W'),
$$
where $U$ is an open neighborhood of $0$ in $[0,\infty)^k\oplus \R^{n-k}\oplus W$, and $U'$ is an open neighborhood
of $0$ in $[0,\infty)^k\oplus \R^{n'-k}\oplus W'$, 
covering the sc-diffeomorphism $\varphi\colon (U,0)\rightarrow (V,0)$, 
so that ${(\Phi_\ast(f+s))}^1$ is a basic germ. 
Here ${(\Phi_\ast(f+s))}^1$  is the germ $\Phi_\ast(f+s)\colon {\mathcal O}(V^1,0)\to {\mathcal O}((\R^{N'}\oplus W')^1,0)$, where the levels are raised by $1$.
\end{theorem}

Recalling  the Fredholm index of a basic germ in Proposition \ref{Newprop_3.9}, we conclude that $n-N=n'-N'$, because the Fredholm index is invariant under strong bundle isomorphisms. The integer $k$ is the  degeneracy index $k=d_C(0)$ of the point $0$ which is, in view of Proposition \ref{newprop2.24} and 
Corollary \ref{equality_of_d}, preserved under the sc-diffeomorphism $\varphi$ satisfying $\varphi (0)=0$.
Although Theorem \ref{arbarello}  was not explicitly formulated  in \cite{HWZ3}, it follows from the proof of Theorem 3.9  in \cite{HWZ3}.

\begin{proof}
Denoting by  $P\colon \R^N\oplus W\rightarrow W$ the sc-projection, the  composition $P\circ f$ is, by definition, of  the form
$$
 P\circ f(a,w)=w-B(a,w), 
$$
and has the property that for every $\varepsilon>0$ the estimate $\abs{B(a,w)-B(a,w')}_m\leq \varepsilon\cdot |w-w'|_m$ holds,   if $(a, w)$ and $w'$ are sufficiently small on level $m$.


Linearizing the  $\ssc^+$-section  $s$ with respect to the variable $w\in W$ at the point $0$, we introduce the sc-operator 
$$A:=P\circ D_2s(0)\colon W\to W.$$
Since $s$ is a
$\ssc^+$-section and $0$ is smooth point, the operator $A\colon W\rightarrow W$ is a $\ssc^+$-operator. Therefore,  the operator ${\mathbbm 1}+A\colon  W\to W$ is a  $\ssc^+$-perturbation of the identity and hence a sc-Fredholm operator by Proposition \ref{prop1.21}.  Because $A$ is level wise compact, 
the index $\ind ({\mathbbm 1}+A)$ is equal to $0$. 
The associated sc-decompositions of the sc-Banach space $W$ are the following,
$$
{\mathbbm 1}+A\colon W=C\oplus X\to W=R\oplus Z,
$$
where $C=\text{ker}({\mathbbm 1}+A)$ and $R=\text{range}\ ({\mathbbm 1}+A)$ and
$\text{dim}\ C=\text{dim}\ Z<\infty$.  


Since $s$ is a $\ssc^+$-section, we conclude from Proposition \ref{lower} that the restriction  $s\colon U_m\to \R^N\oplus W_m$ is of class $C^1$, for every 
$m\geq 1$.  
From the identity 
$P\circ s(a, w)=
P\circ D_2 s(0)w+(P\circ s(a, w)-P\circ D_2 s(0)w)$,
one  deduces the following representation for 
$P\circ s$, on every level $m\geq 1$, 
$$
\text{$P\circ s(a,w)=Aw+S(a, w)$\quad  and \quad 
 $D_2S(0,0)=0$}.$$
Therefore,  $S$ is, with respect to the second
variable $w$, a arbitrary small contraction on every level $m\geq 1$, if $a$ and $w$ are sufficiently small  depending 
on the level $m$ and the contraction constant.  
We can make the arguments which follow only on the levels $m\geq 1$. This explains  the reason for the index  raise by $1$ in the theorem.



We can write
\begin{equation*}
\begin{split}
P\circ (f+s)(a, w)&=w-B(a, w)+Aw+S(a, w)\\
&=({\mathbbm 1}+A)w-[ B(a, w)-S(a, w) ]\\
&=({\mathbbm 1}+A)w-\ov{B}(a, w),
\end{split}
\end{equation*}
where we have abbreviated
$$\ov{B}(a, w)=B(a, w)-S(a, w).$$
By assumption,  the map $B$ belongs to the $\ssc^0$-contraction germ and hence the map $\ov{B}$ is a contraction in the second
variable on every level $m\geq 1$ with arbitrary small contraction
constant $\varepsilon>0$ if $a$ and $w$ are sufficiently small
depending on the level $m$ and the contraction constant $\varepsilon$.  Introducing  the canonical projections by
\begin{align*}
P_1&\colon W=C\oplus X\to X\\
P_2&\colon W=R\oplus Z\to R,
\end{align*}
we abbreviate 
\begin{equation*}
\begin{split}
\varphi (a, w)&:=P_2\circ P\circ (f+s)(a,w)\\
&=P_2  [({\mathbbm 1}+A)w-\ov{B}(a, w)]\\
&=P_2[ ({\mathbbm 1}+A)P_1 w- \ov{B}(a, w)].
\end{split}
\end{equation*}
We have used the relation  $({\mathbbm 1}+A)({\mathbbm 1}-P_1)=0$. The operator
$L:=({\mathbbm 1}+A)\vert X\colon X\to R$ is a sc-isomorphism. In view of
$L^{-1}\circ P_2\circ ({\mathbbm 1}+A)P_1w=P_1w$, we obtain the formula
$$
L^{-1}\circ \varphi (a, w)=P_1w-L^{-1}\circ P_2\circ \ov{B}(a, w).$$

\noindent Writing $w=({\mathbbm 1}-P_1)w\oplus P_1w$,  we  shall consider $(a,
({\mathbbm 1}-P_1)w)$ as our  new finite parameter,  and
correspondingly  define the map $\wh{B}$ by
$$
\wh{B}((a, (1-P_1)w),
P_1w)=L^{-1}\circ P_2\circ  \ov{B}(a, ({\mathbbm 1}-P_1)w+P_1w).
$$
Since $\ov{B}(a, w)$ is a contraction in the second variable on every level $m\geq 1$ with arbitrary small contraction constant if $a$ and $w$ are sufficiently small depending on the level $m$ and the contraction constant,  the right hand side of
$$
L^{-1}\circ \varphi (a, ({\mathbbm 1}-P_1)w+P_1w)=P_1w-\wh{B}(a, ({\mathbbm 1}-P_1)w, P_1w)
$$
possesses the required  contraction normal
form with respect to the variable $P_1w$ on all levels $m\geq 1$,
again if $a$ and $w$ are small enough depending on $m$ and the contraction constant.

 It remains
to prove that the above normal form is the result of an admissible
coordinate transformation of the perturbed section $f+s$. Choosing  a
linear isomorphism $\tau \colon Z\to C$, we  define the fiber
transformation $\Psi\colon \R^N\oplus W\to \R^N\oplus X\oplus C$ by
\begin{equation*}
\begin{split}
\Psi (\delta a\oplus \delta w):= \delta a \oplus L^{-1}\circ P_2 \cdot \delta w \oplus  \tau  \circ ({\mathbbm 1}-P_2)\cdot \delta w.
\end{split}
\end{equation*}
We shall view $\Psi$ as a strong bundle map covering the
sc-diffeomorphism $\psi\colon V\oplus W\to V\oplus C\oplus X$ defined by $\psi (a,
w)=(a, (1-P_1)w, P_1w)$ where $V=[0,\infty )^k\oplus \R^{n-k}.$ With
the canonical projection
\begin{gather*}
\ov{P}\colon  (\R^N\oplus C)\oplus X\to X\\
\ov{P}(a\oplus ({\mathbbm 1}-P_1)w\oplus P_1w)=P_1w,
\end{gather*}
and the relation  $\ov{P}\circ \Psi \circ ({\mathbbm 1}-P)=0$,  we obtain the
desired formula
\begin{gather*}
\ov{P}\circ \Psi \circ(f+s)\circ \psi^{-1} (a, ({\mathbbm 1}-P_1)w, P_1w)\\
=P_1w-\wh{B}(a, ({\mathbbm 1}-P_1)w, P_1w).
\end{gather*}
The proof of Theorem \ref{arbarello}  is complete.

\qed \end{proof}


The theorem has the following corollary, where we use the standard notations, denoting, as usual,  by $C$  a partial quadrant in a sc-Banach space $E$.
We also use a second sc-Banach space $F$. 


\begin{corollary}\label{op-perp}\index{C- Weak stability of basic germs}
We assume that the sc-germ  $g\colon {\mathcal O}(C,0)\rightarrow (F,0)$ is equivalent by a strong bundle isomorphism  $\Phi$ to the basic germ $\Phi_\ast g$, and assume that  $s\colon {\mathcal O}(C,0)\rightarrow (F,0)$ is a $\ssc^+$-germ. Then there exists a strong bundle isomorphism $\Psi$ such  that 
 $((\Psi\circ \Phi)_\ast(g+s))^1$ is a basic germ.
\end{corollary}

\begin{proof}
By assumption there exist open neighborhoods $U$ of $0$ in $C$ and $V$ of $0$ in $[0,\infty)^k\oplus \R^{n-k}\oplus W$
and a sc-diffeomorphism $\varphi\colon (U,0)\rightarrow (V,0)$ which is covered by a strong bundle isomorphism
$\Phi\colon U\triangleleft F\rightarrow V\triangleleft(\R^N\oplus W)$ such  that $\Phi_\ast g$ is a basic germ $h$.
Then $t=\Phi_\ast s$ defines a $\ssc^+$-section satisfying  $t(0)=0$. Clearly $\Phi_\ast(g+s)=h+t$,  and applying Theorem \ref{arbarello}, we find a  second strong bundle isomorphism $\Psi$ such  that $(\Psi_\ast(h+t))^1$ is a basic germ.  Taking the composition $\Gamma =\Psi\circ \Phi$, we conclude that 
$\Gamma_\ast (g+s)^1$ is a basic germ.  This completes the proof of Corollary \ref{op-perp}.
\qed \end{proof}


In order to illustrate the corollary, we now consider the sc-smooth germ  
$$
h\colon {\mathcal O}(C,0)\rightarrow F
$$
 for which we know that there exists a $\ssc^+$-germ $s$
satisfying  $s(0)=h(0)$,  and assume that the germ $h-s$ around $0$  is equivalent to the  basic germ $g=\Phi_\ast(h-s)$.
We observe that  $h-h(0)=(h-s) +(s-h(0))$, where  $s-h(0)$ is a $\ssc^+$-section. Then $t=\Phi_\ast(s-h(0))$ is a $\ssc^+$-section and $g+t$ is a perturbation by a $\ssc^+$-section of a basic germ. By the previous corollary we find 
a strong bundle coordinate change such  that $(\Psi_\ast(g-s))^1$ is a basic germ, or in  other words, 
$((\Psi\circ\Phi)_\ast( h-h(0)))^1$ is a basic germ.

Note that for the implicit function theorem it does not matter whether  we work with $f$, or $f^1$, ore even $f^{(501)}$.
It  matters that our coordinate change is compatible with the original sc-structure. 

We also  point out  that a strong bundle coordinate change 
for $h^1$ is not the same as  a strong bundle coordinate change for $h$ followed by a subsequent raise of the index.


\section{Geometry of Basic Germs}
In this section we shall study in detail sc-smooth germs 
\begin{equation}\label{poi1}
f\colon {\mathcal O}(([0,\infty)^k\oplus \R^{n-k})\oplus W,0)\rightarrow (\R^N\oplus W,0)
\end{equation}
around $0$
of the form
\begin{equation}\label{pi2}
f=h+s
\end{equation}
where $h$ is a basic germ and $s$ is a $\ssc^+$-germ satisfying $s(0)=0$. 
We already know from Corollary \ref{Newprop_3.9} that 
$$
Df(0)\colon \R^n\oplus W\to \R^N\oplus W
$$
 is a sc-Fredholm operator of index $\ind Df(0)=n-N$.\par



In the following we abbreviate $E=\R^n\oplus W$,  $C=([0,\infty)^k\oplus \R^{n-k})\oplus W$, and  $F=\R^N\oplus W$  and by  $P\colon \R^N\oplus W\to W$ the sc-projection.

\begin{theorem}[{\bf Local Regularity and Compactness}]\label{save}\index{T- Local regularity and compactness}
Let $U$ be a relatively open neighborhood of $0$ in $C$.  We  assume that $f\colon U\rightarrow F$ is a sc-smooth map satisfying 
$f(0)=0$ and of the form $f=h+s$ where $h$ is a basic germ and $s$ is a  $\ssc^+$-germ  satisfying $s(0)=0$. We denote by $S=\{(a,w)\in U \, \vert \, f(a,w)=0\}$ the solution set of $f$ in $U$.  Then there exists 
a nested sequence 
$$U\supset {\mathcal O}(0)\supset {\mathcal O}(1)\supset {\mathcal O}(2)\supset \ldots $$
of relatively open neighborhoods of $0$ in $C$ on level $0$ such that  for every $m\geq 0$, the closure of $S\cap {\mathcal O}(m)$ in $C\cap E_0=C_0$ is contained in $C\cap E_m=C_m$, i.e., 
$$
\cl_{C_0}(S\cap {\mathcal O}(m))\subset C_m.
$$
\end{theorem}

\begin{remark} \index{R- Comment on solution regularity}
Theorem \ref{save} says, in particular, that 
${\mathcal O}(m)\cap S\subset C_m$ for all $m\geq 0$.  Therefore,  the regularity of solutions $(a, w)$ of the equation $f(a, w)=0$ is the higher, the closer to $0$  they are on the level $0$.  Moreover, the solution set on level $m$ sufficiently close to $0$ on level $0$ has a closure on level $0$, which still belongs to level $m$. 
Moreover, the solution set on level $m$, sufficiently close to $0$ on level $0$, has a closure on level $0$, which belongs to level $m$.
\qed
\end{remark}
\begin{proof}[Proof of Theorem \ref{save}]
We construct the sets ${\mathcal O}(m)$ inductively  by showing that there exists a decreasing sequence $(\tau_m)_{m\geq 0}$ of positive numbers such that the sets 
$$
{\mathcal O}(m)=\{(a, w)\in C\, \vert \, \text{$\abs{a}_0<\tau_m$ and $\abs{w}_0<\tau_m$}\}
$$
have the desired properties. We begin with the construction of ${\mathcal O}(0)$. 

By definition of a basic germ,  the composition $P\circ h$ is of the form 
$$P\circ h(a, w)=w-B(a, w),$$ 
where $B(0, 0)=0$ and $B$ is a contraction in $w$ locally near $(0, 0)$. 
Moreover, $s$ is a $\ssc^+$-germ satisfying $s(0)=0$. 


We choose $\tau_0'>0$ such that the closed set $\{(a, w)\in C\, \vert \, \abs{a}_0\leq  \tau_0',\abs{w}_0\leq \tau_0'\}$ in  $E_0$ is contained in $U$  and such that, in addition, 
\begin{itemize}
\item[$(0_1)$\, ]\ \ \ $\abs{B(a, w)-B(a, w')}_0\leq \dfrac{1}{4}\abs{w-w'}_0$.
\end{itemize}
for all $a$, $w$, and $w'\in W_0$ satisfying $\abs{a}_0\leq \tau_0'$, 
$\abs{w}_0\leq \tau_0'$, and $\abs{w'}_0\leq \tau_0'$.
Using $B(0)=0$ and $s(0)=0$,  we can choose $0<\tau_0<\tau_0'$ such that 
\begin{itemize}
\item[$(0_2)$\, ]\ \ \ $\abs{B(a, 0)}_0\leq \dfrac{1}{4}\tau_0'$ for all 
$\abs{a}_0\leq \tau_0.$
\item[$(0_3)$\, ]\ \ \ $\abs{P\circ s(a, w)}_0\leq \dfrac{1}{4}\tau_0'$ for all 
$\abs{a}_0\leq \tau_0$ and $\abs{w}_0\leq \tau_0$.
\end{itemize}
For these choices of the constants $\tau_0'$ and $\tau_0$, we introduce the closed set 
$$\Sigma_0=\{(a, z)\in C\, \vert \, \abs{a}_0\leq \tau_0,\, \abs{z}_0\leq \tau_0'/4\}, $$ and denote by $\ov{B}_0(\tau_0')\subset W_0$ the  closed ball in $W_0$ centered  at $0$ and having radius $\tau_0'$.
We define the map 
$F_0\colon \Sigma_0\times \ov{B}_0(\tau_0')\to  W_0$  by 
$$F_0(a, z, w)=B(a, w)-z.$$
If $(a, z)\in \Sigma_0$ and $w, w'\in \ov{B}_0(\tau_0')$, we estimate  using $(0_1)$ and $(0_2)$, 
\begin{equation*}
\begin{split}
\abs{F_0(a, z, w)}_0&=\abs{B(a, w)-z}_0\leq \abs{B(a, w)-B(a, 0)}_0+\abs{B(a, 0)}_0+\abs{z}_0\\
&\leq \dfrac{1}{4}\tau_0'+\dfrac{1}{4}\tau_0'+\dfrac{1}{4}\tau_0'=\dfrac{3}{4}\tau_0'<\tau_0',
\end{split}
\end{equation*}
and
\begin{equation*}
\abs{F_0(a, z, w)-F_0(a, z, w')}_0\leq \dfrac{1}{4}\abs{w-w'}_0.
\end{equation*}
Hence $F_0(a, z,\cdot )\colon \ov{B}_0(\tau_0')\to \ov{B}_0(\tau_0')$ is a contraction,  uniform in  $(a, z)\in \Sigma_0$. 
Therefore, by the parametrized version of Banach's  fixed point theorem there exists a unique continuous function 
$\delta_0\colon \Sigma_0\to \ov{B}_0(\tau_0')$ solving the 
equation 
$$\delta_0(a, z)=B(a, \delta_0 (a, z))-z$$ 
for all  $(a, z)\in \Sigma_0$.
Now we define the open neighborhood ${\mathcal O}(0)$ by 
$${\mathcal O}(0)=\{(a, w)\in C\, \vert \, \text{$\abs{a}_0<\tau_0$ and $\abs{w}_0<\tau_0$}\}.$$
Clearly, the set ${\mathcal O}(0)$ satisfies $\text{cl}_{C_0}(S\cap {\mathcal O}(0))\subset C_0$. 
We observe that if $(a, w)\in {\mathcal O}(0)$, then $\abs{P\circ s(a, w)}_0\leq {\tau_0'}/4$ by $(0_3)$ so that $\delta_0(a, P\circ s(a, w))$ is defined. If, in addition, $f(a, w)=0$, then  $P\circ f(a, w)=0$  so that $w=B(a, w)-P\circ s(a, w)$ and we claim that  
\begin{equation}\label{new_number_1}
w=\delta_0(a, P\circ s(a, w))\quad \text{for all $(a, w)\in {\mathcal O}(0)$.}
\end{equation} 
Indeed, since $\delta_0(a, P\circ s(a, w))=B(a, \delta_0(a, P\circ s(a, w)))-P\circ s(a, w)$, we estimate, using $(0_1)$,  
\begin{equation*}
\begin{split}
\abs{w-\delta_0(a, P\circ s(a, w))}_0&=\abs{B(a, w)-B(a, \delta_0(a, P\circ s(a, w)))}_0\\
&\leq 
\dfrac{1}{4}\abs{w-\delta_0(a, P\circ s(a, w))}_0,
\end{split}
\end{equation*}
implying $w=\delta_0(a, P\circ s(a, w))$ as claimed.


We next construct the set ${\mathcal O}(1)\subset {\mathcal O}(0)$.  Since the embedding $W_1\to W_0$ is continuous, there is a constant $c_1>0$ such that 
$\abs{\cdot }_0\leq c_1\abs{\cdot}_1$. With the constant $\tau_0$ defined above, we choose $0<\tau_1'<\min \{\tau_0, \tau_0/c_1\}$ such that the following holds. 
The set $\{(a, w)\in C\, \vert \,\text{$\abs{a}_0\leq \tau_1'$ and $\abs{w}_1\leq \tau_1'$}\}$ is contained in $U$,  and 
\begin{itemize}
\item[$(1_1)$\, ]\ \ \ $\abs{B(a, w)-B(a, w')}_1\leq \dfrac{1}{4}\abs{w-w'}_1$.
\end{itemize}
for all $a$, $w, w'\in W_1$ satisfying $\abs{a}_0\leq \tau_1'$, 
$\abs{w}_1\leq \tau_1'$, and $\abs{w'}_1\leq \tau_1'$.
We choose $0<\tau_1<\tau_1'$ such that 
\begin{itemize}
\item[$(1_2)$\, ]\ \ \ $\abs{B(a, 0)}_1\leq \dfrac{1}{4}\tau_1'$ for all 
$\abs{a}_0\leq \tau_1$
\item[$(1_3)$\, ]\  \ \ $\abs{P\circ s(a, w)}_1\leq \dfrac{1}{4}\tau_1'$ for all 
$\abs{a}_0\leq \tau_1$ and $\abs{w}_0\leq \tau_1$.
\end{itemize}
Proceeding as in the construction of ${\mathcal O}(0)$, we introduce the closed set $\Sigma_1$ in $E_1$ by 
$$\Sigma_1=\{(a, z)\in C_1\,\vert \, \abs{a}_0\leq  \tau_1,\, \abs{z}_1\leq \tau_1'/4\}, $$
and abbreviate by $\ov{B}_1(\tau_1')$ the closed ball in $W_1$ having its center at $0$ and radius $\tau_1'$.  We define the map 
$F_1\colon \Sigma_1\times \ov{B}_1(\tau_1')\to W_1$ by 
$F_1(a, z, w)=B(a, w)-z$. By  $(1_1)$ and $(1_3)$, the map 
$F_1\colon \Sigma_1\times \ov{B}_1(\tau_1')\to \ov{B}_1(\tau_1')$ is a contraction, uniform in $(a, z)\in \Sigma_1$. 
Again using the Banach fixed point theorem, we find a unique continuous map
$\delta_1\colon \Sigma_1\to \ov{B}_1(\tau_1')$  solving the equation $\delta_1(a, z)=B(a, \delta_1(a, z))-z$ for all $(a, z)\in \Sigma_1$.  
Now we define the open neighborhood ${\mathcal O}(1)$ as 
$${\mathcal O}(1)=\{(a, w)\in C_0\, \vert \, \abs{a}_0<\tau_1,\, \abs{w}_0< \tau_1\}.$$
By our definition of $\tau_1$ we have $\tau_1\leq \tau_1'<\tau_0$ so that  
${\mathcal O}(1)\subset {\mathcal O}(0)$.

We next claim that 
\begin{equation}\label{delta_0_equals_delta_1}
\delta_0(a, P\circ s(a, w))=\delta_1(a, P\circ s(a, w))\quad \text{for all $(a, w)\in {\mathcal O}(1)$}.
\end{equation}
To verify the claim,  we note that if $(a, w)\in {\mathcal O}(1)$, then, by $(1_3)$,  $\abs{P\circ s(a, w)}_1\leq \tau'_1/4$. Hence $\delta_1(a,  P\circ s(a, w))$ is defined  and its norm  satisfies $\abs{\delta_1(a, P\circ s(a, w))}_1\leq \tau_1'$ because $\delta_1$ takes its values in the ball $\ov{B}_1(\tau_1')$. 
This implies, recalling that $\abs{\cdot}_0\leq c_1\abs{\cdot}_1$ and 
$\tau_1'\leq \tau_0/c_1$,  the estimate
$$\abs{\delta_1(a, P\circ s(a, w))}_0\leq c_1\abs{\delta_1(a, P\circ s(a, w))}_1\leq c_1\tau_1'\leq \tau_0\leq \tau'_0.$$
Therefore, by construction, the map 
$(a, w)\mapsto \delta_1(a, P\circ s(a, w))$ solves the equation $\delta_1(a, P\circ s(a, w))=B(a, \delta_1(a, P\circ s(a, w))-P\circ s(a, w)$ for all $(a, w)\in {\mathcal O}(1)$.  On the other hand, it follows from ${\mathcal O}(1)\subset {\mathcal O}(0)$ and $(0_3)$ that $\abs{P\circ s (a, w)}_0\leq \tau_0'/4$ and hence the map $(a, w)\mapsto \delta_0(a, P\circ s(a, w))$ solves, by construction, the same equation $\delta_0(a, P\circ s(a, w))=B(a, \delta_0(a, P\circ s(a, w))-P\circ s(a, w)$ for all $(a, w)\in {\mathcal O}(1)$. The claim \eqref{delta_0_equals_delta_1} now follows from the uniqueness of the Banach fixed point theorem on the level $0$.

If $(a, w)\in {\mathcal O}(1)$ satisfies, in addition, $f(a, w)=0$, we deduce from \eqref{new_number_1} and 
\eqref{delta_0_equals_delta_1} that 
\begin{equation}\label{w_equals_delta_1}
w=\delta_1(a, P\circ s(a, w))\in W_1\quad \text{for all $(a, w)\in {\mathcal O}(1)$}.
\end{equation}

In order to verify the desired  property of ${\mathcal O}(1)$ we fix 
$(a, w)\in \text{cl}_0(S\cap {\mathcal O}(1))$. Then there exists a sequence  
$(a_n, w_n)\in S\cap {\mathcal O}(1)$ such that $(a_n, w_n)\to (a, w)$ on level $0$. 
From \eqref{w_equals_delta_1} it follows that  $w_n=\delta_1(a_n, P\circ s(a_n, w_n))\in W_1$  for all $n$.   Since $s$ is $\ssc^+$,  we know that $P\circ s(a_n, w_n)\to P\circ s(a, w)$ on level $1$. From the continuity of $\delta_1$ we conclude the convergence 
$w_n=\delta_1(a_n, P\circ s(a_n, w_n))\to \delta_1(a, P\circ s(a, w))=w$ on level $1$.  Consequently, $(a, w)\in C_1$ as desired.

The induction step is now clear and the further details are left to the reader.

\qed \end{proof}

The previous result has a useful corollary.

\begin{corollary}\label{corex1}\index{C- Stability of surjectivity}
We assume that $U$ is a relatively open neighborhood of $0$ in a partial quadrant $C=[0,\infty)^n\oplus W$ in a sc-Banach space $E=\R^n\oplus W$ and let $F=\R^N\oplus W$.  Let $f\colon U\to F$ be a sc-smooth map satisfying $f(0)=0$ and  admitting the decomposition
$f=h+s$ where $h\in \mathfrak{C}_{basic}$ and $s$  is a $\ssc^+$-map satisfying $s(0)=0$. We assume, in addition, that 
$Df(0,0)$ is surjective.  Then there exists a 
 relatively open neighborhood $U'\subset U$ on  level $0$ such that the following holds.
\begin{itemize} 
\item[{\em (1)}]\ If $(a,w)\in U'$ satisfies  $f(a,w)=0$, then $(a,w)$ is on level $1$.
\item[{\em (2)}]\ If $(a,w)\in U'$ and $f(a, w)=0$, then $Df(a,w)\colon E\rightarrow F$ is a surjective Fredholm operator of index $n-N$.
\end{itemize}
\end{corollary}

\begin{proof}
In view of Theorem \ref{save}  we know that if $f(a,w)=0$ and $(a,w)$ is sufficiently close to $(0,0)$ on level $0$, then $(a, w)\in E_1$. Hence the linearization $Df(a,w)$ is a well-defined as a bounded linear operator from $E_0$ to $F_0$. By Proposition \ref{Newprop_3.9}, the linearization $Df(0,0)\colon E\to F$ is a  Fredholm operator whose index is equal to $\ind Df(0)=n-N$. 

By assumption, the Fredholm operator $Df(0,0)\colon E\to F$ is surjective. Denoting by $K$ its kernel, we have the splitting $E=K\oplus N$ and conclude that the restriction $Df(0)\vert N\colon N\to F$ is an isomorphism of 
Banach spaces and hence a Fredholm operator of index $0$. To see this, we observe that 
$$
Df(a, w)\vert N=Df(0, 0)\vert N+(Df(a, w)\vert N-Df(0, 0)\vert N), 
$$
and the  second term is a admissible perturbation which does not affect the Fredholm character nor the index. Indeed, 
\begin{equation*}
\begin{split}
\bigl( Df(a, w)-Df(0, 0)\bigr)(\alpha, \zeta)=D_2B(a, w)\zeta+C(a, w)(\alpha, \zeta),
\end{split}
\end{equation*}
where $C(a, w)\colon E\to F$ is a compact operator, and 
$\norm{D_2B(a, w)}\leq \varepsilon$ for every $\varepsilon>0$ if $(a, w)$ sufficiently small in $E_0$ depending on $\varepsilon$,  in view of 
Lemma \ref{new_Lemma3.9}.



It follows that $Df(a, w)\vert N\colon N\to F$ is a Fredholm operator of index $0$, if $(a, w)\in E_1$ is sufficiently small in $E_0$.
\par

We finally show that $Df(a, w)\vert N\colon N\to F$ is a surjective operator if $(a, w)\in E_1$ solves, in addition, $f(a, w)=0$.
Since the index is equal to $0$, the kernel of $Df(a, w)\vert N$ has the same dimension as the cokernel of $Df(a, w)\vert N$ in $F$. Hence we have to prove that the kernel of $Df(a, w)\vert N$ is equal to $\{0\}$, if $(a, w)\in E$ is close to $(0, 0)$ in $E_0$ and solves $f(a, w)=0$.



Arguing by contradiction we assume that  there exist a sequence $(a_k, w_k)\in C\cap E_1$ satisfying $f(a_k, w_k)=0$ and $\abs{(a_k, w_k)}_0\to 0$ as $k\to \infty$. Moreover, there exists a sequence 
$(\alpha_k, \zeta_k)\in (\R^n\oplus W)\cap N$  satisfying $\abs{(\alpha_k, \zeta_k)}_0=1$ and $Df(a_k, w_k)(\alpha_k, \zeta_k)=0$.  Consequently, 
\begin{equation}\label{eq_surj_1}
 \zeta_k-D_2B(a_k,w_k) \zeta_k = D_1B(a_k,w_k)\alpha_k - PDs(a_k,w_k)(\alpha_k,  \zeta_k).
\end{equation}
Without loss of generality we  may assume that $\alpha_k\rightarrow \alpha$.  In view of the proof of the previous theorem, for large values of $k$, the sequence $(a_k, w_k)$ is bounded on level $2$. Consequently, since the embedding $W_2\to W_1$ is compact, we may assume that $(a_k, w_k)\to (0, 0)$ on level $1$. Therefore, 
$D_1B(a_k,w_k)\alpha_k \rightarrow D_1B(0,0)\alpha$ in $E_0$. 
In addition, since $s$ is a $\ssc^+$-operator, the map $E_1\oplus E_0\to F_1$,  defined  by $(x, h)\mapsto PDs(x)h$,  is continuous. Hence,  there exists $\rho>0$ such that $\abs{PDs(x)h}_1\leq 1$ if $\abs{x}_1\leq \rho$ and $\abs{h}_0\leq \rho$. This implies that there is a constant $c>0$ such that $\abs{PDs(x)h}_1\leq c$ for all $\abs{x}_1\leq \rho$ and $\abs{h}_0\leq 1$.  From this estimate, we conclude that the sequence 
$PDs(a_k,w_k)(\alpha_k, \zeta_k)$ is bounded in $W_1$. Since the embedding $W_1\to W_0$ is compact, we may assume that the sequence $PDs(a_k,w_k)(\alpha_k, \zeta_k)$ converges to some point $w_0$  in $W_0$. Denoting by $z_k$ the right-hand side of \eqref{eq_surj_1}, we have proved that $z_k\to z_0=D_1B(0,0)\alpha-w_0$ in $W_0$.  Choosing $0<\varepsilon<1$ in Lemma \ref{new_Lemma3.9}, the  operators ${\mathbbm 1}-D_2B(a_k, w_k)$ have a bounded inverse for large $k$ and we obtain from \eqref{eq_surj_1} that 
\begin{equation*}
\zeta_k=\bigl({\mathbbm 1}-D_2B(a_k, w_k)\bigr)^{-1}z_k=\sum_{l\geq 0}\bigl(D_2B(a_k, w_k)\bigr)^{l}z_k
\end{equation*}
for large $k$. We claim that the sequence $\zeta_k$ converges to $z_0$ in $W_0$. Indeed, take  $\rho>0$. From $\norm{D_2B(a_k, w_k)}\leq \varepsilon$ for $k$ large and the fact that the sequence  $(z_k)$ is bounded in $W_0$, it follows that there exists $l_0$ such that 
$$\abs{\sum_{l\geq l_0}\bigl(D_2B(a_k, w_k)\bigr)^{l}z_k}_0\leq \rho/2.$$
Hence 
\begin{equation*}
\begin{split}
\abs{\zeta_k-z_0}_0&\leq \abs{z_k-z_0}_0+\sum_{l=1}^{l_0}\abs{\bigl(D_2B(a_k, w_k)\bigr)^{l}z_k}_0+\abs{\sum_{l>l_0}\bigl(D_2B(a_k, w_k)\bigr)^{l}z_k}_0\\
&\leq \abs{z_k-z_0}_0+\sum_{l=1}^{l_0}\abs{\bigl(D_2B(a_k, w_k)\bigr)^{l}z_k}_0+\rho/2.
\end{split}
\end{equation*}
From  $\abs{z_k-z_0}_0\to 0$ and $D_2B(a_k, w_k)z_k\to D_2B(0, 0)z_0=0$, it follows that 
$$
\limsup_{k\to \infty}\abs{\zeta_k-z_0}_0\leq \rho/2
$$
 and,  since $\rho$ was arbitrary,  that $\zeta_k\to z_0$ in $W_0$.
We have proved that $(\alpha_k, \zeta_k)\to (\alpha, z_0)$ in $E_0$.  Hence $(\alpha, z_0)\in N$ and 
$\abs{(\alpha, z_0)}_0=1$. On the other hand,
\begin{equation*}
0=\lim_{k\to \infty}Df(a_k, w_k)(\alpha_k, \zeta_k)=Df(0)(\alpha, z_0).
\end{equation*}
Since $Df(0, 0)\vert N$ is an isomorphism, $(\alpha, z_0)=(0, 0)$, in  contradiction to $\abs{(\alpha, z_0)}_0=1$. The proof of 
Corollary \ref{corex1} is complete.
\qed \end{proof}

In the following theorem we denote, as usual, by $C$ the  partial quadrant $[0,\infty )^k\oplus \R^{n-k}\oplus W$ in the  sc-Banach space $E=\R^n\oplus W$ and by $U$ a relatively open neighborhood of $0$ in $C$. Moreover, $F$ is another sc-Banach space of the form $F=\R^N\oplus W$. 

We consider a sc-smooth germ $f\colon U\to F$ satisfying $f(0)=0$ of the form $f=h+s$ where $h$ is a basic germ and $s$ is a $\ssc^+$-germ satisfying $s(0)=0$.
By Theorem \ref{arbarello} there exists a strong bundle isomorphism 
$$\Phi\colon U\triangleleft (\R^N\oplus W)\to U'\triangleleft (\R^{N'}\oplus W').
$$
where $U'$ is a relatively open neighborhood of $0$ in the partial quadrant $C'=[0,\infty)^k\oplus \R^{n'-k}\oplus W'$, covering the sc-diffeomorphism 
$\varphi\colon (U, 0)\to (U',0)$ such that the section $g=\Phi\circ f\circ \varphi^{-1}$ has the property that $g^1=(\Phi_\ast (h+s))^1\colon (U')^1\to (\R^{N'}\oplus W')^1$ is a basic germ. Clearly, $\varphi \bigl(\{x\in U\, \vert \, f(x)=0\}\bigr) =\{x'\in U'\, \vert \, g(x')=0\}.$

We abbreviate $F'=\R^{N'}\oplus W'$ and denote by $P'$ the sc-projection $P'\colon \R^{N'}\oplus W'\to W'$.
By definition of a basic germ, the composition $P'\circ g^1$ is a $\ssc^0$-contraction germ which is sc-smooth. Therefore, in view of Remark \ref{hofer-rem} applied to the levels $m\geq 1$,
there are monotone decreasing sequences $(\varepsilon_i')$ for $i\geq 1$ and 
$(\tau_i')$ for $i\geq i$ such that, abbreviating by $\ov{B}_i(\tau_i')$ the closed ball $W'_i$ of center $0$ and radius $\tau_i'$, and by $U'_i$ the neighborhood $U_i'=\{a\in [0,\infty )^k\oplus \R^{n'-k}\, \vert \, \abs{a}_0\leq \tau_i'\}$, the following statements (1)-(4) hold. 
\begin{itemize}
\item[(1)]\ There exists a unique continuous map 
$$
\delta\colon U'_1\rightarrow \ov{B}_1(\tau_1') 
$$
  satisfying  $P'\circ g(a,\delta(a))=0$ and $\delta(0)=0$.
\item[(2)]\ If $(a, w)\in U_1'\oplus \ov{B}_1(\tau_1')$ solves the equation $P'\circ g(a,w)=0$, then $w=\delta(a)$.
\item[(3)]\ If $a\in U_i'$, then $\delta (a)\in W_{i}'$ and $|\delta(a)|_{i}\leq \tau_i'$ for every 
$i\geq 1$.
\item[(4)]\ $\delta\colon U_i'\to W_i'$ is of class $C^{i-1}$ for all $i\geq 1$.
\end{itemize}

\begin{lemma}\label{new_lemmat_level_0}
There exists $\varepsilon_0'$ and $\tau_0'$ having the following properties. If $(a', w')$ solves the equation $g(a', w')=0$ and satisfies $\abs{a'}_0\leq \varepsilon'_0$ and $\abs{w'}_0\leq \tau_0'$, then $w'=\delta (a')$.
Moreover, if $\abs{a'}_0\leq \varepsilon'_0$, then $\abs{\delta (a')}_0\leq \tau_0'$.
\end{lemma}


\begin{proof}

The solutions of $f(a)=0$ and $g(x')=0$ are related by the sc-diffeomorphism 
$\varphi$ via $x'=\varphi (x)$. Applying the proof of Theorem \ref{save} to the sc-germ $f=h+s$ we find,  for every $\sigma>0$,  a constant $\tau>0$ such that if $x\in C$ is a solution of $f(x)=0$ satisfying $\abs{x}_1<\tau$, then $\abs{x}_1<\sigma$. Using the continuity of $\varphi$ on the level $1$, we choose now  $\sigma>0$ such that if $\abs{x}_1<\sigma$, then $x'=\varphi (x)=(a', w')$ satisfies $\abs{a'}_0\leq \varepsilon_1'$ and $\abs{w'}_1\leq \tau_1'$. Then we conclude from $\abs{x}_0<\tau$ that $\abs{x}_1<\sigma$. Using the continuity of $\varphi^{-1}$ on level $0$ we next choose the desired constants $\varepsilon_0'$ and $\tau_0'$ such that the estimates $\abs{a'}_0\leq \varepsilon_0'$ and $\abs{w'}_0\leq \tau_0'$ imply that $x=\varphi^{-1}(a, w)$ satisfies $\abs{x}_0<\tau$. Assuming now that  $x'=(a', w')$ is a solution of $g(a', w')=0$ satisfying $\abs{a'}_0<\varepsilon_0'$ and $\abs{w'}_0< \tau_0'$, we conclude that $\abs{\varphi^{-1}(x')}_0<\tau$. It follows that 
$\abs{\varphi^{-1}(x')}_1<\sigma$, which implies $\abs{a'}_0<\varepsilon_1'$ and 
$\abs{w'}_1< \tau_1'$. From property (2) we conclude that $w'=\delta (a')$ proving the first statement of the lemma.

Using that the embedding $W_1\to W_0$ is continuous, we find a constant $c>0$ such that %
$\abs{\delta (a')}_0\leq c\abs{\delta (a')}_1$. Taking $\varepsilon_0'$ and $\tau_0'$ smaller we can achieve that 
 $\abs{\delta (a')}_0\leq \tau_0'$ if $\abs{a'}_0\leq \varepsilon_0'$ and the proof of the lemma is complete.
 
 \qed \end{proof}
 
\begin{theorem}[{\bf Local Germ-Solvability I}]\label{LGS}\index{T- Local germ-solvability {I}}
Assume that  $f\colon U\rightarrow F$ is  a sc-smooth  germ  satisfying $f(0)=0$ and of the form $f=h+s$,  where $h$ is a basic germ 
and $s$ is a $\ssc^+$-section satisfying $s(0)=0$. We assume 
that the linearization $Df(0)\colon E\to F$ is surjective and the  kernel $K=\ker Df(0)$ is in good position to the partial quadrant $C$. 
Let 
$$\Phi\colon U\triangleleft (\R^N\oplus W)\to U'\triangleleft (\R^{N'}\oplus W')$$
be the strong bundle isomorphism covering the sc-diffeomorphism $\varphi\colon (U,0)\rightarrow (U',0)$ guaranteed by Theorem \ref{arbarello}. 
Here $U'$ is a relatively open neighborhood of $0$ 
in the  partial quadrant $C'=[0,\infty )^k\oplus \R^{n'-k}\oplus W'$ sitting in   the sc-Banach space $E'=\R^{n'}\oplus W'$.   

Then, denoting by $g=\Phi_\ast (f)$ the push-forward section, the following holds.
The kernel  $K'=\ker Dg(0)=T\varphi(0)K$  is in good position to the partial quadrant $C'$ and there is a good complement $Y'$  of $K'$ in $E'=K'\oplus Y'$,  and a $C^1$-map $\tau\colon V\rightarrow Y_1'$, defined on the  relatively  open neighborhood $V$ 
of $0$ in $K'\cap C'$  such that 
\begin{itemize}
\item[{\em (1)}]\ $\tau\colon {\mathcal O}(K'\cap C',0)\rightarrow (Y',0)$ is a sc-smooth germ.
\item[{\em (2)}]\ $\tau (0)=0$ and $D\tau(0)=0$.
\item[{\em (3)}]\ After perhaps suitably shrinking $U$ it holds
$$\varphi(\{x\in U\ |\ f(x)=0\}) =
\{x'\in U'\, \vert \, g(x')=0\}=\{y+\tau(y)\,  \vert \,  y\in V\}.
$$
\end{itemize}

\end{theorem}

\begin{proof}
The linearization $Dg(0)\colon \R^{n'}\oplus W'\to \R^{N'}\oplus W'$ is a surjective map because, by assumption, $Df(0)\colon \R^{n}\oplus W\to \R^{N}\oplus W$ is surjective. Moreover, $\ker Dg(0)=T\varphi (0)\ker Df(0)$. In view of Proposition \ref{newprop2.24} and Corollary \ref{equality_of_d} we  have $T\varphi (0)C=C'$.
We also  recall that (above Lemma \ref{new_lemmat_level_0}) we have introduced the sc-projection $P'\colon \R^{N'}\oplus W'\to W'$, the neighborhood $U'_i=\{a\in [0,\infty)^k\oplus \R^{n'-k}\, \vert \, \abs{a}_0\leq \tau'_i\}$ of $0$ in $\R^{n'}$, and the map $\delta\colon U_i'\to W_i'$ satisfying $P'\circ g(a, \delta (a))=0$ and $\delta (a)=0$.

We introduce the map $H\colon U_1'\to \R^{N'}$ by 
$$H(a)=({\mathbbm 1}-P')\circ g(a, \delta (a)).$$
It satisfies $H(0)=0$ since $g(0)=0$.  In the following we need the map $H$ to be of class $C^1$. In view of property (4), the map $H$ restricted to $U_i'$ is of class $C^{i-1}$. Since, by Proposition \ref{lower}, the sc-smooth map $g$ induces a $C^1$-map $g\colon E_{m+1}\to E_m$ for every $m\geq 0$, we shall restrict the domain of $H$ to the set $U'_3$. In order to prove the theorem we shall first relate the solution set $\{H=0\}$ to the solution set $\{g=0\}$, and start with the following lemma.

\begin{lemma}\label{new_lemma_relation}
The linear map $\alpha \mapsto (\alpha , D\delta (0)\alpha)$ from $\R^{n'}$ into $E'$ induces a linear isomorphism 
$$\wt{K}:=\ker DH(0)\to \ker Dg(0)=:K'.$$
\end{lemma}

\begin{proof}[Proof of the lemma]
We first claim that  
$$\ker Dg(0)=\{(\alpha ,D\delta (0)\alpha)\, \vert \, \alpha \in \ker DH(0)\}.$$  Indeed, if $(\alpha, \zeta)\in \ker Dg(0)$, then  $P'\circ Dg(0)(\alpha, \zeta)=0$ and  $({\mathbbm 1}-P')\circ Dg(0)(\alpha, \zeta)=0$. By assumption, $P'\circ g(a, w)=w-B(a, w)$. Hence,   differentiating at the point $0$ in the direction of $(\alpha, \zeta)$ and  recalling from Lemma \ref{new_Lemma3.9} that $D_2B(0)=0$, we obtain 
$$0=P'\circ Dg(0)(\alpha, \zeta)= \zeta-D_1B(0)\alpha-D_2B(0)\zeta= \zeta-D_1B(0)\alpha.$$
 On the other hand, differentiating  the identity $P'\circ g(a, \delta (a))=0$ at $a=0$ and evaluating the derivative at $\alpha$, we find,  in view of previous equation,  
$$0=P'\circ g(0)(\alpha, D\delta (0)\alpha)=D\delta (0)\alpha-D_1B(0)\alpha.$$
Consequently,  $\zeta=D\delta (0)\alpha$ as claimed.

From  
$$DH(0)\alpha =({\mathbbm 1}-P')\circ Dg(0)(\alpha , D\delta (0)\alpha )$$
 it follows, if $\alpha \in \ker DH(0)$, in view of 
 $P'\circ Dg(0)(\alpha ,D\delta (0)\alpha)=0$ for all $\alpha$, that 
 $(\alpha, D\delta (0)\alpha)\in \ker Dg(0)$.
 
Conversely, if $(\alpha, \zeta)\in \ker Dg(0)$, then $0=P'\circ Dg(0)(\alpha, \zeta)=
\zeta-D_1B(0)\alpha$ and $({\mathbbm 1}-P')\circ Dg(0)(\alpha, \zeta)=0$. Since 
$P'\circ Dg(0)(\alpha, D\delta (0)\alpha)=0$, we conclude that $\zeta=D\delta (0)\alpha$ and hence $({\mathbbm 1}-P')\circ Dg(0)(\alpha, D\delta (0)\alpha)=DH(0)\alpha=0$, so that $\alpha \in \ker DH(0)$. The proof of 
Lemma \ref{new_lemma_relation} is complete.

\qed \end{proof}


By assumption, the kernel  $K=\ker Df(0)$ is in good position to the partial quadrant $C$. We recall that this requires  that 
$K\cap C$ has a nonempty interior in $K$ and there exists a complement of $K$, denoted by $K^\perp$, so that $K\oplus K^\perp=E$, having the following property. There exists 
$\varepsilon>0$ such that 
if $k+k^\perp\in K\oplus K^\perp$  satisfies  $\abs{k^\perp}_0\leq \varepsilon\abs{k}_0$, then 
\begin{equation}\label{eq_good_position}
\text{$k+k^\perp\in C$ \quad if and only if \quad $k\in C$}.
\end{equation}

The kernel $K'=\ker Dg(0)=T\varphi (0)K$ has a complement in $E'$,  denoted by $(K')^\perp=T\varphi (0)(K^\perp),$ so that 
$K'\oplus (K')^\perp =E'$.
\begin{lemma} 
The complement $(K')^\perp$ is a good complement of $K'$ in $E'$. 
\end{lemma}
\begin{proof}
Since $T\varphi (0)\colon \R^n\oplus W\to \R^{n'}\oplus W'$ is a topological isomorphism, $T\varphi (0)C=C'$ and $K'=T\varphi (0)K$, it follows that $K'\cap C'$ has a nonempty interior in $K'$. Next we choose 
$\varepsilon'>0$ satisfying $\varepsilon'\norm{T\varphi (0)}\norm{(T\varphi (0))^{-1}}\leq \varepsilon$ and take 
$x'\in K'$ and $y'\in (K')^\perp$ satisfying $\abs{y'}_0\leq \varepsilon'\abs{x'}_0$. 
If  $x=(T\varphi (0))^{-1}x'$ and $y=(T\varphi (0))^{-1}y'$, then
\begin{equation*}
\begin{split}
\abs{y}_0&
=\abs{(T\varphi (0))^{-1}y'}_0\leq \norm{(T\varphi (0))^{-1}}\abs{y'}_0\leq \varepsilon' \norm{(T\varphi (0))^{-1}}\abs{x'}_0\\
&=\varepsilon' \norm{(T\varphi (0))^{-1}}\abs{T\varphi (0)}_0\leq 
\varepsilon' \norm{(T\varphi (0))^{-1}}\norm{T\varphi (0)}\abs{x}_0\leq \varepsilon\abs{x}_0.
\end{split}
\end{equation*}
By \eqref{eq_good_position}, $x+y\in C$ if and only if $x\in C$ and since  $T\varphi (0)C=C'$,  we conclude that $x'+y'\in C'$ if and only if $x'\in C'$.  
\qed \end{proof}
The next lemma is proved in Appendix \ref{pretzel-B}.
\begin{lemma}\label{new_lemma_Z}
The kernel  $\wt{K}:=\ker DH(0)\subset \R^{n'}$ of the linearization $DH(0)$ is in good position to the partial quadrant $\wt{C}=[0,\infty)^{k}\oplus \R^{n'-k}$ in $\R^{n'}$. Moreover, there exists a good complement $Z$ of $\wt{K}$ in $\R^{n'}$, hence 
$\wt{K}\oplus Z =\R^{n'}$, having the property that $Z\oplus W'$ is a good complement of $K'=\ker Dg(0)$ in $E'$, 
$$E'=K'\oplus ( Z\oplus W').$$
\qed
\end{lemma}
 In view of  Lemma \ref{new_lemma_Z},  Theorem \ref{help-you} in Appendix \ref{implicit_finite_partial_quadrants} is applicable to the $C^1$-map $H\colon U_2'\to \R^{N'}$,  where 
$U_2'=\{a\in [0,\infty )^k\oplus \R^{n'-k}\, \vert \, \abs{a}_0<\tau_2'\}\subset \R^{n'}$ is introduced before the statement of Theorem \ref{LGS}. According to Theorem 
\ref{help-you}  there exists a relatively open neighborhood $\wt{V}$ of $0$ in $\wt{K}\cap \wt{C}$ and a $C^1$-map 
$$\sigma\colon \wt{V}\to Z$$
satisfying $\sigma(0)=0$ and $D\sigma(0)=0$ and solving the equation  
$$
\text{$H(a+\sigma(a))=0$ for all $a\in \wt{V}$.}
$$   
The situation is illustrated in the following Figure \ref{fig:pict5}.
\begin{figure}[htb]
\begin{centering}
\def\svgwidth{60ex}
\input{pict5.pdf_tex}
\caption{}\label{fig:pict5}
\end{centering}
\end{figure}
Since $H$ is the more regular the closer we are  to $0$,  the map  $\tau$ has the same property.   Recalling the solution germ 
$\delta\colon U_1'\subset \R^{n'}\to \ov{B}_1' \subset W_1'$ of 
$g(a, \delta (a))=0$, we define the map
$\gamma\colon \wt{V}\rightarrow Z\oplus W'_1$ by 
$$\gamma (a)=\sigma(a)+\delta(a+\sigma(a)),\quad v\in \wt{V}.
$$
By the properties of $\sigma$ and $\delta$ 
there exists a nested sequence $\wt{V}_1\supset \wt{V}_2\supset \ldots $ of relatively open neighborhoods of $0$ in $\wt{K}\cap \wt{C}$ such that the restriction
$$
\gamma \vert \wt{V}_i\colon \wt{V}_i\to Z\oplus W_i'
$$
is of class $C^i$,  for every $i\geq 1$.  Recalling from Lemma 
\ref{new_lemma_relation} that $K'=\ker Dg(0)=\{(v, D\delta (0)v)\, \vert \, v\in \wt{K}\}$, we denote by $\pi\colon K'\to\wt{K}$
the projection
$$\pi\colon (v, D\delta (0)v)\mapsto v.$$
The map $\pi$  is a sc-isomorphism. 

We next introduce the map $\tau$ from a relatively open neighborhood of $0$ in $K'\cap C'$ into $Z\oplus W'$ by 
$$\tau (y)=-D\delta (0)\circ \pi (y)+\gamma (\pi (y)),\quad y\in K'\cap C'.$$
It satisfies $\tau (0)=0$. Differentiating $\tau$  at $y=0$, and using  $D\sigma(0)=0$, we obtain
$$
D\tau(0)\eta =-D\delta(0)\circ \pi ( \eta)+D\delta(0)\circ \pi ( \eta)=0
$$
for all $\eta\in K'$ and hence $D\tau (0)=0$. 
Recalling that $y=(v, D\delta (0)v)$ where $v\in \ker DH(0)$, and $\pi (y)=v$, we  compute 
\begin{equation*}
\begin{split}
y+ \tau (y)&=(v +D\delta(0)v) +(-D\delta(0)v+\gamma (v))\\
&=v+\gamma (v)=(v+\sigma (v))+\delta (v+\sigma (v)),
\end{split}
\end{equation*}
where $v+\sigma (v)\in \R^{n'}$. Hence, by definition of the solution germ $\delta$ we conclude from Lemma \ref{new_lemmat_level_0} that 
$$g(y+\tau (y))=0$$
for all $y\in K'\cap C'$ near $0$ on level $0$. By construction, the map $\tau$ is a sc-smooth germ satisfying $\tau (0)=0$ and $D\tau (0)=0$ and there exists a nested sequence of relatively open subsets $\wt{O}_i=\pi^{-1} (V_i)$ of $0$ in $K'$, where 
$O_i=\{a\in [0,\infty)^k\oplus\R^{n'-k}\ |\ |a|_0<\varepsilon_i'\}$
such that the restrictions satisfy 
$$\tau\vert \wt{O}_i\in C^{i}(\wt{O}_i,Z\oplus W_{i}'),\quad \text{for $ i\geq 1$}.$$
Moreover, if $g(y+w)=0$ for $y\in K'\cap C'$ and $w\in Z\oplus W'$ sufficiently small on level $0$, then $w=\tau (y)$.
To sum up, there exists a relatively open subset $U$ of $0$ in $C$ diffeomorphic to  the relatively open subset $U'=\varphi (U)$ of $0$ in $C'$, and a relatively open subset $V$ of $0$ in $K'\cap C'$ such that  
$$
\varphi \bigl(\{x\in U\  |\ f(x)=0\}\bigr) =\{x'\in U'\, \vert \, g(x')=0\}=\{y+\tau(y)\, \vert \, y\in V\}.
$$
The proof of Theorem \ref{LGS} is finished.

\qed \end{proof}



\begin{corollary}\label{LGS2}\index{C- Germ-solvability {II}}
Let  $f\colon U\rightarrow F$ be  a sc-smooth  germ  satisfying $f(0)=0$ and of the form $f=h+s$,  where $h$ is a basic germ 
and $s$ is a $\ssc^+$-section satisfying $s(0)=0$. We assume 
that the linearization $Df(0)\colon E\to F$ is surjective and the  kernel $K=\ker Df(0)$ is in good position to the partial quadrant 
$C\subset E$. 

Then there exists a good complement $Y$ of $K$ in $E$, so that $K\oplus Y=E$, and  there exists a $C^1$-map 
$\sigma\colon V\rightarrow Y_1$ defined on relatively open neighborhood $V$ of $0$ in $K\cap C$, having the following properties.  
\begin{itemize}
\item[{\em (1)}]\ $\sigma\colon {\mathcal O}(K\cap C,0)\rightarrow (Y,0)$ is a sc-smooth germ.
\item[{\em (2)}]\ $\sigma (0)=0$ and $D\sigma(0)=0$.
\item[{\em (3)}]\ 
$\{x\in U\, \vert \, f(x)=0\} =\{v+\sigma(v)\, \vert \, v\in V\}$ after perhaps replacing $U$ by a smaller open neighborhood.
\end{itemize}

\end{corollary}
\begin{proof}

In view of  Theorem \ref{LGS}, the sc-diffeomorphism $\varphi\colon (U, 0)\to (U', 0)$ between  relatively open subsets $U$ and $U'$ of the partial quadrants $C=[0,\infty)^k\oplus \R^{n-k}\oplus W$ and 
$C'=[0,\infty)^k\oplus \R^{n'-k}\oplus W'$ satisfies 
$T\varphi (0)K=K'=\ker Dg(0)$ and $K'$ is in good position to $C'$.   If $Y'$ is the  good sc-complement in Theorem \ref{LGS} of $K'$ in $E'$, we define $Y=T\varphi(0)^{-1}(Y')$. Then $Y$  is the desired good complemement of $K$ in $E$ with respect to the partial quadrant $C$, so that $E=K\oplus Y$. Let $\pi\colon K\oplus Y\to K$ be the sc-projection. 


Recalling  the map $\tau\colon V\subset K'\cap C'\to Y_1'$ from Theorem \ref{LGS},  we define the map 
$\psi\colon V\subset K'\cap C'\rightarrow K$  by 
$$\psi (v)=\pi\circ\varphi^{-1}(v+\tau(v)).$$
The map $\psi$ satisfies  $\psi (0)=0$ and its derivative $D\psi (0)\colon K'\to K$  is equal to 
$D\psi (0)=T\varphi(0)^{-1}\vert K'$, hence it is an isomorphism. 

We claim that the map $\psi$ preserves the degeneracy index, that is 
\begin{equation}\label{index_preserving}
d_{K'\cap C'}(v)=d_{K\cap C}(\psi (v))
\end{equation}
for $v\in V$ close to $0$.  To see this we first assume that $v\in V\subset K'\cap C'$ belongs to $K'\cap (\R^{n'-k}\oplus W')$ where $\R^{n'-k}\oplus W'$ is identified with $\{0\}^k\oplus \R^{n'-k}\oplus W'.$ Hence $v$ is of the form $v=(0, w)\in \{0\}^k\oplus \R^{n'-k}\oplus W'$. 

If $K'$ is one-dimensional, then, in view of Lemma \ref{ll1},  $v=t(a, w')\in \R^{k}\oplus \R^{n'-k}\oplus W'$ where $a=(a_1,\ldots ,a_k)$ satisfies $a_j>0$. Consequently, $t=0$, so that $v=0$. 
Since $\psi (0)=0$,  we have $d_{C'\cap K'}(0)=d_{C\cap K}(\psi (0))$.

If $\dim K'\geq 2$, then,  denoting by $\wt{K'}$ the algebraic complement of $K\cap (\R^{n'-k}\oplus W')$ in $K'$,  we may assume, after linear change of coordinates, that the following holds. 
\begin{itemize}
\item[(a)]\ The finite dimensional subspace $\wt{K}'$ is spanned by the vectors $e'_j=(a'_j, b'_j,  w'_j)$ for $1\leq j\leq m=\dim \wt{K}'$ in which $a_j'$ are the vectors of the standard basis of $\R^{l}$, $b_j'=(b_{j, m+1}',\ldots, b_{j,k}')$ with $b_{j,i}'>0$, and $w_j'\in \R^{n'-k}\oplus W'.$
\item[(b)]\ The good complement $Y'$ of $K'$ in $E'=\R^{n'}\oplus W'$ is contained in $\{0\}^l\oplus \R^{k-l}\oplus \R^{n'-k}\oplus W'$.
\end{itemize}
By adding a basis $e_j'=(0, w_j')\in \{0\}^k\oplus \R^{n'-k}\oplus W'$,  $m+1\leq j\leq \dim K'$,  of $K'\cap (\R^{n'-k}\oplus W')$ we obtain a basis of $K'$. 


We have a similar statement for  the subspace $K$ with the algebraic complement $\wt{K}$ of $K\cap (\R^{n-k}\oplus W)$ in $K$, $e'_j$ replaced by $e_j$, and the good complement $Y$ of $K$ contained in $\{0\}^m\oplus \R^{k-m}\oplus \R^{n-k}\oplus W$.

Now if $v=(0, w_1')\in \{0\}^k\oplus \R^{n'-k}\oplus W'$, then, in view of (a), $d_{K'\cap C'}(v)=m=\dim \wt{K}'$.  
Recalling $K'$ is in good position to the partial quadrant $C'$ and $Y'$ is a good complement of $K'$ in $E'$. there exists a constant $\gamma$  such that if $n\in K'$ and $y\in Y'$, then $\abs{y}_0\leq \gamma\abs{n}_0$ implies that $n+y\in C$ if and only if $n\in C$.  It follows from $\tau (0)=0$ and $D\tau (0)=0$ that 
$\abs{\tau (v)}_0\leq \gamma\abs{v}_0$ and,  since $v\in C$,  we conclude that $v\pm \tau (v)\in C$. Since 
for $v$ as above $v_j=0$ for all $1\leq j\leq k$, we find that also $\tau_j (v)=0$ for all $1\leq j\leq k$. Hence 
$v+\tau (v)=(0, w_2')\in \{0\}^k\oplus \R^{n'-k}\oplus W'$.  Because   the map $\varphi$ is a sc-diffeomorphism, $\varphi^{-1}(v+\tau (v))=\varphi^{-1}((0, w_2'))=(0, w)\in  \{0\}^k\oplus \R^{n-k}\oplus W$.

We shall show that $\pi ((0, w))\in K\cap C$ and that 
$d_{K\cap C}(\pi ((0, w))=m$. We decompose $(0, w)$ according to the direct sum  $E=K\oplus Y$ as 
$(0, w)=k+y$ where $k\in K$ and $y\in Y$, and write 
$k=(\alpha_1, \ldots , \alpha_k, w_1)\in \R^k\oplus \R^{n-k}\oplus W$, $y=(y_1,\ldots , y_k, w_2)\in Y$. Then,   using 
$Y\subset \{0\}^m\oplus \R^{k-m}\oplus \R^{n-k}\oplus W$, we find that  $y_1=\ldots y_m=0$. This implies that 
also $\alpha_1=\ldots =\alpha_m=0$. Consequently, $\pi ((0, w))=k=(0, w_1)\in K\cap C$ and 
$d_{K\cap C}(\pi ((0, w))=m$. We have proved the identity 
\eqref{index_preserving} in the case $v\in K'\cap  (\R^{n'-k}\oplus W')$.


In the case $v=(a, w)\in K\cap C\setminus K\cap  (\R^{n-k}\oplus W)$, we use  Lemma \ref{big-pretzel_1a} and  compute  
$$
d_{C\cap K}(\psi(v))=d_C(\varphi^{-1}(v+\tau(v)))=d_{C'}(v+\tau(v))=d_{C'\cap K'}(v).
$$
Hence $\psi\colon V\rightarrow C$ is a $C^1$-map  satisfying 
$\psi (0)=0$, $D\psi (0)(K'\cap C')=K\cap C$, and preserving  the degeneracy index. Consequently, 
applying  the inverse function theorem for partial quadrants in $\R^n$,  Theorem \ref{QIFT},  to the map $D\psi (0)^{-1}\circ \psi$,  we find relatively open neighborhoods $V_0\subset V$ and $V_1\subset C$ of $0$ such that 
$$
\psi \colon V_0\rightarrow V_1
$$
is a $C^1$-diffeomorphism, which has higher and higher differentiability closer and closer to $0$. Considering the map
$$
w\mapsto  \varphi^{-1}(\psi^{-1}(w)+\tau\circ\psi^{-1}(w)), \quad w\in V_1,
$$
we obtain   $\pi\circ  \varphi^{-1}(\psi^{-1}(w)+\tau\circ\psi ^{-1}(w)) =w$,  and define the map $\sigma\colon V_1\to Y$ by 
$$
\sigma(w)=\varphi^{-1}\bigl(\psi^{-1}(w)+\tau\circ\psi^{-1}(w)\bigr)-w =({\mathbbm 1}-\pi)\varphi^{-1}\bigl(\psi^{-1}(w)+\tau\circ\psi^{-1}(w)\bigr).
$$
Finally,   we can now choose  open neighborhoods $V\subset K\cap C$ of $0$ and $U$ of $0$ in $C$ appropriately 
and see that the map $\sigma$ has the desired properties (1)-(3) of Corollary \ref{LGS2}

\qed \end{proof}

\mbox{}
\section{Implicit Function Theorems}\label{ssec3.4}

Let us  recall from Definition \ref{x-filling}
 the concept  of a filled version.
\begin{definition}[{\bf Filling}]\index{D- Filling}
We consider a  strong local bundle $K\to O$, where $K=R(U\triangleleft F)$, and  let  the set $U\subset C\subset E$ be  a relatively open neighborhood  of $0$ in the partial quadrant $C$ of the  sc-Banach space $E$.  Here  $F$ is a sc-Banach space and $R$ is a strong bundle retraction of the form 
$$R(u, h)=(r(u), \rho(u)(h))$$
covering the tame retraction $r\colon U\to U$ onto $O=r(U)$. We  assume that $r(0)=0$.

A sc-smooth section germ 
$(f, 0)$ of the
strong bundle $K\to O$ possesses a  {\bf filling}
if there exists a sc-smooth section germ $(g, 0)$ of the bundle $U\triangleleft F\to U$ satisfying the following properties.
\begin{itemize}
\item[(1)]\ $f(x)=g(x)$  for $x\in O$ close to $0$
\item[(2)]\ If $g(y)=\rho (r(y))g(y)$ for a point $y\in U$ near $0$, then $y\in O$.
\item[(3)]\ The linearisation of the map
$
y\mapsto  [{\mathbbm 1} -\rho(r(y))]\cdot g(y)
$
at the point $0$, restricted to $\ker(Dr(0))$, defines a topological linear  isomorphism
$$
\ker(Dr(0))\rightarrow \ker(\rho (0)).
$$
\end{itemize}
\qed
\end{definition}


\begin{remark}
By replacing $O$ by a smaller set, we may assume in (1) that $f(x)=g(x)$ for all $x\in O$ and in (2) that 
$g(y)=\rho(r(y))g(y)$ for $y\in U$ implies that $y\in O$.
\qed
\end{remark}


We also  recall the notions  sc-Fredholm germ and sc-Fredholm section.

\begin{definition}[{\bf Sc-Fredholm germ}]\index{D- Sc-Fredholm germ}
Let $f$ be a sc-smooth section of the 
strong bundle 
$P\colon Y\to X$ and let $x\in X$ be a smooth point. 
Then $(f, x)$ is a {\bf sc-Fredholm germ}, if there exists a strong bundle chart around $x$ (as defined in 
Definition \ref{def_strong_bundle_chart})
$$\text{$\Phi\colon \Phi^{-1}(V)\to K$ covering $\varphi \colon (V, x)\to (O, 0)$,}$$
where $K\to O$ is a %
strong local bundle containing $0\in O\subset U$, such that the local section germ $\Phi\circ f\circ \varphi^{-1}\colon O\to K$ has a filling $g\colon U\to U\triangleleft F$ near $0$ which possesses the following additional property. There exists a local $\ssc^+$-section $s\colon U\to U\triangleleft F$ satisfying $s(0)=g(0)$ such that $g-s$ is conjugated near $0$ to a basic germ.

\end{definition}
\begin{definition}[{\bf sc-Fredholm section}]\label{def_again_fedholm_sect}
A sc-smooth section $f$ of the 
strong bundle $P\colon Y\to X$ is a {\bf sc-Fredholm section}, if 
\begin{itemize}
\item[(1)]\ $f$ is regularizing, i.e., if $x\in X_m$ and $f(x)\in Y_{m, m+1}$, then $x\in X_{m+1}$.
\item[(2)]\ The germ $(f, x)$ is a sc-Fredholm germ at every smooth point $x\in X$.
\end{itemize}
\qed
\end{definition}
From Theorem \ref{stabxx} we know that sc-Fredholm sections are stable under  
$\ssc^+$-perturbations; if $f$ is a sc-Fredholm section, then $f+s$ is also a sc-Fredholm section, for every $\ssc^+$-section $s$.
\begin{proposition}\label{prop3_52}
Let $x\in X$ be a solution of $f(x)=0$, where  $f$ is a sc-Fredholm section of the
strong bundle $P\colon Y\to X$.  Then $Tf(x)\colon T_xX\to Y_x$  is a sc-Fredholm operator.
\end{proposition}
\begin{proof}
Since $(f, x)$ is a sc-Fredholm germ, there exists a
strong bundle chart $\Phi\colon \Phi^{-1}(V)\to K$ around $x$ such that the section $\wt{f}=\Phi\circ f\circ \varphi^{-1}\colon O\to K$ has a filling $g\colon U\to U\triangleleft F$ for which there exists a $\ssc^+$-section $s\colon U\to U\triangleleft F$ satisfying $s(0)=g(0)$ such that $g-s$  is conjugated near $0$ to a basic germ. Hence, by Proposition \ref{Newprop_3.9}, the linearization $D(g-s)(0)\colon E\to F$ is a sc-Fredholm operator. Since $Ds(0)$ is a $\ssc^+$-operator,  the linearization $Dg(0)$ is sc-Fredholm operator,  in view of Proposition \ref{prop1.21}. From Proposition \ref{filler_new_1} (2) about fillers it follows that $T\wt{f}(0)\colon T_0O\to K_0$ is a sc-Fredholm operator of index 
$\ind (T\wt{f}(0))=\ind (Dg(0))=\ind (D(g-s)(0))$,  and the proposition follows.
\qed \end{proof}
We now  focus on the solution set $\{f=0\}$ of a sc-Fredholm section near a point $x\in X$ of  $f(x)=0$. In the case of a boundary,  i.e., $d_X(x)\geq 1$,  we require that $P:Y\rightarrow X$ is a strong bundle over a tame M-polyfold and that $\ker f'(x)$ is in good position to the partial quadrant $C_xX$
in the tangent space $T_xX$, see 
Definition  \ref{reduced_cone_tangent}, Theorem \ref{hofer}, and Remark \ref{tamecone}. From this it follows that in the case that $X$ 
is tame the partial cones $C_x$ are, in fact, partial quadrants.
\begin{definition}[{\bf Good position of a sc-Fredholm  germ}]\label{new_good_position_def}\index{D- Good position}
A sc-Fred\-holm germ $(f, x)$ of a tame strong bundle
$Y\rightarrow X$  satisfying $f(x)=0$ is in {\bf good position},   if 
\begin{itemize}
\item[(1)]\ $f'(x)\colon T_xX\rightarrow Y_x$ is surjective.
\item[(2)]\  If $d_X(x)\geq 1$,  then  $\ker (f'(x))\subset T_xX$ is in good position to the partial quadrant  $C_xX$ in the tangent space $T_xX$.
\end{itemize}
\qed
\end{definition}
\begin{remark}\index{R- Remark on good position}
Good position at points $x\in X\setminus\partial X$ satisfying $f(x)=0$ just means that $f'(x):T_xX\rightarrow Y_x$ is surjective
and does not require the tameness of $X$, which is an assumption about the boundary geometry of $X$.
In case $x\in\partial X$ we require in addition that $\ker(f'(x))$  is in good position to the partial quadrant $C_x$.
It would be sufficient to assume that $X$ is only tame on a neighborhood of the points $x\in \partial X$ satisfying $f(x)=0$.
We also should remark that it seems possible to have implicit function theorems when $X$ is not tame, but that would require
a detailed analysis of the boundary structure of $X$ and the local geometry of $(f,x)$.
\end{remark}
The fundamental implicit function theorem is as follows.

\begin{theorem}\label{IMPLICIT0}\index{T- Implicit function theorem}
Let $f$ be a sc-Fredholm section  of a tame strong bundle
$Y\rightarrow X$. If $f(x)=0$, and if the sc-Fredholm germ $(f, x)$ is in good position, then there exists an open neighborhood $V$ of $x\in X$ such that  
the solution set $S=\{y\in V\, \vert \, f(y)=0\}$ in $V$ has the following properties.
\begin{itemize}
\item[{\em(1)}]\ At  every point $y\in S$, the sc-Fredholm germ  $(f,y)$ is in good position.
\item[{\em(2)}]\ $S$ is a sub-M-polyfold of $X$ and  the induced  M-polyfold 
structure is equivalent to a smooth manifold structure with boundary with corners. 
\end{itemize}
\end{theorem}
The requirement that $(f,x)$ is in good position, where $f(x)=0$,  means in particular that $f'(x)$ is surjective.
We note that Theorem \ref{implicit-x} and Theorem \ref{bound} are immediate consequences of Theorem  \ref{IMPLICIT0}.

\begin{proof}[{\bf Proof of Theorem \ref{IMPLICIT0}}]
The sc-smooth sc-Fredhom section $f$   of the tame strong bundle $P\colon Y\to X$ over the M-polyfold $X$ is regularizing so that the solutions $y\in X$ of $f(y)=0$ are smooth points. Moreover, at every smooth point $y\in X$, the sc-germ $(f, y)$ is a sc-Fredholm germ. 


We now focus  on a neighborhood of the solution $x$ of $f(x)=0$. By assumption, the sc-Fredholm germ $(f, x)$ is in good position according to Definition \ref{new_good_position_def}, so that the kernel $N:=\ker f'(x)$ is in good position to the partial quadrant
 $C_xX\subset T_xX$, and the linearization $f'(x)\colon T_xX\to Y_x$ is surjective. In view of Proposition \ref{prop3_52}, the linear operator $f'(x)$ is a Fredholm operator. Its index is equal to $\ind (f'(x))=\dim N.$

By definition of a sc-Fredholm germ, there exists a strong bundle chart  of the tame strong bundle $P\colon Y\to X$
\begin{equation*}
\begin{CD}
P^{-1}(V)@>\Phi>>K\\
@VPVV @VVpV \\
V@>\varphi>>O 
\end{CD}\,
\end{equation*}
covering the sc-diffeomorphism $\varphi\colon V\to O$, which is defined on the open neighborhood $V\subset X$ of the given point $x\in X$ and satisfies  $\varphi (x)=0$. The retract $K=R(U\triangleleft F)$ is the image of the strong bundle retraction $R\colon U\triangleleft F\to U\triangleleft F$ of the form 
$R(u, h)=(r(u), \rho (u)h)$  and which covers the tame sc-smooth retraction $r\colon U\to U$ onto $O=r(U)$. As usual, the set $U\subset C$ is a relatively  open subset of the partial quadrant $C=[0,\infty)^k\oplus \R^{n-k}\oplus W$ in the sc-Banach space $E=\R^n\oplus  W$.
Still by definition of a sc-Fredholm germ, the push-forward section
$$\wt{f}=\Phi_\ast (f)\colon O\to K$$
possesses a filled version $g\colon U\to U\triangleleft F$. It has, in particular, the property that 
\begin{equation}\label{g=wtilde_f}
g(u)=\wt{f}(u)\quad \text{if $u\in O$}.
\end{equation}
In addition, there exists a strong bundle isomorphism 
\begin{equation*}
\begin{CD}
U\triangleleft F@>\Psi>>U'\triangleleft F'\\
@VVV @VVV \\
U@>\psi>>U'
\end{CD}\,
\end{equation*}
where $F'=\R^{N}\oplus W$. It covers the sc-diffeomorphism $\psi\colon U\to U'$ satisfying  $\psi (0)=0$. The set $U'$ is a relatively open subset of the partial quadrant $C'=T\psi (0)C$ in the sc-space $E'=\R^N\oplus W$. In addition,  by definition of a sc-Fredholm germ, there exists a $\ssc^+$-section $s\colon U\to U\triangleleft F$ satisfying $s(0)=g(0)$ such that the push-forward section 
$$\Psi_\ast (g-s)=h\colon U'\to F'$$
is a basic germ according to Definition \ref{BG-00x}. Therefore, 
\begin{equation}\label{new_equ_50}
\Psi_\ast (g)=h+t,
\end{equation}
where $t=\Psi_\ast (s)$ is a $\ssc^+$-section $U'\to F'$.

In view of Proposition \ref{Newprop_3.9}, the linearization $D(h+t)(0)\colon E'\to F'$ is a sc-Fredholm operator, so that, by Proposition \ref{prop1.21}, the operator $Dg(0)\colon E\to F$ is also a sc-Fredholm operator.


From the postulated surjectivity of the linearization $f'(x)\colon T_xX\to Y_x$ we deduce that 
$T\wt{f}(0)\colon T_0O\to K_0$ is surjective. Hence, by Proposition \ref{filler_new_1}, the operator $Dg(0)$ is surjective. Since $\ker f'(x)$ is in good position to the partial quadrant $C_xX\subset T_xX$, and since $T\varphi (x)(C_xX)=C_0O=T_0O\cap C$, the kernel $\ker T\wt{f}(0)$ is in good position to the partial quadrant  $C_0O$. The retract $O=r(U)$ is, by assumption, tame. Hence,  the tangent space $T_0O$ has, in view Proposition \ref{IAS-x}, the sc-complement $\ker Dr(0)$ in $E$ so that 
$$E=T_0O\oplus \ker Dr(0),$$
and $\ker Dr(0)\subset E_x$ at the point $x=0$ ($E_x$ is defined in Definition \ref{new_def_2.33}).
If $Z\subset T_0O$ is a good complement of $\ker T\wt{f}(0)$ in $T_0O=\ker T\wt{f}(0)\oplus Z$, the space $Z\oplus \ker Dr(0)$ is a good complement of 
$\ker T\wt{f}(0)$ in $E$, so that 
$$E=\ker T\wt{f}(0)\oplus (Z\oplus \ker Dr(0)).$$

Since, by the properties of the filler,  
$$\ker T\wt{f}(0)\oplus \{0\}=\ker Dg(0),$$
we conclude that $\ker Dg(0)$ is in good position to $C$ in $E$. Therefore, $N'=\ker D(h+t)(0)$ is in good position to $C'=T\psi (0)C$ in $E'$. Let now $Y'\subset E'$ be the  good complement of $N'$ in $E'=N'\oplus Y'$  from Theorem \ref{LGS2}. %

Then we can apply Theorem \ref{LGS2} %
about the local germ solvability and find an open neighborhood $V'\subset N'\cap C'$ of $0$,  and a map 
$$\sigma\colon V'\to (Y')_1$$ 
possessing the following properties.
\begin{itemize}
\item[(1)]\ $\sigma\colon V'\to (Y')_1$ is of class $C^1$ and satisfies $\sigma (0)=0$ and $D\sigma (0)=0$.
\item[(2)]\ $\sigma\colon {\mathcal O}(N'\cap C', 0)\to (Y', 0)$ is a sc-smooth germ.
\item[(3)]\ 
\begin{align*}
\psi\circ \varphi (&\{y\in V\, \vert \, f(y)=0\}&& \text{}\\
&=\psi (\{u\in O\, \vert \, \wt{f}(u)=0\})&& \text{}\\
&=\psi (\{u\in O\, \vert \, g(u)=0\})&& \text{by \eqref{g=wtilde_f}}\\
&=\{u'\in U'\, \vert \, (h+t)(u')=0\}&& \text{by \eqref{new_equ_50}}\\
&=\{v+\sigma (v)\, \vert \, v\in V'\}&& \text{by Corollary \ref{LGS2}.}
\end{align*}
\end{itemize}
Moreover,
\begin{itemize}
\item[(4)]\ For every $y\in V$ satisfying $f(y)=0$, so that  $\psi\circ \varphi (y)=v+\sigma (v)$, the kernel $\ker f'(y)$ is in good position to the partial quadrant  $C_yX\subset T_yX$, and $f'(y)\colon T_yX\to Y_y$ is surjective.
\end{itemize}
 Property (4) follows from Corollary \ref{corex1} and from the following lemma, whose proof is postponed to Appendix \ref{geometric_preparation}.

\begin{lemma}\label{good_pos}
Let $C\subset E$ be  a partial quadrant in the  sc-Banach space $E$ and $N\subset E$ a finite-dimensional smooth subspace in good position to $C$ and let $Y$ be a good complement of $N$ in $E$, so that $E=N\oplus Y$.
We assume that $V\subset N\cap C$ is a relatively open neighborhood
of $0$ and $\tau\colon V\rightarrow Y_1$ a map of class $C^1$ satisfying $\tau(0)=0$ and $D\tau(0)=0$.


Then there exists a relatively open neighborhood $V'\subset V$ of $0$ such  that the following holds.
\begin{itemize}
\item[{\em (1)}]\ $v+\tau(v)\in C_1$ for $v\in V'$.
\item[{\em (2)}]\ For every $v\in V'$,  the linear subspace $N_v=\{n+D\tau(v)n\, \vert \, n\in N\}$ has the Banach space $Y=Y_0$ as a topological complement.
\item[{\em (3)}]\ For every $v\in V'$,  there exists a  constant $\gamma_v>0$ such  that  if  $n\in N_v$ and $y\in Y$ satisfy 
$\abs{y}_0\leq \gamma_v\cdot \abs{n}_0$,  the statements $n\in C_z$ and $n+y\in C_z$ are equivalent, where $z=v+\tau (v)$. 
\end{itemize}

\end{lemma}


So far we are confronted with the following situation. The open neighborhood $V\subset X$ of the smooth point $x$ is a M-polyfold and we denote the solution set of the sc-Fredholm section $f$ of the tame strong bundle $P^{-1}(V)\to V$ by $S=\{y\in V\, \vert \, f(y)=0\}$. It consists of smooth points. For every $y\in S$, the germ $(f, y)$ is a sc-Fredholm germ and the linearization $f'(y)\colon T_yV\to Y_y$ is a surjective Fredholm operator whose kernel $\ker f'(y)$ is in good position to the partial cone $C_yV\subset T_yV$, so that, proceeding as above we can construct a map $\sigma$ satisfying the above properties (1)-(3). Consequently, abbreviating $d=\dim (\ker f'(x))$, the solution set $S\subset V$ possesses the $d$-dimensional tangent germ property according to Definition \ref{toast}. Therefore we can apply Theorem \ref{HKL} to conclude that the solution set 
$S=\{y\in V\, \vert \, f(y)=0\}$ is a sub-M-polyfold, whose induced M-polyfold structure is equivalent to the structure of a smooth manifold with boundary with corners.

This completes the proof of Theorem \ref{IMPLICIT0}.
\qed \end{proof}
Finally,  we note two immediate consequences of Theorem \ref{IMPLICIT0}.
{\begin{theorem}[{\bf Global implicit function theorem {I}}]\label{io-xx}\index{T- Global implicit function theorem}
If $P\colon Y\rightarrow X$ is a strong bundle over an  M-polyfold $X$ satisfying  $\partial X=\emptyset$,  and if $f$ a sc-Fredholm section having the property that at  every point $x$ in the solution set $S=\{y\in X\ |\ f(y)=0\}$,  the linearization $f'(x)\colon T_xX\rightarrow Y_x$ is surjective. Then $S$ is a sub-M-polyfold
of $X$ and the induced M-polyfold structure on $S$ is equivalent to the structure of a smooth manifold  without boundary.
\end{theorem}

In a later section we shall study the question how to perturb a sc-Fredholm section to guarantee the properties required 
in the hypotheses of Theorem \ref{io-xx} and the following  boundary version.
\begin{theorem}[{\bf Global implicit function theorem {II}}]\label{io-xxx}\index{T- $\partial$-Global implicit function theorem}
Let $P\colon Y\rightarrow X$ be a strong bundle over the tame M-polyfold $X$,   and $f$ a sc-Fredholm section having the property that
at  every point $x$ in the solution set $S=\{y\in X\ |\ f(y)=0\}$,  the linearization $f'(x)\colon T_xX\rightarrow Y_x$ is surjective and the kernel $\ker(f'(x))$ is in good position
to the partial cone $C_xX\subset T_xX$.  Then $S$ is a sub-M-polyfold
of $X$ and the induced M-polyfold structure on $S$ is equivalent to the structure of a smooth manifold with boundary with corners.
\end{theorem}


\section{Conjugation to a Basic Germ}

A useful criterion to decide  in practice whether  a filled version is conjugated to a basic germ is given in Theorem \ref{basic_germ_criterion} below.
We would like to point out a similar result,  due to K. Wehrheim,  in  \cite{Wehr}.
 The following criterion was 
introduced in \cite{HWZ5} and employed to show that the nonlinear Cauchy-Riemann operator occurring in the Gromov-Witten theory
defines a sc-Fredholm section.
\begin{theorem}[{\bf Basic Germ Criterion}]\label{basic_germ_criterion}\index{T- Basic germ criterion}
Let  $U$ be  a relatively open neighborhood of $0$ in the partial quadrant $C$ of the sc-Banach space $E$, and let 
${\bm{f}}\colon U\rightarrow F$ be a sc-smooth map into the sc-Banach space $F$, which satisfies the following conditions.
\begin{itemize}
\item[{\em (1)}]\ At every smooth point $x\in U$ the linerarization $D{\bm{f}}(x)\colon E\rightarrow F$
is a sc-Fredholm operator and the index does not depend on $x$.
\item[{\em (2)}]\ There is a sc-splitting $E=B\oplus X$ in which $B$ is a finite-dimensional subspace of $E$ containing the kernel
of $D{\bm{f}}(0)$, and $X\subset C$, such  that the following holds for $b\in B\cap U$ small enough.  If $(b_j)\subset B\cap U$
is a sequence converging to $b$ and if $(\eta_j)\subset X$ is a sequence which is bounded on level $m$ and satisfying
$$
D{\bm{f}}(b_j)\eta_j=y_j+z_j,
$$
where $y_j\rightarrow 0$ in $F_m$ and where the sequence $(z_j)$ is bounded in $F_{m+1}$, then the sequence $(\eta_j)$ possesses a convergent
subsequence in $X_m$.
\item[{\em (3)}]\ For every  $m\geq 0$ and $\varepsilon>0$, the estimate 
$$
\abs{[D_2{\bm{f}}(b,0)-D_2{\bm{f}}(b,x)]h}_m\leq \varepsilon\cdot \abs{h}_m
$$
holds for all $h\in E_m$, and for  $b\in B$ sufficiently small,  and for $x\in X_{m+1}$ sufficiently small on level $m$, i.e.
we require $x$ to be on level $m+1$, but $|x|_m$ small only for level $m$.
\end{itemize}
Then the section ${\bf f-s}$ is conjugated near $0$ to a basic germ, where ${\bm{s}}$ is the constant $\ssc^+$-section ${\bm{s}}(x)={\bm{f}}(0)$.
\end{theorem}

\begin{proof}
Abbreviating  $Y:=D{\bm{f}}(0)X\subset F$, the restriction 
$$
D{\bm{f}}(0)\vert X\colon X\rightarrow Y
$$
is an injective and surjective sc-operator. Since $D{\bm{f}}(0)\colon E\to F$ is a sc-Fredholm operator, we find a finite-dimensional sc-complement $A$ of $Y$ in $F$, such that 
$$
F=Y\oplus A.
$$
Denoting  by $P\colon Y\oplus A\rightarrow Y$ the sc-projection, we consider the family $b\mapsto L(b)$ of bounded linear operators, defined by  
$$L(b)=P\circ D{\bm{f}}(b)\vert X\colon X\to Y.$$
It is not assumed  that the operators $L(b)$ depend continuously on $b$. Since $B$ is a finite-dimensional
sc-smooth space,  the map 
$$
(B\cap U)\oplus X\rightarrow Y\colon (b,x)\mapsto  P\circ D{\bm{f}}(b)x
$$
is sc-smooth. If we raise the index by one, then the map  
$$
(B\cap U)\oplus X^1\rightarrow Y^1\colon (b,x)\mapsto  P\circ D{\bm{f}}(b)x
$$
is also sc-smooth by Proposition \ref{sc_up}.


\begin{lemma}\label{trivial_kernel}\index{L- Basic germ criterion {I}}
There exists a relatively open neighborhood $O$ of $0$ in $B\cap C$ such  that  the composition  
$$
P\circ D{\bm{f}}(b)\colon X\rightarrow Y,
$$
has a trivial kernel for every $b\in O$.
\end{lemma}
\begin{proof}
Assuming  that such an open set $O$ does not exist,  we find a sequence $b_j\in B\cap C$ satisfying  $b_j\rightarrow 0$ and a sequence $(h_j)\subset X_0$ satisfying $|h_j|_0=1$ such  that
$P\circ D{\bm{f}}(b_j)h_j=0$. Then $D{\bm{f}}(b_j)h_j = z_j$ is a bounded sequence in $A$,  in fact on every level since $A$ is a smooth subspace, and we consider  the level $1$ for the moment.
From property (2) we deduce that $(h_j)$ has a convergent subsequence in $X_0$. So,  without loss of generality,  
we may assume $h_j\rightarrow h$ in $X_0$ and  $|h|_0=1$. Hence
$$
P\circ D{\bm{f}}(0)h=0, 
$$
in contradiction to the injectivity of the map $P\circ D{\bm{f}}(0)\vert X$. 
The lemma is proved.
\qed \end{proof}

From the property (1) and the fact that $P$ is a sc-Fredholm operator,  we conclude that $P\circ D{\bm{f}}(x)$ for smooth $x$ are all sc-Fredholm operators having  the same index. In particular, if $b\in O$, then $P\circ D{\bm{f}}(b)\colon X\rightarrow Y$ is an  injective sc-Fredholm operators of index $0$ in view of Lemma \ref{trivial_kernel},  and 
hence  a  sc-isomorphism. Next we sharpen this result.


\begin{lemma}\index{L- Basic germ criterion {II}}%
We take a relatively  open neighborhood $\wt{O}$ of $0$ in $C\cap B$ whose compact closure is contained in $O$. Then
for every level $m$ there exists a number $c_m>0$ such  that,  for every $b\in \wt{O}$,  we have the estimate
$$
|P\circ D{\bm{f}}(b)h|_m\geq c_m\cdot |h|_m\quad  \text{for all $h\in X_m$.}
$$
\end{lemma}

\begin{proof}

Arguing indirectly we find a level $m$ for which there is no such constant $c_m$. Hence there are sequences
$(b_j)\subset \wt{O}$ and $(h_j)\subset X_m$ satisfying $|h_j|_m=1$ and  
$\abs{P\circ D{\bm{f}}(b_j)h_j}_m\rightarrow 0$.
After perhaps taking a subsequence we may assume that $b_j\rightarrow b$ in $O$. 

From 
$$
D{\bm{f}}(b_j)h_j =P\circ D{\bm{f}}(b_j)h_j=y_j\to 0\quad \text{in $F_m$},
$$
we conclude,  in view of the property (2),  for a subsequence,  that $h_j\to h$ in $X_m$. By continuity, $P\circ D{\bm{f}}(b)h=0$ and $\abs{h}_m=1$, in contradiction to the fact, that $P\circ D{\bm{f}}(b)\colon X\to Y$ is a 
sc-isomorphism for $b\in O$.

\qed \end{proof}

So far we have verified that the family $b\mapsto L(b)$ meets the assumptions 
of the following lemma,  taken from \cite{HWZ8.7}, Proposition 4.8.

\begin{lemma}\label{family_maps}\index{L- Basic germ criterion {III}}
We assume that $V$ is a relatively open subset in the partial quadrant of a finite-dimensional vector space $G$.
We suppose further that $E$ and $F$ are sc-Banach spaces and consider a family of linear operators $v\rightarrow L(v)$ 
having  the following properties.
\begin{itemize}
\item[{\em (a)}]\ For every $v\in V$, the linear operator  $L(v)\colon E\rightarrow F$ is a sc-isomorphism.
\item[{\em (b)}]\ The map
$$
V\oplus E\rightarrow F,\quad (v,h)\mapsto L(v)h
$$
is sc-smooth.
\item[{\em (c)}]\ For every level $m$ there exists a constant $c_m>0$ such that for $v\in V$ and all $h\in E_m$
$$
|L(v)h|_m\geq c_m\cdot |h|_m.
$$
\end{itemize}
Then the well-defined map
$$
V\oplus F\rightarrow E\colon (v,k)\mapsto  L(v)^{-1}(k)
$$
is sc-smooth.
\qed
\end{lemma}

Let us emphasize that it is  not assumed  that the operators $v\rightarrow [L(v)\colon E_m\rightarrow F_m]$ depend continuously as operators 
on $v$.




In view of Lemma \ref{family_maps}, the map 
$B\oplus Y\to Y$,
$$(b, y)\mapsto \bigl(P\circ Df(b)\vert X\bigr)^{-1}y,$$
is sc-smooth.

We may assume that the finite-dimensional space  $B$ is equal to $\R^n$ and that $E=\R^n\oplus X$ and $C=[0,\infty)^k\oplus \R^{n-k}\oplus X$ is the partial quadrant in $E$. Hence $B\cap C=[0,\infty)^k\oplus \R^{n-k}$. Moreover, we may identify the finite-dimensional subspace $A$ of $F$ with $\R^N=A$. Replacing, if necessary, the  relatively open neighborhood $U \subset C$ of $0$ by a smaller one
we may assume, in addition,  that $(b,x)\in U$ implies that $b\in \wt{O}$.

 We now define a strong bundle map
$$
\Phi\colon U\triangleleft (\R^N\oplus Y)\rightarrow U\triangleleft (\R^N\oplus Y)
$$
covering the identity $U\to U$ by
$$
\Phi((b,x),(c,y))= ((b,x), (c,[P\circ D{\bm{f}}(b)|X]^{-1}(y))).
$$
We define  the sc-smooth germ $({\bm{h}},0)$ by ${\bm{h}}(b,x)={\bm{f}}(b,x)-{\bm{f}}(0,0)$, where  $(b,x)\rightarrow {\bm{f}}(0,0)$ is a constant $\ssc^+$-section.
We shall show that the  push-forward germ ${\bm{k}}=\Phi_\ast({\bm{h}})$ is a basic germ. Using $D{\bm{h}}=D{\bm{f}}$,  we compute 
$$
{\bm{k}}(b,x) = (({\mathbbm 1}-P){\bm{h}}(b,x), [P\circ D{\bm{h}}(b)|X]^{-1}P{\bm{h}}(b,x))\in \R^N\oplus X.
$$
The germ ${\bm{k}}$ is  a sc-smooth germ 
$$ 
{\mathcal O}([0,\infty)^k\oplus \R^{n-k}\oplus X,0)\rightarrow (\R^N\oplus X,0).
$$
Denoting by $Q\colon \R^N\oplus X\rightarrow X$ the sc-projection, we shall verify that $Q{\bm{k}}$ is a $\ssc^0$-contraction germ.  We define the sc-smooth  germ $H\colon \R^n\oplus X\to X$ by 
$$
H(b,x) = x- Q{\bm{k}}(b,x)=x - [P\circ D{\bm{h}}(b)|X]^{-1}P{\bm{h}}(b,x).
$$
By construction,  $H(0,0)=0$.  The family $L(b)\colon X\to Y$ of bounded linear operators, defined by 
$$
L(b):=P\circ D{\bm{f}}(b)\vert X,\quad b\in B,
$$
satisfies the assumptions of Lemma \ref{family_maps}. Recalling now the condition (3) of Theorem \ref{basic_germ_criterion}, we choose $m\geq 0$ and $\varepsilon>0$ and accordingly take $b\in B$ small and $x, x'\in X_{m+1}$ small on level $m$. Then using the estimates in condition (3) and in Lemma  \ref{family_maps}, we estimate, recalling that $P\circ D_2h(b, x)=P\circ D_2f(b, x)$, 

\begin{equation*}
\begin{split}
&|H(b,x)-H(b,x')|_m=\abs{L(b)^{-1} [L(b)(x-x') - P{\bm{h}}(b,x) +P{\bm{h}}(b,x')}_m\\
&\quad \leq c_m^{-1}\cdot \abs{P \circ \bigl[D_2{\bm{f}}(b, 0)(x-x')  - {\bm{h}}(b,x) +{\bm{h}}(b,x')] }_m\\
&\quad =c_m^{-1}\cdot \abs{ 
\int_0^1 
P\circ  \bigl[D_2{\bm{f}}(b, 0)- D_2{\bm{f}}(b,tx +(1-t)x')\bigr](x-x')dt}_m\\
&\quad \leq  c_m^{-1}\cdot d_m\cdot\varepsilon\cdot |x-x'|_m.
\end{split}
\end{equation*}
The map $(b, x)\mapsto H(b, x)$ is sc-smooth. Therefore, using the density of $X_{m+1}$ in $X_m$, we conclude,  
for every $m\geq 0$ and $\varepsilon>0$,  that the estimate 
$$\abs{H(b, x)-H(b, x')}_m\leq \varepsilon\abs{x-x'}_m$$
holds, if $b\in B$ is small enough and $x, x'\in X_m$ are sufficiently small.  Having verified that the push-forward germ ${\bm{k}}=\Phi_\ast ({\bm{h}})$ is a basic germ, the proof of Theorem \ref{basic_germ_criterion} is complete.

\qed \end{proof}
\section{Appendix}

\subsection{Proof of Proposition \ref{pretzel}}\label{pretzel-A} 
We need to show the following:\par

\noindent{\bf Proposition} If  $N$ is a finite-dimensional sc-subspace in good position to the partial quadrant  $C$ in $E$, then
$N\cap C$ is a partial quadrant in $N$.\par

As a preparation for the proof we recall some tools and results from the appendix in \cite{HWZ3} and begin with the geometry of closed convex cones and quadrants in finite dimensions.
A  {\bf closed convex cone} $P$ in a finite-dimensional vector space
 $N$ is a closed convex
subset satisfying  $P\cap (-P)=\{0\}$ and $\R^+\cdot P=P$.
 An
{\bf extreme ray} in a closed convex cone $P$ is a subset $R$ of the
form
$$
R=\R^+\cdot x, 
$$
where  $x\in P\setminus \{0\}$, having the property that  if   $y\in P$ and  $x-y\in P$, then $y\in R$. If the cone $P$ has a nonempty interior, then  it generates the vector space  $N$, that is $N=P-P$.

A {\bf quadrant} $C$ in a vector space $N$ of dimension $n$ is a closed convex cone such that there exists a linear isomorphism $T\colon N\rightarrow \R^n$ mapping $C$ onto $[0,\infty)^n$. We observe that a quadrant
in $N$ has precisely $\dim(N)$ many extreme rays.  

The following  version of the Krein-Milman theorem
is well-known, see exercise 30 on page 72 in \cite{Schaefer}.  A proof can be found in the appendix of \cite{HWZ3}, Lemma 6.3.
\begin{lemma}\label{kreinmilman}
A closed convex cone $P$ in a finite-dimensional vector space $N$ is
the  closed convex hull of its extreme rays.
\end{lemma}
 A closed convex cone $P$ is called {\bf finitely generated} provided $P$ has
finitely many extreme rays. If this is the case, then  $P$ is the convex hull of
its finitely many extreme rays.

 For example,  if $C$ is a partial
quadrant in the sc-Banach space $E$ and $N\subset E$ is a finite-dimensional subspace of
$E$ such  that $C\cap N$ is a closed convex cone, then $C\cap N$ is
finitely generated.

\begin{lemma}\label{nomer}
Let $N$ be a finite-dimensional vector space and $P\subset N$ a
closed convex cone having a nonempty interior. Then $P$ is a quadrant if
and only if it has $\dim(N)$-many extreme rays.
\end{lemma}
The proof is given in  \cite{HWZ3}, Lemma  6.4. 

We consider the sc-Banach space $E =\R^n\oplus W$  containing the partial quadrant $C =[0,\infty)^n\oplus W$. A point  $a\in C=[0,\infty )^n\oplus W\subset \R^n\oplus W$, has  the representation
$a=(a_1,\ldots ,a_n, a_{\infty})$,  where $(a_1,\ldots ,a_n)\in [0,\infty )^n$ and $a_{\infty}\in W$.
By $\sigma_a$ we shall denote the collection of all  indices $i\in \{1,\ldots ,n\}$ for which
$a_i=0$ and denote by $\sigma_a^c$  the complementary set of indices in $\{1,\ldots ,n\}$. Correspondingly, we introduce the following subspaces in $\R^n$,
\begin{align*}
\R^{\sigma_a}&=\{x\in \R^n\ \vert \ \text{$x_j=0$ for all $j\not \in \sigma_a$}\}\\
\R^{\sigma^c_a}&=\{x\in \R^n\ \vert \ \text{$x_j=0$ for all $j\not \in \sigma^c_a$}\}.
\end{align*}
The next lemma and its proof is taken from the appendix in \cite{HWZ3}. The hypothesis that $C\cap N$ is a closed convex cone is crucial.

\begin{lemma}\label{roxy}
Let $N\subset E_{\infty}$ be  a finite-dimensional smooth subspace of  $E=\R^n\oplus W$ such  that $N\cap C$ is a closed convex cone. If $a\in N\cap C$ is a generator of  an extreme ray $R=\R^+\cdot x$ in $N\cap C$, then
$$
\dim(N)-1\leq \#\sigma_a.
$$
If,  in addition, $N$ is in good position to $C$, then
$$
\dim(N)-1= \#\sigma_a.
$$
\end{lemma}
\begin{proof}
We assume $R=\R^+\cdot a$ is an extreme ray in $C\cap N$ and abbreviate $\sigma=\sigma_a$ and its complememnt in $\{1, \ldots ,n\}$ by  $\sigma^c$.  Then $R\subset N\cap C\cap (\R^{\sigma^c}\oplus W)$. Let $y\in C\cap N\cap (\R^{\sigma^c}\oplus
W)$ be a nonzero element. Since $a_i>0$ for all $i\in\sigma^c$,  there exists $\lambda>0$ so that $\lambda a-y\in N\cap C\cap
(\R^{\sigma^c}\oplus W)\subset N\cap C$. We conclude $y\in R$ because  $R$ is an extreme ray. Given any element $z\in
N\cap(\R^{\sigma^c}\oplus W)$ we find $\lambda>0$ so that
$\lambda a+z\in N\cap C\cap(\R^{\sigma^c}\oplus W) $ and infer,
by the previous argument,  that $\lambda a+z\in R$. This implies that $z\in \R \cdot a$. Hence
\begin{equation}\label{pol}
 \dim(N\cap(\R^{\sigma^c}\oplus W))=1.
\end{equation}
The projection $P\colon \R^n\oplus W=\R^{\sigma}\oplus (\R^{\sigma^c}\oplus W) \to \R^{\sigma}$ induces a linear map
\begin{equation}\label{ohx}
P\colon N\rightarrow \R^{\sigma}
\end{equation}
which by \eqref{pol} has  an one-dimensional kernel. Therefore,
$$
\#\sigma=\dim(\R^{\sigma})\geq \dim R(P)=\dim N-\dim \ker P=\dim(N)-1.
$$
Next assume $N$ is in good position to $C$. Hence there exist a constant $c>0$ and a sc-complement $N^{\perp}$ such that $N\oplus N^{\perp}=\R^n\oplus W$ and if $(n, m)\in N\oplus N^{\perp}$ satisfies $|m|_0\leq c |n|_0$, then $n+m\in C$ if and only if $n\in C$.  We claim that  $N^{\perp}\subset \R^{\sigma^c}\oplus W$. Indeed, let $m$ be any element of $N^{\perp}$.  Multiplying $m$ by a real number we may assume  $|m|_0\leq c |a|_0$ .  Then $a+m\in C$ since $a\in C$. This implies that
$m_i\geq 0$ for  all indices $i\in\sigma_a$. Replacing $m$ by $-m$,  we conclude
$m_i=0$ for all $i\in\sigma_a$.  So $N^{\perp}\subset  \R^{\sigma^c}\oplus W$ as claimed.
Take  $k\in \R^{\sigma_a}$
and write $(k, 0)=n+m\in N\oplus N^{\perp}$.  From  $N^{\perp}\subset {\mathbb
R}^{\sigma^c}\oplus W$, we conclude $P(n)=k$. Hence the map $P$  in \eqref{ohx}  is surjective  and the desired result follows.
\qed \end{proof}



Having studied the geometry of closed convex cones and partial quadrants in finite dimensions we shall next study finite dimensional subspaces $N$ in good position to a partial quadrant $C$ in a sc-Banach space.  In this case,  $N\cap C$ can be a partial quadrant rather than a quadrant, which requires, some additional arguments.

We assume that $N$ is a smooth  finite-dimensional subspace of
$E=\R^n\oplus W$ which is in good position to the partial quadrant $C=[0,\infty)^n\oplus
W$. Thus, by definition, there is  a sc-complement,  denoted by  $N^{\perp}$,  of $N$ in $E$ and a constant $c>0$ such 
that if  $(n,m)\in N\oplus N^{\perp}$ satisfies  $|m|_0\leq c |n|_0$, then  the statements
$n\in C$ and $n+m\in C$ are equivalent.
We introduce the subset $\Sigma$ if $\{1,\ldots,n\}$ by 
$$\Sigma=\bigcup_{a\in C\cap N, a\neq 0}\sigma_{a}\subset \{1,\ldots ,n\}.$$
and denote by $\Sigma^c$ the complement $\{1,\ldots ,n\}\setminus \Sigma$. The associated subspaces of $\R^n$ are defined by
$\R^{\Sigma}=\{x\in \R^n\ \vert \ \text{$ x_j=0$ for $j\not \in \Sigma$}\}$ and
$\R^{{\Sigma}^c}=\{x\in \R^n\ \vert \ \text{$ x_j=0$ for $j\not \in \Sigma^c$}\}$.

\begin{lemma}\label{cone1}
$N^{\perp}\subset {\mathbb
R}^{\Sigma^c}\oplus W$.
\end{lemma}
\begin{proof}
Take   $m\in N^{\perp}$. We  have to show that $m_i=0$ for all $i\in\Sigma$.
So fix an index  $i\in\Sigma$ and let $a$ be a nonzero element of  $C\cap N$ such that
$i\in\sigma_a$. Multiplying $a$ by a suitable positive number we may
assume $|m|_0\leq c |a|_0$.  Since $a\in C$,   we infer that $a+m\in C$. This implies
that $a_i+m_i\geq 0$. By definition of $\sigma_a$, we have $a_i=0$  implying $m_i\geq 0$.
Replacing $m$ by $-m$ we find $m_i=0$. Hence $N^{\perp}\subset {\mathbb
R}^{\Sigma^c}\oplus W$ as claimed.
\qed \end{proof}


Identifying $W$ with $\{0\}\oplus W$,  we take   an algebraic complement $\wt{N}$ of $N\cap W$ in $N$ so that
\begin{equation}\label{hoferx}
N=\wt{N}\oplus (N\cap W)\quad \text{and}\quad\quad E= \wt{N}\oplus(N\cap W)\oplus N^{\perp}.
\end{equation}
Let us note that the projection $\pi\colon \R^n\oplus W\rightarrow  \R^n$ restricted to $\tilde{N}$ is injective,  so that
\begin{equation}\label{hoferx0}
\dim(\pi(\tilde{N}))=\dim(\tilde{N}).
\end{equation}
\begin{lemma}\label{ntilde}
If the subspace $N$ of $E$ is in good position to the partial quadrant  $C$, then
$\wt{N}$ is also  in good position to $C$ and the  subspace $\wt{N}^{\perp}:=(N\cap W)\oplus N^{\perp}$ is a good complement of $\wt{N}$ in $E$.
\end{lemma}
\begin{proof}
We define $\abs{x}:=|x|_0$.
Since $N$ is in good position to the quadrant $C$ in $E$, there exist a constant $c>0$ and a sc-complement $N^{\perp}$ of $N$ in $E$ such that if $(n, m)\in N\oplus N^{\perp}$ satisfies $\abs{m}\leq c\abs{n}$, then
 the statements $n\in C$ and $n+m\in C$ are equivalent.  Since $E$ is a Banach space and $N$ is a finite dimensional subspace of $E$, there is a constant $c_1>0$ such that
 $\abs{n+m}\geq c_1[ \abs{n}+\abs{m}]$ for all $(n, m)\in N\oplus N^{\perp}$.  To prove  that $\wt{N}$ is in good position to $C$,  we shall show that $\wt{N}^{\perp}:=(N\cap W)\oplus N^{\perp}$ is a good complement of $\wt{N}$ in $E$. Let $(\wt{n}, \wt{m})\in \wt{N}\oplus \wt{N}^{\perp}=E$ and assume that  $\abs{\wt{m}}\leq c_1c\abs{\wt{n}}$. Write $\wt{m}=n_1+n_2\in (N\cap W)\oplus N^{\perp}$. Since $c_1[\abs{n_1}+\abs{n_2}]\leq \abs{n_1+n_2}=\abs{\wt{m}}\leq c_1c\abs{\wt{n}}$, we get $\abs{n_2}\leq c\abs{\wt{n}}$.  Note that $\wt{n}+\wt{m}=\wt{n}+n_1+n_2\in C$ if and only if $\wt{n}+n_2\in C$ since $n_1\in  \{0\}\oplus W$.  Since  $\abs{n_2}\leq c\abs{\wt{n}}$, this is equivalent to $\wt{n}\in C$. It remains to show that $\wt{N}\cap C$ has a nonempty interior. By assumption $N\cap C$ has nonempty interior. Hence there is a point $n\in N\cap C$ and $r>0$ such that the ball $B^{N}_r(n)$ in $N$ is contained in $N\cap C$. Write $n=\wt{n}+w$ where $\wt{n}\in \wt{N}$ and $w\in N\cap W$. Since $n\in C$ and  $w\in W$, we conclude that $\wt{n}\in C$. Hence $\wt{n}\in \wt{N}\cap C$.
Take $\nu \in B^{\wt{N}}_r(\wt{n})$,  the open ball in $\wt{N}$ centered at
  $\wt{n}$ and of radius $r>0$.  We want to prove that $\nu \in C$. Since $C=[0,\infty )^n\oplus W\subset \R^n\oplus W$, we have to prove for $\nu= (\nu', \nu'')\in \R^n\oplus W$ that $\nu'\in [0,\infty )^n$.  We estimate  $\abs{(\nu +w)-n}=\abs{(\nu +w)-(\wt{n}+w)}=\abs{\nu -\wt{n}}<r$ so that $\nu +w\in B^{N}_r(n)$ and hence  $\nu +w\in N\cap C$ . Having identified $W$ with $\{0\}\oplus W$, we have $w=(0, w'')\in \R^n\oplus W$.  Consequently, $\nu+w=(\nu', \nu''+w'')\in N\cap C$ implies $\nu' \in [0,\infty )^n$.  Since also $\nu \in \wt{N}$, one concludes  that $\nu \in \wt{N}\cap C$ and that $\wt{n}$ belongs to the interior of $\wt{N}\cap C$ in $\wt{N}$.  The proof of Lemma \ref{ntilde} is complete.
 \qed \end{proof}
 Since by  Lemma \ref{cone1},  $N^{\perp}\subset \R^{\Sigma^c}\oplus W$,  the  good complement   $\wt{N}^{\perp}=(N\cap W)\oplus N^{\perp}$ satisfies
$$
\wt{N}^{\perp}\subset \R^{\Sigma^c}\oplus W.
$$
We claim that $C\cap \wt{N}$ is a closed convex cone . 
It suffices to verify that if $a\in C\cap \wt{N}$ and $-a\in C\cap \wt{N}$, then $a=0$. We write 
$a=(a', a_\infty)$ where $a'\in \R^n$ and $a_\infty\in W$. Then $a', -a'\in [0,\infty)^n$ implies that $a'=0$ so that $a=(0, a_\infty)\in \{0\}\oplus W$. Since $a\in \wt{N}$ and $\wt{N}$ is an algebraic complement of $N\cap W$ in $N$, we conclude that $a=0$.  
Moreover,  by  Lemma  \eqref{ntilde},   $\wt{N}$ is in good position to $C$. 
Hence,  recalling  Lemma \ref{roxy}, we have proved  the following result.

\begin{lemma}
The intersection $C\cap\wt{N}$ is a closed convex cone in
$\wt{N}$. If  $a$ is a generator of an extreme ray in $C\cap \wt{N}$, then  
\begin{equation}\label{Nsigma}
\dim \wt{N}-1 =\#{\sigma_a}= d_C(a).
\end{equation}
\end{lemma}

The position of $\wt{N}$ with
respect to $\R^{\Sigma^c}\oplus W$ is described in the next lemma.
\begin{lemma}\label{ll1}
Either $\wt{N}\cap (\R^{\Sigma^c}\oplus W)=\{0\}$ or
$\wt{N}\subset \R^{\Sigma^c}\oplus W$.  In the second case
$\dim \wt{N}=1$ and $\Sigma=\emptyset$.
\end{lemma}

\begin{proof}
Assume that  $\wt{N}\cap (\R^{\Sigma^c}\oplus
W)\neq\{0\}$. Take  a nonzero point $x\in \wt{N}\cap (\R^{\Sigma^c}\oplus W)$. We know that $\wt{N}\cap C$ has a
nonempty interior in $\wt{N}$ and is therefore generated as the convex hull of
its extreme rays by Lemma \ref{kreinmilman}.  Let $a\in C\cap \wt{N}$ be a generator of an
extreme ray $R$. Then $a_i>0$ for all $i\in\Sigma^c$ and  hence $\lambda a +x\in C\cap \wt{N}$ for large  $\lambda >0$. Taking another large  number  $\mu>0$, we get   $\mu a- (\lambda a+x)\in C\cap \wt{N}$. Since $R=\R^+\cdot a$ is an extreme ray, we conclude $\lambda a+x\in \R^+\cdot a$ so that $x\in \R\cdot a$. Consequently,
there is only one extreme ray in $\wt{N}\cap C$, namely
 $R=\R^+\cdot a$ with  $a\in \R^{\Sigma^c}\oplus W$.  Since $\wt{N}\cap C$ has a nonempty interior in $\wt{N}$, we conclude that $\dim \wt{N}=1$  . Hence $\wt{N}=\R\cdot a$ and
 $\wt{N}\subset  \R^{\Sigma^c}\oplus W$. From equation \eqref{Nsigma} we also conclude that $a_i>0$ for all $1\leq i\leq n$.  This in turn implies that $\Sigma=\emptyset$ since  $a\in \R^{\Sigma^c}\oplus W$. The proof of Lemma \ref{ll1} is complete.
\qed \end{proof}

We finally come to the proof of Proposition  \ref{pretzel}.

\begin{proof}[Proposition \ref{pretzel}] 
We consider, according to Lemma \ref{ll1},  two cases.
Starting with the first case  we assume that $\wt{N}\cap (\R^{\Sigma^c}\oplus
 W)=\{0\}$. The projection $P\colon \wt{N}\oplus \wt{N}^{\perp}=\R^{\Sigma}\oplus (\R^{\Sigma^c}\oplus W)\to \R^{\Sigma}$  induces the linear map
 \begin{equation}\label{opl}
 P\colon \wt{N}\rightarrow \R^{\Sigma}.
 \end{equation}
Take $k\in\R^{\Sigma}$ and write
 $(k,0)=n+m\in\wt{N}\oplus\wt{N}^{\perp}$. Since $\wt{N}^{\perp}\subset
\R^{\Sigma^c}\oplus W$,  we conclude that
 $$
 P(n+m)=P(n)=k
 $$
so that $P$ is surjective. If $n\in \wt{N}$ and $P(n)=0$, then $n\in  \wt{N}\cap ({\mathbb
 R}^{\Sigma^c}\oplus W)=\{0\}$ by assumption. Hence the map in
 \eqref{opl} is a bijection.  By  Lemma \ref{nomer},
$C\cap\wt{N}$ is a quadrant in $\wt{N}$. We shall show that $P$ maps the quadrant $C\cap \wt{N}$ onto the standard quadrant $Q^{\Sigma}=[0,\infty )^{\Sigma}$ in $\R^{\Sigma}$.
Let $a$ be a nonzero element in $C\cap \wt{N}$ generating  an extreme ray $R=\R^+\cdot a$. Then, by Lemma \ref{roxy},
 $$
 \dim \wt{N}-1=\sharp\sigma_a, 
 $$
 and since $\sharp \Sigma=\text{dim}\ \wt{N}$ there is
exactly one index $i\in\Sigma$ for which
$a_i>0$. Further,  $a_i>0$ for all $i\in\Sigma^c$ by definition of $\Sigma$.  This implies that there can be
at most $\dim(\wt{N})$-many extreme rays. Indeed, if $a$ and $a'$
generate extreme rays and
$a_i,a_i'>0$  for some $i\in \Sigma$, then $a_k=a_k'=0$ for all
$k\in\Sigma\setminus\{i\}$.  Hence,  from  $a_j>0$ for all $j\in \Sigma^c$,   we conclude $\lambda
a-a'\in C$ for large $\lambda>0$. Therefore,
$a'\in \R^+a$ implying that $a$ and $a'$ generate the same
extreme ray. As a consequence,  $\wt{N}\cap C$ has  precisely $\dim \wt{N}$-many extreme rays because $\wt{N}\cap C$ has a nonempty interior in view of Lemma \ref{ntilde}.  Hence  the map $P$ in \eqref{opl}  induces an isomorphism
$$
(\wt{N}, \wt{N} \cap C)\rightarrow (\R^\Sigma,Q^\Sigma).
$$
This implies that $(N,C\cap N)$ is isomorphic to
$\bigl( {\R}^{\dim(N)}, [0,\infty)^{\sharp\Sigma}\oplus {\R}^{\dim(N)-\sharp\Sigma}\ \bigr).$

In the second case we assume  that $\wt{N}\subset \R^{\Sigma^c}\oplus W$.  From Lemma  \ref{ll1},  $\Sigma=\emptyset$ and $\wt{N}=\R\cdot a$ for an element $a\in
C\cap\wt{N}$  satisfying  $a_i>0$ for all $1\leq i\leq n$. Hence
$(\wt{N},\wt{N}\cap C)$ is isomorphic to
$( {\R}, {\R}^+)$ and therefore $(N,N\cap C)$ is isomorphic to
$( {\R}, \R^+)$ since in this case $N=\wt{N}$. The proof of Proposition \ref{pretzel} is complete.

\qed \end{proof}

We would like to add two results, which makes use of the previous discussion.


\begin{proposition}\label{big-pretzel}
Let $N$ be a sc-smooth finite-dimensional subspace of $E=\R^n\oplus W$ in good position to the partial quadrant $C=[0,\infty)^n\oplus W$.
If $x\in N\cap C$, then 
\begin{itemize}
\item[{\em (1)}]\ $d_{N\cap C}(x)= d_C(x)$  if  $x\not \in N\cap W$.
\item[{\em (2)}]\ $d_{N\cap C}(x)= \dim(N)-\dim(N\cap W)$ if $x\in N\cap W$. 
\end{itemize}
Here we identify $W$ with $\{0\}^n\oplus W$.
\end{proposition}

\begin{proof}
We make use of the previous notations and distinguish the two case $\dim N=1$ and $\dim N>1$.

If $\dim N=1$, then $N$ is spanned by a 
vector $e=(a_1,\ldots ,a_n, w)\in \R^n\oplus W$ in which $a_j>0$ for all $1\leq j\leq n$. This  implies that $(N, N\cap C)$ is isomorphic to $(\R, [0,\infty))$. 
If $x\in N\cap C$, then $x=te$ for some $t\geq 0$. If, in addition, 
$x\not \in N\cap W$, then $t>0$ and hence $d_{N\cap C}(x)=0=d_C(x)$. If  however, $x\in N\cap W$, then $t=0$, implying that $d_{N \cap C}(x)=1=\dim N.$

Now we assume that $\dim N>1$ and that $\wt{N}$ is the algebraic complement of $N\cap W$ in $N$ so that 
$N=\wt{N}\oplus (N\cap W)$. We may assume, 
after a linear change of coordinates, that $\wt{N}$ is represented as follows.
\begin{itemize}
\item[$(\ast)$]\ The linear subspace $\wt{N}$ is spanned by the vectors $e^j\in \R^n\oplus W$,  for $1\leq j\leq m=\dim \wt{N}$ of the form 
$e^j=(a^j, b^j, w^j)\in \R^m\oplus \R^{n-m}\oplus W$ where $a^j$  is  the standard basis vector in $\R^m$, $b^j=(b^j_1, \ldots ,b^j_{n-m})\in \R^{n-m}$ satisfies  $b^j_i>0$ for all $1\leq i\leq n-m$, and $w^j\in W$. 
\end{itemize}


If $e^j=(0,w^j)\in \{0\}^n\oplus W$ for $m+1\leq j\leq k$,$k=\dim N$,  is a basis of the finite-dimensional subspace $N\cap W$, then 
the vectors $e^1,\ldots ,e^k$ form a basis of $N=\wt{N}\oplus (N\cap W)$.  It follows that 
$(N, N\cap C)$ is isomorphic to $(\R^k, [0,\infty )^m\oplus \R^{k-m})$.


Now we assume that $x\in N\cap C$. 
 If $x\in N\cap C$, then 
\begin{equation}\label{algebraic_eq}
x=\sum_{j=1}^m\lambda_je^j+\sum_{j=m+1}^k\lambda_j e^j\in \wt{N}\oplus(N\cap W)
\end{equation} 
with $\lambda_j\geq 0$ for all $1\leq j\leq m$ and $d_{N\cap C}(x)=\#\{1\leq j\leq m\ \vert \ \lambda_j=0\}$. If, in addition, $x\in N\cap W$, then $\lambda_j=0$ for all $1\leq j\leq m$, and we conclude that 
$d_{N\cap C}(x)=m=\dim N-\dim (N\cap W)$. 


If $x\in ( N\cap C)\setminus (N\cap W)$, then there is at least one index $j_0$ in $1\leq j_0\leq m$  for which $\lambda_{j_0}>0$. This implies, in view of $(\ast)$  and \eqref{algebraic_eq} that 
$$x=\sum_{j=1}^me^j=(x_1, \ldots, x_n,w)\in \R^n\oplus W$$
satisfies $x_s>0$ for all $m+1\leq s\leq n$ since $b^j_i>0$ for  all $1\leq i\leq n-m$ and $m+1\leq j\leq n$. Using that $a^j$ in $(\ast)$ are vectors of the standard basis in $\R^m$,  it follows  for $1\leq s\leq m$
that $x_s=0$ if and only if $\lambda_s=0.$ This shows that $d_{N\cap C}(x)=d_C(x)$ if $x\not \in N\cap W$ and completes the proof of Proposition \ref{big-pretzel}. 

\qed \end{proof}

\begin{lemma}\label{big-pretzel_1a}
Let $N$ be a sc-smooth finite-dimensional subspace of $E=\R^n\oplus W$ in good position to the partial quadrant $C=[0,\infty)^n\oplus W$ whose good complement in $E$ is $Y$.  We assume that $\tau\colon N\cap C\to Y_1$ is  a $C^1$-map satisfying $\tau (0)=0$ and $D\tau (0)=0$.  Then 
$$d_{N\cap C}(v)=d_{C}(v+\tau (v))$$
for all $v\in N\cap C\setminus N\cap W$ close to $0$.
\end{lemma}

\begin{proof}

Since $N$ is in good position to $C$ and $Y$ is a good complement of $N$ is $E$, there exists a constant 
exists a constant  $\gamma>0$ such that if $n\in N$ and $y\in Y$ satisfy $\abs{y}_0\leq \gamma \abs{n}_0$, then 
$n\in C$ if and only if $n+y\in C$. It follows, in view of $\tau (0)=0$ and $D\tau (0)=0$, that $\abs{\tau (v)}_0\leq \gamma\abs{v}_0$ for $v\in N\cap C$ close to $0$. 

Now proceeding as in the proof of Proposition \ref{big-pretzel}, we 
distinguish the two cases $\dim N=1$ and $\dim N\geq 2$.

In the first case, $N$ is spanned by a vector $e=(a, w)\in \R^n\oplus W$ in which $a=(a_1,\ldots ,a_n)$ satisfies $a_j>0$ for all $1\leq j\leq n$. Take  $v\in N\cap C\setminus N\cap W$, then $v=t(a, w)$ for $t>0$, so that $d_{N\cap C}(v)=0$. 
We  already know that $v_j+\tau_j(v)\geq 0$ for all $1\leq j\leq n$. So, to prove the lemma, it suffices to show that 
$v_j+\tau_j(v)>0$ for $1\leq j\leq n$ and $v\in N\cap C\setminus N\cap W$ close to $0$.  Arguing by contradiction we assume that there exists a sequence $t_k\to 0$ such  that if $v^k=t_ka$, then $v^k_i+\tau_i(v^k)=0$ for some index $1\leq i\leq n$. Then 
$$0\neq \dfrac{a}{\abs{a}_0}=\dfrac{v_i^k}{\abs{v^k}_0}=-\dfrac{\tau_i(v^k)}{\abs{v^k}_0},$$
which leads to   a contradiction since the right-hand side converges to $0$ in view of $\tau (0)=0$ and $D\tau (0)=0$. Consequently, $d_C(v+\tau (v))=0$ for all $v\in  N\cap C\setminus N\cap W$ which are close to $0$.\par

In the case $\dim N\geq 2$, we use the notation introduced in the proof of Proposition \ref{big-pretzel}. If $v=(v_1,\ldots ,v_k, w)\in 
 N\cap C\setminus N\cap W$, then, in view of (1) in the proof of Proposition \ref{big-pretzel}, $d_{N\cap C}(v)=\#\{1\leq i\leq k\, \vert \, v_i=0\}$ and  there exists at least one index $1\leq i\leq k$ for which  $v_i>0$. This implies,  in particular,  that 
 $v_j>0$ for all $k+1\leq j\leq n$.
 Moreover,  in view of Lemma \ref{cone1}, the good complement $Y$ of $N$ is contained in $\{0\}^m\oplus \R^{n-m}\oplus W$. From this we conclude that $v_j+\tau_j (v)=v_j$ for all $1\leq j\leq m$. Hence in order to finish the proof it suffices to show that $v_j+\tau_j(v)>0$ for all $m+1\leq j\leq n$. In order to verify  this we introduce the sc-linear map $T\colon N\to \R^k$ defined by 
 $T(e^l)=\ov{e}^l$ for $1\leq l\leq k:=\dim N$ where  $\ov{e}^1, \ldots ,\ov{e}^k$ of $\R^k$. Then $T(N\cap C)=C':=[0,\infty )^m\oplus \R^{k-m}$ and  $d_{N\cap C}(v)=d_{C'}(T(v)).$
 
 
We consider  the map $g\colon C'\to \R^n\oplus W$,  defined by 
$$g(v')=T^{-1}(v')+\tau (T^{-1}(v'))$$ 
for $v'=(v_1', \ldots ,v'_k)\in C'$ close to $0$. Since $v+\tau (v)\in C$, $g(v')\in C$ for $v'\in C'$ close to $0$. 
We prove our claim by showing that $g_j(v')>0$ for $m+1\leq j\leq n$  and nonzero $v'\in C'$ close to $0$.
Arguing by contradiction we assume that there exists a point $v'\in C'$  different from  $0$ at which $g_j(v')=0$ for some $m+1\leq j\leq n$. 
We have  $v_i'>0$ for some $1\leq i\leq m$ so that  $v'+t\ov{e}^i\in C'$ for $\abs{t}$ small.  Then we compute, 
$$\dfrac{d}{dt}g_j(v'+t\ov{e}^i)\vert_{t=0}=b^i_j+D\tau_j(v)T^{-1}\ov{e}^i=b^i_j+D\tau_j(v)e^i.$$
Since the map $\tau$ is of class $C^1$ and $D\tau (0)=0$ and $b^i_j>0$ we conclude that the derivative is positive, and hence the function $t\mapsto g_j(v'+t\ov{e}^i)$ is strictly increasing for $\abs{t}$ small.  By assumption $g_j(v')=0$, hence  $g_j(v'+t\ov{e}^i)<0$ for $t<0$ small, contradicting  $g_j(v'+t\ov{e}^i)\geq 0$ for $\abs{t}$ small.

Consequently, $v_j+\tau_j(v)>0$ for all $m+1\leq j\leq n$ and all $v\in N\cap C\setminus N\cap W$ sufficiently close to $0$ and since $v_j+\tau_j(v)=v_j$ for $1\leq j\leq m$, we conclude $d_{N\cap C}(v)=d_C(v+\tau (v))$ 
for $v\in N\cap C\setminus N\cap W$ close to $0$. The proof of Lemma \ref{big-pretzel_1a} is complete. 

\qed \end{proof}



\subsection{Proof of Lemma \ref{new_lemma_Z}}\label{pretzel-B}
We recall the statement for the convenience of the reader

\begin{lemma}\label{new_lemma_Z_1}
The kernel  $\wt{K}:=\ker DH(0)\subset \R^{n}$ of the linearization $DH(0)$ is in good position to the partial quadrant $\wt{C}=[0,\infty)^{k}\oplus \R^{n'-k}$ in $\R^{n'}$. Moreover, there exists a good complement $Z$ of $\wt{K}$ in $\R^{n'}$, so that 
$\wt{K}\oplus Z =\R^{n'}$, having the property that $Z\oplus W'$ is a good complement of $K'=\ker Dg(0)$ in $E'$, 
$$E'=K'\oplus ( Z\oplus W').
$$
\end{lemma}
\begin{proof}
The space $E'=\R^{n'}\oplus W'$ is equipped with the norm $\abs{\cdot }_0$. We use the  equivalent norm defined by $\abs{(a, w)}=\max\{ \abs{a}_0,\abs{w}_0\}$ for $(a, w)\in \R^{n'}\oplus W'$. The kernel $K'=\ker Dg(0)\subset \R^{n'}\oplus W'$ is in good position to the partial quadrant $C'=[0,\infty )^k\oplus \R^{n'-k}\oplus W'$ and $Y'$ is a good complement of $K'$ in $E'$, so that $K'\oplus Y'=E'$.

We recall that by the definition of good position, there exists $\varepsilon>0$ such that,  
if  $k\in K'$ and $y\in Y'$ satisfy 
\begin{equation}\label{again_good_1}
\abs{y}\leq \varepsilon \abs{k},
\end{equation}
then 
\begin{equation}\label{again_good_2}
\text{$k+y\in C'$\quad  if and only if\quad  $k\in C'$.}
\end{equation}




Let $Y_0$ be an algebraic complement of $Y'\cap W'$ in  $Y'$, where we have  identified  $W'$ with $\{0\}^{n'}\oplus W'$, so that $Y'=Y_0\oplus (Y'\cap W').$


We claim that the projection $P'\colon \R^{n'}\oplus W'\to \R^{n'}$, restricted to $Y_0$,  is injection. Indeed, assume that $x=(a, w)\in Y_0\subset \R^{n'}\oplus W'$ satisfies that  $P'(x)=0$. Then $a=0$ and $x=(0, w)$. Since $x=(0, w)\in Y'\cap W'$ and $Y_0\cap (Y'\cap W')=\{0\}$, we conclude that $x=0$ so  that indeed $P'\vert Y_0$ is an injection. 


Introducing the subspace  $Z'=P'(Y_0)$, we claim that $\R^{n'}=\wt{K}+Z'$.  To verify the claim, we take $a\in \R^{n'}$ and let $x=(a, 0)$. Since $\R^{n'}\oplus W'=K'\oplus Y'$, there are unique elements $k\in K'$ and $y\in Y'$ such that $x=k+y$. In view of Lemma 3.44,
the element $k\in K'$ is of the form $k=(\alpha, D\delta (0)\alpha)$ for a unique $\alpha \in \wt{K}$. The element $y\in Y'$ is of the form $y=(b, w)\in \R^{n'}\oplus W'$. Hence 
$x=(a, 0)=k+y=(\alpha , D\delta (0)\alpha)+(b, w)=(\alpha+b, D\delta (0)\alpha+w)$, showing $a=\alpha+b$. On the other hand, since $Y'=Y_0\oplus (Y'\cap W')$,  we have  $(b, w)=(b, w_1)+(0, w_2)$ for $w_1, w_2\in W'$ such that $(b, w_1)\in Y'$ and $(0, w_2)\in Y'\cap W'.$ Hence $b=P'(b, w_1)\in Z'$ and, therefore, $a=\alpha +b\in \wt{K}+Z'$ as claimed. 


From this it follows that  $\dim Z'\geq n'-\dim \wt{K}$ and we  choose a subspace $Z$ of $Z'$ of dimension  $\dim Z=n'-\dim \wt{K}$, so that $\R^{n'}=\wt{K}\oplus Z$.  Recalling that  the projection $P'\colon Y_0\to Z'$ is an isomorphism, we have $(P')^{-1}(Z)\subset Y'$.


We shall prove $\wt{K}$ is in good position to the partial quadrant $\wt{C}=[0,\infty )^k\oplus R^{n'-k}$ in $\R^{n'}$ and $Z$ is a good complement of $\wt{K}$, so that 
$\wt{K}\oplus Z=\R^{n'}$.  In view of  the fact that the map $(P')^{-1}\colon Z'\to Y_0$ is an isomorphism and $Z\subset Z'$, there exists a constant $A$ such that 
\begin{equation}\label{again_good_3}
\text{$\abs{(P')^{-1}(z)}\leq A\abs{z}$\quad  for all $z\in Z$.}
\end{equation}
Moreover, by Lemma \ref{new_lemma_relation}, the map $L\colon K'\to \wt{K}$, defined by $L(\alpha , D\delta (0)\alpha)=\alpha$,  is an isomorphism, and hence there exists a constant $B$ such that 
\begin{equation}\label{again_good_4}
\text{$\abs{\alpha}=\abs{L(\alpha ,D\delta  (0)\alpha)}\leq B\abs{(\alpha ,D\delta (0)\alpha)}$ \quad  for all $\alpha\in \wt{K}$.}
\end{equation}   


We choose $\varepsilon'>0$ such that $\varepsilon' \cdot A\cdot B<\varepsilon$, where 
$\varepsilon>0$ is the constant from the condition \eqref{again_good_1}. 
We claim that if  $z\in Z$ and $\alpha\in \wt{K}$ satisfy 
\begin{equation}\label{again_good_5}
\abs{z}\leq \varepsilon' \abs{\alpha}, 
\end{equation} 
then 
\begin{equation}\label{again_good_6}
\text{$z+\alpha \in \wt{C}$\quad  if and only if \quad $\alpha \in \wt{C}.$}
\end{equation}
Since $z\in Z\subset Z'$, there exists a unique $w\in W'$ such that $(P')^{-1}(z)=(z, w)\in Y_0$. 
Then we estimate,  using \eqref{again_good_3}, \eqref{again_good_5}, and then \eqref{again_good_4}, 
$$\abs{(z, w)}=\abs{(P')^{-1}(z)}\leq A\abs{z}\leq \varepsilon' A\cdot B\abs{(\alpha ,D\delta  (0)\alpha)}<\varepsilon  \abs{(\alpha ,D\delta (0)\alpha)}.$$
Thus, $(z, w)\in Y_0\subset Y'$ and $(\alpha, D\delta (0)\alpha )\in K'$ satisfy the estimate \eqref{again_good_1} and it follows that 
\begin{equation}\label{again_good_7}
\text{$(z, w)+(\alpha, D\delta (0)\alpha )\in C$ \quad if and only if\quad  $(\alpha, D\delta (0)\alpha)\in C'.$}
\end{equation}
Since $(z, w)+(\alpha, D\delta (0)\alpha)=(z+\alpha ,w+D\delta (0)\alpha)\in \R^{n'}\oplus W'$, 
\eqref{again_good_7} implies that $z+\alpha\in \wt{C}$ if and only if $\alpha \in \wt{C}$, proving our claim \eqref{again_good_6} and we see that $Z$ is a good complement of $\wt{K}$ in $\R^{n'}$.


Next we set 
$$\ov{Y}=Z\oplus W'$$
and claim that $K'\oplus \ov{Y}=\R^{n'}\oplus W'$ and that $\ov{Y}$ is a good complement of $K'$ in $E'=\R^{n'}\oplus W'.$ We first verify that $\R^{n'}\oplus W'=K'+\ov{Y}$. Take $(a, w)\in \R^{n'}\oplus W'$.  Then, since 
$\R^{n'}\oplus W'=K'\oplus Y'$, there are unique elements $(\alpha, D\delta (0)\alpha)\in K'$, where $\alpha \in \wt{K}$,   and $(b, w_1)\in Y'$ such that 
\begin{equation}\label{again_good_8}
(a, w)=(\alpha , D\delta (0)\alpha)+(b, w_1)\in K'\oplus Y'.
\end{equation}
Hence $a=\alpha +b.$ Since $\R^{n'}=\wt{K}\oplus Z$, we may decompose $b$ as $b=\alpha_1+b_1$ with $\alpha_1\in \wt{K}$ and $b_1\in Z$  and then \eqref{again_good_8} can be written as 
\begin{equation*}
\begin{split}
(a, w)&=(\alpha , D\delta (0)\alpha)+(b, w_1)=(\alpha , D\delta (0)\alpha)+(\alpha_1+b_1, w_1)\\
&=(\alpha , D\delta (0)\alpha)+(\alpha_1, D\delta (0)\alpha_1)+(b_1, w_1-D\delta (0)\alpha_1)\\
&=(\alpha+\alpha_1, D\delta (0)(\alpha+\alpha_1))+(b_1, w_1-D\delta (0)\alpha_1)
\end{split}
\end{equation*}
where  $(\alpha+\alpha_1, D\delta (0)(\alpha+\alpha_1))\in K'$ (since $\alpha+\alpha_1\in \wt{K}$) and $(b_1, w-D\delta (0)\alpha_1)\in Z\oplus W'=\ov{Y}$ (since $b_1\in Z$). Hence $\R^{n'}\oplus W'=K'+\ov{Y}$ as claimed.

If $(\alpha ,D\delta (0)\alpha)\in K'\cap \ov{Y}=K'\cap (Z\oplus W')$, then $\alpha \in \wt{K}\cap Z$, so that $\alpha=0$ and $K'\cap \ov{Y}=\{0\}$ and we  have proved that  $Z\oplus \ov{Y}=\R^{n'}\oplus W'$. 



Finally, we shall show that $\ov{Y}=Z\oplus W'$ is a good complement of $K'$ in $\R^{n'}\oplus W'$.  Recalling the isomorphism $L\colon K'\to \wt{K}$, $L(\alpha, D\delta (0)\alpha)=\alpha$, there exists a constant $M$ such that $\abs{L^{-1}(\alpha)}\leq M\abs{\alpha}$, i.e.,  
$$\text{$\abs{(\alpha ,D\delta (0)\alpha)}\leq M\abs{\alpha}$\quad  for all $\alpha\in \wt{K}$.}$$ 

We choose $\varepsilon''>0$ such that $\varepsilon'' M<\varepsilon'$ where $\varepsilon'$ is defined in \eqref{again_good_5}. We shall show that if 
$(\alpha, D\delta (0)\alpha)\in K'$ and $(a, w)\in Z$
satisfy the estimate
\begin{equation}\label{again_good_9}
\abs{(a, w)}\leq \varepsilon'' \abs{(\alpha, D\delta (0)\alpha)},
\end{equation}
then 
\begin{equation}\label{again_good_10}
\text{$(a, w)+(\alpha, D\delta (0)\alpha)\in C'$\quad if and only if $(\alpha, D\delta (0)\alpha)\in C'$.}
\end{equation}
Since $\abs{(a, w)}=\max\{\abs{a}_0, \abs{w}_0\}\geq \abs{a}$, we conclude from  \eqref{again_good_10} and 
\eqref{again_good_9} the estimate
$$\abs{a}\leq \abs{(a, w)}\leq \varepsilon'' \abs{(\alpha, D\delta (0)\alpha)}\leq \varepsilon'' M\abs{\alpha}.$$
In view of  \eqref{again_good_5} and 
\eqref{again_good_6}, 
$$\text{$a+\alpha \in \wt{C}$\quad if and only if $\alpha \in \wt{C}$}.$$
This is equivalent to 
$$\text{$(a+\alpha, w+D\delta (0)\alpha)\in C'$ \quad if and only if $(\alpha, D\delta (0)\alpha)\in C'.$}$$
Hence \eqref{again_good_10} holds and the proof that $\ov{Y}=Z\oplus W'$ is a good complement of $K'$ is complete. The proof of Lemma \ref{new_lemma_Z} is finished.

\qed \end{proof}

\subsection{Proof of Lemma \ref{good_pos} }\label{geometric_preparation}
We recall the statement for the convenience of the reader.
\begin{lemma}\label{good_pos_1}
Let $C\subset E$ be  a partial quadrant in the  sc-Banach space $E$ and $N\subset E$ a finite-dimensional smooth subspace in good position to $C$ and let $Y$ be a good complement of $N$ in $E$, so that $E=N\oplus Y$.
We assume that $V\subset N\cap C$ is a relatively open neighborhood
of $0$ and $\tau\colon V\rightarrow Y_1$ a map of class $C^1$ satisfying $\tau(0)=0$ and $D\tau(0)=0$.


Then there exists a relatively open neighborhood $V'\subset V$ of $0$ such that the following holds.
\begin{itemize}
\item[{\em (1)}]\ $v+\tau(v)\in C_1$ for $v\in V'$.
\item[{\em (2)}]\ For every $v\in V'$,  the Banach space $Y=Y_0$ is a topological complement of the linear subspace $N_v=\{n+D\tau(v)n\, \vert \, n\in N\}$.
\item[{\em (3)}]\ For every $v\in V'$,  there exists a  constant $\gamma_v>0$ such  that  if  $n\in N_v$ and $y\in Y$ satisfy 
$\abs{y}_0\leq \gamma_v\cdot \abs{n}_0$,  then  $n\in C_x$ if and only if  $n+y\in C_x$ are equivalent, where $x=v+\tau (v)$. 
\end{itemize}
\end{lemma}


\begin{proof}[{\bf Proof of Lemma \ref{good_pos}}]
We shall use the notations of Proposition 
\ref{big-pretzel}
Since  the smooth finite dimensional subspace $N$ of $E$ is in good position to $C$,  and $Y$ is its good complement so that  $E=N\oplus Y$,  there exists a constant $\gamma>0$ such that if $n\in N$ and $y\in Y$ satisfy
\begin{subequations}
\begin{gather}
\abs{y}_0\leq \gamma \abs{n}_0\label{eq_lemma3.55_1}\\
\text{then}\ \ 
\text{$y+n\in C$\quad if and only if\quad  $n\in C$.} \label{eq_lemma3.55_2}
\end{gather}
\end{subequations}
\noindent(1)\,  The $C^1$-map $\tau\colon V\to Y_1$ satisfies $\tau (0)=0$ and $D\tau (0)=0$, so that  
$$\lim_{\abs{v}\to 0}\dfrac{\abs{\tau (v)}_0}{\abs{v}_0}=0.
$$
Consequently, there exists a relatively open neighborhood $V'\subset V$ of $0$ in $N$ such that $\abs{\tau (v)}_0\leq \gamma \abs{v}_0$ for all $v\in V'$.  Since $V'\subset V\subset C$, we conclude from \eqref{eq_lemma3.55_2} that 
$v+\tau (v)\in C$ for all $v\in V'$.  In addition, since  $V'$ consists of smooth points and $\tau (v)\in Y_1$,  we have $v+\tau (v)\in C_1$ for all $v\in V'$.\par

\noindent  (2)\,  By assumption,  $E=N\oplus Y$ and $D\tau (v)n\in Y$ for all $n\in N$. If   $x=n+y\in N\oplus Y\in E$, then $y=(n+D\tau (v)n)+(y-D\tau (v)n)$, showing that $E=N_v +Y$.  If $(n+D\tau (v)n)+y=(n'+D\tau (v)n')+y'$ for some $n, n'\in N$ and $y, y'\in Y$, then $n-n'=(y'-y)+D\tau (v)(n'-n)\in N\cap Y$. Hence $n=n'$ and $y=y'$, showing that $N_v\cap Y=\{0\}$ and hence $E=N_v\oplus Y$. That the subspace $Y$ is a topological complement of $N_v$ follows from the fact that $N_v$ is a finite dimensional subspace of $E$. \par


\noindent (3)\,  
Without loss of generality we may assume $E=\R^n\oplus W$ and $C=[0,\infty)^n\oplus W$. 
We recall that for  $x\in C$, the set $C_x$ is defined by   
$$
C_x=\{(a, w)\in \R^n\oplus W\ \vert \ \text{$a_i\geq 0$ for all $1\leq i\leq n$ for which $x_i=0$}\},
$$ 
and if $x_i>0$ for all $\leq i\leq n$, we set $C_x=E$. Clearly, if $x=(0, w)\in \R^n\oplus W$, then $C_x=C$.\par

If $v=0$, then $x=v+\tau (v)=0$, so that $C_x=C$ and the statement of the corollary follows from the fact that $N_v=N$ and $N$ is in good position to $C$ having the good complement $Y$.

In order to prove the statement for $v\neq 0$ we distinguish thew  two cases $\dim N=1$ and $\dim N>1$. In 
the first case, the proof of Lemma \ref{big-pretzel_1a} shows that $v_j+\tau_j (v)>0$ for all $1\leq j\leq n$.
This implies that $C_x=E$ and that, in view of (2),  $Y$ is a good complement of $N_v$ with respect to $C_x$.\par


 In the second case $\dim N>1$, and we denote by $\wt{N}$ the  algebraic complement of $N\cap W$ in $N$,  where $W$ is identified with $W=\{0\}^n\oplus W$,  so that $N=\wt{N}\oplus (N\cap W)$.   We may assume,  after a linear change of coordinates, that the following holds. 
\begin{itemize}
\item[(a)]\ The linear subspace $\wt{N}$ is spanned by the vectors $e^j$ for $1\leq j\leq m=\dim \wt{N}$ of the form 
$e^j=(a^j, b^j, w^j)$ where $a^j$ are the vectors of the standard basis in $\R^m$, $b^j=(b^j_1, \ldots ,b^j_{n-m})$ satisfy $b^j_i>0$ for all $1\leq i\leq n-m$, and $w^j\in W$. 
\item[(b)]\ The good complement $Y$ of $N$  in $E$  is contained in $\{0\}^m\oplus \R^{n-m}\oplus W.$
\end{itemize}
Denoting by   $e^j=(0, w^j)\in \{0\}^n\cap W$, $m+1\leq j\leq k=\dim N$, a basis of  $N\cap W$, the vectors $e^1,\ldots ,e^k$  form a basis of $N$.   
We choose $0<\varepsilon<\gamma/2$ where $\gamma$ is the constant from \eqref{eq_lemma3.55_1} and define the open neighborhood $V''$ of $0$ in $N\cap C$ consisting  of points $v\in V'$ satisfying $\abs{D\tau (v)n}_0<\varepsilon\abs{n}_0$ for all $n\in N$.  


We consider points  $v\in V'$ belonging to $N\cap W$ where we identify $W$ with $\{0\}^n\oplus W$.  Hence  $v$ is  
of the form $v=(0, w)\in \{0\}^n\oplus W$.  Then $\abs{\tau(v)}_0\leq \gamma \abs{v}_0$ and,  since $v\in C$,  we conclude that $v+\tau (v)$ and $v-\tau (v)$ belong to the partial quadrant $C$. This implies that $\tau_i(v)=0$ for all $1\leq i\leq n$ and  $C_{x}=C$ where $x=v+\tau (v)=(0, w')$. We choose a positive constant $\gamma_v$ such that $\gamma_v(1+\varepsilon)+\varepsilon <\gamma$.  Abbreviating $h=n+D\tau (v)n\in N_v$ for some $n\in N$ and taking $y\in Y$, we assume that 
\begin{equation}\label{eq_lemma3.55_3}
\abs{y}_0\leq \gamma_0\abs{h}_0=\gamma_v \abs{n+D\tau (v)n}_0.
\end{equation}
 
 We claim that $y+h\in C_x$ if and only if $h\in C_x$. Suppose that $y+h=y+n+D\tau (v)n\in C_x=C$. Then we estimate using \eqref{eq_lemma3.55_3}, 
\begin{equation}\label{eeqq1}
\begin{split}
\abs{y+D\tau (v)n}_0&\leq \abs{y}_0+\abs{D\tau (v)n}_0\leq \gamma_v\abs{h+D\tau (v)n}+\abs{D\tau (v)n}_0\\
&\leq (\gamma_v+\varepsilon\gamma_v+\varepsilon)\abs{n}_0\leq \gamma \abs{n}_0.
\end{split}
\end{equation}

Since $y+D\tau (v)n\in Y$ and by assumption $y+h=y+D\tau (v)n+n\in C_x=C$, we deduce from \eqref{eeqq1}  and 
\eqref{eq_lemma3.55_2} that $n\in C$. 
Then the estimate $\abs{D\tau (v)n}_0\leq \varepsilon \abs{n}_0<\gamma\cdot \abs{n}_0$ and again \eqref{eq_lemma3.55_2}, imply that $h=n+D\tau (v)n\in C$, as claimed.\\
Conversely, the  assumption  that $h=n+D\tau (v)n\in C$ implies, in view of  $\abs{D\tau (v)h}_0\leq \abs{h}_0$ and \eqref{eq_lemma3.55_2}, that $n\in C$. Then using  \eqref{eeqq1} we find hat $y+D\tau (v)n +h=y+h\in C$. We have proved that if $h\in N_v$ and $y\in Y$ satisfy $\abs{y}_0\leq \gamma_v\abs{h}_0$, then $y+h\in C_x$ if and only if $h\in C_x$.\par

Finally we consider points $v=(v_1,\ldots ,v_n, w)\in N\cap C\setminus N\cap W$. Then $v_i>0$ for some $1\leq i\leq m$ and $v_j>0$ for all $m+1\leq j\leq k$. Moreover, in view of the proof of the statement (1), 
$\abs{\tau (u)}_0\leq \gamma\abs{v}_0$ which implies that $v+\tau (v)\in C$ if $v$ is close to $0$.
It follows from the proof of Lemma \ref{big-pretzel_1a} that  $v_j+\tau_j (v)>0$ for all $m+1\leq j\leq n$. Abbreviating  $x=v+\tau (v)$ and denoting by $\Lambda_x$ the set of indices $1\leq j\leq n$ for which $x_j>0$,  we conclude 
$$C_x=\{(a, w)\in \R^n\oplus W\, \vert \, \text{$a_j\geq 0$ for all $1\leq j\leq m$ satisfying $j\not \in \Lambda_x$}\}.$$
Recall that $N_v=\{n+D\tau (v)n\, \vert \, n\in N\}$ and $E=N_v\oplus Y$ in view of the statement (2).  Now the inclusion $Y\subset  \{0\}^m\oplus \R^{n-m}\oplus W$ and the definition of $C_x$ above show that, 
if $h=n+D\tau (v)n\in N_v$ and  $y\in Y$, then $y+h\in C_x$ if and only if $h\in C_x$.  This completes the proof of Lemma \ref{good_pos}.

\qed \end{proof}


\subsection{Diffeomorphisms Between Partial 
Quadrants }\label{finite_partial_inverse}

In the sections \ref{finite_partial_inverse} and \ref{implicit_finite_partial_quadrants} 
we shall prove an inverse function theorem and an implicit function theorem for smooth maps defined on partial quadrants in $\R^n$. We recall that the closed subset $C\subset \R^n$ is a partial quadrant, if there exists an isomorphism $L$ of $\R^n$ mapping $C$ onto $L(C)=[0,\infty)^k\oplus \R^{n-k}$ for some $k$.
We begin  with a definition.
\begin{definition}[{\bf Class $C^1$}] Let $C$ be a partial quadrant in $\R^n$ and $f\colon U\rightarrow \R^m$ a map defined on a relatively open subset $U\subset C$. The map  $f$ is said to be of {\bf class  $C^1$}  if,  for every $x\in U$,  there exists a bounded linear map $Df(x)\colon \R^n\rightarrow \R^m$
such that
$$
\lim_{x+h\in U,h\to  0} \dfrac{ \abs{f(x+h)-f(x)-Df(x)h}}{\abs{h}}=0,
$$
and,  in addition,  the map 
$$Df\colon U\to {\mathscr L}(\R^n, \R^m), \quad x\mapsto Df(x),$$
is continuous.
\end{definition}
We note that the tangent 
$TU=U\oplus {\mathbb R}^n$ is a relatively open subset of the partial quadrant $C\oplus \R^n$ and the map 
$Tf\colon TU\rightarrow T\R^m$,  defined by 
$$Tf(x,h)=\bigl(f(x), Df(x)h ),$$
is continuous. If the maps $f$ and $Tf$ are of class $C^1$, then  we say that $f$ is of class $C^2$. Inductively, the map $f$ is $C^k$ if the maps $f$ and $Tf$ are of class $C^{k-1}$.  Finally, $f$  is called smooth 
(or $C^\infty$) if  $f$ is of class $C^k$ for all $k\geq 1$.

We consider the following situation.  Assume  $C$ is  a partial quadrant in $\R^n$ and $U\subset C$  a relatively open neighborhood of $0$ in $C$. Let $f\colon U\to C$ be  a smooth map such that $f(0)=0$ and $Df(0)\colon \R^n\to \R^n$ an isomorphism. 
Even if $Df(0)C=C$ one cannot guarantee that the image $f(O)$  of an open neighborhood $O$ of $0$ in $C$  is an open neighborhood of $0$ in $C$ as Figure \ref{fig:pict6}  illustrates.

\begin{figure}[htb]
\begin{centering}
\def\svgwidth{69ex}
\input{pict6.pdf_tex}
\caption{The boundary tangents at $(0,0)$ are the $x-$ and $y$-axis, but the domain in the right picture is not an open neighborhood of $(0,0)$.}
\label{fig:pict6}
\end{centering}
\end{figure}





Our aim in this section is to derive an inverse and implicit function theorem in this context.


\begin{theorem}[{\bf Quadrant Inverse Function Theorem}]\label{QIFT}
We assume that $C$ is a partial quadrant in ${\mathbb R}^n$ and $U\subset C$ a relatively open neighborhood of $0$, and consider  a smooth map  $f\colon U\rightarrow \R^n$ satisfying $f(U)\subset C$ and having the following properties:
\begin{itemize}
\item[{\em (1)}]\  $f(0)=0$ and $Df(0)C=C$.
\item[{\em (2)}]\  $d_C(x)=d_C(f(x))$ for every $x\in U$.
\end{itemize}
Then there exist two relatively open neighborhoods $U'$ and $V'$ of $0$ in $C$  such that $U'\subset U$ and the map 
$$f\colon U'\rightarrow V'$$ is a diffeomorphism.
\end{theorem}


From $\R^n=C-C$ and $Df(0)C=C$,  it follows that $Df(0)\colon \R^n\to \R^n$ is an isomorphism.  Therefore, it suffices to study the map $g\colon U\to C$, defined by 
$$g(x)=Df(0)^{-1}f(x).$$
The map $g$ has  the same properties (1) and (2), but has the simplifying feature that 
$Dg(0)={\mathbbm1}$. 
Theorem \ref{QIFT} is a consequence of the following proposition.


\begin{proposition}\label{hongkong}
We assume that $C$ is a partial quadrant in ${\mathbb R}^n$ and $U\subset C$ a relatively open convex neighborhood of $0$, and let $f\colon U\rightarrow C$ be a smooth map having the following properties:
\begin{itemize}
\item[{\em (1)}]\ $f(0)=0$.
\item[{\em (2)}]\ $\abs{Df(x)-{\mathbbm 1}}\leq 1/2$ for all $x\in U$.
\item[{\em (3)}]\  $d_C(x)=d_C(f(x))$ for every $x\in U$.
\end{itemize}
Then $V:=f(U)$ is a relatively open neighborhood of $0$ in $C$,  and the map $f\colon U\rightarrow V$ is a diffeomorphism, that is, $f$ and $f^{-1}$ are smooth
in the sense defined above.
\end{proposition}


The proof of Proposition \ref{hongkong} follows from three lemmata proved below.


\begin{lemma}\label{new_lemma_3.73}
With  the assumptions  of Proposition \ref{hongkong} , 
the image  $V=f(U)$ is a relatively open subset of  $C$ and $f\colon U\rightarrow V$ is an open map. Moreover, 
\begin{equation}\label{new_equ_56}
\dfrac{1}{2}\abs{x-x'}\leq \abs{f(x)-f(x')}\leq \dfrac{3}{2} \abs{x-x'}, \quad \text{$x, x'\in U$}.
\end{equation}
\end{lemma}


\begin{proof}

Abbreviating $g(x)=x-f(x)$ and $G(x)= {\mathbbm 1}-Df(x)$, and using  the  convexity of the set $U$, we obtain the identity   
$$g(x')=g(x)+\biggl( \int_0^1G\bigl(\tau x'+(1-\tau )x\bigr)\ d\tau\biggr)\cdot (x'-x)$$
for $x, x'\in U$, from which the desired estimate 
\eqref{new_equ_56} follows, in view of  property (2).
We conclude, in particular,  that the map  $f\colon U\to V$ is injective.

In order to show that the image $V:=f(U)$ is a relatively open subset of $C$, we take a point $y'\in V$. Then $f(x')=y'$ for a unique $x'\in U$ and since 
$U$ is a relatively open subset of $C$, there exists $r>0$ such that $B(x', 3r)\cap C\subset U$. Here  we denoted by  $B(x', 3r)$  the open ball in $\R^n$ centered at $x'$ and having radius $3r$. We claim that $B(y', r)\cap C\subset V$.  In order to prove our claim, we first show that $\{y\in B(x', r)\cap C\, \vert \, d_C(y)=0\}\subset V$. To see this, 
we  take  a point $x_0\in B(x', 3r)\cap C$ such that $d_C(x_0)=0$ and let $y_0=f(x_0)$. By property (3), $d_C(y_0)=0$. Next  we take an arbitrary point $y_1\in B(y', r)\cap C$,  also satisfying $d_C(y_1)=0$,  and consider the points $y_\tau=(1-\tau )y_0+\tau y_1$ for $0\leq \tau \leq 1$.  Abbreviating  $\Sigma=\{\tau \in [0,1]\, \vert \, y_\tau\in V\}$ and $\tau^*=\sup \Sigma$, we assume that $\tau^*<1$.   
We note that $\Sigma$ is non-empty since $0\in \Sigma$ and $d_C(y_{\tau^*})=0$. Then we  choose a sequence $(\tau_n)\subset \Sigma$ such that $\tau_n\to \tau'$ and the  corresponding sequence of points $(y_{\tau_n})$  belonging  to $B(y', r)\cap C$ satisfying $y_{\tau_n}\to y_{\tau^*}$. Since $y_{\tau_n}\in V$, we find points $x_n\in U$ such that $f(x_n)=y_{\tau_n}$ and $d_C(x_n)=d_C(y_{\tau_n})=0$.
By \eqref{new_equ_56},  
$$\abs{x_n-x'}\leq 2\abs{f(x_n)-f(x')}=2\abs{y_{\tau_n}-y'}<2r$$
and 
$$\abs{x_n-x_m}\leq 2\abs{y_{\tau_n}-y_{\tau_m}},$$
which show that $(x_n)$ is a Cauchy sequence belonging to $B(x', 2r).$
Hence $(x_n)$ converges to some point $x^*$  belonging to $\ov{B}(x', 2r).$ By continuity of $f$,  $f(x^*)=y_{\tau^*}$, and the point $x^*$ belongs to the interior of $C$ since, by property (3),  $d_C(x^*)=d_C(y_{\tau^*})=0$.  Now  the classical  inverse function theorem implies that there are  open neighborhoods $W$ and $W'$ of $x^*$ and $y_{\tau^*}=f(x^*)$ both contained in the interior of $C$ such that the map $f\colon W\to W'$ has a continuous inverse $f^{-1}\colon W'\to W$. In particular, if  $\tau>0$ is small, then $y_{\tau^*+\tau}\in V$,  contradicting $\tau^*<1$. Summing up, we have proved our claim that 
$$\{y\in B(y', r)\cap C\, \vert \, d_C(y)=0\}\subset V.$$
Next we take any point $y\in B(y', r)\cap C$ satisfying $d_C(y)\geq 1$. We find sequences $(y_n)\subset B(y', r)\cap C$ and 
$(x_n)=(f^{-1}(y_n))$ satisfying  $d_C(y_n)=d_C(x_n)=0$ and $\abs{y_n-y}\to 0$. 
From  \eqref{new_equ_56}, we  have 
$\abs{x_n-x'}\leq 2\abs{y_n-y'}<2r$ and $\abs{x_n-x_m}\leq 2\abs{y_n-y_m}$
from which we deduce the convergence of the sequence $(x_n)$  to some point $x\in B(x', 3 r)\cap C.$  Hence  $f(x)=y$, implying that $y\in V$. This shows that  $ B(y', r)\cap C\subset V$ and that $V$ is a relatively open subset of $C$. 


Finally, to see that $f\colon U\to V$  maps relatively open subsets onto relatively open subsets,  we take an open subset $U'$ of $U$. Since $U'$ can be written as a union of relatively open convex subsets of $C$,   employing the previous arguments we conclude that $V'=f(U')$ is an open subset of $V$. The proof of
 Lemma \ref{new_lemma_3.73} is complete.

\qed \end{proof}

From the above lemma we obtain immediately the following corollary.
 \begin{corollary}\label{f_homeomrphism}
With the assumptions  of Proposition \ref{hongkong},  the map $f\colon U\to V$ is a smooth homeomorphism between the relatively open subsets $U$ and $V$ of $C$.
\qed
 \end{corollary}


We would like to point out that we cannot employ the usual implicit function theorem (it only applies at interior points). Therefore,  we must provide an argument  for the smoothness of the inverse map  $f^{-1}$. One could try to avoid work,  by first showing that $f$ can be extended to a smooth map defined on an open neighborhood
 of $0$ in ${\mathbb R}^n$. However,  our notion of smoothness does not stipulate that $f$ is near every point the restriction
 of a smooth map defined on an open subset of ${\mathbb R}^n$. This would complicate %
 the construction of a smooth extension.
 
 
 \begin{lemma}
With  the assumptions of Proposition \ref{hongkong},  the iterated tangent map $T^kf:T^kU\rightarrow T^kV$ is 
 a smooth homeomorphism.
 \end{lemma}
 
 \begin{proof}

The set $T^kC$ is a partial quadrant in $T^k\R^n$ and the sets $T^kU$ and $T^kV$ are relatively open subsets of $T^kC$. 
Then the iterated tangent map $T^kf\colon T^kU\rightarrow T^kV$ is smooth since the map $f\colon U\to V$ is smooth.  Hence we only have to show that $T^kf$ has an inverse 
$(T^kf)^{-1}\colon T^kV\to T^kU$ which is continuous. 
 In order to prove this we proceed by induction starting with $k=1$.  
 We introduce the map $\Phi_1\colon TV\to TU$, defined by 
 $$\Phi_1(y,l)=\bigl( f^{-1}(y),[ Df(f^{-1}(y)) ]^{-1}l).$$
 The map $\Phi_1$ is continuous since,  by Corollary \ref{f_homeomrphism},  the map $f\colon U\to V$ is a homeomorphism.
Moreover, 
 $$
 \Phi_1\circ Tf (x,h) = \bigl(f^{-1}(f(x)),[Df(f^{-1}(f(x))) ]^{-1}\circ Df(x)h\bigr)=(x,h), 
 $$
and similarly $Tf\circ \Phi_1=\mathbbm{1}$.  Hence $\Phi_1$ is an inverse of the tangent map $Tf$.  This  together with the continuity of $Tf$ and $\Phi_1$ show that $Tf$ is a homeomorphism, as claimed.

Now we assume that result holds for $k\geq 1$ and we show that 
$$
T^{k+1}f\colon T^{k+1}U\to T^{k+1}V
$$
 is a homeomorphism.  Recalling  that $T^{k+1}U=T^kU\oplus T^k\R^n$, we define the map 
\begin{gather*}
\Phi_{k+1}\colon T^kV\oplus T^k\R^n \to T^kU\oplus T^k\R^n, \\
\Phi_{k+1}(y, l)=\bigl((T^kf)^{-1}(y), [D(T^kf)((T^kf)^{-1}(y))]^{-1}l\bigr).
\end{gather*}
By the inductive assumption, the map $T^kf\colon T^kV\to T^kU$ is a homeomorphism and hence $\Phi_{k+1}$ is well-defined and continuous. 
Moreover, 
\begin{equation*}
\begin{split}
\Phi_{k+1}&\circ T^{k+1}f (x, h)=\Phi_{k+1}\bigl(T^kf(x), (D(T^kf))(x)h\bigr)\\
&=\bigl((T^kf)^{-1}\bigl(T^kf(x)\bigl),  [D(T^kf)((T^kf)^{-1}(T^kf(x)   ))]^{-1}(D(T^kf))(x)h\bigr)\\
&=\bigl(x,  [D(T^kf)(x)]^{-1}(D(T^kf))(x)h\bigr)=\bigl(x, h),
\end{split}
\end{equation*} 
and similarly $ T^{k+1}f\circ \Phi_{k+1}=\mathbbm{1}$. Hence the map $\Phi_{k+1}$ is a continuous inverse of the iterated tangent map $T^{k+1}f$. This completes the inductive step and the proof of the lemma.

\qed \end{proof}

\begin{lemma}\label{addd}
Let  $U$ be  a relatively open subset of a partial quadrant $C\subset {\mathbb R}^n$ and $f\colon U\rightarrow C$ a smooth map satisfying the assumptions of Theorem \ref{hongkong}.  We assume that the image $V=f(U)$ is a relatively open subset of $C$ and $f\colon U\rightarrow V$ a homeomorphism such that $Df(x)$ is invertible at every point $x\in U$. 
Then the inverse map $g=f^{-1}$ is of class $C^1$
 and its derivative at the point $y\in V$ is given by
 $$
 Dg(y) =[Df(g(y))]^{-1}.
 $$
 \end{lemma}
 
\begin{proof}

By assumption,  the map $f\colon U\to V$ is a homeomorphism. This implies that $g\colon V\to U$ is also a homeomorphism and the map 
$V\to {\mathscr L}(\R^n)$, defined by 
$$y\mapsto [Df(g(y))]^{-1},$$
is continuous.  Next we take  $y_0\in V$ and $h\in \R^n$ satisfying  $y_0+h\in V$. 
Then there are unique points  $x_0$ and $x_0+\delta\in U$ such that $f(x_0)=y_0$ and $f(x_0+\delta )=y_0+h.$
Recalling the abbreviation $g=f^{-1}$ we note that 
$g(y_0)=x_0$, $g(y_0+h)-g(y_0)=\delta$ and $f(x_0+\delta)-f(x_0)=h$ and compute,
\begin{equation*}
\begin{split}
&\dfrac{1}{\abs{h}}
\abs{g(y_0+h)-g(y_0)- Df(x_0)^{-1}h}\\
&\quad= \dfrac{1}{\abs{h}}\abs{\delta - Df(x_0)^{-1}(f(x_0+\delta )-f(x_0))}\\
&\quad =\dfrac{\abs{\delta}}{\abs{h}}\cdot 
\dfrac{1}{\abs{\delta}}\cdot  \abs{Df(x_0)^{-1}\bigl[ f(x_0+\delta)-f(x_0)-Df(x_0)\delta\bigr] }\\
\end{split}
\end{equation*}

From \eqref{new_equ_56} in Lemma \ref{new_lemma_3.73} we obtain 
$\frac{1}{2}\abs{\delta}\leq \abs{h}\leq \frac{3}{2}\abs{\delta}$ so that $\abs{h}\to 0$ if and only if $\abs{\delta}\to 0$. 
The limits vanish since $f$ is differentiable at $x_0$. The proof of  the lemma is finished.

\qed \end{proof}
 
Now we are in the position to prove Proposition \ref{hongkong}.

\begin{proof}[Proof of Proposition \ref{hongkong}]
Under the hypotheses of the proposition the previous discussion shows for every $k$,  
that $T^kf:T^kU\rightarrow T^kV$ satisfies the hypotheses of Lemma \ref{addd} for a suitable choice 
of data, i.e.  taking $T^kC$ as partial quadrant in $T^k{\mathbb R}^n$. Hence we conclude that $(T^kf)^{-1}$ is $C^1$,
which precisely means that $T^kg$ is $C^1$.  In  other words,  $g$ is of class $C^{1+k}$. Since $k$ is arbitrary we conclude that $g$ is $C^\infty$.
\qed \end{proof}

\subsection{An Implicit Function Theorem in Partial Quadrants}\label{implicit_finite_partial_quadrants}

We shall prove a version for the classical implicit function theorem for  maps defined on  partial quadrants. 


\begin{theorem}\label{help-you}

We assume that $U$ is relatively open neighborhood of $0$ in the  partial quadrant $C=[0,\infty)^k\oplus {\mathbb R}^{n-k}$ in $\R^n$, and consider a map 
$f\colon U\rightarrow {\mathbb R}^N$ of class $C^j$, $j\geq 1$,  satisfying $f(0)=0$. Moreover, we  assume that  
$Df(0)\colon \R^n\to \R^N $ is surjective  and the kernel $K:=\ker Df(0)$ is in  good position to $C$, and let  
$Y$ be a good  complement of $K$ in $\R^n$, so that $\R^n=K\oplus Y$. 

Then  there exist an open neighborhood $V$ of $0$ in the partial quadrant $K\cap C$, and a map  
$\tau\colon V\rightarrow Y$ of class $C^j$,  and  positive constants $\varepsilon, \sigma$ having the following properties.
\begin{itemize}
\item[{\em (1)}]\ $\tau(0)=0$, $D\tau(0)=0$, and $k+\tau(k)\in U$ if $k\in V$.
\item[{\em (2)}]\ If $k\in V$  satisfies  $\abs{k}\leq \varepsilon$, then $\abs{\tau(k)}\leq \sigma$.
\item[{\em (3)}]\ If $f(k+y)=0$ for $k\in V$ satisfying 
$\abs{k}\leq \varepsilon$  and $y\in Y$ 
satisfying $\abs{y}\leq\sigma$, then $y=\tau (k)$.
\end{itemize}

\end{theorem}

The proof will follow from several lemmata, where we shall us the notations 
$$x=(k, y)=k+y\in K\oplus Y$$
for $k\in K$ and $y\in Y$  interchangeably. 


The restriction $Df(0)\vert_Y\colon Y\rightarrow {\mathbb R}^N$ is an isomorphism and we abbreviate its inverse by   $L=\bigl[ Df(0)\vert_Y\bigr]^{-1}\colon Y\to \R^N$. Instead of studying the  solutions $f(y)=0$ we can as well study  the solutions of $\wt{f}(x)=0$, where $\wt{f}$ is the composition $\wt{f}=L\circ f$.It satisfies $D\wt{f}(0)k=0$ if $k\in K$ and 
$D\wt{f}(0)y=y$ if $y\in Y$ .  In abuse of notation we shall in the following  denote  the composition  $\wt{f}=L\circ f$ by the old letter $f$ again. 
We  may therefore assume that  
$$
f\colon U\cap (K\oplus Y)\rightarrow Y
$$
has the form 
\begin{equation}\label{new_equ_57}
f(k, y)=y-B(k, y),
\end{equation}
where 
\begin{equation}\label{oipu}
B(0,0)=0\quad  \text{and}\quad DB(0,0)=0.
\end{equation}


By $B_K(a)$ , we denote the open ball in $K$ of radius $a$ centered at $0$. Similarly, $B_Y(b)$ is  the open ball in $Y$ of radius $b$ centered  at $0$.


\begin{lemma}\label{LEMMA1}
There exist constants $a>0$ and $b>0$ such  that 
\begin{itemize}
\item[{\em (1)}]\ $\bigl( B_K(a)\oplus B_Y(b)\bigr)\cap C\subset U$.
\item[{\em (2)}]\ $\abs{B(k,y)-B(k,y')}\leq \dfrac{1}{2}\abs{y-y'}$ for 
all $k\in B_K(a)\cap C$ and $y,y'\in B_Y(b)\cap C$. 
\end{itemize}
Moreover, if $f(k,y)=f(k,y')$ for  $(k, y)$ and $(k,y')\in \bigl( B_K(a)\oplus B_Y(b)\bigr)\cap C$, then $y=y'$. 
\end{lemma}

\begin{proof}

It is clear that there exists constants $a, b>0$ such that 
(1) holds. 
To verify (2) we estimate for 
$(k, y)$ and $(k, y')\in \bigl( B_K(a)\oplus B_Y(b)\bigr)\cap C$, 
\begin{equation}\label{est_contraction_B}
\abs{B(k, y)-B(k, y')}\leq\biggl[ \int_0^1\abs{D_2B(k, sy+(1-s)y')}ds\biggr](y-y').
\end{equation}

In view of $DB(0, 0)=0$ we find smaller $a, b$ such that $ \abs{D_2B(k, y'')}\leq 1/2$ for all $(k, y'')\in \bigl( B_K(a)\oplus B_Y(b)\bigr)\cap C$.  So, 
\begin{equation*}
\abs{B(k, y)-B(k, y')}\leq \dfrac{1}{2}\abs{y-y'}
\end{equation*}
as claimed in (2).



If $f(k,y)=f(k,y')$, for two point $(k,y), (k,y')\in \bigl( B_K(a)\oplus B_Y(b)\bigr)\cap C$, 
then, $y-B(k, y)=y'-B(k, y')$ and using (2),  
$$\abs{y-y'}=\abs{B(k,y)-B(k,y')}\leq \dfrac{1}{2}\abs{y-y'}$$
which implies  $y=y'$. This completes the proof of Lemma \ref{LEMMA1}.

\qed \end{proof}

To continue with the proof of the theorem, we recall that $K$ is in  good position to $C$ and $Y$ is a good complement of $K$ in $\R^n$. Therefore,  there exists $\varepsilon>0$ such that for $k\in K$ and $y\in Y$ satisfying 
$\abs{y}\leq \varepsilon\abs{k}$  the statements
$k+y\in C$ and $k\in C$ are equivalent.


\begin{lemma}\label{LEMMA2}
Replacing $a$ by a smaller number, while keeping $b$,  we have
\begin{equation*}
\abs{B(k,y)}\leq \varepsilon \abs{k}\quad \text{ for all $k\in B_K(a)\cap C $ and $\abs{y}\leq \varepsilon \abs{k}$.}
\end{equation*}
\end{lemma}
\begin{proof}
First we replace $a$ by a  perhaps smaller number such that $\varepsilon a<b$. If $k\in B_K(a)\cap C $ and $\abs{y}\leq \varepsilon \abs{k}$, then $k+y\in C$  and $\abs{k+y}\leq (1+\varepsilon )\abs{k}<(1+\varepsilon )a$. Introducing 
$$c(a):= (1+\varepsilon)\cdot \max_{x\in B(1+\varepsilon )a)} \abs{DB(x)},$$
 we  observe that $c(a)\to 0$ as $a\to 0$,  in view of $DB(0, 0)=0$. Then we estimate for $k\in B_K(a)\cap C $  and $y\in Y$ satisfying $\abs{y}\leq \varepsilon \abs{k}$, 
 using that $B(0, 0)=0$, 
\begin{equation}\label{new_equ_70}
\begin{split}
\abs{B(k,y)}& \leq \biggl[ \int_0^1 \abs{DB(sk,sy)}\ ds\biggr] (k+y)\\
&\leq \max_{x\in B(1+\varepsilon )a)} \abs{DB(x)}(1+\varepsilon )\abs{k}=c(a)\abs{k}.
\end{split}
\end{equation}
The assertion follows if we choose $a$ so small that 
$c(a)\leq \varepsilon$.
\qed \end{proof}

Now we take $a>0$ so small that $c(a)\leq \varepsilon/2$ and keep the original $b>0$.
For every $k\in B_K(a)\cap C$, we set 
$$X_k:=\ov{B}_Y(\varepsilon \abs{k})\quad\text{and}\quad X=\bigcup_{k\in B_K(a)\cap C}X_k. $$
Clearly, $X\subset U$. By  Lemma \ref{LEMMA2},  
$B(k,\cdot )\colon X_k\to X_k$, and by 
 Lemma \ref{LEMMA1}, the map $B(k, \cdot )$ is a contraction. Therefore, it  has a unique fixed point $\tau (k)\in X_k$ satisfying 
$$\tau (k)=B(k, \tau (k)).$$
We claim that if   
$y\in B_Y(b)\cap C$ and $B(k, y)=y$ for some $k\in B_K(a)\cap C$, then 
$y=\tau (k)$. 

Indeed, since $B(k, \tau (k))=\tau (k)$, it follows that 
$f(k, y)=f(k,\tau (k))$,  and Lemma \ref{LEMMA1} shows that 
$y=\tau (k)$, as claimed.

\begin{lemma}
The map $\tau\colon B_K(a)\cap C \to B_Y(b)$  is continuous
and satisfies $\abs{\tau(k)}\leq \varepsilon  \abs{k}/2$.
\end{lemma}
\begin{proof}
In view of \eqref{new_equ_70}, the estimate 
$\abs{\tau (k)}\leq \varepsilon \abs{k}/2$ follows from 
$$
\abs{\tau (k)}=\abs{B(k, \tau (k)}\leq c(a)\abs{k}
$$
 and from the choice $c(a)\leq \varepsilon/2$.
 In order to prove continuity of $\tau$, we fix a point $k_0\in  B_K(a)\cap C$ and  use  Lemma \ref{LEMMA1}
 to estimate, 
\begin{equation*}
\begin{split}
\abs{\tau (k)-\tau (k_0)}&=\abs{B(k, \tau (k))-B(k_0, \tau (k_0))}\\
&\leq \abs{B(k, \tau (k))-B(k, \tau (k_0))}+\abs{B(k, \tau (k_0))-B(k_0, \tau (k_0))}\\
&\leq \dfrac{1}{2}\abs{\tau (k)-\tau (k_0)} +\abs{B(k, \tau (k_0))-B(k_0, \tau (k_0))}.
\end{split}
\end{equation*}
This implies, 
\begin{equation}\label{continuity_tau}
\begin{split}
\abs{\tau (k)-\tau (k_0)}&\leq 2\abs{B(k, \tau (k_0))-B(k_0, \tau (k_0))}\\
&\leq 2\biggl[ \int_0^1\abs{D_1B(sk+(1-s)k_0, \tau (k_0))}\ ds\biggr] \abs{k-k_0}\\
&\leq \varepsilon \abs{k-k_0},
\end{split}
\end{equation}
where we have used our choice of $a$ that $c(a)= (1+\varepsilon)\cdot \max_{x\in B(1+\varepsilon )a)} \abs{DB(x)}\leq \varepsilon/2$. This finishes the proof of the continuity of the map $\tau$.
\qed \end{proof}


\begin{lemma}
If $f\colon U\to \R^N$ is of class $C^j$, $j\geq 1$, then the map $\tau\colon B_K(a)\cap C \to B_Y(b)$ is also of class $C^j$.
\end{lemma}

\begin{proof}

We fix the  point $k\in B_K(a)\cap C$ and assume that  
$k+\delta k\in B_K(a)\cap C.$
Then we abbreviate 
\begin{align*}
A(\delta k)&:=\int_0^1\bigl(D_2B(k+\delta k, s\tau (k+\delta k)+(1-s)\tau (k))-D_2B(k, \tau (k))\bigr)\ ds\\
R(\delta k)&:=B(k+\delta k, \tau (k))-
B(k, \tau (k))-D_1B(k, \tau (k))\delta k.
\end{align*}
Using the fixed point property $\tau (k)=B(k,\tau (k))$ and 
$\tau (k+\delta k)=B(k+\delta k,\tau (k+\delta k))$ we compute,
\begin{equation*}
\begin{split}
&\tau (k+\delta k)-\tau (k)-D_1B(k,\tau (k))\delta k\\
&\quad =B(k+\delta k, \tau (k+\delta k))-B(k, \tau (k))-D_1B(k,\tau (k))\delta k\\
&\quad=\bigl[ B(k+\delta k, \tau (k))-B(k, \tau (k))-D_1B(k_0,\tau (k_0))\bigr] \\
&\quad\phantom{=}+
\bigl[ B(k+\delta k, \tau (k+\delta k)) -B(k+\delta k, \tau (k))\bigr] \\
&\quad=R(\delta k)+A(\delta k)\bigl[ \tau (k+\delta k)-\tau (k)\bigr]+D_2B(k, \tau (k))\bigl[ \tau (k+\delta k)-\tau (k)\bigr].
\end{split}
\end{equation*}
Therefore,
\begin{equation*}
\begin{split}
 \bigl[{\mathbbm 1}-D_2B(k, \tau (k))\bigr]&(\tau (k+\delta k)-\tau (k))-D_1B(k, \tau (k))\delta k\\
&=R(\delta k)+A(\delta k)(\tau (k+\delta k)-\tau (k)).
\end{split}
\end{equation*}
Now, $R(\delta k)/\abs{\delta k}\to 0$ and $A(\delta k)\to 0$ as $\abs{\delta k}\to 0$. Moreover, in view of  
\eqref{continuity_tau}, 
$\abs{\tau(k+\delta k)-\tau (k)}/\abs{\delta k}\leq \varepsilon \abs{\delta k}/\abs{\delta k}\leq \varepsilon$. 
Consequently,
$$
\lim_{\abs{\delta k}\to 0}\dfrac{1}{\abs{\delta k}}\abs{\tau (k+\delta k)-\tau (k)- \bigl[{\mathbbm 1}-D_2B(k, \tau (k))\bigr]^{-1}D_1B(k, \tau (k))\delta k}=0.
$$
This shows that the map $\tau$ is differentiable at the point $k$ and its  derivative $D\tau (k)\in {\mathscr L}(K, Y)$ is given by the familiar formula
$$D\tau (k)\delta k= \bigl[{\mathbbm 1}-D_2B(k, \tau (k_0))\bigr]^{-1} D_1B(k,\tau (k))\delta k.$$
The formula shows that $\tau \mapsto D\tau (k)$ is continuous 
since $\tau $ and $DB$ are continuous maps. Consequently,  the map  $\tau$ is of class $C^1$.


We also note that, differentiating $\tau (k)=B(k, \tau (k))$, we obtain 
\begin{equation*}
\begin{split}
D\tau(k)\delta k& = D_2B(k,\tau(k))D\tau(k)\delta k + D_1B(k,\tau(k))\delta k\\
&=DB(k,\tau(k))(\delta k, D\tau(k)\delta k). 
\end{split}
\end{equation*}
If now $f$ is of class $C^2$, we define the $C^1$-map 
$$
f^{(1)}\colon V\oplus K\oplus Y\oplus Y\to Y\oplus Y
$$
by 
\begin{equation*}
\begin{split}
f^{(1)}(k, h, y,\eta)&=\bigl( y-B(k, y), \eta -DB(k, y)(h, \eta)\bigr)\\
&=(y,\eta)-\bigl( B(k, y), DB(k,y)(h, \eta)\bigr)
\end{split}
\end{equation*}
and find by the same reasoning as before, using that  $D_2B(k, y)$ for small $(k,y)$ is contractive, that the associated family of fixed points
$$(k,h)\mapsto  (\tau(k),D\tau(k)h)$$
is of class $C^1$ near $(0,0)$. In particular, the map 
$\tau$ is of class $C^2$ near $k=0$. Proceeding by induction we conclude that $\tau$ is of class $C^j$ 
on a possibly smaller neighborhood $V$ of $0$ in $K$.

\qed \end{proof}
The proof of Theorem \ref{help-you} is finished.



\chapter{Manifolds and Strong Retracts}\label{chap4}
\label{section_tame_manifolds}

The previous chapter showed that  a solution set of a sc-Fredholm  is a sub-M-polyfold whose induced polyfold structure is equivalent to the structure of a finite dimensional smooth manifold with boundary with corners. In this chapter we shall study these objects in more details. 

\section{Characterization}\label{subsect_characterization}


A smooth manifold with boundary with corners is a paracompact Hausdorff   space $M$ which admits an atlas of smooth compatible quadrant charts $(V, \varphi, (U, C,\R^n))$, where $\varphi\colon V\to U$ is a homeomorphism 
from an open subset $V\subset M$ onto a relatively open set $U$ of the partial quadrant $C$ of $\R^n$.
A M-polyfold $X$ is a paracompact Hausdorff space which, in addition, is equipped with a sc-structure. This prompts the following definition.

\begin{definition}\index{D- Equivalent manifold structure}
A M-polyfold $X$ has a {\bf compatible smooth manifold structure with boundary with corners}, if  
it admits an atlas ${\mathcal A}$ consisting of sc-smoothly  compatible  charts 
$(V,\varphi, (U, C, \R^n))$, where $\varphi\colon V\to U$ is a sc-diffeomorphism from the open set $V\subset X$ onto the relatively open set $U\subset C$ of the partial quadrant 
$C$ in $\R^n$ (or in a finite-dimensional vector space $E$). 
\qed
\end{definition}


The transition maps between the  charts are sc-diffeomorphisms between relatively open subsets of partial quadrants in finite-dimensional vector spaces,  
and therefore are classically smooth maps, i.e., of class $C^\infty$. Consequently, the atlas ${\mathcal A}$ defines the structure of a smooth manifold with boundary with corners.
We also note that from the definition it follows immediately that a compatible smooth manifold structure with boundary with corners, if it exists, is unique.


The aim of Section \ref{subsect_characterization}
is the proof of the following characterization.
\begin{theorem}[{\bf Characterization}]
\label{XXX--}\index{T- Characterization of smooth manifolds}
For a tame M-polyfold $X$ the following statements are equivalent.
\begin{itemize}
\item[{\em (1)}]\  $X$
has a compatible smooth manifold structure with boundary with corners.
\item[{\em (2)}]\ $X_0=X_\infty$ and the identity  map ${\mathbbm 1}^1_0\colon X\rightarrow X^1$, $x\mapsto x$ is sc-smooth. Moreover, every point $x\in X$ is contained in a tame sc-smooth polyfold chart $(V, \psi ,(O, C, E))$ satisfying $\psi (x)=0\in O$, and the tangent space $T_0O$ is finite dimensional and in good position to the partial quadrant $C$ in the sc-Banach space $E$.
\end{itemize}\qed
\end{theorem}



\begin{remark}\label{r:r}
If $X_0=X_\infty$, the identity map 
${\mathbbm 1}^1_0\colon X\rightarrow X^1$ has as its inverse the identity map ${\mathbbm 1}^0_1\colon X^1\rightarrow X$. The map 
${\mathbbm 1}^0_1$ is 
always sc-smooth. 
Hence, if  the map ${\mathbbm 1}^1_0\colon X\to X^1$ is sc-smooth, it is a sc-diffeomorphism. 
There is a  subtle point in (2). If $X_0=X_\infty$,  then $X_m=X_0$ as sets for all $m\geq 0$.  However,  it is possible that $X^1\neq X$ as sc-smooth spaces
despite the fact that ${(X^1)}_m = X_{m+1}=X_i$ as sets. In  other words, it  is possible that  as M-polyfolds $X^1\neq X$  
even if the underlying sets are the same.
Indeed, recalling the definition
of sc-differentiability, one realizes that  the sc-smoothness of ${\mathbbm 1}\colon X\rightarrow X$ 
is  completely different from the 
sc-smoothness of ${\mathbbm 1}\colon X\rightarrow X^1$.
This is the reason we use the notation ${\mathbbm 1}_0^1$ 
for the identity map $X\to X^1$.
In contrast, if $X$ is  a finite-dimensional vector space equipped with the constant sc-structure, then $X=X^1$ as sc-spaces.
\qed
\end{remark}


The proof of Theorem \ref{XXX--} requires some preparations and we start with a definition where we denote as usual with $U\subset C\subset E$ a relatively open set $U$ in the partial quadrant $C$ of the sc-Banach space $E$.



\begin{definition}[{\bf Sc$^+$-retraction}] \label{sc_plus_retraction}\index{D- Sc$^+$-retraction}
 A sc-smooth retraction $r\colon U\to U$  is called a 
 {\bf $\ssc^+$-retraction}, if 
$r(U_m)\subset U_{m+1}$ for all $m\geq 0$ and if  $r\colon U\to U^1$  is sc-smooth.
Similarly, if $V\subset X$ is an open subset of a  M-polyfold $X$, we call the sc-smooth retraction $r\colon V\rightarrow V$ a {\bf $\ssc^+$-retraction},  if $r\colon V\rightarrow V^1$ is sc-smooth.
\qed
\end{definition}


 
\begin{lemma}\label{L-L}\index{L- Sc$^+$-retractions}
Let $(O,C,E)$ be  a sc-smooth retract and suppose that there exists a relatively open subset  $U\subset C$  and a 
$\ssc^+$-retraction
$t\colon U\rightarrow U$ onto  $t(U)=O$. Then every   sc-smooth retraction $s\colon V\rightarrow V$ of a relatively open subset $V\subset C$ satisfying $s(V)=O$
is a $\ssc^+$-retraction. 
\end{lemma}

\begin{proof}
By assumption, the sc-smooth map  $t:U\rightarrow U$  satisfies $t\circ t=t$ and $t(U)=O$. In addition, $t\colon U\to U^1$ is  sc-smooth. 
If now $s\colon V\rightarrow V$ is a sc-smooth retraction onto $s(V)=0$, then $t(s(v))=s(v)$ and hence 
$$
s = t\circ s.
$$
In view of the properties of $t$, the composition 
$t\circ s\colon V\to V^1$ is sc-smooth and hence 
$s\colon V\rightarrow V^1$ is sc-smooth, as claimed. 
 \qed \end{proof}


 
\begin{definition}[{\bf Sc$^+$-retract}] \index{D- Sc$^+$-retract}
The sc-smooth retract $(O,C,E)$ is a 
{\bf $\ssc^+$-retract}, if there exists a relatively open subset 
$U\subset C$ and a $\ssc^+$-retraction $t\colon U\rightarrow U$ onto  $t(U)=O$.
\qed
\end{definition}

In view of the Lemma \ref{L-L} the choice of $t$ is irrelevant, being a $\ssc^+$-retract is an intrinsic property of the sc-smooth retract $(O, C, E)$.




\begin{lemma}\label{new_lemma_4.8}\index{L- Image of sc$^+$-retraction}
If $r\colon U\to U$ is a $\ssc^+$-retraction onto the sc-smooth retract $(O, C, E)$, then 
\begin{itemize}
\item[{\em (1)}]\ $r(U)=O=O_\infty$, i.e., consists of smooth points.
\item[{\em (2)}]\ At every point $o\in O$, the tangent space $T_oO=Dr(o)E$ is finite-dimensional.
\end{itemize}
\end{lemma}
\begin{proof}
(1)\, 
 If $x\in U$, then, by definition, $r(x)\in U_1$ and using 
$r\circ r=r$, $r(x)=r(r(x))\in U_2$. Continuing this way we conclude that $r(x)\in \bigcap_{m\geq 0} U_m=U_\infty$. Hence $r(U)=O\cap U_\infty=O_\infty$.\par

\noindent (2)\, At the point $o\in O$, the linearization 
$Dr(o)\colon E\to E$ is, in view of (1),  well-defined, and it is a 
$\ssc^+$-operator, since $r$ is a $\ssc^+$-map. Consequently, $Dr(o)\colon E\to E$ is a compact operator between every level. Therefore, the image of the projection $Dr(o)$, namely $Dr(o)E=T_oO$ must be finite-dimensional. This proves the lemma.
 \qed \end{proof}

The $\ssc^+$-retracts are characterized by the following proposition.
\begin{proposition}\label{frank}\index{P- Characterization of sc$^+$-retractions}
A sc-smooth retract $(O,C,E)$ is a $\ssc^+$-retract  if and only if  $O_0=O_\infty$ and ${\mathbbm 1}_0^1\colon O\rightarrow O^1$ is sc-smooth.
\end{proposition}

\begin{proof}

If $(O,C,E)$ is a $\ssc^+$-retract, there exists a $\ssc^+$-retraction $r\colon U\to U$ onto  $r(U)=O$. 
The retract has the induced M-polyfold structure  defined  by the scaling $O_m=r(U_m)$ and $O^1$ inherits this structure, so that 
$(O^1)_m=O_{m+1}$, for all $m\geq 0$.
In view of Lemma \ref{new_lemma_4.8}, $O=O_\infty$. Hence the identity map ${\mathbbm 1}_0^1\colon O\to O^1$ is well-defined. According to Definition \ref{tangent_retract}, the map  
${\mathbbm 1}_0^1$ is sc-smooth, provided  the composition 
${\mathbbm 1}_0^1\circ r \colon U\to E^1$ is sc-smooth, which is the case because  $r$ is a $\ssc^+$-map.


In order to prove the opposite direction we assume that $O=O_\infty$ and ${\mathbbm 1}_0^1\colon O\to O^1$ is sc-smooth. Let $r\colon U\to U$ be a sc-smooth retraction onto $O=r(U)$. Then the composition 
$$
U\xrightarrow{r} O\xrightarrow{{\mathbbm 1}_0^1} O^1\xrightarrow{\textrm{inclusion}} U^1
$$
is sc-smooth. The composition agrees with the map $r\colon U\to U^1$ and the lemma is proved.
 \qed \end{proof}

The proof of Theorem \ref{XXX--} will make use of the following technical result.





\begin{proposition}
\label{FFF}\index{T- Tangent representation}

Let $(O,C,E)$  be a $\ssc^+$-retract and $t\colon U\to U$ a $\ssc^+$-retraction of  the relatively open subset $U\subset C$ onto $O=t(U)$. We assume that $0\in O$ and the the tangent space $T_0O$ (which  by Lemma \ref{new_lemma_4.8} is finite-dimensional) is in good position to the partial quadrant $C$.   We denote by $Y$ a good complement of $T_0O$, so that $E=T_0O\oplus Y,$  and denote by 
$$
p\colon E=T_0O\oplus Y\rightarrow T_0O
$$ 
the associated sc-projection. 
Then there exist  open neighborhoods ${\mathcal U}$ of $0$ in  $O$ and ${\mathcal V}$ of $0$ in $T_0O\cap C$ such  that
$$
p\colon {\mathcal U}\rightarrow {\mathcal V}
$$
is a sc-diffeomorphism.

\end{proposition}
 
\begin{remark}We 
note that $({\mathcal V},T_0O\cap C,T_0O)$ is a local M-polyfold model, because $T_0O\cap C$ is a  partial quadrant in $T_0O$, in view of Proposition \ref{pretzel}. 
The proof of Proposition \ref{FFF} is based on the implicit function theorem for sc-Fredholm sections proved in the previous chapter.
\qed
\end{remark}
\begin{proof}[Proof of Proposition \ref{FFF}]

We recall that $U$ is a  relatively open neighborhood of $0$ in  the  partial quadrant  $C$ of the sc-Banach space $E$.
Moreover,  $t\colon U\rightarrow U$ is  a $\ssc^+$-retraction onto $O=t(U)$ which contains $0$. In view of 
Lemma \ref{new_lemma_4.8}, the tangent space $T_0O=Dt(0)E$ is a smooth subspace of finite dimensions. By assumption, $T_0O$ lies in good position to $C$. Accordingly, there exists a good sc-complement $Y$ of $T_0O$ in $E$ so that 
$$
E=T_0O\oplus Y.
$$
 It has the property that there 
exists  $\varepsilon_0>0$  such that for $a+y\in T_0O\oplus Y$ satisfying $\abs{y}_0\leq \varepsilon \abs{a}_0$ the  statements $a\in C$    %
and $a+y\in C$ are equivalent.

We shall use in the following the notation $u=a+y\in T_0O\oplus Y$ and denote by $p$ the  sc-smooth projection 
$$
p\colon E=T_0O\oplus Y\rightarrow T_0O.
 $$
Now we consider the local strong bundle 
$$
\pi\colon U\triangleleft Y\rightarrow U,
$$
and  the sc-smooth section $f\colon U\to U\triangleleft Y$ , $f(u)  = (u,{\bm{f}}(u))$, whose principal part ${\bm{f}}\colon U\to Y$
is defined  by
$$
 {\bm{f}}(u) = ({\mathbbm 1}-p)\bigl( u-t(u)\bigr).
$$
We observe that if $u\in O$, then $u=t(u)$ and hence ${\bm{f}}(u)=0.$ We shall show later on that there are no other solutions $u\in U$ of ${\bm{f}}(u)=0$ locally near $u=0$.



\begin{lemma}\label{new_lemma4.11}
The section $f$ is sc-Fredholm.
\end{lemma}
\begin{proof}
In order to verify that the sc-smooth section $f$ is regularizing, we take $u=a+y\in U_m$ and assume that 
${\bm{f}}(u)=y-({\mathbbm 1}-p)\circ t (a+y)\in Y_{m+1}.$
Since $t$ is $\ssc^+$-smooth, we conclude  that $y\in Y_{m+1}$ and since $a$ is smooth, that  $a+y\in U_{m+1}$, showing that $f$ is indeed regularizing. 

We continue by studying the principal part ${\bm{f}}$ of $f$.
The derivative of ${\bm{f}}$ at the smooth point $u\in U$ has the form
\begin{equation*}
\begin{split}
D{\bm{f}}(u)h &=({\mathbbm 1}-p)(h - Dt(u)h)\\
& = h -(p(h)-({\mathbbm 1}-p)Dt(u)h)
\end{split}
\end{equation*}
for $h\in E$. Since  $Dt(u)$  and $p$ are  $\ssc^+$-operators, the operator $D{\bm{f}}(u)$ is a perturbation of the identity operator by a $\ssc^+$-operator, and therefore a sc-Fredholm operator, in view of Proposition 
\ref{prop1.21}.

Next we have to verify that at a given smooth point $u\in U$, a filled version of ${\bm{f}}$, after modification by a $\ssc^+$-section ${\bm{s}}$, is conjugated to a basic germ. However, in the case at hand, we already 
work on relatively open subsets of a partial quadrant, so that  a filling is not needed. We merely have to find a suitable $\ssc^+$-section to obtain a section  which is conjugated to a basic germ.

In general, the good complement $Y$ in the decomposition 
$E=T_0O\oplus Y$ is not a subset of $C$. 
However, we claim that there exists  a finite-dimensional sc-Banach space $B$ and a sc-Banach space $W$ contained in $C$,  such  that $Y=B\oplus W$,  which leads to the sc-decomposition
$$
E= (T_0O\oplus B)\oplus W.
$$
Indeed, if $E=\R^n\oplus F$ and the partial quadrant $C\subset E$ is of  the form $C =[0, \infty)^n\oplus F$ where $F$ is a sc-Banach space, then, identifying the sc-Banach space $F$ with $\{0\}^n\oplus F$, we let $B$ to be an  algebraic complement of $Y\cap F$ in $Y$ and $W=Y\cap F$, so that $Y=B\oplus  W$. Clearly, $W\subset C$ and  $B$ is finite-dimensional. 
 In the general case, there exists a sc-isomorphism $L\colon E\to \R^n\oplus F$ mapping $C$ onto 
the partial quadrant $C'=[0,\infty)^n\oplus F$.  Then the subspace $L(T_0O)$ is in good position to the partial quadrant $C'$ and $L(Y)$ is a good complement of $L(T_0O)$ in $\R^n\oplus F$. 
By the above argument, we find a finite-dimensional subspace $B'$ and a sc-Banach space $W'$ contained in $C'$, so that $L(T_0O)=B'\oplus W'$.  With $B=L^{-1}B'$ and $W=L^{-1}W'$,  we conclude that $B$ is finite-dimensional, $W$ is contained in $C$ and $Y=B\oplus W$, as claimed.
Since $W\subset C$,
$$
C=\bigl(C\cap (T_0O\oplus B)\bigr)\oplus W.
$$
The finite-dimensional space $T_0O\oplus B$ is in good position to $C$. Therefore, the set $C\cap (T_0O\oplus B)$ is a partial quadrant in $T_0O\oplus B$, in view of Proposition \ref{pretzel}. We shall represent an element $u\in U$ as 
$$u=a+b+w\in T_0O\oplus B\oplus W,$$
where $b+w=y\in Y=B\oplus W.$
Furthermore, we denote by  $P$ the projection 
$$P\colon Y=B\oplus W\to W.$$
In accordance with the notation in the definition of a basic germ, we view $Y$ as $\R^N\oplus W$, where 
$N=\dim(B)$,  and $P$  as the sc-projection $P\colon \R^N\oplus W\to W$. 

If $u\in C$ is a smooth point near $0$ we denote by $C_u$ the associated partial quadrant introduced in Definition \ref{new_def_2.33}. The partial quadrant $C_u$ contains $C$, so that 
$$C_u=(C_u\cap (T_0O\oplus B))\oplus W.$$
Fixing the smooth point $u\in C$, the map $v\mapsto u+v$ for $v$ near $0$ in $C_u$, maps an open neighborhood of $0$ in $C_u$ to an open neighborhood of $u$ in $C$. We now study the principal part ${\bm{f}}\colon U\rightarrow Y$ near the fixed smooth point $u$, make  the change of coordinate $v\mapsto  u+v$, and define the section 
${\bm{g}}(v)$ by 
$${\bm{g}}(v):={\bm{f}}(u+v).$$
In addition, we define a $\ssc^+$-section ${\bm{s}}$ near 
near $0$ in $C_u$,  by 
$${\bm{s}}(v) ={\bm{f}}(u) +( {\mathbbm 1}-p)[  t(u)-t(u+v)]. $$
It has the property that  at $v=0$, 
$$
{\bm{g}}(0)-{\bm{s}}(0)=0.
$$
In the decomposition $v=(a+b)+w$ we interpret $a+b\in C_u\cap (T_0O\oplus B)$ as a finite-dimensional parameter and consider 
the germ 
$$(a+b,w)\mapsto  ({\bm{g}}-{\bm{s}})(a+b+w)\in Y.$$
Then 
\begin{equation*}
\begin{split}
 P({\bm{g}}-{\bm{s}})(a+b+w)=P({\mathbbm 1}-p)(a+b+w) =P(b+w)=w.
\end{split}
\end{equation*}
Identifying an open neighborhood of $0$ in $C_u\cap (T_0O\oplus B)$ with an open neighborhood of $0$ in some partial quadrant $[0,\infty)^k\oplus {\mathbb R}^{n-k}$, we conclude that ${\bm{g}}-{\bm{s}}$ is a basic germ, whose contraction part happens to be  identically zero. We have used the local  strong bundle  isomorphism $(u+v,b+w)\mapsto (v,b+w)$.


Consequently,  $(f,u)$ is a sc-Fredholm germ and the proof of lemma \ref{new_lemma4.11}
is  complete.
 \qed \end{proof}

The sc-Fredholm section $f$ vanishes at the point $u=0$, so that ${\bm{f}}(0)=0$. The  linearization of its principal part is  is given by 
$$
D{\bm{f}}(0)(h) = ({\mathbbm 1}-p)h,\quad h\in E.
$$
Therefore, $D{\bm{f}}(0)$ has the kernel $\ker(D{\bm{f}}(0))=T_0O=Dt(0)E$,  which, by assumption,  is in good position to the partial quadrant $C$. Moreover, its image is $ ({\mathbbm 1}-p)E=Y$, so that $D{\bm{f}}(0)$ is surjective.

We are in position to apply the implicit function theorem, Corollary  \ref{LGS2},  and conclude that the local solution set of ${\bm{f}}$ near $u=0$ is represented by 
$$\{u\in U_0\, \vert \, {\bm{f}}(u)=0\}=\{u=a+\delta (a)\in T_0O\oplus Y\, \vert \, a\in V\}\subset U.$$
Here  $U_0\subset U$ is an open neighborhood of $0$ in $U$ and $V$ is an open neighborhood of $0$ in the partial quadrant $T_0O\cap C$ of $T_0O$. The map $\delta\colon V\to Y$ is a sc-smooth map satisfying $\delta (0)=0$ and $D\delta (0)=0$.

That all sufficiently small solutions of ${\bm{f}}(u)=0$ are of the form $a+\delta (a)$, is, in our special case, easily verified directly.


\begin{lemma}\label{new_lemma4.12}
Let $f(a+y)=0$ and $\abs{a}_0<\varepsilon$, $\abs{y}_0<\varepsilon$. If $\varepsilon$ is sufficiently small, then 
$y=\delta (a)$.
\end{lemma}

\begin{proof}
From $f(a+y)=0$ and $f(a+\delta (a))=0$, we obtain 
$y=({\mathbbm 1}-p)t(a+y)$ and 
$
\delta (a)=
({\mathbbm 1}-p)t(a+\delta (a))
$. 
Consequently,  
$$
y-\delta (a)=({\mathbbm 1}-p)[t(a+y)-t(a+\delta (a))].
$$
As $f$ is regularizing, the solutions are smooth points. Since $t$ is a $\ssc^+$-map, the map 
$u\mapsto ({\mathbbm 1}-p)t(u)$ is of class $C^1$ between 
the $1$-levels, and the derivative vanishes at $u=0$, 
$({\mathbbm 1}-p)Dt(0)=0$. Therefore, there exists 
$\varepsilon_1>0$ such that 
\begin{equation}\label{new_eq1_em4.12}
\norm{({\mathbbm 1}-p)Dt(u)}_{L(E_1,E_1)}\leq 1/2
\end{equation}
if $\abs{u}_1<\varepsilon_1$. 
Consequently, on level $1$,
\begin{equation}\label{new_eq2_em4.12}
y-\delta (a)=\biggl(\int_0^1({\mathbbm 1}-p)Dt(u(\tau))\ d\tau \biggr)\cdot (y-\delta (a)),
\end{equation}
where $u(\tau )=a+\tau y+(1-\tau )\delta (a)$.
Since $t$ is a $\ssc^+$-map satisfying $t(0)=0$, we conclude from 
$y=({\mathbbm 1}-p)t(a+y)$ that $\abs{y}_1$ is small if $a$ and $y$ are small on level $0$. Moreover, the map $\delta$ is sc-smooth and satisfies $\delta (0)=0$ and hence 
$\abs{\delta (a)}_1$ is small, if $a$ is small on level $0$. Summing up, 
$\abs{u(\tau)}_1<\varepsilon_1$ if $\varepsilon$ is sufficiently small,  and we conclude from \eqref{new_eq1_em4.12} and 
\eqref{new_eq2_em4.12} the estimate 
$$
\abs{y-\delta (a)}_1\leq \dfrac{1}{2}\abs{y-\delta (a)}_1,
$$
so that indeed $y=\delta (a)$ is $\varepsilon$ is sufficiently small, as claimed in Lemma \ref{new_lemma4.12}.
 \qed \end{proof}




We finally verify that the solutions $f(a+\delta (a))=0$ belong to $O$ if $a$ is small on level $0$.

\begin{lemma}\label{new_lemma_4.13}
Let $f(a+\delta (a))=0$ and $\abs{a}_0<\varepsilon.$
If $\varepsilon>0$ is sufficiently small, then 
$a+\delta (a)\in O$.
\end{lemma}
\begin{proof}
We have to confirm that $a+\delta (a)=t(a+\delta (a))$. From 
$f(a+\delta (a))=0$ we conclude that $\delta (a)=
t(a+\delta (a))-p\circ t(a+\delta (a))$, so that our aim is to prove that 
$$a=p\circ t(a+\delta (a)).$$
Applying the retraction $t$ to the identity
\begin{equation}\label{new_eq3_lem4.13}
p\circ t(a+\delta (a))+\delta (a)=t(a+\delta (a)),
\end{equation}
and using $t\circ t=t$,  we obtain
$$
t\bigl(p\circ t(a+\delta (a))+\delta (a)\bigr)=t(a+\delta (a)).
$$
Hence, abbreviating 
$$a_1:=p\circ t(a+\delta (a)),$$
we arrive at the identity
$$t(a_1+\delta (a))-t(a+\delta (a))=0.$$
Going to level $1$, abbreviating $a(\tau)=\tau a_1+(1-\tau)a+\delta (a)$ and observing that 
$Dt(0)(a_1-a)=a_1-a$,  we estimate
\begin{equation*}
\begin{split}
0&=\abs{t(a_1+\delta (a))-t(a+\delta (a))}_1\\
&=\left|\int_0^1Dt(a(\tau ))\ d\tau (a_1-a)\right|_1\\
& \geq \abs{a_1-a}-\biggl(\int_0^1\norm{Dt(a(\tau ))-Dt(0)}_{L(E_1, E_1)}\ dt \biggr)\cdot \abs{a_1-a}_1
\end{split}
\end{equation*}
Since $\norm{Dt(u)}_{L(E_1, E_1)}$ is continuous in $u$ on level $1$, there exists $\varepsilon_1>0$ such that 
$$\norm{Dt(v))-Dt(0)}_{L(E_1, E_1)}\leq 1/2$$
if $\abs{v}_1\leq \varepsilon_1$. Arguing as in the previous lemma, $\abs{a(\tau)}_1\leq \varepsilon_1$ if $\abs{a}_0<\varepsilon$ and $\varepsilon$ is sufficiently small. Consequently,
$$
0\geq \abs{a_1-a}_1-\dfrac{1}{2}\abs{a_1-a}_1=\dfrac{1}{2}\abs{a_1-a}_1.
$$
Therefore, $a_1=a$ and hence $p\circ t(a+\delta (a))=a$ if 
$\varepsilon>0$ is sufficiently small, and Lemma \ref{new_lemma_4.13} is proved.
 \qed \end{proof}
In order to complete the proof of Proposition \ref{FFF}, we set 
${\mathcal V}=\{a\in T_oO\cap C\, \vert \, \abs{a}_0<\varepsilon\}.$ 
The map $p$, satisfying 
$$p (a+\delta (a))=a,$$
is a sc-diffeomorphism from the open set 
${\mathcal U}=\{ a+\delta (a)\, \vert \, a\in {\mathcal V} \}$ in $O$, to the open set ${\mathcal V}$ having the sc-smooth map $a\mapsto a+\delta (a)$ as its inverse. This completes the proof of Proposition \ref{FFF}.
 \qed \end{proof}


\begin{proof}[Theorem \ref{XXX--}]
We assume that (1) holds true: the M-polyfold $X$  has a compatible smooth manifold structure with boundary with corners. 
Correspondingly there is an atlas of sc-smoothly compatible partial quadrants charts $(V, \varphi, (U, C, \R^n))$ where $\varphi\colon V\to U$ is a sc-diffeomorphism from the open subset $V\subset X$ onto the relatively open subset $U\subset C$ of the partial quadrant $C$ in $\R^n$. We take in $\R^n$ the unique constant sc-structure. 

Then the identity map ${\mathbbm 1}\colon U\to U$ is a tame sc-smooth retraction of $(U, C, \R^n)$.

 Clearly, $U=U_\infty$ and ${\mathbbm 1}_0^1\colon U\to U^1$ is sc-smooth. Consequently, these charts define a tame M-polyfold structure on $X$ for which  $X_0=X_\infty$ and
 ${\mathbbm 1}_0^1\colon X\to X^1$ is sc-smooth and the statement (2) follows.
 
Conversely, if (2) holds for the tame M-polyfold $X$, then $X_0=X_\infty$ and ${\mathbbm 1}_0^1\colon X\to X^1$ is sc-smooth. If $x\in X$, then we find a tame sc-smooth polyfold chart $(V,\psi, (O, C, E))$ such that the sc-diffeomorphism $\psi\colon V\to O$ satisfies $\psi (x)=0$. 
It follows that $O_0=O_\infty$ and 
${\mathbbm 1}_0^1\colon O\to O^1$ is sc-smooth. By Proposition \ref{frank} the sc-retract $(O, C, E)$ is a $\ssc^+$-retract and hence there is a $\ssc^+$-retraction $t\colon U\to U$ of a relatively open sbset $U$ in the partial quadrant $C$ satisfying $O=t(U)$. The tangent space $T_0O$ is a finite-dimensional smooth subspace of the sc-Banach space $E$ and, by assumption,  in good position to $C$. 



Using Proposition \ref{FFF} we find an open neighborhood ${\mathcal O}'$ of $0$ in $O$ and an open neighborhood ${\mathcal V}$ of $0$ in $T_0O\cap C$ and a sc-diffeomorphsim $p\colon {\mathcal O}'\to {\mathcal V}$ onto the finite-dimensional polyfold model $({\mathcal V}, T_0O\cap C, T_0O)$. Taking the open set $V_0=\psi^{-1}({\mathcal O}')\subset V$, the composition 
$$
V_0\xrightarrow{\psi}{\mathcal O'}\xrightarrow{p}{\mathcal V}
$$
is a sc-diffeomorphism onto the finite-dimensional model $({\mathcal V}, T_0O\cap C, T_0O)$. Carrying out this construction around every point $x\in X$, we obtain a smoothly compatible atlas of tame charts and the statement (1) follows. This completes  the proof of Theorem \ref{XXX--}.
 \qed \end{proof}
 


\section{Smooth Finite Dimensional  Submanifolds}

We start with the definition.    


\begin{definition}\label{Def2.40}\index{D- Smooth submanifold}
A {\bf smooth finite-dimensional submanifold} of the M-polyfold $X$  is a subset $A\subset X$ having the property that every point $a\in A$ possesses 
 an open  neighborhood $V\subset X$ and a  $\ssc^+$-retraction $s\colon V\to V$ onto 
 $$
 s(V)=A\cap V.
 $$
 \qed
\end{definition}

In contrast to the sc-smooth sub-M-polyfold of an M-polyfold in Definition 
\ref{def_sc_smooth_sub_M_polyfold}, the retracts in the above definition are  $\ssc^+$-retracts.
We also point out, that a smooth finite dimensional submanifold is not defined as a sub-M-polyfold whose induced structure admits an equivalent structure of a smooth manifold with boundary with corners.
\begin{remark} \index{R- On the notion of  finite-dimensional manifold}
The subset $A\subset X$ in 
Definition \ref{Def2.40}  is called a smooth finite-dimensional manifold for the following reasons. The retraction $s\colon V\to V$, satisfying $s\circ s=s$, is a $\ssc^+$-map. Therefore, the image $s(V)\subset X_\infty$ consists of smooth points, so that every point $a\in s(V)$ possesses a tangent space $T_aA$ defined by $T_aA=Ts(a)(T_aX)$. From the $\ssc^+$-smoothness of the map $s$, it follows that the projection $Ts (a)\colon T_aX\to T_aX$ is a $\ssc^+$-operator  and 
therefore level-wise compact. 
Hence its image, $T_aA$ is finite-dimensional.  Since $A$,  as we shall see,  is in particular a sub-M-polyfold it has an inherited M-polyfold structure
so that its degeneracy index is defined. In general for $a\in A$ it holds that $d_A(a)\leq d_X(a)$. One can show that $A$ near points $a\in A$ with $d_A(a)=0$
has a natural smooth manifold structure. Near points with $d_A(a)=1$ it has a natural structure as a smooth manifold with boundary. If $d_A(a)\geq 2$ the boundary structure
can be quite complex.  However, under the  additional assumption that the tangent space $T_aA$ is in good position to the partial quadrant $C_aX$ in $T_aX$ the subset $A$
has near $a$ in a natural way the structure of a smooth manifold with boundary with corners.  We shall see that $A$ inherits the structure of a M$^+$-polyfold. These differ from
usual classical finite-dimensional manifolds by allowing more general boundary behavior, but if $d_A\leq 1$ they are the same as smooth manifolds with or without boundary.
\qed
\end{remark}

Since an sc$^+$-retraction is an sc-smooth retraction it follows that  a smooth finite-dimensional submanifold $A$ inherits 
from its ambient space $X$ a natural M-polyfold structure. As 
such the degeneracy index $d_A(a)$ is well-defined,  and the boundary $\partial A$ is defined as the subset $\{a\in A\, \vert \, d_A(a)\geq 1\}$.  However, being locally an sc$^+$-retraction implies additional properties.

Recall that a subset $A$ of  a topological space $X$ is called {\bf locally closed}\index{Locally closed} if every point $a\in A$ possesses an open neighborhood $V(a)\subset X$ having the property that a point $b\in V(a)$ belongs to $A$, if $U\cap A\neq \emptyset$ for all open neighborhoods $U$ of $b$. 

\begin{proposition}\label{new_prop4.15}\index{P- Basic properties of submanifolds}
A smooth finite-dimensional submanifold $A\subset X$  of the M-polyfold $X$ has the
following properties.
\begin{itemize}
\item[{\em (1)}]\ $A\subset X_\infty$,  and  $A$  inherits the M-polyfold structure induced from $X$.  In particular,  $A$  possesses a tangent space at every point in $A$, and 
the degeneracy index $d_A$ is defined on $A$.
\item[{\em (2)}]\ $A$ is locally closed in $X$.
\item[{\em (3)}]\ $\partial A=\{a\in A\, \vert \, d_A(x)\geq 1\}\subset \partial X$. 
\item[{\em (4)}]\ ${\mathbbm 1}_0^1\colon A\to A^1$ is sc-smooth.
\end{itemize}
\end{proposition}
\begin{proof}\mbox{}  (1)\, A $\ssc^+$-retraction is, in particular, a sc-retraction and hence $A$ inherits the M-polyfold structure from $X$, in  view of Proposition \ref{sc_structure_sub_M_polyfold}. Since a $\ssc^+$-retraction $s$ has its image in $X_\infty$,  we conclude that $A\subset X_\infty$,  implying that every point in $a\in A$ has 
the  tangent space $T_aA=Ts(s)(T_aX)$. Since $A$ is a M-polyfold,  the degeneracy index $d_A$ is defined on $A$.\\[0.5ex]
(2)\, In order to prove (2) we choose a point   $a\in A$ and an open neighborhood $V\subset X$ of $a$ such that a  suitable 
$\ssc^+$-retraction $s\colon V\to V$  retracts onto $s(V)=A\cap V.$
If  $b\in V$ lies in the closure of $A$, then there exists a sequence $(a_k)\subset A$
satisfying $a_k\rightarrow b$. Since $V$ is open $b\in V$, we conclude that  
$a_k\in A\cap V$ for large $k$.  Hence $a_k=s(a_k)$ and,  using that $b\in V$,  we conclude that $s(b)=\lim_k s(a_k)=b,$ implying that $b\in A\cap V$.\\[0.5ex]
(3)\,  By definition,  $\partial A=\{a\in A\,  \vert \, d_A(x)\geq 1\}$.
We assume that $a\in A$ satisfies $d_A(a)\geq 1$ and show that $d_X(a)\geq 1$. If $d_X(a)=0$,  we find an open neighborhood
$V\subset X$  of $a$ which is sc-diffeomorphic to a retract $(O,E,E)$. This implies that there exists an open neighborhood 
$U\subset A$ of $a$ which is sc-diffeomorphic to a retract $(O',E,E)$, so that $d_A(a)=0$.  \\[0.5ex]
(4)\, The postulated $\ssc^+$-retraction is the identity on the retract $A$, and $A=A_\infty$, so that ${\mathbbm 1}_0^1\colon A\to A^1$ is sc-smooth.

The proof of 
Proposition \ref {new_prop4.15}
is complete.
 \qed \end{proof}

\begin{question} It is an open question,  whether  there 
is a difference between a smooth finite-dimensional submanifold $A$
and a sub-M-polyfold  satisfying $A=A_\infty$ and $\dim T_aA$ being finite and locally constant.  In fact, the question is if under the latter conditions ${\mathbbm 1}_0^1\colon A\rightarrow A^1$ is sc-smooth.  We conjecture that this is not always the case. Rather we would expect,
for example,  if the dimension of the tangent space is equal to $1$, the set $A$ might be something like a branched one-dimensional manifold
as defined in \cite{Mc}. It would be interesting to see if such type of examples  can be constructed. For example,  
consider the subset $T:=\{(x,0)\in {\mathbb R}^2\, \vert\, -1<x<1\}\cup\{(0,y)\in {\mathbb R}^2\, \vert \, y\in [0,1)\}$ with the induced topology.
Is it possible to find a sc-smooth retract $(O,E,E)$ where $E$ is a sc-Banach space so that $T$ is homeomorphic to $O$
and $O=O_\infty$?  From our previous discussion this is impossible if we require $O$ to be a $\ssc^+$-retract. 
\qed
\end{question}




So far not much can be said about the structure of the smooth finite-dimensional submanifold $A$ at the boundary without additional assumptions. In order to formulate such an assumption, we consider a M-polyfold $X$ which is required to be tame. Thus, at every smooth point $a\in X$, the cone $C_aX$ is a partial quadrant in the tangent space $T_aX$, in view of Proposition \ref{tame_equality}, and we can introduce the following definition.

\begin{definition}[{\bf Good position at  $a\in A$}] \label{DEF424}\index{D- Good position at $a\in A$}
A smooth finite-dimensional submanifold $A$ of the tame M-polyfold $X$ is {\bf in good position at the point $a\in A$}, if the finite-dimensional linear subspace $T_aA\subset T_aX$ is in good position to the partial quadrant $C_aX$ in $T_aX$.
\end{definition}



We also need the next definition.

\begin{definition}[{\bf Tame submanifold}] \index{D- Tame submanifold}
A smooth finite-dimensional submanifold $A\subset X$ of the M-polyfold $X$ is called 
{\bf tame}, if, equipped with its induced M-polyfold structure, the M-polyfold $A$ is tame.
\end{definition}


The main result of the section is as follows.

\begin{theorem}\label{thm-basic}\index{T- Characterization of tame submanifolds}%
Let $X$ be a  tame M-polyfold and  $A\subset X$ a smooth finite-dimensional submanifold of $X$. If $A$ is at every point $a\in A$ in good position, then the induced M-polyfold structure  on $A$ is equivalent to the structure of a smooth manifold with boundary with corners. In particular, the M-polyfold $A$ is tame.  
\end{theorem}

\begin{proof}

The result will be based on Proposition \ref{XXX--}. We focus on a point $a\in A$. Then $a$ is a smooth point, and we find a sc-smooth tame chart $\varphi\colon (V, a)\mapsto (O, 0)$, where $\varphi$ is a sc-diffeomorphism from the open neighborhood 
$V\subset X$ of $a$ onto the retract $O$ satisfying $\varphi (a)=0$. The retract $(O, C, E)$ is  a tame local model. By assumption, $T_aA$ is in good position to the partial quadrant $C_aX$ in $T_aX$ and there is a good complement $Y'\subset T_aX$, so that $T_aX=T_aA\oplus Y'$. Therefore, the tangent space $T_0O=T\varphi (a)(T_aX)$ has the sc-splitting 
$$T_0O=N\oplus Y,$$
in which $N=T\varphi(a)(T_aA)$ and $Y=T\varphi (a)Y'$. Since $(O, C, E)$ is tame, the tangent space $T_0O$ has a sc-complement $Z$ contained in $C$, in view of Proposition \ref{IAS-x}. Hence 
$$
E=T_0O\oplus Z= N\oplus Y\oplus Z.
$$


\begin{lemma}\label{new_lemma4.20}
The finite-dimensional subspace $N=T\varphi(a)(T_aA)$ is in good position to $C$ and $Y\oplus Z$ is a good complement in $E$.
\end{lemma}

\begin{proof}[{\bf Proof of Lemma \ref{new_lemma4.20}}] 
By assumption, $N$ is in good position to $C_0=T_0O\cap C=T\varphi (a)(C_aX)\subset T_0O$, with the good complement $Y$. Hence there exists $\gamma>0$ such that  for $(n, y)\in N\oplus Y$
satisfying $\abs{y}_0\leq \gamma \abs{n}_0$ we have $n\in C_0$ if and only if $n+y\in C_0$. Take the norm $\abs{(y, z)}_0=\abs{y}_0+\abs{z}_0$ on $Y\oplus Z$ and consider $(n, y, z)$ satisfying $\abs{(y, z)}_0\leq \gamma \abs{n}_0$, and note that $n\in C$ if and only if $n\in C_0$. If $n\in C_0$, we conclude from 
$\abs{(y, z)}_0\leq \gamma \abs{n}_0$  that $n+y\in C_0$ which implies $n+y\in C$. Since $z\in C$, we conclude that $n+y+z\in C$. Conversely, we assume that $n+y+z\in C$ satisfies $\abs{(y, z)}_0\leq \gamma \abs{n}_0$. Then it follows from $z\in Z\subset C$ that $n+y\in C$ and hence $n+y\in C_0=T_0O\cap C$. From $\abs{y}_0\leq \gamma \abs{n}_0$ we deduce that 
$n\in C_0$ and hence $n\in C$. Having verified that $N$ is in good position to $C$ and $Y\oplus Z$ is a good complement, the proof of lemma is complete.
 \qed \end{proof}


Continuing with the proof of Theorem \ref{thm-basic}, we recall that $(O, C, E)$ is  a tame retract. Hence there exists a relatively open  subset $U\subset C$ and a  sc-smooth tame retraction $r\colon U\to U$ onto $O=r(U)$. Since $A\subset X$ is a finite-dimensional smooth submanifold of $X$, we find an open neighborhood $V\subset X$ of $a$ and a $\ssc^+$-retraction $s\colon V\to V$ onto $s(V)=A\cap V$. Taking $V$ and $U$ small, we may assume that $V=\varphi^{-1}(O)$. 
Then, defining  $t\colon U\rightarrow U$ by
$$
t(u)=\varphi\circ s\circ \varphi^{-1}\circ r (u),
$$
we compute, using $r\circ \varphi =\varphi$ and $s\circ s=s$, 
\begin{equation*}
\begin{split}
t\circ t& = \varphi\circ s\circ\varphi^{-1}\circ r\circ  \varphi\circ s\circ \varphi^{-1}\circ r\\
&=\varphi\circ s\circ\varphi^{-1}\circ  \varphi\circ s\circ \varphi^{-1}\circ r\\
&= \varphi\circ s\circ s \circ \varphi^{-1}\circ r\\
&= \varphi\circ s\circ \varphi^{-1}\circ r\\
&=t.
\end{split}
\end{equation*}
We see that $t$ is 
a retraction. Moreover, it is a $\ssc^+$-retraction since $s$ is a 
$\ssc^+$-retraction. It retracts onto $t(U)=\varphi (A\cap V)$ and 
$Dt(0)E=T\varphi (a)Ts(a)(T_aX)=T\varphi (a)T_aA=N$. 
Therefore,  $Q:=t(U)\subset O$ is a $\ssc^+$-retract and $T_0Q=N$ 
is in good position to $C$, by Lemma \ref{new_lemma4.20}.


Now we can apply Proposition  \ref{FFF}  and conclude that 
that there are open neighborhoods $V_1$ of $0$ in $Q$ and $V_0$ of $0$ in $C\cap N$ such that $p=Dt(0)$ is a sc-diffeomorphism 
$$p\colon V_1\to V_0.$$
In view of Proposition \ref{pretzel},  $C\cap N$ is a partial quadrant in $N$, so that $(V_0, C\cap N, N)$ is a local model which is tame since $V_0\subset C\cap N$ is open.

Defining the open neighborhood $V(a)=\varphi^{-1}(V_0)\cap A$ of $a$ in $A$,  the map 
$$p\circ \varphi \colon V(a)\to V_0$$
is a sc-diffeomorphism defining a sc-smooth tame chart on the M-polyfold $A$. The collection of all these charts defines a sc-smoothly  compatible structure of a smooth manifold with boundary with corners. Moreover, the M-polyfold $A$ is tame. 
The proof of Theorem \ref{thm-basic} is complete.
 \end{proof}

\begin{remark}\index{R- Good position}
If $A$ is in good position at $a$, then there exists and open neighborhood $V(a)\subset X$, so that $A$ is in good position for all $b\in V(a)\cap A$. 
In order to see this we observe that Theorem \ref{FFF} defines a chart from the sole knowledge 
that we are in good position at $0$. Since the tangent spaces  of $A$  move only slowly, 
Lemma \ref{good_pos} implies that we are in good position at the nearby points as well.
\end{remark}


\begin{definition}[{\bf General position}] \index{D- Submanifold in general position}
Let $A\subset X$ be a smooth finite-dimensional submanifold of the 
M-polyfold $X$. Then $A$ is in {\bf general position} at the point $a\in A$, if 
 $T_aA$ has in $T_aX$ a sc-complement 
 contained in the reduced tangent space $T^R_aX$ as defined in Definition
 \ref{def_partial_cone_reduced_tangent}.
 \qed
\end{definition}


The following  local result describes an $A\subset X$ in general position.

\begin{theorem}[{\bf Local structure of smooth submanifolds}]\index{T- Local structure of submanifolds}\label{local-str}
Let $A$ be a smooth submanifold of the tame M-polyfold $X$. We assume that $A$ is in general position at the point $x\in A$, assuming that $T_xA$ has in $T_xX$ a sc-complement contained in $T_x^RX$. Then there exists an open neighborhood $U\subset X$  on which the following holds.
\begin{itemize}
\item[{\em (1)}]\ There are precisely $d=d_X(x)$  many local faces ${\mathcal F}_1,\ldots,{\mathcal F}_d$ contained in $U$. 
\item[{\em (2)}]\ $d_X(a)=d_A(a)$ for $a\in A\cap U$.
\item[{\em (3)}]\ If $a\in A\cap U$, then the tangent space $T_aA$ has in $T_aX$ a sc-complement contained in $T^R_aX$.
\item[{\em (4)}]\ If $\sigma\subset \{1, \ldots ,d\}$, then the intersection ${\mathcal F}_\sigma:=\bigcap_{i\in \sigma}{\mathcal F}_i$ of local faces is a tame M-polyfold and $A\cap {\mathcal F}_\sigma$ is a tame smooth submanifold of ${\mathcal F}_\sigma$. At every point $a\in (A\cap U)\cap {\mathcal F}_\sigma$, the tangent space $T_a(A\cap {\mathcal F}_\sigma)$ has in $T_a{\mathcal F}_\sigma$ a sc-complement contained in  $T_a^R{\mathcal F}_\sigma$.
 \end{itemize}
\end{theorem}

\begin{proof}
The result is local and,  going into a tame M-polyfold chart of $X$ around the point $x$,  we may assume that $X=O$ and $x=0\in O$, where $O$ belongs to the tame retract 
$(O, C, E)$ in which $C=[0,\infty)^n\oplus W$, $n=d_O(0)$, is a partial  quadrant in the sc-Banach space $E={\mathbb R}^n\oplus W$.
Moreover, $A\subset O$ is a smooth submanifold of $O$. We recall that the faces of $C$ are the subsets of $E$, defined by 
$$
F_i=\{(a_1,\ldots ,a_n,w)\in E\, \vert \,\text{$a_i=0$ and $a_j\geq 0$ for $j\neq  i$ and $w\in W$}\}.$$
For a subset $\sigma\subset \{1,\ldots ,n\}$ we introduce $F_\sigma=\bigcap_{i\in \sigma}F_i$. Then the M-polyfold $O$ has the faces ${\mathcal F}_i=O\cap F_i$ and we abbreviate the intersection by ${\mathcal F}_\sigma:=O\cap F_\sigma$.

By Definition \ref{reduced_cone_tangent}, $T_0^RO=T_0O\cap (\{0\}\oplus W)$, in our local coordinates.
By assumption of the theorem, the tangent space $T_0A\subset T_0O$ has in $T_0O$ a sc-complement $\wt{A}\subset T_0^RO$, so that $T_0O=T_0A\oplus \wt{A}$. In view of the definition of tame, the tangent space $T_0O$ has in $E$ a sc-complement $Z\subset \{0\}\oplus W$. Hence $E=T_0O\oplus Z=T_oA\oplus \wt{A}\oplus Z$ and it follows that $T_0A$ has in $E$ a sc-complement $Y$ contained in $W=\{0\}\oplus W$,
$$
E=T_0A\oplus Y,\quad Y\subset W.
$$
We denote by $N\subset T_aA$ a sc-complement of $T_0A\cap W$ in $T_0A$,
$$
T_0A=N\oplus (T_0A\cap W).
$$
From $E\cap W=W=(T_0A\cap W)\oplus (Y\cap W)=(T_0A\cap W)\oplus Y$, we obtain 
$$E=T_0A\oplus Y=N\oplus (T_0A\cap W)\oplus Y=N\oplus W.$$
Using $Y\subset W\subset C$, we deduce 
$$
C=(C\cap N)\oplus W$$
and
$$
C=(T_0A\cap C)\oplus Y.
$$
Therefore, the projection $\R^n\oplus W\to \R^n$ induces an isomorphism from $N$ to $\R^n$ and from $C\cap N$ onto $[0,\infty )^n$. Moreover, the tangent space $T_0A$ is in good position to $C$, and $Y$ is a good complement.
Hence $T_0A\cap C$ is a partial quadrant of $T_0A$ by Proposition \ref{pretzel}.

As proved in Proposition \ref{FFF} the smooth submanifold $A\subset O$ is represented local as the graph 
$$A=\{v+\delta (v)\, \vert \, v\in V\}$$
of a sc-smooth map $\delta\colon V\to Y$ defined on an open neighborhood $V$ of $0$ in the partial quadrant $T_0A\cap C$ of $T_0A$ satisfying $\delta (0)=0$ and $D\delta (0)=0$. 
The projection 
$$p\colon A\to (T_0A\cap C)\cap V,$$
defined by $p(v+\delta (v))=v$, is a sc-diffeomorphism from the M-polyfold $A$ and 
we conclude, by Proposition \ref{newprop2.24}, that 
$$d_A(a)=d_{T_0A\cap C}(p(a))$$
for all $a\in A\cap U$.
The points in $T_0A\cap C$  are represented by $(n, m)\in (N\cap C)\oplus (T_0A\cap W)$ so that the points $a\in A$ are represented by 
$$a=((n, m), \delta (n, m)).$$

Introducing 
$$
(T_0A)_\sigma:=T_0A\cap T_0{\mathcal F}_\sigma=\{(n, m)\in T_0A\, \vert \, 
\text{$n_i=0$ for $i \in \sigma$}\},
$$
the diffeomorphism $p\colon A\to  V\subset T_0A\cap C$, maps the intersection of faces $A\cap {\mathcal F}_\sigma$ to $(T_0A)_\sigma \cap C$. In particular, if $p(a)\in (T_0A)_\sigma\cap C$, then $a\in A\cap {\mathcal F}_\sigma$. This implies that 
$$d_{T_0A\cap C}(p(a))=d_C(a).$$
In view of Proposition \ref{tame_equality}, $d_C(a)=d_O(a)$, and we have verified for $a\in A\cap U$ that $d_A(a)=d_O(a)$ as claimed in the statement (2) of the theorem.

In order to prove the statement (3) we choose $a\in A\cap U$. Then $a=v+\delta (v)$ with $v\in T_0A\cap C$. The tangent space $T_aA$ is the image of the linear map $\alpha\colon h\mapsto h+D\delta (v)h$, $h\in T_0A$. If $a=0$, then $T_0A+W=E$ and we conclude, by means of the particular form of the map $\alpha$, that also $T_aA+W=E$ for all $a\in A\cap U$. Intersecting  with $T_aO$ and using $T_aA\subset T_aO$ leads to 
\begin{equation*}
\begin{split}
T_aO&=T_aA+(W\cap T_aO)\\
&=T_aA+T^R_aO,
\end{split}
\end{equation*}
implying that $T_aA$  has in $T_aO$ a sc-complement which is contained in $T_a^RO$. This proves the statement (3) of the theorem.

As for the last statement we observe that, in view of the arguments in the proof of Proposition \ref{FACE_XXXX}, the sets ${\mathcal F}_\sigma$ are tame M-polyfolds. Moreover, $A\cap {\mathcal F}_\sigma$ are smooth submanifolds of ${\mathcal F}_\sigma$. The previous arguments, but now applied to $A\cap {\mathcal F}_\sigma$ conclude the proof of Theorem \ref{local-str}.
 \qed \end{proof}


We conclude this section by defining M$^+$-polyfolds. If $A\subset X$ is a finite-dimen\-sional submanifold then it will naturally inherit such a structure.
We leave the details to the reader.
If $X$ is a M-polyfold and $A\subset X$ a finite-dimensional submanifold it inherits the structure of a M-polyfold. However, note that the natural local models
are $(O,C,E)$ where $O$ is an sc$^+$-retract. This prompts the following definition.
\begin{definition}\index{D- M$^+$-polyfold}
Let $Z$ be a metrizable topological space. 
\begin{itemize}
\item[(1)]\ A M$^+$-polyfold structure for $Z$ is given by an equivalence class of sc$^+$-atlases.
A sc$^+$-atlas consists of sc-smoothly compatible charts where the local models are sc$^+$-retracts.
\item[(2)]\ A M$^+$-polyfold structure is called {\bf tame} provided there exists an sc$^+$-atlas so that 
the underlying local models are tame.
\end{itemize}
\end{definition}
As a consequence of Theorem \ref{XXX--} and the previous discussions  we have the following result.
\begin{proposition}
Let $Z$ be a M$^+$-polyfold. Then the following holds. 
\begin{itemize}
\item[{\em(1)}]\ If $d_Z\equiv 0$ the topological space $Z$ has a unique  compatible smooth manifold structure (without boundary)  which is sc-smoothly compatible with the M$^+$-polyfold structure.
\item[{\em(2)}]\ If $d_Z\leq 1$ the topological space has a  unique  smooth structure as manifold with boundary, which sc-smoothly compatible with the M$^+$-polyfold structure.
\item[{\em(3)}]\ If the M$^+$-polyfold structure is tame there is a unique smooth structure as manifold with boundary with corners on $Z$ which is sc-smoothly compatible with the tame M$^+$-polyfold structure.
\end{itemize}
\end{proposition}
\begin{proof}
This is just a reformulation of earlier results and details are left to the reader.
 \qed \end{proof}



\section{Families and an Application of Sard's Theorem}
If $X$ is a tame M-polyfold we introduce the family
$$Z:=\R^m\oplus X=\{(\lambda , x)\, \vert \, \lambda \in \R^m, x\in X\}.$$
The family $\R^m\oplus X$ has a natural tame M-polyfold structure defined by the product of the corresponding charts and we denote by 
$$P\colon \R^m\oplus X\to \R^m,\quad P(\lambda ,x)=\lambda$$
the sc-smooth projection.
Using Theorem \ref{local-str}
and Sard's theorem we are going to establish the following result.


\begin{theorem}\label{SARD}\index{T- Fibered families and Sard}
Let $A\subset Z$ be a smooth submanifold of the tame M-polyfold $Z$. We assume that the induced 
M-polyfold structure is tame and the closure of $A$ is compact. Denoting by $p:=P\vert A\colon A\to \R^m$ the restriction of $P$ to $A$ we assume, in addition, that there exists $\varepsilon>0$ such that the following holds.
\begin{itemize}
\item[{\em(1)}]\ For every $\lambda\in \R^m$ satisfying $\abs{\lambda}\leq \varepsilon$, the set $p^{-1}(\lambda )\subset A$ is compact and non-empty.
\item[{\em(2)}]\ For $z\in A$ there exists a sc-complement $T_zA$ in $T_zZ$ which is contained in $T_z^RZ$.
\end{itemize}
Then there exists a set of full measure $\Sigma\subset \{\lambda\in {\mathbb R}^m\, \vert \, \abs{\lambda}<\varepsilon\}$ of regular values of $p$, having full measure in $B^m(\varepsilon)$ such that for $\lambda\in\Sigma$,  the set 
$$A_\lambda:=\{x\in X \, \vert \,  (\lambda,x)\in A\}$$ is a smooth compact  manifold with boundary with corners, having the additional property that the tangent space $T_xA_{\lambda}$ at $x\in A_\lambda$ has in $T_xX$ a sc-complement contained in $T^R_xX$. 
\end{theorem}

\begin{remark}\index{R- Comment on Proposition \ref{tame_equality}}
By Proposition  \ref{tame_equality}, 
the codimension of $T^R_xX$ is equal to $d_X(x)$. Therefore, if $\lambda\in \Sigma$, then the point $x\in A_\lambda$ can only belong to a corner if $d_X(x)\leq \dim (A_\lambda)$. For example, zero-dimensional manifolds $A_\lambda$ have to lie in $X\setminus \partial X$, one-dimensional $A_\lambda$ can only hit the $d_X=1$ part of the boundary,  etc.
\end{remark}

\begin{proof}

Fixing a point $z\in A$ there exists, in view of Theorem \ref{local-str} an open neighborhood $U(z)\subset Z$ of $z$ in $Z$ such that there are precisely $d=d_X(z)$ local faces ${\mathcal F}_1,\ldots ,{\mathcal F}_d$ in $Z\cap U$. Moreover, for all subsets $\sigma\subset \{1, 2,\ldots ,d\}$, the intersection of $A$ with ${\mathcal F}_\sigma=\bigcap_{i\in \sigma}{\mathcal F}_i$ is a tame smooth submanifold in ${\mathcal F}_\sigma$ of dimension $\dim A-\#\sigma$. Moreover, the tangent space $T_z(A\cap {\mathcal F}_\sigma)$ has a sc-complement in $T_z{\mathcal F}_\sigma$ which is contained in $T_z^R{\mathcal F}_\sigma$.

We cover the set $\{z\in A\, \vert \, \abs{p(z)}\leq \varepsilon\}$ with the finitely many such neighborhoods $U(z_1),\ldots , U(z_k)$ and first
 study the  geometry of the problem in one of these neighborhoods $U(z_i)$ which, for simplicity of notation, we denote by $U(z)$.

If $\sigma\subset \{1,\ldots ,d\}$
and ${\mathcal F}_\sigma$ the  associated 
intersection of local faces, we denote by 
${\mathcal F}^{\circ}_\sigma$ the interior of ${\mathcal F}_\sigma$, i.e., the set ${\mathcal F}_\sigma$ with its boundary removed. The union of all 
${\mathcal F}^{\circ}_\sigma$ is equal to $U(z)$. Here we use the convention that for the empty subset of 
$\{1,\ldots ,d\}$, the empty intersection is equal to $U(z)$ from which the boundary is removed. We note that ${\mathcal F}_{\{1,\ldots ,d\}}^\circ$ is a M-polyfold without boundary. By Theorem \ref{local-str}
the intersection $A\cap {\mathcal F}^\circ_{\sigma}$ is a smooth manifold without boundary having dimension $\dim (A)-\#\sigma$. 


With a subset $\sigma$ we associate the smooth projection 
$$p_\sigma\colon A\cap {\mathcal F}_\sigma^\circ\to \R^m,\quad p_\sigma (\lambda , x)=\lambda.$$
Using Sard's theorem we find a subset $\Sigma_\sigma\subset B^m(\varepsilon)$ of regular values of $p_{\sigma}$ having full measure. The intersection 
$$\Sigma=\bigcap_{\sigma \subset \{1,\ldots ,d\}}\Sigma_\sigma$$
has full measure in $B^m(\varepsilon)$ and consists of regular values for all the maps in (1).

Now we fix $\lambda \in \Sigma$. Then the preimage $p^{-1}(\lambda )\subset A$ has the form $\{\lambda \}\times A_\lambda$ and, by construction,
$$p_\sigma^{-1} (\lambda)=(\{\lambda\}\times A_\lambda)\cap {\mathcal F}_\sigma^\circ ,$$ 
which is a smooth submanifold of $A\cap {\mathcal F}_\sigma^\circ$. Moreover, the tangent space $T_{z'}(A\cap {\mathcal F}_\sigma^\circ )$ at the point $z'=(\lambda, x)\in A\cap {\mathcal F}_\sigma^\circ$ is equal to 
$$T_{z'}(A\cap {\mathcal F}_\sigma^\circ )=T_{z'}\bigl((\{\lambda \}\times A_\lambda)\cap {\mathcal F}_\sigma^\circ\bigr)\oplus \xi_{z'}$$
where the linearized projection 
$$Tp_\sigma (z')\colon T_{z'}(A\cap {\mathcal F}_\sigma^\circ )\to T_{p(z')}\R^m$$
maps $\xi_{z'}$  isomorphically onto $\R^m$.

From our discussion we conclude, in view of the assumption (2) of the theorem,  for $z'=(\lambda, x)\in U(z)$ that the tangent space $T_{z'}(\{\lambda \}\times A_\lambda)$ has a sc-complement in $T^R_{z'}X$. Consequently, $A_\lambda\cap U(z)$ is a smooth submanifold of $X$ in general position.

The argument above applies  to every $z_1,\ldots ,z_k$. Hence for every $z_i$ there exists a subset $\Sigma_{z_i}\subset B^m (\varepsilon)$ of full measure consisting of regular values. The subset $\wh{\Sigma}$, 
$$\wh{\Sigma}=\bigcap_{i=1}^k\Sigma_{z_i}\subset B^m(\varepsilon ),$$
has full measure and it follows, for every $\lambda \in \wh{\Sigma}$, that $A_\lambda\subset X$ is a smooth compact submanifold of the M-polyfold $X$ which, moreover, is in general position.
\qed \end{proof}



\section{Sc-Differential Forms}\label{subs_sc_differential}
Assume $X$ is a M-polyfold. Then $TX\rightarrow X^1$ has the structure of an sc-smooth bundle and 
it is an easy exercise that the associated Whitney sum of $k$-copies $TX\oplus..\oplus TX\rightarrow X^1$ is an sc-smooth bundle.
Following  \cite{HWZ7} we start with the definition.
\begin{definition}
Let $X$ be a M-polyfold and $TX\rightarrow X^1$ its tangent bundle. A sc-differential $k$-form  $\omega$ is a sc-smooth map
$$\omega:\bigoplus_k TX\rightarrow \R$$
 which is linear in each argument and skew-symmetric. 
The vector space of sc-differential k-forms on $X$ is denoted by $\Omega^k(X)$. \index{$\Omega^k(X)$}
\end{definition}

By means of the inclusion maps $X^i\rightarrow X$ the 
sc-differential $k$-form $\omega$ on $X$ pulls back to a sc-differential $k$-form on $X^i$, defining this way the directed system
$$
\Omega^k(X)\to \ldots \to  \Omega^k(X^i)\rightarrow\Omega^{k}(X^{i+1}\to \ldots 
$$
We denote the direct limit of the system by $\Omega_\infty^\ast (X)$\index{$\Omega_\infty^\ast (X)$}
and introduce the set $\Omega_\infty^\ast (X)$ of sc-differential form on $X_\infty$ by 
$$
\Omega_\infty^\ast (X)=\bigoplus_k \Omega_\infty^k (X).
$$

Next we define the exterior differential. For this we use the Lie bracket of vector fields which has to be generalized to our context.
As shown in \cite{HWZ7} Proposition 4.4,  the following holds.
\begin{proposition}\index{P- Lie bracket}
Let $X$ be a M-polyfold and given two sc-smooth vector fields $A$ and $B$ on $X$ one can define the Lie-bracket by the usual formula which defines
a sc-smooth vector field $[A,B]$ on $X^1$, that is,  
$[A, B]$ is a section of the tangent bundle $T(X^1)\to X^2.$\index{$[A,B]$}
\end{proposition}


In order to define the exterior derivative 
$$d:\Omega^k(X^{i+1})\to \Omega^{k+1}(X^{i}),$$
we take a sc-differential $k$-form and $(k+1)$ sc-smooth vector fields $A_0,A_1,\ldots, A_k$ on $X$ and define $(k+1)$-form $d\omega$ on $X$ by the following familiar formula
\begin{equation*}
\begin{split}
d\omega(A_0,A_1,\ldots, A_k)&=\sum_{i=0}^k(-1)^iD(\omega(A_0,\ldots,\what{A}_i,\ldots, A_k)\cdot A_i \\
&\phantom{=}+ \sum_{i<j} (-1)^{i+j}\omega([A_i,A_j],A_0,\ldots,\what{A}_i,\ldots,\what{A}_j,\ldots,A_k).
\end{split}
\end{equation*}


The exterior derivative $d$ commutes with the inclusion map $X^{i+1}\to X^i$  occurring in the directed system, and consequently induces a map
$$d:\Omega_\infty^\ast (X)\rightarrow\Omega_\infty^\ast (X)$$ 
having the property  $d^2=0$. The pair $(\Omega_\infty^\ast (X), d)$\index{$(\Omega_\infty^\ast (X), d)$} is a graded differential algebra which we call the de Rham complex of the M-polyfold $X$.

\begin{definition}\label{def_de_Rham_cohomology}
The sc-de Rham cohomology of the M-polyfold $X$ is defined as $H^\ast_{sc}(X):=\text{ker}(d)/\text{im}(d)$.\index{$H^\ast_{sc}(X)$}
\end{definition}

There is also a relative version.
If $X$ is a tame M-polyfold the inclusion map $\partial X\rightarrow X$ restricted to local faces is sc-smooth. Local faces are naturally tame M-polyfolds and the same is true for 
the intersection of local faces. Therefore it makes sense to talk about differential forms on $\partial X$ and $\partial X^i$. We define  the differential algebra $\Omega^\ast_\infty(X,\partial X)$ by
$$
\Omega_\infty^\ast(X,\partial X):=\Omega_\infty^\ast(X)\oplus \Omega_\infty^{\ast-1}(\partial X)\index{$\Omega_\infty^\ast(X,\partial X)$}
$$
with differential
$$
d(\omega,\tau)=(d\omega,j^\ast\omega-d\tau)
$$
where $j:\partial X\rightarrow X$ is the inclusion. One easily verifies that $d\circ d=0$ and we denote the associated cohomology by $H^{\ast}_{dR}(X,\partial X)$.

Clearly, a sc-differential $k$-form $\omega\in \Omega^\ast_{\infty}(X)$ induces a classical smooth  differential form 
on a smooth finite-dimensional submanifold $N$ of the M-polyfold $X$.  The following version of Stokes'  theorem holds true.

\begin{theorem}\index{T- Stokes}
Let $X$ be a M-polyfold and let $N$ be an oriented smooth n-dimensional compact tame submanifold of $X$ whose boundary 
$\partial N$, a  union of smooth faces $F$, is equipped with the induced orientation. If $\omega$ is  a sc-differential $(n-1)$-form  on $X$, then 
$$
\int_M d\omega  = \sum_{F} \int_F \omega.
$$
\qed
\end{theorem}
Here, the submanifold $N$ is not assumed to  be face structured.


The sc-smooth map $f:X\to Y$ between two M-polyfolds induces 
the map  $f^\ast:\Omega^\ast_\infty(Y)\rightarrow\Omega^\ast_\infty(X)$ in the usual way. There is also a version of the Poincar\'e Lemma, formulated and proved in \cite{HWZ7}.
The general the theory of sc-differential forms on M-polyfolds can be worked out as for the classical smooth manifolds. We leave it to the reader to carry  out the details.








\chapter{Fredholm Package for M-Polyfolds}\label{sec_package}

Chapter \ref{sec_package}
is devoted to compactness properties 
of sc-Fredholm sections, to their perturbation theory, and to the transversality theory.

\section{Auxiliary Norms}


Recalling Section \ref{section2.5_sb}, we consider the strong bundle 
$$
P\colon Y\rightarrow X
$$
over the 
M-polyfold $X$.  The subset $Y_{0,1}$\index{$Y_{0,1}$ } of biregularity $(0, 1)$\index{Biregularity $(0, 1)$} is a topological space and
the map  $P\colon Y_{0,1}\rightarrow X$ is continuous. 
The fibers $Y_x:=P^{-1}(x)$ have the structure of Banach spaces.

We  first introduce the notion
of an auxiliary norm. This concept allows us to quantify the size of admissible perturbations in the transversality and perturbation theory.
We point out  that our definition is more general than the earlier one  given in \cite{HWZ3}.


\begin{definition}
An {\bf auxiliary norm} \index{D- Auxiliary norm} is a continuous map $N\colon Y_{0,1}\rightarrow{\mathbb R}$, which has the following properties.
\begin{itemize}
\item[(1)]\ The  restriction of $N$ to a fiber is a complete norm.  
\item[(2)]\ If $(w_k)$ is a sequence in $Y_{0,1}$ such that $P(w_k)\rightarrow x$ in $X$
and $N(w_k)\rightarrow 0$, then $w_k\rightarrow 0_x$ in $Y_{0,1}$.
\end{itemize}
\qed
\end{definition}

Any two auxiliary norms are locally compatible according to the later Proposition \ref{peter},  which is an immediate corollary of  the following local comparison result.
\begin{lemma}\label{erde}\index{L- Comparison of  auxiliary norms}
Let $P\colon Y\rightarrow X$ be a strong bundle over the M-polyfold $X$,  and  let   $N\colon Y_{0,1}\rightarrow{\mathbb R}$ be  a continuous map which fiber-wise is a complete norm.
Then the following statements are equivalent.
\begin{itemize}
\item[{\em (1)}]\  $N$ is an auxiliary norm.
\item[{\em (2)}]\ For every $x\in X$  there exists,  for  a suitable open neighborhood $V$ of $x$,  a strong bundle isomorphism 
$\Phi\colon Y\vert V\rightarrow K$ whose underlying sc-diffeomorphism $\varphi\colon V\rightarrow O$ maps $x$ to a point $o\in O$,  and constants $0<c <C$ such that for all $w\in P^{-1}(V)$, 
$$
c\cdot N(w)\leq \abs{h}_1\leq C\cdot N(w),
$$
where $\Phi(w)=(p,h)$. Here $K\rightarrow O$ is a local strong bundle model.
\end{itemize}
\end{lemma}
\begin{proof}

Assume that (1) holds.   We fix  $x\in X$ and choose for a suitable open neighborhood $V=V(x)\subset X$ a  strong bundle isomorphism $\Phi\colon Y\vert V\rightarrow K$, 
where $K\rightarrow O$ is a local strong bundle and  $K\subset U\triangleleft F\subset C\triangleleft F\subset E\triangleleft F$ is the retract  $K=R(V\triangleleft F)$.  Define $q\in O$ by  $(q,0)=\Phi(0_x)$.
An open neighborhood of $0_x\in  Y_{0,1}$ consists of all $w\in Y_{0,1}$ for which the set  of all  $(p,h)=\Phi(w)$ belongs to some open neighborhood of $(q,0)$ in $K_{0,1}$.
In view of the continuity of the function $N\colon Y_{0,1}\to \R$ there exists $\varepsilon>0$ such that $N(y)<1$ for all $y = \Phi^{-1}(p, h)$ satisfying $\abs{p-q}_0+\abs{h}_1<\varepsilon.$
In particular,  $\abs{p-q}_0 <\varepsilon/2$ and $\abs{h}_1=\varepsilon/2$ imply  $N(w)\leq 1$.
Using that $N(\lambda w) =\abs{\lambda} N(w)$ and similarly for the norm $\abs{\cdot }_1$,  we infer  for $y$ close enough to $x$,  
$P(w)= y$, and $\Phi (w)=(p, h)$, that 
$$
N(w)\leq \frac{2}{\varepsilon}\cdot \abs{h}_1.
$$


On the other hand,  assume there is no constant $c>0$ such that 
$$
c\cdot \abs{h}_1\leq N(w)
$$
for $(p,h)=\Phi(w)$ and $p$ close to $q$.  Then we find  sequences $y_k\rightarrow x$ and $(w_k)$ satisfying  $P(w_k)=y_k$ and $\abs{h_k}_1=1$
such that $N(w_k)\rightarrow 0$. Since $N$ is an auxiliary norm,  we conclude that $w_k\rightarrow 0_x$ in $Y_{0,1}$ 
which implies the convergence $\Phi(w_k)=(q_k,h_k)\rightarrow (q,0)$, contradicting  $\abs{h_k}_1=1$.  At this point we have proved that,  given an auxiliary norm $N$,  there exist for every $x\in X$ constants $0<c<C<\infty$ depending on $x$
such  that 
$$
c\cdot N(w)\leq \abs{h}_1\leq C\cdot N(w)
$$
for all $w\in Y_{0,1}$  for which  $P(w)$ is close to $x$ and $(p,h)=\Phi(w)$,  for a suitable strong bundle isomorphism $\Phi$ to a local strong bundle model. Hence (1) implies (2).

The other direction of the proof is obvious: since $N$ is continuous and fiber-wise a complete norm
we see that  the property (1) in  the definition of an auxiliary norm holds.  The estimate  in the statement of the lemma  implies that also property (2) holds.

\end{proof}


As a corollary of the lemma we immediately obtain the following proposition.

\begin{proposition}\index{P- Local equivalence of auxiliary norms}\label{peter}
Let $P\colon Y\rightarrow X$ be a strong bundle. Then there exists an auxiliary norm $N$.
Given two auxiliary norms $N_0$ and $N_1$, then there exists a continuous function $f\colon X\rightarrow (0,\infty)$ such that for all $h\in P^{-1}(x)\subset Y_{0,1}$,  
$$
f(x)\cdot N_0(h)\leq N_1(h)\leq \frac{1}{f(x)}\cdot N_0(h).
$$
\end{proposition}
\begin{proof}
The existence follows from a (continuous) partition of unity argument using the paracompactness of $X$, pulling back by strong bundle maps the standard norm $\abs{\cdot }_1$
to the fibers of the strong bundles. The local compatibility implies the existence of $f$.
\end{proof}

For later considerations we also introduce the notion of a reflexive auxiliary norm, which leads to particularly useful compactness considerations for sc-Fredholm sections.
Consider $P:Y\rightarrow X$, which is a strong bundle over the M-polyfold $X$. 
\begin{definition}\index{D- Reflexive $(0,1)$-fibers} \index{D- Reflexive $1$-fibers}
We say that $P:Y\rightarrow X$ has {\bf reflexive $(0,1)$-fibers} (or more sloppily: {\bf reflexive $1$-fibers}) provided there exists a strong bundle atlas so that for every strong bundle chart
the local model $K\rightarrow O$, has the property that $K\subset C\triangleleft F$, where $F_1$ is a reflexive Banach space.
\qed
\end{definition}

In a strong bundle $P:Y\rightarrow X$ with reflexive $(0,1)$-fibers we can introduce a particular kind of convergence called mixed convergence for a sequence $(y_k)\subset Y_{0,1}$.
It is a  mixture of strong convergence in the base on level $0$ and a weak convergence in the fiber on level $1$.  

\begin{lemma}
Let $P:Y\rightarrow X$ be a strong bundle over a M-polyfold with reflexive $(0,1)$-fibers. Let  $(y_k)\subset Y_{0,1}$ be  a sequence for which $x_k:=P(y_k)$ converges to some $x\in X$ on level $0$.
Given two  a strong bundle charts around $x$, say $\Psi :Y|U(x)\rightarrow K$ and $\Psi': Y|U'(x)\rightarrow K'$, where $K\subset C\triangleleft F$ with $F_1$ being a reflexive Banach space,
and similarly $K'\subset C'\triangleleft F'$, write $(a_k,h_k)=\Psi(y_k)$ and $(a_k',h_k')=\Psi'(y_k)$.  Then $(h_k)\subset F_1$ converges weakly if and only if $(h_k')\subset F_1'$ converges weakly.
\end{lemma}

\begin{proof}
If $\Phi:K\rightarrow K'$
is a strong bundle isomorphism (arising as a transition map) and $\Phi(a,h)=(\phi(a),A(a,h))$, we consider a sequence $(a_k,h_k)\in K$ satisfying $a_k\rightarrow a$ in $E_0$ and 
$h_k\rightharpoonup h$ in $F_1$. The latter implies that $h_k\rightarrow h$ in $F_0$.
Then $\Phi(a_k,h_k)=:(a'_k,h'_k)$ satisfies $a'_k\rightarrow b$ in $E_0'$ and $h'_k\rightarrow  h'$ in $F_0'$.
For large $k$,  the operator norms of continuous linear operators $A(a_k,\cdot )\colon F_1\rightarrow F_1'$ are uniformly bounded.  Therefore,  the sequence 
$(h'_k)=(A(a_k,h_k))$ is bounded in $F_1'$.
From  $h_k\rightarrow h$ in $E_0$ we conclude the convergence  $(a'_k,h'_k)=\Phi(a_k,h_k)\rightarrow \Phi(a,h)=:(a',h')$ in $E_0'\oplus F_0'$. The boundedness of $(h'_k)$ in $F_1'$ and the convergence of $(a'_k,h'_k)$ on level $0$ 
implies the weak convergence $h'_k\rightharpoonup h'$ in $F_1'$. 
\end{proof}
In view of this lemma we can define mixed convergence for sequences in $Y_{0,1}$, where $P:Y\rightarrow X$ has reflexive $(0,1)$-fibers as follows.
 \begin{definition}[{\bf Mixed convergence}]\index{D- Mixed convergence}
 Let $P:Y\rightarrow X$ be a strong bundle over the M-polyfold $X$ having reflexive $(0,1)$-fibers. 
 A sequence $(y_k)\subset Y$ of bi-regularity $(0,1)$, i.e. $y_k\in Y_{0,1}$, is said to be {\bf mixed convergent} to
 an element $y\in Y_{0,1}$ provided $P(y_k)\rightarrow P(y)=:x$ in $X_0$, and there exists a strong bundle chart
 $\Psi:Y|U(x)\rightarrow K\subset E\triangleleft F$ ($F_1$ being reflexive),  
 such  that for  $\Psi(y_k)=(a_k,h_k)$ and $\Psi(y)=(a,h)$  the sequence $h_k$ converges weakly to $h$ in $F_1$,  denoted by $h_k\rightharpoonup h$ in $F_1$.
 We shall write
 $$
 y_k\stackrel{m}{\longrightarrow} y
 $$
if  $y_k$ is mixed convergent to $y$.
\qed
\end{definition}
The next definition introduces the important concept of a reflexive auxiliary norm.
\begin{definition}\index{D- Reflexive auxiliary norm}
Let $P:Y\rightarrow X$ be a a strong bundle over a M-polyfold  with reflexive $1$-fibers. A {\bf reflexive auxiliary norm}
$N:Y_{0,1}\rightarrow [0,\infty)$ is a continuous map possessing  the following properties.
\begin{itemize}
\item[(1)]\ For every $x\in X$ the function $N$,  restricted to the fiber of $Y_{0,1}$ over $x$,  is a complete norm.
\item[(2)]\ If $(y_k)$ is a sequence in $Y_{0,1}$  satisfying  $P(y_k)\rightarrow x$ in $X$ and $N(y_k)\rightarrow 0$,
then $y_k\rightarrow 0_x$ in $Y_{0,1}$.
\item[(3)]\ If $(y_k)\subset Y_{0,1}$ is mixed convergent to $y\in W_{0,1}$, then 
$$
N(y)\leq \text{liminf}_{k\rightarrow 0} N(y_k).
$$
\end{itemize}
\qed
\end{definition}

 A version of Proposition \ref{peter} holds for reflexive auxiliary norms and we leave the proof to the reader.
 In the context of strong bundles over ep-groupoids a similar result is given in Theorem \ref{EXTTT}.
 \begin{proposition}
 Let $P:Y\rightarrow X$ be a strong bundle over a M-polyfold with reflexive $(0,1)$-fibers.
 Then there exists a reflexive auxiliary norm $N$.  Given an auxiliary norm $N_0$ and a reflexive auxiliary norm
 $N_1$ there exists a continuous map $f:X\rightarrow (0,\infty)$ satisfying  for all $y\in Y_{0,1}$ with $x=P(y)$
 $$
 f(x)\cdot N_0(y) \leq N_1(y)\leq \frac{1}{f(x)}\cdot N_0(y).
 $$
 \end{proposition}
 

\section{Compactness Results}




There are several different kinds of compactness requirements on a sc-smooth section which are useful in practice. It will turn out that they are all equivalent for sc-Fredholm sections. We note that compactness is a notion on the $0$-level of $X$.

\begin{definition}
Let $f$ be a sc-smooth section of a strong bundle $P\colon Y\rightarrow X$. 
\begin{itemize}
\item[(1)]\ We say that 
$f$ has a {\bf compact solution set} \index{D- Compact solution set} if  $f^{-1}(0)=\{x\in X\ \vert \, f(x)=0\}$ is compact in $X$ (on level $0$).
\item[(2)]\ The section  $f$ is called {\bf weakly proper} \index{D- Weakly proper}
if  it has a compact solution set and if for every auxiliary norm $N$ there exists an open neighborhood
$U$ of $f^{-1}(0)$ such  that for every $\ssc^+$-section $s$ having support in $U$  and satisfying $N(s(y))\leq 1$ for all $y$,  the solution set 
$$
\{x\in X\,  \vert \, f(x)=s(x)\}
$$
is compact in $X$. 
\item[(3)]\ The section  $f$ is called {\bf  proper} \index{D- Proper} if $f$ has a compact solution set and if for  every auxiliary norm $N$ there exists an open neighborhood $U$ of
$f^{-1}(0)$ such that the closure in $X_0$ of the set $\{x\in U\,  \vert \,  N(f(x))\leq 1\}$ is compact.
\end{itemize}
\qed
\end{definition}


In point (3) we adopt the convention  that if $f(x)$ does not have bi-regularity $(0,1)$, then $N(f(x))=\infty$.
Obviously  proper implies weakly proper, which in turn implies compactness.  
$$
\text{\bf proper}\, \Longrightarrow\, \text{\bf weakly proper}\ \  \Longrightarrow\, \text{\bf compact solution set}.
$$

In general, for a sc-smooth section $f$,  these notions are not equivalent.  
The basic result that all previous compactness notions coincide for a sc-Fredholm section is given by the following theorem.

\begin{theorem}\label{x-cc}\index{T- Equivalence of compactness notions}
Assume that $P\colon Y\rightarrow X$ is a strong M-polyfold bundle over the M-polyfold $X$  and $f$ a sc-Fredholm section.
If $f$ has a compact solution set, then $f$ is  proper. In particular,  for a sc-Fredholm section the properties of being  proper,  or being weakly proper, or having a compact solution set are equivalent.
\qed
\end{theorem}

\begin{proof} 

We denote by  $N$ the auxiliary norm on a strong M-polyfold bundle  $P$.  Fixing a solution $x\in X$ of $f(x)=0$, we have  to find an open neighborhood $U\subset X$ of $x$, such  that the closure 
$\cl_{X}(\{y\in U\, \vert \,  N(f(y))\leq 1\})$ is compact. Since $f$ is regularizing,  the point $x$ is smooth. 
There is no loss of generality in assuming  that we work
with a filled version $g$ of $f$ for which we have a $\ssc^+$-section $s$ such  that $g-s$ is conjugated to a basic germ.
 Hence, without loss of generality,  we may  assume that  
 we work in local coordinates and $f=h+t$  where $h\colon {\mathcal O}(C,0)\to \R^N\oplus W$ is a basic germ and $t\colon {\mathcal O}(C,0)\to \R^N\oplus W$ a $\ssc^+$-germ satisfying $t(0)=0$. Here $C$ is the partial quadrant $C=[0,\infty)^k\oplus {\mathbb R}^{n-k}\oplus W$ in the sc-Banach space $E=\R^n\oplus W$. Then it suffices to find in local coordinates an open neighborhood $U$ of $0$ in the partial quadrant $C$ such that 
the closure (on level $0$) of the set 
\begin{equation}\label{eq_est_0_5}
\{(a, w)\in U\; \vert \; \abs{(h+t)(a, w)}_1\leq c\}
\end{equation}
is compact. 

The section  $t$ is a $\ssc^+$-section satisfying  $t(0)=0$. Therefore, we find  a constant $\tau'>0$ such that 

\begin{equation}\label{eq_est_1_5}
\text{$\abs{t(a, w)}_1\leq c$\quad for $(a, w)\in C$ satisfying   $\abs{a}_0<\tau'$, $\abs{w}_0<\tau'.$ }
\end{equation}
We denote by  $P\colon \R^N\oplus W\to W$ the sc-projection.   By assumption, $h$ is a basic germ and hence $P\circ h$ is of the form 
$$P\circ h(a, w)=w-B(a, w)\quad \text{for $(a, w)\in C$ near $0$.}$$
Here  $B$ is a sc-contraction germ. Moreover, $({\mathbbm 1}-P)h$ takes values in $\R^N$,  so that its range consists of smooth point. 
In view of the sc-contraction property of $B$ and since any two norms on $\R^N$ are equivalent, replacing $\tau'>0$ by a smaller number,  we may assume that the estimates 

\begin{equation}\label{eq_est_2_5}
\abs{B(a, w)-B(a, w')}_0\leq \dfrac{1}{4}\abs{w-w'}_0
\end{equation}
and
\begin{equation}\label{eq_est_2_5b}
\abs{({\mathbbm 1}-P)h(a, w)}_1\leq c
\end{equation}
are satisfied 
for all $(a, w), (a, w')\in C$ such that $\abs{a}_0\leq \tau'$, $\abs{w}_0\leq \tau'$,  and $\abs{w'}_0\leq \tau'$.
Since $B(0,0)=0$, we find $0<\tau\leq \tau'$ such that 
\begin{equation}\label{eq_est_3_5}
\abs{B(a, 0)}_0\leq \tau'/8\quad \text{for all $a\in \R^n$ such that  $\abs{a}_0\leq \tau$.}
\end{equation}
We introduce the closed set 
$$\Sigma=\{(a, z)\in \R^n\oplus W\, \vert \, \abs{a}_0\leq \tau,\ \abs{z}_0\leq \tau'/2\}$$
and denote by $\ov{B}(\tau')$ the closed ball in $Y_0$ centered at $0$ and having radius $\tau'$.
Then we  define the map $F\colon \Sigma \times \ov{B}(\tau')\to Y_0$ by 
$$F(a, z, w)=B(a, w)+z.$$
If $(a, z, w)\in \Sigma \times \ov{B}(\tau')$, then
\begin{equation*}
\begin{split}
\abs{F(a, z, w)}_0&\leq \abs{B(a, w)-B(a, 0)}_0+\abs{B(a, 0)}_0+\abs{z}_0\\
&\leq \dfrac{1}{4}\abs{w}_0+\abs{B(a, 0)}_0+\abs{z}_0\leq \tau'/4+\tau'/8+\tau'/2=3\tau'/4<\tau',
\end{split}
\end{equation*}
and, if  $(a, z)\in \Sigma$ and $w, w'\in \ov{B}(\tau')$, then 
$$
\abs{F(a, z, w)-F(a, z, w')}_0=\abs{B(a, w)-B(a, w')}_0\leq \dfrac{1}{4}\abs{w-w'}_0.
$$
We see that $F$ is a parametrized contraction of $\ov{B}(\tau')$, uniform in $(a, z)\in \Sigma$.
 In view of the parametrized Banach fixed point theorem, there exists a unique continuous map $\delta \colon \Sigma \to \ov{B}(\tau')$ satisfying 
 $F(a, z, \delta (a, z))=\delta (a, z)$ for every $(a, z)\in \Sigma$. 
Thus 
 $$\delta (a, z)=B(a, \delta (a, z))+z,\quad \text{for all $(a, z)\in \Sigma$}.$$
In particular, if $(a,z, w)\in \Sigma\times \ov{B}(\tau')$ and $z=w-B(a, w)$, then $w=\delta (a, z).$

Now we define the open neighborhood $U$ of $0$ in $C$ by 
 \begin{equation}\label{eq_est_4_5}
 U=\{(a, w)\, \vert \, \abs{a}_0<\tau,\, \abs{w}_0<\tau'/4\}.
 \end{equation}
Assume that $(a, w)\in U$ and  that $z'=h(a, w)$ belongs to $\R^n\oplus Y_1$ and satisfies $\abs{z'}_1\leq c$.  Then  
\begin{equation*}
\begin{split}
z'=h(a, w)+t(a, w)&=P\circ h(a, w)+\bigl(({\mathbbm 1}-P)\circ h+t\bigr) (a, w)\\
&=w-B(a, w)+\bigl(({\mathbbm 1}-P)\circ h+t\bigr)(a, w)
\end{split}
\end{equation*}
and 
\begin{equation}\label{eq_est_5}
w-B(a, w)=z\quad \text{where $z=z'-\bigl(({\mathbbm 1}-P)\circ h+t\bigr) (a, w)$}.
\end{equation}
In view of the estimates \eqref{eq_est_1_5} and \eqref{eq_est_2_5b}, 
\begin{equation}\label{eq_est_5_5}
\abs{z}_1\leq 3c. 
\end{equation}
The  norm of $z$ on level $0$,  can be estimated as 
\begin{equation}\label{eq_est_6_5}
\begin{split}
\abs{z}_0&=\abs{w-B(a, w)}_0\leq \abs{w}_0+\abs{B(a, w)}_0\\
&\leq \abs{w}_0+\abs{B(a, w)-B(a, 0)}_0+\abs{B(a, 0)}_0\\
&\leq \abs{w}_0+\dfrac{1}{4}\abs{w}_0+\abs{B(a, 0)}_0\\
&\leq \tau'/4+\tau'/16+\tau'/8=7\tau'/16<\tau'/2. 
\end{split}
\end{equation}
We conclude that  $(a, z,w )\in \Sigma\times \ov{B}(\tau')$ and $w=\delta (a, z).$ 

At this point we can verify the claim that the closure on level $0$ of the set defined in 
\eqref{eq_est_0_5} is compact. With a sequence $(a_n, w_n)\in \{(a, w)\in U\, \vert \, \abs{(h+t)(a, w)}_1<c\}$, we  consider the   corresponding sequence $z_n=w_n-B(a_n, w_n)$ defined by \eqref {eq_est_5}. Then the estimates  \eqref{eq_est_5_5} and \eqref{eq_est_6_5} give 
$$ \abs{z_n}_1\leq 3c \quad  \text{and}\quad  \abs{z_n}_0\leq \tau'/2, $$
which implies that $w_n=\delta (a_n, z_n)$. Since the embedding $E_1\to E_0$ is compact and $a_n\in \R^n$, we conclude, after taking a subsequence,  that $(a_n, z_n)\to (a, z)$ in $E_0=\R^n\oplus W_0$. From the continuity of the map  $\delta$, we deduce the convergence  
$w_n=\delta (a_n, z_n)\to w:=\delta (a, z)$ in $W_0$. Therefore, 
the sequence $(a_n, w_n)$ converges to $(a, w)$ in $E_0$. Since, by assumption, the solution set of $f$ is compact, the proof of the properness of the Fredholm section is complete.

\end{proof}



There are several other useful considerations. The first is the following  consequence of  the local Theorem \ref{save}.
\begin{theorem}[{\bf Local Compactness}]\label{save-1}\index{T- Local compactness}
Assume that $P\colon Y\rightarrow X$ is strong bundle over the M-polyfold $X$ and $f$ a sc-Fredholm section. Then for a given solution  $x\in X$ of  $f(x)=0$ there exists a nested sequence of open neighborhoods $U(i)$ of $x$ on level zero,
say
$$
x\in U(i+1)\subset U(i)\subset X_0,\quad i\geq 0,
$$
such  that, for all $i\geq 0$,  $\cl_{X_0}(\{y\in U(i)\ |\ f(y)=0\})$ is a compact subset of $X_i$. 
\qed
\end{theorem}

The next result shows that compactness, a notion on the $0$-level, also  implies compactness on higher levels.
\begin{theorem}\index{T- Compactness properties}
Assume that $P\colon Y\rightarrow X$ is a strong bundle over the  M-polyfold $X$ and $f$ is a sc-Fredholm section with compact solution set
 $$
S=\{x\in X\, \vert \, f(x)=0\}
$$
 in $X_0$.
Then $S$  is a compact subset of $X_\infty$.
\end{theorem}
\begin{proof}
By assumption $S$ is compact in $X_0$. Since $f$ is regularizing,  $S\subset X_\infty$.
As was previously shown $X_\infty$ is a metric space. Hence we can argue with sequences.
Take a sequence $(x_k)\subset S$. We have to show that it has a convergent subsequence in $X_\infty$.
After perhaps taking a subsequence we may assume that $x_k\rightarrow x\in S$ in $X_0$. 
From  Theorem \ref{save-1} we conclude that $x_k\rightarrow x$ on every level $i$. 
This implies the convergence  $x_k\rightarrow x$ in $X_\infty$.
\end{proof}

We recall that a sc-smooth section $f$ of the strong bundle $Y\rightarrow X$ defines,  by raising the index,  a sc-smooth section
$f^i$ of $Y^i\rightarrow X^i$. In view of the  previous theorem we conclude that a sc-Fredholm section with compact solution set
produces a sc-Fredholm section $f^i$ with compact solution set. Note that it is a priori clear that $f^i$ is sc-Fredholm. Hence we obtain the following corollary.
\begin{corollary}
Let $f$ be a sc-Fredholm section of the strong bundle $P\colon Y\rightarrow X$ over the M-polyfold $X$ and suppose that the solution set $f^{-1}(0)$ is compact.
Then $f^i$ is a sc-Fredholm section of $P^i\colon Y^i\to X^i$ with compact solution set.
\qed
\end{corollary}

Next we consider another compactness property which is very useful in applications and involves reflexive auxiliary norms.
Given an auxiliary norm $N:Y_{0,1}\rightarrow [0,\infty)$ we define $N:Y\rightarrow [0,+\infty]$ by setting $N(y)=+\infty $ if $y\in Y\setminus Y_{0,1}$.
\begin{definition}\index{D- Reflexive local compactness property}\label{DEFX526}
Assume that $P:Y\rightarrow X$ is a strong bundle over a M-polyfold with reflexive $(0,1)$-fiber and let $f$ be an sc-smooth section of $P$,
which in addition is regularizing.
We say that $f$ has the {\bf reflexive local compactness property}  provided for every reflexive auxiliary norm $N$ 
and every point $x\in X$ there exists an open neighborhood $U(x)$ in $X$, i.e. on level $0$, so that 
$\cl_X\left(  \{q\in U(x)\ |\ N(f(x))\leq 1\}\right) $ is a compact subset of $X$. 
\qed
\end{definition}

\begin{proposition}
Assume that $P:Y\rightarrow X$ is a strong bundle over a M-polyfold with reflexive $(0,1)$-fiber and let $f$ be an sc-smooth section of $P$,
which in addition is regularizing and has the reflexive local compactness property.
\begin{itemize}
\item[{\em(1)}]\ If $x\in X_0\setminus X_1$ there exists for every reflexive auxiliary norm $N$ an open neighborhood $V(x)$ in $X_0$ 
such that $N(f(q))>1$ for all $q\in V(x)$.
\item[{\em(2)}]\ Given a reflexive auxiliary norm $N$ and a point $x\in X$ with $N(f(x))>1$ there exists an open neighborhood $V(x)$ such that for every
$q\in V(x)$ it holds that $N(f(q))>1$.
\end{itemize}
\end{proposition}
\begin{proof}
\noindent (1) is a special case of (2) since $N(f(x))=+\infty$.\par

\noindent (2) Assume that $N(f(x))\in (1,\infty]$. 
Arguing indirectly we find $(x_k)$ with $N(f(x_k))\leq 1$ and $x_k\rightarrow x$. 
Define $h_k=f(x_k)$ and note that $(h_k)\subset Y_{0,1}$. Since $N(h_k)\leq 1$ and $P(h_k)\rightarrow x$
we may assume after perhaps taking a subsequence that $h_k\xrightarrow{m} h$ for some $h\in Y_{0,1}$ with $P(h)=x$.
Since $N$ is a reflexive auxiliary norm we must have
$$
N(h)\leq \text{liminf}_{k\rightarrow\infty} N(h_k)\leq 1.
$$
Moreover $h_k\rightarrow h$ in $Y_{0,0}$ implying that $f(x)=h$. Hence $N(f(x))\leq 1$ contradicting $N(f(x))>1$.
\end{proof}

Under the assumptions of the proposition assume that $U$ is an open subset of $X$ so that the closure of $\{x\in U\ |\ N(f(x))\leq 1\}$
is compact. If $x_k\in U$ with $N(f(x_k))\leq 1$ and $x_k\rightarrow x$ on level $0$ it follows that $h_k=f(x_k)$ is mixed convergent 
to $h=f(x)$. Hence $x\in \cl_X(U)$ and $N(f(x))\leq 1$. Hence $\cl_X(\{x\in X\ |\ N(f(x))\leq 1 \})\subset \{x\in\cl_X(U)\ |\ N(f(x))\leq 1\}$.

A very useful result in applications is given by the following theorem, where we refer to \cite{FH2} for an application to SFT.

\begin{theorem}\label{THM528}\index{T- Extension of controlling $(U_\partial, N)$}
Assume that $P:Y\rightarrow X$ is a strong bundle over a tame M-polyfold with reflexive $(0,1)$-fiber.  Suppose that
$f$ is an sc-Fredholm section with compact solution set having the reflexive local compactness property.  Denote by  $N$ a reflexive auxiliary norm and 
with  $S_\partial:=\{x\in \partial X\ |\ f(x)=0\}$ let  $U_\partial \subset \partial X$ be an open neighborhood of $S_\partial$ in $\partial X$ 
so that the closure of the set $\{x\in U_\partial\ |\ N(f(x))\leq 1\}$ is compact.  Then there exists an open neighborhood 
$U$ of $S=\{x\in X\ |\ f(x)=0\}$ having the following properties.
\begin{itemize}
\item[{\em(1)}]\ $U\cap \partial X= U_\partial$.
\item[{\em(2)}]\ The closure of $\{x\in U\ |\ N(f(x))\leq 1\}$ is compact.
\end{itemize}
\end{theorem}
\begin{remark}\index{R- Controlling compactness}
The result says that under suitable assumptions if $(U_\partial, N)$ controls the compactness on the boundary, one 
can construct $(U,N)$ controlling compactness with $U\cap \partial X=U_\partial$.
\end{remark}
\begin{proof}
Pick a point $x_0\in U_\partial$.  Assume first that $N(f(x_0))>1$. Then we find an open neighborhood $U(x_0)$ in $X$ such that
$N(f(x))>1$ for all $x\in U(x_0)$. By perhaps taking a smaller such neighborhood we may assume that $\partial X\cap U(x_0)\subset U_\partial$.
Next assume that $N(f(x_0))\leq 1$. We find an open neighborhood $U(x_0)$ such that $\{x\in U(x_0)\ |\ N(f(x_0))\leq 1\}$ has compact closure.
At this point we have constructed for every $x_0\in U_\partial$ an open neighborhood $U(x_0)$ with one of the two  specified properties.
\begin{itemize}
\item $N(f(x))>1$ for $x\in U(x_0)$ and $U(x_0)\cap \partial X \subset U_\partial$.
\item  $\cl_X(\{x\in U(x_0)\ |\ N(f(x))\leq 1\})$ is compact and $U(x_0)\cap \partial X \subset U_\partial$.
\end{itemize}

The  closure of $\{x\in U_\partial \ |\ N(f(x))\leq 1\}$ is compact and consists of points $q$ with $N(f(q))\leq 1$. For each such point
we have a constructed an open neighborhood $U(q)$ in $X$ such that the closure of $\{p\in U(q)\ |\ N(f(p))\leq 1\}$ is compact.
We find finitely many $\bar{x}_1,...,\bar{x}_\ell\in \partial X$ 
satisfying 
$$
\cl_{X}(\{x\in U_\partial \ |\ N(f(x))\leq 1\})\subset U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell).
$$
Hence 
$$
\cl_{X}(\{x\in U_\partial \ |\ N(f(x))\leq 1\})\subset \{x\in U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell)\ |\ N(f(x))\leq 1\}.
$$
We also have that $(U(\bar{x}_1)\cup...\cup U(\bar{x}_\ell))\cap \partial X\subset U_\partial$.  If $x\in U_\partial \setminus (U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell))$
we must have $N(f(x))>1$. Consider the union 
$$
\wt{U}:= U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell) \cup \bigcup_{x\in U_\partial \setminus (U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell))} U(x).
$$
This is an open subset of $X$ satisfying $\wt{U}\cap \partial X=U_\partial$.   Moreover
the closure of the set $\{x\in \wt{U}\ |\  N(f(x))\leq 1\}$ is compact. Indeed, take a sequence $(x_k)\subset \wt{U}$ satisfying $N(f(x_k))\leq 1$.
Then we must have  $(x_k)\subset U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell)$ and since the closure of each of the finitely many sets $\{x\in U(\bar{x}_i)\ |\ N(f(x))\leq 1\}$
is compact, we see that $(x_k)$ has a convergent subsequence. The set $\{x\in X\setminus \wt{U}\ |\ f(x)=0\}$ is compact 
and we find finitely many $\wt{U}(\wt{x}_i)\subset X\setminus \partial X$, say $i=1,...,e$, covering this compact set so that in addition the closure of each set $\{x\in \wt{U}(\wt{x}_i)\ |\ N(f(x))\leq 1\}$ is compact. 
Finally define 
$$
U = \wt{U}\cup \wt{U}(\wt{x}_1)\cup...\cup \wt{U}(\wt{x}_e).
$$
Then $U\cap \partial X=U_\partial$ and $\cl_X(\{x\in U\ |\ N(f(x))\leq 1\})$ is compact. The proof is complete.
\end{proof}
\begin{remark}\index{R Compactness control}
The theorem is crucial in many of the inductive perturbation arguments occurring in Floer-type 
problems, for example SFT.
\qed
\end{remark}
\section{Perturbation Theory and Transversality}
For the perturbation theory we need to assume that $X$ is tame. This is needed to control the boundary behavior.
Hence let  $P\colon Y\rightarrow X$ be a strong bundle over a tame  M-polyfold.
 We shall study  for a given sc-Fredholm section 
 $f$ the perturbed section $f+s$, where $s\in\Gamma^+(P)$.

We need a supply of $\ssc^+$-sections,  which (in a complete abstract situation) we can only guarantee if we have enough sc-smooth bump functions
(this is a weaker requirement than having sc-smooth partitions of unity. See Appendix \ref{POU} for a more detailed discussion.)
This is,  for example,  the case if $X$ is built on sc-Hilbert spaces.  

\begin{definition}
The  M-polyfold $X$ {\bf admits sc-smooth bump functions} if for every $x\in X$ and every  open neighborhood $U(x)$
there exists a sc-smooth map $f\colon X\rightarrow {\mathbb R}$ satisfying $f\neq 0$ and $\supp(f)\subset U(x)$.
\qed
\end{definition}

In Section  \ref{POU} (Proposition \ref{prop-x5.36}) the following useful statement is proved.

\begin{proposition}
If the M-polyfold $X$ admits sc-smooth bump functions then for every $x\in X$ and every open neighborhood $U(x)$ there exists
a sc-smooth function $f\colon X\rightarrow [0,1]$ satisfying  $f(x)=1$ and $\supp(f)\subset U(x)$. One can even achieve that $f(y)=1$ for all $y$ close to $x$.
\qed
\end{proposition}


We start with an existence result.

\begin{lemma}[{\bf Existence of $\ssc^+$-sections}]
\index{L- Sc$^+$-sections I}
We assume that $P\colon Y\rightarrow X$ is a strong bundle over the tame M-polyfold $X$ which admits sc-smooth bump functions.
Let $N$ be an auxiliary norm for $P$.
Then for every smooth point $x\in X$,  every smooth point $e$ in the fiber $Y_x=P^{-1}(x)$,  and every $\varepsilon>0$ there exists,  for  a given open neighborhood
$U$ of $x$,  a $\ssc^+$-section $s\in \Gamma^+(P)$ satisfying  $s(x)=e$, $\supp (s)\subset U$,  and $N(s(x))<N(e)+\varepsilon$.
\end{lemma}


The proof is an adaption of the proof in \cite{HWZ3}.
\begin{proof}
Since $X$ is metrizable,  it is a normal space. We choose  an open neighborhood $Q$ of $x$ so that $W\vert Q$ is strong bundle isomorphic
to the tame local bundle $p\colon K\rightarrow O$ mapping $x$ into $0\in O$. We find an open neighborhood $Q'$  of $x$  whose closure in $X$
is contained in $Q$.  If we construct $s\in\Gamma^+(W\vert Q)$ with support in $Q'$ we can extend it by $0$ to $X$. 
It suffices to construct a section $s$ suitably in local coordinates.
Hence we work in $K\rightarrow O$ 
and choose a smooth point $e\in p^{-1}(0)$. The open set $Q'$ corresponds to an open neighborhood $O'$ of $0$ contained in $O$.
We write $e=(0,\wt{e})$.
Let $N\colon K\rightarrow {\mathbb R}$
be the auxiliary norm. Using the local strong bundle retraction $R$, we define the $\ssc^+$-section $t\colon O\to K$ by $t(y)=R(y,\wt{e})$, so that $t(0)=(0, \wt{e})=e$.  
If $\varepsilon>0$ there exists $\delta>0$ such that $N(t(y))<N(t(0))+\varepsilon=N(e)+\varepsilon$ for $y\in O$ and $\abs{y}_0<\delta$. Using Proposition \ref{prop-x5.36}, we find a sc-smooth function $\beta\colon O\to [0,1]$ satisfying $\beta (0)=1$ and having support in $O'\cap \{y\in O\, \vert \, \abs{y}_0<\varepsilon\}$. The $\ssc^+$-sections $s(y)=\beta (y)t(y)$ of $K\to O$ has the required properties.
\end{proof}

Next we discuss a  perturbation and transversality result in the case that the M-polyfold does not have a boundary.
Our usual notation will be $P\colon Y\rightarrow X$ for the strong bundle. In case we have an auxiliary norm $N$
and an open subset $U$ of $X$ we denote by $\Gamma^{+,1}_U(P)$\index{Allowable sc$^+$-sections, $\Gamma^{+,1}_U(P)$} the space of all $s\in\Gamma^+(P)$ satisfying  $\supp(s)\subset U$ and $N(s(x))\leq 1$ for all $x\in X$. In our applications  $U$ is the open neighborhood
of the compact solution set of a sc-Fredholm section $f$.  We shall refer to $\Gamma^{+,1}_U(P)$ as the space of {\bf allowable sc$^+$-sections}.
\index{Allowable sc$^+$-sections}
The space  $\Gamma^{+,1}_U(P)$\index{$\Gamma^{+,1}_U(P)$} becomes a metric space with respect to the uniform distance
defined by 
$$
\rho(s,s')=\sup_{x\in X}\{N(s(x)-s'(x))\,  \vert \, x\in X\}.
$$
The metric space  $(\Gamma^{+,1}_U(P),\rho)$ is not complete.


\begin{remark}
We note, however, that if a section  $s$ belongs to the completion of ${\Gamma}^{+,1}_U(P)$,  then the solution set of $f(x)+s(x)=0$ is still compact provided $f$ has a compact solution set and $U$ is an open neighborhood adapted
to the auxiliary norm $N$,  in the sense that $N(f(x))\leq 1$ for $x\in U$,  has the properties stipulated in the  properness result.
\qed
\end{remark}


\begin{theorem}[{\bf Perturbation: interior case}]\label{p:=}\index{T- Perturbation: interior case}
Let $P\colon Y\rightarrow X$ be  a strong bundle over the   M-polyfold $X$ satisfying $\partial X=\emptyset$, and assume that $X$ admits sc-smooth bump functions.
Let $f$ be a sc-Fredholm section with a compact solution set and $N$ an auxiliary norm. Then there exists an open neighborhood
$U$ of the solution set $S=\{x\in X\, \vert \, f(x)=0\}$ such  that for sections $s\in\Gamma^+(P)$ having the property that  
$\supp(s)\subset U$ and  $N(f(x))\leq 1$ for all $x\in X$,  the solution set
$S_{f+s}=\{x\in X\,  \vert \, f(x)+s(x)=0\}$ is compact. Moreover,   there exists a dense subset ${\mathcal O}
$ of the metric space $(\Gamma^{+,1}_U(P),\rho)$ such  that for every $s\in {\mathcal O}$ the solution set $S_{f+s}$ has the property that
$(f+s)'(x)\colon T_xX\rightarrow Y_x$ is surjective for all $x\in S_{f+s}$, i.e. for all $x\in S_{f+s}$ the germ $(f,x)$ is in good position.
In particular,  $S_{f+s}$ is a sub-M-polyfold whose induced structure is equivalent to the structure of a compact smooth manifold
without  boundary.
\qed
\end{theorem}

One can follow the proof of Theorem 5.21 in \cite{HWZ3}. In \cite{HWZ3}  we still worked with splicing cores.
For the convenience of the reader we therefore sketch the proof, the details can be filled in using the arguments  from  \cite{HWZ3}.
\begin{remark}
In \cite{HWZ3} we assume that the fibers of the strong bundle are separable sc-Hilbert spaces. This is in fact not needed
due to an improved  treatment of the compactness in the present text. Also,  originally an auxiliary norm
had to satisfy more properties involving weak convergence, which,  again due to the improved compactness results,  is not needed.
The strategies of the proofs in this more general context are the same.
\qed
\end{remark}

\begin{definition}\label{Def537}\index{D- Transversal to the zero-section}
The  sc-Fredholm section $g$ of the tame strong M-polyfold bundle $P\colon Y\to X$ is called {\bf transversal to the zero-section} if,  at every point $x$ satisfying  $g(x)=0$, 
the linearization $g'(x)\colon T_xX\rightarrow Y_x$ is surjective.
\qed
\end{definition}

\begin{proof}[Theorem \ref{p:=}]
We  choose  $s_0'$ in $\Gamma^{+,1}_{U}(P)$ and for given $\varepsilon>0$ we find $0<\delta<1$ such  that
$$
\abs{s_0'(x)-\delta s_0'(x)}_1\leq \varepsilon/2 \quad  \text{for all $x\in X$}.
$$
Define $s_0=\delta s_0'$. Consider the solution set $S_{f+s_0}$ which we know is compact. 
For every $x\in S_{f+s_0}\subset X_\infty$ we find finitely  many allowable $\ssc^+$-sections $s_1^x,\ldots, s^{k_x}_x$ $\Gamma^{+,1}_U(P)$ such  that the range of 
$(f+s_0)'(x)$ together with the sections $s_j^x$ span $Y_x$.
Then, abbreviating $\lambda=(\lambda_1,\ldots ,\lambda_{k_x})$,  the map
$$
{\mathbb R}^{k_x}\oplus X\rightarrow W, \quad  (\lambda,y)\rightarrow f(y)+s_0(y)+\sum_{j=1}^{k_x} \lambda_j \cdot s^j_x(y)
$$
is a sc-Fredholm section of the obvious pull-back bundle,  in view of the theorem about parameterized perturbations,
Theorem \ref{corro}. We also note that the linearization at the point $(0,x)$ is surjective. In view of  the interior case 
of the implicit function theorem, Theorem \ref{implicit-x}, there exists an open neighborhood $U(x)\subset X$ of $x$
such  that for every $(0,y)$ with $y\in U(x)\cap S_{f+s_0}$ the linearization of the above section is surjective.
We can carry out the above construction for every $x\in S_{f+s_0}$, and  obtain an open covering $(U(x))_{x\in S_{f+s_0}}$
of $S_{f+s_0}$. Hence we find a finite open cover $(U(x_i))_{i=1,\ldots ,p}$.  For every $i$ we have sections 
$s^{j}_{x_i}$, $1\leq j\leq k_{x_i}$.  For simplicity of notation, we list all of  them as $t_1,\ldots,t_m$. Then,  by construction, the section
$$
{\mathbb R}^m\oplus X\rightarrow W, \quad (\lambda,y)\mapsto f(y)+s_0(y)+\sum_{j=1}^m \lambda_j\cdot t_j(y)
$$
is sc-Fredholm,  and its  linearization at every point $(0,x)$ with $x\in S_{f+s_0}$  is surjective. There is a number $\delta_0>0$ such  that
$\abs{\lambda}<\delta_0$ implies $N(\sum_{j=1}^m \lambda_j\cdot t_j(y))<\varepsilon/2$.  By the implicit function theorem
we find an open neighborhood ${\mathcal U}\subset \{\lambda \in \R^m\, \vert \, \abs{\lambda}<\delta_0 \}\oplus X$ of $\{0\}\times S_{f+s_0}$ such that the section 
$$
F\colon {\mathcal U}\rightarrow Y,\quad  F(\lambda,y)=f(y)+s(\lambda,y):=f(y)+s_0(y)+\sum_{j=1}^m \lambda_j\cdot t_j(y)
$$
has a surjective linearization at every solution 
$(\lambda, y)\in {\mathcal U}$ of the equation $F(\lambda,y)=0$. Moreover, $\wt{S}:=F^{-1}(0)$ is a smooth manifold containing $\{0\}\oplus S_{f+s_0}$. 
Taking a regular value $\lambda_0$ for the  projection
$$
\wt{S}\rightarrow {\mathbb R}^m, \quad (\lambda,y)\mapsto  \lambda,
$$ 
it is easily verified  that
$f+s_0+s(\lambda_0, \cdot )$ is transversal to the zero section, see Theorem 5.21 in \cite{HWZ3}. By construction,  $N(s(\lambda_0,y))\leq \varepsilon/2$
and $N(s_0(y)+s(\lambda_0,y))\leq 1-\varepsilon/2$ for all $y$. 
This completes the proof of Theorem \ref{p:=}. 
\end{proof}


\begin{remark}\index{R- On homotopies}\label{rem_homotopy}
In practice we need to homotope from one sc-Fredholm operator
to the other. For example assume that $f_0$ and $f_1$ are sc-Fredholm sections for $P\colon Y\rightarrow X$, 
both transversal to the zero section and having compact solution sets.
 Suppose further that $f_t$, $t\in [0,1]$,  is an interpolating arc satisfying the following.
 First of all, the section 
 $$
 [0,1]\times X\rightarrow Y,\quad (t,x)\rightarrow f_t(x)
 $$
 is sc-Fredholm and has a compact solution set. Now we can use the above construction for a given auxiliary norm
 to find an open neighborhood $U$  of the solution set and a small perturbation $s$ supported in $U$ satisfying 
 $s(t,\cdot )=0$  for $t$ close to $t=0,1$ (we already have transversality at the boundaries) and such  that $(t,x)\mapsto  f_t(x)+s(t,x)$ is transversal to the 
 zero-section. Then the solution set is a compact smooth cobordism between the originally given solution sets  $S_{f_i}$ for $i=0,1$.
Here  we have to deal with the boundary situation which, in this 
special case,  is trivial. The reader will be able to carry out this construction in more detail
 once we have finished  our general discussion of the boundary case.
 \qed
 \end{remark}
 
 The next result shows that under a generic perturbation we are able to bring the solution set into a general position to the boundary
 and achieve the transversality to the zero-section. The solution space is then a smooth manifold with boundary with corners.
 
 \begin{definition}[{\bf General position}]\index{D- General position of $(f,x)$}\label{DEF_539}
Let $P\colon  Y\rightarrow X$ be a strong bundle over the tame  M-polyfold $X$ and let $f$ be a  sc-Fredholm section. We say that $(f,x)$, where $f(x)=0$, is in {\bf general position}
if  $f'(x)\colon T_xX\rightarrow Y_x$ is surjective and the kernel $\ker(f'(x))$ has a sc-complement contained in the reduced tangent space $T^R_xX$.
\qed
\end{definition}

The associated result is the following.
\begin{theorem} [{\bf Perturbation: general position}]\label{thm_pert_and_trans}\index{T- Perturbation: general position}
Assume that we are given a strong bundle $P\colon  Y \rightarrow X$  over the  tame  M-polyfold $X$ which admits sc-smooth bump functions.
Let $f$ be a sc-Fredholm section with compact solution set and $N$ an auxiliary norm. Then there exists an open neighborhood $U$ of the solution set 
$S=\{x\in X\,  \vert \, f(x)=0\}$ such  that for a section $s\in\Gamma^+(P)$ satisfying  $\supp (s)\subset U$ and $N(s(x))\leq 1$ for all $x\in X$,  the solution set
$S_{f+s}=\{x\in X\,  \vert \,  f(x)+s(x)=0\}$ is compact. Moreover,   there exists a dense subset ${\mathcal O}
$ of the metric space $(\Gamma^{+,1}_U(P),\rho)$ such  that,  for every $s\in {\mathcal O}$,  the solution set $S_{f+s}$ has the property 
that for every $x\in S_{f+s}$,  the pair $(f+s,x)$ is in general position.
In particular,  $S_{f+s}$ is a sub-M-polyfold whose induced structure is  equivalent to the structure of a compact smooth manifold with boundary with corners and  $d_{S_{f+s}}(x)=d_X(x)$ for all $x\in S_{f+s}$. 
\end{theorem}

We follow the ideas of the proof of Theorem 5.22 in \cite{HWZ3}.
\begin{proof}
By assumption,  $f$ has a compact solution set $S_f$. Given an auxiliary norm  we can find an open neighborhood $U$ of $S_f$
such  that the solution set $S_{f+s}$ is compact for every section $s\in \Gamma^{+,1}_U(P)$. 

In order to prove the result we will choose  $s_0\in \Gamma^{+,1}_U(P)$ and perturb nearby by introducing
suitable $\ssc^+$-sections. 
We note that  a good approximation of $s_0\in\Gamma^{+,1}_U(P)$ is $\delta s_0$ where  $\delta<1$ is close to $1$ so that we have to find a small perturbation of the latter.
If we take $s_0$ satisfying  $N(s_0(y))\leq 1-\varepsilon$ for all $y\in X$, 
there is no loss of generality assuming that $s_0=0$ by replacing $f+s_0$ by $f$ and $N$ by $cN$ for some large $c$. 
 The general strategy already appears in the proof of Theorem \ref{p:=}.
Here the only complication is that we would like to achieve additional  properties of the perturbed problem. This requires a more sophisticated set-up. 
However, for the reader familiar with finite-dimensional transversality questions, there are no surprises in the proof.

In the next step we choose enough sections
in $\Gamma^{+,1}_U(P)$, say $s_1,\ldots, s_m$ such  that,  near every $(0,x)$ with $x\in S_f$,  the section 
$$
F(\lambda,y)=f(y)+\sum_{i=1}^m\lambda_i\cdot s_i(y)
$$
has suitable properties. Namely,  we require the following properties:
\begin{itemize}
\item[(i)]\ $F'(0,x)\colon  {\mathbb R}^m\oplus T_xX\rightarrow Y_x$ is surjective.
\item[(ii)]\ $\ker(F'(0,x))$ is transversal to ${\mathbb R}^m\oplus  T^R_xX\subset {\mathbb R}^m\oplus T_xX$.
\end{itemize}
The strategy of the proof is the same as the strategy in  the proof of Theorem \ref{p:=}.  We fix a point $(0,x)$ with $x\in S_f$ and observe that if we have $\ssc^+$-sections
so that the properties (i)-(ii) hold at this specific $(0,x)$, then adding more sections,  the properties (i)-(ii) will still hold. 
Furthermore,   if for a section the properties (i)-(ii) hold at the specific $(0,x)$ , then they  will also hold 
at $(0,y)$ for  $y\in S_f$ close to $x$,  say for $y\in U(x)\cap S_f$. As a consequence we only have to find
the desired sections for a specific $x$ and then,  noting that the collection of neighborhoods $(U(x))$ is an open cover of $S_f$, 
we can choose  finitely many  points $x_1,\ldots ,x_p$ such  that the neighborhoods $U(x_1),\ldots , U(x_p)$ cover $S_f$. The collection of sections associated to these finitely many points 
then possesses  the  desired properties. Therefore,  it is enough to give the argument at a general point $(0,x)$ for  $x\in S_f$.
The way to  achieve  property (i) at $(0,x)$ is  as in the proof of Theorem \ref{p:=}. We take enough $\ssc^+$-sections to obtain the surjectivity.
We take a linear subspace $L$ complementing $T_x^RX$ in $T_xX$ and add sections,  which at $x$ span the image $f'(x)L$.  At this point the combined system of sections already satisfies (i) and (ii) and,  
taking the finite union of all these sections,  the desired properties at $(0,x)$ hold. 
By the previous discussion this completes the construction.

Since $S_f$ is compact  and since,  by construction, the section 
$(F,(x,0))$ is in general position at every  point $(0,x)$, we can apply the implicit function theorem to the section
$$
F(\lambda,y)=f(y)+\sum_{i=1}^m \lambda_i\cdot s_i(y).
$$
We deduce  the existence of $\varepsilon>0$ such  that the set 
$$
\wt{S}=\{(\lambda,y)\in {\mathbb R}^m\oplus X\,  \vert \, \text{$\abs{\lambda}<2 \varepsilon$ and $y\in X$}\}
$$
is a smooth manifold with boundary with corners containing $\{0\}\times S_f$. In addition, the  properties (i)-(ii) hold
for all $(\lambda,y)\in \wt{S}$ and not only for the points $(0,x)\in \{0\}\times S_f$.

To be precise,  $\wt{S}\subset {\mathbb R}^m\oplus X$ is a smooth submanifold with boundary with corners 
so that for every $z=(\lambda,x)\in \wt{S}$ the tangent space $T_z\wt{S}$ has a sc-complement in $ T^R_z({\mathbb R}^m\oplus X)$.  If  $p\colon  \wt{S}\rightarrow {\mathbb R}^m$
is  the projection,  the set $p^{-1}(\{\lambda\, \vert \ \abs{\lambda}\leq \varepsilon\})$ is compact. Hence we can apply 
Theorem \ref{SARD} and find,  for a subset $\Sigma$ of $B^m_\varepsilon$ of full measure,   that
the subset $S_\lambda=\{x\in X\,  \vert \,  (\lambda,x)\in \wt{S}\}$ of $X$ is a smooth submanifold with boundary with corners 
having the property  that every point is in general position, so that   for every  point $x\in S_\lambda$ and every parameter $\lambda\in\Sigma$, the tangent space $T_zS_\lambda$ has a sc-complement contained in $T^R_xX$.

\end{proof}

The third result is concerned with a relative perturbation, which vanishes at the boundary in case we already know that at the boundary we are in a good position. If we have a sc-Fredholm germ $(f,x)$ then a {\bf good position}\index{Good position of $(f,x)$} requires $f'(x)$ to be surjective and the
kernel to be in good position to the partial quadrant $C_xX$.

Such a germ would be in {\bf general  position}\index{General position of $(f,x)$} if we require in addition to the  surjectivity of $f'(x)$, that the kernel has a sc-complement in $T^R_xX$.  Clearly general position implies good position.
\begin{remark}\index{R- On general position}
In SFT  we have a lot of algebraic structure combining a possibly 
infinite family of Fredholm problems. In this case perturbations should respect the algebraic structure and genericity in these cases
might mean genericity within the algebraic constraints. In some of these cases general position is not achievable, but one can  still achieve a good
position. The perturbations occurring in such a  context  are very often constructed inductively,
so that at each step the problem is already in good position at the boundary, but has to be extended to a generic problem.
\qed
\end{remark}
The following theorem is a sample result along these lines.


\begin{theorem}[{\bf Perturbation and transversality: good position}]\index{T- Perturbation: good position}\label{THMX5.3.12}
Assume that $P\colon  Y\rightarrow X$ is a strong bundle 
over the the tame  M-polyfold $X$ which admits sc-smooth bump functions.
Let $f$ be a sc-Fredholm section with compact solution set and $N$ an auxiliary norm. Further,  assume 
that,  for every $x\in \partial X$ solving  $f(x)=0$, the pair $(f,x)$ is in good position. Then there exists an open neighborhood
$U$ of the solution set $S=\{x\in X\, \vert \,  f(x)=0\}$ so that,  for every  section $s\in\Gamma^{+,1}_U(P)$,  the solution set
$S_{f+s}=\{x\in X\ |\ f(x)+s(x)=0\}$ is compact. Moreover,  there exists an arbitrarily small section $s\in\Gamma^{+,1}_U(P)$ satisfying $s(x)=0$ near $\partial X$
such  that $f+s$ is transversal to the zero-section and for every $x\in S_{f+s}$ the pair $(f,x)$ is in good position.
In particular,  $S_{f+s}$ is a M-subpolyfold whose  induced structure is equivalent to the structure of a compact smooth manifold with  boundary with corners.
\end{theorem}

\begin{proof}

By our previous compactness considerations there exists,  for a given auxiliary norm $N$,  an open neighborhood $U$ of $S_f$
so that for $s\in \Gamma^{+,1}_U(P)$ the solution set $S_{f+s}$ is compact.
By the usual recipe already used in the previous proofs we can find finitely many sections $s_1,\ldots ,s_m$ in $\Gamma^{+,1}_U(P)$ 
which are vanishing near $\partial X$ so that for every $x\in S_f$ the image $R(f'(x))$ and the $s_i(x)$ span $Y_x$.
Of course, in the present construction we are allowed to have sections which vanish near $\partial X$, since by assumption
for $x\in S_f\cap \partial X$ we are already in good position (which in fact implies that $S_f$ is already a manifold with boundary with corners
near $\partial X$). Then we consider as before the section 
$$
(\lambda,x)\mapsto   f(x)+\sum_{i=1}^m \lambda_i\cdot s_i(x),
$$
and,  for a generic value of $\lambda$, which we can take as small as we wish,  we conclude that the associated section $s_\lambda=
\sum_{i=1}^m \lambda_i\cdot s_i$ has the desired properties.

\end{proof}



The next result deals with a homotopy $t\mapsto f_t$ of sc-Fredholm sections during which also the bundle  changes. 
\begin{definition}[{\bf Generalized compact homotopy}]\label{gen_comp_hom}
Consider two sc-Fredholm sections $f_i$ of tame strong bundles $P_i\colon  Y_i \rightarrow X_i$ having  compact solution sets.
We shall refer to $(f_i,P_i)$ as two {\bf compact sc-Fredholm problem}\index{D- Compact sc-Fredholm problem}. 
Then a {\bf generalized compact homotopy between the two compact  sc-Fredholm problems}\index{D- Compact homotopy}  consists of a tame strong bundle $P\colon  Y\rightarrow X$
and a sc-Fredholm section $f$, where $X$ comes with a sc-smooth surjective map $t\colon  X\rightarrow [0,1]$, so that the preimages
$X_t$ are tame M-polyfolds and $f_t=f|X_t$ is a sc-Fredholm section of the bundle $Y\vert X_t$. Moreover,  $f$ has a compact solution set
and $(f\vert X_i,P\vert Y_i)=(f_i,P_i)$ for $i=0,1$.
\qed
\end{definition}


\begin{remark}
Instead of requiring $(f\vert X_i,P\vert Y_i)=(f_i,P_i)$ for $i=0,1$ one should better require that the problems 
are isomorphic and make this part of the data. But in applications the isomorphisms are mostly clear, so that we allow ourselves
to be somewhat sloppy.
\qed
\end{remark}

\begin{theorem}[{\bf Morse-type structure}]\label{MORSE-type}\index{T- Fredholm homotopy, Morse-type}
We assume that all occurring M-polyfolds admit sc-smooth bump functions. 
Let $f$ be a sc-Fredholm section of the tame strong bundle $P\colon Y\to X$ which is a generalized compact homotopy between the compact Fredholm  problems $(f_i, P_i)$ for $i=0, 1$, as in Definition \ref{gen_comp_hom}.
We assume that $P_i\colon  Y_i\rightarrow X_i$ are  strong bundles over M-polyfolds $X_i$ having no boundaries,  and that  the Fredholm sections $f_i$
are already generic in the sense that for all $x\in S_{f_i}$ the germ $(f_i,x)$ is in general position.
We assume further that $\partial X=X_0\sqcup  X_1$.  Let $N$ be an auxiliary norm on $P$. Then there exists an open neighborhood $U$ 
of the solution set $S_f$ in $X$ such  that,  for all sections $s\in \Gamma^{+,1}_U(P)$,  the solution set $S_{f+s}$ is compact. Moreover,  there exists an arbitrarily small section 
$s_0\in\Gamma^{+,1}_U(P)$ which vanishes near $\partial X$,  possessing the following properties.
\begin{itemize}
\item[{\em (1)}]\ For every $x\in S_{f+s_0}$,  the germ $(f+s_0,x)$ is in general position.
\item[{\em (2)}]\ The smooth function $t\colon  S_{f+s_0}\rightarrow [0,1]$ has only Morse-type critical points.
\end{itemize}
\end{theorem}
\begin{proof}
Applying the  previous discussions we can achieve property  (1) for a suitable section $s_0$. The idea then is to perturb $f+s_0$ further
to achieve also property (2). Note that (1) is still true after a small perturbation.  Hence it suffices to assume that $f$ already has the property that
$(f,x)$ is in good position for all $x$ solving  $f(x)=0$. The solution set $S=\{x\in X\, \vert \, f(x)=0\}$ is a compact manifold
with smooth boundary components. Moreover,  $d(t\vert S)$ has no critical points near $\partial S$ in view of  the assumption
that $(f_i,X_i)$ are  already in general position. If we take a finite number of $\ssc^+$-sections $s_1, \ldots, s_m$ of $P\colon Y\to X$, which vanish near $\partial X$ and are supported near $S$ (depending on the auxiliary  norm $N$),
then the solution set
$\wt{S}=\{(\lambda,x)\,\vert \,  f(x)+\sum_{i=1}^m\lambda_i\cdot s_i(x)=0,\ \abs{\lambda}<\varepsilon\}$ is a smooth manifold for $\varepsilon$ is small enough. Using the classical standard implicit function theorem, we find a family of smooth embeddings $\Phi_\lambda\colon  S\rightarrow \wt{S}$ having the property that $\Phi_0(x)=(0,x)$ and $\Phi_\lambda(S)=\{\lambda\}\times S_\lambda$, where
$S_\lambda=\{y\in X\, \vert \,  f(x)+\sum_{i=1}^m\lambda_i\cdot s_i(y)=0\}$. 

Our aim is to construct the above sections 
$s_i$ in such a way
that, in addition, the map
$$
(\lambda,y)\mapsto d(t\circ\Phi_\lambda(y))\in T_y^\ast S
$$
is transversal at $\{0\}\times S$ to the zero section in cotangent bundle $T^\ast S$.
Then, after having achieved this, the 
parameterized version of Sard's theorem 
will guarantee values of the parameter 
$\lambda$ arbitrarily close to $0$, for which the smooth section
$$
S\ni y\mapsto  d(t\circ\Phi_\lambda(y))\in T^\ast S
$$
is transversal to the zero-section and hence the function $y\mapsto  t\circ\Phi_\lambda(y)$ will be  a Morse function on $S$.
Since $\Phi_\lambda\colon  S\rightarrow S_\lambda$ is a diffeomorphism,  we conclude  that $t\vert S_\lambda$ is a Morse-function.
Having constructed this way the desired section $s_0$, the proof of the theorem will then be complete.

It  remains to construct the desired family of $\ssc^+$-sections $s_1, \ldots ,s_m$.
We fix a critical point $x\in S$ of the function $t\vert S\to [0,1]$, hence $d(t\vert S)(x)=0$. Then $T_xS\subset \ker (dt(x))$. Since $x$ is a smooth point,  
we find a one-dimensional smooth linear sc-subspace $Z\subset T_xX$ such that
$$
T_xX = Z\oplus \ker(dt(x)).
$$
The proof of the following trivial observation is left to the reader.
\begin{lemma}\label{lemma5.29}
For every element $\tau\in T_x^\ast S$ there exists a  uniquely determined sc-operator 
$$
b_\tau \colon  T_xS\to  Z
$$
satisfying 
$$
dt(x)\circ b_\tau = \tau.
$$
If $a\colon  T_xS\rightarrow \ker(dt(x))$ is a sc-operator, then
$$
dt(x)\circ (b_\tau + a) =\tau.
$$
\qed
\end{lemma}

Slightly more difficult is the next  lemma.
\begin{lemma}\label{lemma5.30}
Assume that $\tau \in T^\ast_xS$ is given.  Then there exists a $\ssc^+$-section $s$ with sufficiently small support around $x$ having the following properties.
\begin{itemize}
\item[{\em (1)}]\ $s(x)=0$.
\item[{\em (2)}]\ $f'(x)\circ b_\tau +  (s'(x)\vert T_xS)=0.$
\end{itemize} 
We note that if $a\colon  T_xS\rightarrow T_xS$,  then also property (2) holds with $b_\tau $ replaced by $b_\tau+a$,  in view of $T_xS = \ker(f'(x))$.
\end{lemma}

\begin{proof}
Since $f$ is a sc-Fredholm section and 
$f(x)=0$, 
the linearization 
$$
f'(x)\colon  T_xX\rightarrow Y_x
$$
 is surjective and the kernel is equal to  $T_xS$.
Then $f'(x)\circ b_\tau \colon   T_xS\rightarrow Y_x$ is a sc-operator, i.e.,  the image of any vector in $T_xS$ belongs to $Y_\infty$. 
If this operator is the zero operator we can take $s=0$. Otherwise the operator has a one-dimensional image spanned
by some  smooth point $e\in Y_x$. We are done if we can construct a $\ssc^+$-section $s$ satisfying  $s(x)=0$,  and having support close to $x$, and  
 $s'(x)\vert T_xS\colon  T_xS\rightarrow Y_x$  has a one-dimensional image spanned by $e$,  and
$\ker(s'(0)\vert T_xS)= \ker(f'(x)\circ b_\tau)$. Then a suitable multiple of $s$ does the job. 

Denote by $K\subset T_xS$ the kernel of $f'(x)\circ b_\tau$  and by $L$ a complement of $K$ in $T_xS$. Then $L$ is one-dimensional.
We work now in local coordinates in order to construct $s$. We may assume that $x=0$ and represent $S$ near $0$ as a graph over the tangent space $T_xS$, say $q\mapsto  q+\delta(q)$ with $\delta(0)=0$ and $D\delta(0)=0$. Here $\delta\colon  {\mathcal O}(T_xS,0)\rightarrow V$, where $V$ is a sc-complement of $T_xS$ in the sc-Banach space $E$. The points in $E$ in a neighborhood of $0$ are of  the form
$$
q+\delta(q) + v,
$$
where  $v\in V$. We note that $q+\delta(q)\in O$, where $O$ is the local model for $X$ near $0$.
We split $T_xS=K\oplus L$ and correspondingly write $q=k+l$. Then we can represent  the points in a neighborhood of $0\in E$ in the form
$$
k+l +\delta(k+l) +v.
$$
Choosing  a linear isomorphism $j\colon  L\rightarrow {\mathbb R}$, we define the section $\wt{s}$ for $(k,l,v)$ small by
$$
k+l+\delta(k+l)+v\mapsto  R(k+l +\delta(k+l) +v,\beta(k+l+\delta(k+l)+v)j(l)e),
$$
where $\beta$ has support around $0$ (small) and $\beta$  takes the value $1$ near $0$. The section $s$ is then the restriction of $\wt{s}$ to
$O$. If we restrict $s$ near $0$ to $S$ we obtain 
$$
s(k+l+\delta(k+l)) = R(k+l+\delta(k+l),j(l) e).
$$
Hence  $s(0)=0$,  and the linearization of $s$ at $0$ restricted to $T_xS$ is given by
$$
s'(0)(\delta k+\delta l) = j(\delta l) e.
$$
This implies that $s'(0)\vert T_xS$ and $f'(0)\circ b_\tau$ have the same kernel and their image is spanned by $e$. Therefore,  $s$,  multiplied
by a suitable scalar,  has the desired properties and the proof of Lemma \ref{lemma5.30} is complete.
\end{proof}

Continuing with the proof of Theorem \ref{MORSE-type}  we focus as before on the critical point $x\in S$ of $t\vert S$, which satisfies   $d(t\vert S)(x)=0$. Associated with  a basis  $\tau_1,\ldots  ,\tau_m$ of $T_x^\ast S$ the previous lemma produces the sections $s_1, \ldots ,s_m$.
Consider the solution set $\wt{S}$ of solutions  $(\lambda,y)$ of $f(y)+\sum_{i=1}^m\lambda_i\cdot s_i(y)=0$.   Since $f'(y)$ is onto for all $y\in S$,  the solution set 
$S_\lambda=\{y\, \vert \,  f(y) +\sum_{i=1}^m \lambda_i\cdot s_i(y)=0\}$ is a compact manifold (with boundary) diffeomorphic to 
$S$ if $\lambda$ small. Moreover,  $\wt{S}$ fibers over a neighborhood of zero via the map $(\lambda,y)\mapsto  \lambda$. 

The smooth map
\begin{equation}\label{eqp}
(\lambda,y)\mapsto  d(t\vert S_\lambda)(y)\in T_yS_\lambda.
\end{equation}
is a smooth section of the bundle over $\wt{S}$ whose  fiber at $(\lambda,y)$ is equal to $T_y^\ast M_\lambda$. 




We  show that the linearization of \eqref{eqp} at $(0,x),$ which is a map
$$
{\mathbb R}^d\oplus T_xS\rightarrow T_x^\ast S, 
$$
is surjective. Near $(0,x)\in \wt{S}$ we can parameterize $\wt{S}$,  using the implicit function theorem,  in the form
$$
(\lambda,y)\mapsto  (\lambda,\Phi_\lambda(y))
$$
where  $\Phi_0(y)=y$, and $\frac{\partial\Phi}{\partial\lambda_i}(0,x)=0$.
Using \eqref{eqp}  and the map $\Phi$ we obtain,  after a coordinate change on the base
for  $\lambda$ small and $z\in S$ near $x$, the map 
$$
(\lambda,z)\mapsto  d(t\circ \Phi_\lambda)(z) = dt(\Phi_\lambda(z))T\Phi_\lambda(z),
$$
where $d$ acts only on the $S$-part. By construction,  the section vanishes at $(0,x)$.
Recall that,  by construction,  $\Phi_\lambda(x)=x$. Hence for fixed $\delta \lambda$ the map 
$$
z\mapsto  \sum_{i=1}^m \delta\lambda_i \cdot \frac{\partial\Phi}{\partial\lambda_i}(0,z)
$$
is a vector field defined near  $x\in S$ which vanishes at $x$. Therefore, it has a well-defined linearization at $x$.
The linearization ${\mathbb R}^d\oplus T_xS\rightarrow T_x^\ast S$ at $(0,x)$ is  computed to be the mapping  
\begin{equation}\label{new_eq5_68}
\begin{split}
(\delta \lambda,\delta z)\mapsto &(dt\vert S)'(x)\delta z + dt(x)\biggl(\sum_{i=1}^m \delta\lambda_i\biggl( \frac{\partial\Phi}{\partial\lambda_i}(0,\cdot )\biggr)'(x)\biggr)\\
&=(dt\vert S)'(x)\delta z + \sum_{i=1}^m \delta\lambda_i \cdot dt(x)\circ \biggl(\frac{\partial\Phi}{\partial\lambda_i}(0,\cdot )\biggr)'(x).
\end{split}
\end{equation}
The derivative  $(dt\vert S)'(x)$ determines  the Hessian of the map $t\vert S$ at the point $x\in S$. The argument is complete if we can show that
\begin{equation}\label{question1}
\biggl(\frac{\partial\Phi}{\partial\lambda_i}(0,\cdot )\biggr)'(x) =b_{\tau_i} +a_i,
\end{equation}
where the image of $a_i$ belongs to  $T_xS$.
By the  previous discussion,   $dt(x)\circ b_{\tau_i}=\tau_i$ so that the map \eqref{new_eq5_68} can be rewritten, using $dt(x)\circ a_i=0$, as
$$
(\delta \lambda,\delta z)\mapsto   (dt\vert S)'(x)\delta z + \sum_{i=1}^m \delta\lambda_i \cdot \tau_i,
$$
which then proves our assertion. So, let us show that the identity \eqref{question1} holds. We first linearize the equation
$$
f(\Phi_\lambda(z))+\sum_{i=1}^d \lambda_i s_i(\Phi_\lambda(z))=0
$$
with respect to $\lambda$ at $\lambda=0$, which  gives 
$$
Tf(z)\biggl(\sum_{i=1}^m \delta\lambda_i\cdot \frac{\partial\Phi}{\partial\lambda_i}(0,z)\biggr) +\sum_{i=1}^d \delta\lambda_i\cdot s_i(z)=0.
$$
Next we linearize with respect to $z$ at $z=x$, leading  to 
$$
\sum_{i=1}^m \delta\lambda_i\cdot \biggl(f'(x)\circ \biggl(\frac{\partial\Phi}{\partial\lambda_i}\biggr)'(0,x) + s'_i(x)\vert T_xS\biggr)=0
$$
for all $i=1,\ldots  ,m$. Hence $f'(x)\circ \bigl(\frac{\partial\Phi}{\partial\lambda_i}\bigr)'(0,x) + s'_i(x)\vert T_xS=0$. This implies that 
$\bigl(\frac{\partial\Phi}{\partial\lambda_i}\bigr)'(0,x) =b_{\tau_i} +a_i$, where the image of $a_i$ lies  in the kernel of $f'(x)$, i.e., in  $T_xS$. 
At this point we have proved that the linearization of \eqref{eqp} at $(0,x)$ is surjective. Since the section is smooth,  there exists an open neighborhood $U(x)$ of $x$  in $S$ so that,  if at $(0,y)$ we have $d(t\vert S)(y)=0$, then the linearization of
$(\lambda,z)\rightarrow d(t\vert S_\lambda)(z)$ at $(0,y)$ is surjective.

We can now apply the previous discussion to all points $x$ solving $d(t\vert S)(x)=0$ and,  using the compactness,  we find finitely many such points $x_1,\ldots  ,x_k$
so that the union of all the $U(x_i)$ covers the critical points of $t\vert S$. For every $i$ we have $\ssc^+$-sections $s_1^i,\ldots  ,s_{m_i}^i$ possessing  the desired properties.  In order to simplify the notation we denote the union of these sections by $s_1,\ldots  ,s_d$. Then we consider the solutions of 
$$
f(y)+\sum_{i=1}^d \lambda_i\cdot s_i(y)=0.
$$
Again we denote the solution set by $\wt{S}$. It fibers over an open neighborhood of $0$ in ${\mathbb R}^d$. By construction, 
the smooth map
$$
(\lambda,z)\mapsto  d(t\vert S_\lambda)(z)\in T_zS_\lambda
$$
has,  at every point $(0,y)$ satisfying $d(t\vert S)(y)=0$,  a linearization
$$
{\mathbb R}^d\oplus T_yS\rightarrow T_y^\ast S
$$
which is surjective. Now we take a regular value $\lambda$ (small) for the projection $\wt{M}\rightarrow {\mathbb R}^d$
and find,   by the parameterized version of Sard's theorem, that
$$
d(t\vert S_\lambda)
$$
is indeed a Morse-function. The proof of  Theorem \ref{MORSE-type} is complete.
\end{proof}

\section{Remark on  Extensions of Sc\texorpdfstring{$^+$}{piy}-Sections}
In this section we state a general result concerning the extension of sc$^+$-sections defined over the boundary of a tame M-polyfold
to the whole M-polyfold. The theorem, given without proof, is a special case of a result given in the context of ep-groupoids, i.e.
in the case of local symmetries. More general results are stated and proved in Section \ref{SECR12.3} and Section \ref{SECR14.1}.

Start with a tame M-polyfold $X$ and recall from Proposition \ref{FACE_XXXX} that every point $x\in X$ belongs to precisely
$d_X(x)$-many local faces. These local faces  at a point $x\in X$, as well as their intersections are sub-M-polyfolds of $X$ which contain $x$.
Assume that $P:W\rightarrow X$ is a strong bundle.
\begin{definition}\index{D- Sc$^+$-section over $\partial X$}
A section $s$ of $W|\partial X\rightarrow \partial X$ is called a sc$^+$-section over $\partial X$, provided
for every $x\in \partial X$ the restrictions of $s$ to the local faces are sc$^+$-sections.
\end{definition}
The basic extension result in our situation, which is a special case of Theorem \ref{p-main-p}, is given by the following theorem.
\begin{theorem}[$\partial$-Extension Theorem]\index{T- Extension theorem for sc$^+$-sections}
Assume  $P:W\rightarrow X$ is   a strong bundle over a tame  M-polyfold $X$  admitting  sc-smooth partitions of unity. 
Let $s$ be a sc$^+$-section of $W|\partial X\rightarrow \partial X$ and let 
$N:W\rightarrow [0,\infty]$ be an auxiliary norm.  If $\wt{U}$ is an open neighborhood in $X$
of $\supp(s)$ and $f:X\rightarrow [0,\infty)$ a continuous map  supported in $\wt{U}$, satisfying
$N(s(x))<f(x)$ for all $x\in \supp(s)$.  Then there exists  a sc$^+$-section $\overline{s}$ of $P$
having  the following properties:
\begin{itemize}
\item[\em{(1)}]\ $N(\overline{s}(x))\leq f(x)$ for all $x\in X$.
\item[\em{(2)}]\ $\supp(\overline{s})\subset \wt{U}$.
\item[\em{(3)}]\ $\overline{s}\vert \partial X=s$.
\end{itemize}
\end{theorem}
\begin{proof}
Here is a sketch of the proof.  Using the tameness of $X$ we can employ in suitable local coordinates
the local extension result Proposition \ref{hucky}. Then these local extensions can be glued together
using a sc-smooth partition of unity.
\qed
\end{proof}




\section{Notes on Partitions of Unity and Bump Functions}\label{POU}

An efficient tool for globalizing local construction in M-polyfolds are sc-smooth partitions of unity.

\begin{definition}
A M-polyfold $X$ {\bf admits sc-smooth partitions of unity} if  for every open covering of $X$ there exists a subordinate sc-smooth partition of unity.
\qed
\end{definition}

So far we did not  need sc-smooth partitions of unity for our constructions on M-polyfolds. We would need them, for example, for the construction of sc-connections  M-polyfolds. We point out that a (classically) smooth partition of unity on a Banach space, which is  equipped with a sc-structure,  induces a sc-smooth partition of unity, in view of  Corollary \ref{ABC-y}. However, many Banach spaces do not admit smooth partition of unity subordinate to a given open cover.
Our discussion in this section is based on the survey article \cite{Fry} by Fry  and McManusi on smooth bump functions on Banach spaces. The article contains many interesting open questions.

For many constructions one does not need sc-smooth partitions of unity, but only sc-smooth bump functions.
\begin{definition}
A M-polyfold $X$ admits {\bf admits sc-smooth bump functions} if  for every point $x\in X$
and every open neighborhood $U(x)$ there exists a sc-smooth function $f\colon  X\rightarrow {\mathbb R}$ which is not identically zero and has support in $U(x)$.
\qed
\end{definition}


For example, if $E$ is a Hilbert space with a scalar product $\langle \cdot, \cdot \rangle$ and associated norm $\norm{\cdot }$, the map $x\mapsto \norm{x}^2$, $x\in E$, is smooth. Choosing a smooth function $\beta\colon \R\to \R$ of  compact support and satisfying $\beta (0)=1$, the function $f(x)=\beta (\norm{x}^2)$, $x\in E$, is a smooth, non-vanishing function of bounded support. Therefore, if $E$ is equipped with a sc-structure, the map is a sc-smooth function on the Hilbert space in view of Corollary \ref{ABC-y}. Using the Hilbert structure to rescale and translate, we see that the Hilbert space $E$ admits sc-smooth bump functions.

Currently it is an open problem whether the existence of sc-smooth partition of unity on M-polyfolds $X$ is equivalent to the existence of sc-smooth bump functions. The problem is related to an unsolved classical question in %
Banach spaces: is, in every Banach space, the existence of a single smooth bump function (we can use the Banach space structure to rescale and translate) equivalent 
to the existence of smooth partitions of unity subordinate to given  open  covers? 
For the discussion on this problem we refer to \cite{Fry}.  


Sc-smooth bump functions can be used for the construction of functions having special properties, as the following example shows.

\begin{proposition}\label{prop-x5.36}
We assume that the M-polyfold $X$ admits sc-smooth bump functions. Then for every point $x\in X$ and every open neighborhood
$U(x)$ there exists a sc-smooth function $f\colon  X\rightarrow [0,1]$ with $f(x)=1$ and support in $U(x)$. In addition we can choose  $f$ in such a way 
that $f(y)=1$ for all $y$ near $x$.
\end{proposition}
\begin{proof}
By  assumption,  there exists  a sc-smooth bump function $g$ having support in $U(x)$   and satisfying $g(0)=1$. In order to achieve that the image is contained in $[0,1]$ we choose a smooth map $\sigma\colon  {\mathbb R}\rightarrow [0,1]$
satisfying $\sigma(s)=0$ for $s\leq 1$ and $\sigma(s)=1$ for $s\geq 1$ and define  the sc-smooth function $f$ by $f=\sigma\circ g$. If, in addition, we wish $f$ to be constant near $x$,  we take $f(y)=\sigma(\delta\cdot g(y))$ for  $\delta>1$. 
\end{proof}



The survey paper \cite{Fry} discusses, in particular, bump functions on Banach spaces, which are classically differentiable.

\begin{definition} [{\bf $C^k$-bump function}]  A Banach space $E$ 
{\bf admits a $C^k$- bump function}\index{D- $C^k$- bump function},  if there exists a $C^k$-function 
$f\colon  E\rightarrow {\mathbb R}$,  not identically zero and having bounded support.
Here $k\in \{0, 1, 2, \ldots\}\cup \{\infty\}$.
\qed
\end{definition}

The existence of $C^k$-bump functions on $L_p$ spaces is a consequence of the following result due to Bonic and Frampton, see Theorem 1 in \cite{Fry}.
\begin{theorem}[Bonic and Frampton]\label{Bonic_Frampton}
For the $L_p$-spaces the following holds for the usual $L^p$-norm $\norm{\cdot }$.
Let $p\geq 1$ and let $\norm{\cdot}$ be the usual norm on $L^p$.  

\begin{itemize}
\item[{\em (1)}]\ If $p$ is an even integer,  then $\norm{\cdot }^p$ is of class $C^\infty$.
\item[{\em (2)}]\ If i$p$ s an odd integer, then $\norm{\cdot }^p$ is of class $C^{p-1}$.
\item[{\em (3)}]\ If $p\geq 1$ is not an integer, then $\norm{\cdot }^p$ is of class $C^{[p]}$, where $[p]$ is the integer part of $p$.
\end{itemize}
\qed
\end{theorem}
We deduce immediately for the Sobolev spaces $W^{k,p}(\Omega)$ that  the usual norms 
$$
\norm{u}_{W^{k,p}}^p=\sum_{|\alpha|\leq k} \norm{D^\alpha u}^p_{L_p}.
$$
have  the same differentiability as $\norm{\cdot}_{L_p}$.    



Taking a non-vanishing smooth function $\beta\colon \R\to \R$ of compact support, 
the map $f(x)=\beta (\norm{x}^p)$, is a bump function of $L_p$, whose smoothness depends on $p$ as indicated in Theorem \ref{Bonic_Frampton}.

If 
$\Omega$ is a bounded domain in ${\mathbb R}^n$ and $E=W^{1,4}(\Omega)$ is equipped with the sc-structure $E_m=(W^{1+m,4}(\Omega)$, $m\geq 0$, we deduce from (1) in Theorem \ref{Bonic_Frampton} that $E$ admits sc-smooth bump functions.
In contrast, if  $E=W^{1,3/2}(\Omega)$ is equipped with the  sc-structure  $E_m=W^{1+m,3/2}(\Omega)$, then the straightforward bump function constructed by using (3) of Theorem \ref{Bonic_Frampton} would only be of class $\ssc^1$. Does there exist a sc-smooth bump function on $E$, i.e., sc-smooth and of bounded support in $E$?

The existence of sc-smooth bump functions is a local property.
\begin{definition}
A local M-polyfold model $(O,C,E)$ has the {\bf sc-smooth bump function property} if,   for every $x\in O$ and every open neighborhood
$U(x)\subset O$ satisfying  $\cl_E(U(x))\subset O$,  there exists a  sc-smooth function $f\colon  O\rightarrow {\mathbb R}$ satisfying  $f\neq 0$ and $\supp(f)\subset U(x)$.
\qed
\end{definition}

Clearly,  the following holds.
\begin{theorem}
A M-polyfold $X$ admits sc-smooth bump functions if and only if it admits a sc-smooth atlas whose  the local models have the sc-smooth bump function property.
\qed
\end{theorem}

The following class of spaces have the sc-bump function property.
\begin{proposition}\label{P548}
Assume that $(O,C,E)$ is a local M-polyfold model in which the $0$-level $E_0$ of the sc-Bananch space $E$ is a Hilbert space. 
Then $(O,C,E)$ has the sc-bump function property.
\qed
\end{proposition}

\begin{proof}
Let $\langle \cdot ,\cdot \rangle$ be the inner product and $\norm{\cdot}$ the associated norm of $E_0$. We choose a smooth function $\beta\colon \R\to \R$ of compact support and satisfying $\beta (0)=1$. Then the function $f(x)=\beta (\norm{x}^2)$, $x\in E$, defines, in view of Corollary \ref{ABC-y}, a sc-smooth function on $E$. Using scaling, translating, and composition with the sc-smooth retraction onto $O$ the proposition follows.
\end{proof}



Next we study the question of the existence of sc-smooth partitions of unity.
By definition, a M-polyfold $X$ is paracompact and, therefore, there exist  continuous partitions of unity. Hence  it is not surprising that the existence of sc-smooth partitions of unity is connected to local properties of $X$,  namely to   the local  approximability 
of continuous functions  by sc-smooth functions. 


\begin{definition}\label{approximation_property}
A local M-polyfold model $(O,C,E)$ has the {\bf sc-smooth approximation property} provided the following holds.
Given $(f,V,\varepsilon)$,  where $V$ is an open subset of $O$ such that $\cl_C(V)\subset O$,  $f\colon  O\rightarrow [0,1]$ is a continuous function with support contained  $V$,  and $\varepsilon>0$,
there exists a sc-smooth map $g\colon  O\rightarrow [0,1]$ supported  in  $V$  and satisfying $\abs{f(x)-g(x)}\leq \varepsilon$ for all $x\in O$.
\qed
\end{definition}

\begin{theorem}\label{partition_approximation}
The following two statements are equivalent.
\begin{itemize}
\item[{\em (1)}]\ A M-polyfold $X$ admits sc-smooth partitions of unity subordinate to any given open cover.
\item[{\em (2)}]\ The M-polyfold $X$ admits an atlas consisting of local models having the sc-smooth approximation property.
\end{itemize}
\end{theorem}


\begin{proof} 
Let us first show that (1) implies (2). For the M-polyfold $X$,  we take an atlas of M-polyfold charts $\phi\colon U\to O$. We shall show that the local models $(O, C, E)$ posses  the sc-smooth approximation property. Let $(f,V,\varepsilon)$ be as in Definition \ref{approximation_property}. 
The sc-smooth function $f\circ \phi$ is defined on $\phi^{-1}(O)\subset X$ and we extend it by $0$ to all of $X$ and obtain a continuous function 
$g\colon X\to [0,1]$ whose  support is contained in the open set $W=\phi^{-1}(V)$, satisfying $\cl_X(W)\subset U$. 
Define the open subset $\wt{W}$ of $X$ by
$$
\wt{W}=\{x\in W\, \vert \, g(x)>\varepsilon/4\}.
$$
Then $\cl_X(\wt{W})\subset W$.
For every $x\in \cl_X(\wt{W})$,  there exists open neighborhood $U_x$ of $x$ such that
$\cl_X(U_x)\subset W$ and $\abs{g(x)-g(y)} <\varepsilon/2$ for all $y\in U_x$. Take the  open cover of $X$ consisting of $U_0=\{x\in X\, \vert \, g(x)<\varepsilon/2\}$ and $(U_x)$, $x\in \cl_X(\wt{W})$. By assumption, there exists a subordinate sc-smooth partition of unity consisting of $\beta_0$ with the support in $U_0$ and $(\beta_x)$ supported in $(U_x)$,  $x\in \cl_X(\wt{W})$.  Then we  define the function $\wh{g}\colon  X\rightarrow [0,1]$ by 
$$
\wh{g}(y)=\sum_{x\in \cl_X(\wt{W})} \beta_x(y)g(x).
$$
Since the collection of supports of $\beta_0$ and $(\beta_x)$ is locally finite, the sum is locally finite and, therefore, $\wh{g}$ is sc-smooth.  


We claim that $\abs{g(x)-\wh{g}(x)}<\varepsilon$ for all $x\in X$. In order to show this we first show that $\supp (\wh{g})\subset W$. We assume that $y\in \supp (\wh{g})$ and let 
$(y_k)$ be a sequence  satisfying $\wh{g}(y_k)>0$ and $y_k\rightarrow y$. Since $\wh{g}(y_k)>0$, every open neighborhood of $y$ intersects $\supp (\beta_x)$ for some $x\in \cl_X(W)$. Since  the collection of supports $(\supp (\beta_x))$ is locally finite, there exists an open neighborhood $Q=Q(y)$ of $y$ in $X$ and finitely many points $x_1,\ldots ,x_m$ such that only the supports of the functions $\beta_{x_i}$ intersect  $Q$.
Hence
$$
0<\wh {g}(y_k) =\sum_{i=1}^m \beta_{x_i}(y_k)g(x_i), 
$$
showing  that  $y_k\subset \bigcup_{i=1}^m \cl_X(U_{x_i})\subset W$ for large $k\geq 1$.  Consequently,  $y\in W$ and hence $\supp (\wh{g})\subset W$.

Next, given $z\in U$,  there exists an  open neighborhood $Q=Q(z)$ of $z$ in $X$  such that 
$Q$ intersects only finitely many supports of functions belonging to the partition of unity.
If $Q$ intersects the support of $\beta_0$ and none of the supports of the functions $\beta_x$, then $Q\subset U_0$ and $\wh{g}(y)=0$ for all $y\in Q$. Consequently, 
$$\abs{g(y)-\wh{g}(y)}=\abs{g(y)}<\varepsilon/2<\varepsilon$$
for all $y\in Q$. If $Q$ intersects supports of the functions $\beta_x$, there are finitely many points $x_1,\ldots, x_l$ such that only the supports of the functions $\beta_{x_i}$ intersect  $Q$.
Hence 
$$
\wh{g}(y)=\sum_{i=1}^l \beta_{x_i}(y)g(x_i)\quad  \text{for all $y\in Q$}.
$$
Since $\abs{g(x)-g(y)}<\varepsilon/2$ if $y\in U_x$ and $g(y)<\varepsilon/2$ if $y\in U_0$,  we conclude that 
\begin{equation*}
\begin{split}
|g(y)-\wh{g}(y)|
&=\abs{\beta_0(x)g(y)+\sum_{i=1}^l\beta_{x_i}(y)g(y)-\sum_{i=1}^l \beta_{x_i}(y)g(x_i)}\\
&< \varepsilon/2 +\sum_{i=1}^l \beta_{x_i}(z)\abs{g(y)-g(x_i)}\\
&\leq \varepsilon/2 +(\varepsilon/2)\sum_{i=1}^l \beta_{x_i}(y)< \varepsilon.
\end{split}
\end{equation*}
for all $y\in Q$. 
Consequently, $\abs{g(y)-\wh{g}(y)}< \varepsilon$ for all $y\in U$ and 
$\abs{f(x)-\wh{g}\circ\phi^{-1}(x)}< \varepsilon$ for $x\in O$. This completes the proof that (1) implies (2).  


Next we show that (2) implies (1).  For the M-polyfold $X$ we take an atlas of M-polyfold charts $\phi_\tau\colon U_\tau \to O_\tau$, $\tau \in T$, where the local models $(O_\tau, C_\tau, E_\tau)_{\tau \in T}$ posses  the sc-smooth approximation property. We assume that ${(V_\lambda)}_{\lambda\in\Lambda}$ is an open cover of $X$.
Then there exists a refinement $(W_\lambda)_{\lambda \in \Lambda}$ (some sets may be empty) with the same index set $\Lambda$, which is locally finite so that $W_\lambda\subset V_\lambda$ and  for every $\lambda\in \Lambda$ there exists an index $\tau(\lambda)\in T$ such that $\cl_X(W_\lambda)\subset  U_{\tau(\lambda)}$. 
Since $X$ is metrizable, we find open sets 
$Q_\lambda$ such  that
$$
 Q_\lambda\subset \cl_X(Q_\lambda)\subset W_\lambda
$$
and $(Q_\lambda)_{\lambda \in \Lambda}$ is a locally finite open cover of $X$. Using again  the metrizability  of $X$, we find continuous functions  $f_\lambda\colon  X\rightarrow [0,1]$ satisfying
$$
f\vert Q_\lambda\equiv 1\quad \text{and} \quad  \supp(f_\lambda)\subset W_\lambda.
 $$
 Let $\varepsilon=1/2$, $V_\lambda'=\phi_{\tau(\lambda)}(W_\lambda)$,   and $f_\lambda'=f_\lambda\circ\phi^{-1}_{\tau(\lambda)}$.   In view of the hypothesis (2), for the triple $(f_\lambda', V_\lambda', 1/2)$ there exists  a sc-smooth function $g_\lambda\colon  O_{\tau(\lambda)}\rightarrow [0,1]$ having support in $V_\lambda'$ and satisfying 
 $$
\abs{ f_\lambda'(x)-g_\lambda(x)}< 1/2\quad  \text{for all $x\in O_{\tau(\lambda)}$}.
$$
Going back to $X$ and extending $g_\lambda\circ \phi_{\tau (\lambda)}^{-1}$ onto $X$ by $0$ outside of $W_\lambda$,  we obtain the sc-smooth functions $\wh{g}_\lambda\colon  X\rightarrow [0,1]$ satisfying
$\wh{g}_{\lambda}(x)>0$ for $x\in Q_\lambda$. Then we define 
$\gamma_\lambda\colon  X\rightarrow [0,1]$ by
$$
\gamma_\lambda(x)=\frac{\wh{g}_\lambda(x)}{\sum_{\lambda\in\Lambda} \wh{g}_{\lambda}(x)}.
$$
The family of functions  $(\gamma_\lambda)_{\lambda \in \Lambda}$ is the desired sc-smooth partition of unity subordinate to the given open cover $(V_\lambda)$ of $X$. 

\end{proof}


An immediate consequence of Theorem \ref{partition_approximation} is the following result.

\begin{proposition}
Assume that the sc-Banach space admits smooth partitions of unity. Then a local model $(O, C, E)$ has the sc-smooth approximation property.\qed
\end{proposition}


The result below, due to Tor\'unczyk (see \cite{Fry}, Theorem 30),  gives a complete characterization of Banach spaces admitting $C^k$-partitions of unity.
This criterion reduces the question to a problem  in the geometry of Banach spaces. Though this criterion is not easy to apply it serves as one of the main tools in the investigation of the question, see \cite{Fry}. In order to formulate the theorem we need a definition.


\begin{definition}
If  $\Gamma$ is a set, we denote by $c_0(\Gamma)$ the Banach space of functions $f\colon  \Gamma\rightarrow {\mathbb R}$ having the property that for every $\varepsilon>0$
the number of $\gamma\in\Gamma$ with $\abs{f(\gamma)}>\varepsilon$ is finite.  The vector space operations are obvious and the norm is defined by
$$
\abs{f}_{c_0}=\text{max}_{\gamma\in\Gamma} \abs{f(\gamma)}.
$$
A  homeomorphic embedding $h\colon  E\rightarrow c_0(\Gamma)$ is {\bf coordinate-wise $C^k$}, \index{Coordinate-wise $C^k$-embedding}
if for every $\gamma\in\Gamma$ the map $E\rightarrow {\mathbb R}$,  $e\rightarrow (h(e))({\gamma})$ is $C^k$.
\qed
\end{definition}


If $\Gamma=\N$, then 
$c_0({\mathbb N})$ is the usual space $c_0$ of sequences converging to $0$.
\begin{theorem}[Tor\'unczyk's Theorem]
A Banach space $E$ admits a $C^k$-partition of unity if and only if there exists a set $\Gamma$ and a coordinate-wise $C^k$ homeomorphic embedding
of  $E$ into $c_0(\Gamma)$. \qed
\end{theorem}

An important class of Banach spaces are those which are are weakly compactly generated. They have good smoothness properties and  will provide
us with examples of sc-Banach spaces admitting sc-smooth partitions of unity.


\begin{definition}
A Banach space $E$ is called  {\bf weakly compactly generated} (WCG) if there exists a weakly compact set $K$ in $E$ such  that the closure of the span of $K$ is the whole space, 
$$
E=\cl_E(\text{span}(K)).
$$
\qed
\end{definition}

There are  two  useful examples of WCG Banach spaces.
\begin{proposition}
Let $E$ be a Banach space.
\begin{itemize}
\item[{\em (1)}]\ If $E$ is reflexive, then $E$ is WCG.
\item[{\em (2)}]\ If $E$ is separable, then $E$ is WCG.
\end{itemize}
\end{proposition}
\begin{proof}
In case that $E$ is reflexive it is known that the closed unit ball ${B}$ is  compact in the weak topology. Clearly,  $E=\text{span}(B)$.
If $E$ is separable, we  take a dense sequence ${(x_n)}_{n\geq  }$ in the unit ball and 
define $K=\{0\}\cup\{\frac{1}{n}x_n\, \vert \,  n\geq1\}$. Then $K$ is compact and,  in particular,  weakly compact. 
\qed
\end{proof}
The usefulness of WCG spaces lies in the following result from \cite{GTWZ}, see also \cite{Fry},  Theorem 31. 
\begin{theorem}[\cite{GTWZ}]\label{wcg_partition}
If the  WCG-space $E$ admits a $C^k$-bump function, then it also admits  $C^k$-partitions of unity.\qed
\end{theorem}



\begin{corollary}\label{C5417}
Let $(O,C,E)$ be a local model, where $E_0$ is a Hilbert space. Then $(O,C,E)$ has the sc-smooth approximation property.
\end{corollary}
\begin{proof}
A Hilbert space is reflexive and hence a WCG-space. 
We have already seen that a Hilbert space equipped with a sc-structure admits sc-smooth bump functions and conclude from 
Theorem \ref{wcg_partition} that it admits sc-smooth partition of unity, and consequently has the smooth approximation property, in view of Theorem 
\ref{partition_approximation}.
\end{proof}



\chapter{Orientations}\label{ORIENTXX}

In this chapter we introduce the notion of a linearization of a sc-Fredholm section and  discuss orientations and invariants associated to proper sc-Fredholm sections. We refer the reader to \cite{DK} for some of the basic ideas around determinants of linear Fredholm operators,
and to \cite{FH} for applications of the more classical ideas to problems arising in symplectic geometry, i.e. linear Cauchy-Riemann type operators. In polyfold theory, the central issue is that the occurring linear Fredholm operators, which are linearizations of nonlinear sections,
 do in general not depend as operators continuously on the points where the linearization was taken. On the other hand there is some weak continuity
property which allows to introduce orientation bundles. However, it is necessary to develop some new ideas.



\section{Linearizations of Sc-Fredholm Sections}

Let $P\colon Y\rightarrow X$ be a strong bundle over the  M-polyfold $X$ and $f$ a sc-smooth section of $P$.
If $x$ is a smooth point in $X$ and $f(x)=0$, there exists a well-defined {\bf linearization}\index{Linearization} 
$$f'(x)\colon T_xX\rightarrow Y_x$$
which is a sc-operator.  In order to recall the definition, we identify, generalizing 
a classical fact of vector  bundles, the tangent space $T_{0_x}Y$ at the element $0_x$ with the sc-Banach space $T_xX\oplus Y_x$ where $Y_x=P^{-1}(x)$ is the fiber over $x$. Denoting by $P_x\colon T_xX\oplus Y_x\to Y_x$ the sc-projection, the linearization of $f$ at the point $x$ is the following operator,
$$f'(x):=P_x\circ Tf(x)\colon T_xX\to Y_x.$$



As in the case of vector bundles there is, in general, no intrinsic notion of a  linearization of the section $f$ at the smooth point $x$ if $f(x)\neq 0$. However, dealing with a strong bundle we can profit from the additional structure. We simply take a local $\ssc^+$-section $s$ defined near $x$ and satisfying $s(x)=f(x)$, so that the linearization 
$$(f-s)'(x)\colon T_xX\to Y_x$$
is well-defined. To find such a $\ssc^+$-section we take a strong bundle chart around $x$. Denoting the sections in the local charts by the same letters, we let $R$ be the local strong bundle retraction associated with the local strong bundle. It satisfies $R (x, f(x))=f(x)$ and we define the desired section $s$ by $s(y)=R(y, f(x))$.  Since $f(x)$ is a smooth point, $s$ is a $\ssc^+$-section satisfying $s(x)=f(x)$ at the distinguished point $x$, as desired.
If $t$ is another $\ssc^+$-section satisfying $t(x)=f(x)=s(x)$, then 
$$
(f-s)'(x)=(f-t)'(x)+(t-s)'(x)
$$
and the linearization $(t-s)'(x)$ is a $\ssc^+$-operator. It follows from Proposition \ref{prop1.21}, that $(f-s)'(x)$ is a sc-Fredholm operator if and only if $(f-t)'(x)$ is a sc-Fredholm operator, in which case their Fredholm indices agree because a $\ssc^+$-operator is level  wise a compact operator.




Let now $f$ be a sc-Fredholm section of the bundle $P$ and $x$ a smooth point in $X$. Then there exists  a local $\ssc^+$-section $s$ satisfying $s(x)=f(x)$ and, moreover, $(f-s)'(x)$ is a sc-Fredholm operator.




\begin{definition}\index{D- Space of linearizations}\index{$\text{Lin}(f,x)$}\label{LINUXX}
If $f$ is a sc-Fredholm section $f$ of the strong bundle $P\colon Y\rightarrow X$ and $x$ a smooth point in $X$, then the {\bf space of linearizations} of $f$ at $x$ is the set of sc-operators from $T_xX$ to $Y_x$ defined as 
$$
\text{Lin}(f,x)=\{(f-s)'(x)+a\, \vert \,  \text{$a\colon T_xX\to Y_x$ is a $\ssc^+$-operator}\}.
$$
\qed
\end{definition}

The operators in $\text{Lin}(f,x)$\index{$\text{Lin}(f,x)$}
all differ by  linear $\ssc^+$-operators and are all sc-Fredholm operators having the same Fredholm index. Hence the space 
$\text{Lin}(f,x)$ is a convex subset of sc-Fredholm operators $T_xX\rightarrow Y_x$. 
Given an sc-Fredholm section of $P:Y\rightarrow X$ taking the linearizations at smooth points defines over $X_\infty$ some kind of `bundle' $\text{Lin}(f)$
where the fibers are the $\text{Lin}(f,x)$
$$
\text{Lin}(f)\rightarrow X_\infty.
$$
We shall use this structure later on for defining orientations.
For the moment it allows us to define
the {\bf  index of the sc-Fredholm germ $(f,x)$} \index{Index of sc-Fredholm germ}
by
$$
\text{ind}(f,x):=\dim \ker \bigl((f-s)'(x)\bigr)-\dim\bigl(Y_x/(\text{Im}(f-s)'(x))\bigr).\index{$\text{ind}(f,x)$}
$$
We shall show that this index is locally constant. The proof has to cope with the difficulty caused by the fact that, in general, the linearizations do not depend continuously as operators on the smooth point $x$.

Recall that a M-polyfold
is locally path connected, and that,  moreover,  any two smooth points in the same connected component can be connected by a $\ssc^+$-smooth path $\phi\colon [0,1]\rightarrow X$.
\begin{proposition}[Stability of $\text{ind}(f,x)$]\index{P- Stability of $\text{ind}(f,x)$}\label{sst}
Let $P\colon Y\rightarrow X$ be a strong bundle over the tame M-polyfold $X$ and $f$  a sc-Fredholm section. If 
$x_0$ and $x_1$ are smooth points in $X$ connected by a sc-smooth path $\phi\colon [0,1]\rightarrow X$, then
$$
\text{ind}(f,x_0)=\text{ind}(f,x_1).
$$
\end{proposition}
\begin{remark}\index{R- On tameness}
The tameness assumption is in all likelihood not needed. However, it allows to apply a trick.
\end{remark}
\begin{proof}
We shall show that the map $t\mapsto  \text{ind}(f,\phi(t))$ is locally constant. The difficulty is that the linearizations, even if picked sc-smoothly will,  in general,  not depend as operators continuously on $t$. On top of it we have possibly varying  dimensions of the spaces so that we need to change the filled version at every point. However, one can prove the result with a trick, which will also be used 
in dealing with orientation questions later on. We consider the tame M-polyfold $[0,1]\times X$ and consider the graph of the path $\phi$. We fix $t_0\in [0,1]$ and choose  a locally defined $\ssc^+$-section $s(t, x)$ satisfying $s(t,\phi(t))=f(\phi(t))$ for  $(t,x)\in [0,1]\times X$ near  $(t_0,\phi(t_0))$. (We do not need a sc-smooth partition of unity. If we had one  available then we could define such a section $s$ which satisfies  $s(t,\phi(t))=f(\phi(t))$ for all $t\in [0,1]$.) We choose  finitely many smooth points $e_1,\ldots ,e_m$
such  that the image of $(f-s(t_0,\cdot ))'(\phi(t_0))$ together with the $e_i$ span $Y_{\phi(t_0)}$.  Next we take a smooth finite-dimensional
linear subspace $L$ of $T_{\phi(t_0)}X$ which has a sc-complement in $T^R_{\phi(t_0)}X$. Then the image
of $L$ under $(f-s(t_0,\cdot ))'(\phi(t_0))$ is a smooth finite-dimensional subspace of $Y_{\phi(t_0)}$ of dimension $r$, say.
We choose  smooth vectors $p_1,\ldots ,p_r$ spanning this space. Next we take $m+r$ many $sc^+$-sections depending on $(t,x)$ (locally defined)
so that at $(t_0,\phi(t_0))$ they take the different values $e_1,\ldots ,e_m$ and $p_1,\ldots ,p_r$. Now the section
$$
F(\lambda,t,x)= f(x)-s(t,x)+\sum_{i=1}^{m+p} \lambda_i\cdot s_i(t,x)
$$
is defined near $(0,t_0,\phi(t_0))$ and takes values in $Y$. The linearization at $(0,t_0,\phi(t_0))$ with respect to the first and second variable
is surjective  and the kernel of the linearization has a complement contained in 
$$
T_{(0,t_0,\phi(t_0))}^R({\mathbb R}^{m+p}\oplus [0,1]\oplus X)={\mathbb R}^{m+p}\oplus T^R_{t_0}[0,1]\oplus T^R_{\phi(t_0)}X.
$$
Hence $\ker(F'(0,t_0,\phi(t_0)))$ is in good position to the boundary. Employing  the implicit function theorem
for the boundary case, we  obtain a solution manifold $S$ of $F=0$ containing $(0,t,\phi(t))$ for $t\in [0,1]$ close to $t_0$.
Moreover,  if  $(\lambda,t,x(t))\in S$, then  $\ker(F'(\lambda,t,\phi(t)))=T_{(\lambda,t,\phi(t))}S$ and
$F'(\lambda,t,\phi(t))$ is surjective. Hence 
$$
t\mapsto  \dim(T_{(0,t,\phi(t))}S)
$$
is locally constant for $t\in [0,1]$ near $t_0$. By construction, 
\begin{equation*}
\begin{split}
\text{ind}(f,\phi(t_0))+m+p&=\text{ind}(F,(0,t_0,\phi(t_0)))\\
&=\text{ind}(F,(0,t,\phi(t)))=\text{ind}(f,\phi(t))+m+p.
\end{split}
\end{equation*}
Therefore, $\ind (f,\phi (t_0))=\ind (f,\phi (t))$ for all $t$ near $t_0$.
\qed \end{proof}


\section{Linear Algebra and Conventions}\label{sect_conventions}

In he following  we  are concerned with the orientation  which is  crucial in our applications.
We follow  to a large extent the  appendix in \cite{HWZ5}. The ideas of the previous proof are also useful
in dealing with orientation questions. There we did not use sc-smooth partitions of unity.  {\bf In the following, however,}
{\bf we shall assume the existence of sc-smooth partitions of unity} to simplify the presentation, but the proofs
could be modified arguing as in the index stability theorem.


We begin with standard facts about determinants and wedge products.
Basically all the constructions are natural, but  usually depend on conventions, which have  to be stated apriori.
Since different authors  use different conventions,  their natural isomorphisms can be different.  To avoid these difficulties we state our conventions carefully. 
We also would like to point out that A. Zinger has written a paper dealing with these type of issues, \cite{Zinger}.
He also describes  some of the mistakes occurring in the literature as well as deviating conventions by different authors.
Since the algebraic treatment of SFT (one of the important applications of the current theory)
relies on the orientations
of the moduli spaces and the underlying conventions we give a comprehensive treatment of orientation questions.
  Using  the notation introduced by Zinger in  \cite{Zinger}, we define 
$$
\lambda(E):=\Lambda^{max} E\quad   \text{and}\quad   \lambda^\ast(E):=(\lambda(E))^\ast,\index{$\lambda(E)$}\index{$\lambda^\ast(E)$}
$$
where $(\lambda (E))^\ast$ is the dual of the vector space $\lambda(E)$.
A linear map $\Phi\colon E \rightarrow F$ between finite-dimensional vector spaces of the same dimension  induces the linear map
$$
\lambda(\Phi)\colon \lambda(E)\rightarrow\lambda (F), \index{$\lambda(\Phi)$}
$$
defined by $\lambda(\Phi)(a_1\wedge\ldots \wedge a_n):= \Phi(a_1)\wedge\ldots \wedge \Phi(a_n).
$
The  map $\lambda(\Phi)$ is nontrivial if and only if $\Phi$ is an isomorphism. The dual map $\Phi^\ast\colon F^\ast\to E^\ast$ of $\Phi\colon E \rightarrow F$ induces the map 
$$\lambda (\Phi^\ast)\colon \lambda (F^\ast )\to \lambda (E^\ast).$$
Moreover, we denote by 
$$\lambda^\ast  (\Phi)\colon \lambda^\ast  (F )\to \lambda^\ast  (E)$$
the dual of the map $\lambda(\Phi)\colon \lambda(E)\rightarrow\lambda(F)$.
The composition of  the two maps 
$$
E\xrightarrow{\Phi}F\xrightarrow{\Psi} G
$$
between vector spaces of the  same dimension satisfies 
$$
\lambda(\Psi\circ\Phi) =\lambda(\Psi)\circ \lambda(\Phi).
$$
There are different canonical isomorphisms
$$
\lambda ( E^\ast) \rightarrow \lambda^\ast( E)
$$
depending on different conventions. Our convention is the following.


\begin{definition}
If $E$ is a finite-dimensional real vector space and $E^\ast$ its dual,  the {\bf natural isomorphism}
$$
\iota\colon \lambda(E^\ast)\rightarrow\lambda^\ast(E)\index{$\iota\colon \lambda(E^\ast)\rightarrow\lambda^\ast(E)$}
$$
is defined by 
$$\iota( e_1^\ast\wedge\ldots \wedge e_n^\ast)(a_1\wedge \ldots \wedge a_n)=\det (e_i^\ast(a_j)),
$$
where $n=\dim(E)$. If $n=0$, we set 
$\lambda( E^\ast) =\lambda(\{0\}^\ast)=\R$.  
\qed
\end{definition}
From this definition we deduce  for a basis $e_1,\ldots ,e_n$ of $E$ and its dual basis $e_1^\ast,\ldots ,e_n^\ast$  the formula
$$
\iota(e^\ast_1\wedge\ldots \wedge e^\ast_n)=(e_1\wedge\ldots \wedge e_n)^\ast,
$$
where the dual vector $v^\ast$ of  a vector $v\neq 0$ in a one-dimensional vector space is determined by $v^\ast(v)=1$. 

Indeed, 
$$
(e_1\wedge\ldots \wedge e_n)^\ast (e_1\wedge\ldots \wedge e_n)=1= \det((e_i^\ast(e_j))=\iota(e_1^\ast\wedge\ldots \wedge e_n^\ast)(e_1\wedge\ldots \wedge e_n).
$$
The definition of $\iota$ is compatible with the previous definition of induced maps.




\begin{proposition}\index{P- Naturality of $\iota$}
If  $\Phi\colon E\rightarrow F$ is an  isomorphism between two finite-dimensional vector spaces and $\Phi^\ast\colon F^\ast\rightarrow E^\ast$ is its dual, then the following diagram is commutative, 
$$\begin{CD}
\lambda(F^\ast)@>\lambda(\Phi^\ast)>> \lambda(E^\ast)\\
@VV\iota V   @VV\iota V\\
\lambda^\ast(F)@>\lambda^\ast(\Phi)>> \lambda^\ast(E)
\end{CD}$$
\end{proposition}
\begin{proof}
Let $f_1,\ldots ,f_n$ be a basis of $F$ and $f_1^\ast,\ldots ,f^\ast_n$ its dual basis of $F^\ast$. Then we define the basis $e_1,\ldots ,e_n$  of $E$ by  $\Phi(e_i)=f_i$.
Its dual basis in $E^\ast$ is given by 
$e_1^\ast=f_1^\ast \circ \Phi,\ldots , 
e_n^\ast=f_n^\ast \circ \Phi$ and we compute,
\begin{equation*}
\begin{split}
&(\lambda^\ast  (\Phi)\circ\iota(f_1^\ast\wedge\ldots \wedge f^\ast_n))(e_1\wedge\ldots \wedge e_n)\\
&\quad= (\lambda (\Phi^\ast)((f_1\wedge\ldots \wedge f_n)^\ast))(e_1\wedge\ldots \wedge e_n)\\
&\quad = (f_1\wedge\ldots \wedge f_n)^\ast\circ \lambda(\Phi)(e_1\wedge\ldots \wedge e_n)\\
&\quad=(f_1\wedge\ldots \wedge f_n)^\ast(f_1\wedge\ldots \wedge f_n)\\
&\quad= 1.
\end{split}
\end{equation*}
Similarly,
\begin{equation*}
\begin{split}
&( \iota\circ\lambda(\Phi^\ast)(f_1^\ast\wedge\ldots \wedge f_n^\ast))(e_1\wedge\ldots \wedge e_n)\\
&\quad = (\iota( f_1^\ast\circ\Phi\wedge\ldots \wedge f_n^\ast\circ\Phi))(e_1\wedge\ldots \wedge e_n)\\
&\quad =(\iota(e_1^\ast\wedge\ldots \wedge e_n^\ast))(e_1\wedge\ldots \wedge e_n)\\
&\quad = {(e_1\wedge\ldots \wedge e_n)}^\ast(e_1\wedge\ldots \wedge e_n)\\
&\quad =1.
\end{split}
\end{equation*}
Hence
$
\lambda^\ast(\Phi)\circ \iota=\iota\circ \lambda(\Phi^\ast)
$
and the commutativity of the diagram is proved. 
\qed \end{proof}

Next we consider the  exact sequence ${\bm{E}}$ of finite-dimensional linear vector spaces, \index{${\bm{E}}$, exact sequence}
$$
{\bm{E}}:\quad  0\rightarrow A\xrightarrow{\alpha} B\xrightarrow{\beta} C\xrightarrow{\gamma} D\rightarrow 0.
$$
We recall that  the sequence is exact at $B$, for example, if  $\text{im}(\alpha)=\ker (\beta)$. 


We deal with the exact sequence as follows, and  take  a complement $Z\subset B$ of $\alpha (A)$ so that $B=\alpha (A)\oplus Z$, and 
a complement $V\subset C$ of $\beta (B)$ so that  $C=\beta (B)\oplus V$. Then the exact sequence ${\bm{E}}$ becomes 
$$
{\bm{E}}:\quad  0\rightarrow A\xrightarrow{\alpha} \alpha (A)\oplus Z \xrightarrow{\beta} \beta (B)\oplus V\xrightarrow{\gamma} D\rightarrow 0.$$
Here the first  nontrivial map is $a\mapsto (\alpha (a), 0)$, the second is $(b, z)\mapsto 
(\beta (z), 0)$, and the third is $(c,v)\mapsto \gamma (v)$. The maps $\alpha\colon A\to \alpha (A)$, $\beta \colon Z\to \beta (Z)$, and $\gamma \colon V\to D$ are isomorphisms. 
From the exact sequence ${\bm{E}}$ we are going  to construct several natural isomorphisms,  fixing again some  conventions.
The first natural isomorphism is the isomorphism
$$
\Phi_{\bm{E}}\colon \lambda(A)\otimes\lambda^\ast(D)\rightarrow \lambda(B)\otimes\lambda^\ast(C)\index{$\Phi_{\bm{E}}$}
$$
constructed as follows.
We abbreviate $n=\dim(A)$, $m=\dim(B)$, $k=\dim(C)$, and $l=\dim(D)$.  
$\Phi_{\bm{E}}$ maps $0$ to $0$. 
Next we take a nonzero vector
$$
h:=(a_1\wedge\ldots \wedge a_n)\otimes (d_1\wedge\ldots \wedge d_l)^\ast\in \lambda (A)\otimes \lambda^\ast (D),
$$
where  $a_1,\ldots ,a_n$ is a basis of  $A$ and $d_1,\ldots ,d_l$ is a basis for $D$.  Then we define the basis $b_1, \ldots ,b_n$ of $\alpha(A)$ by $b_i=\alpha (a_i)$ and the basis $c_1,\ldots ,c_l$ of $V$ by $\gamma (c_i)=d_i$, $i=1,\ldots ,l$.  Now we  choose a basis $b_1',\ldots ,b_{m-n}'$ of $Z$ and define the basis $c_1',\ldots ,c'_{m-n}$ of $\beta (B)\subset C$ by $c_i'=\beta (b_i')$.
Finally, we define $\Phi_{\bm{E}}(h)\in\lambda(B)\otimes\lambda^\ast(C)$ by 
\begin{equation}\label{eq_Phi_E}
\begin{split}
&\Phi_{\bm{E}}((a_1\wedge \ldots \wedge a_n)\otimes (d_1\wedge \ldots \wedge d_l)^\ast)\\
& = (\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge b_1'\wedge\ldots \wedge b_{m-n}')\otimes (c_1\wedge\ldots \wedge c_l\wedge c_1'\wedge\ldots \wedge c_{m-n}')^\ast.
\end{split}
\end{equation}
The {\bf two conventions}  here are  that 
$b_1',\ldots ,b_{m-n}'$ are listed after the
$\alpha (a_1),\ldots ,\alpha (a_n)$ and
$c_1',\ldots ,c_{m-n}'$ are listed after $c_1,\ldots ,c_l$.
Apart from these two conventions how to list the vectors, the resulting definition does not depend on the choices involved.
\begin{lemma}\label{o6.6}\index{L- Well-definedness of $\Phi_{\bm{E}}$}
With the above two conventions, the definition of $\Phi_{\bm{E}}$ does not depend on the choices.
Hence $\Phi_{\bm{E}}$ is a natural isomorphism. 
\qed
\end{lemma}
The  proof is carried out  in Appendix \ref{oo6.6}.


Later we need to compare specific exact sequences. 
Given two exact sequences ${\bm{E}}$ and ${\bm{E}}'$ we assume that we have the commutative diagram
\begin{eqnarray}\label{EQ6240}
\begin{CD}
0 @>>> A@>\alpha>> B @>\beta >> C @>\gamma >> D @>>> 0\\
@.  @V \mathsf{A} VV  @V \mathsf{B} VV @V \mathsf{C}VV @V \mathsf{D} VV @.\\
0 @>>> A'@>\alpha'>> B' @>\beta' >> C' @>\gamma' >> D' @>>> 0,
\end{CD}
\end{eqnarray}
where the vertical maps are isomorphisms.
The horizontal arrows define linear isomorphisms $\lambda(A)\otimes\lambda^\ast(D)\rightarrow \lambda(B)\otimes\lambda^\ast(C)$ and 
$\lambda(A')\otimes\lambda^\ast(D')\rightarrow \lambda(B')\otimes\lambda^\ast(C')$, respectively.  The vertical arrows induce isomorphisms
which complete the obvious commutative diagram
\begin{eqnarray}\label{EQ62401}
\begin{CD}
\lambda(A)\otimes\lambda^\ast(D)@>>> \lambda(B)\otimes\lambda^\ast(C)\\
@VVV @VVV\\
\lambda(A')\otimes\lambda^\ast(D')@>>> \lambda(B')\otimes\lambda^\ast(C').
\end{CD}
\end{eqnarray}

Let $a_1,...,a_n$ be a a basis of $A$ and $d_1,...,d_\ell$ a basis of $D$. Then the top horizontal arrow is obtained by
extending $b_1=\alpha(a_1),..,b_n=\alpha(a_n)$ via a choice of $b_1',..,b_{m-n}'$ to a basis of $B$. We pick $c_1,..,c_\ell$
so that $\gamma(c_i)=d_i$. Then the $c_i$ are linearly independent. 
Then we consider
the linearly  independent vectors $c_1'=\beta(b_1'),...,c_{m-n}'=\beta(b_{m-n}')$. 
The horizontal arrow maps $(a_1\wedge..\wedge a_n)\otimes (d_1\wedge..\wedge d_\ell)^\ast$ to 
$ (\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge b_1'\wedge\ldots \wedge b_{m-n}')\otimes (c_1\wedge\ldots \wedge c_l\wedge c_1'\wedge\ldots \wedge c_{m-n}')^\ast$.
Using that the vertical arrows are isomorphisms we can map
\begin{eqnarray*}
& a_1,..,a_n \rightarrow \mathsf{A}(a_1),..,\mathsf{A}(a_n)&\\
& \alpha(a_1),..,\alpha(a_n), b_1',..,b_{m-n}'  \rightarrow \mathsf{B}(\alpha(b_1)),..\mathsf{B}(\alpha_n),\mathsf{B}(b_1'),..,\mathsf{B}(b_{m-n}')&\\
&c_1,..,c_\ell,c_1',..,c_{m-n}'\rightarrow \mathsf{C}(c_1),..,\mathsf{C}(c_\ell),\mathsf{C}(c_1'),..\mathsf{C}(c_{m-n}')&\\
&d_1,..,d_\ell\rightarrow \mathsf{D}(d_1),..,\mathsf{D}(d_\ell).&
\end{eqnarray*}
We map for example  $h=(a_1\wedge..\wedge a_n)\otimes(d_1\wedge..\wedge d_\ell)^\ast$ to 
$ (\mathsf{A}(a_1)\wedge..\wedge\mathsf{A}(a_n))\otimes(\mathsf{D}(d_1)\wedge..\wedge\mathsf{D}(d_\ell))^\ast$ for the first vertical arrow.
By the previous lemma the horizontal arrows do not depend on the choices involved. From this it follows
also that the above definition does not depend on the choice. We leave additional arguments to the reader and summarize our findings as follows.
\begin{lemma}\label{LEM624x}
A commutative diagram (\ref{EQ6240}) with vertical maps being isomorphisms induces a natural (depending on our conventions) commutative diagram 
(\ref{EQ62401}).
\qed
\end{lemma}

Associated with the exact sequence ${\bm{E}}$ there exists also a second natural isomorphism\index{$\Psi_{\bm{E}}$}
\begin{equation}\label{secon_iso}
\Psi_{\bm{E}}\colon  \lambda(C)\otimes\lambda(A)\otimes\lambda^\ast(D)\rightarrow \lambda(B)
\end{equation}
constructed as follows.
We first map  
$(c_1\wedge\ldots \wedge c_k)\otimes (a_1\wedge\ldots \wedge a_n)\otimes(d_1\wedge\ldots \wedge d_l)^\ast$ into
$(c_1\wedge\ldots \wedge c_k)\otimes\Phi_{\bm{E}}((a_1\wedge\ldots \wedge a_n)\otimes(d_1\wedge\ldots \wedge d_l)^\ast)$ which belongs to  $\lambda(C)\otimes\lambda(B)\otimes\lambda^\ast(C)$
and then we compose this map  with the  isomorphism
$$
\bar{\iota}\colon \lambda(C)\otimes\lambda(B)\otimes\lambda^\ast(C)\to \lambda (B),
 $$
defined by $v\otimes b\otimes v^\ast\rightarrow b.$ Since $\Phi_{\bm{E}}$ is well-defined, so is $\Psi_{\bm{E}}$. For convenience we present a more explicit formula for  $ \Psi_{\bm{E}}$, using the notations of $\Phi_{\bm{E}}$.


\begin{proposition}\label{oger}\index{P- Well-definedness of $\Psi_{\bm{E}}$}
We fix the basis  $a_1,\ldots ,a_n$ of $A$ and 
the basis $d_1,\ldots ,d_l$ of  $D$ and abbreviate their wedge products by $a$ and by $d$. In the complement of $\beta(B)\subset C$ we have the basis  $c_1,\ldots ,c_l$ defined by $\gamma(c_i)=d_i$.
The vectors  $b_1,\ldots ,b_n\in B$ defined by
$b_i=\alpha(a_i)$ are a basis of  of $\alpha (A)\subset B$, and in the complement of $\alpha(A)$ in $B$ we choose the basis  a $b_1',\ldots ,b_{m-n}'$ and define the basis $c_1',\ldots ,c_{m-n}'$ of $\beta (B)\subset C$ by $c_i'=\beta (b_i')$. Abbreviating 
$c=c_1'\wedge\ldots \wedge c_l'\wedge c_1\wedge\ldots \wedge c_{m-n}$, we obtain the formula
$$
\Psi_{\bm{E}}(c\otimes a\otimes d^\ast)= b_1\wedge\ldots \wedge b_n\wedge b_1'\wedge\ldots \wedge b_{m-n}'\in \lambda (B).
$$
\end{proposition}

\begin{proof}
We already know from Lemma \ref{o6.6} that $\Psi_{\bm{E}}$ is well-defined since $\Phi_{\bm{E}}$ is well-defined. By construction, 
$$
\Phi_{\bm{E}}(a\otimes d^\ast) = (b_1\wedge\ldots \wedge b_n\wedge b_1'\wedge\ldots \wedge b_{m-n}')\otimes (c_1'\wedge\ldots \wedge c'_l\wedge c_1\wedge\ldots \wedge c_{m-n})^\ast.
$$
Here $c_i=\beta(b_i)$ and $\gamma(c_i') =d_i$. Then,  abbreviating the wedge product of the vectors $b_1,\ldots b_n$, 
$b_1', \ldots, b_{n-m}'$ by $b$, we obtain 
\begin{equation*}
\Psi_{\bm{E}}(c\otimes a\otimes d^\ast)
=\bar{\iota}(c\otimes b\otimes c^\ast)
=b.
\end{equation*}
\qed \end{proof}



\section{The Determinant of a Fredholm Operator}

We shall use some of the classical theory of determinants which can be found, for example,  in \cite{Zinger}.
A key fact is that many constructions in this area are naturally isomorphic, which too often is a source 
of sign errors in orientation questions.  It is important to note
that there are usually many natural isomorphisms. Specific ones   depend on a priori conventions, which very often differ from author to author
without being specified.
\begin{definition}\label{def_determinant_1}\index{D- Determinant}\index{$\text{det}(T)$}
The {\bf determinant} $\text{det}(T)$ of a bounded linear Fredholm operator $T\colon E\to F$ between real Banach spaces is the $1$-dimensional real vector space defined by
$$
\text{det}(T)= \lambda( \ker(T))\otimes \lambda^\ast( \text{coker(T)}).
$$
\qed
\end{definition}
An alternative definition used by some authors is  
$$
\text{det} (T)=\lambda(\ker(T))\otimes\lambda(\text{coker}(T)^\ast).
$$
The two definitions are naturally isomorphic given a convention how to identify $\lambda^\ast(A)$ and $\lambda(A^\ast)$. 
\begin{definition}
An {\bf orientation}\index{D- Orientation of $T$} of an Fredholm operator $T\colon E\rightarrow F$ is an orientation of the real line $\det(T)$.
\qed
\end{definition}




We begin this subsection by deriving exact sequences associated to Fredholm operators.  %
\begin{definition}
Let $T\colon E\rightarrow F$ be a Fredholm operator between two Banach spaces. A {\bf good left-projection}\index{D- Good left-projection} for $T$ is a bounded projection $P\colon F\rightarrow F$ having the following two properties.
\begin{itemize}
\item[(1)]\ $\dim(F/R(P))<\infty$.
\item[(2)]\ $R(P\circ T)=R(P)$.
\end{itemize}
By $\Pi_T$\index{$\Pi_T$} we denote the collection of all good left-projections for $T$.
\qed
\end{definition}
In view of (1) the projection $P$ satisfies $\dim \text{coker} (P)=\dim \ker (P)<\infty$. Hence $P$ is a Fredholm operator of index $0$. Since $T$ is Fredholm, the composition $P\circ T$ is Fredholm and $\text{ind}(P\circ T)=\text{ind} (P)+\text{ind} (T)=\text{ind} (T).$
The definition of being a good left-projection has a certain amount of stability build in, as can be seen from the next lemma.
\begin{lemma}
Let  $T_0:E\rightarrow F$ be a Fredholm operator between Banach spaces and $P_0\in\Pi_{T_0}$. Then there exists $\varepsilon>0$ so that 
for every $T\in {\mathcal L}(E,F)$, $P\in {\mathcal L}(F)$ with $P\circ P= P$,  $\norm{T-T_0}<\varepsilon$ and $\norm{P-P_0}<\varepsilon$  it holds that $T$ is Fredholm,
$P\in \Pi_T$, and $\text{ind}(T)=\text{ind}(T_0)$.
\end{lemma}
\begin{proof}
Define $H=(I-P_0)F$ and denote by ${\mathcal P}(F)$ the spaces of bounded linear projections $P:F\rightarrow F$. We define the continuous map
$$
{\mathcal P}(F)\times {\mathcal L}(E,F)\rightarrow {\mathcal L}(E\times H,F):(P,T)\rightarrow \Phi_{(P,T)}
$$
by
$$
\Phi_{(P,T)}(x,h)= P\circ T(x) +(I-P)(h).
$$
We note that $\Phi_{(P_0,T_0)}$ is a surjectve Fredholm operator. Also the subset of Fredholm operators ${\mathcal F}(E\times H,F)$ is open in ${\mathcal L}(E\times H,F)$.
We find $\varepsilon>0$ so that the following holds for $\norm{P-P_0}<\varepsilon$, $\norm{T-T_0}<\varepsilon$.
\begin{itemize}
\item[(1)]\ $\Phi_{(P,T)}\in {\mathcal F}(E\times H,F)$.
\item[(2)]\ $\Phi_{(P,T)}$ is surjective.
\item[(3)]\ $(I-P):H\rightarrow (I-P)(F)$ is surjective.
\item[(4)]\ The dimension of $F/P(F)$ equals that of $F/H$. 
\end{itemize}
From this we immediately conclude that for $\norm{P-P_0}<\varepsilon$ and $\norm{T-T_0}<\varepsilon$
$T:E\rightarrow F$ is Fredholm, $P\circ T:E\rightarrow P(F)$ is surjective, and $R(P)$ has finite co-dimension.
This means that $P\in \Pi_T$.
\qed \end{proof}
\begin{remark}\index{R- On $\det(T)$}
The previous lemma has some important consequence which will be used in later constructions.
If $T_0$ is Fredholm and $P\in \Pi_{T_0}$ then a $T$ near $T_0$ is Fredholm and $P\in \Pi_{T_0}$.
It is an easy exercise that $\ker(PT)$ varies continuously as $T$ (near $T_0$) varies and we obtain
an honest local line bundle. This trivially holds for the cokernel $F/R(PT)=F/R(P)$.
As we shall see there is a natural isomorphism between $\det(T)$ and $\det(PT)$ and this fact will be crucial, since it allows
to define a structure of a linear bundle on the union of all $\det(T)$ as $T$ varies.
\qed
\end{remark}
The set $\Pi_T$ of projections  possesses a {\bf partial ordering}\index{Partial ordering on $\Pi_T$} $\leq $ defined by
$$
\text{$P\leq Q$ \quad if and only if \quad $P=PQ=QP$}.
$$
It is in general not true that for given $P,Q\in\Pi_T$ there exists $L\in\Pi_T$ with $L\leq P$ and $L\leq Q$.
\begin{remark}\label{REM635}
In the context of Hilbert spaces one usually takes $\Pi_T^{orth}$, which is the subset of $\Pi_T$ consisting of orthogonal projections.
In this case there exists for $P,Q\in \Pi_T^{orth}$ a $L\in \Pi_T^{orth}$ with $L\leq Q$ and $L\leq P$. This fact simplifies later constructions in the Hilbert case space. 
This particular case, which is classical and well-known,  was discussed in \cite{HWZ5}.
\qed
\end{remark}
Given two projections $P,Q:F\rightarrow F$ having images with finite co-dimensions, the space $R(P)\cap R(Q)$ has finite co-dimension as well.
\begin{lemma}\label{lem634}
Let $Q:F\rightarrow F$ and $P:F\rightarrow F$ be  two continuous projections which have images of finite co-dimension and let $L:F\rightarrow F$ be a continuous projection  satisfying $R(L)=R(P)\cap R(Q)$. Then the bounded linear operators $LP$ and $LQ$ are projections onto $R(L)$ satisfying
 $LQ\leq Q$ and $LP\leq P$.
 \end{lemma}
 \begin{proof}
For $y\in F$ we compute since $R(L)\subset R(P)$  
$$
LPLP(y)= LLP(y)=LP(y)
$$
and similarly for $LQ$. This shows that $LP$ and $LQ$ are projections. Since $R(L)=R(P)\cap R(Q)$ it follows that $R(LQ)=R(LP)=R(L)$.
Finally we compute that
$$
P(LP) = LP = L(PP)=(LP)P
$$
which precisely means that $LP\leq P$. Similarly it follows that $LQ\leq Q$.
  \qed \end{proof} 


\begin{definition}
Assume  $H\subset F$ is a closed linear subspace with finite co-dimension. 
We denote by ${\mathcal P}_H$\index{${\mathcal P}_H$}
the subset of the space of continuous linear operators ${\mathcal L}(F)$, consisting of projections onto $H$.
\qed
\end{definition}
Continuous projections $P:F\rightarrow F$
with image $H$ are in 1-1 correspondence with closed subspaces $K$ of $F$ satisfying
$$
\dim(K) = \dim(F/H)\ \ \text{and}\ \ \ K\cap H=\{0\}.
$$
Given an ordered pair $(K,K')$ of such linear subspaces, there is an associated linear map $\Gamma_{(K,K')}:K\rightarrow H$ uniquely determined by
\begin{eqnarray}\label{eq635}
K'=\{k+\Gamma_{(K,K')}(k)\ |\ k\in K\}.
\end{eqnarray}
We also note the following trivial result.
\begin{lemma}
Let $P,Q\in {\mathcal P}_H$.  Then 
$$
Q(x) = P(x) + Q((I-P)(x))
$$
for all $x\in F$. 
\end{lemma}
\begin{proof}
By assumption $R(P)=R(Q)=H$. We obtain two   topological direct sum decompositions 
$F=H\oplus (I-P)(F)$ and $F=H\oplus(I-Q)(F)$.  Given $x\in F$ we can write it as 
$$
x= P(x) + (I-P)x = Q(x) +(I-Q)x
$$
and applying $Q$ we find that 
$$
Q(x) =QP(x) +Q(I-P)(x)= P(x)+Q(I-P)(x).
$$
\qed \end{proof}





At the heart of the following constructions are suitable exact sequences.
Associated with  the projection $P\in\Pi_T$ there is the exact sequence\index{${\bm{E}}_{(T,P)}$, exact sequence}
$$
{\bm{E}}_{(T,P)}:\quad 0\rightarrow\ker(T)\xrightarrow{j_T^P} \ker(PT) \xrightarrow{\Phi^P_T} F/R(P)\xrightarrow{\pi_T^P}\text{coker}(T)\rightarrow 0,
$$
where $j_T^P$\index{${\bm{E}}_{(T,P)}$} is the inclusion map, $\pi_T^P$ is  defined by 
$$
\pi_T^P(f+R(P))= (I-P)f+R(T), \ \ f\in F,
$$
  and 
$$
\Phi^P_T(x)=T(x)+R(P),\ \  x\in \ker (PT).
$$
\begin{proposition}\index{P- Exactness of ${\bm{E}}_{(T,P)}$}
The sequence ${\bm{E}}_{(T,P)}$ is exact.
\end{proposition}

\begin{proof}
The inclusion $j_T^P$ is injective and $\Phi^P_T\circ j_T^P=0$. If $\Phi^P_T(x)=0$,  then $T(x)\in R(P)$ implying $(I-P)T(x)=0$.
Since $x\in \ker(PT)$ we conclude $T(x)=0$. This proves exactness at $\ker(PT)$. Assuming  $x\in \ker(PT)$,  hence 
$PT(x)=0$, we compute
\begin{equation*}
\begin{split}
\pi_T^P\circ \Phi^P_T(x)&=\pi_T^P(T(x)+R(P))\\
&=\pi_T^P(T(x)+R(PT))\\
&=(I-P)T(x)+R(T)\\
&=T(x)+R(T)\\
&=R(T),
\end{split}
\end{equation*}
i.e. the composition $\pi_T^P\circ \Phi^P_T$ vanishes. If $\pi_T^P(y+R(P))=0$, hence $(I-P)y\in R(T)$, there exists 
$x\in E$ solving  $T(x)=(I-P)y$. Consequently, 
$$
\Phi_T^P(x) = T(x) + R(P) = (I-P)y+R(P)= y+R(P),
$$
proving the  exactness at $F/R(P)$. Finally we show the surjectivity of the map $\pi_T^P$.
Given $f+R(T)\in \text{coker}(T)$, we  choose  $x\in E$ satisfying  $PT(x)=Pf$ and  compute,
$$
\pi_T^P(f-T(x)+R(P))= (I-P)(f-T(x)) +R(T)= f +R(T),
$$
which finishes the proof of the exactness.
\qed \end{proof}


We discuss the ramifications of the previous discussion.
Starting with the  Fredholm operator $T\colon E\rightarrow F$ and the projection $P\in\Pi_T$ we obtain from  the exact sequence
$$
{\bm{E}}_{(T,P)}:\quad 0\rightarrow\ker(T)\xrightarrow{j_T^P} \ker(PT) \xrightarrow{\Phi^P_T} F/R(P)\xrightarrow{\pi_T^P}\text{coker}(T)\rightarrow 0,
$$
recalling $R(P)=R(PT)$, \index{${\bm{E}}_{(T,P)}$, exact sequence} and employing Lemma \ref{o6.6}
the natural isomorphism
$$
\Phi_{{\bm{E}}_{(T,P)}}\colon\lambda(\ker(T))\otimes\lambda^\ast(\text{coker}(T))\rightarrow \lambda(\ker(PT))\otimes \lambda^\ast(\text{coker}(PT)).
$$
By  definition of the determinant,  this means that
$$
\Phi_{{\bm{E}}_{(T,P)}}\colon  \det(T)\rightarrow \det(PT)
$$
is an isomorphism.
We rename this isomorphism for the further discussion and,  setting $\Phi_{{\bm{E}}_{(T,P)}}=\gamma_T^P$, we have the isomorphism
\begin{eqnarray}\label{EQ6311}
\gamma_T^P\colon \det(T)\rightarrow\det(PT).\index{$\gamma^P_T$}
\end{eqnarray}
It is important to note that the righthand side $\det(PT)$ has a local continuity property when $T$ varies. 
For further constructions it will be important to study (\ref{EQ6311}) if we change $P$ to a $Q$ satisfying $Q\leq P$
and ultimately to $Q$ not order related to $P$.

}


{
We consider the Fredholm operator $T\colon E\rightarrow F$ and the projections $P,Q\in \Pi_T$ satisfying $P\leq Q$, so that  $P=PQ=QP$. Then, as we have already seen, the composition  $QT$ is Fredholm. Moreover, 
$P\in \Pi_{QT}$. Therefore, the associated exact sequences ${\bm{E}}_{(T,P)}$, ${\bm{E}}_{(T,Q)}$, and
${\bm{E}}_{(QT,P)}$ produce the following isomorphisms,
\begin{align*}
\gamma^P_T\colon&\det(T)\rightarrow\det(PT),\\ \gamma^Q_T\colon&\det(T)\rightarrow\det(QT),\\ \gamma^P_{QT}\colon&\det(QT)\rightarrow\det(PT).
\end{align*}
\index{$\gamma^P_T:\det(T)\rightarrow\det(PT)$}\index{$\gamma^Q_T:\det(T)\rightarrow\det(QT)$}
\index{$\gamma^P_{QT}:\det(QT)\rightarrow\det(PT)$}
The crucial observation is the following result, whose proof is postponed to Appendix \ref{oooo6.6}.
\begin{proposition}\label{ooo6.6}
If  $T\colon E\rightarrow F$ is a Fredholm operator and $Q,P\in\Pi_T$ satisfy $P\leq Q$, 
then $QT\colon E\rightarrow F$ is a Fredholm operator and $P\in\Pi_{QT}$. Moreover, 
\begin{eqnarray*}
\gamma^P_{QT}\circ \gamma^Q_T=\gamma^P_T.
\end{eqnarray*}
\qed
\end{proposition}
From Proposition \ref{ooo6.6} we conclude for the three 
projections 
$P, R,S\in \Pi_T$ satisfying $P\leq R$ and $P\leq S$, the relation 
$\gamma^P_{TR}\circ \gamma_T^R=\gamma_T^P=\gamma_{ST}^P\circ \gamma_T^S$, so that the 
diagram
\begin{equation*}
\begin{CD}
\det(T)@> \gamma_T^R >> \det(RT)\\
@VV\gamma_T^S V   @VV\gamma_{RT}^P V\\
\det(ST) @>\gamma_{ST}^P>>  \det(PT)
\end{CD}
\end{equation*}
is commutative, implying the following corollary.
\begin{corollary}\label{KPD}
With the assumptions of Proposition \ref{ooo6.6} the map 
$$
\det(ST)\rightarrow \det(RT), \quad  h\mapsto {(\gamma_{RT}^P)}^{-1}\circ\gamma_{ST}^P(h)
$$
is independent of the choice of $P$ as long as $P\leq S$ and $P\leq R$. Moreover,  this map is equal to the isomorphism 
\begin{eqnarray}\label{EQ6313}
\det(ST)\rightarrow \det(RT),\quad h\mapsto \gamma^R_T\circ {(\gamma_T^S)}^{-1}(h).
\end{eqnarray}
\qed
\end{corollary}
The last statement (\ref{EQ6313})  may be viewed as some kind of transition map for
the isomorphisms  $\det(T)\rightarrow \det(PT)$ and $\det(T)\rightarrow \det(QT)$ provided 
 $P,Q\in \pi_T$ and there exists $S\leq P$ and $S\leq Q$. The important fact is that, as already pointed out,
 $\det(PT)$ and $\det(QT)$ change locally continuously in $T$.
Unfortunately it is  not always possible to find for given $P,Q\in \Pi_T$ a projection $S\in \Pi_T$ with $S\leq P$ and $S\leq Q$.  Therefore we 
need a result comparing the constructions for $P$ and $Q$, both in $\Pi_T$, respectively.  
Recalling Remark \ref{REM635} we would like to point out, that in the Hilbert space  setting, taking only
orthogonal projections the previous constructions are enough to define the general determinant bundle.

For the Banach space case we need to understand the relationship when we use two non-compatible 
projections. In view of Lemma \ref{lem634} given $Q,P\in \Pi_T$ we can find $L\in\Pi_T$
such that $LP, LQ\in \Pi_T\cap {\mathcal P}_{R(Q)\cap R(P)}$, $LP\leq P$ and $LQ\leq Q$. 
This gives us the natural maps
\begin{eqnarray}\label{HKL99}
\det(T)\xrightarrow{\gamma^P_T}\det(PT) \ \ \text{and}\ \ \det(T)\xrightarrow{\gamma^Q_T}\det(QT)
\end{eqnarray}
and we need in principle to understand the continuity property of ${(\gamma^Q_T)}\circ{(\gamma^P_T)}^{-1}$.
In order to simplify this task, one uses the fact that 
the natural maps 
$$
\det(PT)\rightarrow\det(LPT)\ \ \text{and}\ \ \det(QT)\rightarrow \det(LQT)
$$
vary (near $T$) continuously. In view of Proposition \ref{ooo6.6},  it suffices therefore to establish
instead of the (local) continuous dependence on $T$ of the transition map associated to  (\ref{HKL99}),  the continuous dependence
of the  transition maps associated to
$$
\det(T)\xrightarrow{\gamma^P_T}\det(LPT) \ \ \text{and}\ \ \det(T)\xrightarrow{\gamma^Q_T}\det(LQT).
$$
The advantage here is that $LQ,LP\in \Pi_{T}\cap {\mathcal P}_{R(Q)\cap R(P)}$. 
Consider  the following diagram which has exact horizontal rows
$$
\begin{CD}
0@>>> \ker(T)@> j^{LP}_T >> \ker(LPT) @> \Phi^{LP}_T >> F/H @> \pi^{LP}_T >> \text{coker}(T) @>>> 0\\
@.         @|                        @V \bm{?}VV                    @V \bm{??}     VV           @| @.\\
0@>>> \ker(T)@> j^{LQ}_T >> \ker(LQT) @> \Phi^{LQ}_T >> F/H @> \pi^{LQ}_T >> \text{coker}(T) @>>> 0.
\end{CD}
$$
We would like to show that we can fill in for $\bm{?}$ and $\bm{??}$ so that the diagram is commutative 
and so that the `fill-in' maps introduce (locally when $T$ varies) continuous maps between the kernel bundles 
associated to $\ker(LPT)$ and $\ker(LQT)$ and similarly for the constant bundles associated to $F/H$. 
Having the diagram filled in by the maps $\bm{?}$ and $\bm{??}$ will give us in view of Lemma \ref{LEM624x}
$$
\begin{CD}
\det(T)@> \gamma^{LP}_T >> \det(LPT)\\
@|    @V\gamma_{{\bm{?,??}}} VV\\
\det(T) @>\gamma^{LQ}_T >>\det(LQT).
\end{CD}
$$
Of course, since $ \gamma_{\bm{?,??}} = \gamma^{LQ}_T\circ {(\gamma^{LP}_{T})}^{-1}$, the proposed procedure
would show, that the transition map is continuously depending when $T$ is locally changed.
The  desired result follows from the next proposition, where we change somewhat the notation to simplify the representation.
It is concerned with the question of filling in the previous (big) diagram.
\begin{proposition}\label{PROP6310}
Let $T:E\rightarrow F$ be a linear Fredholm operator and consider  for $P,Q\in \Pi_T\cap {\mathcal P}_H$ the associated exact sequences
${\bm{E}}_{(T,P)}$ and ${\bm{E}}_{(T,Q)}$.  Then there is a construction for linear maps  $A_T$ and $B_T$,  which are isomorphisms and make the following diagram
commutative
$$
\begin{CD}
0@>>> \ker(T)@> j^P_T >> \ker(PT) @> \Phi^P_T >> F/H @> \pi^P_T >> \text{coker}(T) @>>> 0\\
@.         @|                        @V A_T    VV                    @V B_T     VV           @| @.\\
0@>>> \ker(T)@> j^Q_T >> \ker(QT) @> \Phi^Q_T >> F/H @> \pi^Q_T >> \text{coker}(T) @>>> 0.
\end{CD}
$$
Varying $T$ to a $T'$ near $T$ so that $P,Q\in \Pi_{T'}$ the constructions of $A_T$ and $B_T$ depend continuously on $T$.
\end{proposition}
\begin{proof}
Since $\text{ind}(PT)=\text{ind}(QT)=\text{ind}(T)$ and $R(PT)=R(QT)= H$ it follows that $\dim(\ker(PT))=\dim(\ker(QT))$.
We can take a closed linear subspace $X$ of $E$ which at the same time is a topological linear complement of $\ker(QT)$ and $\ker(PT)$.
Hence
$$
E=X\oplus\ker(QT)=X\oplus \ker(PT).
$$
For  given $e\in \ker(PT)$
denote by $x(e)\in X$ the unique solution in $X$ of 
\begin{eqnarray}\label{EQ234}
QT(x)= QT(e).
\end{eqnarray}
Then $QT(e-x(e))=0$ and we define
$$
A_T\colon\ker(PT)\rightarrow \ker(QT)\colon A_T(e)=e-x(e).
$$
Assume that $e\in \ker(PT)\cap \ker(QT)$ (This intersection  contains $\ker(T)$.). 
Then $QT(x(e))=QT(e)=PT(e)=0$ implying that $x(e)=0$ and therefore
$$
A_T|(\ker(PT)\cap \ker(QT))=Id.
$$
The map  $A_T$ is an isomorphism since $A_T(e)=0$ implies $e\in X$, which together with $e\in \ker(PT)$
implies $e\in X\cap\ker(PT)=\{0\}$.
We also note that the equation (\ref{EQ234}) is uniquely solvable for $T'$ near $T$, in addition for such closeby $T'$ 
we also have $Q,P\in \Pi_{T'}$, and the solution depends continuously on $T'$.

In order  to define the map $B_T:F/H\rightarrow F/H$. 
We consider the bounded linear map
$$
\Phi\colon X\times (I-Q)F\rightarrow F:(x,\wt{f})\rightarrow T(x)+\wt{f}.
$$
This map is an isomorphism. Indeed, if $T(x)+\wt{f}=0$ we find that $QT(x)=0$ implying $x=0$, which implies $\wt{f}=0$.
Given $f\in F$ we find a unique $x\in X$ solving $QT(x)=Qf$. We then pick $\wt{f}:= (I-Q)f-(I-Q)T(x)$ and compute
$$
T(x)+\wt{f} = QT(x) +(I-Q)T(x) +(I-Q)f-(I-Q)T(x)=Qf+(I-Q)f =f.
$$
Now we solve for $f$ with $(I-P)f=f$
$$
T(x)+\wt{f}=f.
$$
The solution is denoted by $(x(f),\wt{f}(f))$ and we  define
$$
B_T\colon F/H\rightarrow F/H\colon B_T(f+H) = \wt{f}+H.
$$
Next we show that
$$
B_T\circ \Phi^P_T= \Phi^Q_T\circ A_T.
$$
For $e\in \ker(PT)$ we compute, using that $(I-P)T(e)=T(e)$ with $T(x(e))+\wt{f}(e)=T(e)$ and observing that $QT(x(e))=QT(e)$ (the defining equation for $A_T$)
\begin{eqnarray*}
B_T\circ \Phi^P_T(e) &=&B_T( T(e)+H)\\
&=& \wt{f}(e)+H\\
&=& T(e-x(e)) + H\\
&=& T(A_T(e))+H\\
&=&\Phi^Q_T(A_T(e)).
\end{eqnarray*}
Further we calculate where $(I-P)f=f$ and $T(x) +\wt{f} =f$
\begin{eqnarray*}
\pi^Q_T\circ B_T(f+H) &=& \pi^Q_T(\wt{f}+H)\\
&=& \wt{f} +R(T)\\
&=& \wt{f}+T(x)+R(T)\\
&=& f+R(T)\\
&=& \pi^P_T(f+H).
\end{eqnarray*}
In order to calculate $B_T((I-P)T(e)+H) $ for $e\in \ker(PT)$, we need to solve for $x\in X$
$$
T(x)+\wt{f}= T(e),
$$
implying $QT(x) =QT(e)$ and consequently  $x=x(e)$. Hence $\wt{f}= T(e-x(e))=T(A_T(e))$ from which we  infer that
$$
\wt{f}+H = T(A_T(e))+H =\Phi^Q_T\circ A_T(e).
$$
We  calculate
\begin{eqnarray*}
\pi^Q_T\circ B(q)&=& \pi^Q_T(\wt{f}(q)+H)\\
&=&(I-Q)\wt{f}(q) + R(T)\\
&=& \wt{f}(q)+R(T)\\
&=& f-T(x(f))+R(T)\\
&=& f+R(T)\\
&=&\pi^P_T(f+H)\\
&=&\pi^P_T(q).
\end{eqnarray*}
Let $e\in \ker(PT)$ and solve $T(x)+\wt{f} = (I-P)T(e)$, so that $B^T_X((I-P)T(e) +H) =\wt{f}+H$.
\begin{eqnarray*}
&& B_X^T\circ \Phi_T^P(e)\\
&=& B_X^T (T(e)+H)\\
&=& \wt{f}+H.
\end{eqnarray*}
Moreover,
\begin{eqnarray*}
&& \Phi_T^Q\circ A(e)\\
&=&\Phi_T^Q(e-x(e))\\
&=& T(e-x(e))+H.
\end{eqnarray*}
Since the diagram has been shown to be commutative, and $A$ is an isomorphism, the five-lemma implies that $B$ is an isomorphism.

By construction $A_T$ is obtained for $e\in\ker(PT)$ by solving $QT(x)=QT(e)$ which is the same as solving
$T(x)+\wt{f} =T(e)$, and $A_T$ maps $e$ to $e-x$.  The map $B_T$ is obtained by solving for $f$ with $(I-P)f=f$
the equation $T(x)+\wt{f}=f$ and mapping $f+H$ to $\wt{f}+H$.  The important fact is that
$$
X\times (I-Q)F\rightarrow F\colon (x,\wt{f})\rightarrow T(x)+\wt{f}
$$
is a linear isomorphism.  If we keep $X$ and perturb $T$ to $T'$  the equation is still uniquely solvable 
and $\ker(PT')\oplus X=\ker(QT')\oplus X=E$. This shows that the maps 
$B_{T'}$ and $A_{T'}$ for small perturbation are continuously depending on $T'$.
\qed \end{proof}
We already discussed the following informally.
In view of Lemma \ref{lem634}
we can take a projection $L$ onto $R(P)\cap R(Q)$ and  the previous discussion applies to $LP\leq P$ and $LQ\leq Q$.
Then we only need to study the relationship between the constructions for  $LP$ and $LQ$. Both projections belong to 
${\mathcal P}_H$, where $H=R(L)=R(LP)=R(LQ)$. In view of Proposition \ref{PROP6310} we can relate the constructions
for $LP$ and $LQ$.
Hence, by  the previous discussions we have natural  isomorphisms 
$$
\det(T)\rightarrow\det(PT)\rightarrow\det(LPT)\ \ \text{and} \ \ \det(T)\rightarrow\det(QT)\rightarrow\det(LQT)
$$
and from Proposition \ref{PROP6310} 
$$
\begin{CD}
0@>>> \ker(T)@> j^{LP}_T >> \ker(LPT) @> \Phi^{LP}_T >> F/H @> \pi^{LP}_T >> \text{coker}(T) @>>> 0\\
@.         @|                        @V A_T    VV                    @V B_T    VV           @| @.\\
0@>>> \ker(T)@> j^{LQ}_T >> \ker(LQT) @> \Phi^{LQ}_T >> F/H @> \pi^{LQ}_T >> \text{coker}(T) @>>> 0
\end{CD}
$$
from which 
we obtain the commutative  diagram
$$
\begin{CD}
\det(T) @>>> \det(LPT)\\
@| @V\gamma_T VV\\
\det(T) @>>> \det(LQT)
\end{CD}
$$
Here $\gamma_T$ is obtained from $A_T$ and $B_T$ and therefore shows continuous dependence on $T$.

Postponing  the construction of determinant bundles there is an important stabilization construction,  which is the linearized version
of a construction occurring in perturbation theory,  and which has to be understood from the point of view of orientations of determinants. 
We start with a Fredholm operator $T\colon E\rightarrow F$ and assume that $\phi\colon {\mathbb R}^n\rightarrow F$ is a linear map
such  that the map $T_\phi\colon  E\oplus {\mathbb R}^n\rightarrow F$, defined by 
$$
T_\phi(e,r)=T(e)+\phi(r),\index{$T_{\phi}$}
$$ 
is surjective. Writing ${\mathbb R}^n$ after 
$E$ is convenient and goes hand in hand with the conventions in  the definition of the isomorphism $\Phi_{\bm{E}}$ associated with the  exact sequence ${\bm{E}}$.  We would like to introduce 
a convention relating the orientations of  $\det(T)$ and $\det(T_\phi)$,  knowing that  ${\mathbb R}^n$ possesses  the   preferred orientation as 
direct sum of $n$-many copies of ${\mathbb R}$,  each of which is  oriented by $[1]$.
We introduce  the exact sequence
$$
{\bm{E}}:\quad  0\rightarrow \ker(T)\xrightarrow{j} \ker(T_\phi)\xrightarrow{\pi} {\mathbb R}^n\xrightarrow{[\phi]} F/R(T)\rightarrow 0,
$$
in which  $j(e)=(e,0)$,  $\pi(e,r)= r$, and  $ [\phi](r)=\phi(r)+R(T)$. 
\begin{lemma}
The sequence ${\bm{E}}$ is exact.
\end{lemma}
\begin{proof}
Clearly,  $\pi\circ j=0$ and $j$ is injective. If $\pi(e,r)=0$, then $T(e)=0$ and $j(e)=(0,e)=(e,r)$. If $(e,r)\in\ker(T_\phi)$, then $T(e)+\phi(r)=0$
implying that $\phi(r)\in R(T)$. Hence $[\phi(r)]=R(T)$. If $[\phi](r)=0$,  we have $\phi(r)=T(-e)$ for some $e\in E$ and hence $(e,r)\in\ker(T_\phi)$.
Moreover,  $\pi(e,r)=r$. The last map is surjective since,   by  assumption,  $T_\phi$ is surjective. 
\qed \end{proof}
From  the  exact sequence ${\bm{E}}$ we deduce the previously constructed natural isomorphism
$$
\Phi_{\bm{E}}\colon \det(T)\rightarrow \lambda(\ker(T_\phi))\otimes \lambda^\ast({\mathbb R}^n).
$$
In the applications the operator $T$ is oriented and the auxiliary constructions to obtain transversality  yield,  on the linearized level,  operators of the type $T_\phi$.
The above isomorphism can be used to relate the orientations of  $\det(T)$ and $\det(T_\phi)$. However, this requires  an additional convention. For this it suffices 
to fix an isomorphism $\lambda^\ast({\mathbb R}^n)\rightarrow {\mathbb R}^\ast =\lambda^\ast(\{0\})$. This gives rise to an isomorphism
$$
\lambda(\ker(T_\phi))\otimes \lambda^\ast({\mathbb R}^n)\rightarrow \lambda(\ker(T_\phi))\otimes {\mathbb R}^\ast=\det(T_\phi),
$$
which then yields an isomorphism $\det(T)\rightarrow \det(T_\phi)$. The isomorphism we choose is defined by 
$$
\psi\colon \lambda^\ast({\mathbb R}^n)\rightarrow \lambda^\ast(\{0\})={\mathbb R}^\ast,\quad  (e_1\wedge\ldots \wedge e_n)^\ast\mapsto 1^\ast,
$$
where $e_1,\ldots ,e_n$ is the standard basis of ${\mathbb R}^n$. It then follows for every basis $c_1,\ldots ,c_n$ of  ${\mathbb R}^n$ that 
\begin{equation}\label{iso--}
\psi \bigl((c_1\wedge\ldots \wedge c_n)^\ast\bigr)=\frac{1}{\det([c_1,\ldots ,c_n])}1^\ast,
\end{equation}
where $\det$ denotes the determinant of a $n\times n$ matrix of the column vectors.




Summing up the previous discussion and using the definition of the isomorphism $\Phi_{\bm{E}}$ associated to the exact sequence ${\bm{E}}$ we can summarize the findings 
in  the following proposition.
\begin{proposition}
With the chosen isomorphism $\phi\colon \lambda^\ast({\mathbb R}^n)\rightarrow\lambda^\ast(\{0\})={\mathbb R}^\ast$, $(e_1\wedge\ldots \wedge e_n)^\ast\rightarrow 1^\ast$, we define the  isomorphism \index{$\iota_\phi\colon \det(T)\rightarrow \det(T_\phi)$}
$$
\iota_\phi\colon \det(T)\rightarrow \det(T_\phi)
$$
by the following formula. We choose  a basis $a_1,\ldots ,a_k$ of $\ker(T)$ and a basis $\bar{d}_1=\phi(\bar{c}_1)+R(T),\ldots ,\bar{d}_m=\phi(\bar{c}_m)+R(T)$ of  $F/R(T)$.
Let $h=(a_1\wedge\ldots \wedge a_k)\otimes (\bar{d}_1\wedge\ldots \wedge \bar{d}_m)^\ast$.  
Extend $(a_1,0),\ldots ,(a_k,0)$ to a basis of  $\ker(T_\phi)$ by adding
$\bar{b}_1=(b_1,r_1),\ldots ,\bar{b}_l=(b_l,r_l)$,  and notice that $r_1=\pi(b_1,r_1),\ldots ,r_l=\pi(b_l,r_l)$ together with $\bar{c}_1,\ldots ,\bar{c}_m$ form a basis of ${\mathbb R}^n$.
Then the isomorphism $\iota_\phi$ is defined by the formula
$$
\iota_\phi(h) = \frac{1}{ \det(\bar{c}_1,\ldots , \bar{c}_m, r_1\,\ldots ,r_l)}((a_1,0)\wedge\ldots \wedge (a_k,0)\wedge \bar{b}_1\wedge\ldots \wedge \bar{b}_l)\otimes1^\ast.
$$
\end{proposition}
This follows immediately from the definition of the isomorphism $\Phi_{\bm{E}}$ associated with  the exact sequence ${\bm{E}}$. Our choice of isomorphism $\lambda^\ast({\mathbb R}^n)\rightarrow {\mathbb R}^\ast$ is, of course, dual
to a uniquely determined choice of isomorphism ${\mathbb R}\rightarrow\lambda({\mathbb R}^n)$,  defined by the mapping,  which maps $1$ to the wedge of the standard basis.
Its  inverse is the map 
\begin{equation}\label{iso--1}
c_1\wedge\ldots \wedge c_n \rightarrow \det([c_1,\ldots ,c_n]).
\end{equation}
Here again $\det$ is the determinant of a $n\times n$ matrix.  Having chosen  the isomorphisms (\ref{iso--}) and (\ref{iso--1}) we deduce the following natural identifications
for every finite dimensional vector space $V$,
$$
V\otimes \lambda({\mathbb R}^n)\rightarrow V\quad  v\otimes (e_1\wedge\ldots \wedge e_n)\mapsto  v\otimes 1\rightarrow v, 
$$
and
$$
V\otimes\lambda^\ast({\mathbb R}^n)\rightarrow V:v\otimes (e_1\wedge\ldots \wedge e_n)^\ast\rightarrow v\otimes 1^\ast\rightarrow v.
$$
We need another convention.
\begin{definition}\index{D- Natural isomorphism for $\det(T\oplus S)$}\index{$\det(T)\otimes \det(S)\rightarrow \det(T\oplus S)$, natural isomorphism}
 Assume that $T\colon E\rightarrow F$ and $S\colon E'\rightarrow F'$ are Fredholm operators. Then the direct sum $T\oplus S\colon E\oplus E'\rightarrow F\oplus F'$ is a Fredholm operator, and we define the {\bf natural isomorphism} 
$$
\det(T)\otimes \det(S)\rightarrow \det(T\oplus S)
$$
as follows. We choose  $h=(a_1\wedge\ldots \wedge a_n)\otimes (d_1\wedge\ldots \wedge d_l)^\ast\in \det (T)$ and  $h'=(a_1'\wedge\ldots \wedge a_{n'}')\otimes (d_1'\wedge\ldots \wedge d_{l'}')^\ast\in \det (S)$.
Then we map $h\otimes h'$ to the vector $g\in \det (T\oplus S)$,  defined by
$$
g=(a_1\wedge\ldots \wedge a_n\wedge a_1'\wedge\ldots \wedge a_{n'}')\otimes(d_1\wedge\ldots \wedge d_l\wedge d_1'\wedge\ldots \wedge d_{l'}')^\ast.
$$
\qed
\end{definition}


\section{Classical Local Determinant Bundles}
We continue  with some local constructions in the neighborhood of  a Fredholm operator $T\colon E\rightarrow F$ between two Banach spaces.
\begin{lemma}
Given a Fredholm operator $T\colon E\rightarrow F$ and a projection  $P\in \Pi_T$, we take a topological complement $Y$ of $\ker(PT)$ in $E$.
Then there exists $\varepsilon>0$ such  that for every $S\in {\mathcal L}(E,F)$ satisfying $\norm{S-T}<\varepsilon$,  the following holds.
\begin{itemize}
\item[{\em (1)}]\ $P\in\Pi_S$.
\item[{\em (2)}]\ $PS\vert Y\colon Y\rightarrow R(P)$ is a topological isomorphism.
\end{itemize}
\end{lemma} 
\begin{proof}
We estimate $\norm{PT\vert Y-PS\vert Y}\leq \norm{P}\cdot\norm{S-T}$. Since $PT\vert Y\colon Y\rightarrow R(P)$ is a topological linear isomorphism, 
it follows from the openness of invertible linear operators $Y\rightarrow R(P)$ that (2) holds for a suitable $\varepsilon$.
Since $PS\colon Y\rightarrow R(P)$ is a topological linear isomorphism,  we conclude that $R(PS)=R(P)$,  which implies
$P\in\Pi_S$.
\qed \end{proof}

We assume the hypotheses of  the previous lemma, split $E=\ker(PT)\oplus Y$,  and  correspondingly write $e=k+y$.
For $S$ satisfying  $\norm{S-T}<\varepsilon$ we consider the equation
$PS(k+y)=0$ which can be rewritten as
$$
PS(y)=-PS(k).
$$
Hence $y=y(k,S))=-(PS\vert Y)^{-1}(PS(k))$. The map $(k,S)\mapsto  y(k,S)$ is continuous. 
We equipe  the topological space
$$
\bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \ker(PS)\subset {\mathcal L}(E,F)\oplus E
$$
with the induced topology. 
The projection
$$
\pi\colon  \bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \ker(PS)\rightarrow  \bigcup_{\norm{S-T}<\varepsilon} \{S\}
 $$
 is the restriction of the continuous projection ${\mathcal L}(E,F)\oplus E\rightarrow {\mathcal L}(E,F)$ and therefore continuous. The fibers of $\pi$ are finite-dimensional vector spaces of the same dimension.  
\begin{lemma}\label{reddat}
The topological  space $\bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \ker(PS)$ together with the  continuous projection $\pi$ has the structure of a trivial  vector bundle.
\end{lemma}
\begin{proof}
The continuous and bijective map
$$
\{S\, \vert \,  \norm{S-T}<\varepsilon\}\times\ker(PT)\rightarrow \bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \ker(PS) 
$$
is defined by
$$
(S,k)\mapsto (S,k+y(k,S)).
$$
Its inverse is the restriction of the continuous map
$$
\{S\,  \vert \, \norm{S-T}<\varepsilon\}\times E\rightarrow\{S\,  \vert \,  \norm{S-T}<\varepsilon\}\times \ker(PT),\quad (S,k+y)\mapsto (S,k), 
$$
so that our map is indeed a topological bundle trivialization. 
\qed \end{proof}



Now we have the trivial bundle 
$$
\pi\colon \bigcup_{ \norm{S-T}<\varepsilon} \{S\}\times\ker(PS)\rightarrow \{S\,  \vert \, \norm{S-T}<\varepsilon\},
$$
and the  product bundle 
$$
\pi_0\colon \{S\,  \vert \, \norm{S-T}<\varepsilon\}\times(F/R(P))\rightarrow \{S\,  \vert \,  \norm{S-T}<\varepsilon\}.
$$
The obvious viewpoint about these bundles is the following. Given the family of Fredholm operators $S\mapsto  PS$ defined for $S$ satisfying  $\norm{S-T}<\varepsilon$, 
the kernel dimension and cokernel dimension is constant. Therefore,  we obtain the topological kernel bundle as well as the cokernel bundle.
We need the following standard lemma whose proof is left to the reader.

\begin{lemma}\label{lemma6.21}
Given finite-dimensional topological vector bundles $E$ and $F$ over the topological space $X$,  the bundles $\lambda(E)\rightarrow X$, $\lambda^\ast(F)\rightarrow X$
as well as $E\oplus F\rightarrow X$, and $E\otimes F\rightarrow X$ have the structure of topological vector bundles in a natural way.
\qed
\end{lemma}



{
From Lemma \ref{lemma6.21} we deduce  immediately the following result.
\begin{proposition}\label{erty-o}
Let $T:E\rightarrow F$ be a Fredholm operator and $P\in \Pi_T$. Then the topological space 
$$
\bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \det(PS), 
$$
together with the projection onto the set $\{S\, \vert \, \norm{S-T}<\varepsilon\}$ 
has in a natural way the structure of topological line bundle.
\qed
\end{proposition}
}
 
 

{We introduce,  for the Fredholm operator $T$ and the projection $P\in\Pi_T$,  the abbreviation
$$
\text{DET}(T,P,\varepsilon)=\bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \det(PS),
$$
where $\varepsilon>0$ is guaranteed by Lemma \ref{reddat}. We shall call $\text{DET}(T,P,\varepsilon)$ the {\bf local
determinant bundle} \index{Local determinant bundle} associated with  the Fredholm operator  $T$, the projection $P\in\Pi_T$,  and $\varepsilon$.
}

{
For the projection  $Q\in\Pi_T$ satisfying  $Q\leq P$ we abbreviate
$$
\text{DET}(T,Q,\varepsilon)=\bigcup_{\norm{S-T}<\varepsilon} \{S\}\times \det(QS)
$$
which,  again in a natural way,  is a topological line bundle. 
\begin{lemma}\label{kimportant}
The algebraic isomorphism
$$
\what{\gamma}_{T,P,Q,\varepsilon}:\text{DET}(T,P,\varepsilon)\rightarrow \text{DET}(T,Q,\varepsilon):(S,h)\rightarrow (S,\gamma^Q_{PS}(h))
$$ 
is a topological line bundle isomorphism.
\end{lemma}
\begin{proof}
This is trivial and follows from an inspection of the maps $\gamma_{PS}^Q$.  A sketch of the proof goes as follows.
We start with the exact sequence
$$
0\rightarrow \ker(PS)\rightarrow \ker(QS)\rightarrow F/R(Q)\rightarrow F/R(P)\rightarrow 0.
$$
Here $\norm{S-T}<\varepsilon$. Since $Q,P\in\Pi_T$ and $Q\leq P$,  the kernels of $PS$ and $QS$ define topological bundles if 
we vary the Fredholm operators $S$. This is  trivially true for the cokernel bundles associated to $PS$ and $QS$,  which are honest product bundles,  in view of
$R(PS)=R(P)$ and $R(QS)=R(Q)$. We can take linearly independent continuous sections which span  the kernels of the $PS$. Similarly,  for the cokernels we can take constant sections. Now going through the construction of the maps $\gamma_{PS}^Q$,  we see that we can extend the kernel sections for the $PS$ to
a family of continuous sections which are  point-wise linearly independent and  span the kernels of the $QS$. Proceeding  the same way  with the cokernels, we obtain at the end a continuous family of point-wise linearly independent sections spanning $\ker(QS)$ and $F/R(Q)$. Taking the appropriate wedges
and tensor products we see  that a continuous section of the first line bundle is mapped to a continuous section of the second.
The argument can  be reversed to verify  the continuity of the inverse map.
\qed \end{proof}
}



{
Now we introduce  the bundle
$$
\text{DET}_{(E,F)}=\bigcup_{S\in{\mathcal F}(E,F)} \{S\}\times \det (S)\index{$\text{DET}_{(E,F)}$}
$$
over the space of all Fredholm operators.
At first sight this set seems not to have a lot of structure globally (though near certain $S$ it has some due to the previous discussion). The problem
is that  in the definition of $\det(S)$ the `ingredients' 
$\ker(S)$ and $F/R(S)$ associated to  $S$ might have varying local dimensions. However, in view of the discussion in the previous subsection, we shall see, that we can equip $\text{DET}_{(E,F)}$  with the structure
of a topological line bundle over the space of Fredholm operators ${\mathcal F}(E,F)$. This structure will turn out to be natural, i.e.,  the structure  does not depend on the choices  involved in  its construction. Here, it is important to follow the conventions already introduced.
}


{
We have the projection map
$$
\text{DET}_{(E,F)}\rightarrow {\mathcal F}(E,F),\quad (S,h)\mapsto  S.
$$
The base ${\mathcal F}(E,F)$ has a topology, but the total space $\text{DET}_{(E,F)}$ at this point has not.
Given $T\in{\mathcal F}$ we can invoke Proposition \ref{erty-o} and find $\varepsilon>0$ and $P\in\Pi_T$
such  that 
$$
\gamma_{(T,P,\varepsilon)}\colon \text{DET}_{(E,F)}\vert \{S\, \vert \, \norm{S-T}<\varepsilon\}\rightarrow \text{DET}(T,P,\varepsilon),\quad (S,h)\mapsto  (S,\gamma^P_S(h))
$$
is a bijection which is fibers-wise linear and covers the identity on the base.
}


{
\begin{definition}
Denote by ${\mathcal B}$ the collection of all subsets $B$ of $\text{DET}_{(E,F)}$ having the property  that there exists $\gamma_{(T,P,\varepsilon)}$ for which 
$\gamma_{(T,P,\varepsilon)}(B)$ is open in $\text{DET}(T,P,\varepsilon)$. 
\qed
\end{definition} 
}


{
The fundamental topological observation is  the following proposition.
\begin{proposition}
The collection of sets ${\mathcal B}$ is a basis for a topology on $\text{DET}_{(E,F)}$.
\qed
\end{proposition}
}



Postponing the proof for the moment, we denote the topology associated with ${\mathcal B}$ by ${\mathcal T}$,  and  obtain the following result.
\begin{proposition}\index{P- Line bundle structure of $\text{DET}_{(E,F)}$}
The set $\text{DET}_{(E,F)}$ with its linear structure on the fibers, equipped with the topology ${\mathcal T}$, 
is a topological line bundle. The maps
$$
\gamma_{(T,P,\varepsilon)}\colon \text{DET}_{(E,F)}|\{S\ |\ \norm{S-T}<\varepsilon\}\rightarrow \text{DET}(T,P,\varepsilon),\quad (S,h)\rightarrow (S,\gamma^P_S(h))
$$
are topological bundle isomorphisms. 
\qed
\end{proposition}
In order to prove the previous two propositions we recall  the maps $\gamma_{(T,P,\varepsilon)}$ and $\gamma_{(T',P',\varepsilon')}$. We are interested in the transition map
$\gamma_{(T',P',\varepsilon')}\circ \gamma_{(T,P,\varepsilon)}^{-1}$. The domain of this map  consists of all pairs $(S,h)$ satisfying  $\norm{T-S}<\varepsilon$ and $\norm{S-T'}<\varepsilon'$ and $h\in \det(PS)$. The transition map preserves the base point and maps $h$ to an element in $\det(P'S)$. This transition map is obviously an algebraic isomorphism between
two topological line bundles, but as we have discussed in the previous subsection these transition maps are continuous.
\begin{lemma}
The transition map $\gamma_{(T',P',\varepsilon')}\circ \gamma_{(T,P,\varepsilon)}^{-1}$ is a topological isomorphism between topological line bundles.
\qed
\end{lemma}
The two previous propositions follows from this lemma, which summarizes previous assertions,
i.e. the discussion around Proposition \ref{ooo6.6} and Proposition \ref{PROP6310}.

Let us finally remark that it is known that the line bundle $\text{DET}_{(E,F)}$ is non-orientable. However,  over certain subsets it is orientable and that will be used in the discussion of sc-Fredholm sections.


\section{Local Orientation Propagation}\label{SECTX65}


Viewed locally, a classical Fredholm section $f$ is a smooth map $f\colon U\to F$ from an open subset $U$ of some Banach space $E$
into  a Banach space $F$. The derivatives $Df(x)$,  $x\in U$,  form a  family of Fredholm operators depending continuously as operators on $x\in U$.
The determinant line bundle of this family of Fredholm operators is a continuous (even smooth)  line bundle over $U$. If $U$ is contractible, this line bundle possesses precisely two possible orientations because a line has precisely two possible orientations.  Indeed, in this case, the orientation of one single line in the bundle determines 
a natural orientation of all the other lines. We might view 
this procedure as a local continuous propagation of an orientation.




This method, however, is not applicable in the sc-Fredholm setting because the linearizations do not, in general,  depend continuously on the base point. 
 There are even additional difficulties. For example, we are confronted with nontrivial bundles where the dimensions 
can locally jump. Nevertheless there is enough structure 
which allows to define a propagation of the orientation 
and this is the core of the orientation theory in the following section.




We consider  the sc-Fredholm section $f$ of the strong M-polyfold bundle $P\colon Y\rightarrow X$ over the tame $M$-polyfold $X$, choose  for a smooth point $x\in X$
a locally defined $\ssc^+$-section $s$ satisfying  $s(x)=f(x)$,  and take the linearization $(f-s)'(x)\colon T_xX\rightarrow Y_x$.  The linearization $(f-s)'(x)$ belongs to
the space of linearizations 
$\text{Lin}(f,x)$ which is a subset of linear Fredholm 
 operators $T_xX\to Y_x$ possessing the induced metric defined by the norm of the space ${\mathscr L}(T_xX, Y_x)$ of bounded operators.
Moreover, $\text{Lin}(f,x)$ is a convex subset and therefore contractible. Introducing 
$$
\text{DET}(f,x):=\bigcup_{L\in \text{Lin}(f,x)}\{L\}\times \text{det}(L)\index{$\text{DET}(f,x)$}
$$
over the convex set $\text{Lin}(f,x)$,  the previous 
discussion shows that $\text{DET}(f,x)$ is naturally a topological line bundle.
\begin{proposition}\index{P- Line bundle structure for $\text{DET}(f,x)$}
$\text{DET}(f,x)$ has in a natural way the structure of a topological line bundle over $\text{Lin}(f,x)$ and consequently has two possible orientations since the base space
is contractible.
\qed
\end{proposition}




\begin{definition}[{\bf Orientation}]\index{D- Orientations of $\text{DET}(f,x)$}
Let $f$ be a sc-Fredholm section of the strong M-polyfold bundle $P\colon Y\to X$ over the tame M-polyfold $X$ and $x\in X$ a smooth point. Then an {\bf orientation for the pair $(f,x)$},  denoted by 
$\mathfrak{o}_{(f,x)}$,  is a choice
of one of the two possible orientations of  
$\text{DET}(f,x)$.
\qed
\end{definition}



Let us denote by ${\mathcal O}_f$ the orientation space associated to $f$,  which is the collection of all pairs $(x,\mathfrak{o})$, in which $x\in X_\infty$ and $\mathfrak{o}$ is an orientation of $\text{DET}(f,x)$.
We consider a category whose  objects are the sets $Or_x^f:=\{\mathfrak{o}_x,-\mathfrak{o}_x\}$ of the two possible orientations of $\text{DET}(f,x)$. The reader should not be confused by our notation.
There is no distinguished class $\mathfrak{o}_x$. We only know there are two possible orientations, namely $\mathfrak{o}_x$ and $-\mathfrak{o}_x$.
For any two smooth points $x$ and $y$ 
in the same path component of $X$ the associated morphism set consists of two isomorphisms. The first one maps $\pm\mathfrak{o}_x\rightarrow \pm\mathfrak{o}_y$
and the second one $\pm\mathfrak{o}_x\rightarrow \mp\mathfrak{o}_y$.






\begin{proposition}\label{umbra}\index{P- Basic construction for orientation {I}}
If $f$ is a  sc-Fredholm section of the strong M-polyfold bundle $P\colon Y\rightarrow X$,  then every smooth point $x$ possesses  two open neighborhoods $U=U(x)$ 
and $U'=U'(x)$ having the following properties.
\begin{itemize}
\item[{\em (1)}]\  $U'\subset U$ is sc-smoothly contractible in $U$ to the point $x$.
\item[{\em (2)}]\ The solution set 
$\{x\in \cl_X (U)\, \vert \, f(x)=0\}$ is compact.
\item[{\em (3)}]\ Given a sc-smooth path $\phi\colon [0,1]\rightarrow U$,  there exists a $\ssc^+$-section $s\colon U\times [0,1]\rightarrow Y$
having  the property that $s(\phi(t),t)=f(\phi(t))$. 
\item[{\em (4)}]\ If  $t_0\in [0,1]$, $y_0\in U_\infty$,  and $e_0$ is  a smooth point in $Y_{y_0}$, then  there exists a $\ssc^+$-section $q\colon U\times [0,1]\rightarrow Y$ satisfying $q(y_0,t_0)=e_0$.
\end{itemize}
\end{proposition}


\begin{proof}
Taking local strong bundle coordinates we may assume that the bundle is $P\colon K\rightarrow O$ and $x=0$.  Here $K=R(V\triangleleft F)$ is the strong bundle retract covering the sc-retraction $r:V\rightarrow V$ satisfying  $r(V)=O$.
As usual,  $V\subset C$ is an open neighborhood of $0$ in the partial quadrant $C$ of the sc-Banach space $E$. 
Take a smaller open neighborhood $V'$ of $0\in C$ which is convex and contained in $V$.
Then we can define 
$$
\wh{r}\colon [0,1]\times V'\rightarrow O\colon \wh{r}(t,x) =r(tx).
$$
We abbreviate $O'=r(V')$ and note that $t\rightarrow \wh{r}(t,V')$ retracts $O'$ at $t=1$ to $x$ at $t=0$ while staying during the deformation
in $O$. We can always replace $V'$ by a smaller convex open neighborhood of $0$ and keep the property just described.

The  sc-Fredholm section $f$ possesses the local compactness property. We can therefore choose  an open  neighborhood $V$ of $0\in C$
such  that $U=r(V)$ satisfies  $\cl_C(U)\subset O$ and the restriction $f\vert \cl_C(U)$ has a compact solution set.
At this point we have constructed an open neighborhood $U$ of $x$ which has the first two properties.
Shrinking $U$ (and $U'$) further will keep these properties.  We  have to show that an additional shrinking will guarantee (3) and (4).


The section $f$ of $K\rightarrow O$ has the form $f(y)=(y,{\bf f}(y))$ where $R(f(y))=f(y)$.
The map  ${\bf f}$ is the  principle part of the section $f$ and is sc-smooth as a map from 
$O$ to $F$.
If $\phi\colon [0,1]\rightarrow U$ is a sc-smooth path, $t\in [0,1]$ and $y\in U$, then 
$(y,{\bf f}(\phi(t)))\in O\triangleleft F\subset V\triangleleft F$  and we define the map
$s\colon U\times [0,1]\rightarrow K$ by 
$$
s(y,t)=R(y,{\bf f}(\phi(t))).
$$
The map  $s$ is a $\ssc^+$-section of the pull-back of the bundle $K\rightarrow O$ by the map $U\times [0,1]\rightarrow O$, $(y, t)\mapsto y$.
By construction,  $s(\phi(t),t)=R(\phi(t),{\bf f}(\phi(t)))=R(f(\phi(t)))=f(\phi(t))$.  This proves (3).

The statement (4) was already proved in some variation  in the sections about Fredholm theory.  Formulated in the local
coordinates, the statement (4) assumes that  the  smooth point $e_0=(y_0,{\bf e_0})\in K$ and 
$t_0\in 0,1]$ are given.
The required  section $q\colon O\times [0,1]\to K$ can be then defined as the section 
$$
q(y,t)=R(y,{\bf e_0}).
$$
It satisfies  $q(y_0,t_0)=R(y_0,{\bf e_0})=(y_0,{\bf e_0})=e_0$, as desired.
\qed \end{proof}
Now we are in the position to define a propagation mechanism. Since it will involve several choices we have to make sure that the end result is independent of the choices involved. 
The set up is as follows. We have a strong bundle $P\colon Y\rightarrow X$ over the M-polyfold $X$ and an sc-Fredholm section $f$ of $P$. Around a smooth point $x\in X$ we choose  the  open neighborhoods $U=U(x)$, $U'(x)$,  so that the statements (1)-(4) of Proposition \ref{umbra} hold.

There is no loss of generality assuming that $X=U$. If 
 $\phi\colon [0,1]\rightarrow X$ is a sc-smooth path, we employ Proposition \ref{umbra}
and choose  a $\ssc^+$-section 
$s:X\times [0,1]\rightarrow W$ satisfying  $s(\phi(t),t)=f(\phi(t))$. 


Adding  finitely many $\ssc^+$-sections $s_1,\ldots ,s_k$ defined on $X\times [0,1]$, we obtain the 
sc-Fredholm section
$$
F\colon  [0,1]\times X\times {\mathbb R}^k\rightarrow W,\quad F(t,y,\lambda)=f(y)-s(y,t)+\sum_{i=1}^k\lambda_i\cdot s_i(y,t)
$$
having the property that  for $\lambda=0$ the points $(t,\phi(t),0)$ are solutions of  
$$
F(t,\phi(t),0)=0.
$$
 For fixed $t\in [0,1]$ we introduce the  sc-Fredholm section
$$
F_t\colon X\times {\mathbb R}^k\rightarrow Y,\quad (y,\lambda)\rightarrow F(t,y,\lambda).
$$
The discussion, so far,  is true for all choices $s_1,\ldots ,s_k$. Using the results from the transversality theory we can choose  
$s_1,\ldots ,s_k$ such  that, in addition, $F_t$ has a good boundary behavior.

\begin{lemma}  \label{lem_property_star}
There exist finitely many $\ssc^+$-sections $s_1,\ldots ,s_k$ of the bundle  $Y\rightarrow [0,1]\times X$
such  that the sc-smooth Fredholm section $F$ of the bundle $Y\rightarrow [0,1]\times {\mathbb R}^k\times X$,  defined by
$$
F(t,y,\lambda) = f(y)-s(y,t)+\sum_{i=1}^k \lambda_i\cdot s_i(y,t),
$$
has the following property (P).
\begin{itemize}
\item[{\em (P)}]\ For every fixed $t\in [0,1]$,  the section $F_{t}$ is at the point $(\phi(t),0)$  in general position to the boundary of $X\times {\mathbb R}^k$.
\end{itemize}
\qed
\end{lemma}
Property (P) automatically implies that $F$ is in general position to the boundary of $[0,1]\times X\times {\mathbb R}^k$
at all points $(t,\phi(t),0)$ for $t\in [0,1]$. As a consequence of the implicit function theorem for the  boundary case we obtain the following result.
\begin{lemma}
The solution set 
$$
S=\{ (t, y, \lambda)\, \vert \,  F(t,y,\lambda)=0\}
$$
 for $(t,y,0)$ near $(t,\phi(t),0)$ is a smooth manifold with boundary with corners and
 $$
 \{(t,\phi(t),0)\, \vert \,  t\in [0,1]\}\subset S.
 $$
  Moreover,  it follows from the property (P) that the projection 
$$
\pi\colon S\rightarrow [0,1], \quad (t,y,\lambda)\mapsto  t
$$
is a submersion. The set  $S_t$ defined by  $\{t\}\times S_t:=\pi^{-1}(t)$  is a manifold with boundary with corners contained
in $ X\times {\mathbb R}^k$.
\qed
\end{lemma}
We do not claim that $S_t$ is compact, but the manifold $S_t$  lies in such a way in $X\times {\mathbb R}^k$ that its intersection with $(\partial X)\times {\mathbb R}^k$
carves out a boundary with corners on the manifold $S_t$.
The tangent space $T_{(\phi (t), 0)}S_t$ at the point $(\phi (t), 0)\in S_t$ agrees with the kernel $\ker (F_t'(\phi (t), 0))$ and, abbreviating  
$$
L_t:=T_{(\phi(t),0)}S_t=\ker (F_t'(\phi (t), 0))\quad \text{for $t\in [0,1]$},$$
we introduce the bundle  $L$ of tangent spaces along the path $\phi (t)\in S$, for $t\in [0,1]$, by 
$$
L=\bigcup_{t\in [0,1]} \{t\}\times L_t.
$$
The bundle $L$ is a smooth vector bundle over $[0,1]$. By $\lambda (L)$ we denote the line bundle associated with $L$,
$$\lambda (L)=\bigcup_{t\in [0,1]} \{t\}\times \lambda (L_t).$$


An orientation of the line $\lambda (L_t)$ determines by continuation an orientation of all the other lines. In particular, an orientation of $\lambda (L_0)$ at $t=0$ determines an orientation of $\lambda (L_1)$ at $t=1$, and we shall relate these orientations to the orientations of
$\text{DET}(f,\phi(0))$ and $\text{DET}(f,\phi(1))$.
To this aim we introduce, for every fixed $t\in [0,1]$, the exact sequence ${\bm{E}}_t$ defined by 
\begin{equation}\label{eexact}
\begin{gathered}
{\bm{E}}_t:\quad 0\rightarrow \ker( (f-s(\cdot,t ))'(\phi(t)) )\xrightarrow{j} \ker ({F}_t'(\phi(t),0))\xrightarrow{p}\\
\xrightarrow{p} {\mathbb R}^k\xrightarrow{c} Y_{\phi(t)}/R((f-s(\cdot,t ))'(\phi(t)))\rightarrow 0
\end{gathered}
\end{equation}
in which  $j$ is the inclusion map, $p$ the projection onto the ${\mathbb R}^k$-factor, and the  map $c$ is defined
by 
$$
c(\lambda) =\left(\sum_{i=1}^k \lambda_is_i(t,\phi(t))\right)+ R((f-s(\cdot,t ))'(\phi(t))).
$$

\begin{lemma}\label{lem_exact_seq_2}
The sequence \eqref{eexact} is exact.
\end{lemma}
\begin{proof}
The inclusion map $j$ is injective and $p\circ j=0$. From  $p(h,\lambda)=0$ it follows that 
$\lambda=0$
so that $h\in \ker((f-s(\cdot,t ))'(\phi(t)))$. If $(h,\lambda)\in \ker(F_t'(\phi(t),0))$,  then $\sum \lambda_is_i(\phi(t),t)$
belongs to the image of $(f-s(\cdot,t ))'(\phi(t))$ which implies $c\circ p=0$. It is also immediate that an
element $\lambda\in {\mathbb R}^k$ satisfying  $c(\lambda)=0$ implies that $\sum \lambda_is_i(\phi(t),t)$ belongs to the image
of $(f-s(\cdot,t ))'(\phi(t))$. This allows us to construct an element $(h,\lambda)\in \ker(F_t'(\phi(t),0))$ satisfying  $p(h,\lambda,)=\lambda$. 
Finally, it follows from the property $(P)$ in Lemma \ref{lem_property_star}  that the map $c$ is  surjective. 
The proof of Lemma 
\ref{lem_exact_seq_2} is complete.
\qed \end{proof}



From the exact sequence ${\bm{E}}_t$ we deduce the natural isomorphism $\Phi_{{\bm{E}}_t}$ introduced in Section \ref{sect_conventions}, 
\begin{equation*}
\begin{split}
\Phi_{{\bm{E}}_t}&\colon \lambda \bigl(\ker (f-s(\cdot , t))'(\phi (t))\bigr)\otimes \lambda^\ast (\coker  (f-s(\cdot , t))'(\phi (t))\bigr)\\
&\to \lambda \bigl(\ker F_t'(\phi (t), 0)\otimes \lambda^\ast(\R^k),
\end{split}
\end{equation*}
and obtain, in view of the the definition of the determinant, the isomorphism
$$
\Phi_{{\bm{E}}_t}\colon \det ((f-s(\cdot ,t))'(\phi (t)))\to \lambda (L_t)\otimes \lambda^\ast(\R^k).
$$
Now we assume that we have chosen the orientation 
$\mathfrak{o}_0$ of $\text{DET}(f,\phi(0))$  at $t=0$. It induces an orientation of $\det ((f-s(\cdot ,0))'(\phi (0))).$
The isomorphism $\Phi_{{\bm{E}}_0}$ determines an orientation of $\lambda (L_0)\otimes \lambda^\ast (\R^k)$. By continuation we extend this orientation to an orientation of  $\lambda (L_1)\otimes \lambda^\ast (\R^k).$ Then the isomorphism $(\Phi_{{\bm{E}}_1})^{-1}$ at $t=1$ gives us an orientation of $\det ((f-s(\cdot ,1))'(\varphi (1)))$ and consequently an orientation $\mathfrak{o}_1$ of 
$\text{DET}(f,\phi(1))$  at $t=1$, denoted by 
$$\mathfrak{o}_1=\phi_\ast \mathfrak{o}_0,$$
and called the {\bf push forward orientation}.
A priori our procedure might depend on the choices of the sections $s(y, t)$ and $s_1\ldots ,s_k$ and we shall prove next that it actually does not.
\begin{proposition}\label{local-xyz}\index{P- Basic construction for orientation {II}}
We assume that $f$ is the sc-Fredholm section of the strong M-polyfold bundle $P\colon Y\rightarrow X$ over the tame $X$, and $U=U(x)$, $U'=U'(x)\subset U$ are  open neighborhood  around a smooth point $x$, for which the conclusions of Proposition \ref{umbra} hold. Let $\phi\colon [0,1]\rightarrow U'$ be a  sc-smooth path. Then the construction of the map
$\mathfrak{o}\rightarrow\phi_\ast\mathfrak{o}$,
associating with  an orientation of $\text{DET}(f,\phi(0))$ an orientation $\phi_\ast\mathfrak{o}$  of $ \text{DET}(f,\phi(1)) $ does not depend on the choices involved as long as the hypotheses of Lemma \ref{lem_property_star} hold. 
\qed
\end{proposition}


The proof of the proposition follows from two lemmata.
\begin{lemma}\label{opas}
Under the assumption of the proposition we assume that 
the sc-Fredholm section 
$$
F(t,y,\lambda)=f(y)-s(y,t)+\sum_{i=1}^k\lambda_i\cdot s_i(y,t),
$$ 
satisfies the property  (P) from Lemma \ref{lem_property_star}.
We view $F$ as section of the bundle $Y\rightarrow [0,1]\times X\times {\mathbb R}^k$. Adding more $\ssc^+$-sections we 
also introduce the second sc-Fredholm section 
$$
\ov{F}(t,y,\lambda,\mu)=F(t,y,\lambda)+\sum_{j=1}^l\mu_j\cdot \bar{s}_j(y,t),
$$
viewed as a section of the bundle 
$Y\rightarrow [0,1]\times X\times {\mathbb R}^{k+l}$. 
Then both sections define the same propagation of the orientation along the sc-smooth path $\phi$.
\end{lemma}
\begin{proof}
The key is to view $F$ as the section
$$
\wh{F}(\tau, t,y,\lambda, \mu)= f(y)-s(y,t)+\sum_{i=1}^k\lambda_i\cdot s_i(y,t)
$$
of the strong M-polyfold bundle $Y\rightarrow [0,1]\times [0,1]\times X\times {\mathbb R}^{k+l}$.
There is a sc-Fredholm section 
$$\wt{F}\colon
[0,1]\times[0,1]\times X\times{\mathbb R}^{k+l}\rightarrow Y, 
$$
defined 
by
$$
\wt{F}(\tau,t,y,\lambda,\mu)=\wh{F}(\tau, t,y,\lambda,\mu)+\sum_{j=1}^l \mu_j\cdot \bar{s}_j(y,t).
$$
The induced map $X\times{\mathbb R}^{k+l}\rightarrow Y$ for fixed $(\tau,t)\in [0,1]\times [0,1]$ satisfies the property (P).
We obtain a solution manifold $\tilde{S}$ with boundary with corners  defined near the points $(\tau,t,\phi(t),0)$,which fibers over $[0,1]\times [0,1]$.
Let $\tilde{\pi}\colon \tilde{S}\rightarrow [0,1]\times [0,1]$ and consider its tangent map.
Then take the vector bundle $\tilde{L}\rightarrow [0,1]\times [0,1]$ whose fiber over $(\tau,t)$ is the preimage of the zero section of $T([0,1]\times [0,1])$ under $T\tilde{\pi}$.
For $\tau=0$ we obtain the bundle $\tilde{L}^0\rightarrow \{0\}\times [0,1]=[0,1]$. This is of the form
$$
L\oplus ([0,1]\times {\mathbb R}^l)\rightarrow [0,1],
$$
where $L$ is the bundle associated to $F$ which we used originally to define the propagation along $\phi$. 
Applying the construction now using $\tilde{L}^0$ one verifies by a simple computation that it defines the same 
propagation.  




Hence it remains to verify that every bundle $\wt{L}^\tau$, $\tau\in [0,1]$,  defines  the same propagation. 
First of all we note that as $\tau$ varies,  the bundle varies continuously. Moreover, we relate the end points 
to $\det((f-s(\cdot,0))'(\phi(0)))$ and $\det((f-s(\cdot,1))'(\phi(1)))$. The data in the occurring exact sequence
relating  the latter with  the corresponding orientations of $\tilde{L}^\tau$,  vary continuously.  This implies that the propagation definition 
does not depend on $\tau$.
\qed \end{proof}

Next we show that the choice of the $\ssc^+$-section $s$ satisfying  $s(\phi(t),t)=f(\phi(t))$ does not affect the definition of the propagation.
\begin{lemma}\label{opas1}
We assume that the $\ssc^+$-sections $s^i$ for $i=0,1$ satisfy 
$$
s^i(\phi(t),t)=f(\phi(t))
$$
 and consider the homotopy $s^\tau=\tau \cdot s^1+(1-\tau)\cdot s^0$.
We choose  additional sections $s^\tau_1,\ldots ,s^\tau_k$  so that the property (P) holds together with $s^\tau$  for every $\tau$.
Then the  propagation of the orientation along the sc-smooth path $\phi$ using each of the collections $s^\tau,s_1^\tau,\ldots ,s_k^\tau$ is the same.
 \end{lemma}
 
 \begin{proof}
 The proof is similar as the lemma above. We obtain a vector bundle $\wtilde{L}\rightarrow [0,1]\times [0,1]$
 with parameters $(\tau,t)$ in the base. Then we can define for fixed $\tau$ a vector bundle over $t\in[0,1]$, say $\wt{L}^\tau$.
 Clearly $\wt{L}^\tau$ varies continuously in $\tau$.  At  $t=0,1$ the linearizations
 $(f-s^\tau(\cdot,0))'(\phi(0))$ and $(f-s^\tau(\cdot,1))'(\phi(1))$ vary continuously as operators in $\text{DET}(f,\phi(0))$ and $\text{DET}(f,\phi(1))$, respectively.
 This implies that the bundle $\tilde{L}^\tau$ induces,  independently of $\tau\in [0,1]$,  the same propagation of the orientation  along the path $\phi$.
\qed \end{proof}
Now we are in the position to finish the proof of Proposition \ref{local-xyz}.
We start with two  collections $s^i,s_1^i,\ldots ,s_{k^i}^i$ to define the propagation and add for $i=0$ and $i=1$
additional $\ssc^+$-sections such that the following holds.
\begin{itemize}
\item[(1)]\ For both situations $i=0$ and $i=1$ we have the same number of sections.
\item[(2)]\ For  a convex homotopy parametrized by $\tau\in [0,1]$, the property (P) holds for each fixed $\tau$.
\end{itemize}
By Lemma \ref{opas} adding section does not change the propagation. We can apply this for $i=0,1$.
Then we can use Lemma \ref{opas1} to show that these two propagations (after adding sections) are the same.

Next assume we have the same hypotheses and $U=U(x)$, $U'=U'(x)$  have the initially stated properties.
If the two sc-smooth paths $\phi^0,\phi^1\colon [0,1]\rightarrow U'$ have the same starting and end points,  we homotope sc-smoothly from one to the other with end points fixed,  using that $U' $ is sc-smoothly contractible in $U$.  We 
denote this sc-smooth homotopy by
$$
\Phi\colon [0,1]\times [0,1]\rightarrow U
$$
where $\phi^i=\Phi(i,0)$ for $i=0,1$. Then we  construct the $\ssc^+$-section $s$ satisfying $s(\Phi(\tau,t),\tau,t)=f(\Phi(\tau,t))$ and define the sc-Fredholm section  
$$
(\tau,t,y,\lambda)\rightarrow f(y)-s(y,\tau,t)+\sum_{i=1}^k\lambda_i\cdot s_i(y,\tau,t)
$$
possesing the obvious properties. 
For every $\tau$ we obtain a vector bundle $\wt{L}^\tau\rightarrow [0,1]$. Since all the data change continuously in these
bundles and the operators for $t=0,1$ in $\text{DET}(\ast)$  change continuously in $\tau$,  we see that every $\wt{L}^\tau$ defines the same 
propagation of the orientation along paths $\phi^\tau=\Phi(\tau,\cdot )$. Hence we have proved the following statement.




\begin{theorem}\label{thm_6.35}\index{T- Propagation of orientation}
We assume that $P\colon Y\rightarrow X$ is a strong bundle over the tame M-polyfold and  $x$ a smooth point in $X$.
Then there exists an open  neighborhood $\wt{U}=\wt{U}(x)$ such  that for every sc-smooth path $\phi\colon [0,1]\rightarrow \wt{U}$
there exists a well-defined propagation 
$$
\mathfrak{o}\rightarrow \phi_\ast\mathfrak{o}
$$
of an orientation $\mathfrak{o}$ of $\text{DET}(f,\phi(0))$. Moreover,  if $\phi^0$ and $\phi^1\colon [0,1]\rightarrow \wt{U}$ are two sc-smooth paths from the  same starting points
to the same end point, then the  propagation along $\phi^0$ and $\phi^1$ is the same, i.e., 
$$
\phi^0_\ast\mathfrak{o}=\phi^1_\ast\mathfrak{o}.
$$
\qed
\end{theorem}
Having this theorem there are precisely two possible ways to orient the family $\text{DET}(f,y)$, $y\in \wt{U}_\infty$,  so that 
these orientations are related by propagation along paths. Namely,  we fix $x$ and take for $y\in \wt{U}_\infty$ a sc-smooth path
$\phi\colon [0,1]\rightarrow \wt{U}$, starting at $x$ and ending at $y$.  Fixing  an orientation $\mathfrak{o}_x$ of $\text{DET}(f,x)$, 
we define $\mathfrak{o}_y=\phi_\ast\mathfrak{o}_x$. The definition is independent of the choice of the path $\phi$.
At this point we have a map which associates to a smooth point $y\in \wt{U}$, i.e. $y\in \wt{U}_\infty$,  an orientation $\mathfrak{o}_y$ of $\text{DET}(f,y)$. It follows from Theorem \ref{thm_6.35} that if  $\psi$ is a sc-smooth path connecting $y_1$ with $y_2$, then $\psi_\ast\mathfrak{o}_{y_1}=\mathfrak{o}_{y_2}$.

\begin{definition}\label{SDEF6511}.
Given a strong bundle $P\colon Y\rightarrow X$ over the tame M-polyfold $X$ and a sc-Fredholm section $f$, we call an open path connected 
neighborhood $\wt{U}(x)$ of a smooth point $x$ on which the local propagation construction can be carried out an {\bf orientable neighborhood}\index{D- Orientable neighborhood} of $(f,x)$. Any two of the possible orientations of $\text{DET}(f,y)$ for $y\in \wt{U}_\infty$, which have the propagation property,  is called  a  {\bf continuous orientation}\index{D- Continuous orientations}.
\qed
\end{definition}
In view of Theorem \ref{thm_6.35}, given an sc-Fredholm section $f$ of a strong bundle $P:Y\rightarrow X$ over a tame $X$, for every  $(f,x)$ with $x\in X_\infty$,
there exists an orientable open neighborhood $\wt{U}(x)$.
A suitable orientable neighborhood  $\wt{U}(x)$ has precisely two continuous orientations. 
Now we globalize the local propagation of orientation constructions to a more global procedure.
Let $X$ be an M-polyfold and $\phi\colon [0,1]\rightarrow X$ a sc-smooth map. We denote by $[\phi]$ its sc-smooth homotopy class with end points fixed. Associated with  $[\phi]$ we have the source $s([\phi])$ which is the starting point $\phi(0)$ and the target $t([\phi])$ which is the end point $\phi(1)$.
Given two sc-smooth homotopy classes  $[\phi]$ and $[\psi]$ satisfying $t([\phi])=s([\psi])$,  we  define the composition $[\psi]\ast[\phi]$ as the class of $\gamma$ defined as follows.
Take a smooth map $\beta\colon [0,1]\rightarrow [0,2]$ satisfying  that $\beta([0,1/2])=[0,1]$, $\beta(0)=0$ and $\beta(s)=1$ for $s$ near $1/2$. Moreover, 
$\beta([1/2,1])=[1,2]$ and $\beta(1)=2$. Then we define the sc-smooth path $\gamma$ by $\gamma(t)=\phi(\beta(s))$ for $s\in [0,1/2]$ and $\gamma(t)=\psi(\beta(s))$ for $s\in [1/2,1]$.
This way we obtain a category ${\mathcal P}_X$ whose objects are the smooth points in $X$ and whose morphisms $x\rightarrow y$ are the homotopy  classes $[\phi]$ with source $x$ and target $y$.
The main result of this section is  described  by the following theorem which is a consequence of the local constructions.


\begin{theorem}\index{T- Main orientation result}
Let $P\colon Y\rightarrow X$ be a strong bundle over the tame M-polyfold $X$ and $f$ a sc-Fredholm section.
Then there exists a uniquely determined functor 
$$
{\mathcal P}_X\xrightarrow{\Gamma_f}{\mathcal O}_f,\index{${\mathcal P}_X\xrightarrow{\Gamma_f}{\mathcal O}_f$}
$$
which associates
with  the smooth point $x$ the set $Or_x^f$,  and with the sc-smooth homotopy class  $[\phi]\colon x\rightarrow y$ a morphism $\Gamma_f([\phi])\colon Or_x^f\rightarrow Or_y^f$,  which has the following property.\\[1ex]
$({\bf \ast})$\quad 
Given any smooth point $x$ in $X$  and  an orientable open neighborhood $\wt{U}=\wt{U}(x)$
the maps 
$$
\phi_\ast\colon Or_{\phi(0)}^f\rightarrow Or_{\phi(1)}^f\ \ \text{and}\ \ \Gamma^f([\phi])\colon Or_{\phi(0)}^f\rightarrow Or_{\phi(1)}^f
$$
coincide for a sc-smooth path $\phi\colon [0,1]\rightarrow \wt{U}$.
\end{theorem}
\begin{proof}
We consider the  sc-smooth path $\phi:[0,1]\rightarrow X$, fix $t_0\in [0,1]$, and choose an orientable neighborhood $\wt{U}(\phi(t_0))$.
Then we find an open interval $I(t_0)$ so that an orientation
$\mathfrak{o}_t$ for $(f,\phi(t))$, where $t\in I(t_0)\cap [0,1]$, determines an orientation for all $s\in I(t_0)\cap [0,1]$.  
Now using the compactness of $[0,1]$ and a finite covering, we can transport a given orientation $\mathfrak{o}_0$ of $\text{DET}(f,\phi(0))$ to an orientation 
$\mathfrak{o}_1$ of $\text{DET}(f,\phi(1))$. The map $\pm\mathfrak{o}_0\rightarrow \pm\mathfrak{o}_1$ is denoted by $\phi_\ast$. By a covering argument one verifies that the map $\phi_\ast$ only depends on the homotopy class $[\phi]$ for fixed end-points. It is obvious that $\Gamma_f$ is unique.
\qed \end{proof}
Finally we can give two equivalent definitions of orientability of a sc-Fredholm section.
\begin{definition}\index{D- Orientable sc-Fredholm section {I}}
A sc-Fredholm section  $f$  of the strong bundle $P\colon Y\rightarrow X$ over the tame M-polyfold $X$ is called  {\bf orientable}  provided for every pair of smooth points $x$ and $y$
in the same path component,  the morphism $\Gamma_f([\phi])$ does not depend on the choice of the homotopy class $[\phi]\colon x\rightarrow y$. 
\qed
\end{definition}
An equivalent version is the following.
\begin{definition} \index{D- Orientable sc-Fredholm section {II}}
Let $f$ be a sc-Fredholm section of the strong bundle $P\colon Y\rightarrow X$ over the tame M-polyfold $X$. Then $f$ is  called {\bf orientable}  if there exists 
a map which associates with a point  $y\in X_\infty$ an orientation $\mathfrak{o}_y$ of $\text{DET}(f,y)$ having the following property. For every smooth point $x$ there exists
an orientable neighborhood $U(x)$ for which  $U_\infty(x)\ni y\mapsto \mathfrak{o}_y$ is one of the two continuous orientations.
\qed
\end{definition}
Finally we  define an orientation of the sc-Fredholm section as follows.
\begin{definition}[{\bf Orientation of sc-Fredholm sections}]\index{D- Orientation of an sc-Fredholm section}
Let $P\colon Y\rightarrow X$ be a strong bundle over the tame M-polyfold $X$ and assume that $f$ is a  sc-Fredholm section.
An orientation $\mathfrak{o}^f$ for $f$ is a map which associates with every  smooth  point $y\in X$ an orientation $\mathfrak{o}_y^f$ of $\text{DET}(f,y)$
such  that,  for every smooth point $x$ and orientable neighborhood $U=U(x)$,  the restriction $\mathfrak{o}^f\vert U_\infty$ is one of the two possible continuous orientations.
\qed
\end{definition}
We close this subsection with a general result.
\begin{theorem}\index{T- Orientation of solution set}
We assume that $P\colon Y\rightarrow X$ is a strong bundle over the tame M-polyfold $X$. Let $f$ be a proper sc-Fredholm section
such  that for every $x\in X$ solving $f(x)=0$ the pair $(f,x)$ is in %
general position to the boundary $\partial X$.
Suppose $\mathfrak{o}^f$ is an orientation for $f$. Then the solution set $S=f^{-1}(0)$ is a smooth compact manifold with boundary with corners
possessing  a natural orientation.
\end{theorem}
\begin{proof}
We already know from the transversality discussion that $S$ is a compact manifold with boundary with corners.
If  $x\in S$, then $\ker(f'(x))=T_xS$ and because  $f'(x)$ is surjective,  every tangent space $T_xS$ is oriented by $\mathfrak{o}_x^f$.
Since $\mathfrak{o}^f$ has the local continuation property,  one verifies that the differential geometric local prolongation of the orientation on $S$ is
the same as the Fredholm one.
\qed \end{proof}



If $f$ is not  generic to start with,  we have to take a small perturbation $s$ supported near the zero set of $f$, so that  the solution set $S_{f+s} $ has a natural orientation coming from $\mathfrak{o}^f$ since $\det((f+s)'(x))$ has an orientation coming from $\text{DET}(f,x)$ for $x\in S_{f+s}$.

\begin{remark} \index{R- On orientations for sc-Fredholm sections}
If $(f,\mathfrak{o})$ is an oriented Fredholm section of the strong bundle $P\colon Y\rightarrow X$ and $s$ is a $\ssc^+$-section of $Y\rightarrow X\times [0,1]$, then the sc-Fredholm section 
$\wh{f}$,  defined on  $X\times[0,1]$ by $\wh{f}(x,t)=f(x)+s(x,t)\in Y$, 
has a natural orientation associated with  
$\mathfrak{o}$ and the standard orientation of $[0,1]$. 
We choose  a local $\ssc^+$-section $t$ near the smooth point $x$  satisfying  $t(x)=f(x)$ and consider the orientation 
$\mathfrak{o}_x$ of  $\det((f-t)'(x))$, where $L=(f-t)'(x)\colon T_xX\rightarrow Y_x$. Taking the vector 
$h=(a_1\wedge\ldots \wedge a_n)\otimes {(b_1\wedge\ldots \wedge b_l)}^\ast$ determining the orientation of $L$, we orient 
$$
\wt{L}\colon T_{(x,t)}(X\times [0,1])\rightarrow Y_x,\quad (a,b)\rightarrow La
$$
by the vector 
$\wt{h}=(a_1\wedge\ldots \wedge a_n\wedge e)\otimes (b_1\wedge\ldots \wedge b_l)^\ast$,
where the vector $e$ defines the standard orientation of $[0,1].$
The linear map $\wt{L}$ belongs to the linearization space of $\wh{f}$ at $(x,t)$, so that the latter obtains an orientation.
\end{remark}


\section{Invariants}
We consider the oriented and proper sc-Fredholm section $(f, \mathfrak{o})$ of the strong bundle $P\colon Y\to X$ over the tame M-polyfold $X$ admitting sc-smooth bump functions. The solution set $S=\{x\in X\, \vert \, f(x)=0\}$ is compact. If $N$ is an auxiliary norm on $P$ we know from the perturbation and transversality result, Theorem \ref{thm_pert_and_trans}, that there exists an open neighborhood $U\subset X$ of $S$ such that for every $\ssc^+$-section $s$ of $P$ which is supported in $U$ and satisfies $N(s(x))\leq 1$ for all $x\in X$, the solution set $S_{f+s}=\{x\in X\, \vert \, f(x)+s(x)=0\}$ is compact. Moreover, there exist distinguished such 
$\ssc^+$-sections having the additional property that,  for all $x\in S_{f+s}$, the  pair $(f+s, x)$ is in general position to the boundary $\partial X$. Its solution set is a compact manifold with boundary with corners and, as we have seen above, possesses a natural orientation induced from the orientation $\mathfrak{o}$ of the sc-Fredholm section $f$.
In the following theorem we shall call these distinguished $\ssc^+$-sections $s$ {\bf admissible for the pair $(N, U)$.}

In Section \ref{subs_sc_differential} we have introduced the differential algebra 
$\Omega^\ast_\infty(X,\partial X)=\Omega_\infty^\ast(X)\oplus \Omega_\infty^{\ast-1}(\partial X).$ Its differential $d(w, \tau)=(d\omega, j^\ast w-d\tau)$, in which $j\colon \partial X\to X$ is the inclusion map, satisfies $d\circ d=0$ and we denote the associated cohomology by 
$H^\ast_{\textrm{dR}}(X, \partial X)$. 




\begin{theorem}\index{T- Invariants for oriented proper sc-Fredholm sections}
Let $P\colon Y\rightarrow X$ be a strong bundle over the tame M-polyfold $X$. We assume that $X$ admits sc-smooth bump functions.
Then there exists a well-defined map which associates with  a proper and oriented sc-Fredholm section $(f, \mathfrak{o})$ of the bundle  $P$ a linear map 
$$
\Psi_{(f,\mathfrak{o})}\colon H^\ast_{\textrm{dR}}(X,\partial X)\rightarrow {\mathbb R}
$$
having the following properties.
\begin{itemize}
\item[{\em (1)}]\ If $N$ is an auxiliary norm on $P$ and $s$ a $\ssc^+$-section of $P$ which is admissible for the pair $(N, U)$, then the solution set  $S_{f+s}=\{x\in X\, \vert \, f(x)+s(x)=0\}$ is an oriented and compact manifold with boundary with corners, and 
$$
\Psi_{(f,\mathfrak{o})}([\omega,\tau]) = \int_{S_{f+s}} \omega -\int_{\partial S_{f+s}}\tau,
$$ 
holds for every cohomology class $[\omega,\tau]$ in $H^\ast_{dR}(X,\partial X)$. The integrals on the right-hand side are defined to be zero, if the dimensions of the forms and manifolds do not agree.  
\item[{\em (2)}]\ For  a proper and oriented homotopy between two oriented sc-Fredholm sections $(f_0,\mathfrak{o}_0)$ and $(f_1,\mathfrak{o}_1)$ of the bundle $P$  we have the identity
$$
\Psi_{(f_0,\mathfrak{o}_0)}=\Psi_{(f_1,\mathfrak{o}_1)}.
$$
\end{itemize}
\end{theorem}
\begin{proof}
(1)\,  The properness of the sc-Fredholm section $f$ implies the compactness of its solution set $S_f=\{x\in X\,\vert \, f(x)=0\}$. If $N$  is an auxiliary norm $N$, then there exist, by Theorem 
\ref{thm_pert_and_trans}, an open neighborhood $U\subset X$ of $S_f$ and a $\ssc^+$-section of $s_0$ of $P$ which is admissible for the pair $(N, U)$ such that the solution set $S_0=S_{f+s_0}=\{x\in X\, \vert \, f(x)+s_0(x)=0\}$ is, in addition, an oriented compact manifold with boundary with corners of dimension $n=\dim S_{f+s_0}=\ind (f'(x))$ for $x\in S_{f+s_0}$. 
The orientation $(f, \mathfrak{o})$ induces an orientation on $S_{f+s}$ and its local faces.  We define the map $\Psi_{(f,\mathfrak{o})}$ by 
\begin{equation}\label{int_eq_1}
\Psi_{(f,\mathfrak{o})}([\omega,\tau]):=\int_{S_{f+s_0}}\omega -\int_{\partial S_{f+s_0}}\tau
\end{equation}
for a cohomology class $[\omega, \tau]$ in $H^\ast_{\textrm{dR}}(X,\partial X)$. The integrals on the right-hand side are defined to be zero 
if the dimensions of the forms and manifolds do not agree. 




In order to verify that the 
definition \eqref{int_eq_1} does not depend on the choice of admissible section $s_0$,  we take a second $\ssc^+$-section $s_1$ admissible for the pair $(N, U)$ so that the solution set $S_1=S_{f+s_1}=\{x\in X\, \vert \, f(x)+s_1(x)=0\}$ is a compact oriented manifold with boundary with corners. As explained in Remark \ref{rem_homotopy}, 
there exists a proper $\ssc^+$- homotopy $s_t$ connecting  $s_0$ with  $s_1$
such the sc-Fredholm section  $F$, defined on $X\times [0,1]$ by $F(x,t)=f(x)+s_t(x)$, is in %
general position to the boundary of $ X\times [0,1]$ for every  $(x,t)$ in the solution set   $S_F=\{(x, t)\in X\times [0,1]\, \vert \, f(x)+s_t(x)=0\}$, which is an 
oriented compact manifold with boundary with corners, whose orientation is induced from the orientation  $\mathfrak{o}$ of $f$ and the standard orientation of $[0,1]$.  We recall that  $[\omega,\tau]$ satisfies $d\omega=0$ and $j^\ast\omega=d\tau$ on $\partial X$ where $j\colon \partial X\to X$ is the inclusion map. Extending $\omega$ to the whole space $X\times [0,1]$, we introduce the form $\ov{\omega}$ on $X\times [0,1]$ by 
$$\ov{\omega}=p_1^\ast\omega\wedge p_2^\ast dt,$$
where $p_1\colon X\times [0,1]\to X$ and $p_2\colon X\times [0,1]\to [0,1]$ are the sc-projection maps. It follows that $d\ov{\omega}=0$ and $\ov{\omega}\vert \partial X\times [0,1]=d\ov{\tau}$, where $d\ov{\tau}=\ov{p}_1^\ast (d\tau)\wedge \ov{p}_2^\ast dt.$ The maps $\ov{p}_i$ for $i=1, 2$ are the restrictions of $p_i$ to $\partial X\times [0,1]$. 
By Stokes theorem,
$$\int_{S_F}d\ov{\omega}=\int_{\partial S_F}\ov{\omega}=0.$$
We decompose the boundary $\partial S_F$ of the manifold $S_F$ into 
$$\partial S_F=S_0\cup S_1\cup \wt{S},$$
where $S_0\subset \partial X\times \{0\}$, $S_1\subset\partial X\times \{1\}$, and $\wt{S}\subset \partial X\times (0, 1)$, as illustrated in Figure \ref{pict7}.

\begin{figure}[htb]
\begin{centering}
\def\svgwidth{70ex}
\input{pict7.pdf_tex}
\caption{}\label{pict7}
\end{centering}
\end{figure}

Hence,
$$
0=\int_{\partial S_F}\ov{\omega}=\int_{\partial S_F}d\ov{\tau},
$$
and we compute the two integrals, taking the orientations into account,
$$0=\int_{\partial S_F}\ov{\omega}=\int_{S_0}\omega-\int_{S_1}\omega-\int_{\wt{S}}\ov{\omega}.$$
Integration of $d\ov{\tau}$ over $\partial S_F$ using Stokes theorem gives 
\begin{equation*}
\begin{split}
0&=\int_{\partial S_F}d\ov{\tau}=\int_{S_0}d\tau-
\int_{S_1}d\tau+\int_{\wt{S}}\ov{\omega}\\
&=\int_{\partial S_0}\tau-\int_{\partial S_1}\tau
+\int_{\wt{S}}\ov{\omega}.
\end{split}
\end{equation*}
Comparing the integrals, we 
obtain 
$$\int_{S_0}\omega-\int_{\partial S_0}\tau=\int_{S_1}\omega-\int_{\partial S_1}\tau,$$
which shows that the definition \eqref{int_eq_1} does indeed not depend on the choice of the distinguished section $s_0$.

The formula in (2) is verified by the same homotopy argument as in (1).
\qed \end{proof}


In the special situation $\partial X=\emptyset$ of no boundary, the map $\Psi_{(f,\mathfrak{o})}\colon H^n_{\textrm{dR}}(X)\rightarrow {\mathbb R}$ is defined by 
$$
\Psi_{(f,\mathfrak{o})}([\omega])=\int_{S_{f+s}}\omega
$$ 
for $[\omega]\in H^n_{\textrm{dR}}(X)$,  if $n$ is equal to the index of the sc-Fredholm section $f$, and zero otherwise.

\section{Appendix}
\subsection{Proof of Lemma \ref{o6.6}}\label{oo6.6}
The goal is to prove that given an exact sequence
$$
{\bm{E}}\colon\ \   0\rightarrow A\xrightarrow{\alpha} B\xrightarrow{\beta} C\xrightarrow{\gamma} D\rightarrow 0
$$
there is a well-defined natural isomorphism $\Phi_{\bm{E}} :\lambda(A)\otimes\lambda^\ast(D)\rightarrow \lambda(B)\otimes \lambda^\ast(C)$.
\begin{proof}[Lemma \ref{o6.6}]
Recalling the exact sequence 
$$
{\bm{E}}:\quad  0\rightarrow A\xrightarrow{\alpha} B\xrightarrow{\beta} C\xrightarrow{\gamma} D\rightarrow 0,
$$
we choose linear subspaces $V\subset B$ and $W\subset C$ such  that
$$
B=\alpha(A)\oplus V\quad   \text{and}\quad    C=\beta(B) \oplus W
$$
and denote this choice of subspaces by $(V, W)$. The maps 
$$\beta_V\colon V\to \beta (B)\quad \text{and}\quad \gamma_W\colon W\to D$$
are isomorphisms and  $\beta(B)=\beta(V)$ by exactness. Fixing the basis 
$a_1,\ldots ,a_n$ of $A$ and  $d_1,\ldots ,d_l$ of $D$, we choose any basis $b_1,\ldots ,b_{m-n}$ of $V\subset B$ and define the basis 
$c_1,\ldots ,c_{m-n}$ of $\beta (B)\subset C$ by  $c_i=\beta_V(b_i)$, and  define the basis  $c_1',\ldots ,c_l'$ of $W$ by $\gamma_W(c_i')=d_i$.



In order to show that  the vector
$$
(\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge b_1\wedge\ldots \wedge b_{m-n})\otimes ( c_1'\wedge\ldots \wedge c_l'\wedge c_1\wedge\ldots \wedge c_{m-n})^\ast
$$
does not depend on the choice of the basis $b_1,\ldots ,b_{m-n}$ of $V$,  we choose a second basis
 $\ov{b}_1,\ldots ,\ov{b}_{m-n}$ of $V$, so that there is a linear isomorphism
$\sigma\colon V\rightarrow V$ mapping one basis into the other by $\ov{b}=\sigma (b)$.
Hence 
$$\ov{b}_1\wedge \ldots \wedge \ov{b}_{m-n}=\det (\sigma )\cdot b_1\wedge \ldots \wedge b_{m-n},$$
where $\det(\sigma)$ is the usual determinant of the  linear map $\sigma$. 
The associated basis $\ov{c}_1,\ldots ,\ov{c}_{m-n}$ of $\beta (B)$  is then defined by 
$\ov{c}_i =\beta_V(\ov{b}_i)$. The two basis 
$c_i$ and $\ov{c}_i$ of $\beta (B)$ are therefore related by the isomorphism
$$
 \beta_V\circ \sigma\circ \beta_V^{-1}\colon \beta(B)\rightarrow\beta(B)
 $$
and consequently,
$$
\ov{c}_1\wedge\ldots \wedge \ov{c}_{m-n} =\det( \beta_V\circ \sigma\circ \beta_V^{-1})c_1\wedge\ldots \wedge c_{m-n}=\det(\sigma)c_1\wedge\ldots \wedge c_{m-n}.
$$
From this we obtain
\begin{equation*}
\begin{split}
&(\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge\bar{b}_1\wedge\ldots \wedge \ov{b}_{m-n})\otimes ( c_1'\wedge\ldots \wedge c_l'\wedge \ov{c}_1\wedge\ldots \wedge \ov{c}_{m-n})^\ast\\
&\quad \quad =\det (\sigma) (\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge b_1\wedge\ldots \wedge b_{m-n})\\
&\phantom{\quad \quad =}\otimes \dfrac{1}{\det (\sigma)}( c_1'\wedge\ldots \wedge c_l'\wedge c_1\wedge\ldots \wedge c_{m-n})^\ast,
\end{split}
\end{equation*}
so that the basis change has indeed no influence. 




Next we replace the basis  $a_1,\ldots ,a_n$ of $A$  by the basis $\ov{a}_1,\ldots ,\ov{a}_n$ by  means of the linear isomorphism  $\sigma\colon A\rightarrow A$ and replace  the basis $d_1,\ldots ,d_l$ of $D$ 
by the basis $\bar{d}_1,\ldots ,\bar{d}_l$  by means of the isomorphism $\varepsilon\colon D\rightarrow D$. Then 
$$(\ov{a}_1\wedge \ldots \wedge \ov{a}_n)\wedge (\ov{d}_1\wedge \ldots \wedge \ov{d}_l)^\ast=
\dfrac{\det (\tau)}{\det (\varepsilon)}\cdot 
(a_1\wedge \ldots \wedge a_n)\wedge (d_1\wedge \ldots \wedge d_l)^\ast,$$
and the vector 
$(a_1\wedge \ldots \wedge a_n)\wedge (d_1\wedge \ldots \wedge d_l)^\ast$ is independent of the choices of the basis if and only if $\det (\tau)=\det (\varepsilon)$. So far, the definition of $\Phi_{\bm{E}}$ could  only depend on the choice 
 of the complements $(V,W)$.




So, we  assume that $(V,W)$ and $(V',W')$ are two choices. We assume that $a_1,\ldots ,a_n$ and $d_1,\ldots ,d_l$ are fixed bases for $A$ and $D$, respectively.
Now fixing  any basis $b_1,\ldots ,b_{m-n}$ of  $V$, we find vectors $q_1,\ldots ,q_{m-n}$ of  $\alpha (A)$ such  that $\ov{b}_1,\ldots ,\ov{b}_{m-n}$ with $\ov{b}_i=b_i+q_i$ is a basis of  $V'$. We define $c_i\in W$ by  $\gamma_W(c_i)=d_i$. Then we choose  $p_i\in\beta(C)$ so that $\ov{c}_i=c_i +p_i\in W'$
and $\gamma_{W'}(\ov{c}_i)=d_i$. Now we use the fact that for  $(V,W)$ and $(V',W')$ other choices do not matter.
Using that $q_j$ is a linear combination of 
$\alpha (a_1),\ldots ,\alpha (a_n)$ and $p_j$ a linear combination of $c_1',\ldots ,c_l'$, it follows that 
\begin{equation*}
\begin{split}
&(\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge b_1\wedge\ldots \wedge b_{m-n})\otimes ( c_1'\wedge\ldots \wedge c_l'\wedge c_1\wedge\ldots \wedge c_{m-n})^\ast\\
&\quad =(\alpha(a_1)\wedge\ldots \wedge\alpha(a_n)\wedge\ov{b}_1\wedge\ldots \wedge \ov{b}_{m-n})\otimes ( c_1'\wedge\ldots \wedge c_l'\wedge \ov{c}_1\wedge\ldots \wedge \ov{c}_{m-n})^\ast,
\end{split}
\end{equation*}
which completes the proof that $\Phi_{\bm{E}}$ is well-defined.
\qed \end{proof}

\subsection{Proof of Proposition \ref{ooo6.6}}\label{oooo6.6}
\begin{proof}[Proof of Proposition \ref{ooo6.6}]
Let $P, Q\in\Pi_T$, $P\leq Q$,  and recall the exact sequence \begin{equation*}
{\bm{E}}_{(T,Q)}\colon\quad 0\rightarrow\ker(T)\xrightarrow{j^Q_T}\ker(QT)\xrightarrow{\Phi^Q_T} F/R(Q)\xrightarrow{\pi^Q_T}  \text{coker}(T)\rightarrow 0.
\end{equation*}
By definition of the determinant,  $h\in \det(T)$ is of  the form
$$
h=(a_1\wedge,\ldots ,\wedge a_n)\otimes ((d_1+R(T))\wedge\ldots \wedge (d_l+R(T)))^\ast,
$$
where $a_1,\ldots ,a_n$ is a basis of  $\ker(T)$ and $d_1+R(T),\ldots , d_l+R(T)$ is a basis of $F/R(T)$ satisfying $d_i\in R(I-Q)$.
The latter condition can be achieved since, by definition of $\Pi_T$,  $R(QT)=R(Q)$.
We choose  the  vectors $b_1,\ldots ,b_m$ in $\ker(QT)$
so that $a_1,\ldots ,a_n,b_1,\ldots ,b_m$ form a basis of  $\ker(QT)$ and take the linearly independent vectors  $T(b_1)+R(Q),\ldots ,T(b_m)+R(Q)$ in $F/R(Q)$.
By definition of the isomorphism $\gamma^Q_T\colon \det T\to \det (QT)$, 
\begin{equation*}
\begin{split}
&\gamma^Q_T(h)\\
&\quad =(a_1\wedge\ldots \wedge a_n\wedge b_1\wedge\ldots \wedge b_m)\otimes\\
&\quad ((d_1+R(Q))\wedge\ldots \wedge (d_l+R(Q))\wedge(T(b_1)+R(Q))\wedge\ldots \wedge (T(b_m)+R(Q)))^\ast .
\end{split}
\end{equation*}
We note that 
\begin{equation} 
T(a_1)=\ldots =T(a_n)=0\ \text{and}\ \ QT(b_1)=\ldots =QT(b_m)=0.
\end{equation}
Next we consider the exact sequence 
\begin{equation*}
0\rightarrow\ker(QT)\xrightarrow{j_{QT}^P}\ker(PT)\xrightarrow{\Phi^P_{QT}} F/R(P)\xrightarrow{\pi_{QT}^P}\text{coker}(QT)\rightarrow 0.
\end{equation*}
In order to  compute $\gamma^P_{QT}(\gamma^Q_T(h))$ we take as basis of  $\ker(QT)$ the vectors
$$
a_1,\ldots ,a_n,b_1,\ldots ,b_m,
$$
  and as basis of $F/R(Q)$ the vectors
   $$
   d_1+R(Q),\ldots ,d_l +R(Q),T(b_1)+R(Q),\ldots ,T(b_m)+R(Q).
   $$
Since  $\ker(QT)\subset\ker(PT)$,  we choose the vectors  $\wt{b}_1,\ldots ,\wt{b}_k$  in $\ker (PT)$ so that
$a_1,\ldots ,a_n,b_1,\ldots ,b_m,\wt{b}_1,\ldots ,\wt{b}_k$ form  a basis of  $\ker(PT)$.  We define 
$$
\alpha^P=a_1\wedge\ldots \wedge a_n\wedge b_1\wedge \ldots \wedge b_m\wedge \wt{b}_1\wedge\ldots \wedge \wt{b}_k,
$$
and note  that $\pi^P_{QT}(d_i+R(P))=(I-P)d_i +R(Q)=d_i+R(Q)$.  The vectors 
\begin{gather*}
d_1+R(P),\ldots ,d_l+R(P),\quad T(b_1)+R(P),\ldots ,T(b_m)+R(P),\\
QT(\wt{b}_1)+R(P),\ldots ,QT(\wt{b}_k)+R(P)
\end{gather*}
are a basis 
of $F/R(P)$ and we abbreviate  their  wedge product by $\beta^P$, so that 
$$
\gamma^P_{QT}(\gamma^Q_T(h)) = \alpha^P\otimes {(\beta^P)}^\ast.
$$
Recall that $d_i=(I-Q)d_i$ and $(I-Q)T(b_i)=T(b_i)$ for $i=1,\ldots ,m$. Abbreviating 
$[d]=d+R(P)$, the projection  $Q\colon F\rightarrow F$ induces the  projection
$\wt{Q}\colon F/R(P)\rightarrow F/R(P)$,  defined by $[d]\mapsto [Qd]$. Then $(I-\wt{Q})[d]=[(I-Q)d]$,  and therefore   
$$
F/R(P)= \ker(\wt{Q})\oplus \ker(I-\wt{Q}).
$$
The vectors 
 \begin{gather*}
 [d_1],\ldots ,[d_l],  [T(b_1)],\ldots ,[T(b_m)]\in \ker(\wt{Q}),
[QT(\wt{b}_1)],\ldots ,[QT(\wt{b}_k)]\in\ker(I-\wt{Q})
\end{gather*}
form  a basis for $F/R(P)$. By the  standard properties of the wedge product, 
\begin{equation*}
\begin{split}
\beta^P&=[d_1]\wedge\ldots \wedge[d_l]\wedge [T(b_1)]\wedge\ldots \wedge[T(b_m)]\wedge[QT(\wt{b}_1)]\wedge\ldots \wedge [QT(\wt{b}_k)]\\
&=[d_1]\wedge\ldots \wedge[d_l]\wedge [T(b_1)]\wedge\ldots \wedge[T(b_m)]\wedge[T(\wt{b}_1)]\wedge\ldots \wedge [T(\wt{b}_k)].
\end{split}
\end{equation*}
Hence we arrive for the composition 
$\gamma^P_{QT}\circ \gamma^Q_T$ at the formula
\begin{eqnarray*}
&&\gamma^P_{QT}(\gamma^Q_T(h))\\
& =& \alpha^P\otimes ([d_1]\wedge\ldots \wedge[d_l]\wedge [T(b_1)]\wedge\ldots \wedge[T(b_m)]\wedge[T(\wt{b}_1)]\wedge\ldots \wedge [T(\wt{b}_k)])^\ast.
\end{eqnarray*}
Next we compute $\gamma_T^P(h)$. In order to do so we start with the basis $a_1,\ldots ,a_n$ of  $\ker(T)$
and extend it to a basis of  $\ker(PT)$  by choosing   
 $b_1,\ldots ,b_m,\wt{b}_1,\ldots ,\wt{b}_k$. The wedge of all these vectors  is $\alpha^q$.
For $F/R(T)$ we have the basis 
$d_1+R(T),\ldots ,d_l +R(T)$.   Recall that $(I-Q)d_i=d_i$ so that $d_i\in \ker(\wt{Q})$. Further, 
\begin{equation*}
\begin{split}
\pi^P_T(d_i +R(P))&=(I-P) d_i+R(T)\\
&=(I-P)(I-Q)d_i+R(T)\\
&=(I-Q)d_i+R(T)\\
&=d_i+R(T).
\end{split}
\end{equation*}
Then we take  the basis of $F/R(P)$ formed  (with the previous convention) by the vectors
$$
[d_1],\ldots ,[d_l], [T(b_1)],\ldots ,[T(b_m)],[T(\wt{b}_1)],\ldots ,[T(\wt{b}_k)],
$$
and note that their  wedge product is equal to $\beta^P$. By definition,
$$
\gamma^P_T(h)=\alpha^P\otimes {(\beta^P)}^\ast,
$$
which agrees with  
$\gamma^P_{QT}\circ \gamma^Q_T(h)$.  The proof  of Proposition \ref{ooo6.6} complete.
\qed \end{proof}




\begin{partbacktext}
\part{Ep-Groupoids}
\noindent The basic notion in Part II is that of an ep-groupoid.  It generalizes the classical notion of an \'etale proper Lie groupoid
to the polyfold setup. From the view point of Fredholm theory it  allows to efficiently describe problems with local symmetries. 
Different ep-groupoids can be used to describe the same problem and it useful to understand the relationship between various descriptions.
This is discussed in the context of equivalences of categories and localization and leads to the introduction of the notion of a generalized
isomorphism.  An important topic is the study of branched ep$^+$-subgroupoids 
which naturally arise as solution spaces of sc-Fredholm section functors. Another topic important in applications is concerned with proper covering functors.
The discussion ends with the study of the various notions and their behavior under generalized isomorphisms and the introduction of a new kind of space called a
polyfold. In some sense it  generalizes the notion of an orbifold with boundary and corners to the world of a generalized differential geometry based on sc-smooth retracts. This basic ideas in the part  are  based on the paper \cite{HWZ3.5}

\end{partbacktext}

\chapter{Ep-Groupoids}
An ep-groupoid is the generalization of an \'etale proper Lie groupoid to the sc-smooth world.
Philosophically it should be viewed as a generalization of an atlas (in the theory of manifolds) in two different ways.
It generalizes smoothness to sc-smoothness and  introduces geometric structures beyond manifolds.  The development of the present part of the theory is quite parallel to parts of the theory Lie groupoids, see \cite{Mj}.
Many of the ideas about Lie groupoids and their importance go back to Haefliger, \cite{Haefliger1,Haefliger1.5, Haefliger2,Haefliger3}.

\section{Ep-Groupoids and Basic Properties}\label{sec_1_1}

We start with the notion of a groupoid following the expositions in  \cite{Mj}-\cite{MM} and recall that a {\bf small category}\index{Small category} is a category whose object class as well as the morphism class are sets.
 \begin{definition}[{\bf Groupoid}] \label{groupoid}\index{D- Groupoid}
A  groupoid $X=(X,\bm{X})$ is a small category consisting of the set $X$ of objects, denoted by $x$, and the set $\bm{X}$ of morphisms (arrows) which are assumed to be invertible, and the following five structure maps $(s, t, m, u, i)$.
\begin{itemize}
\item[(1)]\ {\bf Source and target maps $s$ and $t$}.\index{D- Target map}\index{D- Source map}
The source and the target maps $s, t\colon \bm{X}\to X$ assign to every morphism $\phi\colon x\to  y$ in  $\bm{X}$ its source $s(\phi )=x$ and its target $t(\phi )=y$. 
 \item[(2)]\ {\bf Multiplication map $m$}.\index{D- Multiplication map}
The associative multiplication (composition) map 
$$m\colon \bm{X}{_{s}\times_t}\bm{X}\to \bm{X},\quad m(\phi, \psi)=\phi\circ \psi$$
is defined on the fibered product 
$$ \bm{X}{_{s}\times_t}\bm{X}=\{(\phi, \psi)\in \bm{X}\times \bm{X}\, \vert \, s(\phi)=t(\psi)\}$$
so that if $\psi\colon x\to z$ and $\phi\colon z\to y$, then $\phi\circ \psi\colon x\to y$.
\item[(3)]\ {\bf Unit map $u$}.\, \index{D- $1$-map}
For every object $x\in X$ there exists the unit morphism $1_x\colon x\to x$ in $\bm{X}$, which is a $2$-sided unit for the composition, that is $\phi \circ 1_x=\phi$ and $1_x\circ \psi=\psi$ for all morphisms $\phi, \psi\in \bm{X}$ satisfying $s(\phi )=x=t(\psi)$. These unit morphisms together define the unit map 
$$u\colon X\to \bm{X},\quad u(x)=1_x.$$
\item[(4)]\ {\bf Inverse map $\iota$}.\index{D- Inverse map}
For every morphism $\phi\colon x\to y$ in $\bm{X}$ there exists the inverse morphism $\phi^{-1}\colon y\to x$ which is a $2$-sided inverse (isomorphism), that is $\phi\circ \phi^{-1}=1_y$ and 
$\phi^{-1}\circ \phi=1_x$. These inverses together define the inverse map 
$$\iota\colon \bm{X}\to \bm{X}, \quad \iota(\phi )=\phi^{-1}.$$
\end{itemize}
\qed
\end{definition}
Rather than writing $(X,\bm{X})$ for a groupoid we shall often write simply $X$.
With 
$\text{mor}(x, y)\subset \bm{X}$
we shall abbreviate the set of all morphisms $\phi\in \bm{X}$ satisfying $s(\phi)=x$ and $t(\phi )=y$.
The {\bf orbit space}\index{Orbit space} of the groupoid $(X, \bm{X})$,  denoted by 
$$
\abs{X}=X/\sim,
$$
is the quotient of the set of objects by the equivalence relation defined by $x\sim y$ if and only if there exists a morphism $\phi\colon x\to y$ between the two objects. The equivalence class will be denoted by 
$$\abs{x}:=\{y\in X\, \vert \, y\sim x\},$$
and we have the quotient map
$$\pi\colon X\to \abs{X},\quad \pi (x)=\abs{x}.$$
\begin{definition}[{\bf Isotropy group $G_x$}] \label{isotropy_group}
For fixed $x\in X$ we denote by $G_x$ the isotropy group (stabilizer group) of $x$\index{D- Isotropy group} defined by 
$$G_x=\{\phi \in \bm{X}\, \vert \, \phi\colon x\to x\}.$$
\qed
\end{definition}

The crucial concept of  ep-groupoids defined next can be viewed as  M-polyfold version of  \'etale and proper Lie groupoids discussed  f.e. in \cite{Mj} and \cite{MM}. The ideas in the classical case go back to A. Haefliger, \cite{Haefliger1,Haefliger1.5, Haefliger2,Haefliger3}.


\begin{definition}[{\bf Ep-groupoid}]\label{ep-groupoid_def}
An {\bf ep-groupoid}\index{D- Ep-groupoid} $X=(X,\bm{X})$ consists of a groupoid equipped  with   M-polyfold structures on the object set and the morphism set $\bm{X}$ having  the following properties.
\begin{itemize}
\item[(1)]\ ({\bf etal\'e}).\, \index{D- \'Etale}
  The source and target maps $s,t\colon \bm{X}\rightarrow X$ are  local sc-diffeomorphisms.
\item[(2)]\ The unit map $u$ and  the inverse  map $\iota$ are sc-smooth.
\item[(3)]\ ({\bf Properness}).\, \index{D- Ep-groupoid, properness} Every point $x\in X$ possesses an open neighborhood $V(x)$ of $x$ in $X$ such  that the map
$$t\colon s^{-1}\bigl(\cl_X(V(x)) \bigr)\rightarrow X$$
 is proper.
\end{itemize}
Since $s$ is a  local sc-diffeomorphism, the 
fibered product $\bm{X}{_{s}\times_t}\bm{X}$ is in a natural way a M-polyfold in view of Lemma 2.8 in \cite{HWZ3.5} and we require
\begin{itemize}
\item[(4)]\ The multiplication map $m\colon \bm{X}{_{s}\times_t}\bm{X}\rightarrow \bm{X}$
is sc-smooth.
\end{itemize}
In particular, all the structure maps $(s, t, m, u, i)$ are sc-smooth maps. 
\qed
\end{definition}

Since $s, t\colon \bm{X}\to X$ are local sc-diffeomorphism, every morphism $\phi\colon x\to y$ of an ep-groupoid has an extension to a local sc-diffeomorphism  $\wh{\phi}$ satisfying $\wh{\phi}(x)=y$ which is defined as follows. There exist open neighborhoods $\bm{U}(\phi)\subset \bm{X}$ and $U(x), U(y)\subset X$ such that $s\colon \bm{U}(\phi )\to U(x)$ and $t\colon \bm{U}(\phi)\to U(y)$ are sc-diffeomorphisms,  and the local sc-diffeomorphism 
$\wh{\phi}$\index{$\wh{\phi}$} is defined by 
$$
\wh{\phi}=t\circ (s\vert \bm{U}(\phi))^{-1}\co U(x)\to U(y).
$$
We also note that in the case that $\phi$ is smooth, i.e. $\phi\in \bm{X}_\infty$, there is an associated
sc-isomorphism 
$$
T\phi:T_{s(\phi)}X\rightarrow T_{t(\phi)}
$$
defined by $T\phi:= T\wh{\phi}(x)$\index{$T\phi$}. More generally we have $T\wh{\phi}:TU(s(\phi))\rightarrow TU(t(\phi))$. We note that $T\phi$ can be defined for $\phi$ on level at least $1$ and will give 
a bounded linear isomorphism on level $0$. Only in the case
that it is smooth $T\phi$ will be an sc-operator.
\begin{definition}\index{D- Tangent of $\phi$}
Associated to a smooth morphism $\phi$ we have the so-called {\bf associated local sc-diffeomorphism}
$\wh{\phi}$, as well as its {\bf tangent} $T\phi$.
\qed
\end{definition}

We point out that the above properness assumption in the definition of an ep-groupoid is different from the properness  notion in the classical Lie-groupoids which requires that the map $(s, t)\colon \bm{X}\to X\times X$ is proper. The latter  requirement is too weak for some of our  constructions.


The M-polyfolds $X$ and $\bm{X}$ are equipped with a filtration,
$$X=X_0\supset X_1\supset X_2\supset\ldots \supset X_\infty=\bigcap_{k\geq 0}X_k,$$
and a similar filtration on the morphism set $\bx$.
The set $X_\infty$ is dense in every space $X_k$. If $x$ belongs to the M-polyfold $X$, we denote by $\text{ml}(x)\in \N\cup \{\infty\}$\index{$\text{ml}(x)$}
the largest non-negative integer $m$ or $\infty$ such that $x\in X_m$. Here  ${\mathbb N}=\{0,1,2,3,..\}$.
Since in an ep-groupoid $(X, \bm{X})$ the source and the target maps are local sc-diffeomorphisms and therefore preserve by definition the levels, we conclude that 
$$\text{ml}(x)=\text{ml}(y)=\text{ml}(\phi)$$
for every morphism $\phi\colon x\to y$ in $\bm{X}.$
Consequently, the above filtration on the M-polyfold $X$ induces 
the filtration 
$$\abs{X}=\abs{X_0}\supset \abs{X_1}\supset\ldots \supset  \abs{X_\infty}=\bigcap_{k\geq 0}\abs{X_k}$$
on the orbit space $\abs{X}=X/\sim$.


For the ep-groupoid $(X, \bm{X})$ the degeneracy maps $d_X\colon X\to \N$  and $d_{\bm{X}}\colon \bm{X}\to \N$ are both defined. By Proposition \ref{newprop2.24}, these indices are invariant under local sc-diffeomorphisms and we deduce 
that 
$$d_X(s(\phi ))=d_{\bm{X}}(\phi )=d_{X}(t(\phi))$$
for every morphism $\phi \in \bm{X}$. In particular,
$$d_{X}(x)=d_X(x')\quad \text{if\quad $x\sim x'$},$$
so that  we obtain the non-degeneracy index on the orbit space $\abs{X}$ as follows.

\begin{definition}[{\bf Induced index $d_{\abs{X}}$}]
\index{D- Induced degeneracy index} 
The {\bf induced degeneracy index} $d_{\abs{X}}\colon \abs{X}\to \N$ is defined by 
$$d_{\abs{X}}(\abs{x})=d_X(x).$$
\qed
\end{definition}

\begin{definition}[{\bf Tame ep-groupoid}]\index{D- Tame ep-groupoid}
The ep-groupoid $(X, \bm{X})$ is called {\bf tame} if the object space $X$ is a tame M-polyfold as introduced in Definition \ref{def_tame_m-polyfold}.
\qed
\end{definition}

In a tame ep-groupoid $(X, \bm{X})$ not only $X$ is a tame M-polyfold but also $\bm{X}$ is a tame M-polyfold. This follows from the facts that $\bm{X}$ is locally sc-diffeomorphic by $s$ to $X$ and  the tameness condition is invariant under local sc-diffeomorphisms.


\begin{definition}[{\bf Category ${\mathcal E}{\mathcal P}$}]
\index{D- Category of ep-groupoids}
By ${\mathcal E}{\mathcal P}$\index{${\mathcal E}{\mathcal P}$} 
we denote the category whose objects are the ep-groupoids and whose morphisms $f\colon (X, \bm{X})\rightarrow (Y, \bm{Y})$
are the functors which are sc-smooth maps between the object spaces as well as the morphism spaces.
\qed
\end{definition}

Actually, it is sufficient to require that the functor $f$ is sc-smooth between the object spaces $X\to Y$ because the sc-smoothness of $f\colon \bm{X}\to \bm{Y}$ follows again from the properties of the source map $s\colon \bm{X}\to X$ as follows. 
Given $\phi\in \bm{X}$ and $f(\phi)=\psi\in \bm{Y}$ there exist open neighborhoods $\bm{U}(\phi)$, $\bm{U}(\psi)$, $U(s(\phi))$, and $U(s(\psi))$ satisfying 
$f(U(s(\phi)))\subset U(s(\psi))$ and $f(\bm{U}(\phi))\subset \bm{U}(\psi)$. Moreover,  $s\colon \bm{U}(\phi)\rightarrow U(s(\phi))$ and $s\colon \bm{U}(\psi)\rightarrow U(s(\psi))$ are sc-diffeomorphisms. Therefore, the claim follows from the formula  
$$
f(\gamma)= (s\vert \bm{U}(\psi))^{-1}(f(s(\gamma)))
$$
for all $\gamma\in \bm{U}(\phi).$


We equip the orbit space  $\abs{X}$ 
with the {\bf quotient topology}\index{Quotient topology}, i.e. the finest topology for which the projection  $\pi\colon X\rightarrow \abs{X}$, $x\rightarrow \abs{x}$, is  continuous. A subset $V$ of $\abs{X}$ is open if and only if the set of all objects $x\in X$ which belong to a class in $V$ is open, i.e.,  $\pi^{-1}(V)$ is open in $X$.

\begin{proposition}[{\bf Openness of $\pi$}]\label{q-open}\index{P- Openness of $\pi$}
Let $(X,\bm{X})$ be an ep-groupoid and assume that the orbit space $\abs{X}$  is equipped with the quotient topology. Then
the projection map $\pi\colon X\rightarrow \abs{X}$ is open. 
\end{proposition}
\begin{proof}
Let $U$ be an open subset of $X$. Then $\pi(U)\subset \abs{X}$ is open if and only if $\pi^{-1}(\pi(U))$ is open in $X$.
A point $y\in X$ belongs to $\pi^{-1}(\pi(U))$ if and only if there exist $x\in U$ and $\phi\in \bm{X}$
satisfying  $s(\phi)=x$ and $t(\phi)=y$. From the property (1) of an ep-groupoid we conclude  that there exist open neighborhoods
$\bm{V}(\phi)$, $V(x)$ and $V(y)$ such  that
$$
s\colon \bm{V}(\phi)\rightarrow V(x)\quad  \text{and}\quad t\colon \bm{V}(\phi)\rightarrow V(y)
$$
are sc-diffeomorphisms. We can choose  an open neighborhood $O(y)\subset V(y)$ such that $s\circ (t|V(\phi))^{-1}(O(y))$ is an open neighborhood of $x$ contained in $U$. This shows that $O(y)\subset \pi^{-1}(\pi(U))$, which implies, since $y$ was arbitrary in $\pi^{-1}(\pi(U))$, that the set $\pi^{-1}(\pi(U))$  is open in $X$.
\qed \end{proof}

\begin{proposition}[{\bf Countable neighborhood basis}]\index{P- Countable neighborhood basis}
Let $X$ be an ep-groupoid and let $\abs{X}$ be equipped with the quotient topology ${\mathcal T}$. Then every point $z\in \abs{X}$
has a countable basis of open neighborhoods $(V_k)$, which can be chosen  in a monotone way, 
$$
z\in V_k\subset V_{k-1}\subset \ldots \subset V_1 \quad \text{for all $k$.}
$$
\end{proposition}
\begin{proof}
For  $z\in \abs{X}$ we choose  $x\in X$ satisfying  $\pi(x)=z$. Since $X$ is metrizable, in view of 
Theorem \ref{X_m_paracompact}   we can fix a metric
and take the monotone sequence $U_k=B^X_{1/k}(x)$ of open balls. Then the monotone sequence $V_k=\pi(U_k)$ of open neighborhoods is the desired countable neighborhood basis of $z$.
\qed \end{proof}

\begin{proposition}[{\bf Local closure relation}]\label{Prop7.1.9}\index{P- Local closure relation}
Let $X$ be an ep-groupoid. Then for every $z\in \abs{X}$ and every representative $x\in X$ of $z$ there exists an open neighborhood
$U$ of $x$ in $X$ such  that for every subset $A\subset U$ the equality
$$
\pi(\cl_X(A))= \cl_{\abs{X}}(\pi(A))
$$
holds.
\end{proposition}
\begin{proof}
We take an open neighborhood $U$ of $x$ representing $z$ so that $\pi(x)=z$,  which has the property that the map
 $t\colon  s^{-1}(\cl_X(U))\rightarrow X$ is proper.
If $A$ is  a subset of $U$, then $\cl_X(A)\subset \cl_X(U)$ and obviously $\pi(\cl_X(A))\subset \cl_{|X|}(\pi(A))$. To verify  the reversed inclusion we let  $z'\in \cl_{|X|}(\pi(A))$. In this case every open neighborhood of $z'$ intersects $\pi(A)$
and we  have to show that $z'\in \pi(\cl_X(A))$. We choose  a representative $y\in X$ for $z'$ and take a monotone countable neighborhood basis $(V_k)$ for $z'$ constructed from such a basis $(O_k)$ for $y$, i.e. $V_k=\pi(O_k)$. By assumption,  we find  sequences
$(x_k)\subset A$ and $(y_k)\subset X$, $y_k\in  O_k$,  so that there exists a sequence  $(\phi_k)\subset \bm{X}$ satisfying $s(\phi_k)=x_k$ and $t(\phi_k)=y_k$. Clearly, 
$$
t(\phi_k)=y_k\rightarrow y\quad  \text{in $X$}.
$$
Using that $A\subset U$, the properness assumption implies,  after perhaps taking a subsequence,   the convergence 
$\phi_k\rightarrow \phi$ in $\bm{X}$. Hence $x_k=s(\phi_k)\rightarrow s(\phi)=:a'\in\cl_X(A)$ and $y_k=t(\phi_k)\rightarrow t(\phi)$.
Since $y_k\rightarrow y$,  we conclude  that $\phi\colon a'\rightarrow y$,  proving that $z'=\pi(y)=\pi(a')\in \pi(\cl_X(A))$. This completes the proof.
\qed \end{proof}




 We should point out that we refer to the ``arrows'' $\phi\colon x\rightarrow y$
usually as to morphisms, but note that by the invertibility assumption they are all isomorphisms. If we want to stress the latter we call the arrow $\phi$  the {\bf isomorphism} $\phi$  between $x$ and $y$.


\begin{lemma}\label{finite_x}
Assume that $x, x'\in X$ and that $U(x')$ is an open neighborhood of $x'$ such that the map $t\colon s^{-1}(\cl_X (U(x'))\to \bx$ is proper. Then there exist only finitely many morphisms  $\psi$ satisfying $s(\psi )=x$ and $t(\psi)\in U(x')$.
\end{lemma}
\begin{proof}
Arguing by contradiction there exists an infinite sequence of distinct morphisms $\psi_n : s(\psi_n)\to x$ where $s(\psi_n)\in U(x').$
The properness of the map 
$$
t: s^{-1}(\cl_X (U(x'))\to \bx
$$
implies  the convergence of a subsequence  of $(\psi_n)$ to the morphism 
$\psi : s(\psi)\to x$ where $s(\psi)\in s^{-1}(\cl_X (U(x'))$. The target map $t$ is a local sc-diffeomorphism and therefore we find open neighborhoods $V(x)$ and $\bm{V}(\psi)$ such that $t: \bm{V}(\psi)\to V(y)$ is a sc-diffeomorphism. Consequently, for large $n$ and $m\neq n$, $\psi_n$ and $\psi_m\in \bm{V}(\psi)$ and $t(\psi_n)=t(\psi_m)=x$ imply that $\psi_n=\psi_m$. This contradicts the assumption $\psi_n\neq \psi_m$ if $n\neq m$ and proves the lemma.
\qed \end{proof} 
As a consequence we have the following proposition.


\begin{proposition}[{\bf Finiteness of Isotropy Group}]\index{P- Finiteness of $G_x$}
Let $X$ be an ep-groupoid and $x$ an object in $X$. Then the isotropy group $G_x$ is finite.
\qed 
\end{proposition}

If $x$ and $y$ are isomorphic the associated isotropy groups are isomorphic as well.  In general,  there is no canonical identification of $G_x$ 
with  $G_y$. Any identification depends on an initial choice of isomorphism $\phi\colon x\rightarrow y$ and is given by
$$
G_x\rightarrow G_y,\quad  g\mapsto \phi\circ g\circ \phi^{-1}.
$$
A basic result  from  \cite{HWZ3.5}, Theorem 2.3, describes the following local structure of an ep-groupoid.
\begin{theorem}[{\bf Natural representation of $G_x$}] \label{x-local-x}\index{T- Basic structure of ep-groupoids}
Let $X$ be an ep-groupoid and $x$ an object with the isotropy  group $G=G_x$.  Then for every open neighborhood $V$ of $x$ we find an open neighborhood $U\subset V$ of $x$,  a group homomorphism $\Phi\colon G\rightarrow \text{Diff}_{\textrm{sc}}(U)$, $g\mapsto  \Phi (g)$,  and a sc-smooth map
$\Gamma\colon G\times U\rightarrow \bm{X}$\index{$\Gamma$} such that the following holds.
\begin{itemize}
\item[{\em (1)}]\ $\Gamma(g,x)=g$.
\item[{\em (2)}]\ $s(\Gamma(g,y))=y$ and $t(\Gamma(g,y))=\Phi (g)(y)$ for all $y\in U$ and $g\in G$.
\item[{\em (3)}]\ If $h\colon y\rightarrow z$ is a morphism between points in $U$, then there exists a unique element $g\in G$ satisfying $\Gamma(g,y)=h$, i.e., 
$$
\Gamma\colon G\times U\rightarrow \{\phi\in \bm{X}\, \vert \,  \text{$s(\phi)$ and $t(\phi)\in U$}\}
$$
is a bijection.
\end{itemize}
\qed
\end{theorem}
We shall refer to $(\Phi,\Gamma)$ as the data for the {\bf natural representation}\index{Natural representation} of $G_x$.
The proof  is a  slight modification of the proof in \cite{HWZ3.5} and will be given for the convenience of the reader in Appendix \ref{k-natural}.

In the following we shall often abbreviate the group action of the isotropy group $G=G_{x}$ on $U$ by 
$$g\ast y=\Phi (g)(y)\quad \text{if $g\in G$ and $y\in U$}.
$$
We now discuss informally some of the consequences of Theorem \ref{x-local-x}. To fill in the details the reader might consult the proof in  Appendix \ref{k-natural}. If $x\in X$, and if $U(x)=U\subset X$ is the open neighborhood 
of $x$ guaranteed by  Theorem \ref{x-local-x}, we introduce 
the set of morphisms
$$
\bm{U}(x)=\{\phi\in \bm{X}\, \vert \, \text{$s(\phi)$ and $t(\phi)\in U(x)$}\}.\index{$\bm{U}(x)$} 
$$
The pair  $(U(x),\bm{U}(x))$ is the full subcategory of $(X, \bm{X})$ associated  with $U(x)$. By the properness property of an ep-groupoid we can choose $U(x)$ so small that $\bm{U}(x)$  fits into an arbitrarily small open neighborhood of the finite group $G_x\subset \bm{X}$. 
Using that $s$ is a local sc-diffeomorphism, we choose the connected open neighborhood $U(x)\subset X$ so small that $\bm{U}(x)$ splits into $\# G_x$-many (disjoint) connected components
enumerated  by the group elements  $g\in G_x$ so that 
$$
\bm{U}(x)=\sqcup_{g\in G_x} \bm{U}(g)\index{$\bm{U}(g)$}
$$
and, moreover, the source and target maps 
$$
s,t\colon \bm{U}(g)\rightarrow U(x)
$$ 
are sc-diffeomorphisms.  We introduce the category 
$$
G_x\ltimes U(x):=(U(x), G_x\times U(x)),
$$
called the {\bf translation groupoid}\index{Translation groupoid} associated with $x$ and $U(x)$, 
and defined as follows. We abbreviate
$$U=U(x)\quad \text{and}\quad G=G_x.$$
The object set of the category $G\ltimes U=(U, G\times U)$ \index{$G\ltimes U$}  consists of the points in $U$, and the morphism set consists of the pairs $(g, y)\in G\times U$.  The space $G\times U$ has a natural M-polyfold structure as the finite disjoint  union of copies of the M-polyfold $U$.
The source and the target maps $s, t\colon G\times U\to U$ are defined as 
$$
s(g,y)=y\quad \text{and}\quad t(g,y)=\Phi (g)(y).
$$
The composition of the morphisms 
$(g,y)$ and $(h,z)\in G\times U$ satisfying $y=s(g,y)=t(h,z)=\Phi (h)(y)$  is defined by 
$$
(g,y)\circ (h,z)=(g\circ h,z)\in G\times U.
$$
Using the proof of Theorem \ref{x-local-x} one verifies that the category $G\ltimes U$ is an ep-groupoid. The natural functor 
$$
\bm{\Gamma}\colon G\ltimes U=(U, G\times U)\rightarrow  (X, \bm{X})
$$
between the two categories  maps, on object level,  $y\in U$ to $y\in X$ and, on the morphism level, the  morphism $(g,y)\in G\times U$ into the unique morphism   $\Gamma(g,y)\in \bm{X}$.  By 
property (3) of Theorem \ref{x-local-x}  the functor $\Gamma$ is {\bf full}\index{Full functor} and {\bf faithful}\index{Faithful functor} (fully faithful). 
{\bf Full} requires, that for two objects
$y$ and $z$ in $G\ltimes U$,  the functor $\bm{\Gamma}$ induces a surjection between the morphisms sets of morphisms $y\to z$,
$$
\text{mor}_{G\ltimes U}(y,z)\rightarrow \text{mor}_X(y,z).
$$
{\bf Faithful} means that these maps are injective. 
 The image of the functor $\bm{\Gamma}$ is the full subcategory $(U(x), \bm{U}(x))$ of 
 $(X,\bm{X})$. Hence $\bm{\Gamma}$ identifies the translation groupoid $G_x\ltimes U(x)$ with the category 
$(U(x),\bm{U}(x))$.




Fixing  $x\in X$, we choose as before a sufficiently small connected open neighborhood $U(x)$ in which we have the natural $G_x$-action $\Phi$, and the associated set $\bm{U}(x)$ of morphisms, which is the disjoint union of the connected open neighborhoods 
$\bm{U}(g)\subset \bm{X}$ for  $g\in G_x$. 
By property (3) of  Theorem \ref{x-local-x}, for a given morphism $\phi\in \bm{U}(x)$ there exists a unique $h\in G_x$ satisfying $\phi\in \bm{U}(h)$, and
$$
\phi=\Gamma (h, s(\phi))\quad \text{and}\quad t(\phi)=\Phi (h)(s(\phi)).
$$
Abbreviating  the group action of $G_x$ by 
$$
g\ast z:=\Phi (g)(z),\quad g\in G_x, z\in U(x),
$$
we define the map 
$$
\wh{\Phi}\colon G_x\to \text{Diff}_{\textrm{sc}}(\bm{U}(x))
$$
by 
$$
\wh{\Phi}(g)(\phi )=\Gamma \bigl(g\circ h\circ g^{-1},g\ast (s(\phi))\bigr)\in \bm{U}(g\circ h\circ g^{-1})
$$
if $\phi \in \bm{U}(h)$.  By property (2) of Theorem \ref{x-local-x}, 
$s(\wh{\Phi}(g)(\phi ))=g\ast s(\phi)$ and 
$$
t(\wh{\Phi}(g)(\phi ))=(g\circ h\circ g^{-1})\ast (g\ast s(\phi))=g\ast (h\ast(s(\phi)))=g\ast t(\phi).
$$
If $g'\in G_x$, we compute
\begin{equation*}
\begin{split}
\wh{\Phi}(g')\bigl(\wh{\Phi}(g)(\phi)\bigr)
&=\wh{\Phi}(g')(\Gamma (g\circ h\circ g^{-1},g\ast 
s(\phi)))\\
&=\Gamma \bigl(g'\circ (g\circ h\circ g^{-1})\circ (g')^{-1}, g'\ast(g\ast s(\phi)) \bigr)\\
&=\wh{\Phi}(g'\circ g)(\phi).
\end{split}
\end{equation*}

For $1_x\in G_x$ we obtain $\wh{\Phi}(1_x)(\phi)=\phi$
for all $\phi \in \bm{U}(x)$.   Therefore, the map $\wh{\Phi}\colon G_x\to \text{Diff}_{\textrm{sc}}(\bm{U}(x))$ 
is a group homomorphism satisfying 
$$\wh{\Phi}(g)(\bm{U}(h))=\bm{U}(g\circ h\circ g^{-1})$$ 
for all $g,h\in G_x$. Moreover, 
$$
s(\wh{\Phi}(g)(\phi))=\Phi (g)(s(\phi))\ \ \text{and}\ \ t(\wh{\Phi}(g)(\phi))= \Phi (g)(t(\phi)).
$$

To sum up the discussion, we can choose a small connected neighborhood $U(x)\subset X$ such that $\bm{U}(x)$  is the disjoint union of the connected open subsets
$\bm{U}(g)\subset \bm{X}$ for  $g\in G_x$,   and for $g,h\in G_x$ the sc-diffeomorphism
$\wh{\Phi}(g):\bm{U}(x)\rightarrow \bm{U}(x)$ induces the commutative diagrams
of sc-diffeomorphisms 
$$
\begin{array}{cc}
\begin{CD}
\bm{U}(h) @> s >> U(x)\\
@ V\wh{\Phi}(g)|\bm{U}(h) VV    @V \Phi(g) VV\\
\bm{U}(g\circ h\circ g^{-1}) @> s>> U(x)
\end{CD}
&\ \ \ \ \ \ 
\begin{CD}
\bm{U}(h) @> t >> U(x)\\
@ V\wh{\Phi}(g)|\bm{U}(h) VV    @V \Phi(g) VV\\
\bm{U}(g\circ h\circ g^{-1}) @> t>> U(x)
\end{CD}
\end{array}
$$
The following proposition extends the theorem about natural actions of isotropy groups.

\begin{proposition}\label{delaney}\index{P- Natural representation of $Y$}
 Let $(X, \bm{X})$ be an ep-groupoid and $Y=\{y_1, \ldots ,y_k\}$ a finite set of distinct objects in $X$ which are mutually isomorphic. 
 Denote by $Y=(Y, \bm{Y})$ the full subcategory associated with $Y$ whose  morphism set is $\bm{Y}$.  Then,  given a neighborhood $V$
 of $Y$ in $X$,  there exists a functor $f$, which associates with  the objects $y$ in $Y$  mutually disjoint connected open neighborhoods $U(y)$ contained in $V$, and with  a morphism $\psi\colon y\rightarrow y'$ in $\bm{Y}$  a sc-diffeomorphism
 $f (\psi)\colon U(y)\rightarrow U(y')$. The set of morphisms  $\bm{U}=\{\phi\in \bm{X}\, \vert \,  \text{$s(\phi)$ and $t(\phi)\in \bigcup_{y\in Y} U(y)$}\}$
decomposes into union of connected  components $\bm{U}(\psi)$, $\psi\in \bm{Y}$, and the following holds true.
 \begin{itemize}
 \item[{\em (1)}]\ The isotropy group $G_y$ for $y\in Y$ acts via the natural action on $U(y)$.
 \item[{\em (2)}]\ For $\psi\in \bm{Y}$ the maps $s:\bm{U}(\psi)\rightarrow U(y)$ and $t:\bm{U}(\psi)\rightarrow U(y)$ are sc-diffeo\-mor\-phisms.
 \item[{\em (3)}]\ If  $\psi\colon y\rightarrow y'$ and  $z\in U(y)$, then  
 $$
f(\psi) (z) =t\circ (s|\bm{U}(\psi))^{-1}(z).
 $$
 \end{itemize}
 \end{proposition}
 \begin{proof}
 We prove the result by induction on the number of objects  of the set $Y$. We begin with the case $Y=\{y_1\}$. Morphisms $y_1\to y_1$ are elements of the isotropy group $G_{y_1}$. Taking a $G_{y_1}$-invariant open connected neighborhood $U(y_1)$ of $y_1$ contained in $V$, every morphism $\phi\in \bm{U} (y_1, y_1)$ is of the form $\phi=\Gamma( g, s(\phi))$ for a unique $g\in G_x$. The sets $\bm{U} (g):=\{\varphi =\Gamma (g, z)\, \vert \, z\in U(y_1)\}$ are mutually disjoint  connected open neighborhoods of $g$ and 
 $$
\bm{U}=\bm{U}(y_1)= \bm{U} (y_1, y_1)=\bigcup_{g\in G_{y_1}}\bm{U} (g).
 $$
Moreover, the source and target maps 
$$
s, t: \bm{U} (g)\to U(y_1)
$$
 are sc-diffeomorphims for every $g\in G_{y_1}$.   This is an immediate consequence of Theorem \ref{x-local-x}.
 
Considering  the case of $Y=\{y_1, y_2\}$, we fix  a morphism  $\gamma_{1}: y_1\to y_2$. We take open neighborhoods $U'(y_1)$ and $U'(y_2)$, both contained in $V$ and invariant with respect to the actions of the isotropy groups $G_{y_1}$ and $G_{y_2}$. Using that the source and target maps $s, t$ are local sc-diffeomorphisms, we find a $G_{y_1}$-invariant open neighborhood $V(y_1)\subset U'(y_1)$,  and open neighborhood $V(y_2)\subset  U'(y_2)$, and an open neighborhood $\bm{V}(\gamma_1)$ such that $s: \bm{V}(\gamma_1)\to V(y_1)$ and $t: \bm{V}(\gamma_1)\to V(y_2)$ are sc-diffeomorphisms. Hence  the  composition $\wh{\gamma}_1=t\circ (s\vert \bm{V}(\gamma_1))^{-1}: V(y_1)\to V(y_2)$ 
is also  a sc-diffeomorphism.  Choosing a $G_{y_2}$-invariant open neighborhood 
$W(y_2)$ contained in $V(y_2)$, we find a $G_{y_1}$-invariant connected open neighborhood $U(y_1)$ contained in $V(y_1)$ such that $\wh{\gamma_1}(U(y_1))\subset W(y_2)$.  Denoting  $U(y_2)=\wh{\gamma_1}(U(y_1))$, we claim that $U(y_2)$ is a $G_{y_2}$-invariant neighborhood of $y_2$.  To see this, let $z\in U(y_2)$ and $z'=g\ast z$ where $g\in G_{y_2}$. 
Then $z'\in W(y_2)$ and,  by means of sc-diffeomorphism $\wh{\gamma}_1$, we find points $u\in U(y_1)$, $u'\in V(y_1)$,  and morphisms
$\phi: u\to z$ and $\phi: u'\to z'$. This implies that there is a morphism $u\to u'$ of the form $\Gamma (g', u)$ for some $g'\in G_{y_1}$.
Since $U(y_1)$ is $G_{y_1}$-invariant and $u\in U(y_1)$,  we conclude that $u'\in U(y_1)$, so that   $z'=\wh{\gamma}_1(u')\in U(y_2)$. This shows that $U(y_2)$ is $G_{y_2}$-invariant. It is also  which implies that $z'\in U(y_2)$ since $\wh{\gamma}_1$ maps $U(y_1)$ onto $U(y_2)$.
The source and target maps $s: \bm{U} (\gamma_1)\to U(y_1)$ and $t: \bm{U} (\gamma_1)\to U(y_2)$ are sc-diffeomorphisms, and hence $\wh{\gamma}_1=t\circ (s\vert \bm{U} (\gamma_1))^{-1}: U(y_1)\to U(y_2)$ is also a sc-diffeomorphism. 
   
Any other morphism from $y_1\to y_2$ is of the form $\gamma_g=g\circ \gamma_1$ for some  $g\in G_{y_2}$.  Fixing $g\in G_{y_1}$, we consider the map   $\Phi_g: \bm{U} (\gamma_1)\to \bx$, defined by
$$\Phi_g(\phi)=\Gamma (g, t(\phi))\circ \phi.$$
Then  $\Phi_g$ maps  $\gamma_1$ onto $\gamma_g$ and is a  sc-diffeomorphism onto its image $\bm{U} (\gamma_g):=\Psi_g(\bm{U} (\gamma_1))$.  The images  $\bm{U} (\psi_g)$ are connected and pairwise disjoint neighborhoods of $\gamma_g$
since for any $\phi$ morphism satisfying $s(\phi)\in U(y_1)$ and $t(\phi)\in U(y_2)$, there $\phi=\Gamma (g, s(\phi))\circ \psi$ for uniquely determined  $g\in G_{y_2}$ and $\psi\in \bm{U} (\gamma_1)$. Therefore, the set of morphisms $\bm{U} (y_1, y_2)$ is the union of connected components $\bm{U} (\gamma_g)$ for all $g\in G_{y_2}$.  Also  the source and target maps $s: \bm{U} (\gamma_g)\to U(y_1)$ and $t: \bm{U} (\gamma_g)\to U(y_2)$ are sc-diffeomorhisms.


If $\phi: y_2\to y_1$, then the morphism $\phi^{-1}: y_1\to y_2$ is one of the morphisms $\gamma_g$ for some $g\in G_{y_2}$. Then we define 
$\bm{U} (\phi)=i(\bm{U} (\phi^{-1})),$ where $i:\bx \to \bx$ is the inverse map $i(\phi)=\phi^{-1}$. The source and target maps $s: \bm{U} (\phi)\to U(y_2)$ and $t: \bm{U} (\phi)\to U(y_1)$ are given by 
$$s\vert  \bm{U} (U(\phi))=(t\vert \bm{U} (\phi^{-1}))\circ i\quad \text{and}\quad 
t\vert  \bm{U}(\phi)\bm{U}=(s\vert \bm{U} (\phi^{-1}))\circ i,$$
and so they are sc-diffeomorphisms. This finishes the case of $Y=\{y_1,y_2\}$. 

Let $k\geq 3$ and assume that the statement holds for any set $Y'$ of $k$ distinct objects which are mutually isomorphic. Considering  the set $Y=\{y_1,\ldots, y_{k+1}\}$ of  distinct mutually isomorphic points  $y_i$,  let $V$ be an open neighborhood of $Y$. Let  $Y'=\{y_1,\ldots, y_k\}$ and $\bm{Y}'$ be the set of all morphisms between points in $Y$.  By assumption,  every point $y_i\in Y'$ possesses  a $G_{y_i}$-invariant connected and open neighborhood $U'(y_i)$ contained in $V$ and every morphism $\phi: y_i\to y_j$ possesses  a connected open neighborhood $\bm{U}' (\phi)$ for which the source and target maps  $s: \bm{U}' (\phi)\to U'(y_i)$ and $t: \bm{U}' (\phi)\to U'(y_j)$ are sc-diffeomorphisms. The composition 
$\wh{\gamma}_j: U'(y_i)\to U'(y_j)$ is a sc-diffeomorphism and 
the set of morphisms from $\bigcup_{y\in Y'}U(y)$ and $\bigcup_{y'\in Y'}U'(y')$ is the union of connected components $\bm{U}' (\phi)$ for all  $\phi\in \bm{Y}'$. 

We fix a $G_{y_{k+1}}$-invariant neighborhood $U'(y_{k+1})$ of $y_{k+1}$ contained in $V$ and for every $1\leq j\leq k$ a morphism $\delta_j: y_{k+1}\to  y_j$.  Similarly as in the case $k=2$, we find a $G_{y_{k+1}}$-invariant connected open neighborhood $U(y_{k+1})\subset U'(y_{k+1})$, $G_{y_j}$-invariant connected open neighborhoods $U(y_j)\subset U'(y_j)$, and connected open neighborhoods $\bm{U} (\delta_j)$ such that 
$s: \bm{U} (\delta_j)\to U(y_{k+1})$, $y: \bm{U} (\delta_j)\to U(y_{j})$, and 
$\wh{\delta}_j: U(y_{k+1})\to U(y_j)$ are sc-diffeomorphisms.

Now, as in the case $k=1$, one constructs neighborhoods $\bm{U} (\phi)$ for all other morphisms $\phi$  satisfying $s(\phi)=y_{k+1}$ and $t(\phi)\in Y'$ as well as their inverses. 

Still we have to adjust neighborhoods $\bm{U} '(\phi)$ for morphisms $\phi: y_i\to y_j$ for $i, j\leq k$.  By assumption,  if $\gamma: y_i\to y_j$, then there are neighborhoods $U'(y_i)$, $U'(y_j)$, and  $\bm{U}' (\gamma)$ such that 
$s: \bm{U} '(\phi)\to U'(y_i)$, $t: \bm{U} '(\phi)\to U'(y_j)$, and
$\wh{\gamma}=t\circ (s\vert \bm{U}' (\gamma))^{-1}: U'(y_i)\to U'(y_j)$  are  sc-diffeomorphisms. 

We define $\bm{U} (\gamma):=(s\vert \bm{U}' (\gamma))^{-1}(U(y_i))$ and denote $W(y_j)=t(\bm{U} (\gamma))$. The set $W(y_j)$ is  $G_{y_j}$-invariant and we claim that $W(y_j)=U(y_j)$.  To verify that $U(y_j)\subset W(y_j)$,  we take $z\in U(y_j)$. By means of the sc-diffeomorphisms $\wh{\delta}_i^{-1}: U'(y_i)\to U(y_{k+1})$ and $\wh{\delta}_j: U(y_{k+1})\to U(y_j)$ we find a point $u\in U(y_i)$ and morphisms $\phi\in \bm{U} (\delta_i^{-1})$, $\phi'\in \bm{U} (\delta_j)$ such that 
$\phi'\circ \phi: u\to z$. By means of the sc-diffeomorphism $\wh{\gamma}: U'(y_i)\to U(y_j)$, we find a morphism $\psi: u\to z'$ where $z'=t(\psi)\in W(y_j)$ since $u\in U(y_i).$  Hence there is a morphism  $z'\to z$  which, because $U'(y_j)$ is $G_{y_j}$-invariant, is of the form  
$\Gamma (g, z'): z'\to z$ for some $g\in G_{y_i}$. But $z'\in W(y_j)$ and $W(y_j)$ is $G_{y_j}$-invariant, and we conclude that $z\in W(y_j)$, as claimed. Similar arguments show that $W(y_j)\subset U(y_j)$, and we have proved that $t(\bm{U} (\gamma))=U(y_j)$ for every $1\leq j\leq k$.

The constructed neighborhoods $U(y)$,  for $y\in Y$, and the neighborhoods $\bm{U} (\phi)$ of morphisms between points in $Y$, and the associated source and target maps have the desired properties. This concludes the proof of the inductive step and the proof of the proposition.
\qed \end{proof}

\begin{definition}\index{D- Natural representation of $Y$}
Let $X$ be an ep-groupoid and $Y$ the full subcategory associated with  a finite set of isomorphic objects.
A functor $f$ as constructed in Proposition \ref{delaney} with its stated properties is called 
 the {\bf natural representation of $Y$}  on neighborhoods contained in $V$ or,  alternatively,  on a small neighborhood of $Y$.
 \qed
 \end{definition}
 


\begin{proposition}\label{go-go}\index{P- Existence of local uniformizers}
Let $X$ be an ep-groupoid and $z\in \abs{X}$. We fix  $x\in X$  satisfying  $z=\abs{x}$ and denote the isotropy group of $x$ by $G_x$ and 
take an open neighborhood $U(x)$ of $x$ on which we have the natural $G_x$-action $\Phi$, which we abbreviate as $g\ast y:=\Phi (g)(y)$ for $g\in G_x$ and $y\in U(x)$.
Then
the map $\tau:{_{G_x}\backslash} U(x)\rightarrow \abs{U(x)}=\pi (U(x)),\, G_x\ast y\rightarrow \abs{y}$ is a homeomorphism. In  other words,  the obvious functor
$$
G_x\ltimes U(x)\rightarrow X,
$$
which,  on the object level,  is the inclusion map and,  on the morphism level,  the map
$$
(g,y)\rightarrow \Gamma(g,y),
$$
is a fully faithful functor, which on the orbit spaces defines a homeomorphism between the orbit spaces $|U(x)|_{G_x\ltimes U(x)}={_{G_x}\backslash} U(x)$
and $|U(x)|=\pi(U(x))$.
\end{proposition}
\begin{proof}
Fixing a point $x\in X$, we take an open neighborhood  $U(x)$ of $x$ as guaranteed by Theorem \ref{x-local-x}\  
 and equip ${_{G_x}\backslash} U(x)$ with the quotient topology.
Then the map 
\begin{equation}\label{rok}
\tau:{_{G_x}\backslash} U(x)\rightarrow |U(x)|,\quad G_x\ast y\rightarrow \abs{y}
\end{equation}
is well-defined and  surjective by construction. It is also injective. Indeed, if  $\abs{y}=\abs{y'}$ for $y,y'\in U(x)$, then there exists a morphism $\phi:y\rightarrow y'$ in $\bm{X}$.
By point (3) of Theorem \ref{x-local-x} there exists $g\in G_x$ satisfying $\Gamma(g,y)=\phi$ and  $s(\phi)=y$ and,  moreover,  
$$
y'=t(\phi)=t(\Gamma(g,y))=\Phi (g)(y)=g\ast y.
$$
Hence $y'\in G_x\ast y$ and  our map $\tau$ is a bijection.

 The target $|U(x)|$ is open in $|X|$ by  Proposition \ref{q-open}.
The map 
$$
\pi\vert U(x)\colon U(x)\rightarrow |U(x)|
$$
 is continuous and the preimage of a point $\pi (y)$ is precisely the orbit $G_x\ast y$. Denoting the quotient map
$U(x)\rightarrow {_{G_x}\backslash} U(x)$ by $\sigma$,  we have the relationship
$$
\tau\circ\sigma=\pi\vert U(x).
$$
We note that $\sigma$ is open and continuous. Continuity is implied by the definition of the quotient topology
and the openness follows since $G_x$ acts by sc-diffeomorphisms.  If $O\subset |U(x)|$ is open we find that
$(\pi|U(x))^{-1}(O)= \sigma^{-1}(\tau^{-1}(O))$ is open, which,  by the definition of the quotient topology on 
${_{G_x}\backslash} U(x)$,  precisely means that $\tau^{-1}(O)$ is open. Hence $\tau$ is continuous.
If $Q\subset {_{G_x}\backslash} U(x)$ is open, then by definition,  $\sigma^{-1}(Q)$ is open. 
From 
$$
(\pi\vert U(x))^{-1}(\tau(Q))=\sigma^{-1}(Q)
$$
we conclude,  by definition of the quotient topology on $|X|$,  that $\tau(Q)$ is open. In summary $\tau$ is a homeomorphism.
 This completes the proof of Proposition \ref{go-go}.
\qed \end{proof}
\begin{definition}[{\bf Local uniformizer}]\index{D- Local uniformizer}
Let $X$ be an ep-groupoid and $x$ an object in $X$. A {\bf local uniformizer around $x$} is a  fully faithful
embedding
$$
\Psi_x\co G_x\ltimes U(x)\rightarrow X,
$$
where $U(x)$ is an open neighborhood of $x$ equipped with the natural $G_x$-action, such that $\Psi_x$ induces a homeomorphism
between $|U(x)|_{G_x\ltimes U(x)}$ and  the  open neighborhood $\abs{U(x)}=\pi (U(x))$ of $\pi(x)$ in $\abs{X}$.
\qed
\end{definition}
There exists a local uniformizer around every object $x$ as  Proposition \ref{go-go} shows. We also note that a 
a local uniformizer is injective on objects as well as morphisms.
Next we introduce the notion of an ep-subgroupoid. 
\begin{definition}\label{Xep-subgroupoid}
Let $X$ be an ep-groupoid. An {\bf ep-subgroupoid}\index{D- Ep-subgroupoid} $A$ of $X$ consists of the full subcategory associated
with  a subset $A$ of $X$ which has the following properties.
\begin{itemize}
\item[(1)]\ $A$  is a sub-M-polyfold of the object space $X$.
\item[(2)]\ $A$ is saturated, i.e. $\pi^{-1}(\pi(A))=A$.
\end{itemize}
\qed
\end{definition}
Let us show that the full-subcategory $A$ has in a natural way the structure of an ep-groupoid.
From the definition it follows, as proved in Proposition \ref{sc_structure_sub_M_polyfold}, that the object set $A$ has an induced M-polyfold structure 
for which the following holds.
\begin{itemize}
\item[(1)]\ The inclusion map $i:A\rightarrow X$ is sc-smooth and a homeomorphism onto its image. 
\item[(2)]\ For every $a\in A$ and every sc-smooth retraction $r\colon V\rightarrow V$ of an open neighborhood $V$ of $a$ in $X$ satisfying 
$r(V)=A\cap V$,  the map $i^{-1}\circ r:V\rightarrow A$ is sc-smooth.
\item[(3)]\ At a  smooth point $a\in A$ the tangent space $T_aA$ has a sc-complement in $T_aX$.
\item[(4)]\ If $W\subset X$ is open and  equipped with a sc-smooth retraction 
$r:W\rightarrow W$ satisfying $r(W)=A\cap W$, then the induced map $r:W\rightarrow A$ is sc-smooth (see (2)). Moreover, 
at a smooth point $a\in A$ the tangent space $T_aA$  is equal to $(Tr)(a)T_aX$.
\end{itemize}
In a next step we shall show that the set of morphisms 
$$
\bm{A}=\{\phi\in \bm{X}\, \vert \, \text{$s(\phi)$ and $t(\phi)\in A$}\}
$$
 has in  a natural way the structure of a M-polyfold.
Choosing  $\phi\in \bm{A}$, we find open neighborhoods $\bm{U}(\phi)\subset \bm{X}$ and $U(a)\subset X$, where $a=s(\phi)$, such that
$s\colon \bm{U}(\phi)\rightarrow U(a)$ is a sc-diffeomorphism. By taking a possibly smaller neighborhood $U(a)$ and adjusting $\bm{U}(\phi)$, we may assume that
we have a sc-smooth retraction $r: U(a)\rightarrow U(a)$ satisfying  $r(U(a))=U(a)\cap A$.  We  introduce  the sc-smooth retraction
$$
\bm{r}\colon \bm{U}(\phi)\rightarrow \bm{U}(\phi), \quad \bm{r}(\psi)=(s\vert \bm{U}(\phi))^{-1}\circ r \circ s(\psi).
$$
By construction $s(\bm{r}(\psi))= r(s(\psi))\in A$ and $t(\bm{r}(\psi))\in U(a)$, so that
$\bm{r}(\psi)\in \bm{U}(a)$.
Moreover, since $A$ is saturated we infer also that $\bm{r}(\psi)\in \bm{A}$, implying
$$
\bm{r}(\bm{U}(\phi))=\bm{U}(\phi)\cap\bm{A}.
$$
This shows that $\bm{A}$ is a sub-M-polyfold of $\bm{X}$ and the properties for $A$ listed above  also hold for $\bm{A}$.
From the construction of the sub-M-polyfold structures on $A$ and $\bm{A}$ it follows that the maps $s,t: \bm{A}\rightarrow A$ are sc-smooth.
 Moreover, if  $\phi\in A$ and $a=s(\phi)$, the sc-diffeomorphism $s: \bm{U}(\phi)\rightarrow U(a)$ between open subsets 
of $\bm{X}$ and $X$, respectively, maps the intersection $ \bm{U}(\phi)\cap \bm{A}$ bijectively onto $U(a)\cap A$. This shows that the source map $s: \bm{A}\rightarrow A$ is a  local sc-diffeomorphisms. The same holds for the target map $t$. The unit map, the inversion map, and the multiplication map are restrictions of sc-smooth maps
and therefore sc-smooth. The properness assumption also holds true. Indeed, if $a\in A$, we take an open neighborhood $U(a)$ in $X$ equipped with the natural $G_a$-action, such  that
$t: s^{-1}(\cl_X(U(a)))\rightarrow X$ is proper. Let us show that the open neighborhood $U(a)\cap A$ of $a$ in $A$ has the desired properties. Since $A$ is saturated, 
the set $U(a)\cap A$ is invariant under $G_a$-action.  In order to verify that  the map 
$$
t: s^{-1}(\cl_A(U(a)\cap A))\rightarrow A
$$
is proper we take a  sequence $(\phi_k)\subset \bm{A}$ satisfying $t(\phi_k)\rightarrow c$ in $A$ and $s(\phi_k)\in \cl_A(U(a)\cap A)$.  Then  $s(\phi_k)\in \cl_X(U(a))$ and hence we may assume, without loss of generality, the convergence  $\phi_k\rightarrow \phi$ in $\bm{X}$. It follows that  $t(\phi)=c$ and $s(\phi)\in \cl_X(U(a))$.
Since $A$ is saturated, we conclude from $t(\phi)\in A$ that also $s(\phi)\in A$. In particular,  $\phi_k\rightarrow \phi$ in $\bm{A}$. From  $s(\phi_k)\in \cl_A(U(a)\cap A)$ it follows that $s(\phi)\in \cl_A(U(a)\cap A)$.
Summarizing the argument we have proved the following result.
\begin{proposition}\index{P- Ep-subgroupoids}
Let $X$ be an ep-groupoid and $A$ a saturated subset of the object space $X$ such  that $A$ is also a sub-M-polyfold. Then the full subcategory associated with  $A$,  also denoted by
$A$,  has in a natural way the structure of an ep-groupoid.
In particular,  $A$ and $\bm{A}=\{\phi\in \bm{X}\ |\ s(\phi),t(\phi)\in A\}$ are sub-M-polyfolds of $X$ and $\bm{X}$, respectively and all the structure maps are the restrictions
of the structure maps of $X$ and $\bm{X}$, respectively.
\qed
\end{proposition}



\section{Effective and Reduced Ep-Groupoids}\label{subsec-Effective_Reduced}
In the previous section we have seen that the local morphism structure of an ep-groupoid around an object $x$ is given
by a group homomorphism $G_x\rightarrow\text{Diff}_{\textrm{sc}}(U(x))$.  We can use these local structures
to distinguish a class of ep-groupoids which is useful  for the applications. 
\begin{definition}[{\bf Effective ep-groupoid}]\index{D- Effective ep-groupoid}
An ep-groupoid $X$ is said to be {\bf effective}\index{D- Effective} provided for every $x\in X$ and $g\in G_x\setminus\{1_x\}$, given an open neighborhood 
$\bm{U}(g)\subset \bm{X}$, there exists  a morphism $\psi\in \bm{U}(g)$ satisfying $s(\psi)\neq t(\psi)$. An object $x\in X$ is said to be {\bf regular}\index{D- Regular point} provided $G_{x}=\{1_x\}$.
\qed
\end{definition}
If $\phi\in \bm{X}$ and $s(\phi)$ is a regular object, the same has to be true for $t(\phi)$. \\[1ex]
We define the {\bf regular part}\index{Regular part of an ep-groupoid} $X_{\textrm{reg}}$ of an ep-groupoid as the subset
$$
X_{\textrm{reg}}=\{x\in X\, \vert \, G_x=\{1_x\}\}
$$ 
of the object space $X$.
\begin{lemma}[{\bf Openness of regular set}]\label{ooopen}\index{L- Openness of regular set}
For an ep-groupoid $X$ the regular part $X_{\textrm{reg}} $ is open.
\end{lemma}
\begin{proof}
If  $x\in X_{\text{reg}} $, then $G_x=\{1_x\}$ and we find an open neighborhood $U(x)$ equipped with the natural $G_x$-action $\Phi$. Every morphism $\phi\colon a\rightarrow b$
between  $a,b\in U(x)$ has the form $\phi=\Gamma(1_x,a)$ so that $s(\phi)=a$ and $b=\Phi (1_x)(a)=a$. In particular, there is exactly one morphism
$a\rightarrow a$ and therefore  $\phi=1_a$.  This proves that the isotropy group $G_a$ for every $a\in U(x)$ is equal to $G_a=\{1_a\}$ and therefore $U(x)\subset X_{\textrm{reg}}$.
\qed \end{proof}
Examples show that the regular set can be empty.

\begin{lemma}\label{klsonja}\index{L- Characterization of effectiveness}
For  an ep-groupoid $X$ the following statements are equivalent.
\begin{itemize}
\item[{\em (1)}]\ $X$ is effective.
\item[{\em (2)}]\ For every object $x\in X$ and every open neighborhood $V(x)$  there exists an open neighborhood $U(x)\subset V(x)$ equipped with the natural $G_x$-action such that the 
group homomorphism $\Phi \colon G_x\rightarrow \text{Diff}_{\textrm{sc}}(U(x))$ is injective.
\end{itemize}
\end{lemma}
\begin{proof}
We assume that (1) holds and choose an open neighborhood  $U(x)\subset V(x)$ of $x$ equipped with the natural $G_x$-action  $\Phi$. Every morphism $\phi\in \bm{X}$ satisfying $s(\phi),t(\phi)\in U(x)$ is of the form 
$$
\phi=\Gamma(g,s(\phi))
$$
for a uniquely determined $g\in G_x$, and
$$
t(\phi) =\Phi (g)(s(\phi)).
$$
Arguing by contradiction we  assume that there exists $h\in G_x\setminus\{1_x\}$ for which  $\Phi (h)=\mathbbm{1}$.
Since $X$ is effective,  we find a converging sequence $(\phi_k)\subset \bm{X}$ satisfying  $\phi_k\rightarrow h$ and $s(\phi_k)\neq t(\phi_k)$.
For $k$ large we must have $s(\phi_k),t(\phi_k)\in U(x)$ and hence there exist  uniquely determined elements $(h_k)\subset G_x$ such that 
$$
\phi_k=\Gamma(h_k,s(\phi_k))\quad  \text{and}\quad  t(\phi_k)=\Phi (h_k)(s(\phi_k))\neq s(\phi_k).
$$
Clearly,   $h_k\neq h$, since otherwise $s(\phi_k)=t(\phi_k)$. Since $G_x$ is finite, after perhaps taking a subsequence,  we may assume for all $k$ that
$h_k=g\neq h$. From $\Phi (g)(s(\phi_k))\neq s(\phi_k)$ we deduce that
\begin{equation}\label{nancy}
\Phi (g)\neq \mathbbm{1}.
\end{equation}
Now we can pass to the limit and find, in view of $s(h)=t(h)=x$, that 
$$
h=\Gamma(g,x)\quad  \text{and}\quad \Phi (g)(x)=x.
$$
However, it is one of the properties of $\Gamma$ that $\Gamma(h,x)=h$ for all $h\in G_x$, which implies $h=g$, contradicting $h\neq g$. We have proved that (1) implies (2).


Next we assume that (2) holds. Hence for given $x\in X$ we  find an open neighborhood $U(x)$ equipped with the natural $G_x$-action such  that $\Phi\colon G_x\rightarrow \text{Diff}_{\textrm{sc}}(U(x))$ 
is injective. Assume that $g\in G_x\setminus\{1_x\}$ is given. Then $\Phi (g)$ is not the identity. Hence we find $a\in U(x)$ satisfying 
$\Phi (g)(a)\neq a$ and define the morphism $\phi=\Gamma(g,a)$. By construction,  $s(\phi)=a\neq \Phi (g)(a)=t(\phi)$.
By taking smaller and smaller neighborhoods $U(x)$ and adapting the corresponding restrictions of $\Gamma$,  we find a sequence $(\phi_k)$  satisfying $s(\phi_k)\neq t(\phi_k)$ such that $s(\phi_k),t(\phi_k)\rightarrow x$ and $\phi_k\rightarrow g$.  Hence (1) is verified and the proof of Lemma \ref{klsonja} is complete.
\qed \end{proof}


As the following proposition shows, effective ep-groupoids have an open and dense subset in the object space $X$ consisting of points  whose 
isotropy groups are trivial.
\begin{proposition}\label{prop_density}\index{P- Density result}
If  $X$ is an effective ep-groupoid, then the set $X_{reg}=\{x\in X\, \vert \, G_x=\{1_x\}\}$ is open and dense in $X$.
\end{proposition}
\begin{proof}
In view of Lemma \ref{ooopen} the set $X_{\textrm{reg}}$ is open in $X$.
If $x_0\in X$, we shall show that every  open neighborhood of $x_0$ contains a point with trivial isotropy.
Given an open neighborhood we find a smaller open neighborhood $U(x_0)$ equipped with  the natural action of $G_{x_0}$.
We shall write $g\ast x$ instead of $\Phi (g)(x)$.
 We may assume that $G_{x_0}\neq \{1_{x_0}\}$
since otherwise we are already done. Take a point $x\in U(x_0)$ whose isotropy group $G_x$ satisfies
\begin{equation}\label{min_eq}
\#G_x = \min \{\# G_y\, \vert \, y\in U(x_0)\}.
\end{equation}
If $\# G_x=1$ we are done. So let us assume this is not the case and derive a contradiction. 

In view of Lemma \ref{klsonja}, 
there exists an open neighborhood $U(x)\subset U(x_0)$ equipped with the $G_x$-action and such that the homomorphism $\Phi: G_x\to \text{Diff}_{\textrm{sc}}(U(x))$ is an injection. Hence, given $g\in G_x\setminus \{1_x\}$, there exists $a\in U(x)$ for which $\Phi (g)(a)=b\neq a$. 
The isotropy group $G_a$ at the point $a$ is isomorphic to the subgroup $H
=\{h\in G_x\,\vert \, \Phi (h)(a)=a\}$ of $G_x$. 
From \eqref{min_eq} we conclude that 
$$\#G_x\leq \#G_a=\#H\leq \#G_x,$$
so that $\#G_x=\#H$ and hence $G_x=H$. This shows that 
$g\in H$, so that $\Phi (g)a=a$ contradicting $\Phi (g)a=b\neq a$. 

This contradiction shows that $\#G_x=1$ and that $X_{\textrm{reg}}$  is dense.  This completes the proof  Proposition \ref{prop_density}.
\qed \end{proof}


We recall from Theorem \ref{x-local-x} that every point $x$ in the object set of an ep-groupoid $(X, \bm{X})$ possesses 
a suitable open neighborhood $U(x)$, which can be chosen arbitrarily small, on which the isotropy group $G_x$ acts by the homomorphism $\Phi\colon G_x\to \text{Diff}_{\textrm{sc}}(U(x)).$

We say that  $g\in G_x$ {\bf acts trivially}\index{Trivially acting element in $G_x$} if there exists an open neighborhood $U(x)$ equipped with the $G_x$-action 
$\Phi: G_x\to \textrm{Diff}_{\textrm{sc}}(U(x)$ such that  $g$ belongs to the kernel of the homomorphism $\Phi$, i.e., if $\Phi (g)=\mathbbm{1}.$
Clearly,  $1_x$ is always acting trivially, but there might be other elements $g\in G_x$ acting trivially.  Since we are dealing with a finite group $G_x$, we can choose $U(x)$ so small that the kernel
of $\Phi$ is equal to the subgroup of $G_x$ acting trivially on $U(x)$.  


We denote by $T_x\subset G_x$ the subgroup of $G_x$ acting trivially on $U(x)$, which,  as the kernel of a group homomorphism,  is a normal subgroup of $G_x$.

\begin{definition}\label{DEF725}\index{D- Non-effective part}\index{D- Reduced morphisms}
The {\bf non-effective part $\bm{X}_T\subset \bm{X}$}
is the subset of morphisms defined as 
$$
\bm{X}_T=\{\phi \in T_x\subset G_x\, \vert \, x\in X\}.
$$
The subset $\bm{X}_{\textrm{R}}$ of {\bf reduced morphisms of $X$} is defined as follows. Two morphisms $\phi$ and 
$\phi'\in \bm{X}$ are called equivalent, $\phi\sim \phi'$,  if the following two conditions are satisfied.
\begin{itemize}
\item[(1)]\ $s(\phi)=s(\phi')=x$.
\item[(2)]\ $\phi=\phi'\circ g$ for some $g\in T_x$.
\end{itemize}
The set $\bm{X}_{\textrm{R}}$ is the collection of all equivalence classes $[\phi]$ of morphisms in $\bm{X}$.
\qed
\end{definition}

\begin{proposition}\label{reduced_m_pol}
\index{P- Reduced ep-groupoid}
The reduced morphism set $\bm{X}_{\textrm{R}}$ has a natural M-polyfold structure.
\end{proposition}
\begin{proof}
We equip $\bm{X}_{\textrm{R}}$ with the quotient topology so that 
the quotient map $\pi: \bm{X}\rightarrow \bm{X}_{\textrm{R}}$ is continuous. For every morphism $\phi_0\in \bm{X}$ we find open neighborhoods
$\bm{U}(\phi_0)\subset \bm{X}$ and $U(s(\phi_0))\subset X$ for which  $s\colon \bm{U}(\phi_0)\rightarrow U(s(\phi_0))$ is a sc-diffeomorphism.  Then the map 
$$\pi': \bm{U} (\phi_0)\to \bx_{\textrm{R}},\quad \phi\mapsto [\phi]$$
is continuous.  If  $[\psi]=[\psi']$ for $\psi$ and $\psi'\in \bm{U}(\phi_0)$, then $s(\psi)=s(\psi')$ implies that  $\psi=\psi'$. Hence the map is injective and therefore a bijection onto the image. 

Next we  shall show that the image $\bm{U} ([\phi_0]):=\pi'(\bm{U} (\phi_0))$ is open in $\bx_{\textrm{R}}$. In order to verify this we have to show that the preimage  $\pi^{-1}(\bm{U} ([\phi_0]))$ is open in $\bx$. To see this let  $\psi\in \pi^{-1}(\bm{U} ([\phi_0]))$. Then there is 
$\phi\in \bm{U} (\phi_0)$ such that $\phi\sim \psi$. This means that $s(\phi)=s(\psi)$ and there exists $g\in T_{s(\phi)}=T_{s(\psi)}$ such that $\phi=\psi\circ g.$ 
We have to show that there exists an open neighborhood $\bm{U} (\psi)$ of $\psi$ such that every morphism $\psi'\in \bm{U} (\psi)$ is equivalent to some morphism $\phi'$ belonging to $\bm{U} (\phi_0)$.
We denote by  $U(s(\phi))$ 
an open neighborhood of $s(\phi)$ contained in $U(s(\phi_0))$ and such that $T_{s(\phi)}=T_{s(\psi)}$ is equal to the kernel of the homomorphism $\Phi: G_{s(\psi)}\to \textrm{Diff}_{\textrm{sc}}(U(s(\psi)))$.  
Choosing  an open neighborhood $\bm{U} (\psi)$ of $\psi$ in $\bx$ such that the source map $s: \bm{U} (\psi)\to U(s(\psi))$ is a sc-diffeomorphism, we define  
the map  $\delta: \bm{U} (\psi)\to \bx$ by 
$$\delta (\psi')=(s\vert \bm{U} (\psi))^{-1}(s(\psi'))\circ \Gamma (g, s(\psi')).$$
If  $\psi'=\psi$, then 
$$\delta (\psi)=(s\vert \bm{U} (\psi))^{-1}(s(\psi))\circ \Gamma (g, s(\psi))=\psi\circ g=\phi.$$
Since the map $\delta$ is continuous and $\delta (\psi)=\phi$, there exists an open neighborhood $\bm{U}'(\psi)\subset \bm{U} (\psi)$ of $\psi$ such that $\delta (\bm{U}'(\psi))\subset \bm{U} (\phi_0)$.  Every morphism $\psi'$ in $\bm{U}'(\psi)$ is of the form $\psi'=(s\vert \bm{U} (\psi))^{-1}(s(\psi))$, so that 
$$\delta (\psi')=\psi'\circ \Gamma (g, s(\psi')).$$
Since 
the element $g\in T_{s(\psi)}$, it follows that the morphism 
$\Gamma (g, s(\psi'))$ belongs to $T_{s(\psi')}$, which implies that every morphism $\psi'\in \bm{U}'(\psi)$ is equivalent to the morphism $\delta (\psi')$ belonging to $\bm{U} (\phi_0)$.  This shows that $\bm{U}' (\psi)\subset \pi^{-1}(\bm{U} ([\phi_0])$, implying that  the preimage $\pi^{-1}(\bm{U} ([\phi_0])$ is open in $\bx$. Hence the set $\bm{U} ([\phi_0])$ is open in $\bx_{\textrm{R}}$, as claimed.

The same argument also shows that the map
$$
\bm{\Psi}_{\phi_0}: \bm{U}(\phi_0)\rightarrow \bm{U}([\phi_0]),\quad \phi\mapsto  [\phi]
$$
is an open map. We have shown that the map $\bm{\Psi}_{\phi_0}$ is a homeomorphism between open neighborhoods.  

Next we consider two such maps 
$$\bm{\Psi}_{\phi_0}:\bm{U} (\phi_0)\rightarrow \bm{U} ([\phi_0])\quad \text{and}\quad \bm{ \Psi}_{\psi_0}:\bm{U} (\psi_0)\rightarrow \bm{U} ([\psi_0]),$$
where $U([\phi_0])\cap \bm{U}([\psi_0])\neq\emptyset$, and we claim that the transition map 
$$\bm{\Psi}_{\psi_0}^{-1}\circ \bm{\Psi}_{\phi_0}: \bm{ \Psi}_{\phi_0}^{-1}(\bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))\to 
\bm{ \Psi}_{\psi_0}^{-1}(\bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))$$
is sc-smooth. To verify this claim we take a morphism $\phi\in 
\bm{ \Psi}_{\phi_0}^{-1}(\bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))$ and assume that 
$\bm{ \Psi}_{\psi_0}^{-1}(\phi)=\psi\in \bm{ \Psi}_{\psi_0}^{-1}(\bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))$. Hence 
$[\phi]=[\psi]\in \bm{U} ([\phi_0])\cap \bm{U}([\psi_0])$. Then $s(\phi)=s(\psi)$ and there exists $g\in T_{s(\phi)}=T_{s(\psi)}$ for which 
$$\psi=\phi\circ g.$$
Choosing a sufficiently small open neighborhood $U(s(\phi))\subset U(s(\phi_0))$ such that $T_x$ agrees with the kernel 
of the $G_{s(\phi)}$-action $\Phi: 
G_{s(\phi)}\to \textrm{Diff}_{\textrm{sc}}(U(s(\phi)))$, we find an open neighborhood $\bm{U} (\phi)\subset \bm{ \Psi}_{\phi_0}( \bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))$ for which the source map $s: \bm{U} (\phi)\to U(s(\phi))$ is a sc-diffeomorphims. Then every morphism $\phi'$ in $\bm{U} (\phi)$ is of the form $\phi'=(s\vert \bm{U} (\phi))^{-1}(s(\phi'))$. We define the map 
$$\delta (\phi')=(s\vert \bm{U} (\phi))^{-1}(s(\phi'))\circ \Gamma (g, s(\phi'))$$
for $\phi'\in \bm{U} (\phi)).$ 
Since  
$\delta (\phi)=\psi$ and the map $\delta$ is sc-smooth, in particular continuous, there exists an open neighborhood $\bm{U}'(\phi)\subset \bm{U} (\phi)$ such that $\delta (\bm{U}'(\phi)\subset \bm{U} (\psi_0)$. 
The morphism $ \Gamma (g, s(\phi'))$ belongs to $T_{s(\phi')}$ showing that 
$[\phi']=[\delta (\phi')]$ and $\delta (\phi')\in \bm{ \Psi}_{\psi_0}^{-1}(\bm{U} ([\phi_0])\cap \bm{U} ([\psi_0]))$ for all $\phi'\in \bm{U} '(\phi)$.  We have proved that the transition map $\bm{ \Psi}_{\psi_0}^{-1}\circ \bm{ \Psi}_{\phi_0}=\delta$ is sc-smooth,  as claimed.

Summing up,  the maps 
$$
\bm{ \Psi}_{\phi_0}: U(\phi_0)\rightarrow \bm{U} ([\phi_0])
$$
 are homeomorphisms between open subsets of the M-polyfold $\bm{X}$
and open subsets of $\bm{X}_{\textrm{R}}$, and the transition maps are sc-smooth. This defines the natural M-polyfold structure on $\bm{X}_{\textrm{R}}$. 
\qed \end{proof}
Now we define the {\bf  reduced ep-groupoid}\index{reduced ep-groupoid} $X_{\textrm{R}}$ associated with the ep-groupoid $X$. 
On the object level we put $X_{\textrm{R}}=X$ and
as morphism M-polyfold we take $\bm{X}_{\textrm{R}}$. The source and target maps $s, t: \bm{X}_{\textrm{R}} \to X$  
are defined by 
$$
s([\phi]):=s_{X}(\phi)\quad  \text{and}\quad t([\phi])=t_{X}(\phi).
$$
They  are well-defined since two morphisms in an equivalence class have the same source and the target. 
It is clear that $s$ and $t$ are surjective.
For  the local sc-diffeomorphisms 
$\bm{ \Psi}_{\phi}: \bm{U}(\phi)\rightarrow \bm{U} ([\phi])$  we have the identities 
$$
s(\bm{ \Psi}_{\phi}(\phi'))=s_{X}(\phi')\quad  \text{and}\quad t(\bm{ \Psi}_{\phi}(\phi'))=t_{X}(\phi')
$$
which show that the source and target maps are smoothness of the natural maps can be reduced by our local charts to the corresponding statements for $X$. The properness can be proved similarly.
We summarize these arguments in the following proposition.
\begin{proposition}\index{P- Effectiveness of $X_{\textrm{R}}$}
Every ep-groupoid $X$ possesses an associated reduced ep-grou\-poid $X_{\textrm{R}}$. Moreover,  $X_{\textrm{R}}$ is effective.
\end{proposition}
\begin{proof}
The first part is already proved.  The effectiveness of $X_{\textrm{R}}$ is seen as follows.
Fixing the object $x\in X$, we denote by $\wt{G}_{x}$ the isotropy group of the object $x$ in the ep-groupoid $X_{\textrm{R}}$ and observe that $[1_x]=T_x$. If $\tau\in \wt{G}_x\setminus [1_x]$, then $\tau=[g]$ for some $g\in G_x\setminus T_x$. Let $\bm{V}(\tau)$ be an open neighborhood of $\tau$ in $\bm{X}_{\textrm{R}}$ and let $U(x)=U(s(g))$ be an  open neighborhood of $x$ in $X$ which is equipped with the $G_x$-action $\Phi$ such that 
$T_x=\ker \Phi$. The neighborhood $U(x)$ can be taken as small as we wish. Then we choose an open neighborhood $\bm{U} (g)$ such that the source map $s: \bm{U} (g)\to U(x)$ is a sc-diffeomorphim.   It follows from the proof of Proposition \ref{reduced_m_pol} that the $\bm{ \Psi}_{g}: \bm{U} (g)\to \bm{U} ([g])=\bm{U} (\tau)$ is a homeomorphism. We take a neighborhood $U(x)$ so small that $\bm{U} ([g])\subset \bm{V}(\tau)$. 

Since $g\in G_x\setminus T_x$, there exists $a\in U(x)$ for which $\Phi (g)(a)=b\neq a$. Then for  the morphism $\phi=\Gamma (g, a)$ connecting $a$ with $b$,   we conclude that 
$s([\phi])=s_{X}(\phi)=a\neq b=t_{X}(\phi)=t([\phi]).$
Hence the ep-groupoid $X_{\textrm{R}}$ is effective, as claimed.
\qed \end{proof}

If we start with an ep-groupoid $X$ and take the associated reduced ep-groupoid $X_R$ we recall that the underlying object spaces
are the same, but the morphism spaces differ. If $x\in X$ and $G_x$ is the associated isotropy group, then the isotropy group in the reduced 
ep-groupoid is $G_x/T_x$, where $T_x$ is defined before Definition \ref{DEF725}.
\begin{definition}\label{DEF728}
For and object $x$ in an ep-groupoid $X$ we shall call $G_x/T_x$ the effective isotropy group of $x$ and denote it by $G_x^{\text{eff}}$.
\end{definition}

\section{Topological Properties of Ep-Groupoids}\label{section1.3_top_prop}
In this subsection we shall study the topological properties of ep-groupoids. The following result  summarizes the topological properties.
\begin{theorem}[{\bf Basic Topological Properties of $|X|$}]\label{topos-x}\index{T- Topological properties}\label{ATHOME}
Let $(X,\bm{X})$ be an ep-groupoid. Then  the orbit space $|X|$ is a locally metrizable, regular, Hausdorff topological space.
If in addition $|X|$ is paracompact then it also is metrizable, which is a consequence of the Nagata/Smirnov metrization theorem.
\qed
\end{theorem}
The theorem follows from several lemmata.
\begin{lemma}[{\bf Local metrizability}]\label{local_metrizability_x}\index{L- Local metrizability of orbit spaces}
Let $(X,\bm{X})$ be an ep-groupoid. Then every point $z\in |X|$ has an open neighborhood $V=V(z)$ on which the topology is metrizable, i.e. the orbit space 
$|X|$ is locally metrizable. In fact one can  take $|U(x)|$ where $U(x)$ is an open neighborhood equipped with the natural $G_x$-action.
\end{lemma}
\begin{proof}
We choose  a representative $x\in X$ of $z$ so that  $z=\abs{x}$ and  take an open neighborhood $U=U(x)$ of the form guaranteed by Theorem \ref{x-local-x}.
In particular,  we have a $G_x$-action on $U$ and $V(z):=|U|$ is open by Proposition \ref{q-open}.
The subset $U$ of the M-polyfold $X$ is metrizable and since it is invariant under the $G_x$-action, which acts by sc-diffeomorphisms,
we can define, using a metric $d$ on $U$, a $G_x$-invariant metric $\rho$ on $U$ by
$$
\rho(y,y')=\text{max}_{g\in G_x} d(g\ast y,g\ast y').
$$
The metric $\rho$ on $U$ is equivalent to the original one in the sense that it induces the same topology, and is,  in addition, invariant under the action of $G_x$,
$$
\rho(h\ast y,h\ast y') = \rho (y,y')\quad  \text{for $h\in G_x$.}
$$
On ${_{G_x}\backslash}U$ we obtain the  induced metric $\wh{\rho}$,  defined by
$$
\wh{\rho}([y],[y'])= \text{min}\{\rho(g\ast y,h\ast y')\, \vert \,  g,h\in G_x\}, 
$$
which defines the quotient topology. By Proposition \ref{go-go} the map ${_{G_x}\backslash} U\rightarrow V(z)$ is a homeomorphism.
Hence the push-forward of the metric $\what{\rho}$ to $|U|=V(z)$ shows that $V(z)\subset |X|$ is metrizable.
\qed \end{proof}
The next result follows from the previous one.
\begin{lemma}
Let $(X,\bm{X})$ be an ep-groupoid. Then for the quotient topology on $|X|$ every point $z\in \abs{X}$ has a countable neighborhood basis, consisting of open sets,
$$
{\mathcal V}_z =\{V_k(z)\, \vert \, k=1,2,3,\ldots \}
$$
satisfying  $z\in V_{k+1}(z)\subset V_k(z)$.
\end{lemma}
\begin{proof} In view of  Lemma \ref{local_metrizability_x}
every point in $|X|$ has a metrizable neighborhood.
\qed \end{proof}

That $|X|$ is always Hausdorff is mainly a consequence of the properness property (3)  of an ep-groupoid as the next lemma shows.

\begin{lemma}[{\bf Hausdorffness of orbit space}]\label{lemma1.37}\index{L- Hausdorffness of orbit spaces}
The orbit space $|X|$ of an ep-groupoid  $(X,\bm{X})$ is Hausdorff. 
\end{lemma}
\begin{proof}
We fix two different points $z,z'$ in $|X|$ and choose representatives $x,x'\in X$ satisfying  $\pi(x)=z$ and $\pi(x')=z'$. We can take countable monotonic neighborhood
bases $(U_k(x))$ and $(U_k(x'))$ in $X$ and obtain  for $z,z'$ the sets $V_k(z)=|U_k(x)|$ and $V_k(z')=|U_k(x')|$ in $\abs{X}$. It suffices to show that  $V_k(z)\cap V_k(z')=\emptyset$ for $k$ large. 
Arguing indirectly we find $z_k\in V_k(z)\cap V_k(z')$. This implies the existence of sequences   $x_k\in U_k(x)$ and $x_k'\in U_k(x')$ satisfying  $\pi(x_k)=\pi(x_k')=z_k$. We conclude that  $x_k\rightarrow x$ and $x_k'\rightarrow x'$ in $X$ since $(U_k(x))_{k\geq 1}$ and $(U_k(x')_{k\geq 1}$ are  monotone neighborhood bases.
We take a sequence $(\phi_k)\subset \bm{X}$ satisfying  $s(\phi_k)=x_k$ and $t(\phi_k)=x_k'$. Using the properness condition (3), we conclude after taking a suitable 
subsequence, that there exists a morphism $\phi_0\in \bm{X}$ with $s(\phi_0)=x$ and $t(\phi_0)=x'$ implying $z=z'$ and contradicting $z\neq z'$.
\qed \end{proof}
We recall that a topological space is {\bf regular}\index{Regular topological space} if  for a nonempty closed subset $A$
and a point $z$ not belonging to $A$ there exist open sets $U$ and $V$ such  that $z\in U$, $A\subset V$ and $U\cap V=\emptyset$.
A slight strengthening of the previous result shows that the orbit space $|X|$ of an ep-groupoid is a regular topological space.
Since we already know that $|X|$ is Hausdorff this implies that $|X|$ is a regular Hausdorff space.
\begin{lemma}[{\bf Regularity}]\index{L- Regularity of orbit spaces}
Let $(X,\bm{X})$ be an ep-groupoid.  Then $|X|$ is a regular topological space.
\end{lemma}
\begin{proof}
Assuming  we are given a closed subset $A$ of $|X|$ and a point $z\in |X|\setminus A$,  we choose a representative 
$x\in X$ satisfying $\pi(x)=z$.  Since $|X|\setminus A$ is open and contains $z$,  we find by continuity of $\pi$ an open neighborhood
$O$ of $x$ in $X$  such that  $\pi(O)\subset |X|\setminus A$. Since $X$ is metrizable and therefore normal,  we find an open neighborhood $O'$ of $x$ in $X$ such that 
$$
x\in O'\subset \cl_X(O')\subset O.
$$
By the properness assumption we may assume that $O$ was chosen  in such a way that
$$
t\colon  s^{-1}(\cl_X(O))\rightarrow X
$$
is proper.  We  choose a point $y\in \pi^{-1}(A)$ in  the preimage of $A$ and show that there exists an open neighborhood
$V(y)$ such  that there exists no morphism $\phi$ satisfying $s(\phi)\in O'$ and $t(\phi)\in V(y)$.
Since $X$ is a metrizable space,  we find otherwise a sequence $(\phi_k)$ of morphisms satisfying 
$s(\phi_k)\in O'$ and $t(\phi_k)\rightarrow y$. By the properness assumption we may assume 
after perhaps taking a subsequence that $\phi_k\rightarrow \phi$. Then
$s(\phi)\in \cl(O')$ and $t(\phi)=y$. Since $\cl(O')\subset O$, this implies the contradiction $\pi(y)\in \pi(O)\cap A$.
Hence we find for every $y\in\pi^{-1}(A)$ an open neighborhood $V(y)$ for which  $\pi(V(y))\cap \pi(O')=\emptyset$. The set 

$$
\wh{V}=\bigcup_{y\in \pi^{-1}(A)} V(y)
$$
is an open subset of $X$ and therefore $V:=\pi(\wh{V})$
is an open subset of $|X|$ containing $A$. By construction,  $V\cap \pi(O')=\emptyset$. 
\qed \end{proof}

In view of the above lemmata, the proof of Theorem \ref{topos-x} is complete.
\qed












As a consequence of Urysohn's metrizability theorem we can conclude,  under an additional  condition,  that the orbit space  $|X|$ is (globally) metrizable.
\begin{corollary}[{\bf Metrizability criterion}]\index{C- Metrizability criterion}
Let $X$ be an ep-groupoid whose induced  topology ${\mathcal T}$ on $|X|$ is second countable, i.e. ${\mathcal T}$ has a countable basis.
Then $|X|$ is metrizable.
\end{corollary}
\begin{proof} Urysohn's metrizability result states that a second countable, regular Hausdorff space is metrizable.
As we have shown the orbit space $|X|$ of an ep-groupoid is always a regular Hausdorff space. The additional assumption that 
$|X|$ is second countable gives via Urysohn's theorem the desired result.
\qed \end{proof}
Continuing with a general ep-groupoid $X$  we observe that the induced topology on a given subset  of $|X|$ is again locally metrizable, regular and Hausdorff.
\begin{definition}\index{D- Component compact subset}
If  $X$ is an ep-groupoid, we call a subset $K$ of the orbit space $|X|$ {\bf component compact} provided its intersection with every connected component of $|X|$ 
is compact. 
\qed
\end{definition}
Theorem \ref{ATHOME} has a second corollary, which employs the  Nagata-Smirnov metrizability theorem.

\begin{corollary}\label{NHOOD}\index{C- Metrizability criterion}
Let $(X,\bm{X})$ be an ep-groupoid and $K\subset |X|$ a  component compact subset. Then there exists an open neighborhood $U$ of $K$ for which 
$\cl_{|X|}(U)$ is paracompact. Since $\cl_{|X|}(U)$ is a regular Hausdorff space which is locally metrizable, it follows, in particular,  that $\cl_{|X|}(U)$ is metrizable 
and therefore $U$ is metrizable.
\end{corollary}
\begin{proof}
In order to prove the corollary we need the Nagata-Smirnov metrizability theorem.  We work in a connected component of $K$
and may assume without loss of generality that $K$ is compact. Every point $z\in K$ has an open neighborhood
$U(z)$ whose  closure in $|X|$ is metrizable. In particular,  $\cl_{|X|}(U(z))$ is paracompact. Using the compactness
of $K$ we find finitely many points $z_1,\ldots ,z_k$  in $K$ such that $U(z_1),\ldots ,U(z_k)$ cover $K$. Then the union 
$$
\ov{U}=\bigcup_{i=1}^k \cl_{|X|}(U(z_i))
$$
is paracompact. Moreover,  as a subset of $|X|$ its induced topology  is Hausdorff, regular and locally metrizable. 
By the Nagata Smirnov Theorem $\ov{U}$ is metrizable and the same holds then for the set $U=\bigcup_{i=1}^k U(z_i)$.
 \qed \end{proof}
 
 There are many new features in the sc-theory which do not occur in the classical theory. For example, 
we can raise the index of a M-polyfold $X$ to obtain the M-polyfold $X^1$. Doing this, the question arises whether for an ep-groupoid $X$ we obtain an ep-groupoid $X^1$. The answer is yes, and this is 
the next proposition.

\begin{proposition}[{\bf Index Lifting}]\label{raising-1}\index{P- Index lifting}
If $X=(X, \bm{X})$ is an ep-groupoid, then  the same is true for $X^1=(X^1, \bm{X}^1)$. If $X$ is tame so is $X^1$.
\end{proposition}
\begin{proof}
We note that $X^1=(X^1, \bm{X}^1)$ satisfies trivially  properties (1), (2) and (4) of Definition \ref{ep-groupoid_def}. 
We shall show that  the property (3) holds.   We take a point $x\in X_1$.  Then $x\in X$ and there exists an open neighborhood $V(x)$ of $x$ in $X$ such that 
\begin{equation}\label{ep_groupoid_eq_0}
t: s^{-1}(\textrm{cl}_X (V(x)))\to X
\end{equation}
is proper. Since the inclusion $i:X_1\to X$ is continuous, the set $W(x):=V(x)\cap X_1$ is open in $X_1$ and we also have $\textrm{cl}_{X_1}(W(x)) \subset \textrm{cl}_X (V(x))$, where $\textrm{cl}_{X_1}$ stands for the closure of a set in $X_1$. We claim that the map
\begin{equation}\label{ep_groupoid_eq_1}
t: s^{-1}(\textrm{cl}_{X_1}(W(x))\to X_1
\end{equation}
is proper.  It suffices to show that every sequence $(\phi_k)\subset s^{-1}(\cl_{X_1}(W(x))$ such that  $(t(\phi_k))$ belongs  to a compact subset of $X_1$, has a convergent subsequence in $\bm{X}_1$. Using the properness on level $0$ and the pre-compactness of $(t(\phi_k))$ on level $1$
we may assume after taking a suitable subsequence the following properties of the sequence $(\phi_k)$.
\begin{itemize}
\item[(a)]\ $\phi_k\rightarrow \phi$ in  $\bm{X}_0$.
\item[(b)]\ $s(\phi_k)\rightarrow s(\phi)\in \cl_X(V(x))$  and $t(\phi_k)\rightarrow t(\phi)$ in $X_0$.
\item[(c)]\ $t(\phi_k)\rightarrow t(\phi)$ in $X_1$.
\end{itemize}
From the fact that $t$ is a local sc-diffeomorphism and using (c) we deduce that 
\begin{itemize}
\item[(d)]\ $\phi\in \bm{X}_1$.
\end{itemize}
We  find open neighborhoods $\bm{U}(\phi)$ and $U(t(\phi))$ in $\bm{X}_0$ and $X_0$, respectively, such  that
$$
t\colon \bm{U}(\phi)\rightarrow U(t(\phi))
$$
is a sc-diffeomorphism. For large $k$, the sequences $\phi_k$ and $t(\phi_k)$ belong to these neighborhoods.
So far,  by construction, 
$$
\phi_k=(t\vert \bm{U}(\phi))^{-1}(t(\phi_k))
$$
for large $k$. In view of (d),  $t(\phi_k)\rightarrow t(\phi)$ in $X_1$ and since $(t\vert \bm{U}(\phi))^{-1}$ is $\ssc^0$,  the convergence 
$$
\phi_k=(t\vert \bm{U}(\phi))^{-1}(t(\phi_k))\rightarrow (t\vert \bm{U}(\phi))^{-1}(t(\phi))=\phi\quad \text{in $\bm{ X}_1$}
$$
follows. 
This proves the properness on level $1$.
That the tameness of $X$ implies the tameness of $X^1$,  is trivial. The proof of Proposition \ref{raising-1} is complete.
\qed \end{proof}


\section{Paracompact Orbit Spaces}
We have shown that the orbit space $|X|$ of an ep-groupoid $(X, \bm{X})$ is a locally metrizable, regular  Hausdorff topological space.
This  means that single points are closed subsets. Moreover,  a point $z\in \abs{X}$ and a closed subset $A$ of $|X|$ not containing $z$
can be separated by open subsets containing them. In practice many of the interesting ep-groupoids have orbit spaces whose  topologies  are  paracompact.
In view of the Nagata-Smirnov metrizability theorem such an orbit space will be metrizable. This has, of course, pleasant features when one has to carry out constructions.

\begin{definition}
The ep-groupoid  $(X,\bm{X})$ is an {\bf ep-groupoid with paracompact orbit space}\index{D- Ep-groupoid with paracompact orbit space}
if, in addition to the properties (1)--(4) of Definition \ref{ep-groupoid_def}, it also possesses the following property  (5).
\begin{itemize}
\item[(5)]\ The orbit space $|X|$ is paracompact.
\end{itemize}
\qed
\end{definition}
We recall that a topological space is {\bf paracompact}\index{paracompact} if  every open covering 
has a refinement which is a locally finite open covering.  We do not require a paracompact space to be Hausdorff. It is presently not known whether the property  (5) is a consequence of the properties (1)--(4).  In case
$X$ has a second countable topology we have already seen that (1)-(4) imply (5).
\begin{remark}
In our paper \cite{HWZ3.5} we always required the M-polyfold to be second countable.
We later realized that this  requirement is unnecessarily restrictive and that a better requirement is (5).
\qed
\end{remark}

\begin{proposition}[{\bf Paracompactness under lifts}]\index{P- Paracompactness under lifts}
Let $(X,\bm{X})$ be an ep-groupoid with paracompact orbit space. Then also $(X^1,\bm{X}^1)$ is an ep-groupoid with paracompact orbit space.
\end{proposition}
\begin{proof}
In view of Proposition \ref{raising-1} we only have to show that $|X^1|$ is paracompact and we already know that $|X|$ and $|X^1|$
are regular Hausdorff spaces.
We  recall from Lemma \ref{equivalent_definitions_paracompact}  that a regular Hausdorff space $Z$ is a  paracompact  space if and only if every open covering of $Z$ 
has a locally finite refinement of closed sets. 

For every $x\in X$ we choose an open neighborhood $U(x)$ of $x$ in $X$ equipped with the natural $G_x$-action. 
Since $\abs{X}$ is Hausdorff and paracompact,  the open cover $(\abs{U(x)})_{x\in X}$ of $\abs{X}$ has a refinement $(A_x)_{x\in X}$ having the following properties,
\begin{itemize}
\item[(1)]\  $(A_x)$ is a locally finite collection of closed sets.
\item[(2)]\ $A_x\subset \abs{U(x)}$.
\item[(3)]\ $\bigcup_{x\in X} A_x =\abs{X}$.
\end{itemize}
We note that some of the sets $A_x$ may be empty. We abbreviate  $A_{x,1}=A_x\cap |X_1|$. The set $A_{x,1}$ is the preimage of $A_x$ under the continuous map $|X_1|\rightarrow |X|$
and therefore closed. The collection $(A_{x,1})_{x\in X}$ inherits the property that $(A_x)$ is locally finite and,  by construction, 
$$
|X_1|=|X_1|\cap |X|= |X_1|\bigcap\left( \bigcup_{x\in X} A_x\right)=\bigcup_{x\in X} A_{x,1}.
$$
We shall show that each set $A_{x,1}$ is paracompact. Then the Hausdorff orbit space $\abs{X_1}$ as the union of a locally finite collection of closed paracompact sets is paracompact.   
Since $U(x)$ has the natural $G_x$-action, the same is true for $U(x)_1\subset X_1$. As in the proof of Lemma \ref{local_metrizability_x}
one can take any metric on $U(x)_1$ inducing the topology, and then construct a $G_x$-invariant metric, which then passes to the quotient
$|U(x)|_1=|U(x)_1|$. By construction,  $A_{x,1}\subset \abs{U(x)}_1$ so that $A_{x,1}$  inherits an induced metric and therefore is paracompact.
\qed \end{proof}

In the following a {\bf saturated subset}\index{Saturated subset} $U$ of an ep-groupoid is a subset  of the object space which contains with the object  $x\in U$ also all the objects  isomorphic  to $x$,  i.e., 
$U=\pi^{-1}(\pi(U))$, where $\pi\colon X\rightarrow |X|$ is the projection onto the orbit space.

The importance of paracompactness comes from the existence of partitions of unity which, for example,  is used in the next theorem.


\begin{theorem}[{\bf Continuous Partitions of Unity}]\label{c_partition_of_unity}\index{T- Continuous partitions of unity}
For an ep-grou\-poid $X$ with paracompact orbit space, there is  for every open cover ${(O_\lambda)}_{\lambda\in\Lambda}$ of $|X|$
a subordinate partition of unity ${(\sigma_\lambda)}_{\lambda\in\Lambda}$ (some of the $\sigma_\lambda\equiv 0$).
In particular,  every covering $(U_\lambda)$ of $X$ by saturated open sets possesses  a subordinated continuous partition of unity
$(\beta_\lambda)$,  where every function $\beta_\lambda $ takes the same values on isomorphic objects.
\end{theorem}
\begin{proof}
Due to paracompactness
the first part is an immediate consequence of a partition of unity. If  $(U_\lambda)$ is an open covering of $X$ by saturated open sets, 
then $O_\lambda=\pi(U_\lambda)$ is an open cover of  $|X|$. We choose  a subordinated partition of unity $(\sigma_\lambda)$ and 
define $\beta_\lambda=\sigma_\lambda\circ \pi$, where $\pi\colon X\rightarrow |X|$ is the quotient map.
Then  the support of $\beta_\lambda$ lies in $\pi^{-1}(O_\lambda)=U_\lambda$.  Taking  a point $x\in X$, we obtain $z=\pi(x)\in \abs{X}$ and  find an open neighborhood
$V=V(z)$ so that only finitely many functions $\sigma_\lambda$ have a support intersecting $V$. This means that only finitely many $\beta_\lambda $
have a support intersecting the open neighborhood $U=\pi^{-1}(V)$ of $x$.
\qed \end{proof}

For many differential geometric constructions we need the  sc-smooth partitions of unity or at least sc-smooth bump functions as already discussed in Appendix \ref{POU}.


\begin{definition}[{\bf Sc-Smooth Partitions of Unity}]\index{D- Sc-smooth partitions of unity for ep-groupoids}
An {\bf ep-groupoid $\bm{X}$ with sc-smooth partitions of unity} is an ep-groupoid $X$ having the property  that for every saturated open covering ${(U_\lambda)}_{\lambda\in\Lambda}$ 
of the object M-polyfold $X$ there exists
an subordinate sc-smooth partition of unity ${(\beta_\lambda)}_{\lambda\in\Lambda}$ such that 
\begin{itemize}
\item[(1)]\ For every point $x\in X$ there exists a saturated open neighborhood intersecting only finitely many supports $\text{supp}(\beta_\lambda)$.
\item[(2)]\ For every $\lambda\in\Lambda$ the map $\beta_\lambda$ has the property that $\beta_\lambda(z)=\beta_\lambda(y)$ if $y$ and $z$ are isomorphic objects.
\end{itemize}
\qed
\end{definition}


\begin{remark}\index{R- On sc-smoothness partitions of unity}
Unfortunately this topic,  apart from the case of sc-Hilbert spaces, seems to be generally a zoo, as is the question of classically smooth partitions of unity
on Banach spaces. In the case of sc-smoothness it could potentially be easier to show their existence on concrete scales.\hfill \qed
\end{remark}

The basic result about sc-smooth partitions of unity for ep-groupoids is given by the following theorem.
\begin{theorem}\label{pert}\index{T- Partitions of unity}
Let $X$ be an ep-groupoid with paracompact orbit space $|X|$. We assume that the object M-polyfold $X$ admits sc-smooth partitions of unity. Then, for every  open cover of $X$ by saturated open subsets ${(U_\lambda)}_{\lambda\in\Lambda}$,  there exists a subordinate
sc-smooth partition of unity of the ep-groupoid $X$.
\qed
\end{theorem}
The proof of Theorem \ref{pert} is given in Appendix \ref{SCPART}.

We end this subsection with a characterization of closed subsets of the orbit space $|X|$ assuming that $|X|$ is paracompact.
\begin{definition}\label{proper*}\index{D- Properness property}
 We call a subset $Q$ of $X$ {\bf proper} provided $t: s^{-1}(Q)\rightarrow X$ is proper.
 We shall say that an open subset $U$ of $X$ has the {\bf properness property} provided $\cl_X(U)$ is proper. 
 \qed
\end{definition}
\begin{proposition}\label{proper-closed}
If $Q\subset X$ is proper, then it is a closed subset of $X$.
\end{proposition}
\begin{proof}
For a point $x\in \text{cl}(Q)$ we take a sequence $(x_n)\subset Q$ converging to $x$ and claim that $x\in Q$. Let  $\phi_n$ be the morphisms $1_{x_n}: x_n\to x_n$. The set $K=\{x_n\, \vert\, n\geq 1 \}\cup \{x\}$ is a compact subset of $X$. By the properness assumption, the preimage $(t\vert s^{-1}(Q))^{-1}(K)$  of $K$ under the map $t: s^{-1}(Q)\rightarrow X$ is a compact subset of $s^{-1}(Q)$.  Since $s(\phi_n)=x_n\in Q$ and $t(\phi_n)=x_n$, the sequence $(\phi_n)$ belongs to the compact subset $(t\vert s^{-1}(Q))^{-1}(K)$  of $s^{-1}(Q)$. Without loss of generality we may assume that $\phi_n\to \phi$ for some morphism $\phi\in (t\vert s^{-1}(Q))^{-1}(K) \subset s^{-1}(Q)$. In particular, 
$s(\phi )\in Q$. Since $s(\phi_n)=x_n$ and $x_n\to x$, we conclude after taking a limit that $s(\phi )=x\in Q$, as claimed.
\qed \end{proof}

\begin{proposition}\index{P- Closedness property}\label{closedness}
Let $X$ be an ep-groupoid.
\begin{itemize}
\item[{\em (1)}]\ If $Q\subset X$  is a proper subset, then $\pi(Q)$ is closed in $|X|$.
\item[{\em (2)}]\ If $|X|$ is paracompact, then a subset  $A$ of $|X|$ is closed if  and only if there exists a proper subset  $Q\subset X$ satisfying  $\pi (Q)=A$.
\end{itemize}
\end{proposition}
\begin{proof}
We first prove (1) and assume that $Q$ is proper subset of $X$. 
We abbreviate  $A:=\pi(Q)$. We take $z\in \text{cl}(A)$ and let $y\in X$ be a representative of $z$ so that $\pi (y)=z$. 
Taking a monotone neighborhood basis $(U_k(y))_{k\geq 1}$ we abbreviate $V_k(z)=\pi (U_k(y))\subset \abs{X}$. The open sets $V_k(z)$ form a monotone neighborhood basis of $z$ in $\abs{X}$. Since $z\in \text{cl}(A)$, for every $k\geq 1$, there exists $z_k\in A\cap V_k(z)$. 
In particular, $z_k\to z$. Moreover, there are $x_k\in Q$  and $y_k\in U_k(y)$ satisfying $\pi (x_k)=\pi (y_k)=z_k$. 
Hence there is a sequence of morphisms $(\phi_k)$ in $\bm{X}$ such that $s(\phi_k)=x_k$ and $t(\phi_k)=y_k$. Since  $y_k\to y$, the set $K=\{y_k\, \vert \, k\geq 1\}\cup \{y\}$ is compact in $X$. By assumption, 
$(t\vert s^{-1}(Q))^{-1}(K)$ is a compact subset of $s^{-1}(Q)$.  Then, since $(\phi_k)\subset  (t\vert s^{-1}(Q))^{-1}(K)$, we may assume that $\phi_k\to \phi$ for some morphism $\phi\in s^{-1}(Q)$. This implies that $x=s(\phi)\in Q$. From the convergence $z_k\to z$ and $z_k=\pi (s(\phi_k))\to \pi (s(\phi ))=\pi (x)$, we conclude that $\pi (x)=z\in A$ proving (1).


In order to prove (2) we assume that $|X|$ is paracompact. In view of  (1) it suffices to prove  that a closed subset  $A\subset |X|$ can be written
as $\pi(Q)=A$ for some proper subset $Q$ of $X$.  For every $z\in A$ we choose a representative  $x_z\in X$ satisfying  $\pi(x_z)=z$ and  an open neighborhood
$U(x_z)$ for which we have the natural $G_{x_z}$-action so that $Q_z:=\cl_X(U(x_z))$ is proper and therefore $\pi(Q_z)$ is closed. 
Then the open sets $\pi(U(x_z))$ are an open covering of  $A$. Since $A$ is a closed subset of a paracompact space it is paracompact.
By  Lemma \ref{equivalent_definitions_paracompact}  we  find a locally finite covering of $A$ by closed subsets,  say $A_i\subset A$, $i\in I$, so that 
$A_i\subset \pi(Q_{z_i})$ for a suitable map $i\mapsto z_i$. Define the  closed subset $P_i\subset \cl_X(U_{x_{z_i}})$ by
$$
P_i = (\pi | \cl_X(U_{x_{z_i}}))^{-1}(A_i).
$$
Finally,  introducing  $Q\subset X$ by
$$
Q=\bigcup_{i\in I} P_i,
$$
then,  by construction,  $\pi(Q)=A$ and we  only need to show that $Q$ is proper.  Take a sequence of morphisms $(\phi_k)$ satisfying 
$s(\phi_k)\in Q$ and $t(\phi_k)\rightarrow y$. Since $A$ is closed we see that $z=\pi(y)\in A$.  Since the covering $(A_i)$ is locally finite,
we find an open neighborhood $V(z)\subset |X|$ which  intersects only finitely many $A_i$, say $A_1,\ldots ,A_l$.
For $k$ large, $\pi(t(\phi_k))\in V(z)$. This implies that $\pi(s(\phi_k))\in A_1\cup\ldots \cup A_l$ for large $k$.
Hence, for large $k$, by construction $s(\phi_k)\in P_1\cup\ldots \cup P_l$. After perhaps taking a subsequence we may assume that
$s(\phi_k)\in P_1$. At this point we know that $s(\phi_k)\in P_1$ and $t(\phi_k)\rightarrow y$. By construction,  $P_1$ is proper and hence 
we find a convergent subsequence. This shows that $Q\subset X$ is proper and concludes the proof of Proposition \ref{closedness}.
\qed \end{proof}


\section{Appendix}
\subsection{The Natural Representation}\label{k-natural}
We recall the statement for the convenience of the reader
\begin{theorem}\label{LocalStr1thm}
Given an ep-groupoid $X$, an object  $x_0\in X$, and an open neighborhood $V\subset X$ of $x_0$. Then there exist  an open
neighborhood $U\subset V$ of $x_0$,  a group homomorphism
$$
\Phi  : {G}_{x_0}\rightarrow \text{Diff}_{sc}(U), \quad g\mapsto
\Phi (g)=t_g\circ s_g^{-1},
$$
and an  sc-smooth map
$$
\Gamma : G_{x_0}\times U\rightarrow \bm{X}
$$
having the following properties:
\begin{Myitemize}
\item $\Gamma(g,x_0)=g$.
\item $s(\Gamma(g,y))=y$ and $t(\Gamma(g,y))=\Phi (g)(y)$ for all $y\in U$ and $g\in G_{x_0}$.
\item If $h : y\rightarrow z$  is a morphism  connecting  two objects $y,z\in U$,  then there exists a
unique $g\in G_{x_0}$ such that  $\Gamma(g,y)=h$.
\end{Myitemize}
\end{theorem}
In particular, every morphism between points in $U$ belongs to the
image of the map $\Gamma$.  We call  the group homomorphism $\Phi : G_x\rightarrow
\text{Diff}_{sc}(U)$ a {\bf natural representation} of the
stabilizer  group   $G_{x_0}$.
\begin{proof}

For
every $g\in G_{x_0}$ we choose two  contractible open neighborhoods
$N^t_g$ and $N^s_g\subset \bm{X}$ on which the target and source
maps $t$ and $s$ are sc-diffeomorphisms onto some open neighborhood
$U_0\subset X$ of $x_0$. Since  the isotropy group $G_{x_0}$ is
finite we can assume that the open sets $N^t_g\cup N^s_g$ for $g\in
G_{x_0}$ are disjoint and define the disjoint open neighborhoods
$N_g\subset \bm{X}$ of $g$ by
$$N_g:=N_g^t\cap N_g^s,\quad g\in G_{x_0}.$$
We  abbreviate the restrictions of the source and target maps by
$$s_g:=s\vert N_g\quad \text{and}\quad t_g:=t\vert N_g.$$

\begin{lemma}\label{LocalStr1lem}
With the choices made above there exists an open neighborhood
$U_1\subset U_0$ of $x_0$ so that every morphism $h\in \bm{X}$ satisfying
$s(h)$ and $t(h)\in U_1$ belongs to $N_g$ for some  $g\in G_{x_0}$.
\end{lemma}
\begin{proof}
Arguing indirectly we find a sequence $h_k\in \bm{X}$ with $h_k\not
\in N_g$ for all $g\in G_{x_0}$ and satisfying $s(h_k), t(h_k)\to
x_0$ as $k\to \infty$. By the properness assumption of ep-polyfolds
there is a convergent subsequence $h_{k_l}\to h\in \bm{X}$.
Necessarily $h\in G_{x_0}$ and hence $h\in N_g$ for some $g\in
G_{x_0}$. This contradiction implies the lemma.
\qed \end{proof}

\begin{lemma}\label{LocalStr2lem}
If  $U_1$ is  the open neighborhood of $x_0$ guaranteed by Lemma
\ref{LocalStr1lem}, then there exists an open neighborhood $U_2\subset
U_1$ of $x_0$ so that the open neighborhood $U$ of $x_0$,  which is
defined as the union
$$U:=\bigcup_{g\in G_{x_0}}t_g\circ s_g^{-1}(U_2),$$
is contained in $U_1$ and invariant
 under all the maps $t_g\circ s_g^{-1}$ for $g\in G_{x_0}$.
\end{lemma}
\begin{proof}
We choose an open neighborhood $U_2\subset U_1$ of $x_0$  so small
that the union $U$ and also $t_g\circ s_g^{-1}(U)$ are contained in
$U_1$ for all $g\in G_{x_0}$. Consider the map $t_g\circ
s^{-1}_g : U\to X$ and choose $x\in U$. Then we can represent it as
$x=t_h\circ s_h^{-1}(u)$ for some $h\in G_{x_0}$ and some $u\in
U_2$. Now, $v:=t_g\circ s_g^{-1}\circ t_h\circ s_h^{-1}(u)$ belongs
to $U_1$ and the formula implies the existence of a morphism $u\to
v$ in $\bm{X}$. By Lemma \ref{LocalStr1lem} the morphism has
necessarily the form $v=t_{g'}\circ s^{-1}_{g'}(u)$ for some $g'\in
G_{x_0}$. Since $u\in U_2$ it follows that $v=t_g\circ
s_g^{-1}(x)\in U$ implying the desired invariance of $U$.
\qed \end{proof}

In view of Lemma \ref{LocalStr2lem} we can associate  with every $g\in
G_{x_0}$ the sc-diffeomorphism
$$\Phi (g):=t_g\circ s_g^{-1} : U\to U$$
of the open neighborhood $U$ of $x_0$, and obtain the mapping
$$\Phi  :  G_{x_0}\to \text{Diff}_{sc}(U), \quad g\mapsto \Phi (g).
$$
 Since the neighborhoods $N_g\subset \bm{X}$ of $g$ are
disjoint and since the structure maps are continuous we conclude
that $\Phi $ is a homomorphism of groups, in the following called
the {\bf natural representation of the stabilizer group $G_{x_0}$}
by sc-diffeomorphisms of the open neighborhood $U\subset X$ of
$x_0$. Then we define the map
$$
\text{$\Gamma :  G_{x_0}\times U\rightarrow \bm{X}$ \quad by \quad $\Gamma(g,y)= s_g^{-1}(y).$}
$$
Summing up the consequences of Lemma \ref{LocalStr1lem} and Lemma
\ref{LocalStr2lem} we have proved Theorem \ref{LocalStr1thm}.
\qed \end{proof}

\subsection{Sc-Smooth Partitions of Unity}\label{SCPART}
In this part of the appendix we establish  the existence of sc-smooth partitions of unity on certain ep-groupoids.
We recall Theorem \ref{pert} for the convenience of the reader.
\begin{theorem}
Let $X$ be an ep-groupoid with paracompact orbit space $|X|$. We assume that the object M-polyfold $X$ admits sc-smooth partitions of unity. Then, for every  open cover of $X$ by saturated open subsets ${(U_\lambda)}_{\lambda\in\Lambda}$,  there exists a subordinate
sc-smooth partition of unity of the ep-groupoid $X$.
\end{theorem}

We start the proof with a lemma. 

\begin{lemma}\label{lemma1.126}
We assume that $X$ is an ep-groupoid with  a paracompact  orbit space $|X|$ and the object M-polyfold $X$ admits sc-smooth partitions of unity. 
Suppose further that $x\in X$ and $U(x)$ and $V(x)$ are open neighborhoods of $x$ satisfying  $U(x)\subset \cl_X(U(x))\subset V(x)$ and such that $V(x)$ admits the natural $G_x$-action  and $U(x)$ is invariant.  

If $\beta: X\rightarrow [0,1]$ is a continuous function with support in $U(x)$ and invariant  under the $G_x$-action on $V(x)$, 
then there exists a sc-smooth function  $f:X\rightarrow [0,\infty)$ with support in $V(x)$, which is,  in addition , invariant under the $G_x$-action on $V(x)$ 
and satisfies $\beta(y)\leq f(y)$ for all $y\in X$.
\end{lemma}
\begin{proof}
For every $z\in U(x)$ we take an open neighborhood $W(z)$ with 
$$
\cl_X(W(z))\subset U(x)
$$
 and a number $a_z>0$ so that
$$
\beta(y)< a_z\ \text{for}\ y\in W(z).
$$
For every $z\in V(x)\setminus U(x)$ we can find an open neighborhood $W(z)$ so that $W(z)\subset V(x)$ and $\beta|W(z)=0$. In this case define $a_z=0$.
Since $V(x)$ is a subset of the metrizable object M-polyfold $X$ it is paracompact. Using that $(W(z))$ is an open cover of $V(x)$
we find a subordinate sc-smooth partition of unity $\sigma_z$, $z\in V(x)$ and define the function $\gamma: V(x)\to [0,\infty)$ by 
$$
\gamma (y) =\sum_{z\in V(x)} \sigma_z(y) a_z.
$$
By construction $\gamma \geq \beta$ on $V(x)$. 
Hence $\gamma$ is a  sc-smooth function with support in $\cl_X(U(x))\subset V(x)$. We  average with respect to the $G_x$-action and obtain
the function $f$, defined by 
$$
f(y) =\frac{1}{|G_x|}\sum_{g\in G_x} \gamma (g\ast y).
$$
By construction,  $\beta (g\ast y) \leq \gamma (g\ast y)$ which implies $\beta \leq f$.
\qed \end{proof}

\begin{proof}[Theorem \ref{pert}]
We consider the open covering ${(|U_\lambda|)}_{\lambda\in\Lambda}$ of $|X|$. In a first step we take,  for every $x\in X$,  an open neighborhood $V(x)\subset X$ satisfying the following properties:
\begin{itemize}
\item[(1)]\  There exists an open neighborhood $W(x)$ equipped with the  natural $G_x$-action such that 
$V(x)\subset \cl_X(V(x))\subset W(x)$  and $V(x)$ is invariant.
\item[(2)]\ $t:s^{-1}(\cl_X(V(x))\rightarrow X$ is proper.
\item[(3)]\ For every $x\in X$ there exists a $\lambda$ with $V(x)\subset U_\lambda$.
\item[(4)]\  $( (\pi^{-1}(\abs{V(x)})\setminus V(x))\cap W(x)=\emptyset$.
\end{itemize}
The family $(|V(x)|)_{x\in X}$ is an open covering of $|X|$ refining $(|U_\lambda|)$ and we find a locally finite refinement $(V_i')_{i\in I}$. In particular,  there is a map
$i\rightarrow x_i$ such  that $V_i'\subset \abs{V(x_i)}$. We take,  for every $i\in I$,  an open subset $V_i''$  of $V_i'$ satisfying 
$$
V_{i}''\subset cl_{|X|}(V_i'')\subset V_i'
$$
and, in addition, 
$$
|X| =\bigcup_{i\in I} V_i'' .
$$
For every $i\in I$, $V_i''\subset V_i'\subset |V(x_i)|$,  and we introduce $U_i''= V(x_i)\cap \pi^{-1}(V_i'')$ and   let $U_i$ be its saturation.
Then 
$$
U_i =\pi^{-1}(V_i'').
$$
The open set $U_i''$ is invariant under the $G_{x_i}$ action on $V(x_i)$. Next we take a continuous partition of unity $(\beta_i)$ subordinate
to the locally finite covering $(V_i'')$.  The function   $(\beta_i\circ \pi)|V(x_i)$ has support in $U_i''\subset V(x_i)$. 
Using the existence of smooth partitions of unity for the M-polyfold $X$ we can approximate $ (\beta_i\circ \pi)|V(x_i)$ using Lemma \ref{lemma1.126} by a sc-smooth function $f_i$
supported in $V(x_i)$ satisfying $f_i\geq (\beta_i\circ \pi)|V(x_i)$. We average using the $G_{x_i}$-action,  extend to the saturation of $V(x_i)$,  and then extend by $0$ outside. This gives a function $h_i$ compatible with morphisms.
The sum $h$ of all $h_i$  is locally finite and always bigger than $0$. Consequently,  $(h_i/h)$ is the desired partition of unity for  the ep-groupoid $X$.
\qed \end{proof}

\begin{corollary}\index{C- Partitions of unity}
Let $X$ be an ep-groupoid with paracompact orbit space $|X|$
We assume that the object M-polyfold admits an atlas 
consisting of charts whose local models 
$(O,C,E)$  have the property  that the $E_0$ are Hilbert spaces.  
Then every  open covering of $X$ by saturated open subsets ${(U_\lambda)}_{\lambda\in\Lambda}$ possesses a subordinate
sc-smooth partition of unity of the ep-groupoid $X$.
\end{corollary}
\begin{proof}
We only have to note that the assumption on the atlas implies that the object M-polyfold $X$ admits sc-smooth partitions of unity. The proof can be found in Appendix \ref{POU}, see specifically Proposition \ref{P548},
Theorem \ref{partition_approximation}, and Corollary \ref{C5417}.
Hence, the corollary  follows from Theorem \ref{pert}.
\qed \end{proof}




\chapter{Bundles and Covering Functors}
After discussing the tangent of an ep-groupoid, we shall define strong bundles over ep-groupoids.
Finally we discuss the notion of a proper covering functor between ep-groupoids and strong bundles,
respectively.
\section{The Tangent of an Ep-Groupoid}\label{section_Tangent_Ep-Groupoid}
The {\bf tangent} $T(X, \bm{X})$ of an ep-groupoid $(X,  \bm{X})$ is defined as the pair of 
tangent spaces 
\begin{equation}\label{tangentep_groupoid_eq1}
T(X, \bm{X})=(TX, T\bm{X}).
\end{equation}
Our aim is to equip the pair with the structure of an ep-groupoid, whose object set is the tangent space $TX$ and whose morphism set is the tangent space $T\bm{X}$. The main results are Theorem \ref{main_KK} and Theorem \ref{Walter_xx}.


In order to formulate the theorems we need some preparation. The object M-polyfold is going to be the tangent space $TX$. That $TX$ is a M-polyfold we know from 
Section \ref{section2.1}. The tangent space $T\bm{X}$, again a M-polyfold, is viewed as a the set of morphisms defined as follows. The tangent vector $(\phi, h)\in T_\phi\bm{X}$ is viewed as a morphism 
\begin{equation}\label{earl}
(\phi,h)\colon Ts(\phi)(h)\rightarrow Tt(\phi)(h).
\end{equation}
between the two objects in $TX$.
If $\phi\colon x\to y$ is a morphism in $\bm{X}$, then $Ts(\phi )(h)\in T_xX$ and $Tt(\phi )(h)\in T_yX$.

In view of \eqref{earl} we define the source and 
the target maps $s_{TX}, t_{TX}: T\bm{X}\to TX$ of $(TX, T\bm{X})$ by 
\begin{equation}\label{source-target_TX}
s_{TX}(\phi,h)=Ts(\phi)(h)\quad  \text{and}\quad  t_{TX}(\phi,h)=Tt(\phi)(h).
\end{equation}
In order to introduce the multiplication $(\psi, k)\circ (\phi, h)$ of two morphisms in $T\bm{X}$
we have to assume that 
\begin{equation}\label{source-target_TX_1}
s_{TX}(\psi, k)=Ts(\psi)(k)=Tt(\phi)(h)=t_{TX}(\phi, h)
\end{equation}
which implies that  $s(\psi)=t(\phi)$. Using that the source map $s: \bm{X}\to X$ is a local sc-diffeomorphism, we define the multiplication of the two morphisms 
$(\phi, h)$ and $(\psi, k)$ in $T\bm{X}$ by  

\begin{equation}\label{kaufmann}
(\psi,k)\circ (\phi,h) = (\psi\circ\phi, \bigl(Ts(\psi\circ\phi)\bigr)^{-1}(Ts(\phi)(h)))\in T_{\phi\circ \psi}\bm{X},
\end{equation}
where $k=Ts(\psi)^{-1}\bigl(Tt(\phi)(h)\bigr).$  The notation $(\phi, h)\in T_\phi\bm{X}$ for the tangent vector contains a redundancy.
If $\bm{p}: T\bm{X}\to \bm{X}^1$ is the projection of the tangent bundle, then $\bm{p}(h)=\phi$ if $h\in T\bm{X}$. Therefore, the definition \eqref{kaufmann} for the composition can be expressed shorter as 
\begin{equation}\label{composition_1}
k\circ h = \bigl(Ts(\bm{p}(k)\circ \bm{p} (h))\bigr)^{-1}\bigl(Ts(\bm{p} (h))(h)\bigr)
\end{equation}
and $t_{TX}(h)=s_{TX}(k).$  Depending on the situation we shall or shall not use the short  notation for the composition.

The unit morphism $1_a\in T\bm{X}$ associated with the object $a\in T_xX$ is the morphism 
\begin{equation}\label{unit_TX_1}
1_a=(1_x, h_a)\in T\bm{X},
\end{equation}
where $h_a\in T_{1_x}\bm{X}$ satisfies 
$Ts(1_x)(h_a)=a=Tt(1_x)(h_a).$
Consequently, the unit map $u_{TX}: TX\to T\bm{X}$ is given by 
\begin{equation}\label{unit_TX_2}
u_{TX}(a)=\bigl(1_x, Ts(1_x)^{-1}(a)\bigr)
\end{equation}
for $a\in T_xX$.

If $\iota_X: \bm{X}\to \bm{X}$ is the inverse map of the groupoid $(X, \bm{X})$,  we define  the inverse map $\iota_{TX}: T\bm{X}\rightarrow T\bm{X}$ by
\begin{equation}\label{inversion_TX}
\iota_{TX}(\phi,k) = \bigl(\phi^{-1}, T\iota_X(\phi)(k)\bigr).
\end{equation}


   
\begin{theorem}\label{main_KK}\index{T- Tangent of ep-groupoids}
The tangent $T(X,\bm{X})=(TX,T\bm{X})$ of the  ep-groupoid $(X,\bm{X})$,  together  with the structure maps introduced above, is an  ep-groupoid. 

If the ep-groupoid $(X, \bm{X})$ is tame, then also the ep-groupoid $T(X, \bm{X})$ is tame. 
Moreover, the two projections $p:TX\rightarrow X^1$ and $\bm{p}:T\bm{X}\rightarrow \bm{X}^1$ together define a sc-smooth functor
$(p,\bm{p}): T(X,\bm{X})\rightarrow (X,\bm{X})^1$.
\end{theorem}
The  theorem will follow from a series of lemmata.
By definition,  the multiplication map of the 
ep-groupoid $(X, \bm{X})$,
$$m: \bm{X}{_{s}\times_t}\bm{X}\to \bm{X},\quad m(\psi, \phi)=\psi\circ \phi,$$
where $s(\psi)=t(\phi)$, is a sc-smooth map and we can pass to its tangent map 
$Tm$. To derive a formula for $Tm$ we recall that  $\bm{X}{_{s}\times_t}\bm{X}$ is a sub-M-polyfold of $\bm{X}\times \bm{X}$ so that the tangent space $T(\bm{X}{_{s}\times_t}\bm{X})$ can be identified
with a sub-M-polyfold of $T\bm{X}\times T\bm{X}$ by the identification
$$T(\bm{X}{_{s}\times_t}\bm{X})
=T\bm{X}{_{Ts}\times_{Tt}}T\bm{X},$$
so that  
$Ts(\psi )(k)=Tt(\phi)(h)$ for 
$(\psi, k), (\phi, h)\in T(\bm{X}{_{s}\times_t}\bm{X}).$


\begin{lemma}\label{multiplication}
If $m$ is the multiplication  of isomorphisms in $\bm{X}$, then the multiplication of morphisms 
in $T\bm{X}$, defined in \eqref{kaufmann}, 
can be written as 
$$(\psi, k)\circ (\phi, h)=Tm(\psi, \phi)(k, h)=
\bigl(\psi\circ \phi, Ts(\psi\circ\phi))^{-1}\circ Ts(\phi)(h) \bigr),
$$
keeping in mind that $k=Ts(\psi)^{-1}(Tt(\phi)(h)).$
\end{lemma}
\begin{proof}
In order to derive a formula for $Tm(\psi,\phi)(k, h)$ for $k\in T_\psi \bm{X}$ and $h\in T_\phi \bm{X}$, we vary $\phi'$ in a neighborhood $\bm{U} (\phi)\subset \bm{X}$ and $\psi'$ in a neighborhood $\bm{U} (\psi)\subset \bm{X}$ where $\phi'$ and $\psi'$ are restricted by $s(\psi')=t(\phi')$. Therefore, $\psi'$ is the function $F$ of $\phi'$ defined  by 
$$\psi'=F (\phi')=\bigl(s\vert \bm{U} (\psi )\bigr)^{-1}(t(\phi')).$$
Thus the multiplication becomes
$$m(\psi', \phi')=m\bigl(\bigl(s\vert \bm{U} (\psi )\bigr)^{-1}(t(\phi')), \phi'\bigr).$$
Applying the (restricted) source map leads to the identity 
$$\bigl(s\vert \bm{U} (\phi \circ \psi)\bigr)\circ m\bigl(\bigl(s\vert \bm{U} (\psi )\bigr)^{-1}(t(\phi')), \phi'\bigr)=s(\phi').$$

Differentiating  the identity at  $\phi\in \bm{X}_1$ in the direction $h\in T_\phi\bm{X}$,  we obtain
$$
Ts(\psi\circ\phi)\bigl((Tm(T(s\vert \bm{U} (\psi))^{-1}(Tt(\phi)(h)\bigr),h)=Ts(\phi)(h).
$$
Hence, again using that $s$ is a local sc-diffeomorphism,
$$
Tm\bigl((T(s|U(\psi))^{-1}(Tt(\phi)(h)\bigr),h)= (Ts(\psi\circ\phi))^{-1}\circ Ts(\phi)(h).
$$
Recalling  $Ts(\psi)(k)=Tt(\phi)(h)$ we finally obtain
$$
Tm(k,h)=(Ts(\psi\circ\phi))^{-1}\circ Ts(\phi)(h).
$$
and the lemma follows.
\qed \end{proof}

We abbreviate the morphisms in $T\bm{X}$ as $\Phi=(\phi,h)$ and $\Psi=(\psi, k)$.
\begin{lemma}\label{lemma1.54}
The definitions of $s_{TX}$ and $t_{TX}$ are compatible with the composition, i.e.,
$$
s_{TX}(\Psi\circ\Phi)=s_{TX}(\Phi)\ \text{and}\ t_{TX}(\Psi\circ\Phi)=t_{TX}(\Psi).
$$
\end{lemma}
\begin{proof}
Using the definitions \eqref{source-target_TX_1} and \eqref{kaufmann}, we compute
\begin{equation*}
\begin{split}
s_{TX}((\psi,k)\circ (\phi,h))=
&=Ts(\psi\circ\phi)(T(s(\psi\circ\phi))^{-1}(Ts(\phi)(h)))\\
&=Ts(\phi)(h)\\
&=s_{TX}(\phi,h).
\end{split}
\end{equation*}
We have verified that $s_{TX}(\Psi\circ \Phi)=s_{TX}(\phi).$ In order to verify the formula for $t_{TX}$ we 
fix suitable open neighborhoods $\bm{U} (\psi\circ\phi)$ and $U(x)$ and $U(y)$ with $x=s(\phi)$ and $y=t(\psi)$
so that $t: \bm{U}(\psi\circ\phi)\rightarrow U(y)$ and $: \bm{U}(\psi\circ \phi)\rightarrow U(x)$ are sc-diffeomorphisms.
We define the map $\alpha$ by $\alpha(b)=t\circ (s\vert \bm{U} (\psi\circ\phi))^{-1}(b)$.  Then taking the tangent of $\alpha$ at $s(\phi)$ gives
$$
T\alpha(s(\phi)) = Tt(\psi\circ\phi)\circ (Ts(\psi\circ\phi))^{-1}(s(\phi)).
$$
Now we consider for $\phi'$ near $\phi$ the map
$$
\phi'\mapsto  \alpha\circ s(\phi').
$$
In view of $s(\psi\circ \phi )=s(\phi)$ and 
$t(\psi\circ \phi )=t(\psi)$ we have the identity
\begin{equation*}
\begin{split}
\alpha(s(\phi')) &=t\circ (s\vert \bm{U} (\psi\circ\phi))^{-1}(s(\phi'))\\
&= t\circ (s\vert \bm{U} (\psi))^{-1}(t(\phi')).
\end{split}
\end{equation*}
Therefore,  taking the derivative at $\phi'=\phi$, we obtain
$$
T(\alpha\circ s)(\phi)(h) = Tt(\psi)(T((s|U(\psi))^{-1}(t(\phi))(Tt(\phi)h)).
$$
Using  the definition \eqref{source-target_TX} %
and recalling $Ts(\psi)(k)=Tt)\phi )(h)$, we compute,
\begin{equation*}
\begin{split}
t_{TX}((\psi,k)\circ (\phi,h))
&=Tt(\psi\circ\phi)((Ts(\psi\circ\phi))^{-1}(Ts(\phi)(h)))\\
&=T\alpha(s(\phi))((Ts(\phi)(h))\\
&=T(\alpha\circ s)(\phi)(h)\\
&=Tt(\psi)(T(s\vert \bm{U} (\psi)))^{-1}Tt(\phi)(h)\\
&=Tt(\psi)(T(s\vert \bm{U} (\psi)))^{-1}Ts(\psi)(k)\\
&=Tt(\psi)(k)\\
&=t_{TX}(\psi,k),
\end{split}
\end{equation*}
as claimed in Lemma \ref{lemma1.54}.
\qed \end{proof}
\begin{lemma}
The composition of morphisms in  $T\bm{X}$  is associative. 
\end{lemma}
\begin{proof}
Assuming that the corresponding sources and targets match we compute,
\begin{equation*}
\begin{split}
&\phantom{=;;}(\sigma,l)\circ ((\psi,k)\circ(\phi,h))\\
&=(\sigma,l)\circ (\psi\circ\phi,(Ts(\psi\circ\phi))^{-1}Ts(\phi)(h))\\
&=(\sigma\circ\psi\circ\phi, (Ts(\sigma\circ\psi\circ\phi))^{-1}Ts(\psi\circ \phi)(Ts(\psi\circ\phi))^{-1}Ts(\phi)(h))\\
&=(\sigma\circ\psi\circ\phi, (Ts(\sigma\circ\psi\circ\phi))^{-1}Ts(\phi)(h))\\
&=(\sigma\circ\psi,(Ts(\sigma\circ\psi))^{-1}Ts(\psi)(k))\circ(\phi,h)\\
&=((\sigma,l)\circ(\psi,k))\circ(\phi,h).
\end{split}
\end{equation*}
\qed \end{proof}

\begin{lemma}\label{lemma1_58}
The $1$-morphism associated with the object $q\in T_xX$, defined as 
$$
1_q=(1_x, Ts(1_x)^{-1}q)\in T_{1_x}\bm{X},
$$
is a $2$-sided identity for the composition.
\end{lemma}
\begin{proof}
We first  observe that  $1_q$ is a $1$-morphisms. Indeed, 
$$
s_{TX}(1_q)=Ts(1_x)(Ts(1_x)^{-1}q)=q\quad  \text{and}\quad  t_{TX}(1_q)=Tt(1_x)((Ts(1_x))^{-1}(q))=q.
$$
In the last equation we have used that 
$t(1_b)=b=s(1_b)$ for all $b\in X$, and therefore, since $t$ and $s\colon \bm{X}\to X$ are local sc-diffeomorphisms, we have the identity $t\circ (s\vert \bm{U} (1_x))^{-1}(b)=b$ for all $b$ near $x$, and by the chain rule
$Tt(s^{-1}(b))\circ Ts(s^{-1}(b))^{-1}=1$, so that $Tt(1_x)\circ Ts(1_x)^{-1}=1$ at $b=x$.


Next we assume that the morphism
 $(\phi,k)$ satisfies  $s_{TX}(\phi,k)=t_{TX}(1_q)$ which is equivalent to  $Ts(\phi)(k)=Tt(1_x)\circ Ts(1_x)^{-1}(q)=q$. Then 
\begin{equation*}
\begin{split}
(\phi, k)\circ 1_q&=(\phi,k)\circ(1_x,Ts(1_x)^{-1}q)\\
&=(\phi\circ 1_x, Ts(\phi)^{-1}Ts(1_x)Ts(1_x)^{-1}q)\\
&=(\phi, Ts(\phi)^{-1}(q))=(\phi,k).
\end{split}
\end{equation*}
If $(\phi,k)$ satisfies $t(\phi)=x$ and $t_{TX}(\phi,k)=s_{TX}(1_q)$,  which is equivalent to  $Tt(\phi)(k)=q$, we obtain
\begin{equation*}
1_q\circ (\phi,k)=(\phi, Ts(\phi)^{-1}(Ts(\phi)(k)))=(\phi,k),
\end{equation*}
as claimed. 
\qed \end{proof}
\begin{lemma}\label{lemma1_59}
The inverse morphism $\iota_{TX}$  of the morphism $(\phi, k)\in T\bm{X}$, as defined by 
$$
\iota_{TX}(\phi,k) = (\phi^{-1}, T\iota_X(\phi)(k)),
$$
is a $2$-sided inverse for the composition.
\end{lemma}
\begin{proof}
We first verify that $\iota_{TX}(\phi,k)$ is an 
inverse morphism of $(\phi, k)$. Indeed, from the identities $s(\phi^{-1})=t(\phi)$ and 
$t(\phi^{-1})=s(\phi)$ for $\phi\in \bm{X}$ 
we obtain by the chain rule $Ts(\phi^{-1})\circ T\iota_X (\phi)=Tt(\phi)$ and 
$Tt(\phi^{-1})\circ T\iota_X (\phi)=Ts(\phi)$. 
Consequently, 
$$
s_{TX}(\iota_{TX}(\phi,k))=Ts(\phi^{-1})(T\iota_{X}(\phi)(k))=Tt(\phi)(k)=t_{TX}(\phi,k)
$$
and
$$
t_{TX}(\iota_{TX}(\phi,k))=Tt(\phi^{-1})(T\iota(\phi)(k))=Ts(\phi)(k)=s_{TX}(\phi,k).
$$
For a given morphism $(\phi,k)\in T_\phi \bm{X}$  satisfying  $x=s(\phi)$ we compute, 
\begin{equation*}
\begin{split}
\iota_{TX}(\phi,k)\circ (\phi,k)
&=(\phi^{-1},T\iota_X(\phi)k)\circ(\phi,k)\\
&=(1_x,(Ts(1_x))^{-1}Ts(\phi)k)\\
&= 1_{Ts(\phi)k}.
\end{split}
\end{equation*}
The composition from the right is verified the same way and we have proved that  $\iota_{TX}$ is the $2$-sided inverse for the composition.
\qed \end{proof}

Next we prove the differential geometric properties for the category $TX$ consisting of the object set $TX$ and the morphism set $T\bm{X}$.

\begin{lemma}
For the category with object M-polyfold  $TX$  and morphism M-polyfold $T\bm{X}$ the source and target maps $s_{TX}$ and $t_{TX}$
are surjective local sc-diffeomorphisms and all structure maps are sc-smooth.
\end{lemma}
\begin{proof}
By construction,  $s_{TX}$ and $t_{TX}$ are  local sc-diffeomorphisms. The $1$-map $TX\rightarrow T\bm{X}$ associates with  $q\in T_xX$
the pair $1_q=(1_x,(Ts(1_x))^{-1}(q))$, which sc-smoothly depends on $q$. The inversion map $T\bm{X}\rightarrow T\bm{X}$
is the tangent map of  the sc-smooth inversion map $\bm{X}\rightarrow \bm{X}:\phi\rightarrow \phi^{-1}$ and therefore a sc-diffeomorphism.
Due to the properties of $s_{TX}$ and $t_{TX}$ the fibered product $T\bm{X}{_{s_{TX}}\times_{t_{TX}}}T\bm{X}$ is a M-polyfold. The multiplication map
is given by
$$
T\bm{X}{_{s_{TX}}\times_{t_{TX}}}T\bm{X}\rightarrow T\bm{X}: ((\psi,k),(\phi,h))\mapsto (\psi\circ \phi, (Ts(\psi\circ\phi))^{-1} Ts(\phi)(h)).
$$
which is sc-smooth by inspection. One can also view this  as follows. The tangent space of $\bm{X}{_{s}\times_t}\bm{X}$
can naturally be identified with $T\bm{X}{_{s_{TX}}\times_{t_{TX}}}T\bm{X}$ and our multiplication map $m_{TX}$ is precisely $Tm$, where
$m$ is the multiplication for the original ep-groupoid which  is sc-smooth. This completes the proof of the lemma.
\qed \end{proof}
In order to verify  that $(TX,T\bm{X})$ is an ep-groupoid we still need to confirm  the properness property.
\begin{lemma}
If  $(X,\bm{X})$ be an ep-groupoid, then $(TX,T\bm{X})$ has the properness property. 
\end{lemma}
\begin{proof}
Let $x\in X_1$ and take an open neighborhood $V(x)$ in $X$ such  that 
\begin{equation}\label{pol_proper_x}
t:s^{-1}(\cl_X(V(x)))\rightarrow X\ \text{is proper. }
\end{equation}
In order to show that the map 
\begin{equation}\label{pol_proper}
t_{TX}:s^{-1}(\cl_{TX}(TV))\rightarrow TX
\end{equation}
is proper, we may assume that we have a sequence of morphisms $((\phi_k,h_k))\subset T\bm{X}$ satisfying  $s_{TX}(\phi_k,h_k)\in \cl_{TX}(TV)$ and $(t(\phi_k,h_k))$
lying in a compact subset $K\subset TX$.  Due to the latter, after perhaps taking a subsequence, we may assume  the convergence 
$$
t(\phi_k,h_k)=Ts(\phi_k)(h_k)\rightarrow q\in T_xX.
$$
We note that 
\begin{equation}\label{pol_proper_t}
t(\phi_k)=:x_k\rightarrow x\quad \text{in\ $  X_1$},
\end{equation}
and,    moreover,  
\begin{equation}
t(\phi_k)\rightarrow x\quad \text{in\  $  X_0$.}
\end{equation}
Since $s(\phi_k)\in \cl_X(V)$,  we deduce from the properness in (\ref{pol_proper_x}) that
\begin{equation*}
\phi_k\rightarrow \phi\quad  \text{in\ ${\bf  X}$.}
\end{equation*}
Because $t$ is a sc-diffeomorphism between suitable open neighborhoods of $\phi$ and $x$, the convergence of $(x_k)$ in \eqref{pol_proper_t}
implies the stronger convergence
$$
\phi_k\rightarrow \phi\ \text{in}\ \bm{X}_1.
$$
At this point we know about our sequence $((\phi_k,h_k))$ that $\phi_k\rightarrow \phi$ in $\bm{X}_1$ and $Ts(\phi_k)(h_k)\rightarrow q\in T_xX$ in $TX$.
We take  open neighborhoods $\bm{U}(\phi)\subset \bm{X}$ and $U(x)\subset X$ such  that $s:\bm{U}(\phi)\rightarrow U(x)$ is a sc-diffeomorphism.
Then $Ts\colon T\bm{U}(\phi)\rightarrow TU(x)$ is a sc-diffeomorphism. Since for large $k$ we have $(\phi_k,h_k)\in T\bm{U}(\phi)$ and  the sequence $Ts(\phi_k,h_k)=q_k$ converges,
the same is  true for $(\phi_k,h_k)$. Hence $(\phi_k,h_k)\rightarrow (\phi,h)$ in $T\bm{X}$.  This completes the proof of the properness.
\qed \end{proof}

So far we have proved that the small category $(TX, T\bm{X})$ is an ep-groupoid, 
if $(X, \bm{X})$ is an ep-groupoid. 

\begin{lemma}\label{lemma1_62}
If the ep-groupoid $(X, \bm{X})$ is tame, so is the ep-groupoid $(TX, T\bm{X})$. 
\end{lemma}
\begin{proof}
If $\varphi\colon U\to O$, $O=(O, C, E)$, is a tame chart of the object $M$-polyfold $X$ of $(X, \bm{X})$ and $O=r(U)\subset C$ is a tame retract, then also $Tr\colon TU\to TU$ is a tame retraction. It follows that if $(X, \bm{X})$ has a tame object space, then also $(TX, T\bm{X})$ has a tame object space and hence is, by definition, a tame ep-groupoid. 

\qed \end{proof}

\begin{proof}[Proof of Theorem \ref{main_KK}]
The category $(TX, T\bm{X})$ is in  view of Lemmata \ref{multiplication} - \ref{lemma1_62} 
   a (tame) ep-groupoid, if $(X, \bm{X})$ is a (tame) ep-groupoid. The last statement about the projections being functors just says that if $$
   (\phi,h)\colon Ts(\phi)(h)\rightarrow Tt(\phi)(h),
   $$
then $\bm{p}(\phi,h)=\phi:s(\phi)\rightarrow t(\phi)$ is a morphism compatible with composition.
This  is obvious. The proof of Theorem \ref{main_KK} is complete.
\qed \end{proof}
There are equivalent ways to  equip  the tangent  $(TX, T\bm{X})$ of the ep-groupoid 
with a ep-groupoid structures.
We discuss another possibility in the following remark.
\begin{remark}\index{R- $TX$ as ep-groupoid}
The above definition of $TX$ as an ep-groupoid makes precise in which way we  view the elements in
$T\bm{X}$ as morphisms. There are equivalent ways to turn $TX$ into an ep-groupoid. Recall that a morphism
$\phi:x\rightarrow y$ for $x\in X_1$ (equivalently $y\in X_1$) has a well-defined associated linear isomorphism
$T\phi:T_xX\rightarrow T_yY$. Here $T\phi$ is defined as the tangent map  of $t\circ (s|U(\phi))^{-1}$ at $x$.
One interprets the fact that if $T\phi$ maps $h\in T_xX$ to $k\in T_yY$ as having a morphism $(T\phi,h)$ with
$s(T\phi,h)=h$ and $t(T\phi,h)=T\phi(h)$. The composition  $(T\psi,h)\circ (T\phi,l)$ should be defined,  
provided $h=T\phi(l)$, as follows, 
$$
(T\psi,h)\circ (T\phi,l)=(T\psi\circ T\phi,l)=(T(\psi\circ\phi), l).
$$
We note that this new definition and the previous one are equivalent  by means of the mapping
$$
G: (\phi,h)\rightarrow (T\phi,Ts(h)).
$$
Indeed, $G$ is compatible with the functorial structures. For example, if  $Tt(\phi)(k)=Ts(\psi)(h)$, 
\begin{equation*}
\begin{split}
G((\psi,h)\circ(\phi,k))
&=(T(\psi\circ\phi),Ts((Ts(\psi\circ\phi))^{-1}(Ts(\phi)(k))))\\
&=(T(\psi\circ\phi),Ts(\phi)(k))\\
&=(T\psi\circ T\phi,Ts(\phi)(k))\\
&=(T\psi,T\phi(Ts(\phi)(k)))\circ (T\phi,Ts(\phi)(k))\\
&=(T\psi,Tt(\phi)(k))\circ(T\phi,Ts(\phi)(k))\\
&=(T\psi,Ts(\psi)(h))\circ(T\phi,Ts(\phi)(k))\\
&=G(\psi,h)\circ G(\phi,k).
\end{split}
\end{equation*}

In the latter description the object space is $TX$ as before , but the morphisms are the pairs $(T\phi,h)$, where $\phi\in \bm{X}_1$
and  $h\in T_{s(\phi)}X$.  The map 
$$
G: T\bm{X}\rightarrow \{(T\phi,a)\ |\ \phi\in \bm{X}_1,\ a\in T_{s(\phi)}X\}, 
$$
is a bijection and we can equip the right-hand side with a M-polyfold structure such that 
$G$ becomes a sc-diffeomorphism. Of course we can identify the pairs $(T\phi,a)$
with the triplets  $(a,T\phi,b)$, where $b=T\phi(a)$. This gives another description of the morphism set.
Some further remarks are in order.  For  $\phi\in \bm{X}_1$ we abbreviate  $x=s(\phi)$ and $y=t(\phi)$ in $X_1$.
The linear isomorphism
$$
Tt(\phi)\circ Ts(\phi)^{-1}:T_xX\rightarrow T_yX.
$$
is  the linearization of $t\circ (s|U(\phi))^{-1}$ at $\phi$ and therefore,  by definition,  equal to $T\phi$. 
Using the definitions of $s_{TX}$ and $t_{TX}$,  we find that
$$
t_{TX}\circ (s_{TX}|T_xX)^{-1} = T\phi \colon T_xX\rightarrow T_yX
$$
 is a linear isomorphism. 
\end{remark}\qed


At this point we have constructed the tangent for the ep-groupoids, but not yet for the sc-smooth functors between them. 

\begin{theorem}\label{theorem1.63}\index{T- Tangent of functors}
If $(\Phi, \bm{\Phi})\colon (X, \bm{X})\rightarrow (Y, \bm{Y})$ is  a sc-smooth functor between two ep-group\-oids, then the tangent map 
$$
(T\Phi,T\bm{\Phi})\colon T(X,\bm{X})\rightarrow T(Y,\bm{Y})
$$
is a sc-smooth functor between the corresponding tangents of the ep-group\-oids.
\end{theorem}
\begin{proof}
Clearly, since $\Phi:X\rightarrow Y$ and $\Phi:\bm{X}\rightarrow \bm{Y}$ are sc-smooth maps, it follows
that the tangent maps $T\Phi:TX\rightarrow TY$ and $T\Phi:T\bm{X}\rightarrow T\bm{Y}$ are sc-smooth.  Let us consider the compatibility with 
the composition we have defined for the elements in $T\bm{X}$ and $T\bm{Y}$, respectively.
The functoriality of $\Phi$ requires that 
$$
\Phi\times\Phi:\bm{X}\times \bm{X}\rightarrow \bm{Y}\times \bm{Y}
$$
preserves the fibered products on which the multiplications  are  defined. Consequently,  
if  $(\psi,\phi)\in \bm{X}{_{s}\times_t}\bm{X}$,  then 
$$
\Phi(m_X(\psi,\phi))=m_Y(\Phi(\psi),\Phi(\phi)).
$$
Differentiating with respect to the pair  $(\psi,\phi)\in \bm{X}{_{s}\times_t}\bm{X}$ in the direction $(k,h)\in T\bm{X}{_{Ts}\times_{Tt}}T\bm{X}$
we obtain
$$
T\Phi\circ Tm_X(k,h)= Tm_Y(T\Phi(k),T\Phi(h)).
$$
Therefore, by  Lemma \ref{multiplication},
$$
T\Phi(\psi\circ\phi)(k\circ h) = (T\Phi(\psi)(k))\circ (T\Phi(\phi)(h)),
$$
which is the desired result. To verify  that $T\Phi$ preserves the units,  is left to the reader.

For the  morphisms  $\alpha$ we have the identities
$$
s(\Phi(\alpha))=\Phi(s(\alpha))\ \text{and}\ \ t(\Phi(\alpha))=\Phi(t(\alpha)).
$$
We differentiate at $\alpha_0\in \bm{X}_1$ in the direction $p\in T_{\alpha_0}\bm{X}$ and obtain, setting  $x_0=s(\alpha_0)$ and $x_0'=t(\alpha_0)$, 
\begin{align*}
s_{TY}(T\Phi(\alpha_0)(p))&=T\Phi(x_0)(s_{TX}(p))\\
t_{TY}(T\Phi(\alpha_0)(p))&=T\Phi(x_0')(t_{TX}(p)).
\end{align*}
In other words,  if $h\in T_{x_0}X$ and $k\in T_{x_0'}X$ are objects with a morphism
$(\phi,p)$ between them, i.e. $p\in T_\phi\bm{X}$  satisfying $Ts_X(p)=h$ and $Tt_X(p)=k$, then
$T\Phi(\phi)(p)$ is the corresponding morphism $T\Phi(x_0)(h)\rightarrow T\Phi(x_0')(k)$.
\qed \end{proof}





Recalling  the {\bf category 
$\mathcal{EP}$}  whose class of objects 
are the ep-groupoids and whose morphisms are the sc-smooth functors between the ep-groupoids, we can sum up the previous discussion in the following theorem.



\begin{theorem}[{\bf Functoriality property of $T$ on ep-groupoids}]\label{Walter_xx}\index{T- Functoriality of $T$ on ep-groupoids}
The tangent functor $T$ gives rise to a functor 
$$T\colon \mathcal{EP}\to \mathcal{EP}$$
associating with  an ep-groupoid $X$ its tangent $TX$ and with  a smooth functor $\Phi:X\rightarrow Y$ the tangent functor $T\Phi$.  In particular,  $T\Phi$ preserves the composition and the other structure maps. Furthermore,  $T$ preserves tameness; if $X$ is a tame ep-groupoid so is $TX$.
\qed
\end{theorem}

Finally we shall show that  the tangent functors are compatible with natural transformations.
\begin{definition}[{\bf Natural transformation, natural equivalence}]\label{natural_transf_def}\index{D- Natural transformation}\index{Natural equivalence}
If  
$$
F\colon  X \to Y\ \ \text{and}\ \  G\colon  X \to Y
$$
 are two sc-smooth functors  between the ep-
groupoids $X$ and $Y$, then  $F$  is  called {\bf naturally equivalent} to $G$ and denoted by $F\simeq G$,  if there exists a sc-smooth map
$\tau \colon X\to \bm{Y}$  which associates with every object $x\in X$   a morphism 
$$\tau (x)\colon F(x)\to G(x)$$ 
in $\bm{Y}$ such that 
$$\tau (x')\circ \bm{F}(h)=\bm{G}(h)\circ \tau (x)
$$
for every morphism $h\colon x\to x'$ in $\bm{X}$, i.e.,  
the diagram of morphisms 
$$
\begin{CD}
F(x)@>\tau(x)>> G(x)\\
@VV \bm{F}(h )V  @VV \bm{G}(h)V\\
F(x')@>\tau(x')>>G(x')
\end{CD}
$$
commutes for every morphism $h\colon x\to x'$ in $\bm{X}$.

The sc-smooth map $\tau \colon X\to \bm{Y}$ is called a {\bf natural transformation} between the two sc-functors $F, G\colon  X \to Y$ and will be referred to by the formula 
$$\tau: F\to G.$$
\qed
\end{definition}


The relation $F\simeq G$  between sc-smooth functors $F, G\colon  X \to Y$ of ep-groupoids is an equivalence relation.

\begin{proposition}\label{169}\index{P- Tangent of a natural transformation}
If $\tau : \Phi\rightarrow \Psi$  is a natural transformation  between the two sc-smooth functors 
$$\Phi,\Psi\colon X= (X, \bm{X})\rightarrow Y=(Y, \bm{Y})$$  between ep-groupoids, then 
the tangent  $T\tau\colon TX\rightarrow T\bm{Y}$
is a natural transformation 
$T\tau : T\Phi\rightarrow T\Psi$ between the two tangent functors 
$$
T\Phi, T\Psi\colon (TX, T\bm{X})\to (TY, T\bm{Y}).
$$ 
\end{proposition}
\begin{proof}
If $x\in X$, then 
$\tau (x)\colon \Phi(x)\rightarrow\Psi(x)$ is a morphism in $\bm{Y}$. We note that $s(\tau(x))=\Phi(x)$ and $t(\tau(x))=\Psi(x)$.
Differentiating $\Phi(x)=s(\tau(x))$ and $\Psi(x)=t(\tau(x))$ at $x=x_0\in X_1$ yields,  with $\psi_0=\tau(x_0)$, 
$$
T\Phi(x_0)(h) =Ts(\psi_0)(T\tau(x_0)(h))\ \text{and}\ \ T\Psi(x_0)(h)=Tt(\psi_0)(T\tau(x_0(h)).
$$
Consequently,  $s_{TY}(T\tau(x_0)(h))= T\Phi(x_0)(h)$ and $t_{TY}(T\tau(x_0)(h))=T\Psi(x_0)(h)$.  By definition of the morphisms
in $T\bm{Y}$ we have the morphism 
$$
T\tau(x_0)(h):T\Phi(x_0)(h)\rightarrow T\Psi(x_0)(h).
$$
Since $\tau$ is a natural transformation,  the diagram
$$
\begin{CD}
\Phi(x)@>\tau(x)>> \Psi(x)\\
@VV\Phi(\alpha )V  @VV\Psi(\alpha)V\\
\Phi(x')@>\tau(x')>>\Psi(x')
\end{CD}
$$
commutes for all morphisms $\alpha\colon x\to x'$. 
We  differentiate the relationship defined  by the diagram as follows. We fix $x_0, x_0'\in X_1$ and the morphism $\alpha_0\colon x_0\rightarrow x_0'$.
The latter then also belongs to level $1$. For the morphisms $\alpha$ near $\alpha_0$ on level $0$ we obtain the commuting diagrams
$$
\begin{CD}
\Phi(s(\alpha))@>\tau(s(\alpha))>> \Psi(s(\alpha))\\
@VV\Phi(\alpha )V  @VV\Psi(\alpha)V\\
\Phi(t(\alpha))@>\tau(t(\alpha))>>\Psi(t(\alpha)).
\end{CD}
$$
We differentiate at $\alpha=\alpha_0$ satisfying $s(\alpha_0)=x_0$ and $t(\alpha_0)=x_0'$ and obtain,  for every  $p\in T_{\alpha_0}\bm{X}$, $h=Ts_X(\alpha_0)p$, and $h'=Tt_X(\alpha_0)p$, the commutative diagram
$$
\begin{CD}
T\Phi(x_0)(h)@>T\tau(x_0)h>>T \Psi(x_0)h\\
@VVT\Phi(\alpha_0 )pV  @VVT\Psi(\alpha_0)p V\\
T\Phi(x_0')h' @>T\tau(x_0)h>>T\Psi(x_0')h'.
\end{CD}
$$

Recalling  that  $T\Phi(\alpha_0)p$ is the morphism $T\Phi(x_0)h\rightarrow T\Phi(x_0')h'$ in $T\bm{Y}$ and similarly for $\Psi$, the diagram
above  shows that the tangent map $T\tau: TX\rightarrow T\bm{Y}$, $(\phi,h)\mapsto  T\tau(x_0)(h)$ is a natural transformation $T\tau : T\Phi \to T\Psi$.
This completes the proof of Proposition \ref{169}.
\qed \end{proof}

If $X$ is an ep-groupoid with paracompact orbit space $|X|$  we have seen that $|X|$ is metrizable.  The tangent $TX$ of an ep-groupoid is also an ep-groupoid
as we have seen in Theorem \ref{main_KK}. As we shall show now the paracompactness of $|X|$ is inherited by $|TX|$.
\begin{theorem}\label{paraXCV} \index{T- Inherited paracompactness of $\abs{TX}$}
If $X$ is an ep-groupoid with paracompact orbit space $|X|$, then the tangent ep-groupoid $TX$  has a parcompact orbit space $|TX|$ as well.
\end{theorem} 
\begin{proof}
By assumption $|X|$ is paracompact and the same holds for the ep-groupoid $X^1$, i.e. $|X^1|$ is paracompact.
For every point $z\in |X^1|$ take a representative $x_z\in X^1$ and pick an open neighborhood $U(x_z)$ in $X$ with the natural $G_{x_z}$-action  so that 
$TU(x_z)$ is as a bundle over $U(x_z)^1$ sc-isomorphic to some local bundle model $TO\rightarrow O^1$, which also is equipped with an sc-smooth bundle action by $G_{x_z}$. 
Then $|TU(x_z)|$ and $|U(x_z)^1|$ are metrizable. The collection of sets ${(|U(x_z)^1|)}_{z\in |X^1|}$ is an open covering of $|X^1|$ and we can find a subordinate 
locally finite closed subcover denoted by ${(A_z)}_{z\in\Sigma}$, where $\Sigma\subset |X^1|$ consists of those points for which $A_z\neq \emptyset$. 
For $z\in\Sigma$ we find a  $G_{x_z}$-invariant closed subset of $U(x_z)^1$ and take the restriction of $TU(x_z)$ to this subset.
This defines, after dividing out by the $G_{x_z}$ a closed subset $\wt{A}_z$ of $|TX|$ which is closed and paracompact. Moreover
${(\wt{A}_z)}_{z\in\Sigma}$ is a locally finite covering of $|TX|$ by closed paracompact sets. Since as an ep-groupoid $|TX|$ is a regular Hausdorff space, it follows
that $|TX|$ is paracompact in view of the topological Proposition \ref{union_of_paracompact}. This completes the proof.
\qed \end{proof}

\section{Sc-Differential Forms on Ep-Groupoids}\label{SECT82}
Next we introduce the notion of a sc-differential form in the ep-groupoid context. It will be studied in later sections in more detail.
The notion has been already introduced in the context of M-polyfolds in Section \ref{subs_sc_differential}.
 \begin{definition}\index{D- Sc-Differential form}
 A {\bf sc-differential k-form on the ep-groupoid} \index{sc-differential k-form on the ep-groupoid}  $(X, \bm{X})$ is a  sc-smooth map $\omega:\oplus_k TX\rightarrow {\mathbb R}$ defined on the Whitney sum
 of the tangent of the object M-polyfold, which is
 linear in each argument and skew-symmetric,  and, moreover, possesses  the additional property that for every morphism $\phi: x\rightarrow y$ in $\bm{X}_1$, and its associated tangent $T\phi:T_xX\rightarrow T_yY$ it holds that 
 $$
 (T\phi)^\ast\omega_y=\omega_x.
 $$
\qed
 \end{definition}
   We denote by $\Omega_{ep}^k(X)$\index{$\Omega_{ep}^k(X)$} the vector space of sc-differential $k$-forms compatible with morphisms.
  If $\omega $ is a sc-differential form on $X^i$, then  $\omega$  will also be a differential form on $X^{i+1}$.  We can take the direct limit
 of the directed system
$$
\iota_{i,k}:\Omega^\ast_{ep}(X^i)\rightarrow\Omega^\ast_{ep}(X^{k})
 $$
 with $i\leq k$, induced by the pull-back via inclusions
 and obtain $\Omega^{\ast}_{ep,\infty}(X)$\index{$\Omega^{\ast}_{ep,\infty}(X)$}. With ${\mathbb N}=\{0,1,2,\ldots \}$,  the latter is defined by
 $$
 \Omega^{\ast}_{ep,\infty}(X)=\left(\bigoplus_{i\in {\mathbb N}} \Omega^\ast_{ep}(X^i)\right)/ D,
 $$
 where $D$ is the vector subspace generated by $\omega_i - \iota_{i, k}(\omega_i)$.
By definition,  the elements $[\omega]$ in  $\Omega^{\ast}_{ep,\infty}(X)$ are equivalence classes and can be represented 
by a differential form $\omega_i$ on $X^i$ for some $i$. Then $\omega_i$ and $\omega_k$ present the same element provided there exists an $l\geq k,i$ 
such  that the pullbacks of $\omega_i$ and $\omega_k$ to $X^l$ are the same.  
We define the exterior derivative of $[\omega]$ by
$$
d[\omega]:=[d\omega],
$$
where $d\omega$ is the exterior derivative of a sc-differential form on the object M-polyfold. 
We claim that 
$d[\omega]\in \Omega^{\ast}_{ep,\infty}(X)$, i.e. $d\omega$ is compatible with morphisms. This can be seen as follows.
  Given a morphism $\phi_0\colon x_0=s(\phi_0)\to y_0=t(\phi_0)\in \bm{X}_1$, we  choose  open neighborhoods $U(x_0)\subset X$ and $\bm{U}(\phi_0)\subset \bm{X}$  such  that $s:\bm{U}(\phi_0)\rightarrow U(x_0)$ and $t:U(\phi_0)\rightarrow U(y_0)$ are sc-diffeomorphisms. Defining the composition 
 $$
 f:U(x_0)\rightarrow U(y_0): x\rightarrow t((s\vert \bm{U}(\phi_0))^{-1}(x)), 
 $$
we note that with $\phi\in U(\phi_0)$, $x=s(\phi)\in U(x_0)\cap X_1$ and $y=t(\phi_0)$ the linear isomorphism
 $T\phi:T_xX\rightarrow T_yX$ is equal to $Tf(x)$.
 Therefore, choosing $x\in U(x_0)\cap X_1$,  we compute for  tangent vectors $h_i\in T_xX$,  $y=f(x)$, and $\phi\in \bm{U}(\phi_0)$ satisfying  $t(\phi)=y$,
 \begin{equation*}
 \begin{split}
(f^\ast\omega)_x(h_1,\ldots ,h_k)
&=\omega_y(Tf(x)h_1,\ldots ,Tf(x)h_k)\\
&=\omega_y(T\phi(h_1),\ldots ,T\phi(h_k))\\
&=\omega_x(h_1,\ldots h_k).
\end{split}
 \end{equation*}
Hence,  on $U(x_0)$, in view of $f^\ast \circ d=d\circ f^\ast$, 
 $$
 f^\ast d\omega = d f^\ast\omega = d\omega, 
 $$
so that the sc-differential form $d\omega$ is indeed compatible with morphisms.  From the properties of $d$ in the M-polyfold context we deduce that $d\circ d=0$.
  \begin{definition}\index{D- Sc de Rham complex}
 Given an ep-groupoid $X$,  we call $(\Omega^\ast_{ep,\infty}(X),d)$ the {\bf sc-de Rham complex} for the ep-groupoid $X$.
 We denote an element in $(\Omega^\ast_{ep,\infty}(X),d)$ again by $\omega$ though,  as an element in a direct limit,  it is rather an equivalence class.
 \qed
 \end{definition}



\section{Strong Bundles over Ep-Groupoids}\label{SST}

In this section we introduce the crucial notion of a strong bundle  over an ep-groupoid. Starting from a strong bundle $P: W\to X$ over the object M-polyfold 
$X$ of the ep-groupoid $(X, \bm{X} )$ we shall introduce the structure map 
$\mu: 
\bm{X}{{_s}\times_{P}}W\equiv \bm{W}\to W$.  Its properties allow to lift 
 the morphisms $\phi\in \bm{X}$ to linear isomorphisms 
 $\mu (\phi,\cdot ): W_{s(\phi)}\to W_{t(\phi)}$ between the corresponding fibers defining the morphisms in $\bm{W}$ between points of $W$ and ultimately leading to the sc-smooth functor $(P,\pi_1): (W,\bm{W})\to (X, \bm{X})$ between two ep-groupoids.
The  strong bundles over M-polyfolds have been introduced in Section \ref{section2.5_sb}.

We consider an ep-groupoid $X=(X, \bm{X})$ and a strong M-polyfold
bundle
$$
P : W\to X,
$$
where $P: W\to X$ is a surjective sc-smooth map between the M-polyfold $W$ onto the M-polyfold $X$ which is the object space of the ep-groupoid $(X, \bm{X})$. The M-polyfold $W$ possesses additional structures.  In particular, the fibers
$$
P^{-1}(x)=W_x
$$
over $x\in X$ carry the structure  of  Banach spaces. If $x\in X$ is a smooth point, the Banach space $W_x$ has a sc-structure.
 Since the source map $s : {\bf
X}\to X$ is by definition a local $\ssc$-diffeomorphism, the fibered product
$$
\bm{X}{{_s}\times_{P}}W=\{(\psi, w)\in \bm{X}\times W\vert \, s(\psi)=P(w)\}
$$
is an M-polyfold, and being viewed as  the pull-back of a strong M-polyfold bundle, is also a strong M-polyfold bundle.
Hence we have the strong bundle
$$
\pi_1:\bm{X}{{_s}\times_{P}}W\rightarrow \bm{X}.
$$
\begin{definition}[{\bf Strong bundle over an ep-groupoid}] \label{strong_bundle_ep}\index{D- Strong bundle over an ep-groupoid}
A strong bundle over the ep-groupoid $X$ is a pair $(P,\mu)$ \index{$(P,\mu)$} in which  $P: W\rightarrow X$ is a strong bundle over the object M-polyfold $X$
and $\mu: \bm{X}{{_{s}}\times_{P}}W\rightarrow W$ a strong bundle map covering the target map $t:\bm{X}\rightarrow X$, such  that the diagram  
\begin{equation*}
\begin{CD}
 \bm{X}{{_{s}}\times_{P}}W@>\mu>>W\\
@V\pi_1VV     @VVP V \\
\bm{X}@>t>> X,\\
\end{CD}
\end{equation*}
is commutative, so that 
$$
P\circ \mu (\psi, w)=t(\psi).
$$
Moreover, $\mu$ satisfies the  following additional 
properties.
\begin{Myitemize}
\item[(1)]\ $\mu$ is a surjective local $\ssc$-diffeomorphism
and linear on the fibers $W_x$.
\item[(2)]\ $\mu(1_x, w)=w$ for  all $x\in X$ and $w\in W_x$.
\item[(3)]\  $\mu (\psi\circ \gamma,  w)=\mu (\psi, \mu (\gamma, w))$
 for  all $\psi,\gamma \in \bm{X}$ and $w\in W$ satisfying  
 $$\text{$s(\gamma)=P(w)$\quad  and \quad $t(\gamma)=s(\psi)=P(\mu (\gamma,w))$.}$$
\end{Myitemize}
\qed
\end{definition}
Given a strong bundle $(P,\mu)$ over the ep-groupoid $X$ it follows, in particular, that
$$
\mu (\psi, \cdot ) : W_x\to W_y
$$
is a linear isomorphism if $\psi : x\to y$ is a morphism in $\bm{X}$.   In fact, the data of a strong bundle over an ep-groupoid  provide
via $\mu$ a prescription how to lift morphisms to linear isomorphisms in a compatible way with compositions.

We shall discuss the above definition now in detail. We shall  show that there is an  equivalent functorial picture in the background
which endows $W$ with morphisms resulting in an ep-groupoid  $(W,\bm{W})$ having  additional structures. In fact we shall obtain a sc-smooth functor 
$(P,\bm{P}): (W,\bm{W})\rightarrow (X,\bm{X})$, where $P$ and $\bm{P}$ are strong bundles.

We abbreviate $\bm{W}=\bm{X}{{_s}\times_{P}}W$. Now we can define the ep-groupoid
$$
W=(W, \bm{W})
$$
in which the object set $W$ is the M-polyfold $W$ we started with, and the morphism set $\bm{W}$ is the above fibered  product $\bm{X}{{_{s}}\times_{P}}W$.
Note, however, that we have more structure. The object set carries the structure of a strong bundle $W\rightarrow X$ and the morphism set
also carries the structure of a strong bundle,  namely  $\bm{W}\rightarrow \bm{X}$. For the following discussion we label the source and target maps
by the spaces they act in.  The source and target maps $s_W, t_W : \bm{W}\to W$ are defined as follows,
\begin{align*}
s_W(\psi, w)&=w\\
t_W(\psi, w)&=\mu (\psi, w)
\end{align*}
for $(\psi, w) \in \bm{X}{{_{s}}\times_{P}}W.$ These maps $s_W$ and $t_W$ are fiberwise linear   local $\ssc_\triangleleft$-diffeo\-morph\-isms covering the source and target maps $s_X,t_X\colon \bm{X}\to X$. Indeed,
\begin{align*}
P\circ s_W(\psi, w)&=P(w)=s_X(\psi)\\
P\circ t_W(\psi, w)&=P\circ \mu(\psi, w)=t_X(\psi).
\end{align*}
The action of a morphism $(\psi, w)\in  \bm{X}{{_{s}}\times_{P}}W$ is illustrated 
by the commutative diagram 
\begin{equation*}
\begin{CD}
s_{W}(\psi, w)@>(\psi, w)>>t_{W}(\psi, w)\\
@VPVV     @VVP V \\
s_{X}(\psi)@>\psi>> t_{X}(\psi).
\end{CD}
\end{equation*}
The orbit of a point $w\in W$ covers the orbit of $P(w)\in X$ and hence $P$ induces 
a surjective continuous map $\abs{P}: \abs{W}\to \abs{X}$ between the orbit spaces.



The identity morphism at $w\in W_x$ is the pair $(1_x, w)$ in $\bm{X}$ and if $\psi : x\to y$ is a morphism in $\bm{X}$, the inverse of the morphism  $(\psi, w)\in \bm{W}$ is the pair $i (\psi, w)=(\psi^{-1}, \mu (\psi, w))$. The multiplication map in $W$ is defined by
$$
(\psi, w')\circ (\gamma, w):=(\psi\circ \gamma, w)
$$
whenever  $w'=\mu (\gamma, w)\in W$.

The two sc-smooth projection maps $P : W\to X$ and $\bm{P}:=\pi_1 : \bm{W}\to \bm{X}$ together define an  sc-smooth functor denoted  by
$$
P=(P, \bm{P}) : W\to X
$$
between the two ep-groupoids $W=(W, \bm{W})$ and $X=(X, \bm{X})$.




As demonstrated above we can use the strong bundle $(P: W\to X, \mu)$ in order to construct additional data which allow to  view a strong bundle over the ep-groupoid $X$ alternatively as
the functor just constructed, which  in expanded notation is given by $(P,\bm{P}):(W,\bm{W})\rightarrow (X,\bm{X})$ with the projection  $\bm{P}:=\pi_1$.
We shall usually just call  $P:W\rightarrow X$ a strong bundle over the ep-groupoid $X$, whenever  the precise knowledge of the `structural'
strong bundle map $\mu$ is not needed.


For most purposes a strong bundle $(P,\mu)$ over the ep-groupoid $X$ should be viewed as a strong bundle over the object M-polyfold $X$, together
with a {\bf lift}\index{Lift of morphism} of the morphisms $\psi:x\rightarrow y$ to the  linear isomorphisms $\mu(\psi,\cdot ):W_x\rightarrow W_y$ satisfying some natural requirements.
For example,  $1_x$ is  lifted to the identity, and the lift associated to a composition is the composition of the lifts.
Moreover, the differential geometric side of things  requires that the data produce sc-smooth strong bundle maps.


Next we introduce the notion of a strong bundle map in the context of ep-groupoids. Again there are two equivalent viewpoints.
If we start with the original definition of strong bundles over ep-groupoids, say $(P,\mu)$ and $(P',\mu')$ then  a strong bundle map between
these two objects can be defined as follows.
\begin{definition}[{\bf Strong bundle map}]\label{def_strong_bundle_map}\index{D- Strong bundle functor}
Let $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow  X',\mu')$ be two strong bundles over ep-groupoids. A {\bf strong bundle map}\index{Strong bundle map}
or {\bf strong bundle functor} between strong bundles over ep-groupoids consists of a strong bundle map $\Phi:W\rightarrow W'$ covering the sc-smooth functor $\varphi\colon X\rightarrow X'$ between ep-groupoids having the  property that
$$
\Phi(\mu(\gamma,w))=\mu'({ \varphi}(\gamma), \Phi(w)),
$$
for all $\gamma\in \bm{X}$ and $w\in W$ satisfying $s(\gamma)=P(w)$.
\qed
\end{definition}
While $\mu$ maps $w\in W_x$ to 
$\mu(\gamma,w)\in W_{t(\gamma)}$ for $\gamma\in \bm{X}$ satisfying  $x=s(\gamma)=P(w)$, 
the strong bundle map $\Phi$ maps $w\in W_x$ to $\Phi(w)\in W_{\varphi(x)}$ and  has to cover the sc-smooth map
$\varphi:X\rightarrow X'$ between the object M-polyfolds. Since $\varphi$ is a functor,  it follows
that the morphism $\gamma\in \bm{X}:s(\gamma)\rightarrow t(\gamma)$ is mapped to the morphism 
${\bm  \varphi}(\gamma): \varphi(s(\gamma))\rightarrow \varphi(t(\gamma))$ in $\bm{X}'$.
Hence the above required  relationship between  $\mu$ and $\mu'$ is well-defined.




There is a more functorial definition if we view $(P,\mu)$ as the functor $(P,\bm{P}):(W,\bm{W})\rightarrow (X,\bm{X})$ and similarly for $(P',\mu')$.
Namely,  given $\Phi$ as in the previous definition we can define the map $\bm{\Phi}:\bm{W}\rightarrow \bm{W}'$ by  
$$
\bm{\Phi}(\gamma,w)=({ \varphi}(\gamma),\Phi(w)) \ \ \text{for}\ \ (\gamma, w)\in \bm{W}=\bm{X}{{_s}\times_{P}}W.
$$
Then $\bm{\Phi}:\bm{W}\rightarrow \bm{W}'$ is a strong bundle map covering the map $\bm{\varphi}:\bm{X}\rightarrow \bm{X}'$ which is the  morphism part of  the functor 
$\varphi\colon X\to X'$ between the ep-groupoids and satisfying 
$$
\mu'\circ\bm{\Phi}(\gamma,w)=\mu'({\varphi}(\gamma),\Phi(w))=\Phi(\mu(\gamma,w))
$$
for $\gamma\in \bm{X}$.
Moreover, 
$$
s_{W'}(\bm{\Phi}(\gamma, w))=\Phi (w)=\Phi (s_{\bm{W}}(\gamma, w)).
$$
Recalling  that in the functorial picture $\mu$ and $\mu'$ are the target maps,
the two displayed equations show that the following diagrams commute 
 \begin{equation*}
  \begin{CD}
 \bm{W}@>\bm{\Phi}>>\bm{W}'\\
 @VsVV @VVsV\\
 W@>\Phi>> W'\\
 \end{CD}
 \qquad \qquad \qquad 
 \begin{CD}
 \bm{W}@>\bm{\Phi}>>\bm{W}'\\
 @VtVV @VVtV\\
 W@>\Phi>> W'.\\
 \end{CD}
 \end{equation*}
 Summarizing, we have ``lifted'' a strong bundle map $\Phi:W\rightarrow W'$ satisfying the requirements of  
Definition \ref{def_strong_bundle_map}  to a functor
 $(W,\bm{W})\rightarrow (W',\bm{W}')$.  The reverse is also true. Namely,  given such a functor covering the functor $\varphi\colon X\rightarrow X'$ between ep-groupoids, which is linear on the fibers, we obtain, using the strong bundle structures,  a strong bundle map $\Phi: W\rightarrow W'$ which has the properties listed in 
 Definition \ref{def_strong_bundle_map}. From the strong bundle map  we can recover the functor completely. Hence we obtain the following equivalent definition.

\begin{definition}\label{LinStBunM-def}\index{D- Strong bundle functor}
 A {\bf strong bundle functor} $\Phi : P\to P'$ between the two strong bundles $P : W\to X$ and $P' : W'\to X'$ over the ep-groupoids  $X$ and $X'$ consists of a functor $\Phi : W=(W, \bm{W})\to W'=(W', \bm{W}')$ between ep-groupoids which is linear on the fibers and which covers a sc-smooth functor 
 $(\varphi, {\bm  \varphi}) : 
 (X, \bm{X})\to (X', \bm{X}')$ between the bases. Moreover, the functor $\Phi$ induces strong bundle maps $\Phi : W\to W'$ and $\Phi : \bm{W}\to \bm{W}'$ between the object sets and morphism sets such that the diagram
\begin{equation*}
\begin{CD}
W@>\Phi>>W'\\
@VPVV     @VVP' V \\
X@>\varphi>> X' \\
\end{CD}
\end{equation*}
commutes.
\mbox{}\\[1ex]
\qed
\end{definition}

 In the following we shall either refer to a {\bf strong bundle map} between strong bundles over ep-groupoids if we appeal to the first definition,
or we shall refer to a {\bf strong bundle functor} if we use the second definition. In any case these are identical  notions.
For most purposes, however, the first view point is the most convenient one.
Namely,  if $W\rightarrow X$ and $W'\rightarrow X'$ are strong bundles over ep-groupoids
with respective structure maps $\mu$ and $\mu'$, then a strong bundle functor $\Phi$ is given by the following data. 
A sc-smooth functor $(\varphi,\bm{\varphi}):(X,\bm{X})\rightarrow (X',{\bf X'})$ between ep-groupoids 
and a strong bundle map $\Phi: W\rightarrow W'$
covering  $\varphi:X\rightarrow X'$, which is compatible with the structure maps in the sense that 
\begin{equation}\label{equation_section_functor}
\mu'(\varphi(\gamma),\Phi(w)) =\Phi(\mu(\gamma,w))
\end{equation}
for all $w\in W$ and $\gamma\in \bm{X}$ satisfying $s(\gamma)=P(w)$.


Having a strong bundle $(P:W\rightarrow X,\mu)$ over the ep-groupoid $X$ we can introduce  the notion of a section 
functor.

\begin{definition}\label{SECTION-FUNCTORS-X}
Let $(P: W\to X,\mu)$ be a strong bundle over the ep-groupoid $X$. 
\begin{itemize}
\item[(1)]\ A sc-smooth  {\bf section functor}\index{D- Section functor} $f$
is a  sc-smooth section $f: X\to W$ of the strong bundle $P:W\rightarrow X$ over the object M-polyfold satisfying 
 the  functorial condition
$$
f(y) =\mu(\phi,f(x))
$$
for  morphisms $\phi: x\rightarrow y$. 
We denote by $\Gamma(P,\mu)$\index{$\Gamma(P,\mu)$} the  vector space of sc-smooth section functors of $(P,\mu)$.
\item[(2)]\ A {\bf $\ssc^+$-section functor}\index{D- Sc$^+$-section functor} $f$ is an element in $\Gamma(P,\mu)$ satisfying  $f(x)\in W_{0,1}$ for all $x\in X$
and $f$,  viewed as a section of $W[1]\rightarrow X$,  is sc-smooth. By $\Gamma^+(P,\mu)\subset \Gamma (P, \mu)$\index{$\Gamma^+(P,\mu)$} we denote the vector subspace of $\ssc^+$-section functors.
\item[(3)]\  A {\bf sc-Fredholm section functor}\index{D- Sc-Fredholm section functor}  $f$ is an element in $\Gamma(P,\mu)$ such that, viewed as a section of the strong bundle
$W\rightarrow X$ over the object M-polyfold,  $f$ is a sc-Fredholm section. By $\text{Fred}(P,\mu)$\index{$\text{Fred}(P,\mu)$} we denote the collection  of sc-Fredholm section functors.
\end{itemize}
\qed
\end{definition}

These notions will be studied in more detail later on.


\section{Proper Covering Functors}\label{cov_g}
We need later on the notion of a proper  covering functor, which is inspired by the definition in the Lie groupoid case in  \cite{Mac}.
\begin{definition}\label{d-proper_covering}\index{D- Proper covering functor}
A sc-smooth functor $F:Y\rightarrow X$ between ep-groupoids is called a {\bf proper covering functor}
if the following holds true.
\begin{itemize}
\item[(1)]\ The sc-smooth map $F:Y\rightarrow X$ defined between the objects
is a surjective local sc-diffeomorphism.
\item[(2)]\ For every  object $x\in X$, the  preimage $F^{-1}(x)\subset Y$ is finite. There exists an  open neighborhood $U(x)\subset X$
and  there exist mutually disjoint open neighborhoods $U(y)\subset Y$ around  every point $y\in F^{-1}(x)$ such that the map
$F: U(y)\rightarrow U(x)$ is a sc-diffeomorphism and
$$
F^{-1}(U(x))=\bigcup_{y\in F^{-1}(x)} U(y).
$$
\item[(3)]\ The map 
$$
\bm{Y}\rightarrow \bm{X}{_{s}\times_F} Y,\quad \phi\mapsto (F(\phi),s(\phi))
$$
is a sc-diffeomorphism.
\end{itemize}
\qed
\end{definition}
The map
$$
\bm{Y}\rightarrow \bm{X}{_{s}\times_F} Y,\quad \phi\mapsto (F(\phi),s(\phi)), 
$$
being a  sc-diffeomorphism, preserves 
the degeneracy index, so that 
$$
d_{\bm{Y}}(\phi) = d_{  \bm{X}{_{s}\times_F} Y}(F(\phi),s(\phi))
$$
for the morphisms $\phi\in \bm{Y}$.
By construction, the fiber product   $ \bm{X}{_{s}\times_F} Y$ is a sub-M-polyfold of the product 
$ \bm{X}\times Y$. The latter has the degeneracy index 
$$
d_{ \bm{X}\times Y} (\phi,y)=d_{\bm{X}}(\phi) +d_Y(y).
$$
Since $F$ and $s$ are local sc-diffeomorphisms we conclude that
$$
d_{\bm{X}\times Y}(F(\phi),s(\phi))=d_{\bm{X}}(F(\phi))+d_Y(s(\phi))= d_{\bm{Y}}(\phi)+d_{\bm{Y}}(\phi)=2\cdot d_{\bm{Y}}(\phi).
$$
Combining this with $d_{\bm{Y}}(\phi)=d_{  \bm{X}{_{s}\times_F} Y}(F(\phi),s(\phi))$
we conclude that
$$
d_{  \bm{X}{_{s}\times_F} Y}(F(\phi),s(\phi))=\frac{1}{2}\cdot d_{\bm{X}\times Y}(F(\phi),s(\phi)),
$$
which shows that the fibered product lies in a particular position in the full product.


Next we study the composition of sc-smooth proper covering functors.

\begin{proposition}\index{P- Composition of coverings}
Assume that $X$, $Y$, and $Z$ are ep-groupoids. If $F:Y\rightarrow X$ and $H:Z\rightarrow Y$ are proper covering functors,
then the composition $F\circ H:Z\rightarrow X$ is a proper covering functor.
\end{proposition}
\begin{proof}
That $F\circ H$ satisfies the properties (1) and (2) follows easily. To verify (3) we have to show
that
$$
L_{F\circ H}:{\bf Z}\rightarrow \bm{X}{_{s}\times_{F\circ H}} Z, 
\quad \sigma\mapsto (F(H(\sigma)),s(\sigma))
$$
is a sc-diffeomorphism.
To this aim we introduce the sc-smooth map  $\wtilde{K}$ by
$$
\wtilde{K}:\bm{Y}{_{s}\times_H}Z\rightarrow  \bm{X}{_{s}\times_{F\circ H}}Z, 
\quad(\psi,z)\mapsto (F(\psi),z),
$$
and consider the sc-diffeomorphisms
\begin{align*}
L_H&:{\bf Z}\rightarrow \bm{Y}{_{s}\times_H} Z, 
\quad\sigma\mapsto  (H(\sigma),s(\sigma))&\\
L_F&:\bm{Y}\rightarrow \bm{X}{_{s}\times_F} Y, 
\quad\psi\mapsto  (F(\psi),s(\psi)).
\end{align*}
Then 
$$
L_{F\circ H} =\wtilde{K}\circ L_H.
$$
It suffices  to show that $\wtilde{K}$ is a sc-diffeomorphism, since we already know that the same is true fo $L_H$.
Considering  the  sc-smooth map
$$
\bm{X}{_{s}\times_{F\circ H}}Z\rightarrow \bm{Y} \times Z, 
\quad (\phi,z)\mapsto  (L_F^{-1}(\phi,H(z)),z),
$$
we note  that $L_F^{-1}(\phi,H(z))=\psi$ implies $F(\psi)=\phi$ and $s(\psi)=H(z)$. 
Hence 
$$
(L_F^{-1}(\phi,H(z)),z)\in \bm{Y}{_{s}\times_H} Z
$$
 and 
therefore we can define the sc-smooth map
$$
\wtilde{L}:\bm{X}{_{s}\times_{F\circ H}}Z\rightarrow \bm{Y}{_{s}\times_H} Z \quad \text{by}\quad \wtilde{L}(\phi,z)=(L_F^{-1}(\phi,H(z)),z).
$$
Then  $\wtilde{K}\circ \wtilde{L}(\phi,z)=\wtilde{K}(\psi,z)$, where $F(\psi)=\phi$ and $s(\psi)=H(z)$.
Hence $\wtilde{K}(\psi,z)=(\phi,z)$ implying $\wtilde{K}\circ\wtilde{L}=\id$. Moreover
$\wtilde{L}\circ \wtilde{K}(\psi,z)=\wtilde{L}(F(\psi),z)= (\psi,z)$ so that $\wtilde{L}\circ\wtilde{K}=\id$.
We have shown that $\wtilde{K}$ is a sc-diffeomorphism implying that the map $L_{F\circ H}$ is a sc-diffeomorphism.
\qed \end{proof}


The following theorem can be viewed  as a generalization
of the result about the natural action of the isotropy group.



\begin{theorem}[{\bf Proper Covering {I}}]\label{STRUC_1}\index{T- Proper covering {I}}
Let $F:Y\rightarrow X$ be a proper covering functor and let $x\in X$. Then for  a connected and sufficiently small open  neighborhood $U(x)$ in $X$,
admitting the natural $G_x$-action (given by the data $(\Phi,\Gamma)$), the following holds.
\begin{itemize}
\item[{\em (0)}]\  The subset  $F^{-1}(U(x))$ in $Y$  is a disjoint union of connected open neighborhoods $U(y)$ for all $y\in F^{-1}(x)$  such  that every map $F:U(y)\rightarrow U(x)$ is a sc-diffeomorphism. 
\item[{\em (1)}]\  The subset  $\Gamma(G_x,U(x))=\{\phi\in \bm{X}\, \vert \, s(\phi),t(\phi)\in U(x)\}=:\bm{U} (x)$ is the union of connected components $\bm{U}(g)$ with $g\in G_x$.
Moreover, the source and target maps  $s,t:\bm{U}(g)\rightarrow U(x)$ are sc-diffeomorphisms.
\item[{\em (2)}]\  For every pair $y,y'\in F^{-1}(x)$,  the set 
$$
\bm{U} (y, y')=\{\psi\in \bm{Y}\, \vert \, \text{$s(\psi)\in U(y)$ and $t(\psi)\in U(y')$} \}$$ 
is the disjoint union of connected open neighborhoods
$\bm{U}(\psi_0)\subset \bm{Y}$ centered at morphismsm  $\psi_0: y\to y'$ for which the following properties (3)-(5) hold. 
\item[{\em (3)}]\ The maps $s:\bm{U}(\psi_0)\rightarrow U(y)$ and $t:\bm{U}(\psi_0)\rightarrow U(y')$ are sc-diffeomorphisms.
\item[{\em (4)}]\ The map $\bm{F}: \bm{U}(\psi_0)\rightarrow \bm{U}(\bm{F}(\psi_0))$ is a sc-diffeomorphism. 
\item[{\em (5)}]\ The following diagram is a commutative diagram of sc-diffeomorphisms.
$$
\begin{CD}
\bm{U}(\psi_0)@>\bm{F}>> \bm{U}(\bm{F}(\psi_0))\\
@V s VV @V t VV\\
U(s(\psi_0)) @> F>> U(t(\bm{F}(\psi_0)).
\end{CD}
$$
\end{itemize}
\qed
\end{theorem}
\begin{remark}\index{R- On proper coverings}
(a) As $F$ is a functor we conclude for a morphism $\phi: y\to y'$ in $\bm{Y}$ connecting two objects $y, y'\in F^{-1}(x)$, that the morphism $\bm{F}(\phi): F(y)\to F(y')$ belongs to the isotropy group $G_x$.\par

\noindent (b) In Theorem \ref{STRUC_1}
 everything is determined by the  choice of a small connected open neighborhood $U(x)$
of an object $x\in X$, which  admits the natural $G_x$-action. As discussed in Section \ref{sec_1_1}, Theorem \ref{x-local-x},
the construction of the data $(\Phi,\Gamma)$, which determines the $G_x$-action,   is  natural. The main point in
proving the theorem is the interplay between the map $F$ restricted to suitable subsets,
and its compatibility with the source and target maps due to the functoriality.\qed
\end{remark}

\begin{proof}[Theorem \ref{STRUC_1}]
The set $A=F^{-1}(x)$ is finite,  and for a 
connected open neighborhood $U'(x)$,  the preimage $F^{-1}(U'(x))$ is the disjoint union
of connected open neighborhoods $U'(y)$, so that every map $F: U'(y)\rightarrow U'(x)$ is a sc-diffeomorphism. This is an immediate consequence of the definition of a sc-smooth proper
covering functor. We may assume that the set $U'(x)$ admits  the natural action of $G_x$, otherwise we replace $U'(x)$ by a smaller $G_x$-invariant and for the sets $U'(y)$ we take its preimages  $F^{-1}(U'(x))$.

We find around every point $y\in A$ 
a connected open neighborhood $V(y)$, contained in $U'(y)$ and admitting admitting the natural action of $G_{y}$, and,  for every morphism $\psi: y\to y'$,  a connected open neighborhood $\bm{V}(\psi)$ such that the source and target maps $s: \bm{V}(\psi)\to V(y)$ and $t: \bm{V}(\psi)\to V(y')$ are sc-diffeomorphims. We define the sc-diffeomorphism
$\wh{\psi}$ by 
\begin{eqnarray}\label{disp834}
\wh{\psi}=t\circ \bigl(s\vert \bm{V}(\psi)\bigr)^{-1}: V(y)\to V(y').
\end{eqnarray}
Denoting by $\bm{A}$ the set of all morphisms between objects in $A$,  the set 
$$
\bm{V}=\left\{\phi\in \bm{X}\, \vert \, s(\phi)\in \bigcup_{y\in F^{-1}(x)}V(y), 
t(\phi)\in \bigcup_{y'\in F^{-1}(x)}V(y')\right\}
$$
is a disjoint union of connected components $\bm{V}(\psi)$, 
$$
\bm{V}=\bigcup_{\psi \in \bm{A}}\bm{V} (\psi).
$$
We take a smaller connected open neighborhood $U(x)\subset U'(x)$ which is $G_x$-invariant and for which 
$(F\vert V(y))^{-1}(U(x))\subset V(y)$.  Since the sets $U'(y)$ are $G_y$-invariant, the same is true for the sets 
$U(y):=(F\vert V(y))^{-1}(U(x))$. We claim that the map 
$\wh{\psi}: V(y)\to V(y')$ defined in (\ref{disp834})
maps bijectively 
$U(y)$ onto $U(y')$, and hence it is a sc-diffeomorphism from $U(y)$ onto $U(y')$. To see this, we take $z\in U(y)$ and let $z'=\wh{\psi}(z)$. Then $z'\in V(y')$ and there is a morphism $\phi: z\to z'$. Hence $\bm{F}(\phi)$ is a morphism between $F(z)$ and $F(z')$.  Since $F(z)\in U(x)$ and $F(z')\in U'(x)$, and $U'(x)$ is $G_x$ invariant, there exists $g\in G_y$ for which $\bm{F}(\phi)=\Gamma (g, F(z))$. 
But $U(x)$ is a $G_y$-invariant subset of $U'(x)$ and hence 
$F(z')=s(\bm{F}(\phi))\in U(x)$. So, $z'\in U(y')$ and $\wh{\psi}(U(y))\subset U(y')$. Similar arguments shows that $\wh{\psi}^{-1}(U(y'))\subset U(y)$. Hence the map $\wh{\psi}$ restricted to $U(y)$ is a sc-diffeomorphim onto $U(y')$. 
Now it is clear that if $\bm{U} (\psi)=(s\vert \bm{V}(\psi))^{-1}(U(y))$, then the maps $s: \bm{U} (\psi)\to U(y)$ and 
$t: \bm{U} (\psi)\to U(y')$ are sc-diffeomorphisms. Moreover, 
if $\bm{U} =\{\phi\in \bm{X}\, \vert \, s(\phi)\in \bigcup_{y\in F^{-1}(x)}U(y), 
t(\phi)\in \bigcup_{y'\in F^{-1}(x)}U(y')\}$,
then 
$$\bm{U}=\bigcup_{\psi \in \bm{A}}\bm{U} (\psi).$$



At this point  the properties (0)-(3)  are satisfied and it remains to verify the property (4). We take a morphism $\psi_0: y\to y'$ between points $y, y'\in A$. Then 
$\bm{F}(\psi_0)=g\in G_x$.  Since $\bm{U} (\psi_0)$ is connected and the set $\bm{U} (g)$ is a connected component of the set $\bm{U} (x)$, it follows that $\bm{F}(\bm{U} (\psi_0))\subset \bm{U} (g).$ 
Using that the maps 
$F: U(y)\to U(x)$, $s: \bm{U} (g)\to U(x)$, and 
$s: \bm{U} (\psi_0)\to U(y)$ are  sc-diffeomorpism, we see that any morphism $\phi \in \bm{U} (g)$ is of the form $\phi=(s\vert \bm{U} (g))^{-1}\circ F\circ s(\psi)$ for a unique morphism $\psi\in \bm{U} (\psi_0)$. Both  morphisms $\bm{F}(\psi)$ and $\phi=$ belong to $\bm{U} (g)$ and have the same source,  so 
that $\bm{F}(\psi)=\phi=(s\vert \bm{U} (g))^{-1}\circ F\circ s(\psi).$
Hence $\bm{F}$ is a sc-diffeomorphism  as a  composition  of sc-diffeomorphisms,
$$
\bm{U}(\psi_0)\xrightarrow{s} U(s(\psi_0))\xrightarrow{F} U(x)\xrightarrow{(s\vert \bm{U} (g))^{-1}} \bm{U}(g).
$$
We have verified the  property (4) and the  property (5) is now obvious. The proof of Theorem \ref{STRUC_1} 
is complete.
\qed \end{proof}


Let $F:Y\rightarrow X$ be a proper covering functor.  Fixing  $x\in X$ and a sufficiently small connected open neighborhood $U(x)\subset X$, and open neighborhoods
$U(y)\subset Y$ for $y\in F^{-1}(x)$, such  that every map $F:U(y)\rightarrow U(x)$ is a sc-diffeomorphism,  we obtain,  on the object level,  the map
$$
F:\sqcup_{y\in F^{-1}(x)} U(y)\rightarrow U(x).
$$
Assuming  that $U(x)$ admits the natural $G_x$-action,  
we take the associated full subcategories and  obtain a local model  for the proper covering functor near $x$ and $F^{-1}(x)$.
The morphism structure incorporates the natural actions of the isotropy groups $G_y$ and their  relationships.
Next we shall study the structure of this local model.

Using the previous theorem, we shall  explain the local structure of a proper covering functor in more detail.
We    denote by $\text{Diff}_{\mathrm{sc}}$\index{$\text{Diff}_{\mathrm{sc}}$}
the  category whose objects are M-polyfolds and whose morphisms are sc-smooth diffeomorphisms between M-polyfolds.
\begin{definition}[{\bf Covering functor, geometric lift}]\label{DEFR845}
Let $D$ and $C$ be two categories having both finitely many objects and morphisms. In addition, $C$ has only one object, usually denoted by $x$, so that $C=\{x\}$, and all morphisms of $C$  and $D$ are isomorphisms. 
A {\bf covering functor}\index{D- Covering functor} 
$$f: D\rightarrow C$$
 is a functor such  that the map
$$
\bm{D}\rightarrow \bm{C}{_{s}\times_f} D,\quad \psi\rightarrow (f(\psi),s(\psi))
$$
is a bijection.  

A {\bf geometric lift}\index{D- Geometric lift} of a covering functor 
$f: D\to C$ consists of two functors $L_D:D\rightarrow \text{Diff}_{\mathrm{sc}}$ and $L_C:C\rightarrow \text{Diff}_{\mathrm{sc}}$ and a natural transformation
$$
\tau: L_D\rightarrow L_C\circ f.
$$
of the two functors $L_D, L_C\circ f: D\to \text{Diff}_{\mathrm{sc}}$.
\qed
\end{definition}
 
 We recall that the map $\tau: D\to \text{Diff}_{sc}$ associates with every object $y\in D$ a morphism 
 $$\tau (y): L_D(y)\to L_C\circ f(y)$$
 in $\text{Diff}_{sc}$ satisfying 
 $$\tau (y')\circ L_D(h)=(L_C\circ f)(h)\circ \tau (y)$$
 for every morphism $h: y\to y'$ in $\bm{D}$.
 
 If $f: D\to C$ is a covering functor and
 $\tau:L_D\rightarrow L_C\circ f$ a geometric lift of $f$, the unique object $x\in C$ is mapped to the M-polyfold $L_C(x)$, denoted by 
 $$
U(x):=L_C(x).
$$
For the finitely many objects $y\in D=f^{-1}(x)$ 
we obtain the M-polyfolds  $L_D(y)$ denoted by 
$$
U(y):=L_D(y),\quad y \in D=f^{-1}(x).
$$
Associated with  every objects $y \in D=f^{-1}(x)$ is the morphism 
$\tau (y): L_D(y)\to L_C(f(y))$  which, in view of $f(y)=x$, is the  sc-diffeomorphism  
$$
\tau(y):U(y)\rightarrow U(x)
$$
between the two M-polyfolds.


If $\psi:y\rightarrow y'$ is a morphism in $D$, then the  morphism $L_D(\psi): L_D(y)\to L_D(y')$ in $\text{Diff}_{sc}$ is the sc-diffeomorphism 
$$
\varphi_{yy'}(\psi):=L_D(\psi): U(y)\rightarrow U(y').
$$
The morphism $g\in \bm{C}=G_x$, $g: x\to x$, is mapped  to the morphism $L_C(g): L_C(x)\to L_C(x)$ which is the sc-diffeomorphism 
$$L_C(g): U(x)\to U(x)$$
of the M-polyfold $U(x)$. 
For two morphisms $\gamma: y\to y'$ and $\psi: y'\to y''$ in $\bm{D}$ so that 
$\psi\circ\gamma: y\to y''$, we obtain by functoriality the formula 
$$
\varphi_{yy''}(\psi\circ\gamma)=\varphi_{y'y''}(\psi)\circ\varphi_{yy'}(\gamma)
$$
which is a composition of sc-diffeomorphisms.

In the special case $y=y'$, the isotropy group $G_y\subset \bm{D}$ consists of the finitely many morphisms $y\to y$, and the $G_y$-action on the M-polyfold $U(y)$ is defined  by
$$
\text{$h\ast z:=L_D(h)(z)$, \quad $z\in U(y)$ and $h\in G_y$.}
$$
Similarly,  we denote the action of the isotropy group $G_x$ on $U(x)$ by $g\ast z=L_C(g)(z)$ for $z\in U(x)$ and $g\in G_x$.

Using that $\tau$ is a natural transformation we obtain for $h\in G_y$ the formula
\begin{equation*}
\begin{split}
\tau (y)(h\ast z)&=(\tau (y)\circ L_D(h))(z)\\
&=(L_C(f(h))\circ \tau (y))(z)\\
&=f(h)\ast \tau (y)(z)
\end{split}
\end{equation*}
for all $z\in U(y)$ where $\tau (y)(z)\in U(x)$. 
Therefore, the sc-diffeomorphisms $\tau (y): U(y)\to U(x)$ are equivariant with respect to the map $f: G_y\to G_x$.


\begin{proposition}[{\bf Geometric Lift}]\index{P- Geometric lift}\label{geo_lift}
Associated with a covering functor 
$f:D\rightarrow C$ and a geometric lift $\tau:L_D\rightarrow L_C\circ f$ of $f$  there exists a natural construction of a proper covering functor $F:Y\rightarrow X$ between the  two ep-groupoids $Y$ and $X$.
\end{proposition}
\begin{proof}
Let $x$ be the  unique object of $C$ and $G_x=\bm{C}$ its  isotropy group. 
Using  the previously introduced notations  we take  the translation groupoid 
$$X=G_x\ltimes U(x),$$
 whose  object M-polyfold is $U(x)$ and whose morphism
M-polyfold is $G_x\times U(x)$. The source and the target maps $s, t: G_x\times U(x) \to U(x)$ are defined as  $s(g,z)=z$, and $t(g,z)=g\ast z$.


The  object set  $Y$ of the  ep-groupoid  $(Y, \bm{Y})$  is defined as the disjoint 
union
$$
Y=\bigcup_{y\in D} U(y).
$$
It possesses a 
natural M-polyfold structure.
The  morphism set $\bm{Y}$  is the set 
$$
\bm{Y}=\bigcup_{(y,y')\in D\times D} [\text{mor}(y,y')\times U(y)],
$$ 
which has also  a natural M-polyfold structure.
The source and target maps $s, t: \bm{Y}\to Y$ are defined by 
$$s(\psi,z)=z\quad \text{and}\quad 
t(\psi,z) =\varphi_{yy'}(\psi)(z)
$$
for $\psi \in \text{mor}(y, y')$ and $z\in U(y).$
The maps  $s$ and $t$ are surjective local sc-diffeo\-mor\-phisms.
The composition of  the morphisms $(\psi,z')$ and $(\gamma,z)$ in $\bm{Y}$ is well defined provided  $z'=\varphi_{yy'}(\gamma)(z)$,  and is given by
$$
(\psi,z')\circ(\gamma, z)=(\psi\circ\gamma,z).
$$
The identity elements have the form $(1_y,z)$, where $z\in U(y)$ so that the unit map $u:Y\rightarrow \bm{Y}$ is the map 
$$
u(z)=(1_y,z),
$$
where $z\in U(y)$. The inversion map $\iota:\bm{Y}\rightarrow \bm{Y}$ is given by
$$
\iota(\psi,z)=(\psi^{-1},\varphi_{yy'}(\psi)(z)).
$$
For the M-polyfold structure on $\bm{Y}$  the inversion map $\iota$ is sc-smooth because  $\varphi_{yy'}(\psi)$ is a sc-diffeomorphism.
One verifies that $Y=(Y, \bm{Y})$ is an ep-groupoid, i.e the composition is  sc-smooth and the properness property holds.

The functor $F: (Y, \bm{Y})\rightarrow (X, \bm{X})$ is defined on the objects by 
$F|U(y):=\tau (y)$ for $y\in D$ which is a sc-diffeomorphism $U(y)\to U(x)$. On the morphism set ${\bf }$ we define $\bm{F}: \bm{Y}\to \bm{X}$ as follows. If $(\psi, z)\in \bm{Y}$, where $\psi : y\to y'$ is a morphism satisfying $s(\psi)=y$, and $z\in U(y)$, we set 
$$
\bm{F}(\psi,z)= (f(\psi),\tau (y)(z))\in \bm{X}.
$$
Since $F: U(y)\to U(x)$ is a sc-diffeomorphism
and $F^{-1}(U(x))=Y$, the map 
$F: X\to Y$ is a surjective local sc-diffeomorphism between the object sets. It follows from the construction that 
$$F: (Y, \bm{Y})\to (X, \bm{X})$$
is a sc-smooth functor between ep-groupoids.
Finally, we claim that the map 
\begin{equation}\label{map_star}
\bm{Y}\rightarrow \bm{X}{_{s}\times_F} Y,\quad (\psi,z)\rightarrow ((f(\psi),F(z)),z)
\end{equation}
 is a sc-diffeomorphism. Indeed, from 
$$
((f(\psi),F(z)),z)=((f(\psi'),F(z')),z').
$$
it follows that $z=z'$ 
 implying 
$$(f(\psi), \tau (y)(z))=(f'(\psi'), \tau (y') (z))$$
and hence $y=y'=s(\psi)=s(\psi')$. 
By the definition of a covering functor $f: D\to C$, the map 
$\bm{D}\to \bm{C}{_{s}\times_f}\bm{D}$, $\psi \mapsto (f(\psi), s(\psi))$ is a bijection. Therefore, 
we conclude that $\psi=\psi'$, which shows the injectivity of map \eqref{map_star}. In order to verify the surjectivity we  take an element 
$((g,q),z)\in \bm{X}{_{s}\times_F} Y$.
Then $F(z)=q$ and there exists a point $y\in Y$ for which $z\in U(y)$. Therefore, we find a unique  $\psi\in \bm{D}$ satisfying  $f(\psi)=g$ and $s(\psi)=y$ and consequently, 
$
((f(\psi),F(z)),z)=((g,q),z),
$
which  shows the surjectiviy of  the map \eqref{map_star}. Being a local sc-diffeomorphism, the map \eqref{map_star}  is therefore a sc-diffeomorphism as claimed. 


The proof that the functor $F:Y\rightarrow X$ between the ep-groupoids is a proper covering functor according to Definition \ref{d-proper_covering}, is complete. \qed \end{proof}

Conversely,  combining Theorem \ref{STRUC_1} with  Proposition \ref{geo_lift} we shall construct, for  a proper covering functor $F:Y\rightarrow X$ between ep-groupoids, 
a local model near the object $x\in X$ and near the preimage $F^{-1}(x)\subset Y$, which is the geometric lift of the induced  covering functor
$$
f: D\rightarrow C,
$$
where $D$ is the full subcategory associated with  $F^{-1}(x)$ and $C$ the full subcategory associated with $x$. Moreover,  $f=F\vert D$.

\begin{theorem}[{\bf Proper Covering {II}}] \label{STRUC_2} \index{T- Proper covering {II}}
Let $F:Y\rightarrow X$ be a proper covering functor. Fixing an object $x\in X$, we let $C$ be the full subcategory of $X$ having the single object $x$ and the isotropy group $G_x$ as the morphism set. Moreover, we let $D$ be
the full subcategory having the finite object set $F^{-1}(x)$. Then the restriction $f=F|D:D\rightarrow C$ is a covering functor. Given a sufficiently small open neighborhood
$U(x)$ of $x$ in $X$ as described in Theorem \ref{STRUC_1}, there exists exists a geometric lift $A:K\rightarrow L$ of $f$ and there exist  fully faithful open 
embedding functors
$\Phi$ and $\Psi$, where the image of the functor $\Phi:L\rightarrow X$ is  the full subcategory associated with  $U(x)$, and the image of the functor $\Psi:K\rightarrow Y$ is  the full subcategory associated
with $F^{-1}(U(x))$, such  that the following diagram is commutative, 
$$
\begin{CD}
K @>\Psi >> Y\\
@V A VV @V F VV\\
L @> \Phi >> X.
\end{CD}
$$
\end{theorem}
\begin{proof}
Fixing the object $x\in X$ we obtain the category $C$  consisting of the single object $x$ and the morphism set $G_x$, and the full subcategory $D=(D, \bm{D})$ of $Y$ associated with the finite set of objects  $D=F^{-1}(x)$.
We denote by $f:D\rightarrow C$ the restriction of the proper covering functor $F$ to $D$, so that $f=F\vert D$.  From the covering functor $F$ we deduce that  $f$  is a covering functor between finite categories.
Next we employ Theorem \ref{STRUC_1} and choose the open neighborhood  $U(x)\subset X$ equipped  with its natural action of $G_x$ given by $(\Phi,\Gamma)$, so small that
the properties (0)-(5) of Theorem \ref{STRUC_1} hold. In particular,  we have open neighborhoods $U(x)\subset X$ and $U(y)\subset Y$ for $y\in D$ which are M-polyfolds.
Next we define the geometric lift of $f:D\rightarrow C$. The functor $L_C:C\to \text{Diff}_{sc}$ is defined by
$$
L_C(x)=U(x)\quad \text{and}\quad  L_C(g)=\Phi(g)\in \text{Diff}_{\textrm{sc}}(U(x)), \quad g\in G_x.
$$
On the object set $D$ the functor  $L_D:D\to \text{Diff}_{sc}$ is defined as 
$$
L_D(y)=U(y),\quad y\in D=F^{-1}(x).
$$
Recalling the statement (5) of Theorem  \ref{STRUC_1}, we define the functor $L_D:D\to \text{Diff}_{sc}$ on morphisms as follows. 
If  $\psi:y\to y'\in \bm{U}(\psi_0)$ for the distinguished morphism $\psi_0: y\to y'$, we put 
$$L_D(\psi )=t\circ (s\vert \bm{U}(\psi_0))^{-1}\in 
\text{Diff}_{sc}(U(y),U(y')).
$$
The natural transformation $\tau:L_D\to L_C\circ f$ associates with the object  $y\in F^{-1}(x)$  the morphism 
$\tau (t):L_D(y)\to L_C\circ f(y)$ which is the sc-diffeomorphism 
$$\tau (y):=F\vert U(y): U(y)\to U(x).
$$
One verifies that this defines a geometric lift of  the covering functor $f:D\rightarrow C$. The associated natural construction of a covering functor is denoted by
$A:K\rightarrow L$, where $L$ is the translation groupoid $L=G_x\ltimes U(x)$, and the ep-groupoid $(K,\bm{K})$  is defined by 
$$
K=\sqcup_{y\in F^{-1}(x)} U(y)\quad \text{and}\quad \bm{K}=\sqcup_{(y,y')\in D^2} [\text{mor}(y,y')\times U(y)].
$$
The proper covering functor $A:K\rightarrow L$ is defined on  the objects by $A|U(y):=F|U(y)$ and on the morphisms  $(\psi, z)\in \text{mor}(y,y')\times U(y)$ by  
$$
A(\psi,z)= (f(z), F(z)).
$$
The functor $\Phi:L\rightarrow X$ is the inclusion on objects and maps the morphism $(g,z)\in G_x\times U(x)$
to the morphism $\Gamma(g,z)\in \bm{X}$. The functor $\Psi:K\rightarrow Y$ is the inclusion on objects,  and maps  the morphism $(\psi,z) \in \text{mor}(y,y')\times U(y)$ where $\psi \in \bm{U}(\psi_0)$,  to the morphism $(s\vert \bm{U}(\psi_0)))^{-1}(z)\in \bm{Y}$. 
This way we obtain the commutative diagram
$$
\begin{CD}
K @>\Psi >> Y\\
@V A VV @V F VV\\
L @> \Phi >> X.
\end{CD}
$$
The image of $\Psi$ is the full subcategory associated with the object set  $F^{-1}(U(x))$, the image of $\Phi$ is the full subcategory associated with  $U(x)$, 
and the covering functor $A$ is  the restriction of $F$. The construction of the covering functor $A: K\rightarrow L$ defines, up to the fully faithful
open embeddings $\Psi$ and $\Phi$,  a local model for the proper covering functor $F$ near $x$ and $F^{-1}(x)$. The proof of Theorem \ref{STRUC_2} is complete.
\qed \end{proof}

For further considerations concerning the local structure of a proper covering functor we refer to  Appendix \ref{strustru}.

For applications we need a version of the previous discussion involving strong bundles. We recall  from Definition \ref{strong_bundle_ep} that the structure map $\mu$ of a strong bundle over an ep-groupoid $P:W\rightarrow Y$
is a strong bundle map $\mu:\bm{Y}{_{s}\times_P} W\rightarrow W$ covering the target map $t:\bm{Y}\rightarrow Y$. 
The pairs $(\psi,w)\in \bm{W}=\bm{Y}{_{s}\times_P} W$ are  viewed as the morphisms 
$$
(\psi,w): w\rightarrow \mu(\psi,w).
$$
of the object space $W$. Then $\bm{W}$ becomes  a strong bundle over $\bm{Y}$ via the projection map  
$$
\bm{P}: \bm{W}\rightarrow \bm{Y},\quad (\psi,w)\rightarrow \psi.
$$
The source and  the target maps $s, t: \bm{W}\rightarrow W$ are defined as $s(\psi,w)=w$ and $t(\psi,w)=\mu(\psi,w)$.  The reader  finds more details in Section \ref{SST} about strong bundles.
\begin{definition}\label{proper_sb_covering}
Let $(W,\mu)$ and $(V,\tau)$ be strong bundles over the ep-groupoids $Y$ and $X$, respectively, denoted  by  $P:W\rightarrow Y$ and $Q:V\rightarrow X$.
A {\bf proper strong bundle covering functor} is a strong bundle map $A$  (in particular fiberwise linear), for which the diagram
$$
\begin{CD}
W @> A>>  V\\
@V P VV @ V Q VV\\
Y @> F >> X
\end{CD}
$$
is commutative and which has 
the following additional properties.
\begin{itemize}
\item[(1)]\ $A$ is surjective and a local strong bundle isomorphism covering a sc-smooth proper covering functor $F:Y\rightarrow X$.
\item[(2)]\  The preimage $F^{-1}(x)$ of every object $x\in X$  is finite,  and there exist open neighborhoods $U(x)\subset X$ and $U(y)\subset Y$ for every $y\in F^{-1}(x)$, where the sets $U(y)$ are mutually disjoint, such  that the map
$$
A:W\vert U(y)\rightarrow V|U(x)
$$
 is a strong bundle isomorphism for every $y\in F^{-1}(x)$, and 
 $$
 F^{-1}(U(x))=\bigcup_{y\in F^{-1}(x)} U(y).
 $$
 \item[(3)]\ The map 
 $$
\bm{W}\rightarrow \bm{V}{_{s}\times_A} W:(\psi,w)\rightarrow ((F(\psi),A(w)),w)
 $$
 is a strong bundle isomorphism covering the sc-diffeomorphism $\bm{Y}\rightarrow \bm{X}{_{s}\times_F}Y:\psi\rightarrow (F(\psi),s(\psi))$. Here the strong bundle projection
 $$
 \bm{V}{_{s}\times_A} W\rightarrow \bm{X}{_{s}\times_F} Y
 $$
  is given by $((\phi,v),w)\rightarrow (\phi,P(w))$.
 \end{itemize}
 \end{definition}
The strong bundle data are  some kind of a lift of the data on the level of ep-groupoids. All structural statements about proper covering functors
 between ep-groupoids lift to the strong bundle situation.  We give some further discussion in the following appendix.
 \section{Appendix}

\subsection{Local Structure of Proper Coverings}\label{strustru}
We consider a proper covering functor 
$F:Y\rightarrow X$ between ep-groupoids 
as described in Definition \ref{d-proper_covering}. Fixing an object $x\in X$,  we denote by $X(x)$ the full subcategory whose object set consists of the single element $x$ and whose morphisms  are the elements of the isotropy group $G_x$. By $Y(x)$ we denote the full subcategory whose object set is the finite set $F^{-1}(x)\subset Y$ and denote the associated set of morphisms by 
$\text{mor}(F^{-1}(x))$. We obtain  the
functor
$$
F: Y(x)\to X(x).
$$
In view of the property (3) in Definition \ref{d-proper_covering} of a proper covering functor, the map 
$$
\text{mor}(F^{-1}(x))\rightarrow (G_x) {_{s}\times_F} F^{-1}(x)= G_x \times F^{-1}(x),\quad \phi\mapsto (F(\phi),s(\phi))
$$
is a bijection. This implies  
$$
\# \text{mor}(F^{-1}(x))= \# G_x\cdot \# F^{-1}(x).
$$

We decompose the finite set $F^{-1}(x)$ into isomorphism classes
$$
F^{-1}(x)=\Theta_1\cup\ldots \cup\Theta_q,
$$
where two objects are isomorphic if there exists an isomorphism in $\text{mor}(F^{-1}(x))$ between them. Clearly,  for any two elements 
$y,y'\in\Theta_j$, the isotropy groups $G_y$ and $G_{y'}$ are isomorphic.
\begin{lemma}\label{ABB}\index{L- Structure of ${\mathcal F}^{-1}_x$ (I)}
For every $j=1,\ldots,q$ we have the equality
$$
\# G_x\cdot \# \Theta_j = \#\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi),t(\psi)\in \Theta_j\}.
$$
Moreover, for every $j=1,\ldots ,q$ and $y_0\in \Theta_j$, 
$$
\#\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi),t(\psi)\in\Theta_j\} = \# G_{y_0}\cdot( \#\Theta_j)^2
$$
and 
$$
\# G_x =\# G_{y_0}\cdot \# \Theta_j.
$$
\end{lemma}
\begin{proof}
The map
\begin{equation}\label{x_burger}
\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi), t(\psi)\in \Theta_j\}\rightarrow G_x\times \Theta_j:\psi\rightarrow (F\psi),s(\psi))
\end{equation}
is a bijection by property (3) of a proper covering functor, implying the first claim.

We decompose the subset  $\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi),t(\psi)\in \Theta_j\}$ of morphisms  into the disjoint union
$$
\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi),t(\psi)\in \Theta_j\}=\sqcup_{(y,y')\in \Theta_j\times \Theta_j}\text{mor}(y,y').
$$
Since any two points in $\Theta_j$ are isomorphic, each of these sets $\text{mor}(y,y')$ is nonempty. If we choose  $y_0\in \Theta_j$ and  fix for every $y\in \Theta_j$ a morphism $\psi_y: y_0\rightarrow y$, 
then the map
$$
\text{mor}(y_0,y_0)\rightarrow \text{mor}(y,y'),\quad  \psi\mapsto  \psi_{y'}\circ\psi\circ\psi_{y}^{-1}
$$
is a bijection. Consequently, 
$$
\#\{\psi\in \text{mor}(F^{-1}(x))\ |\ s(\psi),t(\psi)\in\Theta_j\} = \# G_{y_0}\cdot( \#\Theta_j)^2.
$$
Combining this with the first statement we obtain the final claim of Lemma \ref{ABB}.
\qed \end{proof}

Let again $F:Y\rightarrow X$ be the above  proper covering functor between ep-groupoids and 
assume that $x,x'\in X$ are isomorphic.  We consider,  for given $y\in F^{-1}(x)$,  all objects  $y'\in F^{-1}(x')$ for which  there exists a morphism
$\phi:y\rightarrow y'$. If $y_1\in F^{-1}(x)$ is isomorphic to $y$ and $y_1'$  by the morphisms  $\psi:y_1\rightarrow y$, and $\psi':y_1\rightarrow y_1'$,  we see that
$y'$ and $y_1'$ are isomorphic. If  $y'$ is reachable by an isomorphism starting in $\Theta_j$ and $y_1'$ is isomorphic to
$y'$, then the latter is also reachable by an element starting in $\Theta_j$.  Hence we have proved the following lemma.
\begin{lemma}\label{LEM1}\index{L- Structure of ${\mathcal F}^{-1}_x$ (II)}
Given a proper covering functor $F:Y\rightarrow X$, we  assume that $x$ and $x'$ are isomorphic. Then there is a one-to-one correspondence 
between the isomorphism classes associated to $F^{-1}(x)$ and $F^{-1}(x')$, respectively.
If  $ F^{-1}(x)=\sqcup_{j=1}^q \Theta_j$  is  isomorphisms class decomposition, then there is the decomposition
$F^{-1}(x')=\sqcup_{j=1}^q\Theta_j'$ having  the property that if  $y\in F^{-1}(x)$ and $y'\in F^{-1}(x')$  are connected by an isomorphism, 
there exists a uniquely determined $j$ such  that $y\in\Theta_j$ and $y'\in\Theta_j'$.
\end{lemma}
Therefore, there is  a one-to-one correspondence between the  isomorphism classes for which  $\Theta_j$ corresponds to $\Theta_j'$ for $j=1,\ldots ,q$.
Two points $y_0\in \Theta_j$ and $y_0'\in\Theta_j'$ are isomorphic and therefore $\# G_{y_0}=\# G_{y_0'}$.
Moreover, since $x$ and $x'$ are isomorphic,  $\# G_x=\# G_{x'}$. Using the third claim of Lemma \ref{LEM1}, 
we infer that
$$
\#\Theta_j= \frac{\# G_x}{\# G_{y_0}}=\frac{\# G_{x'}}{\# G_{y_0'}}=\#\Theta_j'.
$$
We sum up the discussion in the 
following lemma.
\begin{lemma}\label{LEM2}\index{L- Structure of ${\mathcal F}^{-1}_x$ (III)}
Given a proper covering functor $F:Y\rightarrow X$, we  assume that $x$ and $x'$ are isomorphic. Then, with the decompositions
of $F^{-1}(x)$ and $F^{-1}(x')$ as described in Lemma \ref{LEM1}, 
we have the equality $\#\Theta_j=\#\Theta_j'$ for every  $j=1,\ldots ,q$.
In particular, 
$$
\# F^{-1}(x)=\sum_{i=1}^q \#\Theta_j=\sum_{i=1}^q\#\Theta_j'=\# F^{-1}(x').
$$
\end{lemma}
The structure of isomorphism classes of $F^{-1}(x)$ stays the same if we perturb $x'$. This follows immediately from the definition of a proper covering functor.
In particular, together with Lemma \ref{LEM2} we obtain the following result.
\begin{proposition}\index{P- Structure of ${\mathcal F}^{-1}_x$}
Let $F:Y\rightarrow X$ be a sc-smooth proper covering functor. Then for every connected component $c$ of the orbit space $|X|$ there exists a constant $k_c$ such  that the following holds.
If $z\in c$ and $\pi(x)=z$, then $\# F^{-1}(x) =k_c$. In other words,  viewing ${\mathbb N}=\{1,2,\ldots \}$ as an ep-groupoid with the identities as the morphisms,  
the map
$$
X\rightarrow {\mathbb N},\quad x\mapsto \# F^{-1}(x)
$$
is a sc-smooth functor.
\end{proposition}
\subsection{The Structure of Strong Bundle Coverings}
Recall Definition \ref{proper_sb_covering} and consider the diagram
$$
\begin{CD}
W @>A>> V\\
@V P VV @V QVV\\
Y @>F>> X,
\end{CD}
$$
where the properties of the maps have been specified in the before-mentioned definition.
A strong bundle $P:W\rightarrow Y$ over an ep-groupoid is by definition given as a strong bundle $W\rightarrow Y$ over the object M-polyfold
together with a map $\mu_Y$ which associates to a morphism $\phi:y\rightarrow y'$ a topological linear isomorphism $\mu_Y(\phi):P^{-1}(y)\rightarrow P^{-1}(y')$.
A morphism $w\rightarrow w'$ is given by a pair $(\phi,w)$ with $s(\phi)=P(w)$ so that
$$
(\phi,w):w\rightarrow \mu_Y(\phi)(w).
$$
The same holds for $Q:V\rightarrow X$.  The functor $A$ applied to morphisms has the form 
$$
A(\phi,w) = (F(\phi),A_{s(\phi)}(w)),
$$
where $A_y:P^{-1}(y)\rightarrow Q^{-1}(F(y))$ is the topological linear isomorphism induced by $A$ between the fibers of the object spaces.
By definition
$$
A(\phi,w):  A_{s(\phi)}(w)\rightarrow \mu_X(F(\phi))(A_{s(\phi)}(w))
$$
from which we deduce that 
\begin{eqnarray*}
\mu_X(F(\phi))\circ A_{s(\phi)}(w)&=&\mu_X(F(\phi))(A_{s(\phi)}(w))\\
&=&t(A(\phi,w))=A(t(\phi,w))\\
&=&A(\mu_Y(\phi)(w))\\
&=& A_{t(\phi)}\circ \mu_Y(\phi)(w)
\end{eqnarray*}
implying the relationship
$$
\mu_X(F(\phi))\circ A_{s(\phi)} = A_{t(\phi)}\circ \mu_Y(\phi)\ \ \text{for}\ \ \phi\in \bm{Y}.
$$
Denote by $\text{Ban}$ the category of Banach spaces with the morphisms being linear topological isomorphisms.
We can view $\mu_Y:Y\rightarrow \text{Ban}$ and $\mu_X:X\rightarrow \text{Ban}$ as functors. Then 
the assignment $Y\rightarrow \text{mor}(\text{Ban}):y\rightarrow A_y$ is nothing else, but a natural transformation
$$
\mu_Y\xrightarrow{A} \mu_X\circ F.
$$




\chapter{Branched \texorpdfstring{Ep$^+$}{plusplus}-Subgroupoids}\label{CHAPTER_9}
In this chapter we  introduce the notion of a branched ep$^+$-subgroupoid and study its properties. 
These objects will arise naturally
as solution spaces of sc-Fredholm sections provided there is enough transversality. If a branched ep$^+$-subgroupoid is oriented 
and has a decent boundary geometry, we shall show that we can integrate sc-differential forms over them. Moreover a version of Stokes theorem holds.
The chapter ends with an appendix raising some questions and describing some ideas pointing to possible useful generalizations.
\section{Basic Definitions}
Recall from Chapter \ref{chap4} that 
a (finite-dimensional) submanifold  $M$ of a M-polyfold $X$ is a subset which is locally an sc$^+$-retract. 
It inherits the structure of a M-polyfold and in fact this structure is equivalent to a M$^+$-polyfold structure.
Since, as we have seen, M$^+$-polyfolds essentially are manifolds modulo the fact that the boundary might be 
not particularly nice, we shall call M$^+$-polyfolds just (smooth) manifolds, see  the next 
 \ref{REM911} were we recall
some more details. 
 Using this language 
we can say that a submanifold $M$ of a M-polyfold  $X$
inherits a natural (smooth) manifold structure.
\begin{remark}\label{REM911}\index{R- On finite-dimensional submanifolds}
If $m\in M$
the dimension of $T_mM$ is locally constant and by definition the local dimension of $M$.  A local sc$^+$-retract inherits from $X$ 
the structure of a M$^+$-polyfold.  As was shown previously,
if $m_0\in M$ with $d_M(m_0)=0$, then there exists an open neighborhood of $m_0$ in $M$ which has a natural (classical) smooth manifold
structure. Near points $m_0$ with $d_M(m_0)=1$ we have a natural structural of a smooth manifold with boundary. Hence a M$^+$-polyfold is near points with $d_M(x)=0$ the same as a smooth manifold without boundary and near points with $d_M(x)=1$
a manifold with boundary. We also introduced previously the notion of a tame M$^+$-polyfold and showed that this object is the same as 
a smooth manifold with boundary with corners. In generally the behavior of a M$^+$-polyfold near boundary points with $d_M(x)\geq 2$ can be quite complicated.
\qed
\end{remark}


The basic definition is that of a branched ep$^+$-subgroup\-oid of an ep-groupoid and it will be given next. 
\begin{definition}\label{DEF912}\index{D- Branched ep$^+$-subgroupoid}
Let $X$ be an ep-groupoid. A {\bf branched ep$^+$-subgroup\-oid} is a functor  $\Theta:X\rightarrow {\mathbb Q}^+$  which has the following properties.
\begin{itemize}
\item[(1)]\ If $\Theta(x)>0$ then $x$ is smooth, i.e. the support $\supp(\Theta)=\{x\in X\ |\ \Theta(x)>0\}$ of $\Theta$ is contained in $X_\infty$.
\end{itemize}
In addition we require that for every  $x\in \supp(\Theta)$ the following holds.
\begin{itemize}
\item[(2)]\ There exists  an open neighborhood $U(x)$  and a finite family of submanifolds $M_i\subset U(x)$, $i\in I$, with $x\in M_i$, so that
the inclusion $M_i\rightarrow U(x)$ is proper.
\item[(3)]\  There exists for  every $i\in I$  a positive rational number $\sigma_i>0$, called {\bf weight}\index{Weight}.
\item[(4)]\ With the data in (ii) and (iii) we have the equality
$$
\Theta(y)= \sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i \ \ \text{for}\ \ y\in U(x).
$$
We shall refer to ${(M_i)}_{i\in I}$ and ${(\sigma_i)}_{i\in I}$ as a {\bf local  branching structure}.\index{Local branching structure}
\end{itemize}
We shall call $\Theta$ {\bf  $\bm{n}$-dimensional}\index{$n$-dimensional} provided  for every point $x\in \supp(\Theta)$ the manifolds of a local 
branching  structure are all   $n$-dimensional. We say that $\Theta$ is {\bf locally  equidimensional}\index{Locally equidimensional} provided if  for every $x\in \supp(\Theta)$
the manifolds in a sufficiently small branching structure have all the same dimension.
\qed
\end{definition}
\begin{remark}\index{R- On finite-dimensional branched ep$^+$-subgroupoids}
a) We can view $\Theta$ as data which distinguishes a full subcategory of $X$, namely the one
associated to the objects in $\supp(\Theta)$, and in addition associates to the objects $x$ of $ \supp(\Theta)$
a rational positive weight $\Theta(x)$.\par

\noindent b) The local branching structures at a point $x$ are in general not unique, even close to $x$.
For example assume that $X={\mathbb R}^2$ with the morphisms being the identities.
Take two smooth functions $\beta_i:{\mathbb R}\rightarrow {\mathbb R}$, $i\in \{1,2\}$, having the following properties,
$\beta_1(s)=0$ for $s\leq 0$, $\beta_1(s)>0$ for $s>0$, $\beta_2(s)>0$ for $s<0$, and $\beta_2(s)=0$ for $s\geq 0$.
Associated to the  $\beta_i$ we have their graphs $G_1$ and $G_2$ and give each of them the weight $1$ and define
$$
\Theta(x,y)=|{\{i\in \{1,2\}\ |\ (x,y)\in G_i\}} |.
$$
We note that there is another branching structure with $\gamma_1(s)=0$, $s\in {\mathbb R}$,  and $\gamma_2(s)>0$ for $s\neq 0$ describing $\Theta$. It is clear from this example that local branching structures can be 
arbitrarily complicated, f.e. take oscillatory graphs with high numbers of tangencies.
\qed
\end{remark}
A basic  observation is given in the following lemma. Recall that a subset $A$ of a topological space $Z$ is {\bf locally closed}\index{Locally closed} provided every point $a\in A$ has an open neighborhood
$V(a)$ in $Z$ so that $V(a)\cap A$ is closed in $V(a)$. Also recall the definition of an open subset $U$ of $X$ having the properness
property, which will be frequently used, see Definition \ref{proper*}.
\begin{lemma}\index{L- Local closedness of $\Theta$}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched ep$^+$-subgroupoid. 
Then $|\supp(\Theta)|$ is locally closed in $|X|$.
\end{lemma}
\begin{proof}
Let $z\in |\supp(\Theta)|$ and pick a representative $x\in X$. Take an open neighborhood $U(x)$
with the natural $G_x$-action, and the properness property, which in addition 
allows for a local branching structure ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, representing 
$\Theta$. Define $V(z):=|U(x)|$ as the open neighborhood of $z$ and pick $w\in V(z)$ with
$w\in \cl_{|X|}(|\supp(\Theta)|)$. Take a representative $y\in U(x)$ of $w$.
The submanifolds $M_i$ are properly mapped $M_i\rightarrow U(x)$. 
If there is an open neighborhood $U(y)\subset U(x)$ which does not intersect any of the $M_i$
it follows, since $\bigcup_{i\in I} M_i$ is $G_x$-invariant, that $|U(y)|$ does not intersect $\cl_{|X|}(|\supp(\Theta)|)$. Hence we find a sequence $x_k\in \bigcup_{i\in I} M_i$ converging to $y$.
After perhaps taking a subsequence we may assume  $x_k\in M_i$ for a suitable $i\in I$.
Since $M_i$ is properly mapped the preimage of the compact set $(x_k)\cup \{y\}$ is compact
and $x_k$ has a convergent subsequence in $M_i$, which implies $y\in M_i$. This completes the proof.
\qed \end{proof}
The following definitions will be  useful later on.
\begin{definition}\label{DEF915}\index{D- Closed or compact $\Theta$}\index{Closed $\Theta$}\index{Compact $\Theta$}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched ep$^+$-subgroupoid.
\begin{itemize}
\item[(1)]\ We call $\Theta$ {\bf closed} provided $|\supp(\Theta)|$ is closed in $|X|$.
\item[(2)]\ We call $\Theta$ {\bf compact} provided $|\supp(\Theta)|$ is a compact subset of $|X|$.
\end{itemize}
\qed
\end{definition}
If $V(x')\subset U(x)$, $x$ smooth,  we can replace $M_i$ by $N_i=M_i\cap V(x')$ and obtain an induced representation using the same weights on $V(x')$
$$
\Theta(y)=\sum_{\{i\in I\ |\ y\in N_i\}} \sigma_i \ \ \text{for}\ \ y\in V(x').
$$
Note that some (or all) of the $N_i$ might be empty. 
We can always find symmetric representations.
Namely, take $V(x)\subset U(x)$ so that $V(x)$ admits the natural $G_x$-action. Without loss of generality
assume that for $V(x)$ the manifolds $(M_i)$ and weights $(\sigma_i)$ are given, where $i\in I$.
Then define a new index set $J:=I\times G_x$, and  $M_{i,g}:= g\ast M_i$.  With the weights $\sigma_{(i,g)}$ defined 
by
$$
\sigma_{(i,g)}=\frac{1}{|G_x|}\cdot \sigma_i,
$$
we obtain a new local branching structure ${(M_{(i,g)})}_{(i,g)\in J}$, ${(\sigma_{(i,g)})}_{(i,g)\in J}$. Indeed we compute, using that $\Theta$ is a functor.
\begin{eqnarray*}
\sum_{\{(i,g)\in J\ |\ y\in g\ast M_i\}} \sigma_{(i,g)}&=& \frac{1}{|G_x|}\cdot \sum _{\{(i,g)\in J\ |\ g^{-1}\ast y\in M_i\}}\sigma_i\\
&=& \frac{1}{|G_x|}\cdot \left(\sum_{g\in G_x} \left(\sum_{\{i\in I\ |\ g^{-1}\ast y\in M_i\}} \sigma_i\right)\right)\\
&=&\frac{1}{|G_x|}\cdot\sum_{g\in G_x} \Theta(g^{-1}\ast y)\\
&=&\Theta(y).
\end{eqnarray*}
The interesting point is that $G_x$ acts on $J$ via $(h,j)\rightarrow h(j)$,  and in addition  $h\ast M_{j}=M_{h( j)}$,  and  $\sigma_{j}=\sigma_{h(j)}$ for $h\in G_x$ and $j\in J$.
Hence we have established the following result.
\begin{lemma}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched ep$^+$-subgroupoid of the ep-groupoid $X$. Then there exists for every 
object $x\in X$ with $\Theta(x)>0$ an open neighborhood $U(x)$ admitting the natural $G_x$-action,  submanifolds $(M_i)$, $i\in I$,
properly embedded in $U(x)$, a $G_x$-action on $I$,  and rational weights $\sigma_i>0$,  such that the following holds.
\begin{itemize}
\item[(1)]\ $g\ast M_i = M_{g(i)}$ for all $i\in I$.
\item[(2)]\ $\sigma_{i}=\sigma_{g(i)}$ for $g\in G_x$ and $i\in I$.
\item[(3)]\ $\Theta(y)=\sum_{\{i\in I\ |\ y\in M_i\}}\sigma_i$  for $y\in U(x)$. 
\end{itemize}
\qed
\end{lemma}
We can distinguish different types of branched ep$^+$-subgroupoids.
\begin{definition}[Types of $\Theta$]\label{DEF917}\index{D- Types of $\Theta$}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subgroupoid.
\begin{itemize}
\item[(1)]\ We say $\Theta$ is of {\bf manifold-type}\index{Manifold-type $\Theta$} provided $\Theta$ only takes the values $0$ and $1$,
and between objects  $x,y\in \supp(\Theta)$ there is at most one morphism.
\item[(2)]\ We say that $\Theta$ is of {\bf orbifold-type}\index{Orbifold-type $\Theta$} provided $\Theta$ only takes the values $0$ and $1$.
\end{itemize}
\qed
\end{definition}

The basic result about  branched ep-subgroupoids of the flavors described above is given in the following proposition. 
\begin{proposition}[Natural smooth structures]\label{PROPY918}\index{P- Smooth structures from types}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subgroupoid. Consider the orbit space $|\supp(\Theta)|\subset |X|$ with the induced
metrizable topology. 
\begin{itemize}
\item[{\em(1)}]\  If $\Theta$ is of manifold-type then the ep-groupoid $X$ induces on the orbit space 
$S=|\supp(\Theta)|$  a natural smooth manifold structure. 
\item[{\em(2)}]\  If $\Theta$ is of orbifold-type then $X$ induces on $S=|\supp(\Theta)|$ a natural smooth orbifold structure.
\end{itemize}
\end{proposition}
\begin{remark}\label{remark918}
Here the notion of manifold and orbifold  are the M$^+$-polyfold versions. In particular if $d_{|X|}(z)=0$ for a every $z\in |\supp(\Theta)|$ 
it holds that $S$ has a natural (classical) smooth manifold structure in case (1) and a natural (classical) smooth orbifold structure  in case (2).
\qed
\end{remark}
\begin{proof}
Denote by $Z$ the orbit space $|\supp(\Theta)|$ and equip it with the induced (metrizable) topology
from $|X|$. 
For every $x$ with  $\Theta(x)>0$ we find an open neighborhood
$U(x)$ with the natural  $G_{x}$-action so that $U(x)$ has the properness property, and properly embedded
manifolds $M_i$, $i\in I$, with $x\in M_i$, and rational weights $\sigma_i>0$ allowing us to write
$$
\Theta(y)=\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i\ \ \text{for}\ y\in U(x).
$$
Also $G_{x}$ acts on $I$ and $g\ast M_i=M_{g(i)}$.

First we draw a conclusion from the assumption that $\Theta$ only takes values in $\{0,1\}$.
Assuming that $M_i\neq M_j$ for some $i\neq j$
we find $y$ such that $y\in M_i$ and $y\not \in M_j$, which implies 
$$
0<\Theta(y)<\Theta(x)=1.
$$
 This is a contradiction
since $\Theta$ either takes the value $0$ or $1$.  Having established that all $M_i$ are identical we can replace our local branching structure by a single submanifold, denoted by $M_{x}$, properly embedded in $U(x)$ and the weight $\sigma=1$.
This implies the representation
$$
\Theta(y)= \delta_{M_{x}}(y)=\left[\begin{array}{cc}
1&\text{if}\ y\in M_x\\
0&\text{if}\ y\in U(x)\setminus M_{x}
\end{array}
\right.
$$
Define the maps $\Psi_x:M_x\rightarrow Z:w\rightarrow |w|$ for $x\in \supp(M)$.

In order to prove (1) we employ the assumption that between any two points in $\supp(\Theta)$ there is at most one 
isomorphism. The first consequence of this assumption is that every $\Psi_x$ is injective. 
Indeed, we must have that $G_{x}=\{1_{x}\}$ because otherwise there would be at least two isomorphisms 
from $x$ to itself.  Assuming $\Psi_x(w)=\Psi_x(w')$ for $w,w'\in M_x$ 
there exists $g\in G_{x}$ with $\Gamma(g,w)=w'$. Since  $g= 1_{x_z}$ we deduce that $w=w'$.

Assume that  $\Psi_x$ and $\Psi_{x'}$ have an intersecting image.   Pick $w\in M_x$ and $w'\in M_{x'}$ 
so that $\Psi_x(w)=\Psi_{x'}(w')$. Hence there exists a morphism $\phi: w\rightarrow w'$ in $\bm{X}$.
We find open neighborhoods $U(w)\subset U(x)$,  $U(w')\subset U(x')$, and $U(\phi)\subset \bm{X}$ so that
$s:U(\phi)\rightarrow U(w)$ and $t:U(\phi)\rightarrow U(w')$ are sc-diffeomorphisms, which we use to define 
the sc-diffeomorphism $f:U(w)\rightarrow U(w')$ by
$$
f(v) = t\circ (s|U(\phi))^{-1}(v).
$$
If $v\in U(w)\cap M_x$ it follows that $f(v)\in M_{x'}$ since both manifolds represent $\Theta$. If $v'\in U(w')\cap M_{x'}$ we similarly conclude that $f^{-1}(v')\in M_x$.
We note that $f(v) = \Psi_{x'}^{-1}\circ \Psi_x(v)$ which implies that $\Psi_x$ and $\Psi_{x'}$ are sc-smoothly compatible. 
Since the $\Psi_x$ are defined on smooth manifolds $M_x$  we can use them to construct ordinary M$^+$-polyfold charts for the metrizable space $Z$,
which then by the previous discussion are smoothly compatible. It is evident that the smooth manifold structure on $Z$ 
does not depend on the choices of the  specific $U(x)$ picked for $x$.  The easy argument follows the above line and is left to the reader.
This completes the proof of (1).

In order to establish (2) we consider the maps $\Psi_x : M_x\rightarrow Z$.  In this case $G_x$ acts on $M_x$
fixing $x$, and the maps $\Psi_x$ are the restrictions 
of the projections $\pi_x:U(x)\rightarrow |X|$ which induce homeomorphisms $_{G_x}\backslash U(x)\rightarrow |U(x)|$, i.e.
$$
\Psi_x =\pi_x|M_x.
$$
Hence $\Psi_x:M_x\rightarrow Z$ are continuous maps inducing homeomorphism when we pass to the $G_x$-quotient.
Given $x,x'\in \supp(\Theta)$ define ${\bm{M}}(x,x')$ by
$$
\bm{M}(x,x')=\{\phi\in\bm{X}\ |\ s(\phi)\in M_x,\ t(\phi)\in M_{x'}\}.
$$
This is submanifold of $\bm{X}$ and has therefore an induced smooth manifold structure for which $s:{\bm{M}}(x,x')\rightarrow M_x$ and $t:{\bm{M}}(x,x')\rightarrow M_{x'}$ are local (classical) diffeomorphisms.
Denote by $M$ the disjoint union of the $M_x$. We can view this manifold as the object space of a small category,
where the morphism set is the disjoint union of all $\bm{M}(x,x')$.  This category, denoted by $M$, turns out to be 
an \'etale proper Lie groupoid, see \cite{Mj}  (Note that our notion of smooth manifold is more general since we use M$^+$-polyfolds, see Remark
\ref{REM911}).  We have a natural functor 
$$
\beta:M\rightarrow Z: \left[\begin{array}{cc}
\beta(y) = \pi_x(y),& y\in M_x\\
\beta(\phi) =1_{\beta(s(\phi))}, & \phi\in \bm{M}(x,x')
\end{array}
\right.
$$
where $Z$ is viewed as a category  with only the identities as morphisms.
By construction, passing to the orbit space $|M|$ we obtain the homeomorphism $|\beta|:|M|\rightarrow |Z|=Z$.  Hence it equips $Z$ with an orbifold structure. Again different choices for $x\in \supp(\Theta)$
would lead to a different  \'etale proper Lie groupoid $M'$  (in our M$^+$-context) and $\beta':M'\rightarrow Z$. However, this data defines an equivalent orbifold structure.  The metrizable space $Z$ equipped with such an equivalence class
of orbifold structures is called an orbifold. The equivalence classes appear since in the construction choices have to be made.
Of course, the nature of such an equivalence class has to be investigated. We leave this to the reader. There are no surprises
and a reader knowledgeable with the notion of Morita equivalence of \'etale proper Lie groupoids will be able to carry this out.
For details in the Lie groupoid case,  see \cite{Mj} or \cite{AE}, and for the polyfold version for topological spaces see the constructions in Section \ref{SEC2} and Part IV. The relevant fibered product constructions are similar to those described in the next chapter \ref{SEC2}.
\qed \end{proof}

Next we show that a branched ep$^+$-subgroupoid $\Theta:X\rightarrow {\mathbb Q}^+$ has a natural dimensional decomposition.
\begin{proposition}\label{PROP919}\index{D- Dimensional decomposition of $\Theta$}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subgroupoid.
Then there is a uniquely determined sequence $\Theta_0,\Theta_1,..$ of branched ep$^+$-subgroupoids
$$
\Theta_k:X\rightarrow {\mathbb Q}^+,\ k\in \{0,1,...\},
$$
uniquely characterized by the following two properties.
\begin{itemize}
\item[{\em(1)}]\ $\Theta_k$ is $k$-dimensional.
\item[{\em(2)}]\ $\Theta=\Theta_0+\Theta_1+....$. 
\end{itemize}
We also note that the sum in (2) is locally finite.
\end{proposition}
\begin{proof}
  If $x$ does not belong to the support of $\Theta$ 
we define $\Theta_k(x)=0$ for every $k\in \{0,1,2,..\}$.
If  $x\in X$ is  a point in $\supp(\Theta)$ we take 
on a suitable open neighborhood $U(x)$, invariant under the $G_x$-action, and having a symmetric  local branching structure ${(M_i)}_{i\in I}$,
${(\sigma_i)}_{i\in I}$. We can decompose $I=I_0+....+I_n$, where $M_i$ for $i\in I_k$
is $k$-dimensional. Since $I$ is finite we see that $I_k=\emptyset $ for $k$ large enough.
Since the action of $G_x$ preserves dimension the sets $I_k$ are $G_x$-invariant.
Associated to ${(M_i)}_{i\in I_k}$ and ${(\sigma_i)}_{i\in I_k}$ we can define $\Theta_k$ on $U(x)$ in the obvious way by
$$
\Theta_k(y)=\sum_{\{i\in I_k\ |\ y\in M_i\}} \sigma_i.
$$
We can do this for every $x\in \supp(\Theta)$ and the local definitions are compatible
since morphisms preserve dimension.  By construction the sum is locally finite.
The uniqueness of the decomposition is obvious.
\qed \end{proof}



\section{The Tangent and Boundary  of \texorpdfstring{$\Theta$}{plu}}\label{SECX9.2}
In the preparation for defining  orientations for branched ep$^+$-subgroupoids we need to introduce the notion
of the tangent of $\supp(\Theta)$. As a by-product we shall also see that associated to $\Theta$
there is a branched ep-subgroupoid $T\Theta:TX\rightarrow {\mathbb Q}^+$, where, not surprisingly, the local branching structure 
on $TU(x)$ is given by ${(TM_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, if ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$  is the one for $\Theta$ over $U(x)$.

Let $x$ be a smooth object in the ep-groupoid $X$. 
We consider finite formal sums 
$\sum_{i\in I} \sigma_i \cdot L_i$, where $I$ is a finite set, the $\sigma_i$ are positive rational numbers, and the $L_i$ are
smooth finite-dimensional linear subspaces of $T_xX$. 
With other words, we take first the free vector space over ${\mathbb Q}$ generated by all finite-dimensional smooth linear subspaces
and then take elements in the cone defined by sums with non-negative coefficients.
In particular  the trivial subspace denoted by
$O$ is one of the generators, so that for example  $1\cdot O + 3\cdot L$ is an admissible formal sum.
We identify
$$
\sigma_i\cdot L_i +\sigma_j \cdot L_j = (\sigma_i+\sigma_j)\cdot L
$$
provided $L_i=L_j=L$. This allows us to write any such sum as   $\sum \sigma_L\cdot L$,
where only a finite number of $\sigma_L$ are non-zero (and positive rational).  Sometimes we abbreviate
$$
\mathsf{L}:= \sum \sigma_L\cdot L.
$$
We denote the set of all such formal sums by  $\text{Gr}(x)$, and  define  $\text{Gr}(X)$ as the union
$$
\text{Gr}(X):=\bigcup_{x\in X_\infty} \text{Gr}(x).
$$
There is a natural projection map $\pi: \text{Gr}(X)\rightarrow X_\infty$.  We shall consider the points in the set $\text{Gr}(X)$ as the objects of a category.
The morphisms for this category are the pairs $(\mathsf{L},\phi)$ with $\phi\in \bm{X}_\infty$ and $\mathsf{L}\in \text{Gr}(s(\phi))$.
The source and target maps are given by 
$$
s(\mathsf{L},\phi)=\mathsf{L}
$$ 
 and 
$$
t\left(\sum\sigma_L\cdot L,\phi\right)=\sum\sigma_L\cdot T\phi(L),
$$
where we recall that for smooth $\phi$  we have the well-defined sc-isomorphism 
$$
T\phi:T_{s(\phi)}X\rightarrow T_{t(\phi)}X.
$$
The composition of morphisms $(\mathsf{L},\psi)$ and $\mathsf{K},\phi)$ with $s(\mathsf{L},\psi)=t(\mathsf{K},\phi)$ is defined by
$$
(\mathsf{L},\psi)\circ (\mathsf{K},\phi)=(\mathsf{K},\psi\circ\phi).
$$
The identity elements have the form $(\mathsf{L},1_{\pi({\mathsf{L}})})$, and
the projection $\pi:\text{Gr}(X)\rightarrow X_\infty$ extended to morphisms by $\pi(\mathsf{L},\phi)=\phi$ becomes a functor.

\begin{theorem}\label{P15.2*1}\index{T- Functor $\mathsf{T}_\Theta$}\index{$\mathsf{T}_\Theta$}
Let  $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched ep$^+$-sub\-group\-oid. Associated to $\Theta$
there is a natural section functor $\mathsf{T}_\Theta:X_\infty\rightarrow \text{Gr}(X)$, i.e. 
$$
\pi\circ T_\Theta = Id_{X_\infty},
$$
 which is characterized by the following properties.
\begin{itemize}
\item[{\em(1)}]\ If $x\in \supp(\Theta)$ it holds $\mathsf{T}_\Theta(x)=\sum_{i\in I} \sigma_i\cdot T_xM_i$, where $(M_i)$ and $(\sigma_i)$ is any local branching structure
for $\Theta$ at $x$.  If $x\not\in \supp(\Theta)$  it holds that $T_{\Theta} (x)$ is the zero-sum.
\item[{\em(2)}]\ For a morphism $\phi$ it holds that $\mathsf{T}_\Theta(\phi): \mathsf{T}_\Theta(s(\phi))\rightarrow \mathsf{T}_\Theta(t(\phi))$ is given by 
$\mathsf{T}_\Theta(\phi)=(\mathsf{T}_\Theta(s(\phi)),\phi)$.
\end{itemize}
\qed
\end{theorem}
The proof is given later after Lemma \ref{LEM1526}.
The difficult part is (1), where one needs to show that the definition does not depend on the local branching structure.  It suffices to prove the proposition in the equidimensional case and to define 
$$
\mathsf{T}_{\Theta} =\sum_{k=0}^\infty \mathsf{T}_{\Theta_k}.
$$
The proof needs a considerable amount of preparation and we follow the presentation in \cite{HWZ7}.
 
\begin{definition}\label{D15.2.2}\index{D- Good point}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched equidimensional ep$^+$-subgroupoid and ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ be a local branching structure on $U=U(x)$, where $x\in \supp(\Theta)$.  Define $M_U = \bigcup_{i\in I} M_i$\index{$M_U$}. A point $y\in M_U$ is called a {\bf good point}\index{Good points}
(with the respect to the given branching structure) provided there exists an open neighborhood $V(y)\subset U(x)$ such that
$V(y)\cap M_i = V(y)\cap M_j$ for all $i,j\in I_y:=\{k\in I\ |\ y\in M_k\}$. 
\qed
\end{definition}
The notion of being a good point turns out to be independent of the local branching structure and an intrinsic notion
for $\Theta$ as shown in the next result.
\begin{lemma}[\cite{HWZ7}, Lemma 2.2]\label{L15.2.3}\index{L- Good points}
Assume that $\Theta:X\rightarrow {\mathbb Q}^+$ is a branched equidimensional ep$^+$-subgroupoid. For $x\in \supp(\Theta)$
consider on the open neighborhood  $U(x)$  two local branching structures resulting 
in $M_U$ and $N_U$ (which have to be equal). If $y\in M_U=N_U$ is a good point for the first 
local branching structure the same holds with respect to the  second local branching structure.
\end{lemma}
\begin{proof}
Abbreviate $A=M_U=N_U$ and assume that $y\in A$ is good for the first local branching structure.
We find an open neighborhood $V(y)\subset U(x)$ so that
\begin{eqnarray}\label{ART1}
&M_i\cap V(y)= M_{i'}\cap V(y) \ \ \text{for}\ \ i,i'\in I_y=\{i''\in I\ |\ y\in M_{i''}\}.&
\end{eqnarray}
We note that $i_0\not\in I_y$ implies $y\not\in\cl_X(M_{i_0})$. Indeed, that $M_{i_0}\subset U(x)$
is properly embedded  would imply that $y\in M_{i_0}$ and therefore $i_0\in I_y$.
Hence we can pick $V(y)$ so small that in addition to (\ref{ART1}) also the following holds
\begin{eqnarray}\label{ART2}
& M_i\cap V(y)=\emptyset\ \ \text{for}\ \ i\in I\setminus I_y.&
\end{eqnarray}
 Using the representation for $\Theta$ we see that 
for $z\in V(y)\cap A$
$$
\Theta(y) = \Theta(z).
$$
For the second branching structure ${(N_j)}_{j\in J}$, ${(\tau_j)}_{j\in J}$ we find an open neighborhood $W(y)\subset U(x)$
such that $J_z\subset J_y$ for $z\in W(y)\cap A$, which again is a consequence 
of the properness. This implies 
$$
\Theta(z) =\sum_{j\in J_z} \tau_j\leq \sum_{j\in J_y} \tau_j =\Theta(y)\ \text{for}\ z\in W(y)\cap A.
$$
On $V(y)\cap W(y)\cap A$ we must therefore have the equality $J_z=J_y$ because otherwise the left-hand side 
in the last expression would be strictly smaller, giving a contradiction.
Hence we have proved that with $Q(z)=V(y)\cap W(y)$ it holds that $N_j\cap Q(z)=N_{J'}\cap Q(z)$
for all $j,j'\in J_y$. This shows that $y$ is a good point for the second branching structure.
\qed \end{proof}
\begin{remark}\label{REMr3} \index{R- On good points}
(a)  In view of Lemma \ref{L15.2.3} being a good point for $\Theta$  is an intrinsic notion. 

\noindent (b)  At a good point $y$ we can take a suitable open neighborhood $V(y)$ and a submanifold
$M$ properly contained in $V(y)$ so that $\Theta(z)=\sigma\cdot \delta_M(z)$ for $z\in V(y)$,
where $\sigma>0$ is a rational weight and $\delta_M(y)=1$ if $y\in M$ and $0$ otherwise.

\noindent(c)  Since we can transport local branching structures around by morphisms we obtain the following result.
\qed
\end{remark}
\begin{lemma}\label{L15.2.4}\index{L- Good points}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be  a branched equidimensional ep$^+$-subgrou\-poid. 
Assume that $\phi\in \bm{X}$ so that $s(\phi)\in\supp(\Theta)$ (and then also $t(\phi)\in \supp(\Theta)$).
Then $s(\phi)$ is a good point if and only if $t(\phi)$ is a good point.
\end{lemma}

Following \cite{HWZ7}
we introduce the sets of good and bad points for $\Theta$.
\begin{definition}\index{$S^g_\Theta$}\index{$S^b_\Theta$}\index{D- Set of good points}\index{D- Set of bad points}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched equidimensional ep$^+$-subgroupoid.  The {\bf set of good points} 
is denoted by $S^g_\Theta$ and consists of all points in $\supp(\Theta)$ which are good for $\Theta$
in the sense of Definition \ref{D15.2.2}. The {\bf set of bad points} is defined by $S^b_\Theta=\supp(\Theta)\setminus S^g_\Theta$.
\end{definition} 

In view of Remark \ref{REMr3} (c) following Lemma \ref{L15.2.3},   the notion of being a good point or bad point descends to orbit spaces.
With $|S^g_\Theta|$ and $|S^b_\Theta|$  being the induced subsets in $|X|$ it holds that 
$$
\pi^{-1}(|S^g_\Theta|)=S^g_\Theta\ \ \text{and}\ \ \pi^{-1}(|S^b_\Theta|)=S^b_\Theta,
$$
where $\pi:X\rightarrow |X|$ is the obvious map.

\begin{lemma}\label{LEM1526}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a branched equidimensional ep$^+$-sub\-groupoid and $S^g_\Theta$ and $S^b_\Theta$
the set of good and bad points, respectively. 
\begin{itemize}
\item[{\em(1)}]\ The set $S^g_\Theta$ is open and dense, and $S^b_\Theta$ is closed and nowhere
dense in $\supp(\Theta)$. 
\item[{\em(2)}]\ Assume a bad point $x\in \supp(\Theta)$ and a local branching structure on $U(x)$,
say ${(M_i)}_{i\in I}$ and ${(\sigma_i)}_{i\in I}$ on $U(x)$ representing $\Theta$ on $U(x)$,
are given. Then for every $i\in I$ there exists a sequence of good points $(x_k)$ contained in
$M_i$ and converging to $x$.
\end{itemize}
\end{lemma}
\begin{proof}
\noindent(1) The set $\sg$ is open by  definition. Hence its complement $\sba$ is closed and we
show that it is nowhere dense. At this point the proof of (2) will imply the validity of (1).\par

\noindent(2) Fix a metric $d$ on object M-polyfold $X$ (Compatibility with morphisms is not required.). By taking a possibly smaller $U(x)$ we may assume that $M_i=M_{i'}$ in $U(x)$
provided it holds near $x$. By redefining the weights and the index set we may assume without loss of generality that
$M_i=M_{i'}$ if and only if $i=i'$.  Since $x$ is bad we must have at least two indices.
 
 Take   a monotonically decreasing sequence $(\varepsilon_k)$ of positive real numbers converging to 
$0$. Define $D_k(x)=\{y\in U(x)\ |\ d(x,y)\leq \varepsilon_k\}$. If  $\varepsilon_1$ is small enough
we may assume without loss of generality that every $D_k(x)$ is a closed subset of $X$.
For large $k$ the subsets $M_i\cap D_k(x)$ are compact. To see this recall that there exists
an sc$^+$-retraction $r:W(x)\rightarrow W(x)$ for a suitable open neighborhood $W(x)$ of $x\in X$, so that
$r(W(x))=W(x)\cap M_i$. If we take a sufficiently small closed $\varepsilon$-ball, which is contained in
$W(x)$, its image under $r$ will be compact using the compactness property of the inclusions
of the Banach spaces in the scale and the fact that $r$ is sc$^+$-smooth. In view of this we may assume
by taking perhaps $\varepsilon_1>0$ smaller that 
$M_i\cap D_k(x)$ is a compact metric space for all $k\geq 1$.
The same holds without loss of generality for
$$
A^k :=  \bigcup_{i\in I} (M_i\cap D_k(x)) \subset D_k(x).
$$
After fixing $i_0\in I$ and $k$,  consider for $i\in I\setminus \{i_0\}$ the closed subset
 of $M_{i_0}\cap D_k(x)$ defined
by
$$
\Sigma_k^i = M_i\cap M_{i_0}\cap D_k(x).
$$
 The
 complement 
$$
(M_{i_0}\cap D_k(x))\setminus \bigcup_{i\in I\setminus\{i_0\}} \Sigma^i_k
$$
it is an open subset of $M_{i_0}\cap D_k(x)$, which, of course, might be empty.
If it is nonempty  we we can pick a point $x_k$ in this set  having the additional property
that $d(x_k,x)<\varepsilon_k$, which then  necessarily is a good point. 
If the set is empty we have the identity
$$
M_{i_0}\cap D_k(x)=  \bigcup_{i\in I\setminus\{i_0\}} \Sigma^i_k.
$$
This means that at least one of the $\Sigma^i_k$ has non-empty interior, say
$\Sigma_{k}^{i_1}$. Pick a point $x_k'$ in the interior of the latter. If $x_k'$ lies for some $i\neq i_1$
in  $\Sigma_k^{i}$ but not in its interior,  we can move it slightly so that its does not belong to the set
$\Sigma_k^i$, but by staying
still in the first set $\Sigma_{k}^{i_1}$.  Continuing this way we find a $x_k\in M_{i_0}$
with $d(x,x_k)<\varepsilon_k$ so that for a nonempty $\Sigma_k^i$ we either do not belong to this set
or we belong to the interior. Clearly $x_k$ is a good point. By construction we have now a sequence 
of good points $(x_k)\subset M_{i_0}$ which converges to $x$.
This completes the proof of the lemma.
\qed \end{proof}
Now we are in the position to show that the functor $\mathsf{T}_\Theta$ is well-defined.
\begin{proof}[Theorem \ref{P15.2*1}]
Let $x\in \supp(\Theta)$. If $x$ is a good point the functor $\Theta$ can be  represented near $x$ by a single (near $x$ uniquely determined) submanifold
$M_x$ contained properly in an open neighborhood $U(x)$ and the rational weight $\sigma_x=\Theta(x)$.
Since $\Theta$ is constant on $M_x$ we have the identity 
$$
\Theta(y)=\Theta(x)\cdot\delta_{M_x}(y)\ \ \text{for}\ \ y\in U(x).
$$
Hence 
$$
\mathsf{T}_\Theta(y)=\Theta(y)\cdot T_yM_x\ \ \text{for}\ \ y\in U(x).
$$
This shows that $\mathsf{T}_\Theta$ is well-defined at good points.

Next we assume that $x\in\supp(\Theta)$ is a bad point. 
We take  a branching structure
on a suitable $U(x)$ representing $\Theta$, which we denote   by ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$. 
Since $\Theta$ is equidimensional all occurring manifolds have the same dimension, say $n$.
 We define an  {\bf equivalence relation}\index{Equivalence relation $i\sim i'$} $\sim$  on $I$  by saying that $i\sim i'$ provided $T_xM_i=T_xM_{i'}$.
 An equivalence class is denoted by $[i]$.\index{$[i]$}
The next part of the construction is a finite induction which terminates  once we run out of indices. 
We formulate the needed assertion in the following proposition which is proved utilizing several lemmata.
\begin{proposition}\label{890}
Under the previously stated assumptions.
Starting with an $\sim$-equivalence class $\Xi$ of indices in $I$ there exists a finite sequence
of indices $i_1,..,i_p\in I$ such $[i_1]=...=[i_p]=\Xi$  with the following properties.
\begin{itemize}
\item[{\em(1)}]\ For every $e\in \{1,...,p\}$ there exists a  nonempty subset $I^e$ of $\Xi$ containing $i_e$. These subsets are mutually disjoint and $\Xi= I^1\sqcup..\sqcup I^p$. 
\item[{\em(2)}]\ For every $e\in \{1,...,p\}$ there exists a sequence of good points $(x_k^e)\subset U(x)$ converging to
$x$ such that $x_k^e\in M_i$ if and only if $i\in I^e$.
\end{itemize}
\end{proposition}
\begin{proof}
The consideration being local, 
we may assume that we are given a partial quadrant $C$ in the sc-Banach space $E$
and M$^+$-polyfolds ${(M_i)}_{i\in I}$ of dimension $n$ containing the point $x=0$.
The set $I$ is the disjoint union of equivalence classes and we fix one, say $\Xi$.
If $n=0$ the point $0$ is isolated and therefore a good point. Hence we may assume 
that $n\geq 1$.  Writing $\Xi=[i_1]$ define $L^1:=T_0M_{i_1}$ and consider
$L^1\cap C$. 
\begin{lemma}\label{1528}
Under the previously stated assumptions it holds $\text{int}_{L^1}(L^1\cap C)\neq \emptyset$.
\end{lemma}
\begin{proof} Take $M_{i}$ for $i\in \Xi$ and, with the considerations being local, we may assume
there exist a relatively open neighborhood $U\subset C$ of $0\in C$  and a sc$^+$-retraction
$r:U\rightarrow U$ with $r(U)=U\cap M_i= M_i$ and $r(0)=0$.

We  consider for every $h\in C$ with $h\in E_1$ the $C^1$-path 
$$
[0,\varepsilon)\rightarrow C:\tau\rightarrow r(\tau\cdot h).
$$
From this we conclude, differentiating at $\tau=0$,  the fact that $Dr(0)h\in C$.
Since $Dr(0)$ has  a continuous extension to $E_0$ we conclude that
$$
Dr(0)(C)\subset C.
$$
The operator $Dr(0):E_0\rightarrow L^1$ is surjective and therefore open.
Pick a nonzero vector $h_0$  in $C$ with $Dr(0)(h_0)=h_0$.
We find a close-by vector $h_1$ which lies in the interior of $C$ such that $Dr(0)h_1\neq 0$.
Hence we find a sufficiently small $\varepsilon >0$ such that $B_\varepsilon^{E_0}(h_1)\subset C$,
and   $Dr(0)(B_\varepsilon^{E_0}(h_1))\subset C\cap L^1$ consists of nonzero vectors,
and is an open neighborhood of $h_1$ in $C\cap L^1$. This completes the proof of the lemma.
\qed \end{proof}
Abbreviate $L:=L^1$ and pick  $h_0\in \text{int}_{L}(L\cap C)$ with $\norm{h_0}_{E_0}=1$.
Define for $\varepsilon>0$ 
$$
S_\varepsilon(h_0):=\{\tau\cdot h\ |\ \tau>0,\ h\in L,\  \norm{h}_{E_0}=1,\ \norm{h-h_0}_{E_0}<\varepsilon\},
$$
which lies for sufficiently small
 $\varepsilon>0$ in $\text{int}_{L}(L\cap C)$. We call $S_\varepsilon(h_0)$\index{$S_\varepsilon(h_0)$} the  {\bf open $\varepsilon$-cone}
 \index{$\varepsilon$-cone around $h_0$}
 around $h_0$ in $L$.  Moreover, in this case  the associated {\bf closed $\varepsilon$-cone}  $\bar{S}_\varepsilon(h_0):=\cl_L(S_\varepsilon(h_0))$ belongs to
 $L\cap C$ and is given by 
 $$
 \bar{S}_\varepsilon(h_0):=\cl_L(S_\varepsilon(h_0))=\{\tau\cdot h\ |\ \tau\geq 0,\ h\in L,\  \norm{h}_{E_0}=1,\ \norm{h-h_0}_{E_0}\leq\varepsilon\}.
 $$
\begin{lemma} \label{891}
Under the previously stated assumptions. Let $h_0\in \text{int}_L(L\cap C)$ with $\norm{h}_{E_0}=1$.
There exists $\delta >0$ and an sc-complement $Z$ of $L$ in $E$
such that suitable subsets of  $M_i$ with $i\in [i_1]$ can be written  as 
$$
a+B_i(a), \  \norm{a}_0<\delta,\ a\in \cl_L(S_\delta(h_0)),
$$
where $i\in [i_1]$, $B_i(0)=0$, $DB_i(0)=0$ and $B_i(a)\in Z$.
\end{lemma}
\begin{proof}
Pick an sc-complement $Z$ of $L$ so that $E=L\oplus Z$ and 
denote by $P:E\rightarrow E$ the associated sc-projection onto $L$.
We compute for $a\in L\cap C$ with $r=r_i$, the sc$^+$-retraction associated to $M_i$ near $0$
\begin{eqnarray}\label{892}
r(a)& =&\left(\int_{0}^{1} Dr(s\cdot a)ds\right)(a)\\
&=& Dr(0)(a) + \left(\int_0^1 (Dr(s\cdot a)-Dr(0))ds\right) (a)\nonumber\\
&=& a + \left(\int_0^1 (Dr(s\cdot a)-Dr(0))ds\right) (a)\nonumber\\
&=:& a + A(a)(a)\nonumber\\
&=& (a + PA(a)(a)) +(I-P)A(a)(a).\nonumber
\end{eqnarray}
We observe that by construction $A(0)=0$. 
The map  $a\rightarrow a+PA(a)a$ is defined on a suitable open neighborhood
$V(0)$ of $0$ in  $C\cap L$.   Hence we introduce the map
$$
\Phi: V(0)\rightarrow L:a\rightarrow a+PA(a)a.
$$
We need the following fact about $\Phi$.
\begin{lemma}\label{893}
Under the previously stated assumptions there exists a sufficiently small $\delta>0$ and $\sigma>0$ 
so that $ \cl_L (S_{\delta}(h_0))\subset C\cap L$, $\{a\in L\cap C\ |\ \norm{a}_{E_0}\leq   \sigma\}\subset V(0)$,  and in addition
the map
$$
\Phi:\{a\in \bar{S}_\delta(h_0)\ |\ \norm{a}_{E_0}\leq \sigma\}\rightarrow C\cap L
$$
is injective, has invertible derivatives,  and its image 
contains  the set 
$$
\{b\in \cl_L(S_{\delta/2}(h_0))\ |\ \norm{b}_{E_0}\leq \sigma/2\}.
$$
 The inverse of $\Phi$ restricted to the set $\{b\in \cl_L(S_{\delta/2}(h_0))\ |\ \norm{b}_{E_0}\leq \sigma/2\}$
defines a smooth map $\Psi$ with $\Psi(0)=0$
and $D\Psi(0)=Id_L$.
\end{lemma}
\begin{proof}
Given $h_0\in \text{int}_L(L\cap C)$ with $\norm{h_0}_{E_0}=1$ there exists $\varepsilon>0$
so that every $h\in L$ with $\norm{h}_{E_0}=1$ and $\norm{h-h_0}_{E_0}\leq \varepsilon$
satisfies $h\in C\cap L$. As a consequence, if $h\in L$ and $\norm{h- \norm{h}_{E_0}\cdot h_0}_{E_0}\leq \varepsilon\cdot \norm{h}_{E_0}$, then $h\in C\cap L$.  Now consider
for $a\in L\cap C$ (close enough to $0$) 
$$
\Phi(a)=a+PA(a)a =:a+\wt{A}(a).
$$
We have that $\wt{A}(0)=0$ and $D\wt{A}(0)=0$. Given $\tau\in (0,1)$ we therefore  find $\sigma>0$ so that for $a\in L\cap C$ with $\norm{a}_{E_0}\leq \sigma$ the following estimates hold
\begin{eqnarray}\label{1000}
&\norm{D\wt{A}(a)}_{L(E_0)}\leq \tau&\\
&\norm{\wt{A}(a)}_{E_0}\leq \tau\cdot \norm{a}_{E_0}&\nonumber \\
&\norm{\Phi(a)}_{E_0}\geq (1-\tau)\cdot \norm{a}_{E_0}.&\nonumber
\end{eqnarray}
Hence we estimate for $a\in L\cap C$ with $\norm{a}_{E_0}\leq \sigma$ and addition belonging to $\bar{S}_\delta(h_0)$
\begin{eqnarray*}
&&\norm{\Phi(a)-\norm{\Phi(a)}_{E_0}\cdot h_0}_{E_0}\\
&=& \norm{a +\wt{A}(a) - \norm{a +\wt{A}(a)}_{E_0}\cdot h_0}_{E_0}\\
&\leq & \norm{a-\norm{a}_{E_0}\cdot h_0}_{E_0} + 2\cdot \norm{\wt{A}(a)}_{E_0} \\
&\leq& \norm{a-\norm{a}_{E_0}\cdot h_0}_{E_0} + 2\tau \cdot \norm{a}_{E_0} \\
&\leq&(\delta +2\tau)\cdot\norm{a}_{E_0}\\
&\leq &(\delta +2\tau)\cdot (1-\tau)^{-1}\cdot  \norm{\Phi(a)}_{E_0}.
\end{eqnarray*}
Hence, if we take $\tau\in (0,1)$ and $\delta\in (0,\varepsilon)$ small enough,  we conclude for 
$a\in \bar{S}_\delta(h_0)$ with $\norm{a}_{E_0}\leq \sigma$  that $\Phi(a)\in \cl_L(S_\varepsilon(h_0))\subset L\cap C$.

Next we show that for sufficiently small $\sigma>0$, so that in particular the previous discussion  holds,
the image of $\Phi$ when restricted to points in $\bar{S}_\delta (h_0)$ with $\norm{a}_{E_0}\leq \sigma$
contains the points in $\bar{S}_{\delta/2}(h_0)$ with $\norm{a}_{E_0}\leq \sigma/2$.
 If $\sigma>0$ is small enough we may assume that (\ref{1000}) holds.

Pick $b\in \bar{S}_{\delta/2}(h_0)$ with $\norm{b}_{E_0}\leq \sigma/2$ and consider the fixed point problem
$$
 a=b-\wt{A}(a)=:T(a), 
 $$
where we look for a solution in $\bar{S}_\delta(h_0)$ with $\norm{a}_{E_0}\leq \sigma$.
The solution $a=a(b)$ is found by an iteration scheme starting with $b$ and applying successively 
$T$ to obtain the sequence $a_k:=T^k(b)$. We have to show that $b\in \bar{S}_{\delta/2}(h_0)$ with $\norm{b}_{E_0}\leq \sigma/2$
implies that $a=\lim T^k(b)$ exists and satisfies $a\in \bar{S}_{\delta}(h_0)$ with $\norm{a}_{E_0}\leq \sigma$.
We estimate
\begin{eqnarray}\label{999}
&&\norm{a_{k+\ell}-a_k}_{E_0} \\
&\leq &\sum_{e=1+k}^{k+\ell} \norm{a_e-a_{e-1}}_{E_0}\nonumber\\
&\leq& (\sum_{e=k}^{k+\ell-1} \tau^e)\norm{\wt{A}(b)}_{E_0}\nonumber\\
&\leq&
\tau^k\cdot (1-\tau)^{-1}\cdot \tau\cdot \norm{b}_{E_0}.\nonumber
\end{eqnarray}
We use this estimate in two ways. First of all we deduce that
\begin{eqnarray}\label{1001}
\norm{a_\ell-b}_{E_0}\leq (1-\tau)^{-1}\cdot \tau\cdot \norm{b}_{E_0}.
\end{eqnarray}
Hence, writing $a_\ell = b +o_\ell$
\begin{eqnarray}\label{1002}
&&\norm{a_\ell - \norm{a_\ell}_{E_0}\cdot h_0}_{E_0}\\
&=& \norm{b +o_\ell - \norm{b}_{E_0}h_0 +(\norm{b}_{E_0}-\norm{a_\ell}_{E_0})h_0}_{E_0}\nonumber\\
&\leq & \norm{b-\norm{b}_{E_0}h_0}_{E_0} +\norm{o_\ell}_{E_0} + |\norm{b}_{E_0}-\norm{a_\ell}_{E_0}|\nonumber\\
&\leq& \norm{b-\norm{b}_{E_0}h_0}_{E_0} + 2\norm{o_\ell}_{E_0}\nonumber\\
&\leq& (\delta/2) \norm{b}_{E_0} + 2 (1-\tau)^{-1}\tau \norm{b}_{E_0}\nonumber
\end{eqnarray}
If we take $\sigma$ small enough we can achieve that $\delta/2 + 2 (1-\tau)^{-1}\tau<\delta$.
From (\ref{1001}) we deduce using $\norm{b}_{E_0}\leq \sigma/2$,  if $\sigma$ is small enough (and consequently 
$\tau$ as small as we wish)
$$
\norm{a_\ell}_{E_0}\leq \norm{b}_{E_0}+\norm{a_\ell-b}_{E_0}\leq \sigma/2 + (1-\tau)^{-1}\tau \sigma/2\leq \sigma.
$$
From the previous discussion we conclude that for $\sigma$ small enough and $b\in \bar{S}_{\delta/2}(h_0)$ with $\norm{b}_{E_0}\leq \sigma/2$
the sequence $a_k:=T^k(b)$ is a Cauchy sequence which stays in $\bar{S}_\delta(h_0)$ and has norm at most $\sigma$.
Define $a(b)=\lim T^k(b)$ and observe $a(b)=b-\wt{A}(a_b)$.  It is clear that $b$ enters the discussion as a continuous parameter
so that the map $b\rightarrow a(b)$ is continuous.  We leave it to the reader to show that the map
$$
\Psi:\{b\in \bar{S}_{\delta/2}(h_0)\ |\ \norm{b}_{E_0}\leq \sigma/2\}\rightarrow \{a\in \bar{S}_{\delta}(h_0)\ |\ \norm{a}_{E_0}\leq \sigma\}:b\rightarrow a(b)
$$
is classically smooth.
\qed \end{proof}

Using (\ref{892}) and Lemma \ref{893} we can write on the subset of $\cl_L(S_{(\delta/2)}(h_0))$
consisting of points with $\norm{b}_{E_0}\leq \sigma/2$
$$
r\circ\Psi(b) = \Phi\circ \Psi(b) + (I-P)A(\Psi(b))(\Psi(b)) =: b+ B(b)
$$
as claimed in the Lemma \ref{891}.
\qed \end{proof}

 
 Next we can pick a sequence $x_k^1\rightarrow 0$ of good points lying on $M_{i_1}$
 in the $\delta/2$-sector 
 and we may assume that the associated set of indices $I_k^1$, consisting of those indices in $[i_1]$ to which $x_k^1$ belongs,
 is constant. We shall  denote it by
 $I^1$. Clearly $i_1\in I^1$. We can write $x_k^1 = \ell_k^1 + B_{i_1}(\ell_k^1)$.
 If $i\in [i_1]\setminus I^1$ we must have that $B_i(\ell_k^1)\neq  B_{i_1}(\ell_k^1)$.
 By perturbing $(\ell_k^1)$ slightly and perhaps after taking a subsequence 
 we my assume that $x_k^2:= \ell_k^2+B_i(\ell_k^2)$ are good points.
 They  do not lie in $M_{j}$ for $j\in I^1$ and consequently $I^2$ is disjoint. 
 If $i\in [i_1]\setminus (I^1\sqcup I^2)$ we perturb $\ell^2_k$ slightly 
 so that $x_k^3:= \ell_k^3+B_i(\ell_k^3)$ are good points. If the perturbation
 is small these do not lie in $M_i$  for $i\in I^1\sqcup I^2$ and we may assume 
 after taking a subsequence that $I^3_k$ is constant, i.e. $I^3$. Proceeding this way
 the induction will terminate and we are done proving the Proposition \ref{890}.
 \qed \end{proof}
 Consider the formal sum
$$
\sum_{e=1}^p \Theta(x^e_k)\cdot T_{x_k^e}M_{i_e}.
$$
This sum is  independent of the local branching structure since it only involves  
good points.  The coefficients are constant and the tangent  spaces converge as $k\rightarrow \infty$.
Hence we can talk about convergence of this formal sum.
Given a specific local branching structure, as  $k\rightarrow \infty$, it converges to 
$$
\sum_{e=1}^p \left(\sum_{i\in I^e}\sigma_i\right)\cdot T_{x}M_{i_e}
$$
which equals the
 sum
$$
\sum_{i\in [i_1]} \sigma_i \cdot T_xM_i.
$$
For any local branching structure describing $\Theta$ near $x$ the same result holds.
This holds for every $\sim$-equivalence class $\Xi\subset I$, 
which implies the main result, since the sum over these $\Xi$ equals 
$$
\sum_{i\in I} \sigma_i\cdot T_x M_i.
$$
This completes the proof of Theorem \ref{890}.
\qed \end{proof}



At this point we can define  the {\bf tangent}\index{Tangent of $\Theta$} of a $\Theta:X\rightarrow {\mathbb Q}^+$.
\begin{definition}\index{D- Tangent $T\Theta$}\label{DEFNX9212}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched 
ep$^+$-sub\-group\-oid. Then there exists a well-defined branched ep$^+$-subgroupoid
$T\Theta:TX\rightarrow {\mathbb Q}^+$ 
defined as follows. 
We put   $T\Theta(h)=0$  for $h\in T_xX$ with $\Theta(x)=0$. If $\Theta(x)>0$
we  take a local branching structure on $U(x)$,
say ${(M_i)}_{i\in I}$ and ${(\sigma_i)}_{i\in I}$, and define on $TU(x)$ the functor $T\Theta$ by
$$
T\Theta(h) =\sum_{\{i\in I\ |\ h\in TM_i\}} \sigma_i.
$$
We call $T\Theta$ the {\bf tangent} of $\Theta$.
\qed
\end{definition}
By the previous discussion this definition is independent of the local branching structure.
Moreover, we note that the local definitions fit together.  
Since we can transport local branching structures 
around using the local sc-diffeomorphims associated to the morphisms it suffices
to show that for two local branching structures on $U(x)$ with $x\in \supp(\Theta)$  the local definitions 
define the same object, i.e.
$$
\sum_{\{i\in I\ |\ h\in TM_i\}} \sigma_i = \sum_{\{j\in J\ |\ h\in TN_j\}} \tau_j\ \ \text{for}\ \ h\in TU(x).
$$
By the previous discussion it holds that $\mathsf{T}_\Theta (y) = \sum_{\{i\in I\ |\ y\in M_j\}} \sigma_i\cdot T_yM_i$
is well-defined and independent of the local branching structure taken. Hence for $y\in U(x)$ 
the number 
$$
\sum_{\{i\in I\ |\ h\in T_yM_i\}} \sigma_i,
$$
is intrinsic and independent of the local branching structure we picked. This shows that $T\Theta$ is well-defined.\par




Assume that $\Theta:X\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid. There is a natural construction for a functor $\partial\Theta:X\rightarrow {\mathbb Q}^+$ called the {\bf boundary} \index{Boundary of $\Theta$}  of $\Theta$.
The support of $\partial\Theta$ is contained in $\partial X$. 
In general this functor has not a particularly good structure due to the fact that $\partial X$ might not have a good structure.
We shall later on describe situations in which $\partial \Theta (x)=\Theta(x)$ for all $x\in \partial X$ and $0$ otherwise.
One should note, however, that this is not(!) always the case. We start with a lemma discussing
the position of a submanifold intersecting $\partial X$. Recall for a M-polyfold as well as a M$^+$-polyfold
the degeneracy index $d_X$ which has been introduced in Definition \ref{M_polyfold_degeneracy _index}. We shall also utilize the notion
of the reduced tangent space $T^R_xX$ as well as that of the cone $C_xX$  (or depending on the situation the partial quadrant $C_xX$) at a smooth point  $x$.


\begin{lemma}[Characterization of $d_M(x)=0$]\label{15211}\label{15214}\index{L- Characterization of $d_M(x)=0$}
Let $M\subset X$ be a finite-dimensional submanifold of a M-polyfold $X$. The following two statements are equivalent.
\begin{itemize}
\item[{\em(1)}]\ $x\in M\cap \partial X$   with $d_M(x)=0$.
\item[{\em(2)}]\ $T_xM\subset T_x^RX$.
\end{itemize}
\end{lemma}
\begin{remark}\index{R- On points with $d_M(x)=0$}
Under the assumption of the lemma,  $M$ is a subset of $X$ which is locally an sc$^+$-retract. If $x\in M\cap \partial X$
it is possible that $x\not\in \partial M$. According to the lemma this precisely is the case when $T_xM\subset T^R_xX$.
Reformulating the statement,  $x\in \partial M$ if and only if $x\in\partial X$ and  $T_xM$ is not contained in the partial cone $C_xX$.
\qed
\end{remark}
\begin{proof}
The problem is entirely local. Hence we may assume $X=O$, where $(O,C,E)$ is a local model
and $x=0$. We may further assume that we are  given an open neighborhood $U$ of $0$ in $C$ containing $O$ and an sc-smooth retraction $r:U\rightarrow U$ with $r(U)=O$, and an sc$^+$-retraction $s:U\rightarrow U$ with $s(U)=M$.  \par

Assume first that (1) holds. Since $d_M(0)=0$ there exist an open neighborhood
$W\subset M$ of $0$ and an sc-diffeomorphism $\Phi:({\mathbb R}^n,0)\rightarrow (W,0)$, mapping $0$ to $0$.
Here $n=\dim(T_0M)$. For every $h\in {\mathbb R}^n$  it holds that $\Phi(h)=\Phi(h)-\Phi(0)\in C$
and consequently using the differentiability at $0$ we deduce that $T\Phi(0)(h)\subset C$
implying that $T_0M\subset T_0O \cap C=T^R_0O$. This shows that (2) holds.\par

Next assume (2). Without loss of generality $C=[0,\infty)^k\oplus W$, where $k=d_O(0)$,
and $E={\mathbb R}^k\oplus W$, in particular $W$ is an sc-Banach space. By assumption $T_0M\subset \{0\}\oplus W$. 
For $(0,h)\in T_0M$ small enough  we have that $(0,h)\in U$ and therefore $s(0,h)\in M \subset C$.
We compute similarly as before when we studied submanifolds that 
$$
s(0,h) = (0,h) + A(0,h) 
$$
with $A(0,0)=(0,0)$ and $DA(0,0)=0$, where $A$ is an sc-smooth map into $E$ defined on an open neighborhood $Q$
of $0$ in the smooth $T_0M$.  Take an sc-complement $Y$ of $T_0M$ so that $E=T_0M\oplus Y$
and denote by $P:E\rightarrow T_0M$ the associated sc-projection. We define
$$
\Psi: Q\rightarrow T_0M: (0,h)\rightarrow (0,h) +PA(0,h).
$$
Note that $D\Psi(0,0)=Id$ and the map is classically smooth so that by the implicit function theorem
$\Psi^{-1}$ is defined and classically smooth. Hence 
$$
s\circ \Psi^{-1}(0,h) = (0,h) + (Id-P)A(\Psi^{-1}(y))=: (0,h) + B(0,h),
$$
where $B(0,0)=0$, $DB(0,0)=0$, and $B(0,h)\in Y$.  By construction $s\circ\Psi^{-1}(0,h)\in C$. 
Define $\wt{s}(0,h)=s\circ\Psi^{-1}(0,h)$ for $(0,h)\in T_0M$ with $\norm{(0,h)}_{E_0}$ small.
Since $T\wt{s}(0,0)=Id: T_0M\rightarrow T_0M\subset T^R_0O\subset T_0O$
we can define for small $y\in Y$ the map
$$
((0,h),y)\rightarrow \wt{s}(0,h)+y,
$$
which is a local sc-diffeomorphism from an open neighborhood of $(0,0)$ in $T_0M\times Y$
to an open neighborhood of $0$ in $E$.  Denote the inverse by $F$ and note that the composition
$$
\wt{s}\circ P\circ F 
$$
is an sc$^+$-smooth map defined on an open neighborhood of $0$ in $E$ and has image 
$M$(near $0$).  Moreover, if defined on a suitable open neighborhood around $0$ it is a retraction.
Hence we see that $M$ near $0$ can be realized as an sc$^+$-retraction in $E$ with $C=E$.
This implies that $d_M(0)=0$.
\qed \end{proof}
Now we can state the crucial result needed to define $\partial\Theta$.
\begin{proposition}[Well-definedness of $\partial\Theta$]\index{P- Well-definedness of $\partial\Theta$}\label{PROPX9.2.15}
Let $\Theta:X\rightarrow {\mathbb Q}^+$ be a bran\-ched ep$^+$-subgroupoid and let $x\in \supp(\Theta)\cap \partial X$.
Suppose ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, and ${(N_j)}_{j\in J}$, ${(\tau_j)}_{j\in J}$ are two local branching structures
on a suitable open neighborhood $U(x)$ which represent $\Theta$ on $U(x)$. 
\begin{itemize}
\item[{\em(1)}]\ Then for every $y\in U(x)$ the equality
\begin{eqnarray}\label{polarizedx}
\sum_{\{i\in I\  |\ y\in \partial M_i\}}\sigma_i =\sum_{\{j\in J\ |\ y\in \partial N_j\}} \tau_j
\end{eqnarray}
holds.
\item[{\em(2)}]\ The sums in (\ref{polarizedx})  vanish if $y\in U(x)$ satisfies $d_X(y)=0$.
\item[{\em(3)}]\ There is a well-defined functor 
$\partial\Theta:X\rightarrow {\mathbb  Q}^+$
with
$\supp(\partial\Theta)$ $ \subset \partial X$, so that for $x\in \supp(\partial \Theta)$ it holds
$$
\partial \Theta(y) =\sum_{\{i\in I\ |\ y\in M_i,\ d_{M_i}(y)\geq 1\}}\sigma_i,\ \ y\in U(x).
$$
Here we take any local branching structure for $\Theta$ on some $U(x)$.
\end{itemize}
\end{proposition}
\begin{proof}
(1) Let ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ be a local branching structure on $U(x)$ and 
consider the sum $\sum_{\{i\in I\  |\ y\in \partial M_i\}}\sigma_i$. We also consider
$T_\Theta(y) = \sum_{\{i\in I\ |\ y\in M_i\}}\sigma_i\cdot T_yM_i$. The latter we know is independent of the local branching structure. We can rewrite this  as
\begin{eqnarray*}
T_\Theta(y) &=& \sum_{\{i\in I\ |\ y\in M_i\}}\sigma_i\cdot T_yM_i\\
&=&\sum_{\{i\in I\ |\ y\in M_i,\ d_{M_i}(y)\geq 1\}}\sigma_i\cdot T_yM_i  +
\sum_{\{i\in I\ |\ y\in M_i,\ d_{M_i}(y)=0\}}\sigma_i\cdot T_yM_i.
\end{eqnarray*}
In view of Lemma \ref{15211} and the remark thereafter,  this is a natural decomposition independent of the local branching structure
and from this the desired result (1) is easily obtained.\par


\noindent (2) Let  ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ be  a local branching structure on $U(x)$.
Assume that $d_X(x)=0$. Then, if $U(x)$ is small enough all the $d_{M_i}$ vanish identically
implying that $\sum_{\{i\in I\  |\ y\in \partial M_i\}}\sigma_i=0$.  
Hence for $y\in U(x)$ 
$$
\sum_{\{i\in I\ |\ y\in M_i,\ d_{M_i}(y)\geq 1\}}\sigma_i\cdot T_yM_i =0.
$$
(3) Follows immediately from (1) and (2). 

\qed \end{proof}

In view of Proposition \ref{15214} the boundary $\partial\Theta$ of $\Theta$ can be defined.
\begin{definition}\label{DEF9214}\index{D- Boundary of $\Theta$}\index{$\partial\Theta$}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$ a branched ep$^+$-groupoid.
The functor $\partial\Theta$, uniquely characterized by the following properties
\begin{itemize}
\item[(1)]\ $\supp(\partial\Theta)\subset \partial X$.
\item[(2)]\  For  $x\in \supp(\partial \Theta)$ it holds for any local branching structure on a suitable
$U(x)$
$$
\partial \Theta(y) =\sum_{\{i\in I\ |\ y\in M_i,\ d_{M_i}(y)\geq 1\}}\sigma_i,\ \ y\in U(x).
$$
\end{itemize}
 is called the {\bf boundary of $\Theta$}.
 \qed
\end{definition}
\begin{remark}\index{R- On the functor $\partial\Theta$}
The functor $\partial\Theta$ in general does not have particularly nice 
properties. In Section \ref{IandST},  Definition \ref{TAMERXX},
we shall introduce the notion of a tame branched ep$^+$-subgroupoid.
As we shall show their boundaries  $\partial\Theta$
are nice enough for an integration and orientation theory. 
\qed
\end{remark}


\section{Orientations}\label{SECXV93}
There is also  an oriented version of the $\text{Gr}(X)$-construction in the previous section, which we shall describe in the following.
\begin{remark}\index{R- Remark on \cite{HWZ7}} In  \cite{HWZ7} we used a particular definition of orientability 
of an ep$^+$-subgroupoid,  which is too special to be applicable to all occurring types of sc-Fredholm problems.
In \cite{HWZ7} we erroneously claimed that it does, see the  erratum \cite{HWZ7err} for more details.
However, the techniques from \cite{HWZ7} apply immediately to the general approach which 
is described below.
\qed
\end{remark}
 
An {\bf oriented}\index{Oriented} finite-dimensional linear vector space $L$ denoted by $\wh{L}$ is a pair $(L,o)$,
where $o$ is an orientation of $\Lambda^{\text{max}}L$, i.e. a choice of connected component in $\Lambda^{\text{max}}L\setminus\{0\}$.
In the case $L$ is the trivial space consisting only of the $0$-vector by definition $\Lambda^{\text{max}}L={\mathbb R}$.
If one of the components is denoted by $o$ we shall write for  the other one  $-o$.
For smooth $x$ denote by $\wh{\text{Gr}}(x)$ the set of formal sums
$$
\wh{\mathsf{L}}=\sum {\sigma_{\wh{L}}}\cdot\wh{L},
$$
where almost all $\sigma_{\wh{L}}$ vanish and the  $\wh{L}$  are  smooth, oriented, 
finite-dimensional linear subspaces of $T_xX$. We define the set
$$
\wh{\text{Gr}}(X):= \bigcup_{x\in X_\infty} \wh{\text{Gr}}(x),
$$
which again comes with a natural map into $X_\infty$, denoted by 
$$
\wh{\pi}:\wh{\text{Gr}}(X)\rightarrow X_\infty.
$$
 We can turn $\wh{\text{Gr}}(X)$ into a category
by viewing the elements $\wh{\mathsf{L}}$ as objects and defining the pairs $(\wh{\mathsf{L}},\phi)$,
with $s(\phi)=\wh{\pi}(\wh{\mathsf{L}})$, as morphisms. Again $s(\wh{\mathsf{L}},\phi)=\wh{\mathsf{L}}$  and 
$$
t(\wh{\mathsf{L}},\phi)=\sum \sigma_{(L,o_L)} \cdot (T\phi(L),T\phi_\ast(o_L)).
$$ 
There is a fiberwise 2-1 forgetful functor  fitting into the commutative diagram
$$
\begin{CD}
\wh{\text{Gr}}(X) @>\mathsf{f}>>\text{Gr}(X)\\
@VVV @VVV\\
X_\infty @=        X_\infty.
\end{CD}
$$
Note that $\sigma_{(L,o)} \cdot (L,o) +\sigma_{(L,-o)}\cdot (L,-o)$ is mapped to $(\sigma_{(L,o)}  +\sigma_{(L,-o)})\cdot L$.
If $\wh{\mathsf{L}}=\sum_{L\in\text{Gr}(x)} (\sigma_{(L,o)}\cdot (L,o) +\sigma_{(L,-o)}\cdot (L,-o))$ we denote $\mathsf{f}(\wh{\mathsf{L}})$ by $\mathsf{L}$. We observe that
$$
\mathsf{L}= \sum_{L\in \text{Gr}(x)} (\sigma_{(L,o)} +\sigma_{(L,-o)})\cdot L.
$$
\begin{definition}\index{D- Orientation for $\Theta$}\index{D- Orientability of $\Theta$}\label{DEFNC932}
An {\bf orientation}\index{Orientation} for the branched ep$^+$-subgroupoid $\Theta:X\rightarrow {\mathbb Q}^+$ is 
a choice of section functor  $\wh{\mathsf{T}}_\Theta:X_\infty\rightarrow \wh{\text{Gr}}(X)$ which lifts $\mathsf{T}_\Theta:X_\infty\rightarrow \text{Gr}(X)$, i.e.
$$
\mathsf{T}_\Theta=\mathsf{f}\circ \wh{\mathsf{T}}_\Theta
$$
 with the  property
that for every $x$ with $\Theta(x)>0$ there exists a local representation with oriented $(M_i,o_i)$ so that 
\begin{eqnarray}\label{15000}
\wh{\mathsf{T}}_\Theta(y) = \sum_{i\in I} \wh{\sigma}_i \cdot T_y(M_i,o_i).
\end{eqnarray}
We shall call $\wh{\mathsf{T}}_\Theta$ an {\bf oriented lift}\index{Oriented lift $\wh{\mathsf{T}}_\Theta$}
 of $T_\Theta$.
We say $\Theta$ is {\bf orientable}\index{Orientability} provided $T_\Theta$ admits an oriented lift.
\qed
\end{definition}

\begin{remark}
The local representation (\ref{15000}) associated to a local branching structure precisely means the local continuity
of the lift $x\rightarrow \wh{\mathsf{T}}_\Theta(x)$ on $\supp(\Theta)$. 
The reader should also observe that $\Theta$, if orientable, might allow more than two possible orientations
due to its `fractional nature'.
\qed
\end{remark}
We shall derive next some properties of an orientation $\wh{\mathsf{T}}_\Theta$ of $\Theta$.
Assume that we have fixed for every $x\in \supp(\Theta)$ an oriented local branching
structure ${(M_i^x,o^x_i)}_{i\in I_x}$ with weights ${(\sigma^x_i)}_{i\in I_x}$ so that
$$
\wh{\mathsf{T}}_\Theta(y) =\sum_{i\in I_x} {\sigma}^x_i \cdot T_y (M_i^x,o^x_i)\ \ \text{for}\ \ y\in U(x).
$$
In addition we have that $\mathsf{T}_\Theta(y)=\sum_{i\in I_x} {\sigma}_i^x\cdot T_{y}M_i$.
The interesting case is that some $L=T_xM_i$ occurs with the two different possible
orientations, i.e. there are two different indices $i,j\in I_x$ with $T_xM_i=T_xM_j$, but $o_i^x=-o^x_j$.
Hence  $\mathsf{T}_\Theta(x)$ has a term $\sigma\cdot L$ which comes
from  $\sigma^x_i \cdot (L,o^x_i) + \sigma^x_j\cdot (L,-o^x_j)$ with $\sigma^x_i+\sigma^x_j=\sigma$.

\begin{lemma}
Assume that $X$ is an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$
a branched ep$^+$-subgroupoid. 
Then two orientations $\wh{\mathsf{T}}_\Theta^j$, $j=1,2$,  of $\Theta$, which agree at good points
 are the same. 
\end{lemma}
\begin{proof}
The branched ep$^+$-subgroupoid $\Theta$ defines $\mathsf{T}_\Theta$
and we assume that we are given oriented lifts $\wh{\mathsf{T}}_\Theta^j$, $j=1,2$,  satisfying (\ref{15000}), which
agree over the good points. Let $x\in \supp(\Theta)$ be a bad point 
and assume we have the oriented representations
$$
\wh{\mathsf{T}}^1_\Theta(y)= \sum_{i\in I_x}  \sigma_i\cdot T_y(M_i,o_i)\ \ \text{and}
\ \ \wh{\mathsf{T}}^2_\Theta(y)=\sum_{j\in J_x}\tau_j\cdot T_y(N_j,p_j)
$$
for $y\in U(x)$. 
We begin by studying the first orientation and associated branching structure.
Define an equivalence relation on $I_x$  by saying that $(M_i,o_i)$ and
$(M_{i'},o_{i'})$ are equivalent provided $T_xM_i=T_xM_{i'}$. Note that
at this point we ignore the orientations.
Denote the equivalence classes by $[i_1],...,[i_\ell]$. 

Employing Proposition \ref{890}, recall that 
for every such equivalence class $[i_h]$ there  exist sequences $(x_k^q)$ of good points converging to $x$, 
and a partition $[i_h]= I^1\sqcup...\sqcup I^e$ 
such that $x^q_k\in M_i$ if and only if $i\in I^q$.
Consider the formal sum
$$
\sum_{q=1}^e \wh{\mathsf{T}}_\Theta^1(x_k^q),
$$
where a term    $\wh{\mathsf{T}}_\Theta^1(x_k^q)$  has 
 the form
$$
\wh{\mathsf{T}}_\Theta^1(x_k^q) =\sum_{i\in I^q} \sigma_{i}\cdot T_{x_k^q}(M_i,o_i).
$$
We can define an equivalence relation on $I^q$ by saying that $i\approx i'$
provided 
$$
T_{x}(M_i,o_i)=T_{x}(M_{i'},o_{i'}).
$$
 Denote the two equivalence classes
by $I^q_\pm$ so that $I^1=I^q_+\sqcup I^q_{-}$. If $k$ is large enough 
$T_{x^q_k}(M_i,o_i)=T_{x^q_k}(M_{i'},o_{i'})$ if and only if $i,i'$ both lie in the same equivalence class.
Now we consider for all large $k$ the decomposition
$$
\wh{\mathsf{T}}_\Theta^1(x_k^q) =\sum_{i\in I^q_+} \sigma_{i}\cdot T_{x_k^q}(M_i,o_i)+
\sum_{i\in I^q_-} \sigma_{i}\cdot T_{x_k^q}(M_i,o_i).
$$
The  expression on the right would be the same for the second branching structure,
since the  $x^q_k$ are good points and the assumption $\wh{\mathsf{T}}_\Theta^1(x_k^q) =\wh{\mathsf{T}}_\Theta^2(x_k^q) $.
As $k\rightarrow \infty$ the right-hand side converges to
\begin{eqnarray}\label{16000}
\sum_{i\in I^q_+} \sigma_{i}\cdot T_{x}(M_i,o_i)+
\sum_{i\in I^q_-} \sigma_{i}\cdot T_{x}(M_i,o_i),
\end{eqnarray}
which is the part of $\wh{\mathsf{T}}_\Theta^1(x)$ associated to the tangent spaces $T_xM_i$, $i\in [i_h]$,
which are all equal, but in general have different orientations. 
If we apply the previous discussion to the second orientation we obtain the 
expression 
$$
\sum_{j\in J^q_+} \tau_{j}\cdot T_{x}(N_j,p_j)+
\sum_{j\in J^q_-} \tau_{j}\cdot T_{x}(N_j,p_j),
$$
which must equal (\ref{16000}). This sum is over indices $j$ so that $T_xN_j=T_xM_i$ with $i\in i_h]$ (or $j$ in the corresponding 
equivalence class $[j_{h'}]$.

The sum of these expressions define $\wh{\mathsf{T}}_\Theta^1(x)$ as well as $\wh{\mathsf{T}}_\Theta^2(x)$,  and since the ingredients are equal they coincide.
\qed \end{proof}

\begin{example}
We introduce four different smooth maps  $\beta^{\pm\pm}:{\mathbb R}\rightarrow {\mathbb R}$. 
The map $\beta^{++}$ satisfies  $ \beta^{++}(s)>0$ for $s\neq 0$, $\beta^{++}(0)=0$,  and has vanishing derivatives
of all order at $0$. Put $\beta^{--}:=-\beta^{++}$.
Define $\beta^{+-}$ by being equal to $\beta^{++}$ for $s\leq 0$ and equal to $\beta^{--}$
for $s>0$. Similarly we define $\beta^{-+}$. Associated to these maps 
we have their graphs denoted by $G^{++}, G^{--}, G^{+-}$, and $G^{-+}$.
Observe that
$$
|\{i \in \{++,--\}\ |\ (x,y)\in G^i\} | =|\{j\in \{+-,-+\}\ |\ (x,y)\in G^j\}|
$$
for all $(x,y)\in {\mathbb R}^2$. This defines $\Theta:{\mathbb R}^2\rightarrow {\mathbb Q}^+$.
Orient $G^{++}$ and $G^{+-}$  in such way that 
it is given at $(0,0)$ by the class of $(1,0)$ and orient $G^{--}$ and $G^{-+}$
so that the orientation at $(0,0)$ is given by the class of $(-1,0)$. 
Then $G^{++}$ and $G^{--}$ define a first orientation and $G^{+-}$ and $G^{-+}$ a second one.
They coincide at $(0,0)$, but are otherwise different.  In this case
we have in fact four different possibilities to orient. 
We also learn from this example, that given an oriented $\Theta$ and two local branching structures at $x\in \supp(\Theta)$ for which the first is oriented and the second is orientable,
the second cannot to be re-oriented to coincide with the orientation of the first one.
\qed
\end{example}


Next we would like to consider the boundary $\partial \Theta$ of an oriented $\wh{\Theta}$ and define an induced orientation.
Given $x\in \supp(\Theta)$
we find an open neighborhood $U(x)$ on which we have a local branching structure ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$
such that
$$
\Theta(y)=\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i.
$$
Assuming that $\Theta$ is oriented we can pick an oriented branching structure such that
$$
\wh{\mathsf{T}}_\Theta(y) =\sum_{\{i\in I \ |\ y\in M_i\}} \sigma_i\cdot T_y(M_i,o_i).
$$
Assuming that $\Theta:X\rightarrow {\mathbb Q}^+$ is tame, the $(M_i,o_i)$ have the property that $M_i$ is tame, i.e.
in particular has the structure of a classical smooth manifold with boundary with corners.
In this case, for every $i\in I$, the set of points with $d_{M_i}(y)=1$ is open and dense in $\partial M_i$. 
We shall define an induced  boundary orientation for $\partial\Theta$ in the following.
First we state the usual orientation convention.
\begin{definition}\index{D- Orientation for $\partial M$}
Let $(M,o)$ be an oriented  smooth $n$-dimensional M$^+$-polyfold 
with $\partial M\neq \emptyset$. At a point $y\in \partial M$ with $d_M(y)=1$
an orientation $o_{\partial M,y}$ of $T_y\partial M$  is defined by a basis $(a_1,...,a_{n-1})$ of $T_y\partial M$
such that $(a_1,..,a_{n-1},e)$, where $e\in T_yM$ is inward pointing, defines $o_y$ on $T_yM$.
The map $o_{\partial M}$ which assigns to a point $y\in\partial M$ with $d_M(y)=1$ the orientation $o_{\partial M,y}$ is
called the {\bf orientation} of $\partial M$.
\qed
\end{definition}

Let $X$ be an ep-groupoid and $\wh{\Theta}:X\rightarrow {\mathbb Q}$ be a branched ep$^+$-subgroupoid.
\begin{definition}\index{D- Tame branched ep$^+$-subgroupoid}\label{TAMERXX}
We say that $\Theta:X\rightarrow {\mathbb Q}^+$ is {\bf tame}, provided for every $x\in \supp(\Theta)$ 
there exists an open neighborhood $U(x)$ admitting the natural $G_x$-action and having the properness
property and allowing for a local branching structure ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ representing $\Theta$ on $U(x)$,
 where 
every M$^+$-polyfold $M_i$ has an equivalent tame structure.  In particular, every $M_i$ has an equivalent structure of a smooth manifold with boundary with corners.
\qed
\end{definition}

Given the oriented, tame,  branched ep$^+$-subgroupoid $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ 
we find for every $x\in \supp(\Theta)$ an open neighborhood $U(x)$ and an associated oriented tame  branching structure
${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ such that for $y\in U(x)$
\begin{eqnarray*}
&\Theta(y) = \sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i&\\
& \wh{\mathsf{T}}_\Theta(y) = \sum_{\{i\in I\ |\ x\in M_i\}} \sigma_i\cdot T_y(M_i,o_i).&
\end{eqnarray*}
For $\partial\Theta:X\rightarrow {\mathbb Q}^+$ we define an orientation by 
\begin{eqnarray}\label{asdfgh}
&\wh{\mathsf{T}}_{\partial\Theta}(y) = 0\ \ \ \text{for}\ \ y\in X_\infty\setminus \supp(\Theta)&\\
& \wh{\mathsf{T}}_{\partial\Theta}(y) = \sum_{\{i\in I\ |\ y\in \partial M_i,\ d_{M_i}(y)=1\}} \sigma_i\cdot T_y(\partial M_i,o_{\partial M_i})\ \
\text{for}\ \ y\in U(x)\cap \partial X_\infty.&\nonumber
\end{eqnarray}
\begin{definition}[Boundary Orientation]\label{DEF936}\index{D- Orientation for $\partial\Theta$}
For the oriented, tame,  branched ep$^+$-subgroupoid $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ 
the map $\wh{\mathsf{T}}_{\partial\Theta}:X_\infty\rightarrow \wh{\text{Gr}}(X)$  defined in (\ref{asdfgh}) 
is called the orientation for $\partial\Theta$ induced from the orientation $\wh{\mathsf{T}}_\Theta$ of $\Theta$.
\qed
\end{definition}
In order to simplify notation we shall abbreviate 
$$
\wh{\Theta}:=(\Theta,\wh{\mathsf{T}}_\Theta)\ \ \text{and}\ \ 
\partial\wh{\Theta}:=(\partial\Theta,\wh{\mathsf{T}}_{\partial\Theta}).
$$
As we shall see later on, the following holds for a compact, oriented, tame, branched $n$-dimensional ep$^+$-subgroupoid  $\wh{\Theta}$ and
a degree $n-1$ sc-differential form $\omega$ for an appropriately defined {\bf branched integration} $\oint$:
$$
\oint_{\wh{\Theta}}d\omega = \oint_{\partial\wh{\Theta}}\omega.
$$
This is the  version of Stokes theorem for branched integration and details are carried out in Section \ref{IandST}.

\begin{remark}\index{R- Questions on non-tame branched ep$^+$-groupoids}
It would be interesting to carry out the orientation discussion for  branched ep$^+$-groupoids which are not necessarily
tame in order to see the generality under which Stokes theorem holds. 
The basic step would be to understand the boundary behavior of a M$^+$-polyfold. 
We refer the reader to Appendix \ref{SEC96} for a discussion of the issues involved.
\qed
\end{remark}

\section{Geometry of Local Branching Structures}\label{SEC15.4}
For the integration theory we need to understand the geometry of a local branching structure in more detail.
Of particular importance is the understanding of the branching sets. For this we need later on the following definitions.
\begin{definition}[\cite{HWZ7}]
Let $M$ be a smooth $n$-dimensional manifold with boundary and corners
and $K\subset M$. 
\begin{itemize}
\item[(1)]\ Associated to $z\in K$ there is a distinguished linear subspace 
$T^K_zM\subset T_zM$ defined by the following property.
Given a chart $\varphi:(V(z),z)\rightarrow ([0,\infty)^k\times {\mathbb R}^{n-k},0)$, where 
$k=d_M(z)$, the linear subspace $T\varphi(z)(T^K_zM)$\index{$T\varphi(z)(T^K_zM)$} of ${\mathbb R}^n$ is the linear hull
of all unit vectors in ${\mathbb R}^n$, which can be obtained by taking a sequence $(z_k)\subset K\setminus\{z\}$
with 
\begin{itemize}
\item[(a)]\ $\lim_{k\rightarrow \infty} z_k=z$.
\item[(b)]\ $\lim_{k\rightarrow\infty} \varphi(z_k)/|\varphi(z_k)| =e$.
\end{itemize}
The definition is independent of the choice of $\varphi$. 
\item[(2)]\
We say a point $z\in K$ is {\bf  essential}\index{D- Essential points} provided there exists a sequence $(z_k)\subset K$
such that
\begin{itemize}
\item[(a)]\ $\lim_{k\rightarrow \infty} z_k=z$.
\item[(b)]\ $T_{z_k}^K M= T_{z_k} M$.
\end{itemize}
If $K^e$ denotes the essential points in $K$ then the points in $K^{ne}:=K\setminus K^e$ are called 
{\bf non-essential}\index{D- Non-essential points} points.
\end{itemize}
Note that the statement that $z\in K$ is  essential is a statement about $z$ with respect to $K$ as a subset of $M$.
We need the knowledge of $M$ near $z$ to define the allowable $\varphi$.
\qed
\end{definition}

The following result is obvious from the definition.
\begin{lemma}
Let $M$ be a finite-dimensional manifold with boundary with corners and $K$ a subset.
Then $K^e$ is closed in $K$ and consequently $K\setminus K^e $ is open in $K$.
\qed
\end{lemma}
For the following we fix a local (oriented) branching structure ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, on an open neighborhood
$U(x)$. We impose the technical condition 
\begin{description}
\item[(T)] If for $i,i'\in I$ and some $y_0\in U(x)$  it holds $y_0\in M_i\cap M_{i'}$
and $T_{y_0}M_i=T_{y_0} M_{i'}$ and $o_{i,y_0}=\varepsilon \cdot o_{i',y_0}$ for some $\varepsilon \in \{-1,1\}$,
 then $T_y (M_i,o_i)=T_y(M_{i'},\varepsilon\cdot o_{i'})$ for all $y\in M_i\cap M_{i'}$ with $T_yM_i=T_yM_{i'}$.
\end{description}
Property {\em{\bf (T)}}  can  be achieved by restricting a given oriented branching structure on $U(x)$ to a smaller open neighborhood
$U'(x)$ as is shown in the following lemma.
\begin{lemma}
Let ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ be an oriented branching structure on an open neighborhood
$U(x)$ around the smooth point $x$. Then there exists $U'(x)\subset U(x)$ so that the restricted branching structure satisfies
the technical condition  {\em{\bf (T)}}.
\end{lemma}
\begin{proof}
The consideration is local. Without loss of generality we may assume that we are given  an open (rel $C$) neighborhood
$U$ of $0\in C\subset E$,  subsets $M_i$ which are sc$^+$-retracts, oriented and contain $0$.
We assume that the $M_i$ are properly embedded into $U$.  (There also exists an sc-smooth retract $O$ containing 
$0$ so that the $M_i$ lie in $O$, but this is not relevant for the argument).

Each of the $M_i$ is near $0$ the image of an sc$^+$-smooth retraction $r_i$. We consider
the maps 
$$
z\rightarrow Tr_i(r_i(z))E = T_{r_i(z)}M_i.
$$
for $z\in C$ close to $0$.  We can identify the smooth finite-dimensional spaces $T_{r_i(z)}M_i$ naturally with linear subspaces
of $E$.  Assume that our assertion is wrong.
Then we find  sequences $(y_k)$, $(z_k)$ of smooth points converging to zero,  indices $i_k^1\neq i_k^2$
and $\varepsilon_k\in \{-1,1\}$ such that
\begin{eqnarray}\label{PLKJ}
y_k\in M_{i_k^1}\cap M_{i^2_k},\ \ T_{y_k}M_{i_k^1}=T_{y_k}M_{i_k^2},\ \ o_{i_k^1,y_k}=\varepsilon_k\cdot o_{i_k^2,y_k}
\end{eqnarray}
and
\begin{eqnarray}\label{PLKJ2}
z_k\in M_{i_k^1}\cap M_{i^2_k},\ \ T_{z_k}M_{i_k^1}=T_{z_k}M_{i_k^2},\ \ o_{i_k^1,z_k}=-\varepsilon_k\cdot o_{i_k^2,z_k}.
\end{eqnarray}
After perhaps taking suitable subsequences we may assume that $i_k^1=:i_1$ and $i_k^2=:i_2$ are constant and $i_1\neq i_2$, and moreover
$\varepsilon_k$ is constant.  The points $y_k$ and $z_k$ are smooth and the tangent spaces $T_{y_k}M_{i_1}$ converge to $T_0M_{i_1}$
and similarly $T_{z_k}M_{i_2}\rightarrow T_0M_{i_2}$.   We also note that $T_0M_{i_1}=T_0M_{i_2}$. 
From (\ref{PLKJ}) we conclude  $o_{i_1,0}=\varepsilon\cdot o_{i_2,0}$ and from (\ref{PLKJ2}) that 
$o_{i_1,0}=-\varepsilon\cdot o_{i_2,0}$, which gives a contradiction.
\qed \end{proof}
We associate to   $i,i'\in I$ the closed subset of $M_i$ and $M_{i'}$  defined by
$$
K(i,i')=M_i\cap M_{i'}.
$$
We can view $K(i,i')$ as a subset of $M_i$ as well as a subset of $M_{i'}$.
Hence, a priori, we can talk about points $z\in K(i,i')$ which are essential with respect to
$K(i,i')$ as a subset of $M_i$ or as a subset of $M_{i'}$.
The detailed proof of the following statement, which shows that these two a priori notions of being essential
coincide, is left to the reader.
\begin{lemma}
If $z\in K(i,i')$ is essential for $K(i,i')\subset M_i$ then it is also essential for
$K(i,i')\subset M_{i'}$. Hence the subsets $K(i,i')^e$ and $K(i,i')^{ne}$ are well-defined
independent of the chosen reference $M_i$ or $M_{i'}$.
\end{lemma}
\begin{proof}
Given $z\in K\subset M\subset X$ the first observation is the following.
Take a M-polyfold chart $\psi:(U(z),z)\rightarrow (O,0)$ and note that $T_z^KM$ corresponds under $T\psi(z)$
to the linear subspace of $T_0O$ defined as follows.  Let $N=\psi(M\cap U(z))\subset O$ and $D=\psi(K\cap U(z))$.
Then define $T^D_0 N$ to be the span of all vectors in $T_0O$ such that there exists a sequence $(z_k)\subset D\setminus\{0\}$ with
$$
e=\text{lim}_{k\rightarrow\infty} \frac{z_k}{|{z_k}|_0}.
$$
As already said $T\psi(z)(T^K_zM)=T^D_0 N$.   From this description the proof of the lemma can be reduced
to the study of $0\in M_i,M_{i'}\subset O$ and $D=M_i\cap M_{i'}$ and the alternative description 
immediately implies that $T^K_zM_i =T^K_z M_{i'}$.
\qed \end{proof} 
In view of the lemma the subsets $K(i,i')^e$ and $K(i,i')^{ne}$ of $M_i$ and $M_{i'}$ are well-defined
independent of which reference we take.
The manifolds  $M_i$ and $M_{i'}$ come with orientations $o_i$  and $o_{i'}$. If $z\in K(i,i')^e$
and $T_{z}M_i$ and $T_{z}M_{i'}$ have the same orientation it holds in view of {\em{\bf (T)}} for all points
in $K(i,i')^{e}$, and similarly if the orientations differ.
In view of this observation we can associate to $(i,i')$ a map  $K(i,i')^{e}\rightarrow \{-1,1\}$.
If $K(i,i')^e=\emptyset$ it is the obvious map, and if the set is nonempty it is the constant map relating the orientations.



\begin{definition}\label{DEF944}\index{D- Measure zero}
We shall say that a set $K\subset M_i$ has {\bf measure zero} provided for every smooth chart 
$\varphi:M_i\supset U\rightarrow [0,\infty)^k\times {\mathbb R}^{n-k}$ the set $\varphi(U\cap K)$ has
Lebesgue-measure zero.
\qed
\end{definition}
  A basic fact is given by the following lemma,  which is proved similarly as  Lemma 2.8 in  \cite{HWZ7}.
\begin{lemma}
The sets $K(i,i')^{ne}$ have measure zero.
\end{lemma}
\begin{proof}
We
pick a point $x\in K (i,j)^{ne}$ and choose  a chart $\varphi:V(x)\subset
M_i\rightarrow O(0)\subset [0,\infty)^d\times {\mathbb R}^{n-d}$ satisfying $\varphi (x)=0$. We abbreviate the image set in $\R^n$ by $K=\varphi (K(i,j)^{ne}\cap V(x))$. It suffices to show that $0$ is a point of Lebesgue density $0$, i.e.,
$$
\lim_{\varepsilon\rightarrow 0}
\frac{1}{\varepsilon^n}\mu(B_\varepsilon\cap K)=0,
$$
where $\mu$ stands for the $n$-dimensional   Lebesgue measure  and  $B_{\varepsilon}$ is the  ball of radius $\varepsilon$ centered at the origin. We must have $T_x^{K(i, j)}M_i\neq T_xM_i$. Hence by
composing the chart with a rotation in the image,  we may assume
that
$$
\Sigma:=T\varphi(x)(T_x^{K(i,j)}M_i)\subset\R^{n-1}\times \{0\}.
$$
Now  take a number $\delta>0$, define the set
$\Gamma_\delta=\{(a, b)\in \R^{n-1}\times \R\vert \, \abs{b}\leq \delta \abs{a}\}$ and consider the subset
$(B_{\varepsilon}\setminus \Gamma_{\delta})\cap K$ of  $\R^n$. If, for a given  sequence $\varepsilon_k\to 0$,  there exists a sequence of points $x_k$ in
$(B_{\varepsilon_k}\setminus \Gamma_{\delta})\cap K$, then  we arrive at a contradiction with the definition of $\Sigma$. Consequently,   the set
$B_{\varepsilon}\cap K$  is contained in $\Gamma_{\delta}$ if $\varepsilon$ is sufficiently small. Hence
\begin{equation*}
\begin{split}
\limsup_{\varepsilon\to  0}\frac{1}{\varepsilon^n}\mu(B_\varepsilon\cap K)\leq
\limsup_{\varepsilon\rightarrow
0}\frac{1}{\varepsilon^n}\mu(B_\varepsilon\cap \Gamma_\delta)\leq
C(\delta)
\end{split}
\end{equation*}
for a constant $C(\delta)$ satisfying $C(\delta)\rightarrow 0$ as $\delta\rightarrow 0$. This shows that
$$
\lim_{\varepsilon\rightarrow 0}\frac{1}{\varepsilon^n}\mu(B_\varepsilon\cap K) =0.
$$
We have proved that the Lebesgue density at every point $x$ in the Borel set $K (i, j)^{ne}\subset M_i$ vanishes. This implies that this  set is of measure zero.
\qed \end{proof}
In view of the previous lemma the sets $K(i,i')^e$ have full measure in $K(i,i')$ and $K(i,i')^e\subset M_i\cap M_{i'}$
Denote by $M_U$ the union of the ${(M_i)}_{i\in I}$. Define for $y\in M_U$ the subset $I_y$ of $I$ by
$$
I_y=\{i\in I\ |\ y\in M_i\}.
$$
\begin{definition}\index{D- $y$-equivalence}
We say that $i,i'\in I_y$ are {\bf $y$-equivalent} ($i\sim_y i'$) provided there exists a chain of indices in $I_y$,
say $i_0=i,i_1,...,i_k=i'$ such that $y\in K(i_{p-1},i_p)^e   $ for $p=1,..,k$.  Note that if $i\sim_y i'$ then $T_y M_i=T_yM_{i'}$.
The equivalence relation $\sim_y$ defines a {\bf partition of $I_y$}\index{D- Partition $P_y$} given by the collection of equivalence classes
which we shall denote by $P_y:= I_y{/\sim_y}$. 
\qed
\end{definition}

\begin{lemma}
The set $\{y\in M_U\ |\ \sharp(I_y/\sim_y)\geq 2\}$ has measure zero.
\end{lemma}
\begin{proof}
Given $y\in M_U$ the equivalence relation $\sim_y$ defines a partition $P_y$ of the set $I_y$.
Define for a subset $J$ of $I$ and a finite partition $P$ of $J$ the set
$$
M_U^{(J,P)} =\{y\in M_U\ |\ I_y=J,\ P_y=P\}.
$$
The set $\{y\in M_U\ |\ \sharp(I_y/\sim_y)\geq 2\}$ can be written as a finite union
of such sets. Hence it suffices to show that $M_U^{(J,P)}$ has measure zero provided $\sharp P\geq 2$.

Assume that $\sharp P\geq 2$ and take two indices $i,i'$ which belong to different sets $\gamma_1$ and $\gamma_2$  of the partition $P$. If  $y\in M_U^{J,P}$ it follows that $i\not \sim_y i'$. That means that for every chain of indices
$i_0=i,...,i_k=i'$ in $I_y= J$ connecting $i_0$ with $i'$ it holds that $y$ belongs to some $K(i_{p-1},i_p)^{ne}$ with $p=p_y$.
Hence 
$$
y\in \bigcup_{j,j'\in J} K(j,j')^{ne}\subset \bigcup_{j,j'\in I} K(j,j')^{ne},
$$
where the right-hand side is a set of measure zero.
\qed \end{proof}
In view of the previous discussion we can take the subset $M_U^\ast$ of $M_U$ consisting of all
$y$ with $I_y{/\sim_y} \ = \{I_y\}$, i.e. all points $y$ so that all the elements in $I_y$ are $\sim_y$-equivalent.
By construction $M_U\setminus M_U^\ast$ has measure zero.
Denote for a subset $J\subset I$ by $M^{J}_U$ the subset of $M_U^\ast$ consisting of all
$y$ such that $I_y=J$ and $P_y=\{J\}$, i.e.
$$
M^J_U=\{y\in M_U^\ast\ |\ I_y =J,\ P_y=\{J\}\}.
$$
For $y\in M^{J}_U$ and every $i\in J$ we have the same
tangent space $T_yM_i$, but the orientations coming from the $o_i$ can differ.

This defines on $J$ an equivalence relation $\approx_J$, where by definition $i\approx_J i'$ provided
$T_y(M_i,o_i)=T_y(M_{i'},o_{i'})$  for all $y\in M^J_U$ with $i\sim_y i'$.
Recall that as a consequence of the technical condition {\em{\bf (T)}}  it holds that if   $i\sim_{y_0} i'$ then it is true for all $y$ with $i\sim_y i'$ in $M^J_U$. 

We obtain a partition of $J$ into possibly two nonempty subsets denoted by $A_J$ and $B_J$.
We define  for $y\in M^{J}_U$ 
$$
T^J_y:= T_yM_i,
$$
where we pick any element $i\in J$,
and 
$$
\sigma_J:=\sum_{i\in J} \sigma_i.
$$
With these definitions 
$$
\mathsf{T}_\Theta(y) = \sigma_J\cdot T_y^J\ \ \text{for}\ \ y\in M_U^{J}.
$$
 Associated to $A_J$, if nonempty,  we have the orientation 
$o_i$, where we pick some $i\in A_J$.  We  equip  $T_yM_i $ with $o_{A_J,y}=o_{i,y}$.    If  $B_J\neq \emptyset$ we define for $i'\in B_J$
the orientation $o_{B_J,y}=o_{i',y}$, which over the relevant set is just $-o_{A_J}$.
We define
$$
a_J:=\sum_{i\in A_J} \sigma_i\ \ \text{and}\ \ \ b_J:=\sum_{i'\in B_J} \sigma_{i'}
$$
and note that $\sigma_J=a_J+b_J$.
 Now consider the assignment
$$
M^J_U\ni y\rightarrow a_J\cdot (T^J_y,o_{a_J}) +b_J\cdot (T^J_y,o_{b_J})
$$
\begin{proposition}\label{PROP947}
Under the assumptions of the previous discussion the following holds.
The  collection
$$
M_U^\ast=\{ y \in M_U\ |\ \sharp P_y =1\}
$$
differs from $M_U$ by a set  of measure zero.  We can decompose $M_U^\ast$
by
$$
M_U^\ast = \sqcup_{J\subset I} M_U^{J}:=\sqcup_{J\subset I} \{y\in M_U^\ast\ |\ I_y=J\}.
$$
On $M_U^J$ we have the following identities
\begin{itemize}
\item[{\em(1)}]\ $\Theta(y)=\sum_{i\in J} \sigma_i=:\sigma_J$, $y\in M_U^J$.
\item[{\em(2)}]\ $\mathsf{T}_\Theta(y) =\sigma_J\cdot T_y^J$, $y\in M^J_U$.
\item[{\em(3)}]\  $\wh{\mathsf{T}}_\Theta(y) = a_J\cdot (T^J_y,o_{a_J}) +b_J\cdot (T^J_y,o_{b_J})$, $ y\in M_U^{J}$.
\item[{\em(4)}]\ $a_J+b_J = \sigma_J$ and $o_{a_J}=-o_{b_J}$.
\end{itemize}
\qed
\end{proposition}
The previous discussion allows us to compare two local branching structures on the open set
$U(x)$. Denote the second one by  ${(M_{i'},o_{i'})}_{i'\in I'}$,
${(\sigma_{i'})}_{i'\in I'}$. Then the union with the first one gives a new local branching structure indexed by $I''=I\sqcup I'$.
We abbreviate the three local branching structures by ${\mathcal B}$, ${\mathcal B}'$, and ${\mathcal B}''$. 
The local branching structure ${\mathcal B}''$ defines over  $U(x)$ the functor $2\cdot\Theta$ with orientation 
$$
\wh{\mathsf{T}}_{2\cdot\Theta}(y)=\sum_{\{i''\in I\sqcup I'\ |\ y\in M_{i''}\}} \sigma_{i''}\cdot T_y(M_{i''},o_{i''})
= 2\cdot \wh{\mathsf{T}}_\Theta(y).
$$
 The sets $M_U$, $M_U'$, and $M_U''$   associated to the three
local branching structures are all the same. However $M_U^\ast$, $M_U'^\ast$, and $M_U''^\ast$ generally are different, but 
their complements in $M_U$  have measure zero.
The set $M_U''^\ast$ is written as the disjoint union of sets 
$$
\{y\in M_U\ |\ I''_y = J'',\ \sharp P_y'' =1\}.
$$
where $J''\subset I''$. The intersection $M^\dagger_U= M_U^\ast\cap M_U'^\ast\cap M_U''^\ast$ has a complement of measure
zero in $M_U$. On $M^\dagger_U$ we can relate the  three local  branching structures in a way which is useful to define branched 
integration in the next subsection.  Define
\begin{eqnarray*}
&M^\dagger_U =\bigsqcup_{J\subset I} M^{\dagger J}_U :=\bigsqcup_{J\subset I} \{y\in M_U^\dagger\ |\ I_y = J\}&\\
&M^\dagger_U =\bigsqcup_{J'\subset I'} M^{\dagger J'}_U :=\bigsqcup_{J\subset I} \{y\in M_U^\dagger\ |\ I_y' = J'\}&\\
&M^\dagger_U =\bigsqcup_{J''\subset I''} M^{\dagger J''}_U :=\bigsqcup_{J''\subset I''} \{y\in M_U^\dagger\ |\ I_y'' = J''\}.&
\end{eqnarray*}
Pick $J\subset I$ and $J'\subset I'$ and consider the set $M^{\dagger J}_U \cap M^{\dagger J'}_U$. If $y$ belongs to this set
it holds that $I_y=J$ and $I_y'=J'$, with both being nonempty, since both branching structures define the same $\Theta$.
Since $y\in M^\dagger_U\subset M_U''^\ast$ it also satisfies $I''_y =J''$ and $\sharp P_y''=1$
for some $J''\subset I''$.   Clearly $J''=J\sqcup J'$ and we derive that 
\begin{eqnarray}\label{eq914}
M^{\dagger J}_U \cap M^{\dagger J'}_U \subset M^{\dagger J\sqcup J'}_U.
\end{eqnarray}
Since 
\begin{eqnarray}\label{eq915}
M^\dagger_U &=& \left( \bigsqcup_{J\subset I} M^{\dagger J}_U\right)\bigcap \left(\bigsqcup_{J'\subset I'} M^{\dagger J'}_U\right)\\
&=& \bigsqcup_{J\subset I,\ J'\subset J'} \left(M^{\dagger J}_U \cap M^{\dagger J'}_U\right),\nonumber
\end{eqnarray}
combining (\ref{eq914}) and (\ref{eq915}) we find the equality
\begin{eqnarray*}
M^{\dagger J}_U \cap M^{\dagger J'}_U = M^{\dagger J\sqcup J'}_U.
\end{eqnarray*}
From this discussion, since ${\mathcal B}$ and ${\mathcal B}'$ describe the same oriented local branching structure
and ${\mathcal B}''$ is their union  we infer that for $y\in  M^{\dagger J\sqcup J'}_U$ the following holds:
\begin{itemize}
\item[(1)]\ $\Theta(y) =\sum_{i\in J}\sigma_i =:\sigma_J = \sum_{i'\in J'} \sigma_{i'} =:\sigma_{J'}$
\item[(2)]\ $\mathsf{T}_{\Theta}(y) =\sigma_J\cdot T^J_y = \sigma_{J'}\cdot T^{J'}_y$
\item[(3)]\ $\wh{\mathsf{T}}_\Theta(y) = a_J\cdot (T^J_y,o_{a_J})+ b_J\cdot (T^J_y,o_{b_J}) = a_{J'}\cdot (T^{J'}_y,o_{a_{J'}})+ b_{J'}\cdot (T^{J'}_y,o_{b_{J'}})$.
\item[(4)]\ $a_J+b_J=\sigma_J=\sigma_{J'} =a_{J'}+b_{J'}$.
\end{itemize}
We can summarize this discussion in the following proposition.
\begin{proposition}\label{prop948}
Assume that $U(x)$ is an open neighborhood around the smooth point $x$ in a M-polyfold.  Suppose we are given two oriented local branching structures
on $U(x)$ denoted by ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, and ${(M_{i'},o_{i'})}_{i'\in I'}$, ${(\sigma_{i'})}_{i'\in I'}$ such that for $y\in U(x)$
the following holds
\begin{itemize}
\item[{\em(a)}]\ $\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i =  \sum_{\{i'\in I'\ |\ y\in M_{i'}\}} \sigma_{i'}$.
\item[{\em(b)}]\ $\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i\cdot T_y(M_i,o_i) =  \sum_{\{i'\in I'\ |\ y \in M_{i'}\}} \sigma_{i'}\cdot T_y(M_{i'},o_{i'})$.
\end{itemize}
Define $M_U:= \bigcup_{i\in I} M_i=\bigcup_{i'\in I'} M_{i'}$.  
Then there exists a subset $M^\dagger_U$ of $M_U$ and a finite partition of $M^\dagger_U=A_1\sqcup ...\sqcup A_\ell$ with the following properties.
\begin{itemize}
\item[{\em(1)}]\ $M_U\setminus M_U^\dagger$ has measure zero.
\item[{\em(2)}]\ For every $A_p$ the maps $y\rightarrow I_y=\{i\in I\ |\ y\in M_i\}$ and $y\rightarrow I_y'=\{i'\in I'\ |\ y\in M_{i'}\}$ are constant, and moreover
for $i,j\in I_y$ and $i',j'\in I_y'$
$$
T_yM_i =T_y M_j =T_y M_{i'}=T_y M_{j'}
$$
\item[{\em(3)}]\ Denote by $I_p$ the value of $y\rightarrow I_y$ on $A_p$ and similarly $I_p'$. Then 
$$
\sum_{i\in I_p} \sigma_i=\sum_{i'\in I_p'} \sigma_{i'}.
$$
\item[{\em(4)}]\ For $A_p$ with $I_p= J$ and $I'_p=J'$ there exist partitions $J=J_+\sqcup J_-$ and $J'=J'_+\sqcup J'_-$ such that
for $(i,j), (i',j')\in (J_+\times J_+')$ or $(i,j), (i',j')\in (J_-\times J_-')$ and all $y\in A_p$
$$
T_y (M_i,o_i)=T_y (M_j,o_j)= T_y(M_{i'},o_{i'})=T_y (M_{j'},o_{j'}).
$$
\item[{\em(5)}]\ For $y\in A_p$  and having fixed $i_\pm\in J_\pm$, $i'_\pm\in J'_\pm$ we have the identity
$$
[\sum_{j\in J_\pm}\sigma_j]\cdot T_y(M_{i_\pm},o_{i_\pm})= [\sum_{j'\in J_\pm'} \sigma_{j'} ]\cdot T_y(M_{i'_\pm},o_{i'_\pm})
$$
\end{itemize}
\qed
\end{proposition}
Proposition \ref{prop948} will be important for introducing the branched integration in the next 
section.
\section{Integration and Stokes}\label{IandST}
In the following we assume that $\Theta$ is an 
 oriented, tame, compact,  branched ep$^+$-subgroupoid of dimension $n$, see
 Definition \ref{TAMERXX}.
We denote by $S$ the orbit space $|\supp(\Theta)|$ which by assumption is a compact
subspace of the metrizable space $|X|$. 

Given a classically smooth $n$-manifold $M$ (perhaps with boundary with corners)   there is a natural class of measures equivalent to Lebesgue measure, i.e.
those which can be written in local coordinates as $f\cdot dx_1\wedge..\wedge dx_n$ for some function $f>0$.
This allows to introduce the notion of a subset $A\subset M$ to be of measure zero. We have introduced this notion already in
Definition \ref{DEF944}. Given a local branching structure ${(M_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ for $\Theta$ on
$U(x)$ we obtain 
$$
M_U=\bigcup_{i\in I}  M_i
$$
and $|M_U|\subset S$.  Given a subset $A$ of $S$  we can consider $A\cap |M_U|$ and the preimages
$A_i\subset M_i$ for $i\in I$ under the canonical map $M_U\rightarrow |M_U|$.
\begin{definition}\index{D- Measure zero}
We say a subset $A$ of $S=\supp(\Theta)$ has {\bf measure zero}, provided for every $x\in \supp(\Theta)$
and a choice of local branching structure on a suitable $U(x)$ the sets $A_i$ introduced above, have measure zero.
\qed
\end{definition}
According to the following lemma, see \cite{HWZ7}, Lemma 3.2, the definition does not depend on the choice of local branching structures.
\begin{lemma}\index{L- Measure zero}
The definition of a set of measure zero in $S$ does not depend on the choice of local branching structures.
\qed
\end{lemma}
After this preparation we can introduce the {\bf canonical $\sigma$-algebra ${\mathcal L}(S)$}, see also \cite{HWZ7}, Definition 3.3.
\begin{definition}[Canonical $\sigma$-Algebra ${\mathcal L}(S)$] \index{D- Canonical $\sigma$-Algebra ${\mathcal L}(S)$}
Let $X$ be an ep-groupoid and $\Theta: X\rightarrow {\mathbb Q}^+$ a tame, compact, branched ep$^+$-subgroupoid. Define
$S=|\text{supp}(\Theta)|$. The $\sigma$-algebra ${\mathcal L}(S)$\index{${\mathcal L}(S)$} is the smallest $\sigma$-algebra consisting of subsets of $S$,
which contains the Borel $\sigma$-algebra ${\mathcal B}(S)$\index{${\mathcal B}(S)$} and all subsets of $S$ of measure zero.
\qed
\end{definition}
It follows immediately from the definition that ${\mathcal L}(S)$ is obtained from ${\mathcal B}(S)$ by just adding the sets
of measure zero. Denote by ${\mathcal M}(S,{\mathcal L}(S))$\index{${\mathcal M}(S,{\mathcal L}(S))$} the vector space of finite signed measures on the Lebesgue $\sigma$-algebra  on $S$.

The basic first integration result concerns an sc-differential form and an oriented, tame, branched ep$^+$-subgroupoid.
\begin{theorem}\label{IandS}\index{T- Integration associated to $\wh{\Theta}$}
Let $X$ be an ep-groupoid and $\wh{\Theta}=(\Theta,\wh{\mathsf{T}}_\Theta):X\rightarrow {\mathbb Q}$
be an oriented, tame, compact,  branched ep$^+$-subgroupoid of dimension $n$.
There exists a linear map 
$$
\Phi_{\wh{\Theta}}:\Omega^n_\infty(X)\rightarrow {\mathcal M}(S,{\mathcal L}(S)):\omega\rightarrow \mu_\omega,
$$
characterized uniquely by the following property.
\begin{itemize}
\item  Given a point $x\in \text{supp}(\Theta)$ and an oriented local branching structure ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$
on $U(x)$, which is assumed to admit the natural $G_x$-action, the following identity holds for every
measurable subset $K\subset S$ contained in $|U(x)|$ with $K_i\subset M_i$ the preimage of $K$ under
$\pi:U(x)\rightarrow |U(x)|:y\rightarrow |y|$
$$
\mu^\Theta_\omega(K) =\frac{1}{|G_x^{{\text{eff}}}|} \cdot \sum_{i\in I} \sigma_i\cdot \int_{K_i} \omega|(M_i,o_i).
$$
\end{itemize}
Here $G_x^{eff}$ is the effective isotropy group of $x$ and was previously defined in Definition \ref{DEF728}.
\qed
\end{theorem}
The proof of Theorem \ref{IandS} takes some preparation and we follow essentially \cite{HWZ7}.
In a first step we show that locally the definition does not depend on the choice of branching structure, see \cite{HWZ7}, Lemma 3.5.
\begin{lemma}[Independence]\label{LOP1}\index{L- Well definedness of $\mu^U_\omega$}
Assume that $x\in \supp(\Theta)$ and $U=U(x)$ is an open neighborhood invariant under the natural $G_x$-action
and having the properness property. Suppose further that $U$ harbors two oriented local branching structures,
say ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, and ${(M_{i'},o_{i'})}_{i'\in I'}$, ${(\sigma_{i'})}_{i'\in I'}$ describing the oriented $\wh{\Theta}$ over $U$.
Then for a measurable subset $K$ of $M_U$ with corresponding $K_i\subset M_i$ for $i\in I$ and $K_{i'}\subset M_{i'}$ for $i'\in I'$ it holds
$$
\frac{1}{|G_x^{{\text{eff}}}|} \cdot \sum_{i\in I} \sigma_i\cdot \int_{K_i} \omega|(M_i,o_i)
= \frac{1}{|G_x^{{\text{eff}}}|} \cdot \sum_{i'\in I'} \sigma_{i'}\cdot \int_{K_{i'}} \omega|(M_{i'},o_{i'}).
$$
Here the index sets are disjoint, i.e. $I\cap I'=\emptyset$. 
\end{lemma}
\begin{proof}
In order to prove the lemma we assume an oriented, compact, and tame  $\wh{\Theta}$ is given. Let $x\in \supp(\Theta)$ and $U(x)$ be
an open neighborhood equipped with the natural $G_x$-action, and the properness property.  On $U(x)$ we assume that
two local oriented branching structures are given, say
$$
{(M_i,o_i)}_{i\in I},\ {(\sigma_i)}_{i\in I}\ \ \text{and}\ \ {(M_{i'},o_{i'})}_{i'\in I'},\ \  {(\sigma_{i'})}_{i'\in I'},
$$
which represent $\Theta$ and $\wh{\mathsf{T}}_\Theta$, i.e. for $y\in U(x)$
\begin{eqnarray}
\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i &=&\sum_{\{i'\in I'\ |\ y\in M_{i'}\}}\sigma_{i'}\\
\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i \cdot T_y(M_i,o_i)&= &\sum_{\{i'\in I'\ |\ y\in M_{i'}\}} \sigma_{i'}\cdot T_y(M_{i'},o_{i'}).\nonumber
\end{eqnarray}
We assume that $\omega\in \Omega^n_\infty(Y)$ and denote by $\pi:U(x)\rightarrow |U(x)|$
the projection $y\rightarrow |y|$.   We show that for $K\subset |U(x)|$ with
$K_i= (\pi|M_i)^{-1}(K)$ and $K_{i'}:=(\pi|M_{i'})^{-1}(K)$  the equality
\begin{eqnarray}\label{XWEQ1}
\sum_{i\in I} \sigma_i\cdot \int_{K_i} \omega|(M_i ,o_i)=\sum_{i'\in I'} \sigma_{i'}\cdot \int_{K_{i'}}\omega|(M_{i'},o_{i'})
\end{eqnarray}
holds. 
If this is known to hold  the rest of the proof of Theorem \ref{IandS} follows easily. The difficulty in establishing the validity of 
(\ref{XWEQ1}) arises from the fact that in general there does not exist  a correspondence between the submanifolds
of the branching structures, so that one needs to analyze the branching sets in more detail.  
This is the place where the considerations of Section \ref{SEC15.4} enter, particularly Proposition \ref{prop948}.

Associated to the local branching structures we have with the notation in Section \ref{SEC15.4}
the sets $M_U=M_U'$ as well as $M_U^{\dagger}$, see Proposition \ref{prop948}. 
Denote by $A_1\sqcup..\sqcup A_p$  the decomposition of $M_U^\dagger$ according to Proposition \ref{prop948}.


If we subtract from the $K_i$ or $K_{i'}$ the set $M_U\setminus M_U^{\dagger}$, resulting in the sets $K_i^{\dagger}$ and $K_{i'}^{\dagger}$,
it holds, using that this is a measure zero modification
$$
\sum_{i\in I} \sigma_i\cdot\int_{K_i^{\dagger}}\omega|(M_i,o_i) =\sum_{i\in I} \sigma_i\cdot\int_{K_i}\omega|(M_i,o_i)
$$
and
$$
\sum_{i'\in I'} \sigma_{i'}\cdot\int_{K_{i'}^\dagger}\omega|(M_{i'},o_{i'}) =\sum_{i'\in I'} \sigma_{i'}\cdot\int_{K_{i'}}\omega|(M_{i'},o_{i'}).
$$
The set $K_i^\dagger $ decomposes
as 
$$
K^\dagger_i=\bigsqcup_{p=1}^\ell K^{\dagger p}_i,
$$
where $K^{\dagger p}_i:= K^\dagger_i\cap A_p$.
 We compute, using heavily Proposition \ref{prop948}:
\begin{eqnarray*}
&&\sum_{i\in I} \sigma_i\cdot\int_{K_i^{\dagger}}\omega|(M_i,o_i)= \sum_{i\in I} \sum_{p=1}^\ell\sigma_i\cdot\int_{K_i^{\dagger p}}\omega|(M_i,o_i)\\
&=&\sum_{p=1}^\ell \sum_{i\in I} \sigma_i\cdot\int_{K_i^{\dagger p}}\omega|(M_i,o_i)=\sum_{p=1}^\ell \sum_{i\in I_p}\sigma_i\cdot\int_{K_i^{\dagger p}}\omega|(M_i,o_i)\\
&=&\sum_{p=1}^\ell \left(\sum_{i\in I_p^+} \sigma_i-\sum_{i\in I_p^-}\sigma_i\right)\cdot \int_{K_{i_p^+}^{\dagger p}} \omega |(M_{i_p^+},o_{i_p^+})
\end{eqnarray*}
\begin{eqnarray*}
&=&\sum_{p=1}^\ell \left(\sum_{i'\in I'^+_p} \sigma_{i'}-\sum_{i'\in I'^-_p}\sigma_{i'}\right)\cdot \int_{K_{i'^+_p}^{\dagger p}} 
\omega |(M_{{i'}_p^+},o_{{i'}_p^+})\\
&=&\sum_{p=1}^\ell \sum_{i'\in I'_p}\sigma_{i'}\cdot\int_{K_{i'}^{\dagger p}}\omega|(M_{i'},o_{i'})=\sum_{p=1}^\ell \sum_{i'\in I'} \sigma_{i'}\cdot\int_{K_{i'}^{\dagger p}}\omega|(M_{i'},o_{i'})\\
&=& \sum_{i'\in I'}\sum_{p=1}^\ell \sigma_{i'}\cdot\int_{K_{i'}^{\dagger p}}\omega|(M_{i'},o_{i'})=\sum_{i'\in I'} \sigma_{i'}\cdot\int_{K_{i'}^{\dagger}}\omega|(M_{i'},o_{i'}).
\end{eqnarray*}
This shows that local integrals are well-defined and do not depend on the local branching structure.
\qed \end{proof}
The procedure  defines, associated
to an sc-differential form $\omega$ for a  local branching structure on $U(x)$,  which we assume to be invariant under the natural action of $G_x$
and having the properness property, a signed measure $\mu_\omega^{U(x)}$ for measurable subsets contained in $|U(x)|\subset S$, namely
$$
\mu^{U(x)}_\omega(K)=\frac{1}{|G^{\text{eff}}_x|} \cdot \sum_{i\in I}\sigma_i\cdot \int_{K_i} \omega|(M_i,o_i).
$$
From the construction it is clear that if $\tau=f\cdot \omega$ then 
\begin{eqnarray}\label{EQ918}
d\mu_\tau^{U(x)} = \bar{f}||U(x)|  \cdot d\mu_\omega^{U(x)},
\end{eqnarray}
with $\bar{f}\circ\pi =f$.
We shall use this fact later on.  
\begin{remark}\label{DFGX}
We point out that even if $U(x)$ and $U(x')$ are as before and $|U(x)|=|U(x')|$ with $|x|=|x'|$
it is still a possibility that $\mu^{U(x)}_\omega$ and $\mu^{U(x')}_\omega$ are not the same on $|U(x)|$.
This point is being addressed in Lemma \ref{LOP3}.
\qed
\end{remark}
  Since $S=|\supp(\Theta)|$ is compact the set $S$ can be 
covered by finitely many such constructions.  We want to show that this fact can be used to define a global signed measure, which boils down to showing that
the constructions coincide on the overlaps. We need Lemma 3.6 from \cite{HWZ7}. 

\begin{lemma}[Restrictions]\label{LOP2} \index{L- Restriction of $\mu^U_\omega$}
Let $X$ be an ep-groupoid and $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ an oriented, tame, branched ep$^+$-subgroupoid.   For $x\in \supp(\Theta)$
let $U=U(x)$ be an open subset invariant under the natural $G_x$-action, having the properness property,
and also supporting a local oriented  branching structure ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ for $\wh{\Theta}$.
Further let $y\in U$ with isotropy group $H_y$ and assume  $V=V(y)\subset U$ is an open neighborhood with the natural
$H_y$-action. For an sc-differential form $\omega$ denote the associated signed measures by $\mu^{U}_\omega$ and $\mu^{V}_\omega$.
Then, if a measurable subset $K\in {\mathcal L}(S)$ is contained in $|M_V|\subset |M_U|\subset S$ it holds 
$$
\mu^{U}_\omega(K)=\mu^{V}_\omega(K).
$$
\end{lemma}
\begin{proof}
The proof is given in \cite{HWZ7}.  Since the definition of the measures is independent of the actual 
local oriented branching structure we can take the one on $V$ which is induced from the one on $U$.
Then the result follows from a computation involving the orders of isotropy groups.
\qed \end{proof}

We address now the point raised in Remark \ref{DFGX},   see also \cite{HWZ7}, Lemma 3.7.
\begin{lemma}[Morphism Invariance]\label{LOP3}\index{L- Morphism invariance}
Let $X$ be an ep-groupoid and $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ a tame, compact, oriented branched ep$^+$-subgroupoid.
Assume that $x,x'\in \supp(\Theta)$ and $\phi:x\rightarrow x'$ is a morphism.  Let $U=U(x)$ and $U'=U(x')$
be open neighborhood allowing for the natural actions by $G_x$ and $G_{x'}$, respectively, and suppose the sets have the 
properness property. In addition we assume that the natural local sc-diffeomorpism associated to $\phi$, 
defines an sc-diffeomorphism $\wh{\phi}:U\rightarrow U'$. Given an sc-differential form $\omega$ on $X$ the equality
$$
\mu^U_\omega(K)=\mu^{U'}_\omega(K)
$$
holds for measurable subsets $K$ contained in $|M_U|=|M_{U'}|$. 
\end{lemma}
\begin{proof}
This is nothing else but change of variables.
\qed \end{proof}
Now we are in the position to prove Theorem \ref{IandS}.
\begin{proof}[Theorem \ref{IandS}]
Using the compactness of $S=|\supp(\Theta)|$ there exist finitely many points $x_1$,..,$x_\ell$
and open neighborhood $U_p:=U(x_p)$ admitting the natural $G_{x_p}$-action, having the properness property,
and having an oriented local branching structure ${(M^p_i,o^p_i)}_{i\in I^p}$, ${(\sigma_i^p)}_{i\in I^p}$ representing the oriented
$\wh{\Theta}$ over $U_p$, so that
$$
S=\bigcup_{p=1}^\ell |M_{U_p}|.
$$
 With the given sc-differential form $\omega$ we obtain the signed measures
$$
\mu^{U_p}_\omega
$$
on $|M_{U_p}|\subset S$.  Given a measurable subset $K$ of $S$ in ${\mathcal L}(S)$ we partition 
it in such a way that $K=\bigsqcup_{p=1}^\ell  K_p$ with $K_p\subset |M_{U_p}|$ and consider the sum
$$
\sum_{p=1}^\ell \mu^{U_p}_\omega(K_p).
$$
This definition does not depend on the choices involved, due to Lemmata \ref{LOP1}, \ref{LOP2}, and \ref{LOP3}.
It defines our desired signed measure $\mu_\omega^\Theta$. 
\qed \end{proof}
\begin{remark}\index{R- Questions about branched ep$^+$-subgroupoids}
(a) In \cite{HWZ7} the theorem was proved under the assumption that $X$ allows sc-smooth partitions of unity.
The modification of the proof presented above gets rid of this assumption.\par

(b) It should be possible to define $\mu_\omega$ also for compact, oriented, branched ep$^+$-subgroupoids, getting rid
of the tameness assumption. This would require to show that the boundaries of the occurring sub-M$^+$-polyfolds have measure
zero, which in all likelihood is the case. We leave such investigation to the reader.\par

(c) It might even be true that a compact sub-M$^+$-polyfold in a M-polyfold has a boundary which is a Lipschitz manifold,
which would have consequences for the the boundary structure of compact,  branched, ep$^+$-subgroupoids. 
It would in particular imply that the following considerations about Stokes theorem should be true for oriented 
$\Theta$ which are not tame. We also leave such investigations to the reader.
\qed
\end{remark}

Given an ep-groupoid $X$ and a compact, tame, oriented branched ep$^+$-subgroupoid $\wh{\Theta}:X\rightarrow {\mathbb Q}$
there is an oriented $\partial\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ according to Definitions \ref{DEF9214} and \ref{DEF936}
and the associated discussions in previous sections.  Since $\Theta$ is tame the M$^+$-polyfolds occurring in the local branching 
structures have an equivalent structure as classically smooth manifolds $M$ with boundary with corners. Given such a M$^+$-polyfold
and a boundary point $x$ with degeneracy index $d=d_M(x)$, the boundary near $x$ consists of of the union of $d$-many local faces.
 
If $d\geq 2$ the intersection of two or more such faces,   as a subset of any such face, has $(n-1)$-dimensional Lebesgue measure $0$, where $n=\dim(M)$.
If $K\subset \partial M$ we have consequently a well-defined notion of being of {\bf $(n-1)$-dimensional measure zero}\index{Measure zero}. 
In view of this discussion we can define the Lebesgue $\sigma$-algebra ${\mathcal L}(\partial S)$, where $\partial S = |\supp(\partial\Theta)|$,
since there is a well-defined notion of a subset of $\partial S$ to be of $(n-1)$-dimensional measure zero.
\begin{definition}[Canonical $\sigma$-Algebra ${\mathcal L}(\partial S)$]\index{D- Canonical $\sigma$-Algebra ${\mathcal L}(\partial S)$}
Let $X$ be an ep-groupoid and $\Theta:X\rightarrow {\mathbb Q}^+$  a tame, compact, branched ep$^+$-subgroupoid.
The $\sigma$-algebra ${\mathcal L}(\partial S)$ \index{${\mathcal L}(\partial S)$} is the smallest $\sigma$-algebra containing the Borel $\sigma$-algebra ${\mathcal B}(\partial S)$\index{${\mathcal B}(\partial S)$}
and all subsets of $\partial S$ of measure zero.
\qed
\end{definition}
With the same techniques as used in the proof of Theorem \ref{IandS} we obtain the following theorem for boundary integration,
where ${\mathcal M}(\partial S,{\mathcal L}(\partial S))$ \index{${\mathcal M}(\partial S,{\mathcal L}(\partial S))$} is the vector spaces of signed measures.
\begin{theorem}[Canonical Boundary Measures]\label{THM9510}\index{T- Canonical boundary measures}
Assume $X$ is an ep-groupoid and $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ an oriented tame, compact, branched ep$^+$-subgroupoid of dimension $n$.
Then there exists a linear map 
$$
\Phi_{\partial\wh{\Theta}}:\Omega^{n-1}_\infty(X)\rightarrow {\mathcal M}(\partial S,{\mathcal L}(\partial S)):\omega\rightarrow \mu_\omega^{\partial\wh{\Theta}}
$$
which is uniquely characterized by the following property.
\begin{itemize}
\item Given $x\in \supp(\partial \Theta)$, an open neighborhood $U(x)$ in $X$ with the natural $G_x$-action and the properness property,
and an oriented branching structure on $U(x)$ representing $\wh{\Theta}$, say ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, the following identity
holds for a measurable subset $K\in {\mathcal L}(\partial S)$ with $K\subset |M_U^\partial| :=| \bigcup_{i\in I} \partial M_i|$
$$
\mu_{\omega}^{\partial\wh{\Theta}}(K) =\frac{1}{\sharp G_x^{\text{eff}}}\cdot \sum_{i\in I} \sigma_i\cdot \int_{K_i} \omega|(\partial M_i,o_{\partial M_i}),
$$
where $K_i\subset \partial M_i$ is the preimage of $\pi:\partial M_i\rightarrow |\supp(\partial\Theta)|\cap |U(x)|$.
\end{itemize}
\qed
\end{theorem}
\begin{remark}\index{R- Question concerning Stokes Theorem}
In our context we have a version of Stokes theorem, which can be formulated as follows.
\begin{theorem}[Stokes Theorem]\index{T- Stokes theorem}
Let $X$ be an ep-groupoid admitting sc-smooth partitions of unity, and $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ a tame, oriented, compact, branched ep$^+$-subgroupoid
of dimension $n$. Denote by $\partial\wh{\Theta}$ its oriented boundary and by $\omega$ an sc-differential form of degree $n-1$.
Then 
$$
\mu_\omega^{\partial\wh{\Theta}}(\partial S) =\mu_{d\omega}^{\wh{\Theta}}(S),
$$
or equivalently
$$
\oint_{\wh{\Theta}} d\omega   = \oint_{\partial\wh{\Theta}} \omega.
$$
\end{theorem}
The assumption of having an sc-smooth partition of unity is very likely not needed and enters since we use the standard ideas for proving 
Stokes theorem.
\end{remark}
\begin{proof}
We cover the compact $S$ by finitely many  open sets  $|U_k|$, where 
$U_k=U(x_k)$, $1\leq  k\leq \ell$ are open sets admitting the natural $G_{x_k}$-action, have the properness property
and are equipped with an oriented branching structure representing $\wh{\Theta}$.
We denote  the oriented  local  branching structures  by $(M_i,o_i)_{i\in I^k}$ (for $k=1,...,\ell$)  with the associated weights ${(\sigma_i)}_{i\in I^k}$. 
Then we have the total index set $I =I_1\sqcup ...\sqcup I_\ell$.

The $M_i$  are tame  finite dimensional submanifolds of $X$, all  of the same dimension $n$ and for $i\in I_k$
the $M_i$ are properly embedded in $U(x_k)$ and over $U(x_k)$ the functor $\Theta$ and associated orientation can be written as
\begin{eqnarray}
&\Theta(y)=\sum_{\{i\in I_k\ |\ y\in M_{i}\}} \sigma_i\ \ \text{for}\ \ y\in U(x_k)&\\
&\wh{\mathsf{T}}_{\Theta}(y) =\sum_{\{i\in M_i\ |\ y\in M_i\}} \sigma_i\cdot T_y(M_i,o_i)\ \ \text{for}\ \ y\in U(x_k).&\nonumber
\end{eqnarray}
Abbreviate $U_k:=U(x_k)$ for $k=1,...,\ell$ and 
 denote by $U_{k}^*$ the saturations of the sets $U_{k}$ in $X$ and add  another saturated open set $U^\ast_0$ so that
the sets $U^\ast_{k}$  cover $X$ and 
the sets $\abs{U^\ast_{k}\setminus \overline{U^\ast_0}}$  still cover $S$.
Given this finite open covering of $X$ by saturated set we can  take a subordinate sc-smooth partition of unity  $\beta_0,\ldots ,\beta_\ell$ on $X$ for the
ep-groupoid $X$.  Hence the $\beta_i$ are functors with values in $[0,1]$ and   $\supp \beta_k\subset U^{\ast}_k$.
By construction 
$$
\sum_{k=1}^\ell\beta_k =1\ \ \text{on}\ \  \bigcup_{k=1}^\ell M_{U_{k}}.
$$
We define   $\omega_k=\beta_k \omega$ so that its support is contained in $\supp \omega_k\subset U^*_k$ and
$\omega=\sum_{k=1}^n\omega_k$.

If  the set $|U_k|$ does not contain parts of $|\supp(\partial\Theta)|$,  we
conclude  by the standard Stokes theorem
$$
\int_{(M_i,o_i)} d\omega_{k} =0 \ \text{for}\ \ i\in I_k.
$$
In the other case, again by the standard Stokes theorem,
$$
\int_{(M_i,o_i)} d\omega_k=\int_{\partial (M_i,o_i)} \omega_{k}\ \ \text{for}\ \ i\in I_k.
$$
Summing  up  all these contributions we conclude the following.
\begin{eqnarray*}
\mu^{\wh{\Theta}}_{d\omega}(S)&=& \sum_{k=1}^\ell\mu^{\wh{\Theta}}_{d\omega_k}(S)\\
&=& \sum_{k=1}^\ell \frac{1}{\sharp G_{x_k}^{\text{eff}}}\cdot \sum_{i\in I_k}\sigma_i\cdot \int_{(M_i,o_i)}d\omega_k\\
&=& \sum_{k=1}^\ell \frac{1}{\sharp G_{x_k}^{\text{eff}}}\cdot \sum_{i\in I_k}\sigma_i\cdot \int_{\partial (M_i,o_i)}\omega_k\\
&=&\sum_{k=1}^\ell \mu_{\omega_k}^{\partial\wh{\Theta}}(\partial S)\\
&=& \mu^{\partial\wh{\Theta}}_\omega (\partial S).
\end{eqnarray*}
The proof of Stokes' theorem in the branched context is complete.
\qed \end{proof}

\section{Appendix}\label{SEC96}
In the following two subsections we shall discuss several questions, whose answers 
are related to possible generalizations of the results in this chapter.
Given an ep-groupoid $X$ and a compact oriented ep$^+$-subgroupoid $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$
we have interpreted it as a full subcategory of $X$ with a weight function and we use some of the ambient
structure when we talk about local branching structures. Of course, it would be nice to define an intrinsic 
object, without reference to an ambient $X$, which would have similar properties, and would allow an integration theory, as well
as the notion of differential forms. Another question is concerned with the necessity of the tameness assumption.
It is possible that combining our discussion with results from a Lipschitz theory of manifolds would lead to an appropriate
generalization. 


\subsection{Questions about M\texorpdfstring{$^+$}{pol}-Polyfolds}
A M$^+$-polyfold is a M-polyfold admitting an sc-smooth atlas, where the local models 
are sc$^+$-retracts $(O,C,E)$. If $d_M:M\rightarrow {\mathbb N}$  denotes  the associated degeneracy index, we know 
that near points $x\in M$ with $d_M(x)=0$ it has the structure of a smooth classical manifold.

In general the boundary behavior is complicated. However, as we have seen if $x\in \partial X$ and $X$ is tame near $x$,
then the fact that $T_xM$ is in good position to the partial quadrant $C_x$,  implies that $M$ near $x$ has the equivalent structure
of a classically smooth manifold with boundary with corners.  \par

\noindent {\bf Question 1:}  Since $O=r(U)$ for a relatively  open neighborhood of $0$ in the partial quadrant $C$ 
one can show that the sc$^+$-operator $Dr(0):E\rightarrow E$ has the property $Dr(0)(C)\subset C$. 
This distinguishes the smooth finite-dimensional linear subspaces $N$ of $E$ which can be written as the image 
of an sc$^+$-projection $P:E\rightarrow E$ with $P(C)\subset C$.  Let us refer to such $N$ as special $N$.
One can show that the interior of $N\cap C$ in $N$ is nonempty.
We can consider as local models for spaces open neighborhoods $V$ of $0\in N\cap C$, which we refer to as an open neighborhood
of $0$ in $(N,C,E)$, where $N$ is special. One can define in a standard way what a classically smooth map between two such
open sets is.  This allows us to define charts for metrizable spaces $M$ and smooth atlases.   This defines a class of
manifolds modeled on special $(N,C,E)$.  It is trivial to show that such manifolds are M$^+$-polyfolds using the property $P(C)\subset C$. 
The question is,  if every M$^+$-polyfold admits an equivalent atlas with special models?\par

\noindent{\bf Question 2:} Let $M$ be a compact M$^+$-polyfold of dimension $n$.  Does $\partial M$ have naturally the structure
of a Lipschitz-manifold of dimension $n-1$, see \cite{Heinonen,Rosen}. If that is the case one should be able 
to prove Stokes for every oriented, compact,  branched ep$^+$-subgroupoid $\wh{\Theta}$ using Stokes theorem in the Lipschitz context. 
In Remark \ref{rem116} we indicated even a possible generalization for defining M-polyfolds where $C$ is being replaced by more general
convex sets with nonempty interior. If it is indeed true that a Lipschitz version of Stokes can be applied, may be it even generalizes 
to such a more general setup.\par


The answers to these questions might allow to generalize some of the results about integration, but are also useful in studying the question
what is the intrinsic structure of an  ep$^+$-subgroupoid. We  raise some question about the latter in the next subsection.

\subsection{Questions about Branched Objects}
The definition of an ep$^+$-subgroupoid requires an ambient space. However, there seems to be an  underlying intrinsic object in the background.
The intrinsic object should be the metrizable space $|\supp(\Theta)|$ together with an additional structure. 
The following mentions some ideas to describe such an object, but the details have not been carried out.
Possibly these ideas need some modification.

Consider tuples $(M_U,w,U,C,E)$, where $E$ is an sc-Banach space,  $C\subset E$ a partial quadrant, $U\subset C$ a relatively open subset,
and $M_U$ a subset of $U$, and $w:M_U\rightarrow {\mathbb Q}^+$ is a map  with the following properties:
\begin{itemize}
\item[(1)]\ There exist finitely many  sc$^+$-retracts $(M_i,C,E)$ for $i\in I$ and positive rational weights $ {(\sigma_i)}_{i\in I}$
such that $M_i\subset U$ is properly embedded as submanifold.
\item[(2)]\ $M_U=\bigcup_{i\in I} M_i$.
\item[(3)]\ $w(y)= \sum_{\{i\in I\ |\ y\in M_i\}}\sigma_i$ for $y\in M_U$. 
\end{itemize}
We shall refer to $(M_U,w,U,C,E)$ as a branched manifold model. If $U'\subset C$ is relatively open and $U'\subset U$
we can define 
$$
(M_U,w,U,C,E)_{U'} =(M_{U'},w',U',C,E)
$$
 by restricting the data. We call this the restriction to $U'$.
 

We say that $(M_U^i,w^i,U^i,C^i,E^i)$ for $i=1,2$ are isomorphic provided there exists 
a homeomorphism $h:M_U^1\rightarrow M_U^2$ satisfying
\begin{itemize}
\item[(1)]\ $w^2\circ h =w^1$
\item[(2)]\ If $N\subset M_U$ is such that  $(N,C,E)$ is an sc$^+$-retract, then $(h(N),C,E)$ is an sc$^+$-retract.
The same for $h^{-1}$.
\item[(3)]\ $h:N\rightarrow h(N)$ is an sc-diffeomorphism.
\end{itemize}
The notion of equivalence accommodates the fact that $M_U$ can be written possibly  in different ways 
as union of M$^+$-polyfolds. Naturally the discussion of the geometry of local branching structures enters.
The local models have to be defined as subset of an ambient space to catch the variety of possible
branching structures. 

Let us refer to an object $\Xi=(M_U,w,U,C,E)$ as a branched M$^+$-polyfold model.  Following ideas in this book
one should be able to define the tangent $T\Xi$, and one should be able to define the notion of an orientation. 
There should be a notion of an sc-smooth map between such objects. Then one can define
 charts with the $\Xi$ as local models and sc-smooth atlases.  This would lead to the notion 
 of a branched M$^+$-polyfold.

 At this point we could employ the definition of an ep-groupoid, but take 
as local models the branched M$^+$polyfold models. Let us call such a space a branched ep$^+$-groupoid. 

The structure on $S=|\supp(\Theta)|$ would be given by an equivalence class $(Q,\beta)$, where $Q$ is a branched
ep$^+$-groupoid and $\beta:|Q|\rightarrow S$ is a homeomorphism. The notion of equivalence is parallel to the kind of Morita equivalence
used in giving a definition of orbifold using \'etale proper Lie groupoids, see \cite{AR,Mj,MM}. Such an idea is also applied
in Chapter \ref{chap11+}.
The boundaries of such spaces should be accessible to Lipschitz type methods mentioned in the previous subsection and there 
should be
Stokes theorem in this context.\par

\noindent{\bf Question 3:}  Is there a theory along the lines described above, i.e. build on branched local models, providing 
standard features expected from classical differential geometry or Lipschitz geometry (at least for the boundary portion)?



\chapter{Equivalences and Localization}\label{SEC2}
An equivalence between ep-groupoids is the sc-smooth version of an equivalence of categories.
In this chapter we shall study notions which are invariant under equivalences and introduce 
the notion of generalized maps. The ideas come from a well-known procedure in category theory, see \cite{GZ},
and also have been used in the classical Lie groupoid context, see \cite{Mj}.

\section{Equivalences}\label{SST_0}

The category ${\mathcal{EP}}$\index{${\mathcal{EP}}$} has  ep-groupoids as objects.  Its  class of morphisms $\textrm{mor}({\mathcal{EP}})$\index{$\textrm{mor}({\mathcal{EP}})$} consists of the sc-smooth functors between ep-groupoids and 
contains an interesting subclass  of morphisms called equivalences,  defined as follows.
\begin{definition}\label{equiv}\index{D- Equivalences}
An {\bf equivalence}  $F\colon X\rightarrow Y$ between the ep-groupoids  $X$ and $Y$ is a sc-smooth functor  having the following properties.
\begin{itemize}
\item[(1)]\ $F$ is faithful and full. 
\item[(2)]\  The induced map $|F|:|X|\rightarrow |Y|$ between the orbits spaces is a homeomorphism.
\item[(3)]\  $F$ is a local sc-diffeomorphism on objects.
\end{itemize}
We denote the {\bf class of equivalences}\index{Class of equivalences} by  ${\bf E}$\index{${\bf E}$}.
\qed
\end{definition}

We recall from the  category theory that a functor $F:X\to Y$ between two categories $X$ and $Y$ is called  {\bf faithful}\index{Faithful functor} if for every $x, x'\in X$, the induced map $\textrm{mor}_X(x, x')\to \textrm{mor}_Y(F(x), F(x'))$ is injective, 
and it is called {\bf full}\index{Full functor} if for every $x, x'\in X$, the induced map $\textrm{mor}_X(x, x')\to \textrm{mor}_Y(F(x), F(x'))$ is surjective.  If, in addition, the functor $F$ is {\bf essentially surjective}\index{Essentially surjective functor}, that is,  if 
for every object $y$ in $Y$ there exist an object $x$ in $X$ and an isomorphism $\varphi:F(x)\to y$, then the functor $F:X\to Y$ is called an {\bf equivalence}\index{Equivalence between categories}. If the functor $F:X\to Y$ between two categories $X$ and $Y$ is an equivalence in the sense of the category theory, then the induced map $\abs{F}:\abs{X}\to \abs{Y}$ is a bijection. 




The following result characterizes equivalences between ep-groupoids.
\begin{lemma}\label{equivalence_in_the sense_of_category_theory}\index{L- Characterization of equivalences}
Assume that $F:X\rightarrow Y$ is a sc-smooth functor between ep-groupoids  which is an equivalence in the category sense 
and,  in addition,  is a local sc-diffeomorphism on the class of objects. Then  $F$ is an equivalence in the sense of Definition \ref{equiv}.
\end{lemma}
\begin{proof}
In view of the above remarks, it is enough to show that the induced map $\abs{F}:\abs{X}\to \abs{Y}$ is a homeomorphism.  Since the functor $F$ is sc-smooth and hence $\ssc^0$, the map 
$\abs{F}$ is  continuous between every level. Take a point $\abs{x}\in \abs{X}$ and its representative $x\in X$.  Then, by our assumption,  we find an open neighborhood $U$ of $x$ in $X$ so that 
$F:U\to F(U)$ is a sc-diffeomorphism. In particular, $F(U)$ is an open  subset of  $Y$. Since the  projection map $\pi:X\to \abs{X}$ is an open map and  $\abs{F}(\abs{U})=\abs{F(U)}$, it follows that $\abs{F(U)}$ is open in $\abs{Y}$. This holds for any open subset of $U$, and the proof is complete.
\qed \end{proof}

If $F\colon X\to Y$ and $G\colon Y\to Z$ are equivalences between ep-groupoids, then the composition $G\circ F\colon X\to Z$ is also an equivalence. In general, an equivalence is not invertible as a functor.

 
If $X$ is an ep-groupoid and ${\mathcal U}$ an open covering of the object M-polyfold, we define an ep-groupoid  $X_{{\mathcal U}}$ as follows. 
The object M-polyfold is the disjoint union of all the open sets $U\in {\mathcal U}$
$$
X_{{\mathcal U}}=\sqcup_{U\in {\mathcal U}} U.
$$
We shall write $(x,U)$ for its elements, where $x\in U$. The morphism M-polyfold ${\bm{X}}_{{\mathcal U}}$ consists of all triples  $(U,\phi,V)$ in which $U, V\in {\mathcal U}$ and $\phi\in {\bm{X}}$ is a morphism satisfying  $s(\phi)\in U$ and $t(\phi)\in V$.
The structural maps are the obvious ones. It is clear that this is a category whose object and morphism sets have M-polyfold structures induced from $X$ and ${\bm{X}}$, respectively.
We shall call $X_{{\mathcal U}}$ the {\bf refinement of the  ep-groupoid $X$}  associated with the  open covering ${\mathcal U}$.\index{Refinement  $X_{\mathcal U}$}\index{$X_{\mathcal U}$}
\begin{proposition}\label{fragmentation-x}\index{L- Fragmentation}
 $X_{{\mathcal U}}$ is an ep-groupoid and the map 
 $$
 F\colon X_{{\mathcal U}}\rightarrow X: (x,U)\mapsto  x
 $$
 is an equivalence of ep-groupoids.
 \end{proposition}
 \begin{proof}
 It is clear that object space and morphism space have natural M-polyfold structures coming from the ep-groupoid $X$.
The source and target maps,  defined by  $s(U,\phi,V)=(s(\phi),U)$ and $t(U,\phi,V)=(t(\phi),V)$,  are local sc-diffeomorphisms and $s,t\colon {\bm{X}}_{{\mathcal U}}\rightarrow X_{{\mathcal U}}$, 
 are by construction surjective. The smoothness properties of the structure  maps are obvious. Next we show that $X_{{\mathcal U}}$ is proper.  If  $(x,U)$ is  an object in $X_{{\mathcal U}}$,  we find an open neighborhood $V=V(x)$ of $x$ in $X$ such  that 
\begin{itemize}
\item[(1)]\ $\cl_X(V)\subset U$.
\item[(2)]\ $t:s^{-1}(\cl_X(V))\rightarrow X$ is proper. Here $s$ and $t$ are the source and target maps of the ep-groupoid  $X$.
\end{itemize}
The associated neighborhood of $(x,U)$ in $X_{{\mathcal U}}$ is then given by
$$
\wtilde{V}(x,U)=\{(y,U)\ |\ y\in V(x)\}.
$$
Note the closure of $\wtilde{V}\subset X_{{\mathcal U}}$ in $X_{{\mathcal U}}$ corresponds to the closure  of $V(x)$ in $X$.
Next, with $s$ and $t$ the source and target maps of $X_{{\mathcal U}}$ we show that 
$$
t:s^{-1}(\cl_{X_{{\mathcal U}}}(\wtilde{V}))\rightarrow X
$$ 
is proper.
We assume that $(\Phi_k)$ is a sequence in ${\bm{X}}_{|{\mathcal U}}$ with $s(\Phi_k)\in \cl(\wtilde{V})$ and $t(\Phi_k)$ belonging to a compact subset in $X_{|{\mathcal U}}$.
Writing $\Phi_k=(U_k,\phi_k,V_k)$ we know by assumption that $U_k=U$ and $s(\phi_k)\in \cl_X(V)$. Moreover $(t(\Phi_k))$ belongs to a compact subset 
$K$ of $X_{|{\mathcal U}}$. 
After perhaps taking a subsequence we may assume without loss of generality
that $V_k=W\in {\mathcal U}$ and $K\subset W$.
Hence we have a sequence $(\phi_k)\subset {\bm{X}}$ satisfying  $s(\phi_k)\in \cl_X(V)$ and $t(\phi_k)\in K$.
 Now using the properness of $X$ we may take another subsequence converging  to a morphism $\phi\in {\bm{X}}$ satisfying $s(\phi)\in \cl_X(V)$ and $t(\phi)\in K$. Then the convergence $\Phi_k\rightarrow (U,\phi,W)$ follows.
 Finally,  we note that $F$ is an equivalence of categories and a sc-smooth local sc-diffeomorphism, hence an equivalence of ep-groupoids in view of 
Lemma \ref{equivalence_in_the sense_of_category_theory}. 
  \qed \end{proof}

We recall from Section 
\ref{section_Tangent_Ep-Groupoid}, Definition \ref{natural_transf_def},  the notion of a natural equivalence between sc-smooth functors.
\begin{definition}[{\bf Natural equivalence}]\label{natural_equivalence}\index{D- Equivalence}
Two  sc-smooth functors $F:X\rightarrow Y$ and $G:X\to Y$ between the same ep-groupoids  are called {\bf naturally equivalent} if there exists 
 a sc-smooth map $\tau:X\rightarrow {\bm{Y}}$ having the following property.
 \begin{itemize}
 \item[(1)]\ For every object $x\in X$, $\tau (x)$ is a morphism,
$$
\tau (x)\colon F(x)\rightarrow G(x)\in {\bm{Y}}
$$
\item[(2)]\ The map $\tau$ is ``natural'' in the sense that 
$$
{\bf G}(\varphi)\circ \tau (x) = \tau (x')\circ {\bf F}(\varphi).
$$
for every morphism $\varphi:x\rightarrow x'$.  
\end{itemize}
The sc-smooth map $\tau\colon X\to {\bm{Y}}$ is called a {\bf natural transformation} of the two functors $F, G\colon X\to Y$ and symbolically referred to by 
$$\tau \colon F\to G.$$
\qed
\end{definition}

``Naturally equivalent'' is an equivalence relation for  sc-smooth functors $F, G\colon X\to Y$, which we denote by 
$$F\simeq G.$$
If $F\simeq G$ for two sc-smooth functors $F, G\colon X\to Y$ and if $\Phi\colon Y\to Z$ and $\Psi\colon Z\to X$ are sc-smooth functors, then 
$$F\circ \Psi\simeq G\circ \Psi\quad \text{and}\quad \Phi \circ F\simeq \Phi\circ G.$$
The following result is taken from \cite{HWZ3.5}, Proposition 2.7.
\begin{proposition}\label{equivalence_naturally_equivalent}\index{P- Equivalences {I}}
Assume that $F:X\to Y$ and $G:X\to Y$ are naturally equivalent  sc-smooth functors.  If one of them is an equivalence, so is the other.
\end{proposition}

Here is another useful property.
\begin{proposition}\label{another_property}\index{P- Equivalences {II}}
Assume that $F:X\rightarrow Y$ is an equivalence between ep-groupoids and $\Phi:Y\rightarrow Z$ a sc-smooth functor between ep-groupoids.
If $\Phi\circ F:X\rightarrow Z$ is an equivalence, so is $\Phi$.
\end{proposition}
\begin{proof}
Since on the object level $F$ and $\Phi\circ F$ are local sc-diffeomorphisms this holds for $\Phi$. 
Using that $\Phi\circ F$ is an equivalence it follows that it is essentially surjective, which then has to hold for $\Phi$.
Since $|F|$ and $|\Phi\circ F|$ are homeomorphisms we deduce via
$$
|\Phi| =|\Phi|\circ |F|\circ |F|^{-1} =|\Phi\circ F|\circ |F|^{-1}
$$
that $|\Phi|\colon \abs{X}\to \abs{Y}$ is a homeomorphism.

For two objects $y$ and $y'$ we have to show that the map $\Phi:{\bm{Y}}(y,y')\rightarrow{\bm{Z}}(\Phi(y),\Phi(y'))$ between the sets of morphisms is a bijection.
We assume that $\psi,\psi':y\rightarrow y'$ are morphisms satisfying $\Phi(\psi)=\Phi(\psi')$. Since $F$ is essentially surjective,  we find morphisms
$\phi:F(x)\rightarrow y$ and $\phi':F(x')\rightarrow y'$ and  consider the morphisms 
${(\phi')}^{-1}\circ\psi\circ \phi$ and  ${(\phi')}^{-1}\circ\psi'\circ \phi\colon F(x)\rightarrow F(x')$.  Because  $F$ is an equivalence,  there exist uniquely determined morphisms $\alpha,\alpha'\colon x\rightarrow x'$
solving 
$$
F(\alpha)={(\phi')}^{-1}\circ\psi\circ \phi\quad  \text{and}\quad F(\alpha')={(\phi')}^{-1}\circ\psi'\circ \phi.
$$
Applying the functor $\Phi$ to both expressions we compute
\begin{equation*}
\begin{split}
\Phi\circ F(\alpha)&=\Phi({(\phi')}^{-1}\circ\psi\circ \phi)\\
&=\Phi({(\phi')}^{-1})\Phi(\psi)\Phi(\phi)\\
&=\Phi({(\phi')}^{-1})\Phi(\psi')\Phi(\phi)\\
&=\Phi({(\phi')}^{-1}\circ\psi'\circ \phi)\\
&=\Phi\circ F(\alpha').
\end{split}
\end{equation*}
Since $\Phi\circ F$ is an equivalence,  we deduce $\alpha=\alpha'$,  implying
$$
{(\phi')}^{-1}\circ\psi\circ \phi={(\phi')}^{-1}\circ\psi'\circ \phi.
$$
Multiplying the inverses right and left,  we conclude that  $\psi=\psi'$. This proves the injectivity. 

A similar argument shows that  the map $\Phi:{\bm{Y}}(y,y')\rightarrow {\bm{Z}}(\Phi(y),\Phi(y'))$ is surjective.  Indeed, let  $\sigma:\Phi(y)\rightarrow\Phi(y')$ be a morphism in $ {\bm{Z}}(\Phi(y),\Phi(y'))$.  Since $F$ is essentially surjective, there exist 
$x,x'\in X$ and morphisms $\phi:F(x)\rightarrow y$ and $\phi':F(x')\rightarrow y'$. Then 
$$
\Phi(\phi')^{-1}\circ \sigma \circ\Phi(\phi) :\Phi\circ F(x)\rightarrow \Phi\circ F(x')
$$
belongs to $ {\bm{Z}}$,
and using that $\Phi\circ F$ is an equivalence we find a morphism $\alpha:x\rightarrow x'$ satisfying 
$$
\Phi\circ F(\alpha) = \Phi(\phi')^{-1}\circ \sigma \circ\Phi(\phi).
$$
We define the morphism  $\beta:y\rightarrow y'$ in ${\bm{Y}}$
by
$$
\beta=\phi'\circ F(\alpha) \circ  \phi^{-1}\in {\bm{Y}}(y, y')
$$
and compute,
\begin{equation*}
\begin{split}
\Phi(\beta)
&= \Phi(\phi')\circ \Phi\circ F(\alpha)\circ \Phi(\phi)^{-1}\\
&=\Phi(\phi')\circ \Phi(\phi')^{-1}\circ \sigma\circ \Phi(\phi)\circ \Phi(\phi)^{-1}\\
&=\sigma,
\end{split}
\end{equation*}
showing that $\Phi $ is surjective. 
This completes the proof of Proposition \ref{another_property}.
\qed \end{proof}
One of the basic results is the following theorem.
\begin{theorem}\label{gertrude}\index{T- Tangent of an equivalence}
If $F:X\rightarrow Y$ is an equivalence between ep-groupoids, then $TF:TX\rightarrow TY$ is an equivalence between ep-groupoids.
\end{theorem}


\begin{proof}
Since $F$ is a local sc-diffeomorphism, the same holds for the sc-smooth functor $TF:TX\to TY$. Hence, in view of Lemma \ref{equivalence_in_the sense_of_category_theory},  it suffices to show that $TF$ 
is an equivalence in the category theory sense. 
That $TF$ is a functor follows from the fact that $F$ is a functor.
Let us show next that $TF$ is essentially surjective.  We choose $a\in T_yY$. First of all we note that there exist 
$x\in X_1$ and $\phi\in {\bm{Y}}_1$ such  that 
$$
\phi:F(x)\rightarrow y.
$$
For  suitable open neighborhoods the source map  $s_Y:U(F(x))\rightarrow U(y)$ is a sc-diffeomorphism. We consider
for $x'$ near $x$ the map
$$
x'\mapsto  t_Y\circ (s_Y|U(\phi))^{-1}(F(x')).
$$
Differentiating at $x'=x$ in the direction $b\in T_xX$ gives the linear map
$$
b\mapsto Tt_Y(\phi)\circ (Ts_Y(\phi))^{-1}TF(x)(b)
$$
This is a linear isomorphism $T_xX\rightarrow T_yY$. Hence, we find a vector $b\in T_xX$ which is mapped to the given vector $a\in T_yY$.

Choosing $k=Ts_Y(\phi))^{-1}TF(x)(b)\in T_\phi{\bm{Y}}$, 
we obtain 
$$
Ts_Y(\phi)(k)=TF(x)(b)\ \ \text{and}\ \ Tt_Y(\phi)(k)=a.
$$
Therefore,  recalling Section \ref{section_Tangent_Ep-Groupoid}, the 
tangent vector $k\in T_\phi {\bm{Y}}$ is, by definition, the morphism 
$$
k\colon TF(b)\rightarrow a
$$
in $T{\bm{Y}}$.
This shows that $TF$ is essentially surjective. 
We leave the verification that $TF$ is full and faithful to the reader.
\qed \end{proof}



The next proposition shows that if two equivalences $F$ and $G$ satisfy $|F|=|G|$,   then  also $|TF|=|TG|$.
For the proof we shall need the following lemma.


\begin{lemma}\label{very_go}
Let $X$ be an  ep-groupoid, $x\in X$, and $U(x)$ a connected  open neighborhood of $x$ in $X$ equipped with the natural representation
$$
\Phi:G_x\rightarrow \text{Diff}_{sc}(U(x)).
$$
Suppose $\beta:U(x)\rightarrow X$ has an open image and  is an sc-diffeomorphism onto its image  satisfying $\beta(x)=x$, and 
$|\beta(y)|=|y|$ for all $y\in U(x)$. Then the following holds.
\begin{itemize}
\item[{\em(1)}]\ $\beta(U(x))=U(x)$ and $\beta:U(x)\rightarrow U(x)$ is an sc-diffeomorphism.
\item[{\em (2)}]\ There exists $g\in G_x$ such that $\beta(y)=g\ast y$ for all $y\in U(x)$.
\end{itemize}
\end{lemma}
\begin{proof}
Assume first that $X$ is effective.
Pick any point $y\in U(x)$ and take a continuous path $\gamma:[0,1]\rightarrow U(x)$ satisfying $\gamma(0)=x$ and $\gamma(1)=y$.
We consider the continuous map $\beta\circ \gamma:[0,1]\rightarrow X$. We show that the image of this map lies in $U(x)$.
Let $\varepsilon_0\in (0,1]$ be the largest number such that 
$$
\beta\circ\gamma([0,\varepsilon))\subset U(x).
$$
It is clear that $\varepsilon_0>0$.  Pick a sequence $(t_k)\subset [0,\varepsilon_0)$ converging monotonically 
to $\varepsilon_0$ and abbreviate $x_k:=\gamma(t_k)$.  Then $x_k\in U(x)$, $\beta(x_k)\in U(x)$ 
and $\beta(x_k) = g_k\ast x_k$ for a suitable $g_k\in G_x$. After perhaps taking a subsequence we may assume 
without loss of generality that $g=g_k$ for all $k$. Hence
$$
\beta(x_k)=g\ast x_k.
$$
By construction $x_k\rightarrow \gamma(\varepsilon_0)\in U(x)$ and therefore $\beta(x_k)\rightarrow g\ast \gamma(\varepsilon_0)\in U(x)$.
This implies $\beta(\gamma(\varepsilon_0))\in U(x)$. Therefore $\varepsilon_0=1$ and $\beta(U(x))\subset U(x)$.  

Next we show that $\beta(U(x))$ is open and closed in $U(x)$ which implies since $U(x)$ is connected that $\beta(U(x))=U(x)$.
By assumption $\beta(U(x))$ is open. We only need to show its closedness.  Pick $y\in U(x)$ so that there exists a sequence 
$(x_k)\subset U(x)$ with $\beta(x_k)\rightarrow y$. After perhaps taking a subsequence we find $g\in G_x$ such that 
$\beta(x_k)=g\ast x_k\rightarrow y$. This implies $x_k\rightarrow g^{-1}\ast y$. Hence $\beta(g^{-1}\ast y)=y$.
This completes the proof of (1). 

Pick any $y\in U_1(x)$, i.e. a point on level $1$. Since $X$ is metrizable and the neighborhood of $y$ is modeled on an sc-smooth retract
we can pick a metric $d$ which induces the topology (on level $0$) on $X$, but also 
for  a strictly decreasing sequence $\varepsilon_k$
converging to $0$ the spaces  
$$
\Sigma_k=\{z\in X\ |\ d(y,z)\leq \varepsilon_k\}\subset U(x)
$$
with the induced metric are complete.  We define the closed subsets 
$$
\Sigma_k^g=\{z\in \Sigma_k\ |\ \beta(z)=g\ast x\}.
$$
Then $\Sigma_k =\bigcup_{g\in G_x} \Sigma_k^g$ and by the Baire theorem there exists $g_k$ such that 
$\Sigma_k^{g_k}$ has a nonempty interior.  Hence we find $y_k$ with $d(y,y_k)<\varepsilon_k$ so
that $\beta(z)=g_k\ast z$ for $z$ near $y_k$. We may assume by slightly shifting $y_k$ that it is a smooth point.
We infer that $T\beta(y_k)=T\varphi_{g_k}(y_k)$. 
After perhaps taking a subsequence we may assume that $g_k=g$ and passing to the limit we find that
$$
T\beta(y)(h) = T\varphi_g(y)(h)\ \ \text{for all}\ \ h\in T_yX.
$$
We note that for large $k$ there cannot be a $g_k'\neq g$ with $\Sigma_k^{g'}$ having nonempty interior,
because it would imply by the same argument as above that also
$$
T\beta(y) =T\varphi_{g'}(y)
$$
for some $g'\neq g$. This, however is impossible by the current assumption that $X$ is effective.

Next take a large $k$ so that $\Sigma^g_k$ is the only set with nonempty interior. If $y'\in \Sigma_k$
with $d(y',y)<\varepsilon_k$ we can study by the same method a small neighborhood of $y'$
which is contained in $\Sigma^g_k$. By this argument we find an open set arbitrarily close to $y'$
on which $\beta(z)=g\ast z$.  Summing up we find an open dense subset of $\Sigma^g_k$ on which
$\beta(z)=g\ast z$. By continuity this must hold for all $z\in \Sigma_k^g$.  Hence we have proved
that every point $y\in U_1(x)$ has an open neighborhood $U(y)\subset U(x)$ on level $0$
so that $\beta(z)=g_y\ast z$ for $z\in U(y)$. Since $U_1(x)$ is also connected it follows that there is a single 
$g\in G_x$ such that $\beta(z)=g\ast z$ for all $z\in U_1(x)$. Using density of $U_1(x)$ in $U(x)$ and the continuity
of $\beta$ on level $0$ we finally conclude that 
$$
\beta(y)=g\ast y\ \ \text{for all}\ \ y\in U(x).
$$
Next we remove the effectivity assumption.  We can pass to $X_R$ which has the same object M-polyfold and  apply the argument
just established. This immediately implies the result. 
\qed \end{proof}
We use the previous lemma to prove the following useful result.
\begin{proposition}\label{prop4.14}
If  $F,G:X\rightarrow Y$ are two equivalences satisfying  
$$\abs{F}=\abs{G}\colon \abs{X}\rightarrow \abs{Y},$$
 then the following holds.
\begin{itemize}
\item[{\em (1)}]\ There exists for every $x\in X$   an sc-smooth map $U(x)\rightarrow \bm{Y}:z\rightarrow \alpha_z$
such that  
$$
\alpha_z:F(z)\rightarrow G(z).
$$
Here $U(x)$ is a connected open neighborhood of $x$ admitting the natural $G_x$-action.
\item[{\em (2)}]\ The tangent functors  $TF, TG:TX\rightarrow TY$ satisfy $\abs{TF}=\abs{TG}$.
\end{itemize}
\end{proposition}
\begin{remark}\index{R- Remark concerning Proposition \ref{prop4.14}}
In (1) we cannot prescribe $\alpha_x$, as the following example shows.
Let $X={\mathbb R}^2$ with the group ${\mathbb Z}_2$ acting with the nontrivial element
via $(x,y)\rightarrow (-x,-y)$. Then take the associated translation groupoid. We let $F$ be the identity functor and $G(x,y)=-(x,y)$.
Then we have the identity morphism $F(0,0)\rightarrow G(0,0)$, which however does not lie in an sc-smooth local family.
\end{remark}


Before we start  with the proof of the theorem we first recall from 
Section \ref{section_Tangent_Ep-Groupoid} that the tangent $T(X, { \bf X})=(TX, T{\bm{X}})$ of an ep-gropuoid $(X, {\bm{X}})$ is an ep-groupoid. The object space $TX$ is a M-polyfold and the morphism space $T{\bm{X}}$ is also a M-polyfold. The tangent vector $(\phi, k)\in T_{\phi}{\bm{X}}$ is viewed as a morphism
$$(\phi, h)\colon Ts(\phi )(h)\to Tt(\phi )(h)$$
between the two objects 
$Ts(\phi )(h)\in T_xX$ and $Tt(\phi )(h)\in T_yX$ in $TX$, if $\phi\in {\bm{X}}$ is a morphism $\phi\colon x\to y$.

\begin{proof}[Proposition \ref{prop4.14}]
Since $\abs{F}=\abs{G}$, given $x\in X$ there exists a morphism $\psi\colon F(x)\to G(x)$ belonging to ${\bm{Y}}$.  Since, by assumption $F$ and $G$ are equivalencies 
there exist open neighborhoods 
${\bm{U}}(\psi)$, $U(F(x))$, $U(G(x))$, $U(x)$, and $U'(x)$ such  that
$F\colon U(x)\rightarrow U(F(x))$, $G\colon U'(x)\rightarrow U(G(x))$, $s\colon {\bm{U}}(\psi)\rightarrow U(F(x))$ and $t\colon {\bm{U}}(\psi)\rightarrow U(G(x))$ are all
sc-diffeomor\-phisms. Hence we have the sequence of sc-diffeomorphisms
\begin{eqnarray}\label{unwrap}
U(x)\xrightarrow{F} U(F(x))\xrightarrow{s^{-1}}{\bm{U}}(\psi)\xrightarrow{t}U(G(x))\xrightarrow{G^{-1}}U'(x),
\end{eqnarray}
whose composition defines the sc-diffeomorphism 
$$
\beta:(U(x),x)\rightarrow (U'(x),x).
$$
Unwrapping the contents of the sequence  (\ref{unwrap}) there exist an sc-smooth map $U(x)\rightarrow \bm{Y}:z\rightarrow \psi_z$
with $\psi_x=\psi$, satisfying
$$
\psi_z :F(z)\rightarrow G(\beta(z))\ \ \text{for all}\ \ z\in U(x).
$$
Since $|F(z)|=|G(z)|$ we find $\phi_z:F(z)\rightarrow G(z)$, where at this point we do not know the precise dependence of $\phi_z$ on $z$.
Note that 
$$
\psi_z\circ \phi_z^{-1}:G(z)\rightarrow G(\beta(z))\ \ \text{for all}\ \ z\in U'(x).
$$
Since $F$ is an equivalence there exists $\sigma_z:z\rightarrow \beta(z)$ with $G(\sigma_z)=\psi_z\circ \phi_z^{-1}$. 
Hence $\beta:U(x)\rightarrow U'(x)\subset X$, $\beta(x)=x$, and $|z|=|\beta(z)|$. From  Lemma \ref{very_go}
we deduce that $U'(x)=U(x)$, $\beta:U(x)\rightarrow U'(x)$ is an sc-diffeomorphism, and there exists $g\in G_x$ such that
$$
\beta(z)=g\ast z\ \ \text{for all}\ z\in U(x).
$$
Define $\gamma_z:=\Gamma(g,z):z\rightarrow g\ast z$.  Then we define the sc-smooth map
$$
U(x)\rightarrow \bm{Y}:z\rightarrow \alpha_z:= G(\gamma_z^{-1})\circ \psi_z
$$
and note that 
$$
\alpha_z: F(z)\rightarrow G(z)\ \ \text{for all}\ \ z\in U(x).
$$

Next we consider (2).  Assume that $x\in X_1$.  Differentiating the sc-smooth expression
$$
\alpha_z : F(z)\rightarrow G(z)
$$
at $z=x$ and writing $\alpha:=\alpha_x$ we find that 
$$
T\alpha(x)\circ TF(x) =TG(x) :T_xX\rightarrow T_{G(x)}Y.
$$
This precisely means that $|TF(x)|=|TG(x)|$ for all $x\in X_1$ and therefore $|TF|=|TG|$.
\qed \end{proof}






We finally remark that equivalences between ep-groupoids descend to equivalences  between associated reduced ep-groupoids introduced at the end of Section \ref{subsec-Effective_Reduced}.
\begin{proposition}\label{prop2.16}
We assume that  $F:X\rightarrow Y$ is an equivalence of ep-groupoids.
We denote by $X_R$ and $Y_R$ the associated reduced ep-groupoids and define the map $F_R:X_R\to Y_R$ on the objects by $F_R=F$ and on the morphisms by $F_R([\phi])=[F(\phi)]$. 
Then $F_R$ is a well-defined functor and  $F_R:X_R\rightarrow Y_R$  is an equivalence. 
\end{proposition}
\begin{proof}
Since $F$ is an equivalence between ep-groupoids,  it follows immediately that $F(T_x)=T_{F(x)}$ and consequently $F_R$ is a well-defined functor.
Since $F=F_R$ on the objects,  the map $F_R$ is a local sc-diffeomorphism between the  objects. This implies that 
$F_R$ is a fully faithful functor. It is immediate that $F_R$ is essentially surjective, and hence an equivalence of categories.
All these facts together imply that $F_R$ is an equivalence of ep-groupoids.
\qed \end{proof}
\begin{example}
The assumption in Proposition \ref{prop2.16} that the functor $F\colon X\to Y$ is an equivalence cannot be omitted. Indeed, 
given ep-groupoids $X$ and $Y$ and a sc-smooth functor $\Phi:X\rightarrow Y$ it is in general not true that it passes to the reduced ep-groupoids as the following example illustrates.
Let $X={\mathbb Z}_4\ltimes {\mathbb R}$. Here the action of ${\mathbb Z}_4=\{0,1,2,3\}$ is given $0\ast x=x$, $1\ast x=-x$, $2\ast x=x$ and $3\ast x=-x$.
Let $Y={\mathbb Z}_4\ltimes {\mathbb R}^2$ with the action of ${\mathbb Z}_4$ by counter clock-wise rotation by $90$ degrees. We define
$\Phi$ on objects by $\Phi(x)=(0,0)$ and on morphisms by 
$$
\Phi(i,x)= (i,(0,0)),
$$
where $i=0,1,2,3$. Note that $T_x =\{(0,x),(2,x)\}$ for all $x\in {\mathbb R}$. For $(x,y)\in {\mathbb R}^2$ we have that $T_{(x,y)}=\{(0,(x,y))\}$ and note that $Y=Y_R$.
If $\phi_0=(i,x)$ and $\phi_1=(j,y)$ in ${\bm{X}}$ are equivalent it means that $x=y$ and $i=j$ mod $2$. Now we observe that
$\Phi((1,x))=(1,(0,0))$ and $\Phi(3,x)=(3,(0,0))$. These are however different points in $Y_R=Y$. Hence $\Phi$ does not pass to equivalence classes and consequently does not define
a functor between the reduced groupoids.
\qed
\end{example}


\section{The Weak Fibered Product}


 We continue with a useful  construction called the weak fibered product.

\begin{definition}\index{D- Weak fibered product}
Let  $F:X\rightarrow Y$ and $G:Z\rightarrow Y$ be 
sc-smooth functors between ep-groupoids.  The {\bf  weak fibered product}  $L=X\times_Y Z$\index{$X\times_Y Z$} is the category  whose objects are triples 
$(x,\varphi,z)$ in which $x\in X$, $z\in Z$, and $\varphi:F(x)\rightarrow G(z)$ is a morphism in ${\bm{Y}}$, i.e.
$$
L= X{_{F}\times_s}{\bm{Y}}{_{t}\times_G}Z.
$$
The morphism set ${\bm{L}}$ consists  of all triples  $(h,\varphi,k)\in {\bm{X}}\times{\bm{Y}}\times{\bm{Z}}$
satisfying  $s\circ F(h)=s(\varphi)$ and $s\circ G(k) = t(\varphi)$, so that 
$$
{\bm{L}}={\bm{X}}{_{s\circ F}\times_s}{\bm{Y}}{_{t}\times_{s\circ G}}{\bm{Z}}.
$$
The identity morphism $1_{(x, \varphi, z)}\in {\bm{L}}$ at the object $(x, \varphi, z)\in L$ is given by $1_{(x, \varphi, z)}:=(1_x, \varphi, 1_z)$. The inversion map $i:{\bm{L}}\to {\bm{L}}$ is defined by 
$i(h, \psi, k):=(h^{-1}, G(k)\circ \varphi\circ F(h)^{-1}, k^{-1})$. 
The source and target maps $s,t:{\bm{L}}\rightarrow L$ are defined by
$$
s(h,\varphi,k)=(s(h),\varphi,s(k))\ \ \text{and}\ \ t(h,\varphi,k)=(t(h), G(k)\circ\varphi\circ F(h)^{-1},t(k)).
$$
Finally, the multiplication $m\colon {\bm{L}}{_{s}\times_t}{\bm{L}}\to {\bm{L}}$ is defined by
$$m((h, \varphi, k), (h', \varphi', k'))=(h\circ h', \varphi', k\circ k').$$
\qed
\end{definition}
Since  $L=(L, {\bm{L}})$ is a small category, the weak fibered product $X\times_Y Z$ is a groupoid.  
Theorem 2.9 in \cite{HWZ3.5} shows that the weak fibered product is an ep-groupoid, provided at least one of the functors $F$ or $G$
is an equivalence.  Below we present a slightly modified proof of this fact.
\begin{theorem}\label{modified_weak_fibered_product}
\index{T- Weak fibered product}
Let $F:X\to Y$ be an equivalence of ep-groupoids, and let $G:Z\to Y$ be a sc-smooth functor.  Then the weak fibered product $X\times_Y Z$ is in a natural way an ep-groupoid and the projection
$\pi_Z: X\times_Y Z\rightarrow Z$ is an equivalence of  ep-groupoids.   Moreover, the sc-smooth functors 
$$F\circ \pi_X, G\circ  \pi_Z\colon X\times_Y Z\to Y$$
 are naturally equivalent and the degeneracy index $d_{X\times_Y Z}$ satisfies
$$
d_{X\times_Y Z}(x,\varphi,z)=d_Z(z),\quad \text{for every $(x,\varphi, z)\in X\times_Y Z$}.
$$
Moreover,  if $Z$ is a tame ep-groupoid so is the weak fibered product $ X\times_Y Z$. Further, if $Z$ has a paracompact orbit space, so has $X\times_Y Z$.
\qed
\end{theorem}


If $\pi_Z\colon X\times_YZ\to Z$ is an equivalence between ep-groupoids, then it is, by definition, a local sc-diffeomorphism between the object sets. Consequently, if one ep-groupoid is tame, so is the other, because tameness is invariant under sc-diffeomorphisms. Moreover, again by definition of an equivalence, the induced map $\abs{\pi_Z}\colon \abs{X\times_YZ}\to \abs{Z}$ is a homeomorphism between the orbit spaces. Consequently, if $\abs{Z}$ is paracompact, then also $\abs{X\times_YZ}$ is paracompact. Therefore, the last two statements of the theorem follow once we have shown that $\pi_Z$ is an equivalence.

If  we assume that $G:Z\to Y$ is an equivalence instead of $F:X\to Y$, then 
the fibered product $X\times_Y Z$ is again naturally an ep-groupoid and this time the projection 
$\pi_X:X\times _Y Z\rightarrow X$ is an equivalence of ep-groupoids. In this case,  the degeneracy index $d_{X\times_Y Z}$ satisfies 
$$d_{X\times_Y Z}(x,\varphi,z)=d_X(x),\quad \text{for every $(x,\varphi, z)\in X\times_Y Z$}.$$
If both $F:X\to Y$ and $G:Z\to Y$ are equivalences of ep-groupoids, then 
$$
d_X(x)=d_{X\times_Y Z}(x,\phi,z)=d_Z(z),\quad \text{for every $(x,\varphi, z)\in X\times_Y Z$}.
$$
The M-polyfold structures on $L$ and ${\bm{L}}$ in both cases are the natural ones induced
on $L\subset X\times{\bm{Y}}\times Z$ and ${\bm{L}}\subset {\bm{X}}\times{\bm{Y}}\times {\bm{Z}}$ as sub-M-polyfolds.

\begin{proof}[Proof of Theorem \ref{modified_weak_fibered_product}]
Clearly $ X\times{\bm{Y}}\times Z$ and ${\bm{X}}\times {\bm{Y}}\times {\bm{Z}}$  are  M-polyfolds.   We first show that $L$ is a  sub-M-polyfold.  


Let  $(x,\varphi,z)\in L$.  Since $F:X\to Y$ is an equivalence and hence locally a sc-diffeomorphism, we find open neighborhoods $U=U(x)$ of $x$ in $X$ and $W=W(F(x))$ of $F(x)$ in $Y$, so that 
$$F\vert U:U\to W$$
is a sc-diffeomorphism. 
The source and the target maps $s, t:{\bm{Y}}\to Y$ are also local sc-diffeomorphisms.  Hence, replacing $U$ and $W$ by smaller neighborhoods if necessary,  we find open neighborhoods
 $W'=W'(G(z))$ of $G(z)$ in $Z$ and  ${\bm{U}}={\bm{U}}(\varphi)$ of $\varphi$  in ${\bm{Y}}$, such that the source and target maps 
$$
s\colon {\bm{U}}\to W\quad \text{and}\quad t\colon {\bm{U}}\to W'
$$
are sc-diffeomorphisms.  Moreover, since $G$ is sc-smooth and hence $\ssc^0$,  we find an open neighborhood $V=V(z)$ of $z$ in $Z$, so that 
$$G(V)\subset W'.$$
With these choices we define  the map 
$$
R:U\times {\bm{U}}\times V\to U\times {\bm{U}}\times V
$$ 
by 
\begin{equation}\label{retraction_weak_fibered_product_1}
R(x', \varphi', z')=\bigl( (F\vert U)^{-1}\circ  s\circ (t\vert {\bm{U}})^{-1}\circ G (z'), (t\vert {\bm{U}})^{-1}\circ G (z'), z').
\end{equation}
 Clearly $R$  is sc-smooth and $R\circ R=R$, so that $R$ is a sc-retraction.  The image of $R$ is equal to 
$$R(U\times {\bm{U}}\times V)=(U\times {\bm{U}}\times V)\cap L,$$
which implies that $L$ is a sub-M-polyfold of $X\times {\bm{Y}}\times Z$ and consequently inherits 
a M-polyfold structure. If $(V, \psi, (O, C, E))$ is a chart around $z$ on $Z$,  then 
the map $\Psi: (U\times {\bm{U}}\times V)\cap L\to O$,  defined by $\Psi ( x', \varphi', z')=\psi (z')$ defines a chart on $L$ around the point $(x, \varphi, z)$.
 We also observe that the projection map $\pi_Z:L\to Z$, defined by $\pi_Z(x, \varphi, z)=z$,  is in our charts the identity map. Consequently, $\pi_Z:L\to Z$ is a local sc-diffeomorphism. If $z\in Z$, then since $F$ is an equivalence, there exists an object $x\in X$ and a morphism $\varphi\in {\bm{Y}}$ between $F(x)$ and $G(z)$. Hence $(x, \varphi, z)\in L$ and $\pi_Z(x, \varphi, z)=z$, so that $\pi_Z$ is a surjection.  
 


\noindent Next we shall show that ${\bm{L}}$ is also  M-polyfold.  We take a morphism  $(h, \phi, k)\in {\bm{L}}$. Since $F:X\to Y$ and $s:{\bm{X}}\to X$ are local sc-diffeomorphisms,  we find open neighborhoods ${\bm{U}}={\bm{U}}(h)$ of $h$ in ${\bm{X}}$ and $U=U(F(s(h)))$ of $F(s(h))$ in $Y$ such that 
$$F\circ s:{\bm{U}}\to U$$ 
is a sc-diffeomorphism.  Taking these neighborhoods smaller if necessary, we find, since $s, t:{\bm{Y}}\to Y$ are local sc-diffeomorphisms,  open neighborhoods ${\bm{V}}={\bm{V}}(\phi)$ of $\phi$ in ${\bm{Y}}$ and $V=V(G(s(k)))$ of $G(s(k))$ in $Y$, so that 
the maps 
$$s:{\bm{V}}\to U\quad \text{and}\quad t:{\bm{V}}\to  V$$
are sc-diffeomorphism. Finally, we choose an open neighborhood ${\bm{W}}={\bm{W}}(k)$ of $k$ in ${\bm{Z}}$ such that $(s\circ G)({\bm{W}})\subset {\bm{V}}$.  With these choices of open sets we define the 
map 
$${\bm{R}}\colon {\bm{U}}\times {\bm{V}}\times {\bm{W}}\to  {\bm{U}}\times {\bm{V}}\times {\bm{W}}$$ by 
$$
{\bm{R}}(h',\phi',k')=\bigl(   ((F\circ s)\vert {\bm{U}})^{-1}\circ s \circ (t\vert {\bm{V}})^{-1} \circ (s\circ G) (  k'),  (t\vert {\bm{V}})^{-1} \circ (s\circ G) (  k'), k'\bigr).
$$
Then ${\bm{R}}\circ {\bm{R}}={\bm{R}}$,  the map ${\bm{R}}$ is sc-smooth and has the image ${\bm{R}}( {\bm{U}}\times {\bm{V}}\times {\bm{W}})=( {\bm{U}}\times {\bm{V}}\times {\bm{W}})\cap {\bm{L}}$. Consequently, ${\bm{L}}$ is a sub-M-polyfold of the M-polyfold ${\bm{X}}\times {\bm{Y}}\times {\bm{Z}}$. Similarly as in the $L$-case, one defines charts on ${\bm{L}}$.  Moreover, the projection ${\bf \pi}_{\bm{Z}}:{\bm{L}}\to {\bm{Z}}$, defined by ${\bf \pi}_{\bm{Z}}(h, \varphi, k)=k$, is a local sc-diffeomorphism. 

Next we shall show that the structure maps are sc-smooth. We start with the source map $s:{\bm{L}}\to L$. Recall that 
$s(h, \varphi, k)=(s(h), \varphi, s(k))$ for every $(h, \varphi, k)\in {\bm{L}}$.  Locally, the source map $s$ is a composition of local sc-diffeomorphisms,  
$$s (h, \varphi, k)=\pi_Z^{-1}\circ s_Z\circ {\bf \pi}_{\bm{Z}}(h, \varphi, k),$$
and hence $s$ is a local sc-diffeomorphism. 
In our charts  on ${\bm{L}}$, the inversion map $i:{\bm{L}}\to {\bm{L}}$, given by $(h, \varphi, k)\mapsto (h, \varphi, k)^{-1}= (h^{-1},  G(k)\circ \varphi\circ F(h)^{-1} , k^{-1})$, takes the form $q\mapsto \psi'\circ i_Z\circ \psi^{-1}(q)$ where $\psi$ and $\psi'$ are suitable charts of $Z$. Since the inversion map $i_Z:{\bm{Z}}\to {\bm{Z}}$ is a local sc-diffeomorphism, the same holds for $i$. 

Now observe that the target map $t:{\bm{L}}\to {L}$ is equal to $t=i\circ s$ and so, $t$ is a local sc-diffeomorphism. 
The $1$-map $1:L\to {\bm{L}}$ is defined  by $1(x, \varphi, z)=(1_x, \varphi, 1_z)$ and,  in our charts on $L$ and ${\bm{L}}$,  is given by $q\mapsto  \psi' \circ 1_Z \circ \psi^{-1}(q)$ where $\psi$ and $\psi'$ are suitable charts on $Z$. Since the $1$-map $1_Z:Z\to {\bm{Z}}$ is sc-smooth, the same holds for $1_L:L\to {\bm{L}}$. Finally, we consider the multiplication map 
$m\colon {\bm{L}}{_{s}\times_t}{\bm{L}}\rightarrow {\bm{L}}$. We know that the fibered product 
$ {\bm{L}}{_{s}\times_t}{\bm{L}}$ is a  M-polyfold.  In local coordinates, the multiplication map $m$ takes the form 
$q\mapsto   \psi'\circ  m_Z(s^{-1}\circ t\cdot, \cdot )\circ  \psi^{-1}(q)$ for suitable charts $\psi$ and $\psi'$ on $Z$. This shows that the multiplication map $m$ is sc-smooth as claimed.



Next we will show that $L$ is proper. We take $(x, \varphi, z)\in L$ and choose neighborhoods $U=U(x)$ of $x$ in $X$ and $V=V(z)$ of $z$ in $Z$ 
such that the maps
$$t\colon s^{-1}\bigl(\ov{U}\bigr) \to X\quad \text{and}\quad t\colon s^{-1}\bigl(\ov{V}\bigr) \to Z$$
are proper.  We define the open neighborhood $W(x, \varphi, z)$ of $(x, \varphi, z)$ in $L$ by 
$$W(x, \varphi, z) =\{(x', \varphi', z')\in L\vert \, \text{$x'\in U,\, z'\in V, \,$  and $\varphi': F(x')\to G(z')$}\}$$
and claim that the restriction of the target map 
$$t:s^{-1}(\ov{W(x, \varphi, z)})\to L$$
is proper. To see this,  let $K$ be a compact subset of $\textrm{L}$ and let $((h_n, \psi_n, k_n))_{n\in \N}$ be a sequence of morphisms belonging to $ s^{-1}(\ov{W(x, \varphi, z')}$ so that $t(h_n, \psi_n, k_n)\in K$.  Since $K$ is compact, after taking a subsequence, the sequence  $t(h_n, \psi_n, k_n)$ converges in $\textrm{L}$ to the  morphism $(x', \psi', z')$. From 
$t(h_n, \psi_n, k_n)=(t(h_n), G(k_n)\circ \psi_n \circ F(h_n)^{-1}, t(k_n))$, it follows that $t(h_n)\to x'$, $t(k_n)\to z'$,  and $G(k_n)\circ \psi_n \circ F(h_n)^{-1}\to \psi'$.  Since 
$(h_n, \psi_n, k_n)\in s^{-1}(\ov{W(x, \varphi, z')})$, we conclude that $s(h_n)\in \ov{U}$ and $s(k_n)\in \ov{V}$. Then  the properness of the maps $t\colon s^{-1}\bigl(\ov{U}\bigr) \to X$ and $t\colon s^{-1}\bigl(\ov{V}\bigr) \to Z$ imply, after taking subsequences, the convergence  $h_n\to h$ in  $s^{-1}\bigl(\ov{U}\bigr)$. Hence 
the sequence of morphisms $(\psi_n)$ converges in ${\bm{Y}}$ to the morphism $G(k)^{-1}\circ \psi'\circ F(h)$.  Since $\psi_n$ is a morphism between $F(s(h_n))$ and $G(s(k_n))$, it follows that 
$\psi'$ is a morphism between $F(s(h))$ and $G(s(k))$. We have proved that the sequence $(h_n, \psi_n, k_n)$ has a subsequence converging to $(h, \psi, k)\in s^{-1}(\ov{W(x, \varphi, z')})$, and the proof of properness of $\textrm{L}$ is complete.



We already know that $\pi_Z$ is  surjective and a local sc-diffeomorphism, hence to show that $\pi_Z$ is an equivalence it suffices to show that for every two  objects
 $(x, \varphi, z)$, $ (x', \varphi', z')$ in $L$ the induced map 
$$\textrm{mor}_{L}((x, \varphi, z), (x', \varphi', z'))\to \textrm{mor}_{Z}(z, z')$$
is a bijection.  Take a morphism $k:z\to z'$. Then $\varphi'\circ G(k)\circ \varphi^{-1}$ is a morphism between $F(x)$ and $F(x')$.
Since $F:X\to Y$ is an equivalence and hence faithful and full, there exists a unique morphism $h$ in ${\bm{X}}$ between $x$ and $x'$ so that $F(h)=\varphi'\circ G(k)\circ \varphi^{-1}.$
Then $(h, \varphi, k)\in \textrm{mor}_{L}((x, \varphi, z), (x', \varphi', z'))$ and  $\pi_Z( (h, \varphi, k))=k$. Hence $\pi_Z$ is faithful and full, as claimed. The map $\pi_Z$ is also an essentially surjective. Indeed, let  $z\in Z$. Then since $F:X\to Y$ is an equivalence and hence, in particular, $\abs{F}:\abs{X}\to \abs{Y}$ is a bijection, there exists $x\in X$ and an isomorphism $\varphi\in {\bm{Y}}$ between  $F(x)$ and $G(z)$. Then $(x, \varphi, z)\in L$ and there exists a morphism between $\pi_Z(x, \varphi, z)=z$  and $z$, namely $1_z\in {\bm{Z}}$. Therefore $\pi_Z$ is an equivalence in the sense of category theory and hence $\abs{\pi_Z}:\abs{ X\times_Y Z}\to \abs{Z}$ is a bijection. Consequently, by Lemma \ref{equivalence_in_the sense_of_category_theory}, $\pi_Z$ is an equivalence in the sense of Definition \ref{equiv}. 

To see that the functors $F\circ \pi_X$ and $G\circ \pi_Z:X\times_YZ\to Y$ are naturally equivalent we define the map 
$\sigma\colon X\times_YZ\to {\bm{Y}}$ by 
$$\sigma (x, \varphi, z)=\varphi.$$
By definition of the triple $ (x, \varphi, z)\in X\times_YZ$, the morphism  $\varphi$ is a morphism between $F(x)$ and $G(z)$, hence between $F\circ \pi_X(x, \varphi, z)$ and $G\circ \pi_Z(x, \varphi, z).$  In order to  to show that $\sigma:F\circ \pi_X\to G\circ \pi_Z$ is a natural transformation we let $(x, \varphi, z)$ and $(x', \varphi', z')$ be two  triples in $X\times_YZ$ and $(h, \psi, k)$ a morphism between $ (x, \varphi, z)$ and $(x', \varphi', z')$. Then $h:x\to x'$, $k:z\to z'$, $\psi=\varphi$, and $\varphi'=G(k)\circ \varphi\circ F(h)^{-1}$. Consequently, 
\begin{equation*}
\begin{split}
 \sigma (x', \varphi', z') \circ (F\circ \pi_X)(h, \psi, k)&=\varphi'\circ F(h)\\
 &=G(k)\circ \varphi =(G\circ \pi_Z)(h, \psi, k)\circ  \sigma (x, \varphi, z).
 \end{split}
 \end{equation*}
It remains to verify that $\sigma: X\times_YZ\to {\bm{Y}}$ is sc-smooth. This follows from the fact that $\pi_Z:X\times_YZ\to Z$  is a local sc-diffeomorphism and hence we take it as a chart around $(x, \varphi, z)$. In this chart the composition $\sigma\circ \pi_{Z}^{-1}$ is equal to $(t\vert{\bm{U}})^{-1}\circ G$ where ${\bm{U}}$ is a suitable neighborhood of the  morphism $\varphi$. Since the maps $t$ and $G$ are sc-smooth, it follows that $\sigma$ is also sc-smooth. Hence we have proved the natural equivalence  $F\circ \pi_X\simeq G\circ \pi_Z$.
Finally, $\pi_Z\colon X\times_Y Z\to Z$ is a local sc-diffeomorphism and therefore,  
$$d_{X\times_Y Z}(x,\varphi,z)=d_Z(\pi_Z(x,\varphi, z))=d_Z(z)$$
for every $(x,\varphi, z)\in X\times_Y Z$. The proof of Theorem \ref{modified_weak_fibered_product} is complete.
\qed \end{proof}
\begin{remark}
Consider three ep-groupoids $A$, $B$, and $X$ and assume that $F:A\rightarrow X$ and $H:B\rightarrow X$ are  equivalences of ep-groupoids.
Then the weak fibered product $A\times_X B$  associated to the diagram $A\xrightarrow{F} X\xleftarrow{H} B$ is an ep-groupoid
and the projections $\pi_A: A\times_X B\rightarrow A$ and $\pi_B:A\times_X B\rightarrow B$ are equivalences of ep-groupoids in view of the previous discussion.  
By construction $F\circ \pi_A : A\times_X B\rightarrow X$ and $H\circ \pi_B: A\times_X B\rightarrow X$ are naturally equivalent
by $\tau:A\times_X B\rightarrow \bm{X}$ defined by
$$
\tau(a,\phi,b)=\phi.
$$
Given an equivalence $F:A\rightarrow X$ we may think of $A$ as a smaller model for $X$. The previous discussion can be understood
as saying that given smaller models for $X$, say $A$ and $B$, then there exists a model for $X$ which is smaller than $A$ and smaller than $B$.
\qed
\end{remark}
\section{Localization at the System of Equivalences}\label{section2.3_localization}
The category of  ep-groupoids ${\mathcal{EP}}$     \index{${\mathcal{EP}}$} has as  objects the ep-groupoids and as morphisms the  sc-smooth functors between ep-groupoids. They contain the distinguished class of morphisms ${\bf E}$\index{${\bf E}$},  called equivalences introduced in Definition \ref{equiv}.   Let us mention the following examples of equivalences. 
\begin{itemize}
\item[(E1)]\ \ \ Every isomorphism in the category ${\mathcal E}{\mathcal P}$ between two ep-groupoids is an equivalence.
\item[(E2)]\ \ \ If $F:X\rightarrow Y$ and $G:Y\rightarrow Z$ are equivalences, then $G\circ F$ is an equivalence. 
\item[(E3)]\ \ \ A functor which is naturally equivalent to an equivalence is an equivalence by Proposition 2.6.
\end{itemize}
We are going to construct a  new category
${\mathcal{EP}}({\bf E}^{-1})$\index{${\mathcal{EP}}({\bf E}^{-1})$} having  the same objects as ${\mathcal {EP}}$ for which there exists a functor
$$
i:{\mathcal{EP}}\rightarrow {\mathcal{EP}}({\bf E}^{-1})
$$
which is the identity on objects, but maps on morphisms every equivalence to an isomorphism. Moreover, this new category has some universal property.
The procedure is standard in category theory and called localization. In our case it has a quite explicit form.

From Theorem 
\ref{modified_weak_fibered_product} we recall that given an equivalence $F:X\rightarrow Y$ and a sc-smooth functor $\Phi:Z\rightarrow Y$ we can build the weak fibered product $X\times_Y Z$, which is an ep-groupoid. Moreover,  the projection $\pi_Z:X\times_Y Z\rightarrow Z$ is an equivalence  of ep-groupoids and the projection $\pi_X:X\times_Y Z\rightarrow X$ is a sc-smooth functor so that the sc-functors 
$\Phi\circ \pi_Z$ and $F\circ \pi_X$
are naturally equivalent via the natural equivalence $\tau\colon X\times_Y Z\rightarrow {\bm{Y}}$ defined by $\tau(x,\phi,z)=\phi$,
$$
F\circ\pi_X\xrightarrow{\tau} \Phi\circ\pi_Z.
$$
Next, given two ep-groupoids $X$ and $Y$, we  consider  {\bf diagrams} of the form
$$
 d\colon X\xleftarrow{F}Z\xrightarrow{\Phi} Y
 $$
\index{$d\colon X\xleftarrow{F}Z\xrightarrow{\Phi} Y$}
in which  $F\colon Z\to X$  is an equivalence and $\Phi\colon Z\to Y$ is a sc-smooth functor. 
\begin{definition}[{\bf Refinement}]
The diagram $d':X\xleftarrow{F'}Z'\xrightarrow{\Phi'} Y$ is called 
a {\bf refinement of the diagram}\index{D- Refinement of $d$} $d:X\xleftarrow{F}Z\xrightarrow{\Phi} Y$ if there exists an equivalence 
$$
H\colon Z'\rightarrow Z 
$$
of ep-groupoids such that  $F\circ H$ and $F'$ are naturally equivalent and $\Phi\circ H$ and $\Phi'$ are naturally equivalent.
\qed
\end{definition}

The situation, illustrated in the diagram
\begin{equation*}
\begin{CD}
d:X@<F<<Z@>\Phi>>Y\\
@. @AAHA @. \\
d':X@<F'<<Z'@>\Phi'>>Y,\\ 
\end{CD}
\end{equation*}
is sometimes abbreviated by
$$H:d'\rightarrow d.$$
For example, if 
$d: X\xleftarrow{F}Z\xrightarrow{\Phi} Y$ is a diagram and $H:Z'\rightarrow Z$ an equivalence, then 
$$d': X\xleftarrow{F\circ H}Z'\xrightarrow{\Phi\circ H} Y$$
is a refinement of  $d$. Another refinement of $d$ is the diagram 
$d':X\xleftarrow{G} Z\xrightarrow{\Psi} Y$
where $G\colon Z\rightarrow X$ is naturally equivalent to $F$ and $\Psi\colon Z\rightarrow Y$ is naturally equivalent to $\Phi$.  
The equivalence $H\colon Z\to Z$ is in this case $H=Id_Z$.
\begin{lemma}\index{L- Refinements of $d$}
Consider diagrams $d:X\xleftarrow{F}Z\xrightarrow{\Phi} Y$, $d':X\xleftarrow{F'}Z'\xrightarrow{\Phi'} Y$, and $d'':X\xleftarrow{F''}Z''\xrightarrow{\Phi''} Y$.  If $d'$ is a refinement of $d$ and $d''$ is a refinement of $d'$, then $d''$ is a refinement of $d$.
\end{lemma}
\begin{proof}
The verification  of the lemma is straightforward. Indeed,  we have the following diagram
\begin{equation*}
\begin{CD}
X@<F<<Z@>\Phi>>Y\\
@. @AAHA @. \\
X@<F'<<Z'@>\Phi'>>Y\\ 
@. @AAH'A @. \\
X@<F''<<Z@>\Phi''>>Y\\ \\
\end{CD}
\end{equation*}
in which  $F\circ H\simeq F'$, $F'\circ H'\simeq F''$ and $\Phi\circ H\simeq \Phi'$, $\Phi'\circ H'\simeq \Phi''$. 
Therefore,   $F\circ (H\circ H')\simeq F''$  and  $\Phi\circ (H\circ H')\simeq \Phi''$.
\qed \end{proof}
\begin{definition}[{\bf Common refinement}]\index{D- Common refinement}
Given two diagrams 
$$
d:X\xleftarrow{F} Z\xrightarrow{\Phi} Y\quad \text{and}\quad d':X\xleftarrow{F'} Z'\xrightarrow{\Phi'} Y,
$$
then a third diagram $d'':X\xleftarrow{F} Z''\xrightarrow{\Phi} Y$ is called  a {\bf common refinement} \index{Common refinement} of $(d, d')$, if $d''$ is a refinement of 
$d$ and a refinement of $d'$.
\qed
\end{definition}

Having a common refinement defines an equivalence relation on diagrams. This is a consequence of the following lemma.
\begin{lemma}\label{lemma_three}\index{L- Common refinements}
Consider the three diagrams 
$$d\colon X\xleftarrow{F}Z\xrightarrow{\Phi} Y,\quad d'\colon X\xleftarrow{F'}Z'\xrightarrow{\Phi'} Y\quad \text{and}\quad  d''\colon X\xleftarrow{F''}Z''\xrightarrow{\Phi''} Y.$$
 If $(d, d')$ has  a common refinement and  $(d', d'')$ has  a common refinement, then $(d, d'')$ has a common refinement.
\end{lemma}
\begin{proof}
Let $X\xleftarrow{G}W\xrightarrow{\Psi} Y $ be common refinement of $(d, d')$ so that we have the diagrams
\begin{equation*}
\begin{CD}
d:X@<F<<Z@>\Phi>>Y\\
@. @AAHA @. \\
\phantom{d:}X@<G<<W@>\Psi>>Y\\ \\
\end{CD}
\quad \text{and}\quad 
\begin{CD}
d':X@<F'<<Z'@>\Phi'>>Y\\
@. @AAH'A @. \\
\phantom{d':}X@<G<<W@>\Psi>>Y\\ \\
\end{CD}
\end{equation*}
in which $F\circ H\simeq G$,  $\Phi\circ H\simeq \Psi$ and $F'\circ H'\simeq G$,  $\Phi'\circ H'\simeq \Psi$. Similarly, let 
$X\xleftarrow{G'}W'\xrightarrow{\Psi} Y $ be  a common refinement of $(d', d'')$ illustrated by  the diagrams
\begin{equation*}
\begin{CD}
d':X@<F'<<Z'@>\Phi'>>Y\\
@. @AAKA @. \\
\phantom{d':}X@<G'<<W'@>\Psi'>>Y\\ \\
\end{CD}
\quad \text{and}\quad 
\begin{CD}
d'':X@<F''<<Z''@>\Phi''>>Y\\
@. @AAK'A @. \\
\phantom{d'':}X@<G'<<W'@>\Psi'>>Y\\ \\
\end{CD}
\end{equation*}
in which $F'\circ K\simeq G'$,  $\Phi'\circ K\simeq \Psi'$ and $F''\circ K'\simeq G'$,  $\Phi''\circ K'\simeq \Psi'$. 
Since $H':W\to Z'$ and $K:W'\to Z'$ are equivalences, we consider the weak  fibered  product $W''=W\times_{Z'}W'$. Then $G\circ \pi_W:W\times_{Z'}W'\to X$ is an equivalence and we claim that the digram
$$X\xleftarrow{G\circ \pi_W}W\times_{Z'}W'\xrightarrow{\Psi'\circ \pi_{W'}} Y $$
is a common refinement of the diagrams $d$ and $d''$.  Indeed,  $H\circ \pi_W:W\times_{Z'}W'\to Z$ is an equivalence as a composition of equivalences and 
\begin{equation*}
F\circ (H\circ \pi_W)=(F\circ H)\circ \pi_W\simeq G\circ \pi_W
\end{equation*}
and, using $\Phi'\circ H'\simeq \Phi$ and $H'\circ \pi_W\simeq K\circ \pi_{W'}$, 
\begin{equation*}
\begin{split}
\Phi\circ (H\circ \pi_W)&=(\Phi\circ H)\circ \pi_W\simeq\Psi\circ \pi_W\simeq (\Phi'\circ H')\circ \pi_W=\Phi'\circ (H'\circ \pi_W)\\
&\simeq\Phi'\circ (K\circ \pi_{W'})=(\Phi'\circ K)\circ \pi_{W'}\simeq \Psi'\circ \pi_{W'},
\end{split}
\end{equation*}
proving our claim. 


Similarly, one shows that $X\xleftarrow{G\circ \pi_W}W\times_{Z'}W'\xrightarrow{\Psi'\circ \pi_{W'}} Y $ is refinement of $d''$ with an equivalence $K'\circ \pi_{W'}:W\times_{Z'}W'\to Z''$.
This completes the proof of Lemma \ref{lemma_three}.
\qed \end{proof}
\begin{definition}[{\bf Equivalence of diagrams}]\index{D- Common refinements as equivalence relation}
Two diagrams 
$$
d\colon X\xleftarrow{F}Z\xrightarrow{\Phi}Y\quad \text{and}\quad d'\colon X\xleftarrow{F'}Z'\xrightarrow{\Phi'}Y
$$
are called {\bf equivalent}\index{equivalence of diagrams}  if they have a {\bf common refinement}.
\qed
\end{definition}

This defines an equivalence relation on diagrams. We denote the {\bf equivalence class}  of $d$ by $[d]$ or by $[ X\xleftarrow{F}Z\xrightarrow{\Phi}Y]$ 
\index{$[ X\xleftarrow{F}Z\xrightarrow{\Phi}Y]$} and are going to  interpret $[d]$  as a morphism
$$
[d]\colon X\rightarrow Y
$$
between the ep-groupoids.\index{$[d]\colon X\rightarrow Y$}




We shall show shortly that such equivalence classes $[d]$  can be composed and the ep-groupoids with these type of morphisms define
a new category (denoted by ${\mathcal E}{\mathcal P}({\bf E}^{-1})$) \index{${\mathcal E}{\mathcal P}({\bf E}^{-1})$} 
possessing  useful properties.

Since the equivalence $F\colon Z\to X$ induces a homeomorphism $\abs{F}\colon \abs{Z}\to \abs{X}$ between the orbit spaces, we can associate with the diagram $d\colon X\xleftarrow{F}Z\xrightarrow{\Phi}Y$,  the map 
$\abs{d}\colon \abs{X}\rightarrow \abs{Y}$  between the orbit spaces, defined by 
$$\abs{d}:=\abs{\Phi}\circ \abs{F}^{-1}.$$
The  map $\abs{d}$ is continuous between all levels of the orbit spaces.  Let   $d'\colon X\xleftarrow{F'}Z'\xrightarrow{\Phi'}Y$  be   a refinement  of  the  digram  $d\colon X\xleftarrow{F}Z\xrightarrow{\Phi}Y$,  illustrated by the  diagram  
\begin{equation*}
\begin{CD}
X@<F<<Z@>\Phi>>Y\\
@. @AAHA @. \\
X@<F'<<Z'@>\Phi'>>Y. \\
\end{CD}
\end{equation*}
Then 
$$
\abs{F}\circ \abs{H} =\abs{F'}\quad \text{and}\quad \abs{\Phi}\circ\abs{H}=\abs{\Phi'},
$$
and therefore, since $\abs{F}$, $\abs{F'}$, and $\abs{H}$ are homeomorphisms, 
$$
\abs{d'}= \abs{\Phi'}\circ \abs{F'}^{-1}= \abs{\Phi}\circ \abs{H}\circ \abs{H}^{-1}\circ \abs{F}^{-1}= \abs{\Phi}\circ \abs{F}^{-1} =\abs{d}.
$$
Hence we have proved the following lemma.
\begin{lemma}\index{L- Induced map by a diagram}
If $H\colon d'\rightarrow d$ is a refinement of diagrams, where $d,d'\colon X\rightarrow Y$, then  the induced maps $|d|,|d'|\colon |X|\rightarrow |Y|$ between the orbit spaces are the same, i.e.,  $|d|=|d'|$.
\qed
\end{lemma}
This implies that we have a well-defined map
associated with  an equivalence class of diagrams $[d]:X\rightarrow Y$,  namely the map
$$
\abs{[d]}:\abs{X}\to \abs{Y}, 
$$
defined by 
$$
|[d]|:= |\Phi|\circ |F|^{-1},
$$
 where we have chosen  any representative $d:X\xleftarrow{F}Z\xrightarrow{\Phi} Y$ of the equivalence class $[d]$.
  We note that if in the equivalence class $[d]=[X\xleftarrow{F}Z\xrightarrow{\Phi} Y]$ both functors $F$ and $\Phi$ are equivalences, then the induced map $\abs{[d]}\colon \abs{X}\to \abs{Y}$ is a homeomorphism between the orbit spaces.
 
\begin{definition}\index{D- Induced map}
Given an equivalence class $[d]$ of diagrams $d\colon X\rightarrow Y$,  the {\bf induced map  between the orbit spaces}
is denoted by 
$$\abs{[d]}\colon \abs{X}\rightarrow \abs{Y}.$$
\qed
\end{definition}
Next we shall show  for two equivalence classes  $[d]:X\rightarrow Y$ and $[d']:Y\rightarrow Z$ that there is a well-defined associative 
composition $[d']\circ [d]$ defining an equivalence class $[d'']$ of diagrams $d''\colon X\rightarrow Z$. 

\begin{theorem}[{\bf Composition of equivalence classes}]\label{proppp}\index{T- Composition for $[d]$}
Let 
$$
d\colon X\xleftarrow{F} A\xrightarrow{\Phi}Y\quad \text{and}\quad d'\colon Y\xleftarrow{G} B\xrightarrow{\Psi} Z
$$
be representatives  of the equivalence classes $[d]\colon X\rightarrow Y$ and $[d']\colon Y\rightarrow Z$, respectively.  Then the equivalence class $[d'']$ of the diagram 
$$
d''\colon X\xleftarrow{F\circ\pi_A} A\times_Y B\xrightarrow{\Psi\circ\pi_B} Z
$$
is independent of the choices of representatives in the equivalence classes $[d]$ and $[d']$. The equivalence class $[d'']:X\to Z$ is called the {\bf composition}
of $[d]$ and $[d']$ and is denoted by 
$$[d'']=[d']\circ [d].$$
Moreover, the composition is associative; if $[d]:X\rightarrow Y$, $[d']:Y\rightarrow Z$,  and $[d'']:Z\rightarrow W$, then 
$$
([d'']\circ [d'])\circ [d]=[d'']\circ ([d']\circ [d]).
$$
In addition, 
$$
[d]\circ [1_X]=[d]\quad \text{and}\quad  [1_Y]\circ [d]=[d]
$$
for every equivalence class $[d]:X\rightarrow Y$.  Here $[1_X]$ is  the equivalence class 
$$[1_X]=[X\xleftarrow{1_X} X\xrightarrow{1_X}X].$$
\qed
\end{theorem}
The somewhat lengthy technical proof is postponed to  Appendix \ref{x-proppp}.



\begin{definition}[{\bf Generalized maps, generalized isomorphisms}]   \index{D- Generalized map}\index{D- Generalized isomorphism}
Let $X$ and $Y$ be two ep-groupoids.
An equivalence class $[a]=[X \xleftarrow{F}A\xrightarrow{G}Y]$ of diagrams in which $F$ is an equivalence and $G$ is a sc-smooth functor is called a {\bf generalized map}, and abbreviated by 
$$[a]\colon X\to Y$$
if the representation is irrelevant.
A generalized map $[a]\colon X\to Y$ is called a 
{\bf generalized isomorphism} or {\bf invertible}, if there exists a generalized map $[b]\colon Y\to X$ satisfying 
$$[b]\circ [a]=[1_X]\quad \text{and}\quad [a]\circ [b]=[1_Y].$$
In this case the equivalence class $[b]$ is called the {\bf inverse} of $[a]$ and denoted by 
$$[b]=[a]^{-1}.$$
\qed
\end{definition}
In the following theorem we characterize generalized isomorphisms.
\begin{theorem}\label{strong-iso}\index{T- Characterization of generalized inverse}
Let $X$, $Y$, and $A$  be ep-groupoids.
\begin{itemize}
\item[{\em(1)}]\
The equivalence class $[a]=[X\xleftarrow{F}A\xrightarrow{G}Y]$ in which $F$ is an equivalence and $G$ is a sc-smooth functor  is a generalized isomorphism if and only if the functor $G$ is an  equivalence. 
\item[{\em(2)}]\
The inverse of a generalized isomorphism $[a]=[X\xleftarrow{F}A\xrightarrow{G}Y]$ is the equivalence class 
$$[a]^{-1}=[Y\xleftarrow{G}A\xrightarrow{F}X].$$
\end{itemize}
\end{theorem}
The proof is postponed to  Appendix \ref{x-strong-iso}. \qed

Assume that $\mathfrak{f}:X\rightarrow Y$ and $\mathfrak{g}:Y\rightarrow Z$ are generalized maps between ep-groupouids.
Then their composition is defined giving $\mathfrak{g}\circ \mathfrak{f}:X\rightarrow Z$.  Assume that $\mathfrak{f}=[d]$ and $\mathfrak{g}=[d']$
with representatives $d$ and $d'$ given by
$$
X\xleftarrow{F} A \xrightarrow{\Phi} Y\ \ \text{and}\ \ Y\xleftarrow{G} B\xrightarrow {\Psi}  Z,
$$
respectively.   We know already that $|\mathfrak{f}|:|X|\rightarrow |Y|$ is given by $|\mathfrak{f}|= |\Phi|\circ |F|^{-1}$ 
and $|\mathfrak{g}|:|Y|\rightarrow |Z|$ by $|\mathfrak{g}|=|\Psi|\circ |G|^{-1}$. As a representative $d''$ for $[d']\circ [d]=\mathfrak{g}\circ \mathfrak{f}$ we can take 
the diagram 
$$
d''\colon X\xleftarrow{F\circ \pi_A} A\times_Y B\xrightarrow{\Psi\circ \pi_B} Z.
$$
Here $F\circ \pi_A$ is an equivalence.  We compute $|d''|=|[d'']|$
Given  $|x|\in |X|$  we find $(a,\varphi,b)\in A\times_Y B$ and a morphism $\sigma:F(a)\rightarrow x$. Then  by definition $|d''|(|x|) = |\Psi(b)|$.
Observe that $\varphi:\Phi(a)\rightarrow G(b)$ by definition of the weak fibered product.  Hence $|\Phi(a)|=|G(b)|$. This implies, using that $G$ is an equivalence
\begin{eqnarray*}
|[d'']|(|x|)&=& |\Psi(b)|\\
&=& |\Psi|\circ |G|^{-1}\circ |\Phi(a)| \\
&=& |\Psi|\circ |G|^{-1}\circ |\Phi|\circ |F|^{-1}(|x|)\\
&=&|[d']|\circ |[d]|(|x|).
\end{eqnarray*}
Hence we have proved the following result
\begin{proposition}\label{equal_prop}\index{P- Composition and induced maps}
If $\mathfrak{f}\colon X\to Y$ and $\mathfrak{g}\colon Y\to Z$ are generalized maps  between ep-groupoids,  then 
$$\abs{\mathfrak{g}\circ \mathfrak{f}}=\abs{\mathfrak{g}}\circ \abs{\mathfrak{f}}.$$
\qed
\end{proposition}




In view of the Theorems  \ref{proppp}  and \ref{strong-iso} we can now introduce the new category whose morphisms are the generalized maps.
\begin{definition}\index{D- Category ${\mathcal{EP}}({\bf E}^{-1})$}
The {\bf category ${\mathcal{EP}}({\bf E}^{-1})$}  has as  objects the objects of ${\mathcal{EP}}$, namely the ep-groupoids $X$,  and as  morphisms
the equivalence classes $[d]\colon X\to Y$ of diagrams (the generalized maps) between ep-groupoids. 
\qed
\end{definition}

The notation ${\mathcal{EP}}({\bf E}^{-1})$ indicates that we added inverses to the elements in ${\bf E}$.
  The basic result  relating  ${\mathcal E}{\mathcal P}$ with  ${\mathcal E}{\mathcal P}({\bf E}^{-1})$
is  the following theorem.
\begin{theorem}[{\bf Properties of the Localization at ${\bf E}$}]\label{localization}\index{T- Localization}
There is a  natural functor 
$$
i\colon {\mathcal{EP}}\rightarrow {\mathcal{EP}}({\bf E}^{-1}),
$$
which is the identity on objects and maps every  sc-smooth functor $\Phi\colon X\rightarrow Y$ between ep-groupoids to the equivalence class
$[d_\Phi]$ defined by 
$$
[d_\Phi]=[X\xleftarrow{1_X} X\xrightarrow{\Phi} Y].
$$
If the functor $F:X\rightarrow Y$ is an equivalence, then   the morphism $i(F)$ is invertible and
$$
i(F)^{-1} =[Y\xleftarrow{F} X\xrightarrow{1_X} X].
$$
\end{theorem}
\begin{proof}
We first verify  that 
$$
[d_\Psi]\circ [d_\Phi] = [d_{\Psi \circ\Phi}].
$$
for sc-smooth functors $\Phi:X\rightarrow Y$ and $\Psi:Y\rightarrow Z$.  Since the diagrams 
$$
d_\Phi \colon X \xleftarrow{1_X} X\xrightarrow{\Phi} Y\quad \text{and}\quad d_\Psi\colon Y\xleftarrow{1_Y} Y\xrightarrow{\Psi} Z, 
$$
are representative of the equivalence classes $[d_\Phi]$ and $[d_\Psi]$, the diagram 
\begin{equation}\label{diagram_1}
X\xleftarrow{\pi_X}  X\times_Y Y\xrightarrow{\Psi\circ \pi_Y} Z
\end{equation}
is a representative of the class $[d_\Psi]\circ [d_\Phi]$.
The class $[d_{\Psi\circ \Phi}]$ is represented by the diagram
$$d_{\Psi\circ \Phi}\colon  X\xleftarrow{1_X} X\xrightarrow{\Psi\circ \Phi} Z, $$
and we claim that the diagram $d_{\Psi\circ \Phi}$ is a refinement of the digram \eqref{diagram_1}.  For the equivalence between $X\times_Y Y$ and $X$ we take the  projection $\pi_X:X\times_Y Y\to X$. Then $1_X\circ \pi_X=\pi_X$ and, since $\Phi\circ \pi_X\simeq \pi_Y$ by  Theorem  \ref{modified_weak_fibered_product},   we find that
\begin{equation*}
(\Psi\circ \Phi)\circ \pi_X=\Psi\circ (\Phi\circ \pi_X)\simeq \Psi \circ \pi_Y.
\end{equation*}
Therefore, 
\begin{equation*}
i(\Psi\circ\Phi)=[d_{\Psi\circ \Phi}]=[d_{\Psi}]\circ [d_{\Phi}]=i(\Psi)\circ i(\Phi).
\end{equation*}
We already know that $i(1_X)=[X\xleftarrow{1_X}X\xrightarrow{1_X} X]=[1_X]$.

 Next we assume that $F:X\to Y$ is an equivalence and let $i(F)=[d_F]$ where $d_F$ is the diagram 
$$d_F\colon X\xleftarrow{1_X} X\xrightarrow{F}Y.$$ 
Considering the diagram $d\colon Y\xleftarrow{F} X\xrightarrow{1_X}X$, we claim that $[d]\circ [d_F]=[1_X]$ and $[d_F]\circ [d]=[1_Y]$.  The composition 
$[d]\circ [d_F]$ is represented by the diagram
\begin{equation}\label{invertible_1}
X\xleftarrow{\pi_X} X\times_Y X\xrightarrow{\pi_X} X.
\end{equation}
Since $F:X\to Y$ is an equivalence, the projection $\pi_X\colon X\times_Y X\to X$ is an equivalence by Theorem \ref{modified_weak_fibered_product}. Consequently, in view of
Theorem \ref{modified_weak_fibered_product},  the diagram in \eqref{invertible_1} is a representative of the equivalence class $[1_X]$, that is, $[d]\circ [d_F]=[1_X]$. The proof of 
$[d_F]\circ [d]=[1_Y]$ is similar. Therefore,  $i(F)$ is invertible and $i(F)^{-1}=[ Y\xleftarrow{F} X\xrightarrow{1_X}X]$. The proof of Theorem \ref{localization} is complete.
\qed \end{proof}
We summarize the fact that generalized maps induce continuous maps between orbit spaces, compatible with compositions,  as follows, where $\text{TOP}$ is the category of topological spaces.
\begin{theorem}\index{T- The functor $\vert .\vert$ on ${\mathcal{EP}}({\bf E}^{-1})$}
There exists a natural functor $|.|: {\mathcal{EP}}({\bf E}^{-1})\rightarrow \text{TOP}$ which associates to an ep-groupoid $X$ its orbit space $|X|$
and to a generalized map 
$$
\mathfrak{f}=[d]:X\rightarrow Y,
$$
 where the representative $d$ is given by $X\xleftarrow{F} A\xrightarrow{\Phi} Y$,
the continuous map $|[d]| =|\Phi|\circ |F|^{-1}:|X|\rightarrow |Y|$.
\qed
\end{theorem} 
\begin{remark}\index{R- On polyfolds}
Before we move to the strong bundle case we give an example why the previous considerations are important. These ideas will studied in more generality later on.
Assume that $Z$ is a metrizable space. Consider pairs $(X,\beta)$, where $\beta:|X|\rightarrow Z$ is a homeomorphism. 
In this case $|X|$ is metrizable as well. Given a second pair $(X',\beta')$ we say it is equivalent to $(X,\beta)$ provided there exists a generalized
isomorphism $\mathfrak{f}:X\rightarrow X'$ satisfying $\beta'\circ |\mathfrak{f}|=\beta$. The metrizable space $Z$ equipped with an equivalence class
of pairs $(X,\beta)$ will be called an sc-smooth polyfold.  It  is similar to an orbifold, with the difference that  as local models we allow $G\backslash O$, were $G$ is a finite group acting 
on the M-polyfold $O$.  Later we study which notions behave well with respect to equivalences. As a by-product one obtains the notions which make sense 
on polyfolds.
\qed
\end{remark}


\begin{theorem}\label{THMX10316}\index{T- Uniqueness theorem for generalized isomorphisms}
Assume that $X$ and $Y$ are ep-groupoids and $\mathfrak{f},\mathfrak{f}':X\rightarrow Y$ generalized isomorphisms 
satisfying $|\mathfrak{f}|=|\mathfrak{f}'|$. Then $\mathfrak{f}=\mathfrak{f}'$.
\end{theorem}
 \begin{proof}
 We take  representatives $d:X\xleftarrow{F} A\xrightarrow{H} Y$ for $\mathfrak{f}$  and
$d:X\xleftarrow{F'} A'\xrightarrow{H'} Y$ for $\mathfrak{f'}$.  Take the weak fibered product $A\times_X A'$
associated to the diagram 
$$
A\xrightarrow{F} X\xleftarrow{F'} A'.
$$
Then 
$$
X\xleftarrow{F\circ \pi_A} A\times_X A'\xrightarrow{H\circ\pi_A} Y
$$
 is a diagram of equivalences  equivalent to $d$.
The diagram 
$$
X\xleftarrow{F'\circ \pi_{A'}} A\times_X A' \xrightarrow{H'\circ \pi_{A'}} Y
$$
is equivalent to $d'$. We also not that $F\circ\pi_A$ and $F'\circ\pi_{A'}$ are naturally equivalent.
In view of this discussion
 we have shown that we can take the representatives for $\mathfrak{f}$ and $\mathfrak{f}'$ 
in such a way that  $A=A'$ and $F$ and $F'$ are naturally equivalent. This even allows us to replace $F'$ by $F$.
Hence 
\begin{eqnarray*}
& d\colon X\xleftarrow{F} A\xrightarrow{H} Y&\\
&d'\colon X\xleftarrow{F} A\xrightarrow{H'} Y.&
\end{eqnarray*}
The property that $|\mathfrak{f}|=|\mathfrak{f}'|$, or equivalently $|[d]|=|[d']|$,  then means that $|H|=|H'|$. 
To proceed with our argument we study the equivalences $H,H':A\rightarrow Y$ which have the property that the induced homemorphisms 
between the orbit spaces are the same. In view of Proposition \ref{prop4.14} we find for every object $a\in A$ and open neighborhood
$U(a)$ so that there exists a (sc-smooth) natural transformation $\alpha_a:U(a)\rightarrow \bm{X}$ 
such that 
$$
\alpha_a(b):H(b)\rightarrow H'(b)\ \ \text{for}\ \ b\in U(a).
$$
The collection ${\mathcal U}$ of all these $U(a)$, where $a$ varies over the objects in $A$ is an open covering and 
associated to it we have the ep-groupoid $A_{\mathcal U}$ together with natural  equivalences
$$
H_{\mathcal U}: A_{\mathcal U}\rightarrow Y\ \ \text{and}\ \ H_{\mathcal U}':A_{\mathcal U}\rightarrow Y.
$$
From the $(\alpha_a)$ we obtain a natural transformation $\alpha:H_{\mathcal U}\rightarrow H_{\mathcal U}'$.
We the natural equivalence $\pi: A_{\mathcal U}\rightarrow A$ the diagram
$$
X\xleftarrow{F\circ \pi} A_{\mathcal U}\xrightarrow{H_{\mathcal U}} Y
$$
is equivalent to $X\xleftarrow{F}A\xrightarrow{H} Y$ and 
$$
X\xleftarrow{F\circ \pi} A_{\mathcal U}\xrightarrow{H_{\mathcal U}'} Y
$$
is equivalent to  $X\xleftarrow{F}A\xrightarrow{H'} Y$. By construction the two displayed diagrams are equivalent 
which proves that $\mathfrak{f}=\mathfrak{f}'$.
  \qed \end{proof}


 \section{Strong Bundles and Equivalences}\label{STE__x}

Next we discuss the notion of equivalence between strong bundles over ep-groupoid. 
In Section \ref{SST} we have introduced the notion of a strong bundle $(P\colon W\to X, \mu)$ over the ep-groupoid $X$, where $P\colon W\to X$ is a strong bundle over the object M-polyfold $X$ and the structure map $\mu$ is a strong bundle isomorphism 
$$
\mu:{\bm{X}}{_{s}\times_P W}\rightarrow W
$$
covering the target map $t:{\bm{X}}\rightarrow X$ and possessing additional  properties.  In particular,  $\mu$ lifts a morphism $\phi\colon x\rightarrow y$
to a linear isomorphism $\mu(\phi,\cdot ):W_x\rightarrow W_y$ which is compatible with the composition of morphisms.  As we have seen Section \ref{SST}, $W$ can be viewed 
as the object space of a category $(W, {\bm{W}})$ whose morphisms space is ${\bm{W}}:={\bm{X}}{_{s}\times_P W}$. The projection 
${\bm{P}}:{\bm{W}}\rightarrow {\bm{X}}$, ${\bm{P}}(\phi,w)=\phi$,  defines a strong bundle. Moreover,  the pairs $(W[i],{\bm{W}}([i])$ for
$i=0,1$ are ep-groupoids and  the projections $(P,{\bm{P}})\colon (W[i],{\bm{W}}[i])\rightarrow (X,{\bm{X}})$ onto ep-groupoids are sc-smooth functors.


A strong bundle functor $\Phi \colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X', \mu')$  between strong bundles over ep-groupoids is a strong bundle map $\Phi:W\rightarrow W$
covering the  sc-smooth functor $\varphi\colon X\rightarrow X'$ between the ep-groupoids preserving the structural maps in the sense that
\begin{equation}\label{equation_section_functor_1}
\mu'(\bm{\varphi}(\gamma),\Phi(w))=\Phi(\mu(\gamma ,w))
\end{equation}
for all $(\gamma ,w)\in {\bm{W}}$. 
In the more functorial description,  a strong bundle functor is a  functor
$(\Phi,\bm{\Phi}):(W,{\bm{W}})\rightarrow (W,{\bm{W}}')$  in which  $\Phi$ and $\bm{\Phi}$ are strong bundle maps covering the sc-functor $\varphi\colon X\to X'$.

\begin{definition}\label{LinStBunEq-def}\index{D- Strong bundle equivalence}
A {\bf strong bundle equivalence} 
$$
\Phi \colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X', \mu')
$$
  between two  strong bundles over ep-groupoids is a linear strong bundle 
functor between strong bundles over ep-group\-oids satisfying the following properties:
\begin{itemize}
\item[(1)]\ The functors $\Phi \colon W[i]\to W'[i]$ for $i=0,1$ are  equivalences between  ep-group\-oids, covering the equivalence $\varphi \colon X\to X'$ between the underlying  ep-groupoids.
\item[(2)]\  The induced maps $\Phi \colon W\to W'$ and $\bm{\Phi} \colon {\bm{W}}\to {\bm{W}}'$ between the object sets and the morphism sets preserve the strong bundle structures and are locally strong bundle isomorphisms.
\end{itemize}
\qed
\end{definition}
If $(P\colon W\rightarrow X,\mu)$ is a strong bundle over the  ep-groupoid $X$,   we consider  $w\in W$ as an object in the ep-groupoid $(W, {\bm{W}})$. By definition,  
 $w$ and $w'\in W$ are isomorphic if there exists a morphism $\sigma \colon P(w)\to P(w')\in {\bm{X}}$ satisfying 
\begin{equation}\label{strong_bundle_equ_eq1}
\mu(\sigma,w)=w'.
\end{equation}
By $\abs{W}$ we denote, as usual, the  orbit space of $W$, whose elements are the  equivalence classes $|w|=\{w'\, \vert \,  w'\,  \text{is isomorphic to}\,   w\}$.
A  strong bundle map $\Phi \colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X', \mu')$ induces the continuous map  $|\Phi|\colon |W|\rightarrow |W'|$ between the orbit spaces.

Finally we recall from Section \ref{SST} that a  sc-smooth section functor $f\colon X\to W$ 
of the strong bundle $(P\colon W\to X, \mu)$
satisfies 
\begin{equation}\label{property_eq2}
f(t(\gamma))=\mu(\gamma,f(s(\gamma))).
\end{equation}
for every morphism $\gamma\in {\bm{X}}$. This relation 
encapsulates the functoriality of the section $f$. 
If  $\gamma\in {\bm{X}}$ belongs to the isotropy group $G_x$ at $x\in X$, then 
\begin{equation}\label{property_eq3}
f(x)=\mu(\gamma,f(x)).
\end{equation}
This relation has  an  interesting consequence for the pull-backs $\Phi^\ast(f')$ of section functors $f'$ of the bundle $W'\to X'$, defined at $x\in X$ by the formula
$$
\Phi^\ast(f')(x) =\Phi^{-1}\circ (f' (\varphi (x)))\in W_x,
$$
provided $\Phi$ is a strong bundle equivalence.
\begin{proposition}\label{Strong_bundle_equivalences_I}\index{P- Strong bundle equivalences {I}}
We assume that 
$\Phi \colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X', \mu')$
 is a strong bundle equivalence covering the equivalence $\varphi\colon X\to X'$ between ep-groupoids,  and $\Psi \colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X', \mu')$  is a 
strong bundle equivalence covering the equivalence $\psi\colon X\to X'$. 
If $|\Psi|=|\Phi|$, then 
$$
\Phi^\ast(f')=\Psi^\ast(f')
$$
for every sc-smooth section functor $f'\colon W'\to X'$.
\end{proposition}
\begin{proof}
The section functor 
$f'\colon X'\to W'$ satisfies, by definition, 
$$
f'(\psi (x)) = \mu'(\tau', f'(\varphi (x))) 
$$
for every morphism $\tau'\colon \varphi (x)\to \psi (x)$ in $\bx '$. 
Abbreviating
$$
\text{$g=\Psi^\ast (f')$\quad and \quad $f=\Phi^\ast (f')$},$$
we deduce 
\begin{equation}\label{pull_back_eq4}
\Psi (g(x))=f'(\psi (x))=\mu'(\tau', f'(\varphi (x)))=\mu'(\tau', \Phi (f(x)))
\end{equation}
for every morphism $\tau'\colon \varphi (x)\rightarrow \psi (x)$. In view of the assumption, 
that $\abs{\Phi}=\abs{\Psi}$  there exists  a morphism $\Sigma\colon \Phi (g(x))\to \Psi (g(x))$ in 
${\bf W'}$. The vector $\Phi (g(x))$ belongs to the fiber $W'_{\varphi (x)}$ and the vector 
$\Psi (g(x))$ belongs to the fiber $W_{\psi (x)}'$. Therefore, in view of \eqref{strong_bundle_equ_eq1}, there exists a morphism $\sigma\colon \varphi (x)\to \psi (x)$ in ${\bm{X}}'$ such that 
\begin{equation}\label{pull_back_eq5}
\Psi (g(x))=\mu'(\sigma, \Phi (g(x)).
\end{equation}
From \eqref{pull_back_eq4} and \eqref{pull_back_eq5} we deduce the relation 
$$
\mu'(\tau', \Phi (f(x)))=\mu'(\sigma, \Phi (g(x))),
$$
which implies, using the properties  of the structure map $\mu$ is Section \ref{SST},
\begin{equation}\label{pull_back_eq6}
\Phi (f(x))=\mu'((\tau')^{-1}\circ \sigma, \Phi (g(x))).
\end{equation}
We note that $(\tau')^{-1}\circ \sigma\colon \varphi (x)\to \varphi (x)$ in ${\bm{X}}'$. 
Since $\Phi$ is a strong bundle equivalence, which covers the equivalence  
$\varphi\colon X\to X'$ between ep-groupoids, there exists a morphism $\eta\colon x\to x$ in ${\bm{X}}$ satisfying 
$$
 \varphi(\eta)=(\tau')^{-1}\circ \sigma\in {\bm{X}}'.
 $$
The strong bundle equivalence $\Phi$ preserves the structure maps. Therefore, 
$$
\mu'(\varphi(\eta), \Phi (g(x)))=\Phi (\mu (\eta, g(x))).
$$
Combining this with \eqref{pull_back_eq6} leads to 
\begin{equation}\label{edi_zehnder}
\Phi(f(x))=\Phi (\mu (\eta, g(x))).
\end{equation}
Since $g$ is a section functor and $\eta\colon x\to x$ belongs to $G_x$, we obtain, in view of \eqref{property_eq3}, 
$g(x)=\mu (\eta, g(x))$, and hence conclude from the previous relation that 
$$\Phi(f(x))=\Phi(g(x)).$$
Now, $\Phi$ is fiberwise an isomorphism implying that $g(x)=f(x)$,  as we wanted to prove. 
\qed \end{proof}

We shall prove the analogous result for push-forwards.  For  a strong bundle equivalence
$$
\Phi\colon (P\colon W\to X, \mu)\rightarrow (P'\colon W'\to X',\mu')
$$
as in Proposition \ref{Strong_bundle_equivalences_I},   we define the push-forward 
$$\Phi_\ast:\Gamma(P,\mu)\rightarrow \Gamma(P',\mu')$$
of sc-smooth section functors as follows. By definition, the equivalence $\Phi$ is essentially surjective. Hence fixing 
$x'\in X'$ we find  $x\in X$ and a morphism $\sigma:\varphi(x)\rightarrow x'$ in ${\bm{X}}'$ and define the push-forward $\Phi_\ast (f)\colon X'\to W'$ of the section functor $f\colon X\to W$  of the bundle $P\colon W\to X$ at the point $x'\in X'$ by 
$$
(\Phi_\ast f)(x') = \mu'(\sigma,\Phi(f(x))).
$$
Let us first make sure that this is well-defined. If $y\in X$ and $\sigma':\varphi (y)\rightarrow x'$, then 
$\sigma^{-1}\circ\sigma':\varphi(y)\rightarrow \varphi(x)$ and since $\varphi$ is an equivalence between ep-groupoids 
we find a morphism $\tau:y\rightarrow x$ satisfying  ${\bls \varphi}(\tau)=\sigma^{-1}\circ\sigma'$, so that $\sigma\circ {\bls \varphi}(\tau)=\sigma'$.
We compute using the functoriality of $\Phi$ and the properties of the structure map $\mu'$, 
\begin{equation}\label{equation_independent}
\begin{split}
\mu'(\sigma',\Phi(f(y)))
&=\mu'(\sigma\circ{\bls \varphi}(\tau),\Phi(f(y)))\\
&=\mu'(\sigma,\mu'({\bls \varphi}(\tau),\Phi(f(y)))\\
&=\mu'(\sigma,\Phi(\mu(\tau,f(y))))\\
&=\mu'(\sigma,\Phi(f(x))).
\end{split}
\end{equation}
This proves that our definition is independent of the choices. The sc-smoothness
of $\Phi_\ast f$ is easily verified. 

\begin{proposition}\label{Strong_bundle_equivalences_II}\index{P- Strong bundle equivalences {II}}
If  $\Phi$ and $\Psi$ are the strong bundle equivalences of Proposition \ref{Strong_bundle_equivalences_I} satisfying 
$|\Phi|=|\Psi|$, 
then 
$$\Phi_\ast f=\Psi_\ast f$$
for every $f\in \Gamma (P, \mu)$.
\end{proposition}
\begin{proof}
Let $f\in \Gamma (P, \mu)$ and $x'\in X'$. We take $x\in X$ and a morphism $\sigma:\varphi(x)\rightarrow x'\in {\bm{X}}'$. From $|\Psi|=|\Phi|\colon \abs{W}\to \abs{W'}$  we conclude that $|\varphi|=|\psi|\colon \abs{X}\to \abs{X'}$ implying the existence of a morphism $\sigma':\psi(x)\rightarrow x'$ in ${\bm{X}}'$. Then, 
by definition, 
$$
\text{$(\Phi_\ast f)(x') = \mu'(\sigma,\Phi(f(x)))$\quad  and\quad 
$(\Psi_\ast f)(x') = \mu'(\sigma',\Psi(f(x)))$}.
$$
Since $\abs{\Phi}=\abs{\Psi}$, we conclude the 
existence of  a morphism $\Phi(f(x))\rightarrow \Psi(f(x))$ in ${\bm{W}}'$.  Hence, arguing as in Proposition \ref{Strong_bundle_equivalences_I}, there exists a morphism 
$\tau':\varphi(x)\rightarrow \psi(x)$ in ${\bm{X}}'$ such that  $\Psi(f(x))=\mu'(\tau',\Phi(f(x)))$. Consequently, 
$$
(\Psi_\ast f)(x')=\mu'(\sigma',\mu'(\tau',\Phi(f(x))))=\mu'(\sigma'\circ\tau',\Phi(f(x))).
$$
Then $\sigma ^{-1}\circ \sigma'\circ \tau'\colon \varphi(x)\rightarrow \varphi(x)$ and,  since $\varphi$ is an equivalence between ep-groupoids, 
we find a morphism $\eta\colon x\rightarrow x$ in ${\bm{X}}$ satisfying  ${\bls \varphi}(\eta)=\sigma ^{-1}\circ \sigma'\circ \tau'$ implying 
$$
\sigma\circ {\bls \varphi}(\eta)=\sigma'\circ \tau'.
$$
Hence,  
\begin{equation*}
\begin{split}
(\Psi_\ast f)(x')
&=\mu'(\sigma\circ {\bls \varphi} (\eta),\Phi(f(x)))\\
&=\mu'(\sigma,\mu'({\bls \varphi} (\eta),\Phi(f(x))))\\
&=\mu'(\sigma,\Phi(\mu(\eta,f(x))))\\
&=\mu'(\sigma,\Phi(f(x)))\\
&=(\Phi_\ast f)(x').
\end{split}
\end{equation*}
The proof of Proposition \ref{Strong_bundle_equivalences_II} is complete.
\qed \end{proof}
\begin{proposition}\label{composition_push_pull}
If $\Phi\colon (P,\mu)\to (P', \mu')$ and $\Psi\colon (P',\mu')\to (P'',\mu'')$ are strong bundle equivalences, then 
$$(\Psi\circ \Phi)^\ast=\Phi^\ast \circ \Psi^\ast\quad \text{and}\quad (\Psi\circ \Phi)_\ast=\Psi_\ast \circ \Phi_\ast.$$
\end{proposition}
\begin{proof}
We assume that the equivalence $\Phi\colon ((P\colon W\to X),  \mu)\to (P'\colon W'\to X'), \mu')$ covers the equivalence $\varphi\colon X\to X'$ between ep-groupoids and the equivalence $\Psi \colon ((P'\colon W'\to X'),  \mu)\to (P''\colon W''\to X''), \mu')$ covers the equivalence $\psi\colon X'\to X''$ between ep-groupoids. If $f''\colon X''\to W''$ is a section functor and $x\in X$, then, by definition,
\begin{equation*}
\begin{split}
((\Psi\circ \Phi)^\ast f'')(x)&=(\Psi\circ \Phi)^{-1}(f''(\psi \circ \varphi (x))\\
&=\Phi^{-1}\circ \Psi^{-1}(f''(\psi (\varphi (x)))\\
&=\Phi^{-1}(\Psi^\ast f'' (\varphi (x))=(\Phi^\ast\circ \Psi^\ast)f''(x).
\end{split}
\end{equation*}
Next we consider push-forwards.  We fix  $x''\in X''$. Using the fact that  the composition of equivalences is again an equivalence, we choose $x\in X$ and a morphism $\sigma''\colon \psi \circ \varphi (x)\to x''$ in ${\bf X'}$. Then, by definition,  
$$(\Psi\circ \Phi)_\ast (f)(x'')=\mu''(\sigma'' , \Psi\circ \Phi (f(x))).$$
Moreover, again using that  $\phi$  and $\psi$ are equivalences, we find a point  $x'\in X'$ and a morphism $\sigma'\colon \psi (x')\to x''$ in ${\bm{X}}''$ and a $y\in X$ and a morphism $\sigma\colon \varphi (y)\to x'.$
Then 
$$(\Phi_\ast f)(x')=\mu'(\sigma, \Phi (f(y)))$$
and, from \eqref{equation_section_functor_1}  
and the properties of the structure map $\mu$, we deduce
\begin{equation*}
\begin{split}
\bigl(\Psi_\ast (\Phi_\ast f)\bigr)(x'')&=\mu''\bigl(\sigma', \Psi ((\Phi_\ast f)(x')\bigr)\\
&=\mu''(\sigma', \Psi (\mu'(\sigma , \Phi (f(y)))\\
&=\mu''(\sigma',\mu''( {\bls \psi}(\sigma) ,\Psi( \Phi (f(y))))\\
&=\mu''(\sigma'\circ {\bls \psi}(\sigma),\Psi \circ \Phi (f(y)).
\end{split}
\end{equation*}
Since $\sigma\colon \varphi (y)\to x'$, we have ${\bls \psi}(\sigma)\colon \psi \circ \varphi (y)\to \psi (x')$,  and $\sigma'\colon \psi (x')\to x''$, the composition $\sigma'\circ {\bls \psi}(\sigma)$ is a morphism between $\psi \circ \varphi (y)$ and $x''$. 
We conclude, in view of the independence of the choices involved in the definition of push-forward, \eqref{equation_independent},
that 
$(\Psi\circ \Phi)_\ast (f)(x'')=\bigl(\Psi_\ast (\Phi_\ast f)\bigr)(x'')$, as claimed.
\qed \end{proof}


It follows from the definitions that  $\Phi_\ast$ and $\Phi^\ast$ are mutual inverses. The transformations
$\Phi_\ast:\Gamma(P,\mu)\rightarrow \Gamma(P',\mu')$ and $\Phi^\ast:\Gamma(P',\mu')\rightarrow \Gamma(P,\mu)$
map the subspaces of $\ssc^+$-section functors in one bundle to the corresponding ones in the other bundle.
If the  sc-smooth section functor $f$ of $(P,\mu)$, just viewed as a sc-smooth section
of the strong bundle $W\rightarrow X $ over the object M-polyfold,  is sc-Fredholm, then the same is true for $\Phi_\ast f$ and $\Phi^\ast f$. 
This  follows immediately from the definition of a sc-Fredholm section  in Part I.


We  summarize the above results as follows.
\begin{theorem}\label{useful}\index{T- Strong bundle equivalences and sections}
If $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ are strong bundles over ep-groupoids and
$\Phi:W\rightarrow W'$ is a strong bundle equivalence, then the pull-back $\Phi^\ast$ and the push-forward $\Phi_\ast$
define mutually inverse bijections
$$
\Phi_\ast :\Gamma(P,\mu)\rightarrow \Gamma(P',\mu')\quad  \text{and}\quad \Phi^\ast:\Gamma(P',\mu')\rightarrow \Gamma(P,\mu).
$$
If  $\Phi$ and $\Psi\colon W\rightarrow W'$ are two equivalences of strong bundles satisfying $|\Phi|=|\Psi|$, then 
$\Phi_\ast=\Psi_\ast$ and $\Phi^\ast=\Psi^\ast$. Moreover,  $\Phi_\ast$ and $\Phi^\ast$ preserve $\ssc^+$-sections and 
sc-Fredholm sections, so that 
$$
\Phi_\ast:\Gamma^+(P,\mu)\rightarrow \Gamma^+(P',\mu')\ \text{and}\ \Phi^\ast:\Gamma(P',\mu')\rightarrow \Gamma(P,\mu)
$$
and
$$
\Phi_\ast:\textrm{Fred}(P,\mu)\rightarrow \textrm{Fred}(P',\mu')\ \text{and}\ \ \Phi^\ast:\text{Fred}(P',\mu')\rightarrow \text{Fred}(P,\mu).
$$
\qed
\end{theorem}

In order to generalize the notion of natural equivalence to strong bundle maps we 
 consider the two strong bundles 
 $$
 \text{$(P \colon W\to X,\mu)$\quad  and \quad  $(P' \colon W'\to X',\mu')$}
 $$
 over ep-groupoids and the two strong  bundle functors
$$
\Phi, \Psi \colon (P,\mu)\to (P',\mu').
$$
\begin{definition}\label{NatEquiv-def}\index{D- Natural equivalence}
The %
strong  bundle functors $\Phi$ and $\Psi$  are called {\bf naturally equivalent}, $\Phi\simeq \Psi$, if there exists a natural transformation
$$
T \colon W\to {\bm{W}}'
$$
associating with every object $w\in W$ a morphism $\tau (w)\colon \Phi (w)\to \Psi (w)$ in 
${\bm{W}}'$ satisfying 
$$
T (w')\circ {\bf \Phi}(h)={\bf \Psi}(h)\circ T (w)
$$
for every morphism $h\colon w\to w'$ in ${\bm{W}}$. In addition, there exists a natural transformation 
$$
\tau\colon X\to {\bm{X}}'
$$
of the two underlying functors $\varphi$ and $\psi\colon X\to X'$ between ep-groupoids such that 
$$
\tau\circ P(w)=P'\circ T(w),\quad w\in W.
$$
where $P\colon W\to X$ and $P'\colon W'\to X'$ are the projection functors. 
\qed
\end{definition}
\begin{remark}\index{R- Sc-smoothness of natural transformations}
The natural transformation $\tau$ between the sc-smooth functors $\varphi$ and $\psi$ is sc-smooth by definition,
see Definition \ref{natural_equivalence}. We seemingly did not spell out any smoothness assertion about $T$.
However, as we shall see, $T$ is completely detemined by $\tau$ and automatically has the right sc-smoothness properties.
\qed
\end{remark}
Recall that a strong bundle over an ep-groupoid $(P,\mu)$ consists of a strong bundle $P:W\rightarrow X$ over the object 
space and a lift of the morphisms to strong linear bundle maps. In particular  $\bm{W}$ is a natural construction 
associated to $(P,\mu)$. It consists of the pairs $(\phi,w)\in \bm{X}\times W$ with $s(\phi)=P(w)$.
It follows from Definition \ref{NatEquiv-def} that the natural transformation 
$$
T \colon W\rightarrow {\bm{W}}' := {\bm{X}}'{{_s}\times_{P'}}W',
$$
covering $\tau \colon X\rightarrow {\bm{X}}'$ has the form
$$
T(w)=(\tau(P(w)),A(w)).
$$
In view of the definition of the morphisms in ${\bm{W}}'$ we obtain $\Phi(w)=s(T(w))=A(w)$ and $\Psi(w)=t(T(w))=\mu(\tau(P(w)),A(w))$, so that 
\begin{align}\label{Kalign}
T(w)&=(\tau(P(w)),\Phi(w))\\
\Psi(w)&=\mu(\tau(P(w)),\Phi(w)).\nonumber
\end{align}
We see that the strong bundle functor $\Psi$ and the natural transformation $T$ are uniquely determined by the strong bundle functor $\Phi$ and the natural transformation $\tau$. We see from (\ref{Kalign}) and the sc-smoothness properties of $P$, $\Phi$ and $\tau$, that $T$ is necessarily an sc-smoothness strong bundle map.
This allows us to define a natural transformation  between the two strong bundle functors equivalently as follows. 
\begin{definition}\label{NatTranBM}\index{D- Natural transformation}
A {\bf natural transformation} $T$ between the strong bundle functors $\Phi \colon P\to P'$ and $\Psi \colon P\to P'$
(covering the underlying functors $\varphi \colon X\to X'$  and $\psi \colon X\to X'$)
is a strong bundle map
$$
T \colon W\rightarrow {\bm{X}}'{{_s}\times_{P'}}W'
$$
covering a natural transformation $\tau \colon X\rightarrow {\bm{X}}'$ between  the functors $\varphi$ and $\psi$ of the form
$$
T(w)=(\tau(P(w)),\Phi(w)), 
$$
and satisfying
$$
\Psi(w)=\mu(\tau(P(w)),\Phi(w)).
$$
\qed
\end{definition}
From the natural equivalence $\Phi\simeq \Psi$ we deduce that their induced maps 
$$
\abs{\Phi},\abs{\Psi}\colon \abs{W}\to \abs{W'}
$$
 between the orbit spaces agree,
$$\abs{\Phi}=\abs{\Psi}.$$
At this point we can introduce a category whose objects are strong bundles over ep-groupoids.
\begin{definition}[{\bf The category ${\mathcal{SEP}}$}] \index{D- Category of strong bundles}
The category  ${\mathcal{SEP}}$\index{${\mathcal{SEP}}$} has as objects the 
strong bundles over ep-groupoids. The morphisms are the strong bundle  functors.
The morphism set has a distinguished subset $ {\bf F}$\index{${\bf F}$} of strong bundle equivalences.
\qed
\end{definition}

\section{Localization in the  Strong Bundle Case} 
Next we carry out the previous localization procedure but now in the context of strong bundle equivalences.
As in the case of  the category $\mathcal{E}\mathcal{P}$
we have a distinguished class of morphisms which are the strong bundle equivalences.
The preparatory material for this subsection can be found in the Sections \ref{SST} and \ref{SST_0}.
The only new thing is that we need to discuss the behavior of sections under generalized strong bundle isomorphisms.
There will be  the distinguished class ${\bf F}$\index{${\bf F}$} \index{Class of strong bundle equivalences} of strong bundle equivalences and,  following the procedure carried out
for ep-groupoids,  we shall define the  new category ${\mathcal S}{\mathcal E}{\mathcal P}({\bf F}^{-1})$.\index{${\mathcal S}{\mathcal E}{\mathcal P}({\bf F}^{-1})$}

  We consider two strong bundles
$(P \colon W\to X,\mu)$ and $(P' \colon W'\to X',\mu')$ over ep-groupoids and study the
diagrams
$$
W\xleftarrow{\Phi} W''\xrightarrow{\Psi}W',
$$
in which  $P'' \colon W''\to X''$ is a  third strong bundle over an ep-groupoid, and where $\Phi$ is a strong bundle equivalence and $\Psi$ a sc-smooth strong bundle functor.  Following our  earlier construction of a generalized map between ep-groupoids, one introduces the notion of a refinement of a diagram and then calls two diagrams equivalent, if they possess a common refinement. The equivalence class of the  diagram $D\colon W\xleftarrow{\Phi} W''\xrightarrow{\Psi}W',$ is then, by definition, a {\bf generalized strong bundle map},\index{Generalized strong bundle map}\index{$D\colon W\xleftarrow{\Phi} W''\xrightarrow{\Psi}W'$}  and denoted by
$$
[D] \colon W\rightarrow W'.\index{$[D] \colon W\rightarrow W'$}
$$
A diagram $D:W\xleftarrow{\Phi}W''\xrightarrow{\Psi}W'$ always covers a diagram $d\colon X\xleftarrow{\phi} X''\xrightarrow{\psi} X'$ of the underlying ep-groupoids. Hence the generalized strong bundle map  $[D]$ covers the generalized map 
$$
[d] \colon X\rightarrow X'
$$
between ep-groupoids. 
{The generalized strong bundle map $[D]=[W\xleftarrow{\Phi}W''\xrightarrow{\Psi}W']$ induces the map 
$$\abs{[D]}\colon \abs{W}\to \abs{W'}$$
between the orbit spaces, defined by 
$\abs{[D]}=\abs{\Psi}\circ \abs{\Phi}^{-1}$. The definition does not depend on the choice of the representative diagram for 
$[D]$.  
\begin{remark}\index{R- On the interpretation of certain diagrams}
Given the previous discussion it is tempting to introduce the diagram $\mathscr{D}$
\begin{eqnarray}\label{EQN1051}
{\mathscr{D}}\colon\ \ \ \ \ \ &
\begin{CD}
W @>[D]>>  W'\\
@V P VV   @V P' VV\\
X@>[d]>> X
\end{CD}
\end{eqnarray}
which literally, however,  does not make too much sense, since compositions are not defined.  Nevertheless, we might view (\ref{EQN1051}) 
as a {\bf symbolic diagram} and this is the view point we shall take.
Clearly passing to orbit spaces it becomes a commutative diagram $|\mathscr{D}|$ for continuous maps
\begin{eqnarray*}
|{\mathscr{D}}|\colon\ \ \ \ \ \ &
\begin{CD}
\abs{W} @>\abs{[D]}>> \abs{ W'}\\
@V\abs{P} VV   @V \abs{P'} VV\\
\abs{X}@>\abs{[d]}>> \abs{X}
\end{CD}
\end{eqnarray*}
There are  additional local properties of such diagrams, which we shall discuss below.
\qed
\end{remark} 
There is another property of the symbolic diagram. Namely pick $x\in X$ and $x'\in X'$ such that $|[d]|(|x|)=|x'|$. 
Taking a representative $d  \colon X\xleftarrow{\phi} X''  \xrightarrow{\psi} X'$  of $[d]$, we find $x''$ and morphisms 
$$
x\xleftarrow{a} \phi(x'') \ \text{and}\ \  \psi(x'')\xrightarrow{b} x'.
$$
These diagrams define a group homomorphism 
$$
\gamma\colon G_{x}\rightarrow G_{x'}'\colon g\rightarrow \gamma (g),
$$
obtained as a composition of several homomorphisms.
\begin{itemize}
\item $g\rightarrow h =  a\circ g \circ a^{-1}$\ \ (group isomorphism).
\item  $h\rightarrow k=\phi^{-1}(h)$\ \  (group isomorphism).
\item  $k\rightarrow \ell= \psi(k)$ \ \ (group homomorphism).
\item $\ell\rightarrow b\circ \ell \circ b^{-1}$ \ \ (group isomorphism).
\end{itemize}
We also find  suitable open neighborhoods $U(x)$, $U(x'')$, $U(x')$, $U(\phi(x''))$, and $U(\psi(x'')$, and a germ of equivariant sc-diffeomorphisms $q:{\mathcal O}(X,x)\rightarrow {\mathcal O}(X',x')$
such that
$$
q(g\ast z) = \gamma(g)\ast q(z).
$$
The germ $q$ is obtained 
from the following diagram where all arrows are sc-diffeomorphisms with the exception of $\psi$
are sc-diffeomorphisms
$$
U(x)\xleftarrow{t} U(a)\xrightarrow{s} U(\phi(x''))\xleftarrow{\phi} U(x'')\xrightarrow{\psi} U(\psi(x''))\xleftarrow{s} U(b)\xrightarrow{t} U(x')
$$
Associated to the germ $q$ there is a natural lift $Q:W|{\mathcal O}(X,x)\rightarrow W|{\mathcal O}(X',x')$ which is a strong bundle map fitting into the commutative diagram
of equivariant maps
$$
\begin{CD}
W|{\mathcal O}(X,x)@> Q>> W|{\mathcal O}(X',x')\\
@V P VV @V P' VV\\
{\mathcal O}(X,x) @> q>> {\mathcal O}(X',x')
\end{CD}
$$
 These are the local expressions 
induced by $\mathscr{D}$ and these are compatible with the projections $P$ and $P'$ and define the  strong bundle structures.


\begin{definition}\index{D- Category  ${\mathcal S}{\mathcal B}({\bf F}^{-1})$}
The {\bf category ${\mathcal S}{\mathcal E}{\mathcal P}({\bf F}^{-1})$}  has the strong bundles  over ep-group\-oids as objects and the generalized 
strong bundles maps as morphisms.
\qed
\end{definition}
 As in the ep-groupoid case a generalized strong bundle isomorphism has a particular form.
\begin{definition}\index{D- Generalized strong bundle isomorphism}
A {\bf generalized strong bundle isomorphism}
 $[D]\colon W\rightarrow W'$ is an equivalence class 
 $$
 [D]=[W\xleftarrow{\Phi} W''\xrightarrow{\Psi} W']
 $$
 of diagrams  $W\xleftarrow{\Phi} W''\xrightarrow{\Psi} W'$ in which  both $\Phi$ and $\Psi$ are strong bundle equivalences. 
 \qed
\end{definition}
So the objects are morphisms can be viewed as the following diagrams.
$$
\begin{array}{cc}
\begin{CD} 
W\\
@V P VV\\
X
\end{CD}
&\ \ \ \ \ \ \ \ \ 
\begin{CD}
W @>>[D]>  W'\\
@V P VV   @V P' VV\\
X@>[d]>> X
\end{CD}
\end{array}
$$
or in short form $[D]:W\rightarrow W'$.

Theorem \ref{useful} allows to push-forward or pull-back sc-smooth section functors by  strong bundle
equivalences.   We assume that we have a generalized strong bundle isomorphism
$$
[D]:(P,\mu)\rightarrow (P',\mu')
$$
and take a representative $W\xleftarrow{\Phi} W''\xrightarrow{\Psi} W'$ in which  both maps are strong bundle equivalences.
For a sc-smooth section functor $f$ of the strong bundle $(P,\mu)$,  we define  the push-forward by 
$$
[D]_\ast f = \Psi_\ast\Phi^\ast f.
$$
This definition does not depend on the choice of the diagram representing  $[D]$. To see this we  take a second diagram
$W\xleftarrow{\Phi'} W'''\xrightarrow{\Psi'} W'$ refining the previous one and let $H:W'''\rightarrow W''$ be the refining equivalence.
Then $\Phi\circ H\simeq \Phi'$ and $\Psi\circ H\simeq \Psi'$. Using the 
Propositions \ref{Strong_bundle_equivalences_I}-\ref{composition_push_pull} we obtain,  
\begin{equation*}
\begin{split}
\Psi_\ast\Phi^\ast f
&=\Psi_\ast H_\ast H^\ast \Phi^\ast f\\
&=(\Psi\circ H)_\ast (\Phi\circ H)^\ast f\\
&=\Psi_\ast'  (\Phi')^\ast f.
\end{split}
\end{equation*}
Since our equivalence relation is  the common refinement we see that $[D]_\ast$ is well-defined. Similarly we define
$$
[D]^\ast g = \Phi_\ast \Psi^\ast g
$$
and again this is well-defined.  Again by Theorem \ref{useful},  we see that $[D]_\ast$ and $[D]^\ast$ preserve $\ssc^+$-section functors
and sc-Fredholm functors, see Definition \ref{SECTION-FUNCTORS-X} for the different classes of sc-smooth section functors. Hence we obtain the following theorem.
\begin{theorem}\label{Push-Forw-prop}\index{T- Generalized bundle isomorphisms}
Let $(P \colon W\to X,\mu)$ and $(P' \colon W'\to X',\mu')$ be two strong bundles over ep-groupoids and $[D]:W\rightarrow W'$ a generalized strong bundle isomorphism.
Denote by $\Gamma(P,\mu)$ and $\Gamma(P',\mu')$ the vector spaces of sc-smooth section functors. Then $[D]$ induces a well-defined isomorphism
$$
[D]_\ast\colon\Gamma(P,\mu)\rightarrow \Gamma(P',\mu').
$$
Its inverse is given by the inverse diagram and equals the pull-back $[D]^\ast$.  The same assertion hold for $sc^+$-section functors 
$$
[D]_\ast\colon\Gamma^+(P,\mu)\rightarrow \Gamma^+(P',\mu')\colon
$$
and sc-Fredholm sections functors
$$
[D]_\ast\colon \text{Fred}(P,\mu)\rightarrow \text{Fred}(P',\mu').
$$
Moreover, if $[D], [D']: W\rightarrow W'$ are two generalized strong bundle isomorphisms inducing the same maps between orbit spaces, i.e. $|[D]|=|[D']|$, then
$[D]_\ast =[D']_\ast$ and $[D]^\ast =[D']^\ast$.
\qed
\end{theorem}

We end this section by stating a result which generalizes Theorem \ref{THMX10316} to the strong bundle situation.
\begin{theorem}\index{T- Uniqueness result for generalized strong bundle isomorphisms}
Assume that $(P \colon W\to X,\mu)$ and $(P' \colon W'\to X',\mu')$ are  two strong bundles over ep-groupoids and $[D], [D'] :W\rightarrow W'$ are generalized strong bundle isomorphisms satisfying 
$|[D]|=|[D']|$. Then $[D]=[D']$.\qed
\end{theorem}
\begin{proof}
The proof follows essentially along the lines of the proof of Theorem \ref{THMX10316}.
\qed \end{proof}
\section{Appendix}

\subsection{Proof of Theorem \ref{proppp}}\label{x-proppp}
We recall the statement of the theorem for the convenience of the reader.\par

{\bf Theorem \ref{proppp}\textcolor{red}{.}}
Let 
$$
d\colon X\xleftarrow{F} A\xrightarrow{\Phi}Y\quad \text{and}\quad d'\colon Y\xleftarrow{G} B\xrightarrow{\Psi} Z
$$
be representatives  of the equivalence classes $[d]\colon X\rightarrow Y$ and $[d']\colon Y\rightarrow Z$, respectively.  Then the equivalence class $[d'']$ of the diagram 
$$
d''\colon X\xleftarrow{F\circ\pi_A} A\times_Y B\xrightarrow{\Psi\circ\pi_B} Z
$$
is independent of the choices of representatives in the equivalence classes $[d]$ and $[d']$. The equivalence class $[d'']:X\to Z$ is called the {\bf composition}
of $[d]$ and $[d']$ and is denoted by 
$$[d'']=[d']\circ [d].$$
Moreover, the composition is associative; if $[d]:X\rightarrow Y$, $[d']:Y\rightarrow Z$,  and $[d'']:Z\rightarrow W$, then 
$$
([d'']\circ [d'])\circ [d]=[d'']\circ ([d']\circ [d]).
$$
In addition, 
$$
[d]\circ [1_X]=[d]\quad \text{and}\quad  [1_Y]\circ [d]=[d]
$$
for every equivalence class $[d]:X\rightarrow Y$.  Here $[1_X]$ is  the equivalence class 
$$[1_X]=[X\xleftarrow{1_X} X\xrightarrow{1_X}X].$$
\par

\begin{proof}
Assume that $X\xleftarrow{F'} A'\xrightarrow{\Phi'}Y$ is a refinement of $X\xleftarrow{F} A\xrightarrow{\Phi}Y$ and $Y\xleftarrow{G'} B'\xrightarrow{\Psi'} Z$ is a refinement of 
$Y\xleftarrow{G} B\xrightarrow{\Psi} Z, 
$ so that we have the following two diagrams 
\begin{equation*}
\begin{CD}
X@<F<<A@>\Phi>>Y\\
@. @AAHA @. \\
X@<F'<<A'@>\Phi'>>Y\\ \\
\end{CD}
\qquad \text{and}\qquad 
\begin{CD}
X@<G<<B@>\Psi>>Y\\
@. @AAKA @. \\
X@<G'<<B'@>\Psi'>>Y\\ \\
\end{CD}
\end{equation*}
in which $H$ and $K$ are equivalences and $F\circ H\simeq F'$, $\Phi\circ H\simeq \Phi'$ and $G\circ K\simeq G'$, $\Psi\circ K\simeq \Psi'$. 
We claim that 
the diagram 
$$
X\xleftarrow{F'\circ\pi_{A'}} A'\times_Y B'\xrightarrow{\Psi'\circ\pi_{B'}} Z
$$ 
is a refinement of $d''$, so that 
\begin{equation*}
\begin{CD}
d'':X@<F\circ \pi_A<<A\times_YB@>\Psi\circ \pi_B>>Y\\
@. @AALA @. \\
\phantom{d'':}X@<F'\circ \pi_{A'}<<A'\times_{Y}B'@>\Psi'\circ \pi_{B'}>>Y\\ \\
\end{CD}
\end{equation*}
for an equivalence $L$ satisfying $F'\circ \pi_{A'}\simeq(F\circ \pi_A)\circ L$ and 
$\Psi'\circ \pi_{B'}\simeq(\Psi\circ \pi_B)\circ L$. 


Indeed, take  $(a, \varphi, b)\in  A'\times_Y B'$. Then $\varphi$ is a morphism in ${\bm{Y}}$ between the points $\Phi' (a)$ and $G'(b)$. Since  $\Phi\circ H\simeq \Phi'$, there exists a sc-smooth map $\tau_{A'}:A'\to {\bm{Y}}$ such  that $\tau_{A'}(a)$ is a morphism between the points $\Phi'(a)$ and $(\Phi \circ H)(a)=\Phi (H(a))$ in ${\bm{Y}}$. Similarly, there  exists a sc-smooth map $\tau_{B'}:B'\to {\bm{Y}}$ so that $\tau_{B'}(b)$ is a morphism between $G'(b)$ and $(G \circ K)(b)=G(K(b))$. Consequently, $\tau_B(b)\circ \varphi \circ (\tau_{A'}(a))^{-1}$ is a morphism in ${\bm{Y}}$ between $H(a)$ and $K(b)$. So we define the map 
$$L: A'\times_Y B'\to  A\times_Y B$$
by 
$$L(a, \varphi, b)=(H(a), \tau_{B'}(b)\circ \varphi \circ (\tau_{A'}(a))^{-1}, K(b)).$$
The map $L$ is sc-smooth and 
\begin{equation*}
\begin{split}
(F\circ \pi_A)\circ L(a, \varphi, b)&=F\circ (\pi_A\circ H)(a, \varphi, b)=F\circ H(a)\\
&=F'(a)=(F'\circ \pi_{A'})(a, \varphi, b)
\end{split}
\end{equation*}
so that $(F\circ \pi_A)\circ L=F'\circ \pi_{A'}$. Similarly, $(\Phi \circ \pi_B)\circ L =\Psi'\circ \pi_{B'}$.
Since $F\circ \pi_A$ and $F'\circ \pi_{A'}$ are local sc-diffeomorphism, also $L$ is a local sc-diffeomorphism. Moreover, the induced maps between orbit spaces satisfy
 $\abs{(F\circ \pi_A)\circ L}=\abs{F\circ \pi_A}\circ \abs{L}=\abs{F'\circ \pi_{A'}}$ and since $\abs{F\circ \pi_A}$ and $\abs{F'\circ \pi_{A'}}$ are homeomorphisms, the same is true for the map $\abs{L}: \abs{A'\times_Y B'}\to  \abs{A\times_Y B}$.  Next we show that $L$ is faithful and full.  Take two objects  $(a, \varphi, b)$ and $(a', \varphi', b')$ in $A'\times_Y B'$. We have to verify that the induced map 
 $$\textrm{mor}_{A'\times_Y B'}( (a, \varphi, b), (a', \varphi', b'))\to \textrm{mor}_{A\times_YB}( L(a, \varphi, b), L(a', \varphi', b'))$$
 is a bijection. We take a morphism $(h', \psi, k')\in \textrm{mor}_{A\times_YB}( L(a, \varphi, b), L(a', \varphi', b'))$. In view of the definition of $L$, the triple $(h', \psi, k')$ is a morphism between $(H(a), \tau_{B'}(b)\circ \varphi \circ (\tau_{A'}(a))^{-1}, K(b))$ and $(H(a'),  \tau_{B'}(b')\circ \varphi' \circ (\tau_{A'}(a'))^{-1}, K(b'))$ so that  we have a following diagram 
 \begin{equation*}
\begin{CD}
H(a)@>\psi= \tau_{B'}(b)\circ \varphi \circ (\tau_{A'}(a))^{-1}>>K(b)\\
 @ Vh'VV   @VVk'V \\
H(a')@> \psi'= \tau_{B'}(b')\circ \varphi' \circ (\tau_{A'}(a'))^{-1}  >>K(b').\\
\end{CD}
\end{equation*}
Since $H$ and $K$ are equivalences, and hence faithful and full, we find unique morphisms $h:a\to a'$ in ${\bf A}'$ and $k:b\to b'$ in ${\bf B}'$ such that $H(h)=h'$ and $K(k)=k'$. Then 
$$L(h, \psi, k)=(h', \psi, k')$$
showing that $L$ is faithful and full. 

We have proved that $L$ is an equivalence and that $(F\circ \pi_A)\circ L\simeq F'\circ \pi_{A'}$ and $(\Phi \circ \pi_B)\circ L\simeq \Psi'\circ \pi_{B'}$. Consequently, the diagram 
$
X\xleftarrow{F'\circ\pi_{A'}} A'\times_Y B'\xrightarrow{\Psi'\circ\pi_{B'}} Z
$
is a refinement of $d''$ as claimed. Hence the equivalence class $[d'']$ is independent of the choice of the  representatives in the  equivalence classes $[d]$ and $[d']$.  

To see that the composition is associative, we consider three diagrams
$$d\colon X\xleftarrow{F}A\xrightarrow{\Phi}Y,\quad d'\colon Y\xleftarrow{F'}A'\xrightarrow{\Phi'}Z,\quad \text{and}\quad d''\colon Z\xleftarrow{F''}A''\xrightarrow{\Phi''}W.$$
The composition $[d'']\circ [d']$ is represented  by the diagram 
\begin{equation*}
Y\xleftarrow{F'\circ\pi_{A'} } A' \times_Z A'' \xrightarrow{\Phi''\circ\pi_{A''} } W, 
\end{equation*}
so that the composition $([d'']\circ [d'])\circ [d]$ is represented by the diagram 
\begin{equation}\label{associativity_1}
X\xleftarrow{F\circ\wt{\pi}_{A}}A\times_Y (A'\times_Z A'')\xrightarrow{(\Phi''\circ\pi_{A''})\circ \wt{\pi}_{A'\times_ZA''} } W
\end{equation}
where we have denoted by $\wt{\pi}$ the projection  onto the corresponding factor of the weak fibered product $A\times_Y (A'\times_Z A'')$. 
Similarly,  the composition $[d']\circ [d]$ is represented  by the diagram 
$$
X\xleftarrow{F\circ\pi_{A}} A\times_Y A'\xrightarrow{\Phi''\circ\pi_{A'}} Z
$$
and  the composition $[d'']\circ ( [d'])\circ [d])$ is represented by the diagram 
\begin{equation}\label{associativity_2}
X\xleftarrow{(F\circ {\pi}_{A})\circ \wt{\pi}_{A\times_YA'} } (A\times_Y A')\times_Z A''\xrightarrow{(\Phi''\circ \wt{\pi}_{A''} } W.
\end{equation}
where this time $\wt{\pi}$ denotes  projection onto the corresponding  factor of the weak fibered product $(A\times_Y A')\times_Z A''$. 
Note that $(A\times_Y A')\times_Z A''$ is the sub  M-polyfold of $A\times{\bm{Y}}\times A'\times {\bm{Z}}\times A''$
consisting of points $(a,\phi,a',\psi,a'')$ in which  $\phi:\Phi(a)\to F'(a')$ and $\psi:\Phi' (a')\to F'' (a'')$ are morphisms.
Moreover, $A\times_Y (A'\times_Z A'')$ is the same space.   Then 
\begin{equation*}
\begin{aligned}
&(F\circ\wt{\pi}_{A} )(a,\phi,a',\psi,a'')=F(a')\\
&(F\circ {\pi}_{A})\circ \wt{\pi}_{A\times YA'} (a,\phi,a',\psi,a'')= (F\circ {\pi}_{A})(a, \phi, a')=F(a)
\end{aligned}
\end{equation*}
and
\begin{equation*}
\begin{aligned}
&(\Phi''\circ\pi_{A''})\circ \wt{\pi}_{A'\times_ZA''}   (a, \phi, a', \psi, a'')\Phi''\circ\pi_{A''}(a', \psi, a'')=\Phi''(a'')\\
&(\Phi''\circ \wt{\pi}_{A''}) (a,\phi,a',\psi,a'')=\Phi''(a'').
\end{aligned}
\end{equation*}
Hence,  taking the identity map $i_{(A\times_Y A')\times_Z A''}:(A\times_Y A')\times_Z A''\to A\times_Y (A'\times_Z A'')$ as the equivalence, the diagrams \eqref{associativity_1} and \eqref{associativity_2} are refinements of each other which implies  that $([d'']\circ [d'])\circ [d]=[d'']\circ ( [d']\circ [d])$ as claimed. 



Next we shall show that $[1_X]\circ [d]=[d]$ where $d\colon X\xleftarrow{F}A\xrightarrow{\Phi} Y$. To see this it suffices to show that the diagram $X\xleftarrow{\pi_X}X\times_XA\xrightarrow{\Phi\circ \pi_A}$ is a refinement of the diagram $X\xleftarrow{F}A\xrightarrow{\Phi} Y$. The map $\pi_A\colon X\times_XA\to A$ is an equivalence and we only  have to show that $F\circ \pi_A\simeq \pi_X$.  We define $\tau:X\times_XA\to {\bm{X}}$  by $\tau (x, \varphi, a)=\varphi$. Clearly the map $\tau$ is sc-smooth and for every $ (x, \varphi, a)\in X\times_XA$, $\tau (a, \varphi, a)=\varphi$ is a morphism between $x$ and $(F\circ \pi_A) (x, \varphi, a)=F(a).$ If $(h, \psi, k)$ is a morphism in $X\times_XA$ between 
$(x, \varphi, a)$ and $(x', \varphi', a')$, then $h:x\to x'$, $k:F(a)\to F(a')$, and $\psi=\phi$ and $\varphi'=F(k)\circ \psi\circ h^{-1}=F(k)\circ \varphi\circ h^{-1}$.  Consequently, 
$$\tau (x', \varphi', a')\circ \pi_X(h, \psi, k)=(F\circ \pi_A)(h, \psi, k)\circ \tau (x, \varphi, a)$$
showing that  the map $\tau$  is natural  and that $F\circ \pi_A$ and $\pi_X$ are naturally equivalent. Hence $[1_X]\circ [d]=[d]$. Similarly, one shows that $[d]\circ [1_Y]=[d]$. The proof of Theorem \ref{proppp}  is complete.
\qed \end{proof}

\subsection{Proof of Theorem \ref{strong-iso}}\label{x-strong-iso}
We recall the theorem for the convenience of the reader.\par

{\bf Theorem \ref{strong-iso}\textcolor{red}{.}}
Let $X$, $Y$, and $A$ be ep-groupoids.
The equivalence class $[a]=[X\xleftarrow{F}A\xrightarrow{G}Y]$ in which $F$ is an equivalence and $G$ is a sc-smooth functor  is a generalized isomorphism if and only if the functor $G$ is an  equivalence. 

The inverse of a generalized isomorphism $[a]=[X\xleftarrow{F}A\xrightarrow{G}Y]$ is the equivalence class 
$$[a]^{-1}=[Y\xleftarrow{G}A\xrightarrow{F}X].
$$
\par




\begin{proof}
(1) We first verify that the generalized map $[a]\colon X\to Y$ given by the equivalence class $[a]=[X\xleftarrow{F}A\xrightarrow{G}Y]$ in which $F$ and $G$ are equivalences is a generalized isomorphism whose inverse is equal to $[a]^{-1}=[Y\xleftarrow{G}A\xrightarrow{F}X]$. 


Indeed, the composition 
$$[a]^{-1}\circ [a]= [Y\xleftarrow{G}A\xrightarrow{F}X]\circ [X\xleftarrow{F}A\xrightarrow{G}Y]$$
is represented by the diagram 
$X\xleftarrow{F\circ \pi_1}A\times_YA\xrightarrow{F\circ \pi_2}X$ which is refined by the diagram $X\xleftarrow{F}A\xrightarrow{F}X$ by means of the equivalence $A\to A\times_YA$ defined by $a\mapsto (a, a)$. The diagram $X\xleftarrow{F}A\xrightarrow{F}X$ refines also the identity diagram $X\xleftarrow{1_X}X\xrightarrow{1_X}X$ via the equivalence $F\colon A\to X$.
Therefore, $[a]^{-1}\circ [a]=[1_X]$. Similarly one sees that $[a]\circ [a]^{-1}=[1_Y]$ so that  $[a]\colon X\to Y$ is indeed a generalized isomorphism.


(2)\, Conversely we assume that $[a]\colon X\to Y$ is a generalized isomorphism and $[b]\colon Y\to X$ is the inverse so that $[b]\circ [a]=[1_X]$ and  $[a]\circ [b]=[1_Y]$.
If $[a]=[X\xleftarrow{F}A\xrightarrow{\Phi}Y]$ and 
$[b]=[Y\xleftarrow{G}A\xrightarrow{\Psi}X]$, we shall verify that 
$\Phi\colon A\to Y$ is an equivalence.

In view of Theorem \ref{proppp},  the diagram
$$X\xleftarrow{F\circ \pi_A} A\times_Y B\xrightarrow{\Psi\circ\pi_B} X$$
is a representative of the class $[b]\circ [a]=[1_X]$ 
and the diagram
$$Y\xleftarrow{G\circ  \pi'_B} B\times_X A\xrightarrow{\Phi\circ\pi'_A} Y$$
is a  a representative of the class $[a]\circ [b]=[1_Y]$. By Theorem \ref{proppp},  the sc-functor $\Psi\circ\pi_B: A\times_Y B\to  X$ is an equivalence and the same holds for the sc-functor $\Phi\circ\pi'_A:B\times_X A\to  Y$.  

\noindent {\bf (C1)} We claim that the functors $\Phi:A\to Y$ and $\Psi:B\to X$ are equivalences in the sense of the category theory. \\[0.5ex]
We first show that  $\Phi$ is full, that is, given $a, a'\in A$, the induced map $\textrm{mor}_{A}(a, a')\to \textrm{mor}_{Y}(\Phi (a), \Phi (a'))$ is surjective.  With  $a, a'\in A$, the objects $\Phi (a), \Phi(a')$ belong to $Y$ and since $G:B\to Y$ is essentially surjective, there are $b, b'\in B$ and morphisms $\varphi\colon G(b)\to  \Phi (a)$ and $\varphi'\colon G(b')\to  \Phi (a')$. In view of the definition of the weak fibered product $B\times_XA$, the triples $(b, \varphi, a)$ and $(b', \varphi, a')$ belong to $B\times_XA$. We know that the map 
\begin{equation}\label{faithful_morphism_1}
\textrm{mor}_{B\times_XA}((b,\varphi, a), ( b', \varphi', a'))\to \textrm{mor}_{Y}((\Phi \circ \pi'_A)(a, \varphi, b), (\Phi \circ \pi'_A)(a', \varphi', b')),
\end{equation}
induced by the equivalence  $\Phi\circ \pi'_A$, is surjective. We note that  the sets $\textrm{mor}_{Y}((\Phi \circ \pi'_A)(a, \varphi, b), (\Phi \circ \pi'_A)(a', \varphi', b'))$ and $\textrm{mor}_{Y}(\Phi(a), \Phi(a'))$ are equal.  Hence given the morphism 
morphism $h':\Phi(a)\to \Phi(a')$, we find  a morphism  
$$
(k, \psi, h)\in \textrm{mor}_{B\times_XA}((b,\varphi, a), ( b', \varphi',a'))
$$
 such that $\Phi\circ \pi'_A (k, \psi, h)=h'$. Since $\Phi\circ \pi'_A (k, \psi, h)=\Phi (h)$ and,  by definition of the morphism $(k, \psi, h)$, $h\in \textrm{mor}_{A}(a, a')$, we conclude that the map  $\textrm{mor}_{A}(a, a')\to \textrm{mor}_{Y}(\Phi (a), \Phi (a'))$ is surjective, as claimed. Next we show that this map is also injective.  Take two distinct elements $h, h'$ in $\textrm{mor}_{A}(a, a')$. Then the morphisms $\Phi (h)$ and $\Phi (h')$ belong to 
$\textrm{mor}_{Y}(\Phi(a), \Phi(a'))$ and we claim that they are distinct. Arguing as above we find two objects $b$ and $b'\in B$ and two morphisms $\varphi\colon G(b)\to  \Phi (a)$ and $\varphi'\colon G(b')\to  \Phi (a')$ such  that $(b, \varphi, a), (b', \varphi', a')\in B\times_XA$. Setting $\wt{k}:=(\varphi')^{-1}\circ \Phi (h)\circ \varphi$ and $\wt{k}':=(\varphi')^{-1}\circ \Phi (h')\circ \varphi$, we obtain two morphisms in ${\bm{Y}}$ between $G(b)$ and $G(b')$. Since the equivalence $G:B\to Y$ is full, there are morphisms $k$ and $k'$ in ${\bf B}$ between $b$ and $b'$ such that $G(k)=\wt{k}$ and $G(k')=\wt{k}'$. 
Then $(k, \varphi, h)$ and $(k', \varphi', h')$ are distinct morphisms in $\textrm{mor}_{B\times_XA}((b,\varphi, a), ( b', \varphi', a'))$ and since the map \eqref{faithful_morphism_1} induced by $\Phi\circ \pi'_A$ is injective, the morphisms $(\Phi\circ \pi'_A)(k, \varphi, h)$ and $(\Phi\circ \pi'_A)(k', \varphi', h')$ are distinct. From  $(\Phi\circ \pi'_A)(k, \varphi, h)=\Phi (h)$ and $(\Phi\circ \pi'_A)(k', \varphi', h')=\Phi (h')$  it follows that $\Phi (h)$ and $\Phi (h')$ are distinct elements of $\textrm{mor}_{Y}(\Phi(a), \Phi(a'))$, proving that the functor   $\Phi:A\to Y$ is faithful.  Finally,  since the functor 
$\Phi\circ\pi'_A:B\times_XA\to Y$ is essentially surjective,  we conclude for a given object $y\in Y$ that  there exists an object $(b, \varphi, a)\in B\times_XA$ and a morphism $\psi$ in ${\bm{Y}}$ between $(\Phi\circ\pi'_A)(b, \varphi, a)=\Phi (a)$ and $x$.  But this implies that the functor $\Phi:A\to Y$ is essentially surjective. Hence $\Phi$ is an equivalence in the sense of the category theory,  and similar arguments show the same for the functor $\Psi$. This finishes the proof of  the claim (C1).

It remains, in view of Lemma \ref{equivalence_in_the sense_of_category_theory}, to prove the following claim.\\[0.5ex]
\noindent {\bf (C2)}  The sc-functors $\Phi:A\to Y$ and $\Psi:B\to X$ are local sc-diffeomorphisms. \\[0.5ex]
 The arguments for the functors $\Phi$ and $\Psi$ are similar and hence we only consider the $\Phi$-case. 
 Fix a point $a\in A$ and choose an object $(b, \varphi, a)\in B\times_XA$.  Here $a\in A$, $b\in B$, and $\varphi:\Psi (b)\to F(a)$ is a morphism in ${\bm{X}}$.
Since the source and the target maps $s, t\colon {\bm{X}}\rightarrow X$ and also the equivalence $F\colon A\rightarrow X$ are  local sc-diffeomorphisms,  we find open neighborhoods
$U=U(\Psi  (b))$ of $\Psi (b)$ in $X$, $V=V(F(a))$ of $F(a)$ in $X$, ${\bm{U}}={\bm{U}}(\varphi)$ of $\varphi$ in ${\bm{X}}$, and $W=W(a)$ of $a$ in $A$ such that  the maps 
$$
s\vert {\bm{U}}\colon {\bm{U}}\to U,\quad t\vert {\bm{U}}\colon {\bm{U}}\to V,\quad \text{and}\quad  F\vert W\colon W\to V
$$ 
are sc-diffeomorphism.  Let $U':=\Psi^{-1}(U)\subset B$ and define for $b'\in U'$
$$\Gamma (b')=(b', (s\vert {\bm{U}})^{-1}(b'), (F\vert W)^{-1}\circ t\circ  (s\vert {\bm{U}})^{-1}(b')).$$
Then $\Gamma (b')\in B\times_XA$ so that $\Gamma:U'\to B\times_XA$. The map $\Gamma$ is a local sc-diffeo\-mor\-phism and its inverse is equal to a suitably restricted projection 
$\pi'_B:B\times_XA\to B$. 
Since $\Phi\circ \pi'_A$ is an equivalence, the composition $(\Phi\circ \pi'_A)\circ \Gamma:U'\to Y$, 
$$(\Phi\circ \pi'_A)\circ \Gamma (b')= \Phi\circ  (F\vert W)^{-1}\circ t\circ  (s\vert {\bm{U}})^{-1}(b')),$$
is a local sc-diffeomorphism. In addition the map $\Gamma':U'\to A$, defined by 
$$\Gamma'(b')= (F\vert W)^{-1}\circ t\circ  (s\vert {\bm{U}})^{-1}(b'),$$
is a local sc-diffeomorphism. Consequently, the map $\Phi:A\to Y$ is a local sc-diffeomorphism and the claim (C2) is proved. 



Having  proved  the claims (C1) and (C2), it follows now from Lemma \ref{equivalence_in_the sense_of_category_theory}
that $\Phi$ is an equivalence. The proof of Theorem \ref{strong-iso} is complete.
\qed \end{proof}



\chapter{Geometry  up to Equivalences}\label{CHAPTER_11}

We now study the category ${\mathcal{EP}}({\bf E}^{-1})$ in more detail.  In particular we investigate how certain concepts
behave with respect to equivalences and generalized maps.




\section{Ep-Groupoids and Equivalences}
We recall that the objects are the ep-groupoids and the morphisms are the generalized maps $[d]\colon X\to Y$ abbreviating the equivalence  classes  
$$
[d]=[X\xleftarrow{F}A\xrightarrow{\Phi} Y]
$$
of diagrams, in which $F$ is an equivalence and $\Phi$ a sc-smooth functor between ep-groupoids. 
The invertible generalized maps are the equivalence classes
$$
[d]=[X\xleftarrow{F}A\xrightarrow{\Phi} Y]
$$
in which both functors $F$ and $\Phi$ are equivalences, in view of Theorem \ref{strong-iso}. Often we denote a generalized map
by $\mathfrak{f}:X\rightarrow Y$, where $\mathfrak{f}=[d]$.

\begin{theorem}\label{TANGENTXXX}\index{T- Tangent functor in ${\mathcal{EP}}({\bf E}^{-1})$}
The tangent functor induces in a natural way a functor
$$
T:{\mathcal{EP}}({\bf E}^{-1})\rightarrow {\mathcal{EP}}({\bf E}^{-1}).
$$
It maps an ep-groupoid $X$ to the ep-groupoid $TX$ and a morphism  $[d]:X\rightarrow Y$ to the morphism  $T[d]:TX\rightarrow TY$
defined by 
$$
T[X\xleftarrow{F}A\xrightarrow{\Phi}Y]=[TX\xleftarrow{TF} TA\xrightarrow{T\Phi}TY].
$$
\end{theorem}
\begin{proof}
On objects we just take the tangent $TX$ of the ep-groupoid $X$.  We  already know from Theorem \ref{main_KK} that $TX$  is an ep-groupoid. 
Let  $X\xleftarrow{F}A\xrightarrow{\Phi}Y$ 
be  a representative of the equivalence class  $[d]:X\rightarrow Y$. Since $F$ is an equivalence,   the sc-smooth functor $TF$ is an equivalence by Theorem \ref{gertrude} and we claim that if a diagram $X\xleftarrow{G}B\xrightarrow{\Psi}Y$ is a refinement of the diagram $X\xleftarrow{F}A\xrightarrow{\Phi}Y$, then 
the diagram $TX\xleftarrow{TG} TB\xrightarrow{T\Psi}TY$ is a refinement of the diagram $TX\xleftarrow{TF} TA\xrightarrow{T\Phi}TY$. 
So,   we consider the diagram 
\begin{equation*}
\begin{CD}
X@<F<<A@>\Phi>>Y\\
@. @AAHA @. \\
X@<G<<B@>\Psi>>Y\\ \\
\end{CD}
\end{equation*}
in which $H:B\to A$ is an equivalence and $F\circ H\simeq G$ and  $\Phi\circ H\simeq \Psi$. We claim that $T(F\circ H)=TF\circ TH\simeq TG$ and $T(\Phi\circ H)\simeq T\Psi$.
In view of Theorem \ref{gertrude} the tangent functors   $TF$, $TG$,  and $TH$ are  equivalences. 
Since $F\circ H\simeq G$, there exists a sc-smooth map $\sigma:B\to {\bm{X}}$ such that, for every $x\in B$, $\sigma (x)$ is a morphism $G(x)\to F\circ H(x)$ in ${\bm{X}}$. Hence  
$T\sigma \colon TB\to T{\bm{X}}$ is sc-smooth and by Proposition \ref{169} a natural transformation $TG\rightarrow TF\circ TH$ and consequently $TF\circ TH\simeq TG$.
The remaining argument is similar.
\qed \end{proof}

If $X$ is an ep-groupoid we denote by  $d_X$  the degeneracy index map for the underlying object M-polyfold.
If $\phi:x\rightarrow y$ is a morphism,  then  $d_X(x)=d_X(y)$ so that we obtain the  {\bf induced degeneracy map}\index{Induced degeneracy map}
$$
d_{|X|}:|X|\rightarrow {\mathbb N}
$$
on the orbit space $|X|$.
\begin{proposition}\label{deg-x}\index{P- Invariance of $d_{|X|}$}
We assume that $X$ and $Y$ are ep-groupoids and $d_X$ and $d_Y$ the respective degeneracy index maps, and
$d_{|X|}$  and $d_{|Y|}$ the induced degeneracy maps.
Let  $[d]\colon X\rightarrow Y$ be  an isomorphism in ${\mathcal{EP}}({\bf E}^{-1})$ and 
$|[d]|\colon |X|\rightarrow|Y|$
 the induced homeomorphism.
If $|[d]|(\abs{x})=\abs{y}$, then 
$$
d_X(x')=d_Y(y')
$$
for every $x'\in \abs{x}$ and $y'\in \abs{y}$ and $d_{|X|}(\abs{x})=d_{|Y|}(\abs{y})$.
\end{proposition}
\begin{proof}
If $x'\in \abs{x}$, then $d_{X}(x')=d_{X}(x)$ since $s, t:{\bm{X}}\to X$ are local sc-diffeo\-mor\-phisms. Hence it suffices to show that $d_{X}(x)=d_{Y}(y)$.
Since $[d]:X\to Y$ is a generalized  isomorphism, the equivalence class  $[d]$ is,  in view of Proposition \ref{strong-iso}, represented by a diagram 
$$
X\xleftarrow{F} A\xrightarrow{G} Y
$$
 in which $F$ and $G$ are equivalences. 
By assumption, 
$$
\abs{[d]}(\abs{x})=\abs{G}\circ \abs{F}^{-1}(\abs{x})=\abs{y}.
$$
  Let $\abs{F}^{-1}(\abs{x})=\abs{a}$. Then $\abs{F}(\abs{a})=\abs{F(a)}=\abs{x}$ and $\abs{G}(\abs{a}]=\abs{G(a)}=\abs{y}$ and, since  equivalences are essentially surjective, 
there are morphisms  $\varphi\in {\bm{X}}$ and $\psi\in {\bm{Y}}$ so that
$$
\varphi\colon F(a)\rightarrow x \quad \text{and}\quad \psi\colon G(a)\rightarrow y.
$$
Using again the fact that $s$ and $t$ are local sc-diffeomorphisms ,  we find  that 
$$d_{X}(x)=d_{X}(F(a))\quad \text{and}\quad d_{Y}(y)=d_{Y}(G(a)).$$
Since $F$ and $G$ are local sc-diffeomorphisms, 
$$d_{X}(x)=d_{X}(F(a))=d_{A}(a)=d_{Y}(G(a))=d_{Y}(y).$$
Consequently, $d_{X}(x)=d_{Y}(y)$ as claimed.
\qed \end{proof}

If $X$ is a  tame M-polyfold we have introduced the notion of a face. It is by definition the closure of a connected component of 
the set $\{x\in X\ |\ d_X(x)=1\}$, see Definition \ref{DEF248}. The tame M-polyfold was called face-structured provided a point $x\in X$ lies in precisely
$d_X(x)$-many faces. Recall that $x$ always lies in at most $d_X(x)$-many faces.  When we study an ep-groupoid we can talk about the faces
of the underlying M-polyfold, which is useful for certain discussions. If we study ep-groupoids up to equivalences we need to take the 
morphisms into consideration and the definition of a face in the ep-groupoid sense should accommodate this fact. 
If $X$ is an ep-groupoid and $\phi\in \bm{X}$ 
 we have the equality 
 $$
 d_{X}(s(\phi))=d_X(t(\phi)),
 $$
 which we already used to define $d_{|X|}:|X|\rightarrow {\mathbb N}$. This allows us to give a more appropriate definition  of
 a face in the case of an ep-groupoid. We assume that the ep-groupoid is tame so that $\partial X$ has reasonable geometrical properties.
 If $X$ is an ep-groupoid and $\theta\subset |X|$,  there exists an associated full subcategory $X_\theta$\index{$X_\theta$} of $X$ associated to all
 objects $x\in X$ with $|x|\in\theta$.

\begin{definition}\label{DEF1113}\index{D- Face of a tame ep-groupoid}\index{D- Face structured ep-groupoid}
Let $X$ be a tame ep-groupoid. A {\bf face} of $X$ (in the ep-groupoid sense) is the full-subcategory $X_\theta$
associated to the closure $\theta$ in $|X|$ of a connected component $\theta^\circ$ of $\{z\in |X|\ |\ d_{|X|}(z)=1\}$. We shall 
call $\theta$ a face of $|X|$.
  A tame ep-groupoid is called {\bf face structured} (in the ep-groupoid sense)
provided a point $z\in |X|$ lies in precisely $d_{|X|}(z)$-many faces of $|X|$.  We say the tame ep-groupoid $X$ is {\bf weakly face structured}
provided the underlying object M-polyfold is face-structured.
\qed
\end{definition}
\begin{example}
To illustrate the definition consider the manifold with boundary with corners $X=C=[0,\infty)^2\subset {\mathbb R}^2$
and take as morphisms only the identities. Then $X$ is a face structed ep-groupoid.    In the second example take 
the same object space and we have ${\mathbb Z}_2=\{-1,1\}$ act as follows. The element $1$ acts through the identity
and $-1$ interchanges coordinates.  Then ${\mathbb Z}_2\ltimes C$ is an ep-groupoid. It is not face structured, but weakly face structured.
\qed
\end{example}
\begin{remark}\index{R- On being face-structured}
In certain contexts it is even true that face structured ep-groupoids have an additional structure, 
namely they are {\bf ordered face structured}\index{Ordered face structured}. The additional structure 
is that on the set of faces there is a partial ordering, which induces for an object $x\in X$ a total ordering on 
the set of faces containing $x$.  This additional structure occurs in applications to Floer-theoretic problems.
\qed
\end{remark}


There is a comprehensive discussion of faces of ep-groupoids in \cite{HWZ3.5}. Although in \cite{HWZ3.5} we still discussed only spaces built on splicing cores, the discussion applies verbatim to the tame ep-groupoids considered here. Recall that a M-polyfold build on  splicing cores is automatically tame.
According to Proposition 3.15 in \cite{HWZ3.5}, an equivalence $\Phi\colon X\to Y$ between ep-groupoids defines the natural bijections 
\begin{align*}
\Phi_\ast&\colon \text{Faces}_X\to \text{Faces}_{Y}\colon\quad \Phi_\ast(F)=\text{saturation}(\Phi (F))\\
\Phi^\ast&\colon \text{Faces}_Y\to \text{Faces}_{X}\colon\quad \Phi^\ast(G)=\Phi^{-1} (G))
\end{align*}
and $\Phi^\ast =(\Phi_\ast)^{-1}$. Moreover, if $X$ is face structured, then also $Y$ is face structured and vice versa.
Consequently, considering a generalized isomorphism
$$[d]=[X\xleftarrow{\Phi}A\xrightarrow{\Psi}Y]$$
we can define the bijections 
\begin{equation*}
[d]_\ast\colon \text{Faces}_X\to \text{Faces}_{Y}\quad \text{and}\quad 
[d]^\ast\colon \text{Faces}_Y\to \text{Faces}_{X}
\end{equation*}
by
\begin{equation*}
[d]_\ast=\Psi_\ast\circ \Phi^\ast\quad \text{and}\quad [d]^\ast=\Phi_\ast\circ \Psi^\ast.
\end{equation*}
They satisfy $[d]^\ast=([d]_\ast)^{-1}.$


\begin{proposition}\index{P- Boundary of face-structured $X$}
If the tame ep-groupoid $X$ is face structured, then each face $F$ has an object set $\text{obj}_F$ which is a sub-M-polyfold of $X$ 
on which the induced structure is tame.  
The same holds for the morphism set $\text{mor}_X$. Equipped with the induced structures the face $F$ is in a natural way
an ep-groupoid. If the intersection of two faces $F$ and $G$ is  nonempty, then it is a face  in $F$ as well as in $G$.
 If $X$ and $Y$ are tame ep-groupoids and $[d]:X\rightarrow Y$ is a generalized  isomorphism, then
$[d]$ induces the  bijection
$$
[d]_\ast\colon \text{Faces}_X\rightarrow{Faces}_Y.
$$
Moreover,  for every face $F$ in $X$ and its corresponding face $G=[d]_\ast (F)$ in $Y$ the generalized isomorphism $[d]$ induces a natural equivalence class
$$
[d]_F:F\rightarrow G
$$
which is a generalized  isomorphism.
\end{proposition}

\begin{proof}
Pick a connected component $\theta^\circ $ in $\{z\in |X|\ |\ d_{|X|}(z)=1\}$ and denote by $\theta$ its closure in $|X|$.
A point $x\in X_\theta$ lies in exactly $d=d_X(x)$-many local faces of the M-polyfold $X$. 
If $x$ would lie in less than $d$-many global faces of the M-polyfold $X$ it would immediately follow
that there are less than $d$-many connected components $\theta_i^\circ$  of $\{z\in |X|\ |\ d_{|X|}(z)=1\}$
with their closures $\theta_i$ in $|X|$ containing $|x|$. 

Let $\theta$ be any face of $|X|$. In view of the previous discussion we find that an object $x\in X_\theta$
lies in precisely one global face $F$ of the M-polyfold $X_\theta$ so that $F\subset X_\theta$. 
The global faces $F$ of the M-polyfold $X$  are closed in the M-polyfold $X$,  and $X_\theta$ consists of a disjoint 
union of these. It has been proved in Theorem \ref{FACE_XX} that $F$ is a sub-M-polyfold with an induced tame structure.
Since $X_\theta$ is a disjoint union of such $F$ we see that the object space $X_\theta$ is a sub-M-polyfold
and consequently the associated full subcategory is an ep-groupoid.

If $[d]:X\rightarrow Y$ is a generalized  isomorphism  between the tame ep-groupoids $X$ and $Y$, then it is represented by a diagram 
$$
X\xleftarrow{\Phi}A\xrightarrow{\Psi} Y
$$
in which $\Phi$ and $\Psi$ are equivalences.  If $\theta^\circ$ is a connected component of $\{z\in |X|\ |\ d_{|X|}(z)=1\}$ it follows for the homeomorphism
$|[d]|:|X|\rightarrow |Y|$ that the image 
$|[d]|(\theta^\circ)$ is a connected component of $\{q\in |Y|\ |\ d_{|Y|}(q)=1\}$. Since $|[d]|$ is a homeomorphism 
$$
\cl_{|Y|}([d](\theta^\circ)) =|[d]|(\theta)
$$
We therefore define
$$
[d]_\ast X_\theta =Y_{|[d]|(\theta)}\ \ \text{and}\ \  [d]^\ast Y_{\theta'}= X_{|[d]|^{-1}(\theta')}.
$$
Clear $[d]_\ast$ and $[d]^\ast$ are mutually inverse to each other.

Alternatively, if $F$ is a face of $X$ one verifies easily that  $B=\Phi^{-1}(F)$ is a face of $A$ and in turn the saturation $C$ of $\Psi(B)$  is a face of $Y$.
In  other words,  there are  natural bijections between the faces of $A$ and those of $X$ and $Y$. Also it is clear by the above construction, that the restrictions of $\Phi$ and $\Psi$ define 
the diagram
\begin{equation}\label{walter_}
F\xleftarrow{\Phi\vert B} B\xrightarrow{\Psi\vert B} C.
\end{equation}
The equivalence class  $[e]:=[d]\vert F$ of this diagram is a generalized  isomorphism $F\rightarrow C$ by Theorem \ref{strong-iso}. Indeed,  the restricted functors in \eqref{walter_} are essentially surjective,
full and faithful and local sc-diffeomorphism, and hence equivalences by 
Lemma \ref{equivalence_in_the sense_of_category_theory}.
\qed \end{proof}

\begin{remark}\label{REM1116}\index{R- Face-structured and generalized isomorphisms}
The reader should note the following. Assume that $X$ and $Y$ are ep-groupoids and $\mathfrak{f}:X\rightarrow Y$
is a generalized isomorphism. If one these ep-groupoids is tame and face-structured the same holds for the other one.
\qed
\end{remark}


The following somewhat stronger result holds true.
\begin{proposition}\index{P- Correspondence of faces}
Let $X$ and $Y$ be tame face-structured ep-groupoids and $\mathfrak{f},\mathfrak{g}:X\rightarrow Y$ two generalized isomorphisms
satisfying $|\mathfrak{f}|=|\mathfrak{g}|$.
Then the induced bijections between the collection of faces are the same, i.e. $\mathfrak{f}_\ast=\mathfrak{g}_\ast$.
Further, the induced generalized isomorphisms $F\rightarrow \mathfrak{f}_\ast F$  and $G\rightarrow \mathfrak{f}_\ast G$ induce the same map $\abs{F}\to \abs{\mathfrak{f}_\ast F}$ on the orbit spaces.
\end{proposition}
\begin{proof}
This follows from the previous discussion.
\qed \end{proof}

\section{Sc-Differential Forms and Equivalences}
We next investigate the behavior of sc-differential forms on ep-groupoids (introduced in Section 
\ref{SECT82}) under equivalences. The main result in this section is the following 
theorem. 

 \begin{theorem}\label{OOmaine}\index{T- Generalized sc-smooth maps and forms}
 We assume that $\mathfrak{f}\colon X\rightarrow Y$ is a generalized sc-smooth map between ep-groupoids, and that $\mathfrak{h},\mathfrak{k}\colon X\rightarrow Y$
 are two sc-smooth generalized isomorphisms. Then the following holds.
 \begin{itemize}
 \item[{\em (1)}]\ $d\colon \Omega^{\ast}_{ep,\infty}(X)\rightarrow \Omega^{\ast}_{ep,\infty}(X)$ and $d\circ d=0$.
\item[{\em (2)}]\ There is a well-defined operation of pull-back $\mathfrak{f}^\ast\colon \Omega^{\ast}_{ep,\infty}(Y)\rightarrow \Omega^{\ast}_{ep,\infty}(X)$
 such that $d_X\circ \mathfrak{f}^\ast = \mathfrak{f}^\ast \circ d_Y$.
 \item[{\em (3)}]\ For the generalized isomorphism $\mathfrak{h}\colon X\to Y$ there is a well-defined push-forward $\mathfrak{h}_\ast\colon \Omega^{\ast}_{ep,\infty}(X)\rightarrow \Omega^{\ast}_{ep,\infty}(Y)$ satisfying $\mathfrak{h}_\ast\circ d_X=d_Y\circ \mathfrak{h}_\ast$. Moreover, with the pull-back $\mathfrak{h}^\ast$  we have that $\mathfrak{h}_\ast\circ \mathfrak{h}^\ast =Id$ and $\mathfrak{h}^\ast\circ \mathfrak{h}_\ast=Id$.
 \item[{\em (4)}]\ If the generalized isomorphisms $\mathfrak{h}$ and $\mathfrak{k}$ induce the same  maps between orbit spaces,  so that  $|\mathfrak{h}|=|\mathfrak{k}|$, then $\mathfrak{h}_\ast=\mathfrak{k}_\ast$ and $\mathfrak{h}^\ast=\mathfrak{g}^\ast$.
 \end{itemize}
 \qed
 \end{theorem}
For statement  (1) we refer to Section 
\ref{SECT82}.  The other statements  of the  theorem will follow from several results of independent interest, where we make precise
how $\mathfrak{f}^\ast$ and $\mathfrak{h}_\ast$ are defined. We recall that the generalized map $\mathfrak{f}:X\rightarrow Y$ is an equivalence class
of diagrams 
 $$
 X\xleftarrow{F} A\xrightarrow{\Phi}Y
 $$
in which  $F$ is an equivalence of ep-groupoids and $\Phi$ a sc-smooth functor.
The generalized isomorphism is given by the same  diagram in which, however,  $\Phi$ is also an equivalence.
 
 \begin{lemma}\label{differential_form_1}\index{L- Differential forms {I}}
 We consider an equivalence 
$F:X\rightarrow Y$   between ep-groupoids and a  sc-differential form
$\omega$   on $X$.  Given $y\in Y_1$ and $h_1,\ldots,h_k\in T_yY$, we let  $\psi$ and $\psi'\in {\bm{Y}}_1$
be two morphisms  satisfying $\psi:F(x)\rightarrow y$ and $\psi'\colon F(x')\rightarrow y$ for $x$ and $x'\in X_1$.
If $l_1,\ldots ,l_k\in T_xX$ and $l_1',\ldots ,l_k'\in T_{x'}X$
satisfy
\begin{equation}\label{diff_sc_forms}
T\psi(TF(x)l_j )=h_j=T\psi'(TF(x')l_j'),
\end{equation}
then 
$$
 \omega_x(l_1,\ldots,l_k)=\omega_{x'}(l_1',\ldots,l_k').
 $$
 \end{lemma}
 \begin{proof}
 We start with the morphism
 $$
\tau:= \psi^{-1}\circ\psi'\colon F(x')\rightarrow F(x)
 $$
in ${\bm{Y}}_1$. Its linearization at $x'$ satisfies, in view of the assumption \eqref{diff_sc_forms}, 
 \begin{equation}\label{oip}
 T \tau(TF(x')l_j') = TF(x)l_j
 \end{equation}
 for all $j=1,\ldots ,k$.
  Since $F$ is an equivalence there exists a uniquely determined morphism $\sigma\colon x'\rightarrow x$ satisfying
 $$
 F(\sigma)= \tau.
 $$
This implies  $\sigma\in {\bm{X}}_1$ since $\tau\in {\bm{Y}}_1$. In order to relate $T\sigma$ and $T\tau$ we    take,  for suitable open neighborhoods, 
 the sc-diffeomorphisms 
 $s_X\colon {\bm{U}}(\sigma)\rightarrow U(x')$ and $t_X\colon {\bm{U}}(\sigma)\rightarrow U(x)$ and recall the  definition of $T\sigma$,
$$
T\sigma = T(t_X\circ (s_X|U(\sigma))^{-1})(x').
$$
By the functoriality of $F$, 
\begin{equation*}
\begin{split}
F(t_X\circ (s_X|U(\sigma))^{-1}(q))
 =t_Y\circ F((s_X|U(\sigma))^{-1}(q))
 =t_Y\circ (s_Y|U(\tau))^{-1}(F(q)).
 \end{split}
 \end{equation*}
Taking the derivative in $q$ at $q=x'$ leads to 
$$
TF(x)\circ T\sigma = T\tau\circ TF(x').
$$
Consequently, in view of \eqref{oip},
$$
TF(x)l_j = T \tau(TF(x')l_j') = TF(x)(T\sigma l_j').
$$
This implies, since $TF(x)\colon T_xX\to T_{F(x)}Y$ is an isomorphism,  that
$$
l_j=T\sigma l_j'\quad \text{for all $ j$.}
$$
Therefore, using the compatibility of sc-differential forms with morphisms, 
$$
\omega_x(l_1,\ldots,l_k)=\omega_x(T\sigma l_1',\ldots,T\sigma l_k')=\omega_{x'}(l_1',\ldots,l_k'),
$$
as claimed in Lemma 
\ref{differential_form_1}.
 \qed \end{proof}
 Lemma \ref{differential_form_1} allows to define the push-forward $F_\ast\omega\in \Omega_{ep,\infty}(X)$ under an equivalence $F\colon X\to Y$.
 \begin{definition}\label{d_push_forward}\index{D- Push-forward of forms}
The {\bf push-forward}\index{D- Push-forward of sc-differential form} of the sc-differential form $\omega\in \Omega^k_{ep,\infty}(X)$ by an equivalence  $F\colon X\rightarrow Y$ between ep-groupoids, denoted by $$F_\ast\omega\in \Omega^k_{ep,\infty}(Y),$$ is defined as follows.
If $y\in Y_1$ and $h_1,\ldots, h_k\in T_yY$, we  take $x\in X_1$ (using that $F$ is essentially surjective) such  that there is a morphism $\psi\colon F(x)\rightarrow y$. Then we take  
 $l_j\in T_xX$ satisfying $h_j=T\psi(TF(x)l_j)$,  and define
 $$
 (F_\ast\omega)_y(h_1,\ldots ,h_k)=\omega_x(l_1,\ldots ,l_k).
 $$
\qed
 \end{definition}
 In view of Lemma \ref{differential_form_1} this is well-defined and independent of the choice of the morphism $\psi$.
 In order to see that the push-forward  form $F_\ast \omega$ on $Y$ as defined above is sc-smooth, we recall that the equivalence $F\colon X\to Y$ is, by definition, locally a sc-diffeomorphism. Moreover, the morphism $\psi\colon F(x)\to y$ has a unique sc-smooth extension $\wh{\psi}$ to a sc-diffeomorphism between properly chosen open neighborhoods 
$U(F(x))=F(U(x))$ and $U(y)$ in $Y$
$$
\wh{\psi}:U(F(x))\rightarrow U(y).
$$
 The composition  $\wh{\psi}\circ F\colon U(x)\to U(y)$ is a sc-diffeomorphism satisfying $(\wh{\psi}\circ F)(x)=y$. Hence the push-forward of the sc-smooth form 
$\omega$ on $X$ by the equivalence $F\colon X\to Y$ is the pull-pack of the form $\omega$ by the sc-diffeomorphism 
$(\wh{\psi}\circ F)^{-1}\colon U(y)\to U(x)$,
\begin{equation}\label{push-forward_eq1}
F_\ast \omega=\bigl((\wh{\psi}\circ F)^{-1}\bigl)^\ast \omega.
\end{equation}
This shows sc-smoothness.
We also note that  standard arguments now imply that 
\begin{equation}\label{push-forward_eq2}
d_Y(F_\ast \omega)=F_\ast (d_X\omega).
\end{equation}

 \begin{lemma}\label{equivalence_forms}\index{C- Equivalences and forms}
Assume that $F:X\rightarrow Y$ and $G:Y\rightarrow Z$ are equivalences between ep-groupoids.
Then 
\begin{itemize}
\item[{\em (1)}]\ $(G\circ F)^\ast \omega =F^\ast \circ G^\ast\omega$.
\item[{\em (2)}]\ $(G\circ F)_\ast\omega = G_\ast \circ F_\ast\omega$
\item[{\em (3)}]\ $F_\ast \circ F^\ast \omega=\omega\quad  \text{and}\quad  F^\ast \circ F_\ast\tau=\tau.$
\end{itemize}
\end{lemma}
\begin{proof} The well-known formula (1) is an immediate consequence of the definition of the pull-back of a form $\omega$ on $Y$, which is the form $F^\ast\omega$ on $X$ given by
$$(F^\ast \omega)_x(k_1,\ldots, k_n)=\omega_{F(x)}(TF(x)k_1,\ldots, TF(x)k_n).$$
The statements (2)  and (3) will  follow from 
Definition \ref{d_push_forward}, the properties of equivalences and the invariance of the forms.

We consider the sc-form $\omega$ on $X$ and fix $z\in Z_1$ and $h_1,\ldots ,h_k\in T_zZ$. The composition $G\circ F\colon X\to Z$ is an equivalence and hence essentially surjective. Therefore,  there exist $x\in X_1$ and a morphism $\psi\colon G\circ F(x)\to z$ in ${\bm{Z}}_1$. Taking the unique solutions $l_j$ of 
$T\psi\circ T(G\circ F)(x)l_j=h_j$, we obtain, by definition, 
$$
((G\circ F)_\ast\omega)_z(h_1,\ldots ,h_k)=\omega_x(l_1,\ldots ,l_k).$$
On the other hand, if $y=F(x)$, we have the morphism $\psi\colon G(y)\to z$ and taking the solutions $T\psi\circ TG(y)l_j'=h_j$ which are equal to $l_j'=TF(x)l_j$ we obtain, by definition,
$$
(G_\ast (F_\ast \omega))_z(h_1,\ldots ,h_k)=(F_\ast \omega)_y(TF(x)l_1,\ldots ,(TF(x)l_k).$$
Since $y=F(x)$, we have the $1$- morphism $1_y\colon y\to y$ in ${\bm{Y}}$ whose linearization is the identity map and get for the solution of 
$TF(x)l_j'=TF(x)l_j$, which is given by $l_j'=l_j$, again by definition,
$$
(F_\ast \omega)_y(TF(x)l_1,\ldots , TF(x) l_k)=\omega_x(l_1,\ldots ,l_k).
$$
We have verified that $G_\ast (F_\ast\omega)=(G\circ F)_\ast \omega$.

In order to verify $F_\ast \circ F^\ast \omega=\omega$ for forms  $\omega$ on $Y$, we fix $y\in Y$ and $h_1,\ldots, h_k\in T_yY$, find $x \in X$ and a morphism $\phi\colon F(x)\to y$ in ${\bm{Y}}$. With the solution $l_j$ of $T\phi\circ  TF(x)l_j=h_j$ we get 
\begin{equation*}
\begin{split}
(F_\ast(F^\ast \omega))_y(h_1, \ldots ,h_k)&=(F^\ast \omega)_x(l_1,\ldots ,l_k)\\
&=(F^\ast \omega)_{F(x)}(TF(x)l_1,\ldots ,TF(x)l_k)\\
&=\omega_y (h_1,\ldots ,k_k),
\end{split}
\end{equation*}
where we have used that 
$l_j=(TF(x))^{-1}\circ (T\phi)^{-1}h_j$ and also have used the invariance of $F^\ast \omega$ under morphisms. The second formula in (3) is verified the same way and the proof of Lemma \ref{equivalence_forms} is complete. 
\qed \end{proof}



Next we study the compatibility with natural equivalences.
 \begin{lemma}\label{Goddard}\index{L- Differential forms {II}}
Let $F,G\colon X\rightarrow Y$ be equivalences between ep-groupoids which are naturally equivalent by the natural transformation
$$
\tau\colon F\rightarrow G.
$$
If $\omega$ is a sc-differential form on $X$ and $\omega'$ a sc-differential form on $Y$, then
$$
F_\ast\omega =G_\ast\omega\quad  \text{and}\quad  \ F^\ast\omega'= G^\ast\omega'.
$$
 If $\Phi,\Psi:X\rightarrow Y$ are sc-smooth functors which are naturally equivalent,
then $\Psi^\ast\omega=\Phi^\ast\omega$.
\end{lemma}
 \begin{proof}
 By assumption,  $\tau:X\rightarrow {\bm{Y}}$ is a sc-smooth map associating with every $x\in X$ the morphism
 $$
\tau(x)\colon  F(x)\rightarrow G(x)
 $$
such that  for every morphism $\phi\colon x\rightarrow x'$ in ${\bm{X}}$, the diagram 
 $$
 \begin{CD}
 F(x)@>\tau(x)>> G(x)\\
 @V F(\phi)VV @V G(\phi)VV\\
 F(x')@>\tau(x') >> G(x')
 \end{CD}
 $$
 is commutative.
 We choose $h_1,\ldots, h_k\in T_yY$. We take  $\psi\colon F(x)\rightarrow y$ and $\psi'\colon G(x')\rightarrow y$ which have to be on level $1$ 
 and take  $l_1,\ldots,l_k\in T_xX$ solving  $T\psi\circ TF(x)l_j=h_j$ and similarly take $l_j'$ in $T_{x'}X$ satisfying  $T\psi'\circ TG(x')l_j'=h_j$.
 By definition, 
 $$
 F_\ast\omega(h_1,\ldots ,h_k)=\omega(l_1,\ldots,l_k)\quad \text{and}\quad G_\ast\omega(h_1,\ldots,h_k)=\omega(l_1',\ldots,l_k').
 $$
Recalling the morphism $\tau(x):F(x)\rightarrow G(x)$, we consider the composition
 $$
 G(x')\xrightarrow{\psi'}y\xrightarrow{\psi^{-1}} F(x)\xrightarrow{\tau(x)} G(x).
 $$
 Since $y$ is on level $1$,  this is true for the data above as well. The functor  $G$ is an equivalence, hence  we find a morphism
 $
 \sigma\colon x'\rightarrow x
 $
 satisfying  $G(\sigma)= \tau(x)\circ\psi^{-1}\circ \psi'$. A computation, similar to that in the previous lemma, leads to 
 $$
 T\sigma(l_j')=l_j
 $$
 which implies that 
 $$
 \omega_x(l_1,\ldots,l_k)=\omega_{x'}(l_1',\ldots,l_k').
 $$
Consequently,  $(F_\ast\omega)_y(h_1,\ldots,h_k)=(G_\ast\omega)_y(h_1,\ldots,h_k)$  proving the statement for the push-forward. 
 
 For the pull-back we start again with  the morphism
 $$
\tau(x)\colon  F(x)\rightarrow G(x)\quad \text{in ${\bm{Y}}$}, 
 $$
so that  $F(x)=s(\tau(x))$ and $G(x)=t(\tau(x))$ for all $x\in X$. We choose suitable open neighborhoods such  $s:{\bm{U}}(\tau(x))\rightarrow U(F(x))$ is a sc-diffeomorphism. Then 
 $$
 t\circ (s\vert {\bm{U}}(\tau(x)))^{-1}\circ F(q) = G(q).
 $$
We differentiate at $q=x$ which we assume to be on level $1$ and, abbreviating $\phi=\tau(x)$, we obtain
 $$
 TG(x) = T\phi\circ TF(x).
 $$
 By the compatibility of the sc-differential form $\omega$ on $Y$ with morphisms we conclude,
  \begin{equation*}
  \begin{split}
G^\ast \omega(h_1,\ldots, h_k)&= \omega(TG(x)h_1,\ldots,TG(x)h_k)\\&=\omega(T\phi\circ TF(x)h_1,\circ ,T\phi\circ TF(x)h_k)\\
 &=\omega(TF(x)h_1,\ldots,TF(x)h_k)=F^\ast \omega(h_1,\ldots, h_k).
 \end{split}
\end{equation*}
 This proves the assertion about the pull-backs.  Note that we did not use %
 the fact that $F$ and $G$ are equivalences.
 Hence we can apply the same idea to the natural transformation $\tau:\Phi\rightarrow\Psi$ in order to complete the proof of Lemma \ref{Goddard}.
\qed \end{proof}
 
 
 
 
\begin{lemma}\label{compatibilityyy}\index{C- Pull-back of forms}
We consider two diagrams $d\colon X\xleftarrow{F} A\xrightarrow{G}Y$  and $d'\colon X\xleftarrow{F'} A'\xrightarrow{G'}Y$, in which $F$ and $F'$ are equivalences and $G, G'$ are sc-smooth functors between ep-groupoids, and assume  
that  $H:A'\rightarrow A$ is an equivalence, as illustrated in the diagram

\begin{equation*}
\begin{CD}
d:X@<F<<A@>G>>Y\\
@. @AAHA @. \\
d':X@<F'<<A'@>G'>>Y.\\ 
\end{CD}
\end{equation*}
\mbox{}\\[1ex]
If $F\circ H\simeq F'$ (naturally equivalent) and $G\circ H\simeq G'$, then 
$$
F_\ast \circ G^\ast\omega' = (F')_{\ast} \circ (G')^{\ast}\omega'.
$$
for every sc-differential form $\omega'$ on $Y$.
If, in addition, $G$ and $G'$ are equivalences, then 
$$G_\ast \circ F^\ast\omega = (G')_{\ast} \circ (F')^{\ast}\omega$$
for every sc-differential form $\omega$ on $X$.
\end{lemma}
\begin{proof} Recalling that the composition of equivalences is an equivalence, and using Lemma \ref{differential_form_1} and Lemma \ref{d_push_forward} we compute,
\begin{equation*}
\begin{split}
{F'}_\ast \circ (G')^\ast\omega &=(F\circ H)_\ast \circ (G')^\ast\omega\\
&=F_\ast \circ H_\ast  \circ (G\circ H)^\ast\omega\\
&= F_\ast \circ H_\ast \circ H^\ast \circ G^\ast\omega\\
&= F_\ast \circ  G^\ast\omega.
\end{split}
\end{equation*}
The second part is proved the same way.
 \qed \end{proof}
We recall that two diagrams in the equivalence class $[d]=[X\xleftarrow{F}A\xrightarrow{G}Y]$, in which $F$ is an equivalence and $G$ a sc-smooth functor between ep-groupoids, are equivalent if they possess a common refinement. Therefore, we are able, in view of the previous lemma, to introduce the pull-back $[d]^\ast \omega$ 
for generalized maps $[d]\colon X\to Y$ and the push-forward $[d]_\ast\omega$ for generalized isomorphisms $[d]\colon X\to Y$ between ep-groupoids.
\begin{definition}[{\bf Pull-back, push-forward by generalized maps}]
If $[d]=[X\xleftarrow{F}A\xrightarrow{G}Y]\colon X\to Y$ is a generalized map between ep-groupoids then the {\bf pull-back} $[d]^\ast\omega'$ of a  
sc-differential form $\omega'$ on $Y$ is the sc-differential form on $X$,  defined by 
$$[d]^\ast\omega'=F_\ast\circ G^\ast \omega'\in \Omega_{\textrm{ep},\infty}(X).$$ 
If $[d]=[X\xleftarrow{F}A\xrightarrow{G}Y]\colon X\to Y$ is a generalized 
isomorphism (i.e., both $F$ and $G$ are equivalences), the {\bf push-forward} $[d]_\ast\omega$ of a sc-differential form
 $\omega$ on $X$ is the sc-differential form on $Y$,  defined by 
$$[d]_\ast\omega=G_\ast\circ F^\ast \omega\in \Omega_{\textrm{ep},\infty}(Y).$$ 
\qed
\end{definition}
In view of Lemma \ref{compatibilityyy} the push-forward and the pull-back by generalized isomorphism are well-defined, i.e., independent of the choice of the diagram representing the equivalence class $[d]$.

With Definition \ref{differential_form_1}, the statements (2) and (3) of Theorem \ref{OOmaine} now follow from Lemma \ref{differential_form_1} and Lemma \ref{equivalence_forms}.

The proof of the  statement (4) in Theorem \ref{OOmaine} requires a preparation.
 \begin{proposition}\label{dependence_on_F}\index{P- Dependence on $F$}
We assume that $F,G:X\rightarrow Y$ are equivalences between ep-groupoids satisfying $|F|=|G|\colon \abs{X}\to \abs{Y}$.
 Then for  the  sc-differential forms $\omega$ on $X$ and $\omega'$ on $Y$ we have  the identities  
 $$
 F_\ast\omega=G_\ast\omega\ \text{and}\ \ F^\ast\omega'=G^\ast\omega'.
 $$
 \end{proposition}
 \begin{proof}
 Since $|F|=|G|$,  Proposition \ref{prop4.14} implies for every $x\in X_1$ that 
 there exists a morphism $\psi\colon F(x)\rightarrow G(x)$ satisfying
 $$
 T\psi(TF(x)h)=TG(x)h\quad  \text{for all}\quad  h\in T_xX.
 $$
 If $\omega'$ is a sc-differential form on $Y$,  we compute, using 
 $\omega'_{G(x)}\circ (T\psi\oplus\ldots \oplus T\psi)=\omega_{F(x)}'$, 
 \begin{equation*}
 \begin{split}
(G^\ast\omega')_x(h_1,\ldots,h_k)
&=\omega'_{G(x)}(TG(x)h_1,\ldots,TG(x)h_k)\\
&=\omega'_{G(x)}(T\psi(TF(x)h_1),\ldots,T\psi(TF(x)h_k))\\
&=\omega'_{F(x)}(TF(x)h_1,\ldots,TF(x)h_k)\\
&=(F^\ast\omega')_x(h_1,\ldots,h_k).
\end{split}
\end{equation*}
Therefore,
$$
G^\ast\omega'=F^\ast\omega'.
$$
Next we investigate the 
push-forward.
We consider $F_\ast\omega$ and $G_\ast\omega$ and fix  $y\in Y_1$.
For $h_1,\ldots,h_k\in T_yY$ we compute $F_\ast\omega$ by taking  $x\in X_1$ and a morphism $\phi\in {\bm{Y}}_1$ such that
$\phi:F(x)\rightarrow y$. Then we take the solutions  $l_1,\ldots, l_k\in T_xX$ of  $T\phi(TF(x)l_j)=h_j$, and  obtain, by definition, 
$$
\omega_x(l_1,\ldots ,l_k)=:(F_\ast\omega)_y(h_1,\ldots,h_k).
$$
The definition for $G$ is similar. 
Recalling the morphism 
$\psi\colon F(x)\to G(x)$, we introduce  the morphism  
$$\phi':=\phi\circ \psi^{-1}\colon G(x)\to y$$
 and take 
$l_j'\in T_{x'}X$ satisfying  $T\phi'(TG(x)l_j')=h_j$. Then,   by definition, 
$$
\omega_{x}(l_1',\ldots,l_k')=:(G_\ast\omega)_y(h_1,\ldots,h_k).
$$
By construction,
$
T\phi(TF(x)l_j)=T\phi'(TG(x)l_j'
$
or equivalently,
$$
TF(x)l_j = T(\phi^{-1}\circ\phi')(TG(x)l_j').
$$
By Proposition \ref{prop4.14} there exists a morphism
$\sigma\colon F(x)\rightarrow G(x)$ such that 
$$
T\sigma\circ TF(x)h=TG(x)h\quad \text{for all $h\in T_xX$}.
$$
Hence
$$
TG(x)l_j=T\sigma\circ TF(x)l_j= T\sigma \circ T(\phi^{-1}\circ\phi')(TG(x)l_j')
$$
for all $j$. Since  $\sigma\circ \phi^{-1}\circ\phi'\colon G(x)\rightarrow G(x)$ 
in ${\bm{Y}}$ and since $G$ is an equivalence
there exists a unique morphism 
$\tau\colon x\rightarrow x$ satisfying 
$$
G(\tau)=\sigma\circ \phi^{-1}\circ\phi'.
$$
We consider the germs $t_Y\circ (s_Y\vert {\bm{U}}(\sigma\circ \phi^{-1}\circ\phi'))^{-1}$ and $t_X\circ (s_X\vert {\bm{U}}(\tau))^{-1}$. 
Because  $G$ is an equivalence we must have  the relationship 
$$
t_Y\circ (s_Y\vert {\bm{U}}(\sigma\circ \phi^{-1}\circ\phi'))^{-1}\circ G(b) = G(t_X\circ (s_X\vert {\bm{U}}(\tau))^{-1}(b))
$$
for $b$ near $x$. Differentiating in $b$ at $b=x$  leads to 
$$
T(\sigma\circ \phi^{-1}\circ\phi')\circ TG(x)h= TG(x)T\tau(h)
$$
for all $h\in T_xX$. In view of \eqref{oip} we arrive at
$
TG(x)l_j = TG(x)\circ T\tau(l_j')
$ for all $j$. Since $TG(x)$ is an isomorphism,  
$$
l_j= T\tau(l_j')\quad  \text{for all $j=1,\ldots ,k$.}
$$
From the compatibility of $\omega$ with morphisms we  conclude
$$
\omega(l_1,\ldots ,l_k)=\omega(T\tau l_1',\ldots ,T\tau l_k')=\omega(l_1',\ldots ,l_k'),
$$
which implies the desired equality
$
F_\ast\omega=G_\ast\omega.
$
The proof of Proposition \ref{dependence_on_F} is complete.
 \qed \end{proof}
 
 

 \begin{proposition}\label{dependence_f_ast}\index{C- Dependence of $\mathfrak{f}_{\ast}$}\index{C- Dependence of $\mathfrak{f}^{\ast}$}
 Assume that $\mathfrak{f},\mathfrak{g}:X\rightarrow Y$ are sc-smooth generalized isomorphism satisfying $|\mathfrak{f}|=|\mathfrak{g}|$.
 Then 
 $$\text{$\mathfrak{f}_\ast=\mathfrak{g}_\ast$\quad   and \quad $\mathfrak{f}^\ast=\mathfrak{g}^\ast$}.$$
 \end{proposition}
 \begin{proof}
 Let $\mathfrak{f}=[X\xleftarrow{F}A\xrightarrow{G}Y]$ and 
$\mathfrak{g}=[X\xleftarrow{F'}A'\xrightarrow{G'}Y]$. We consider the two equivalences 
$F\colon A\to X$ and $F'\colon A'\to X$.
According to Theorem \ref{modified_weak_fibered_product}, the associated weak fibered  
 product $A\times_X A'$ is an ep-groupoid and the two functors
 $$F\circ \pi_A,F'\circ \pi_{A'}\colon 
A\times_X A'\to X$$
are naturally equivalent. Moreover,
the functors 
$\pi_A\colon A\times_XA'\to A$ and 
$\pi_{A'}\colon A\times_XA'\to A'$ are equivalences. Hence the compositions $F\circ \pi_A$ and $F'\circ \pi_{A'}$ are equivalences.
Since two equivalences between ep-groupoids which are naturally equivalent induce the same maps on the orbit spaces, we have 
\begin{equation}\label{equation2.33}
\abs{F\circ \pi_A}=
\abs{F'\circ \pi_{A'}}\colon \abs{A\times_XA'}\to \abs{X}.
\end{equation}
In addition, in view of Lemma \ref{equivalence_forms},
$$(F\circ \pi_A)^\ast=(F'\circ \pi_{A'})^\ast.$$
Using  that $(\pi_A)_\ast\circ (\pi_A)^\ast=Id$, by Lemma \ref{equivalence_forms} (3), we compute for a given sc-differential form $\omega$ on $X$,
\begin{equation}\label{equation2.34}
\begin{split}
G_\ast \circ F^\ast \omega&=
G_\ast \circ (\pi_A)_\ast\circ (\pi_A)^\ast\circ F^\ast \omega\\
&=(G \circ \pi_A)_\ast\circ (F\circ \pi_A)^\ast\omega\\
&=(G \circ \pi_A)_\ast\circ (F'\circ \pi_{A'})^\ast\omega.
\end{split}
\end{equation}
Considering now $G'\circ \pi_{A'}$, we use the assumption that 
$|G|\circ |F|^{-1}= |G'|\circ |F'|^{-1}$, use \eqref{equation2.33}
and compute,
\begin{equation*}
\begin{split}
\abs{G'\circ \pi_{A'}}&=\abs{G'}\circ \abs{\pi_{A'}}\\
&=\abs{G}\circ \abs{F}^{-1}\circ \abs{F'}\circ \abs{\pi_{A'}}\\
&=\abs{G}\circ \abs{F}^{-1}\circ \abs{F'\circ\pi_{A'}}\\
&=\abs{G}\circ \abs{F}^{-1}\circ \abs{F\circ \pi_{A}}\\
&=\abs{G}\circ \abs{F}^{-1}\circ \abs{F}\circ \abs{\pi_{A}}\\
&=\abs{G\circ \pi_A}.
\end{split}
\end{equation*}
Consequently, we can apply Proposition \ref{dependence_on_F} and obtain using \eqref{equation2.34}, Lemma \ref{equivalence_forms} and Lemma \ref{differential_form_1},
\begin{equation*}
\begin{split}
G_\ast F^\ast\omega&= (G\circ \pi_A)_\ast \circ (F'\circ\pi_{A'})^\ast\omega\\
&=(G'\circ\pi_{A'})_\ast \circ (F'\circ\pi_{A'})^\ast\omega\\
&=(G')_\ast \circ (\pi_{A'})_\ast \circ (\pi_{A'})^\ast \circ (F')^\ast\omega\\
& = (G')_\ast \circ (F')^\ast\omega.
\end{split}
\end{equation*}
We have verified the first assertion of Proposition \ref{dependence_f_ast}. The  second assertion is proved the same way and the proof of Proposition \ref{dependence_f_ast} is complete.
  \qed \end{proof}
 With Proposition \ref{dependence_f_ast} also the last statement (4) in Theorem \ref{OOmaine} is verified, so that the proof of Theorem \ref{OOmaine} is  finally complete.\hfill \qed
 
 
   \section{Branched Ep\texorpdfstring{$^+$}{Ep}-Subgroupoids and Equivalences}
 
   We shall study the behavior of branched ep$^+$subgroupoid under equivalences and generalized isomorphisms.
  We begin with a categorical definition.
   \begin{definition}\index{D- Pushforward and Pullback of $\Theta$}
   Let $F:X\rightarrow Y$ be an equivalence between ep-groupoids and $\Theta:X\rightarrow{\mathbb Q}^+$ and $\Theta':Y\rightarrow {\mathbb Q}^+$  just functors
   \begin{itemize}
   \item[(1)]\ The {\bf pullback} $F^\ast\Theta':X\rightarrow {\mathbb Q}^+$ is defined by $F^\ast\Theta' :=\Theta'\circ F$.
   \item[(2)]\ The {\bf push-forward} $F_\ast\Theta:X'\rightarrow {\mathbb Q}^+$ is defined as follows. For $y\in Y$ pick
   $x\in X$ and $\psi\in \bm{Y}$ with $s(\psi)=F(x)$ and $t(\psi)=y$. Then set $(F_\ast\Theta)(y):=\Theta(x)$.
   \end{itemize}
   \end{definition}
   Clearly the pull-back is well-defined as a functor, but the push-forward might depend on the choices involved.
   \begin{lemma}
  {\em(1)} Let $F:X\rightarrow Y$ be an equivalence and $\Theta:X\rightarrow {\mathbb Q}^+$ a functor 
   Then $F_\ast\Theta$ is well-defined as a functor.  Moreover $F^\ast F_\ast \Theta=\Theta$.
   
   \noindent {\em(2)} Let $\Theta':Y\rightarrow {\mathbb Q}^+$ be a functor.  Then $F_\ast F^\ast\Theta'=\Theta'$.
   
   \noindent{\em(3)} Let $\Theta$ and $\Theta'$ be as in (b) and assume that $F,G:X\rightarrow Y$ are equivalences which are naturally equivalent.
   Then $F_\ast\Theta=G_\ast\Theta$ and $F^\ast\Theta'=G^\ast\Theta'$.
   \end{lemma}
   \begin{proof}
   In order to show that $F_\ast\Theta$ is well-defined, assume that $x,x'\in X$ and $\psi,\psi'\in\bm{Y}$ satisfy
   $$
   \psi:F(x)\rightarrow y\ \ \text{and}\ \ \ \psi':F(x')\rightarrow y.
   $$
   Then $\psi^{-1}\circ\psi':F(x')\rightarrow F(x)$. Since $F$ is an equivalence we find $\sigma:x'\rightarrow x$ satisfying $F(\sigma)=\psi^{-1}\circ\psi'$.
   From this we conclude that
   $$
   \Theta(x)=\Theta(x'),
   $$
   which show that $F_\ast\Theta$ is well-defined.  
    The properties $F_\ast F^\ast\Theta'=\Theta'$ and $F^\ast F_\ast\Theta=\Theta$ are immediate (b) as well 
    as the properties stated in (3).
   \qed \end{proof}
   If $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism, it is represented by a diagram $X\xleftarrow{F}A\xrightarrow{G}Y$,
   where $F$ and $G$ are equivalences. We define $\mathfrak{f}_\ast = G_\ast F^\ast$ and $\mathfrak{f}^\ast = F_\ast G^\ast$ and as we shall see   this is well-defined independent of the diagram we picked to represent $\mathfrak{f}$.
   Indeed, if we have to equivalent diagrams representing $\mathfrak{f}$ there is a common refinement resulting in 
   $$
   \begin{CD}
   X @<F <<  A @>G>> Y\\
   @.   @A H AA  @.\\
   X@<F''<<  A''  @> G''>> Y\\
   @.  @V H'VV  @.\\
   X @<F' <<  A' @> G' >> Y
   \end{CD}
   $$
   Here $F\circ H \simeq F''$, $G\circ H\simeq G''$, $F'\circ H'\simeq F''$, and $G'\circ H'\simeq G''$.
   This implies that 
   \begin{eqnarray*}
   && G_\ast F^\ast\Theta\\
   &=& G_\ast H_\ast H^\ast F^\ast\Theta\\
   &=& G''_\ast F''^\ast \Theta\\
   &=& (G'\circ H')_\ast (F'\circ H')^\ast\Theta\\
   &=& G'_\ast F'^\ast\Theta,
   \end{eqnarray*}
   so that $\mathfrak{f}_\ast\Theta$ is well-defined. Similarly $\mathfrak{f}^\ast\Theta'$ is well-defined.
   It is easily verified that for $\mathfrak{f}:X\rightarrow Y$ and $\mathfrak{g}:Y\rightarrow Z$ we have the properties
   \begin{eqnarray*}
   &(\mathfrak{g}\circ\mathfrak{f})_\ast=\mathfrak{g}_\ast\circ \mathfrak{f}_\ast&\\
   &(\mathfrak{g}\circ\mathfrak{f})^\ast=\mathfrak{f}^\ast\circ \mathfrak{g}^\ast&\\
   &\mathfrak{f}_\ast^{-1}=\mathfrak{f}^\ast&.
   \end{eqnarray*}
   The considerations so far were purely algebraic for arbitrary functors $\Theta$ and $\Theta'$.
   Next we consider $\Theta$ and $\Theta'$ which are branched ep$^+$-subgroupoids.
   As we shall see this property is preserved by the generalized isomorphisms.
   The first basic result in this section is the following theorem.
    \begin{theorem}\label{THM1133}\index{T- Branched ep$^+$-subgroupoids under generalized isomorphisms}
    Let $\mathfrak{f}:X\rightarrow Y$ be a generalized isomorphism between two ep-groupoids. 
    \begin{itemize}
    \item[{\em(1)}]\ If $\Theta:X\rightarrow {\mathbb Q}^+$ is a branched  ep$^+$-subgroupoid then $\mathfrak{f}_\ast\Theta:Y\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid.
    \item[{\em(2)}]\ If If $\Theta':Y\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid then $\mathfrak{f}_\ast\Theta:X\rightarrow {\mathbb Q}^+$ is  a branched ep$^+$-subgroupoid.
    \end{itemize}
    Moreover, the following holds for the maps $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$.
    \begin{itemize}
   \item[{\em (3)}]\  If $\Theta$ and $\Theta'$ are closed, see Definition \ref{DEF915}(i), so are $\mathfrak{f}_\ast\Theta$ and $\mathfrak{f}^\ast\Theta'$.
  \item[{\em (4)}]\  If $\Theta$ and $\Theta'$ are compact, see Definition \ref{DEF915}(ii), so are $\mathfrak{f}_\ast\Theta$ and $\mathfrak{f}^\ast\Theta'$.
  \item[{\em(5)}]\ The maps $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$ also preserve the property of being of manifold-type or orbifold-type, respectively.
  For the definitions see Definition \ref{DEF917}.
  \item[{\em (6)}]\ The maps $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$ also preserve the dimensional decomposition given in Proposition \ref{PROP919}.
   \end{itemize}
    \end{theorem}
   \begin{proof}
   The basic considerations which lead to the desired results are concerned with the behavior of branched 
   ep$^+$-subgroupoids with respect to equivalences $F:X\rightarrow Y$.   
   
   First consider $F^\ast\Theta'= \Theta'\circ F$.  Let $x\in \supp(F^\ast\Theta')$. We find open neighborhoods
   $U(x)$ and $U(F(x))$ so that $F:U(x)\rightarrow U(F(x))$ is an sc-diffeomorphism and $\Theta'$ is represented on $U(F(x))$
   by a local branching structure ${(M_i')}_{i\in I}$ , ${(\sigma_i)}_{i\in I}$, i.e.
   $$
   \Theta'(y)=\sum_{\{i\in I\ |\ y\in M_i'\}}\sigma_i\ \ \text{for}\ \ y\in U(F(x)).
   $$
   Using $F|U(x)$ we can pull back  the $M_i'$, defining $M_i:= (F|U(x))^{-1}(M_i')$. We keep the weights.
   Then 
   $$
   (F^\ast\Theta')(z) = \Theta'\circ F(z)=\sum_{\{i\in I\ |\ z\in M_i\}}\sigma_i\ \ \text{for}\ \ z\in U(x).
   $$
   This shows that $F^\ast\Theta'$ is a branched ep$^+$-subgroupoid.
   
   Next we consider $F_\ast\Theta$. Pick $y\in \supp(F_\ast\Theta)$. We find $x\in\supp(\Theta)$ and a morphism
   $\psi:F(x)\rightarrow y$.  The local sc-diffeomorphism $\wh{\psi}$ between neighborhoods of $F(x)$ and $y$ 
   will map a local branching structure around $F(x)$ to a local branching structure around $y$.
   Since $F$ is a local sc-diffeomorphisms a local branching structure around $x$ is mapped to one around $F(x)$.
   Using $F$ and $\wh{\psi}$ we can map a local branching structure around $x$ for $\Theta$ to one 
   around $y$ for $F_\ast\Theta$.
   
 If $\mathfrak{f}$ is represented  by
 $$
d\colon  X\xleftarrow{F} A\xrightarrow{G} Y
 $$
 then $\mathfrak{f}_\ast \Theta =G_\ast F^\ast\Theta$ which implies that $\mathfrak{f}_\ast\Theta$ is a branched ep$^+$-subgroupoid.
 Similarly for $\mathfrak{f}^\ast\Theta'= F_\ast G^\ast\Theta'$ in view of the previous discussion. This completes the proofs of (1) and (2).
 
 A branched ep$^+$-subgroupoid $\Theta:X\rightarrow {\mathbb Q}^+$ defines a map
 $|\Theta|:|X|\rightarrow {\mathbb Q}^+$ defined by $|\Theta|(|x|):=\Theta(x)$. We note the identity
 $$
 |\mathfrak{f}_\ast\Theta|= |\Theta|\circ |\mathfrak{f}|^{-1}.
 $$
If  $\Sigma:=\{z\in |X|\ |\ |\Theta|(z)>0\}$ is closed or compact, the same holds for $|\mathfrak{f}|(\Sigma)=\{q\in |Y|\ |\ |\mathfrak{f}_\ast\Theta|(q)>0\}$. A similar argument holds for $\mathfrak{f}^\ast\Theta'$.  This proves (3) and (4).

If $\Theta$ or $\Theta'$  only takes the values $0$ and $1$ the same holds for $\mathfrak{f}_\ast\Theta$ and $\mathfrak{f}^\ast\Theta'$.
This proves that $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$ preserve the property of having orbifold-type.
Assume that between two objects $x,x'\in \supp(\Theta)$ there are is at most one morphism.  Let $y,y'\in \supp(\mathfrak{f}_\ast\Theta)$.
If there exist two different morphisms $y\rightarrow y'$ it follows that there exists a nontrivial morphism $\phi':y\rightarrow y$.
If $\psi:F(x)\rightarrow y$. It follows that $\psi\circ\phi'\circ\psi^{-1}:F(x)\rightarrow F(x)$ is a nontrivial isomorphism.
Then $\sigma:x\rightarrow X$ with $F(\sigma)= \psi\circ\phi'\circ\psi^{-1}$ is nontrivial and $x\in \supp(\Theta)$, which gives 
a contradiction. The same argument works for $F^\ast\Theta'$. Hence $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$ preserves
manifold-type.   The point (4) is trivial. This completes the proof of the theorem.
   \qed \end{proof}
   
   
   
   
   Next we consider the behavior of orientations. We begin with a quite algebraic consideration.
   Consider the ep-groupoids $X$ and $Y$ with associated $\pi_X:\wh{\text{Gr}}(X)\rightarrow X_\infty$ and 
   $\pi_Y:\wh{\text{Gr}}(y)\rightarrow Y_\infty$. Denote by $\Gamma(\pi_X)$ and $\Gamma(\pi_X)$ the space of section functors  (no continuity requirement).
   Assume that $F:X\rightarrow Y$ is an equivalence of ep-groupoids. We define maps 
   $$
   F_\ast:\Gamma(\pi_X)\rightarrow \Gamma(\pi_Y)\ \ \text{and}\ \   F^\ast:\Gamma(\pi_Y)\rightarrow \Gamma(\pi_X)
   $$
   as follows.  Given $h\in \Gamma(\pi_X)$ we set  $h'=F_\ast h\in\Gamma(\pi_Y)$ by
\begin{eqnarray}\label{EQN118}
   h'(y)= T\psi \circ TF(x) h(x),
  \end{eqnarray}
   where $\psi:F(x)\rightarrow y$. Since $F$ is an equivalence we find for given $y\in Y_\infty$ such an $x$ and $\psi$. 
   The map $T\psi\circ TF(x):T_xX\rightarrow T_yY$ is a linear sc-isomorphism, which maps the formal finite sum 
   in the obvious way. Since $h$ is functorial and $F$ an equivalence the definition does not depend on the choices involved.
   If $F,G:X\rightarrow Y$ are naturally equivalent functors one immediately deduces that $G_\ast h=F_\ast h$. 
   
   Similarly we can define for $h'\in\Gamma(\pi_Y)$ the element $h=F^\ast h'$ by
\begin{eqnarray}\label{EQN119}
   TF(x) h(x) =h'(F(x)),
\end{eqnarray}
   and again for naturally equivalent $F$ and $G$ it holds that $F^\ast h'=G^\ast h'$.
   
   Next consider a generalized isomorphism $\mathfrak{f}:X\rightarrow Y$. It is represented by an equivalence of diagrams, where the equivalence
   is defined by `common refinement'. From our discussion above it follows immediately that if $\mathfrak{f}$ is represented by 
   a diagram 
   $$
   d\colon X\xleftarrow{F}A\xrightarrow{G} Y.
   $$
   then $\mathfrak{f}_\ast h:= G_\ast F^\ast h$ and $\mathfrak{f}^\ast h':= F_\ast G^\ast h'$ are well-defined and do not depend
   on the specific choice of representative diagram. Hence we have proved.
   \begin{lemma}
   Given a generalized isomorphism $\mathfrak{f}:X\rightarrow Y$ between ep-groupoids
   there are well-defined maps 
   $$
   \mathfrak{f}_\ast:\Gamma(\pi_X)\rightarrow \Gamma(\pi_Y)\ \ \text{and}\ \ \ \mathfrak{f}^\ast:\Gamma(\pi_Y)\rightarrow \Gamma(\pi_X)
   $$
   such hat $\mathfrak{f}_\ast^{-1}=\mathfrak{f}^\ast$.  If $\mathfrak{g}:Y\rightarrow Z$ is another generalized isomorphism
   then $(\mathfrak{g}\circ\mathfrak{f})_\ast=\mathfrak{g}_\ast\circ \mathfrak{f}_\ast$ and $(\mathfrak{g}\circ\mathfrak{f})^\ast=\mathfrak{f}^\ast\circ\mathfrak{g}^\ast$.  If $\mathfrak{f}$ is represented by the diagram
   $$
   d\colon X\xleftarrow{F} A\xrightarrow{G} Y
   $$
   then $\mathfrak{f}_\ast=G_\ast F^\ast$ and $\mathfrak{f}^\ast = F_\ast G^\ast$, where for an equivalence
   the push-forward and pullback are defined by (\ref{EQN118}) and (\ref{EQN119}), respectively.
   \end{lemma}
   
   
   
   
   
   Given an oriented $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ the associated $\wh{\mathsf{T}}_\Theta$ is a section functor
   in $\Gamma(\pi_X)$. If $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism one would like to equip
   the branched ep$^+$-subgroupoid $\mathfrak{f}_\ast\Theta$ with $\mathfrak{f}_\ast \wh{\mathsf{T}}_\Theta\in\Gamma(\pi_Y)$.
   The only thing one needs to check is that it has the local representation property, so that it is indeed an orientation.
  Similarly there is a construction involving $\mathfrak{f}^\ast$.
   Our second main result in this section is the following theorem.
   \begin{theorem}\label{THM1135}\index{T- Transformations of orientation}
   Let $\mathfrak{f}:X\rightarrow Y$ be a generalized isomorphism and $(\Theta,\wh{\mathsf{T}}_\Theta)$ an oriented branched ep$^+$subgroupoid on $X$ 
   and $(\Theta',\wh{\mathsf{T}}_{\Theta'})$ an oriented branched ep$^+$-subgroupoid on $Y$.
   Then $\mathfrak{f}_\ast\wh{\mathsf{T}}_\Theta$ is an orientation for $\mathfrak{f}_\ast\Theta$ and $\mathfrak{f}^\ast\wh{\mathsf{T}}_{\Theta'}$
   an orientation for $\mathfrak{f}^\ast\Theta'$.
     \end{theorem}
   \begin{proof}
   The following arguments show that $\mathfrak{f}_\ast \wh{\mathsf{T}}_\Theta$ and $\mathfrak{f}^\ast\wh{\mathsf{T}}_{\Theta'}$ are locally representable
   by the tangents of oriented local branching structures.
   
    Let $\wh{\mathsf{T}}_\Theta:X_\infty\rightarrow \wh{\text{Gr}}(X)$ be an orientation for $\Theta:X\rightarrow {\mathbb Q}^+$. 
   We already know that $F_\ast\Theta:Y\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid, when $F:X\rightarrow Y$ is an equivalence.
   We define $F_\ast\wh{\mathsf{T}}_\Theta:Y_\infty\rightarrow \wh{\text{Gr}}(Y)$ as follows. For $y\in Y_\infty$ we take $x\in X_\infty$ 
   so that $|F(x)|=|y|$. Pick an isomorphism $\psi:F(x)\rightarrow y$ and pick open neighborhoods $U(x)$, $V(F(x))$, and $V(y)$
   so that
   $$
   F:U(x)\rightarrow V(F(x))\ \ \text{and}\ \ \wh{\psi}:V(F(x))\rightarrow V(y)
   $$
   are sc-diffeomorphisms and $U(x)$ supports an oriented branching structure 
   $$
   {(M_i,o_i)}_{i\in I},\ \ {(\sigma_i)}_{i\in I}
   $$
    representing $\Theta$ and
   $\wh{\mathsf{T}}_\Theta$. We map this data by the sc-diffeo\-mor\-phism   $\wh{\Psi}\circ (F|U(x))$ to obtain
   $(M_i',o_i') := \wh{\psi}\circ F(M_i,o_i)$, and we keep the weights. Then for $z\in V(y)$ we define 
   $$
   (F_\ast\wh{\mathsf{T}}_\Theta)(z)=\sum_{\{i\in I\ |\ z\in M_i\}} \sigma_i\cdot T_z(M_i',o_i').
   $$
 Again this definition involves choices, and we have to show that the definition does not depend on them.  Hence assume $\psi':F(x')\rightarrow y$
 and pick a local branching structure on $U(x')$ representing near $x'$ the oriented $\wh{\Theta}$. We denote it by ${(N_j,o_j)}_{j\in J}$, ${(\tau_j)}_{j\in J}$.
Then $x$ and $x'$ are isomorphic by $\gamma:x'\rightarrow x$ defined by $\psi\circ\gamma=\psi'$.
 We  can map the latter local branching structure  via $\wh{\gamma}$ to a neighborhood 
 of $x$, where it will represent the oriented $\wh{\Theta}$. After perhaps restricting $U(x)$ we  map it via $\wh{\psi}$ and obtain another local branching 
 structure near $y$.  It is clear that near $y$ it defines the same expression. Of course, the result is the same as using $\wh{\psi}'\circ F|U(x')$
 and this shows that $F_\ast\wh{\mathsf{T}}_\Theta$ is well-defined. 
 
  Assume next that $F,G:X\rightarrow Y$ are equivalences which are naturally isomorphic $\tau:F\rightarrow G$. Clearly
 $F_\ast\Theta=G_\ast\Theta$ and by an argument as above we also see that $F_\ast\wh{\mathsf{T}}_\Theta=G_\ast\wh{\mathsf{T}}_\Theta$.
 
 Assume that $\Theta':Y\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid and $F:X\rightarrow Y$ an equivalence. 
 The orientation of $F^\ast\Theta'$ is defined by $F^\ast\wh{\mathsf{T}}_\Theta:X_\infty\rightarrow \wh{\text{Gr}}(X)$ as follows. 
 Given $x\in X_\infty$ we pick open neighborhoods $U(x)$ and $V(F(x))$, so that $F:U(x)\rightarrow V(F(x))$ is an sc-diffeomorphism.
 If $V(y)$ is small enough we take an oriented local branching structure and its preimage. This will define 
 $F^\ast\wh{\mathsf{T}}_\Theta$ over $U(x)_\infty$. Assume that $F,G:X\rightarrow Y$ are equivalences which are naturally equivalent by a natural transformation.
 Clearly $G^\ast\Theta'=F^\ast\Theta'$ and $F^\ast\wh{\mathsf{T}}_\Theta=G^\ast\wh{\mathsf{T}}_\Theta$.
 
 If $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism  it follows from the previous discussion
 that taking any representative diagram
 $$
 d\colon X\xleftarrow{F} A\xrightarrow{G} Y
 $$
 the expressions $G_\ast F^\ast\wh{\mathsf{T}}_\Theta$ and $G^\ast F_\ast\wh{\mathsf{T}}_{\Theta'}$ are well-defined and do not depend
 on the particular  choice of the representatives.  Hence $\mathfrak{f}_\ast\wh{\mathsf{T}}_\Theta$ and $\mathfrak{f}^\ast\wh{\mathsf{T}}_{\Theta'}$
 are well-defined.   Our discussion shows that orientations can be transformed by generalized isomorphisms. 
 \qed \end{proof}
 In view of Theorem \ref{THM1135} we can make the following definition.
 \begin{definition}\index{D- Transformation of $\wh{\Theta}$}
 Let $\wh{\Theta}=(\Theta,\wh{\mathsf{T}}_\Theta):X\rightarrow {\mathbb Q}^+$ and $\wh{\Theta}':Y\rightarrow {\mathbb Q}^+$
 be oriented, branched ep$^+$-subgroupoids. Assume that $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism.
 Then $\mathfrak{f}_\ast\wh{\Theta}$ and $\mathfrak{f}^\ast\wh{\Theta}'$ are defined by
 \begin{eqnarray*}
 &\mathfrak{f}_\ast\wh{\Theta}=(\mathfrak{f}_\ast\Theta,\mathfrak{f}_\ast\wh{\mathsf{T}}_\Theta)&\\
 &\mathfrak{f}^\ast\wh{\Theta}' =(\mathfrak{f}^\ast\Theta',\mathfrak{f}^\ast\wh{\mathsf{T}}_{\Theta'}).&
 \end{eqnarray*}
 \qed
 \end{definition}
 If $\mathfrak{f}:X\rightarrow Y$ and $\mathfrak{g}:Y\rightarrow Z$ are generalized isomorphisms its is clear from the definition that
 the operations on the oriented, branched ep$^+$-subgroupoids have the following functorial property
\begin{eqnarray}
& (\mathfrak{g}\circ\mathfrak{f})_\ast \wh{\Theta}=\mathfrak{g}_\ast\circ \mathfrak{f}_\ast\wh{\Theta}\ \ \text{and}\ \ \  (\mathfrak{g}\circ\mathfrak{f})^\ast\wh{\Theta}'=\mathfrak{f}^\ast\circ \mathfrak{g}^\ast\wh{\Theta}'&\\
&\mathfrak{f}^\ast\mathfrak{f}_\ast\wh{\Theta}=\wh{\Theta}\ \ \text{and}\ \ \ \mathfrak{f}_\ast\mathfrak{f}^\ast\wh{\Theta}'=\wh{\Theta}'.&\nonumber
\end{eqnarray}
Next we consider the tangent of $\Theta:X\rightarrow {\mathbb Q}^+$ and its behavior under equivalences.
\begin{theorem}\index{T- Transformations of $T\Theta$}
Let $\mathfrak{f}:X\rightarrow Y$ be a generalized isomorphism and $\Theta:X\rightarrow {\mathbb Q}^+$ and $\Theta':Y\rightarrow {\mathbb Q}^+$
branched ep$^+$-subgroupoids. Then 
$$
(T\mathfrak{f})_\ast T\Theta = T(\mathfrak{f}_\ast \Theta)\ \ \text{and}\ \ \ (T\mathfrak{f})^\ast(T\Theta')= T(\mathfrak{f}^\ast\Theta').
$$
\end{theorem}
\begin{proof}
If $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism which is representable by the diagram
$$
d\colon X\xleftarrow{F} A\xrightarrow{G} Y,
$$
then we obtain the  generalized isomorphism $T\mathfrak{f}:TX\rightarrow TY$ by
$$
T\mathfrak{f}:= [Td]:= [TX\xleftarrow{TF} TA\xrightarrow {TG} TY].
$$
Recalling that $T\Theta$ is locally represented by the tangents of the manifolds occurring in the local branching structure 
the result is easily established. We leave the further details to the reader.
\qed \end{proof}

Next we study the relationship between the boundary construction $\partial\Theta$ and
the maps $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$. We shall prove the following result
\begin{theorem}\label{THMX1138}\index{T- Boundary operation and equivalences}
Let $\mathfrak{f}:X\rightarrow Y$ be  a generalized isomorphism between ep-groupoids.
Assume that $\Theta:X\rightarrow {\mathbb Q}^+$ and $\Theta':Y\rightarrow {\mathbb Q}^+$ are branched ep$^+$-subgroupoids
with associated  boundaries $\partial\Theta$ and $\partial\Theta'$.
Then  we have the equalities
\begin{eqnarray}
&\mathfrak{f}_\ast(\partial\Theta) =\partial (\mathfrak{f}_\ast\Theta)&\\
&\mathfrak{f}^\ast(\partial\Theta') = \partial(\mathfrak{f}^\ast\Theta').&\nonumber
\end{eqnarray}
\end{theorem}
\begin{proof}
In order to do so,  we have to understand as before the behavior with respect to equivalences $F:X\rightarrow Y$,
as well as $G:X\rightarrow Y$ provided $F$ and $G$ are naturally equivalent. 
The basic idea is as before that the local branching structures can be moved around by equivalences,
and the local sc-diffeomorphism $\wh{\psi}$ associated to a morphism $\psi$.
If $M\subset X$ is a submanifold and $x\in M$ we can move small neighborhoods around in the same way
and not that $d_M(x)$ is being preserved. 
The proof of the theorem follows from these considerations and is left to the reader.
\qed \end{proof}

Let $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ be an oriented, tame, branched ep$^+$-subgroupoid. 
Then we have seen that $\partial\Theta$ has a natural  orientation $\wh{\mathsf{T}}_{\partial\Theta}$, so that we can define
$\partial\wh{\Theta}$, see Definition \ref{DEF936}.  The section $\wh{\mathsf{T}}_{\partial\Theta}$ can be pushed forward 
or pulled back by a generalized isomorphism. According to the following theorem  these procedures define the corresponding
orientations for the transformed $\partial\Theta$.

\begin{theorem}\index{T- Transformations and boundaries}\label{THMX11.3.9}
Let $\mathfrak{f}:X\rightarrow Y$ be a generalized isomorphism between ep-groupoids and $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$
and $\wh{\Theta}':Y\rightarrow {\mathbb Q}^+$ oriented, tame, branched ep$^+$-subgroupoids.  Then the following formulae hold.
\begin{eqnarray*}
&\partial(\mathfrak{f}_\ast\wh{\Theta}) =\mathfrak{f}_\ast(\partial\wh{\Theta})&\\
&\partial(\mathfrak{f}^\ast\wh{\Theta}')=\mathfrak{f}^\ast(\partial\wh{\Theta}').&
\end{eqnarray*}\
\qed
\end{theorem}
We leave the proof, which follows the lines of previous proofs in this section,  to the reader.

 \section{Equivalences and Integration}\label{SECRTY114}
The ingredients for integration, sc-differential forms and oriented, branched ep$^+$-subgroupoids behave well under equivalences.
Recall the statement of Theorem \ref{IandS}, which asserts that given an ep-groupoid $X$, we can associate
to an oriented, tame, compact, branched ep$^+$-subgroupoid $\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ of dimension $n$
a natural linear map
$$
\Phi_{\wh{\Theta}}:\Omega^n_\infty(X)\rightarrow {\mathcal M}(S,{\mathcal L}(S)),
$$
where $S=|\supp(\Theta)|$, associating to an sc-differential $n$-form $\omega$ a signed measure $\mu_\omega^\Theta$.
\begin{theorem}[Transformation of canonical measures]\label{THM1141} \index{T- Transformation of canonical measures}
Assume that $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism between two ep-groupoids and
$\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ and $\wh{\Theta}':Y\rightarrow {\mathbb Q}^+$ are oriented, tame,  compact, branched
ep$^+$-subgroupoids of dimension $n$. Suppose further that $\omega$ and $\omega'$ are sc-differential forms 
on $X$ and $Y$, respectively, of degree $n$. Then, for a measurable subset $K$ of $|\supp(\Theta)|$
$$
\mu^{\wh{\Theta}}_{\omega} (K)  = \mu^{\mathfrak{f}_\ast\wh{\Theta}}_{\mathfrak{f}_\ast\omega}( |\mathfrak{f}|(K))\ \ \text{and}\ \ \
\mu^{\mathfrak{f}^\ast\wh{\Theta}'}_{\mathfrak{f}^\ast\omega'}(K)   = \mu^{\wh{\Theta}'}_{\omega'}( |\mathfrak{f}|(K)).
$$
With the obvious notation we can rewrite this more suggestively as
$$
|\mathfrak{f}|_\ast\mu^{\wh{\Theta}}_{\omega}   = \mu^{\mathfrak{f}_\ast\wh{\Theta}}_{\mathfrak{f}_\ast\omega}\ \ \text{and}\ \ \
\mu^{\mathfrak{f}^\ast\wh{\Theta}'}_{\mathfrak{f}^\ast\omega'}   = |\mathfrak{f}|^\ast \mu^{\wh{\Theta}'}_{\omega'}.
$$
\qed
\end{theorem}
The theorem will be proved later.
\begin{remark}\label{REM1142}\index{R- Remarks on polyfold structures}
An obvious consequence of this result is the following fact, which will be elaborated on further
in Chapter \ref{chap11+}.  Let $Z$ be a metrizable space and consider a pair  $(X,\beta)$, where $X$ is an ep-groupoid
and $\beta:|X|\rightarrow Z$ is a homeomorphism. We shall refer to such a pair $(X,\beta)$ as a {\bf polyfold structure}\index{Polyfold structure on $Z$}
on the metrizable space $Z$. Given another such pair $(X',\beta')$ we say that it defines an {\bf equivalent polyfold structure}
\index{Equivalent polyfold structure}
on $Z$ provided there exists a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$ satisfying
$$
\beta'\circ |\mathfrak{f}| =\beta.
$$
With other words $|\mathfrak{f}|={(\beta')}^{-1}\circ \beta$. Hence, $(X,\beta)$ and $(X',\beta')$ are equivalent if the {\it transition map}
$ {(\beta')}^{-1}\circ\beta :|X|\rightarrow |X'|$ is induced by a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$. Recall that 
$|\mathfrak{f}|=|\mathfrak{g}|$ implies that $\mathfrak{f}=\mathfrak{g}$, see Theorem \ref{THMX10316}, which implies that $\mathfrak{f}$ is unique.

We explain this concept in a special case. Let $X$ be an \'etale proper Lie groupoid, so that between two objects 
there are is at most one morphism. It is an easy exercise that $|X|$ has a (classical)
natural smooth manifold structure. Assume that $Z$ is a metrizable topological space and $\beta:|X|\rightarrow Z$ a homeomorphism.
Then we can equip $Z$ with the unique smooth manifold structure making $\beta$ a diffeomorphism. 
If $(X',\beta')$ is similar and the transition map is induced from a generalized isomorphism $\mathfrak{f}$ it means that the smooth manifold 
structure
induced on $Z$ is the same as that coming from $(X,\beta)$. Hence the formalism in the more general case can be viewed as 
a generalization of the definition of a smooth manifold. In fact it is a generalization of the concept of an orbifold with boundary and corners
(a manifold is a special case).

A metrizable space equipped with an equivalence class of polyfold structures is called a {\bf polyfold}\index{Polyfold}.
A polyfold $Z$ is the generalization of an orbifold to the sc-smooth world.

There are several concepts which can be carried over to polyfolds.   For example
a differential form on $Z$ is an equivalence class $[(X,\beta),\omega]$. Here $\omega$ is an sc-differential form
on $X$ and $((X,\beta),\omega)\sim ((X',\beta',\omega')$ provided for a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$
with $\beta'\circ|\mathfrak{f}|=\beta$ it holds that $\mathfrak{f}^\ast\omega'=\omega$. 
We can also define branched sub$^+$-polyfold of $Z$ as an equivalence class $[(X,\beta),\Theta]$ with the obvious notion of equivalence.
Similarly the notions of being compact, closed, tame, and oriented carry over. 

If $[(X,\beta),\wh{\Theta}]$ is an oriented, compact, tame branched $n$-dimensional sub$^+$-polyfold and $[(X,\beta),\omega]$
an sc-differential $n$-form on $Z$, we can consider the support $S$ of $|\Theta|\circ \beta^{-1}:Z\rightarrow {\mathbb Q}^+$. 
which call the support of $[(X,\beta),{\Theta}]$, and which is defined independently of the representative which we picked.
Then we can defined the Lebesgue $\sigma$-algebra ${\mathcal L}(S)$ and the vector spaces of signed measures
${\mathcal M}(S,{\mathcal L}(S))$. We can associate 
to $[(X,\beta),\wh{\Theta}]$ and $[(X,\beta),\omega]$ the signed measure $\mu_{[(X,\beta),\omega]}^{[(X,\beta),\wh{\Theta}]}$.
The upshot is that all notions which transform well under equivalences define intrinsic objects on the polyfold $Z$.
\qed
\end{remark}

There is a version of Theorem \ref{THM1141} for the boundary case, which relies on Theorem \ref{THM9510}.
\begin{theorem}[Transformation of canonical boundary measures]\label{THM1143} \index{T- Transformation of canonical boundary measures}
Assume that $\mathfrak{f}:X\rightarrow Y$ is a generalized isomorphism between two ep-groupoids and
$\wh{\Theta}:X\rightarrow {\mathbb Q}^+$ and $\wh{\Theta}':Y\rightarrow {\mathbb Q}^+$ are oriented, tame,  compact, branched
ep$^+$-subgroupoids of dimension $n$. Suppose further that $\omega$ and $\omega'$ are sc-differential forms 
on $X$ and $Y$, respectively, of degree $n-1$. Then on $|\supp(\partial \Theta)|$
$$
\mu^{\partial\wh{\Theta}}_{\omega}   = \mu^{\mathfrak{f}_\ast\partial \wh{\Theta}}_{\mathfrak{f}_\ast\omega}\circ |\mathfrak{f}|\ \ \text{and}\ \ \
\mu^{\mathfrak{f}^\ast\partial\wh{\Theta}'}_{\mathfrak{f}^\ast\omega'}   = \mu^{\partial\wh{\Theta}'}_{\omega'}\circ |\mathfrak{f}|
$$
With the obvious notation we can rewrite this more suggestively as
$$
|\mathfrak{f}|_\ast\mu^{\partial\wh{\Theta}}_{\omega}   = \mu^{\mathfrak{f}_\ast\partial\wh{\Theta}}_{\mathfrak{f}_\ast\omega}\ \ \text{and}\ \ \
\mu^{\mathfrak{f}^\ast\partial\wh{\Theta}'}_{\mathfrak{f}^\ast\omega'}   = |\mathfrak{f}|^\ast \mu^{\partial\wh{\Theta}'}_{\omega'}.
$$
\qed
\end{theorem}
\begin{proof}[Theorem \ref{THM1141}]
Consider the case where $F:X\rightarrow Y$ is an equivalence between two ep-groupoids.
Let $x\in \supp(\Theta)$ and consider open neighborhoods $U(x)$ and $U(F(x))$ such that $F:U(x)\rightarrow U(F(x))$
is an sc-diffeomorphism, and both neighborhoods have the properness property, allow the natural actions.
We assume that $U(x)$ is equipped with an oriented local branching structures ${(M_i,o_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ so that
$$
\Theta(y)=\sum_{\{i\in I\ |\ y\in M_i\}}\sigma_i\ \ \text{for}\ \ y\in U(x).
$$
We equip $U(F(x))$ with the branching structure obtained via $F|U(x)$ and denote the associated submanifolds by
${(M_i',o_i')}_{i\in I}$.
We compute
\begin{eqnarray}\label{KLM1141}
\mu_\omega^{\wh{\Theta}}(K)&=& \frac{1}{\sharp G^{\text{eff}}_x}\cdot \sum_{i\in I} \sigma_i\cdot \int_{K_i} \omega\\
&=& \frac{1}{\sharp G^{\text{eff}}_{F(x)}}\cdot \sum_{i\in I} \sigma_i\cdot \int_{F(K_i)} F_\ast \omega\\
&=&  \mu_{F_\ast\omega}^{F_\ast\wh{\Theta}}(|F|(K)).\nonumber
\end{eqnarray}
This shows that the homeomorphism $|F|:|X|\rightarrow |Y|$ relates locally the measures 
$\mu^{\wh{\Theta}}_{\omega}$ and $\mu^{F_\ast\wh{\Theta}}_{F_\ast\omega}$. Since measures
are $\sigma$-additive it follows that
$$
\mu^{\wh{\Theta}}_{\omega} =|F|^\ast \mu^{F_\ast\wh{\Theta}}_{F_\ast\omega}.
$$
There is a similar relationship involving pull-backs and the proof follows the same lines
$$
\mu^{F^\ast\wh{\Theta}'}_{F^\ast\omega'} = |F|^\ast \mu^{\wh{\Theta}'}_{\omega'}.
$$
Given the generalized isomorphism $\mathfrak{f}:X\rightarrow Y$ take a representative diagram
$$
X\xleftarrow{F} A\xrightarrow{G} Y
$$
We compute
\begin{eqnarray*}
|\mathfrak{f}|_\ast \mu^{\wh{\Theta}}_\omega = G_\ast F^\ast\mu^{\wh{\Theta}}_\omega
= G_\ast  \mu^{F^\ast\wh{\Theta}}_{F^\ast\omega}
=\mu^{G_\ast F^\ast\wh{\Theta}}_{G_\ast F^\ast\omega}
= \mu^{\mathfrak{f}_\ast\wh{\Theta}}_{\mathfrak{f}_\ast\omega}
\end{eqnarray*}
The pull-back formula is established in the same way.
\qed \end{proof}

\begin{proof}[Theorem \ref{THM1143}]
The considerations are very similar to those in the roof of Theorem \ref{THM1141}.
Using a local branching structure at a point $x$ in $\supp(\partial\Theta)$ we establish
for equivalences that the measures agree locally. This step corresponds to (\ref{KLM1141}).
The rest is formally as in the proof of Theorem \ref{THM1141}.
The details are left to the reader.
\qed \end{proof}



\section{Strong Bundles up to Equivalence}
For the following developments we have to study the behavior of various concepts, introduced above, under generalized strong bundle maps.
In  other words,  we have to carry out some `strong bundle geometry up to equivalence'. This is similar to the case of ep-groupoids;  added are the sc-smooth section functors.  We begin by recalling Theorem \ref{Push-Forw-prop} from Chapter \ref{SEC2}.

{\bf Theorem \ref{Push-Forw-prop}\textcolor{red}{.}}
Let $(P \colon W\to X,\mu)$ and $(P' \colon W'\to X',\mu')$ be two strong bundles over ep-groupoids and $[D]:W\rightarrow W'$ a generalized strong bundle isomorphism.
Denote by $\Gamma(P,\mu)$ and $\Gamma(P',\mu')$ the vector spaces of sc-smooth section functors. Then $[D]$ induces a well-defined isomorphism
$$
[D]_\ast\colon\Gamma(P,\mu)\rightarrow \Gamma(P',\mu').
$$
Its inverse is given by the inverse diagram and equals the pull-back $[D]^\ast$.  The same assertion hold for $sc^+$-section functors 
$$
[D]_\ast\colon\Gamma^+(P,\mu)\rightarrow \Gamma^+(P',\mu')
$$
and sc-Fredholm sections functors
$$
[D]_\ast\colon \text{Fred}(P,\mu)\rightarrow \text{Fred}(P',\mu').
$$
Moreover, if $[D], [D']: W\rightarrow W'$ are two generalized strong bundle isomorphisms inducing the same maps between orbit spaces, i.e. $|[D]|=|[D']|$, then
$[D]_\ast =[D']_\ast$ and $[D]^\ast =[D']^\ast$.
\qed



Next we show that generalized isomorphisms map auxiliary norms to auxiliary norms.
\begin{proposition}\label{prop_auxiliary_norm}\index{P- Auxiliary norms}
Let $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ be strong bundles over ep-groupoids and $[D]:W\rightarrow W'$ a generalized strong bundle isomorphism.
Given an auxiliary norm $N'$ for $(P':W'\rightarrow X',\mu')$ there is a well-defined pull-back $N=[D]^\ast N'$ which is an auxiliary norm for $(P,\mu)$.
Similarly there is a push forward $[D]_\ast N$ defining an auxiliary norm on $(P',\mu')$. Moreover, 
$$
[D]^\ast[D]_\ast N=N\ \text{and}\ [D]_\ast [D]^\ast N' =N'.
$$
In addition,  if $[D]$ and  $[D']:W\rightarrow W'$ satisfy $|[D]|=|[D']|$,  then $[D]_\ast N=[D']_\ast N$ and $[D]^\ast N'=[D']^\ast N'$.
\end{proposition}
\begin{proof}
In order to  define the auxiliary norm $N:=[D]^\ast N'$we choose  a representative $D\colon W\xleftarrow{\Phi}W''\xrightarrow{\Psi} W'$ and take $e\in W_{0,1}$. Since $\Phi$ is a strong bundle equivalence, we find $e''\in W''_{0,1}$ and a morphism $\Phi(e'')\rightarrow e$. Then we define
$$
N(e):= N'(\Psi(e'')).
$$
As one easily verifies,  the definition does not depend on the choices involved since $N'$ is a functor $W'\rightarrow {\mathbb R}^+$. Moreover it follows from the definition that
$[D]^\ast N=[D']^\ast N'$ provided $|[D]|=|[D']|$.
We can also go in the reverse direction to define the push forward and derive the desired results.
\qed \end{proof}

The $\ssc^+$-multisections behave nicely too under  generalized strong bundle isomorphisms, as we shall see next.

In order to define the pull-back and push forward of $\ssc^+$-multisections we consider the equivalence $\Phi\colon W\to W'$ between the strong bundles 
$(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ covering the equivalence $\phi\colon X\to X'$ between the underlying ep-groupoids. The {\bf pull back of the $\ssc^+$-multisection} \index{pull back of the $\ssc^+$-multisection}
$\Lambda'\colon W'\to \Q^+$ is the multisection $\Lambda\colon W\to \Q^+$ defined by 
$$\Lambda (w)=\Phi^\ast \Lambda' (w)=\Lambda' (\Phi (w)),\quad w\in W.$$
The push-forward $\Phi_\ast \Lambda$ of the $\ssc^+$-multisection $\Lambda^\ast\colon W\to \Q^+$ at the point $w'\in W'$ is defined as follows. Using that the equivalence is essentially surjective we find a point $w\in W$ and a morphism $(\sigma', \Phi (w))\in {\bm{W}}'$,
$$(\sigma', \Phi (w))\colon \Phi (w)\to w'=\mu'(\sigma', \Phi (w))\in W'.$$
Here $\sigma'\in {\bm{X}}'$ is the underlying morphism $\sigma'\colon \phi (x)\to x'$, where $x=Pw\in X$ and $x'=P'w'\in X'$. The {\bf push-forward of the $\ssc^+$-multisection}\index{push-forward of a $\ssc^+$-multisection} $\Lambda'\colon W'\to \Q^+$ is defined as the $\ssc^+$-multisection $\Lambda'\colon W'\to \Q^+$,
$$\Lambda'(w')=\Phi_\ast \Lambda (w')=\Lambda (w).$$
It is independent of the choices of $w$ and morphism $\Phi (w)\to w'$. Indeed, if $w_0\in W$ and $\Phi (w_0)\to w'$ is a second morphism in ${\bm{W}}'$, we obtain the  morphism $\Phi (w)\to \Phi (w_0)$ in $W'$ and hence  a morphism $w\to w_0$ in ${\bm{W}}$ and conclude by the functoriality of 
$\Lambda$ that $\Lambda (w)=\Lambda (w_0)$.
\begin{lemma}
$\Lambda'=\Phi_\ast \Lambda$ is a functor.
\end{lemma}
\begin{proof}
Given a morphism $w_1'\to w_2'$ in ${\bf W'}$,  we have to show that $\Lambda' (w_1')=\Lambda' (w_2')$. There are $w_1, w_2\in W$ and morphisms 
$\Phi (w_1)\to w_1'$ and $\Phi (w_2)\to w_2'$ in ${\bm{W}}'$. Since $w_1'\to w_2'$ is a morphism, there exists also a morphism $\Phi (w_1)\to \Phi (w_2)$. Since  $\Phi$ is an equivalence,  there exists a morphism $w_1\to w_2$ in ${\bm{W}}$ and therefore $\Lambda (w_1)=\Lambda (w_2)$, in view of the functoriality of $\Lambda$. Hence, by definition of $\Phi_\ast \Lambda$, 
$$\Lambda' (w_1')=\Lambda (w_1)=\Lambda (w_2)=\Lambda' (w_2').$$
\qed \end{proof}

To obtain a local section structure $(s'_i, \sigma_i')$ around $x'\in X'$ we take a point $x\in X$ and the morphism $\sigma'\colon \phi (x)\to x'$ in ${\bm{X}}'$ from above, take the local section structure $(s_i, \sigma_i)$ of $\Lambda$ around $x$, define $\sigma_i'=\sigma_i$ and $s_i'(x')=\mu (\sigma', \Phi (s_i (x))$, and use that $\sigma'$ extends to a unique local sc-diffeomorphism by $t\circ s^{-1}$.

By construction, 
$$\Phi^\ast\circ \Phi_\ast \Lambda =\Lambda$$
for every $\ssc^+$-mulitisection $\Lambda\colon W\to \Q^+$.




If $[D]=[W\xleftarrow{\Phi}W''\xrightarrow{\Psi}W']$ is a generalized strong bundle isomorphism covering the generalized isomorphism $[d]=[X\xleftarrow{\phi}X''\xrightarrow{\psi}X']$, we choose a representative diagram and define the push forward $[D]_\ast \Lambda$ as the $\ssc^+$-multisection 
$$[D]_\ast \Lambda=\Psi_\ast\circ \Phi^\ast\colon W'\to \Q^+.$$
The definition does not depend on the choice of the diagram.



\begin{proposition}\index{P- Push forward and pull back of $\ssc^+$-multi sections}
Let $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ be strong bundles over ep-groupoids and $[D]:W\rightarrow W'$ a generalized strong bundle isomorphism.
Given a $\ssc^+$-multisection $\Lambda$ for $(P,\mu)$ there exists a well-defined push forward $[D]_\ast\Lambda$ and for a $\ssc^+$-multisection $\Lambda'$ for $(P'\,\mu')$
a well-defined pull-back $[D]^\ast\Lambda'$. These operations are mutually inverse. Moreover, if $[D],[D']:W\rightarrow W'$ are generalized strong bundle maps
satisfying $|[D]|=|[D']|$, then the push-forward and pullback operations for $\ssc^+$-multisections are the same. 
\qed
\end{proposition}

The proof follows from previously established properties.


\section{Coverings and Equivalences}\label{SQWERTY116}
We study proper coverings up to equivalence. We recall that a  proper covering functor $F\colon Y\rightarrow X$ between ep-groupoids is a sc-smooth functor such that 
 \begin{itemize}
 \item[(1)]\  The sc-smooth map $F$ between the object M-polyfolds is a surjective local sc-diffeomorphism.
 \item[(2)]\ The preimage $F^{-1}(x)$  of every object $x\in X$ is finite and there exist open neighborhoods
 $U(x)$ of $x$ and $U(y)$ for every $y\in F^{-1}(x)$ such  that $F\colon U(y)\rightarrow U(x)$ is a sc-diffeomorphism 
 and
 $$
 F^{-1}(U(x))=\bigcup_{y\in F^{-1}(x)} U(y).
 $$
 \item[(3)]\ The map
 $$
\alpha\colon  {\bm{Y}}\rightarrow \bx{_{s}\times_F}Y, \quad \phi\mapsto ({\bf F}(\phi),s(\phi))
 $$
 is a sc-diffeomorphism.
 \end{itemize}

Denote for an object $x\in X$ by $Y(x)$ the full subcategory of $Y$ generated by the finitely many 
objects in $F^{-1}(x)$.
 We can define a group action of $G_x$ on $Y(x)$ as follows. For $g\in G_x$ and $y\in Y(x)$
we define $g\ast y := t(\psi)$, where $\alpha(\psi)=(g,y)$. 
Assuming that $\alpha(\psi_1)=(g_1,y)$ and $\alpha(\psi_2)=(g_2,t(\psi_1))$ we see that 
$F(\psi_1)=g_1$, $s(\psi_1)=y$,  $F(\psi_2)=g_2$,  and $s(\psi_2)=t(\psi_1)$. 
There exists a unique $\psi_3$ such that $F(\psi_3)=g_2\circ g_1$ and $s(\psi_3)=y$.
We note that $s(\psi_2\circ \psi_1)=s(\psi_1)=y$ which implies that $\psi_3=\psi_2\circ \psi_1$
by uniqueness.  Consequently defining $g\ast y:= t(\alpha^{-1}(g,y))$ we compute
$$
(g_2\circ g_1)\ast y = t(\psi_3) =t(\psi_2\circ\psi_1)= t(\psi_2) = g_2\ast t(\psi_1) =g_2\ast(g_1\ast y).
$$
Moreover $1\ast y =t(1_y)=y$. Hence we can build the translation groupoid $G_x\ltimes Y_x$.
The morphisms are the pairs $(g,y)$ with $s(g,y)=y$ and $t(g,y)=g\ast y$. The composition
of $(g_2,y_2)$ and $(g_1,y_1)$ is defined if $y_2=g\ast y_1$ and in this case
$(g_2,y_2)\circ (g_1,y_1)=(g_2\circ g_1,y_1).$

The category $Y(x)$ is isomorphic to the category $G_x\ltimes Y_x$ by the functor 
which on objects is the identity $Y(x)\rightarrow Y(x)$ and on morphisms $\alpha$.  Indeed, by construction
$\alpha(1_y)= (1_x,y)$ and 
$$
\alpha(\psi_2\circ \psi_1)= (F(\psi_2\circ\psi_1),s(\psi_1))=(F(\psi_2)F(\psi_1),s(\psi_1)).
$$
We note that  $F(\psi_1)\ast s(\psi_1) = t(\psi_1)=s(\psi_2)$. Hence 
$$
\alpha(\psi_2\circ \psi_1) =(F(\psi_2),s(\psi_2))\circ (F(\psi_2),s(\psi_1))= \alpha(\psi_2)\circ \alpha(\psi_1).
$$

Hence we have proved.
\begin{lemma}
Let $F:Y\rightarrow X$ be a proper covering functor between ep-groupoids. Then for every object $x\in X$
the full subcategory $Y(x)$ generated by the objects in $F^{-1}(x)$ can be naturally identified 
with the translation groupoid $G_x\ltimes Y_x$ for a naturally defined action
$$
G_x\times Y_x\rightarrow Y_x : (g,y)\rightarrow g\ast y:= t(\alpha^{-1}(g,y)).
$$
The identification of $(Y(x),\bm{Y}(x))\rightarrow G_x\ltimes Y(x)$ is given by the identity on objects
and by the map $\alpha$ on morphisms.
\qed
\end{lemma}

Every morphism $\phi:x\rightarrow x'$ defines an equivalence of categories as follows.
\begin{lemma}
Let $\phi:x\rightarrow x'$ be a morphism in $\bm{X}$. Then $\phi$ induces an equivariant map
$$
B_\phi:Y(x)\rightarrow Y(x')
$$
and consequently an equivalence of translation groupoids, which is bijective on objects and morphisms
$$
\wt{\phi}: G_x\ltimes Y(x)\rightarrow G_{x'}\ltimes Y(x'): (g,y)\rightarrow (\phi\circ g\circ \phi^{-1},B_\phi(y)).
$$
The map $B_\phi:Y(x)\rightarrow Y(x')$ is defined by
$$
B_\phi(y)=t(\psi),
$$
where $F(\psi)=\phi$ and $s(\psi)=y$. The map
$$
\alpha^{-1}\circ\wt{\phi}\circ\alpha: (Y(x),\bm{Y}(x))\rightarrow (Y(x),\bm{Y}(x'))
$$
is a natural  equivalence of categories associated to $\phi:x\rightarrow x'$.
\end{lemma}
\begin{proof}
Given $\phi:x\rightarrow x'$ there is an induced equivariant bijection $B_\phi:Y_x\rightarrow Y_{x'}$ 
defined by 
$$
B_\phi(y) = t(\alpha^{-1}(\phi,y)).
$$
The equivariance is obtained as follows. We consider $(g,y)\in G_x\times Y(x)$ and
$\phi:x\rightarrow x'$ and compute $B_{\phi}(g\ast y)$ as follows. We take $\psi_1\in \bm{Y}$
with $F(\psi_1)=\phi$ and $s(\psi_1)=g\ast y =t(\psi_2)$ where $F(\psi_2)=g$ and $s(\psi_2)=y$.
Then $\psi_1\circ \psi_2$ is well-defined and $s(\psi_1\circ\psi_2)=s(\psi_2)=y$.
Moreover $F(\psi_1\circ\psi_2)=\phi\circ g$.
Hence 
$$
B_{\phi}(g\ast y)= t(\psi_1)=t(\psi_1\circ\psi_2) = B_{\phi\circ g}(y).
$$
The morphism $\phi:x\rightarrow x'$ determines the  group isomorphism $G_x\rightarrow G_{x'}$
given by
$$
\gamma_\phi(g) = \phi\circ g\circ \phi^{-1}.
$$
Hence $\gamma_\phi(g)\circ \phi= \phi\circ g$. Consequently
$$
B_{\phi}(g\ast y) = B_{\gamma_\phi(g)\circ \phi}(y).
$$
By definition $B_{\gamma_\phi(g)\circ \phi}(y)=t (\psi_3)$ with $F(\psi_3)=\gamma_\phi(g)\circ\phi$
and $s(\psi_3)=y$. Pick $\psi_4$ with $F(\psi_4)=\gamma_\phi(g)$ and $s(\psi_4)=B_{\phi}(y)$.
We also take $\psi_5$ with $F(\psi_5)=\phi$ and $s(\psi_5)=y$. 
Then $\psi_3=\psi_4\circ \psi_5$ which implies
$$
B_{\gamma_\phi(g)\circ \phi}(y)=t (\psi_3) = t(\psi_4)=\gamma_\phi(g)\ast B_\phi(y).
$$
Bringing everything together we obtain
$$
\gamma_\phi(g)\ast B_\phi(y) = B_\phi( g\ast y).
$$
\qed \end{proof}


 
 
 
Given two proper covering functors $F:Y\rightarrow X$ and $F':Y'\rightarrow X'$ assume we are 
 given a pair of functors $\Psi$ and $\Phi$ making the following diagram commutative
 $$
 \begin{CD}
 Y @>\Psi>> Y'\\
 @V FVV @V F'VV\\
 X@>\Phi>> X'.
 \end{CD}
 $$
 For objects $x\in X$ and $x'\in X'$
 denote by $Y(x)$ and $Y'(x')$ the full subcategories generated by the finitely many objects 
 in $F^{-1}(x)$ and $F'^{-1}(x')$, respectively.  The maps $\alpha$ and $\alpha'$ define bijective equivalences
 of categories
 $$
\bm{Y}(x)\rightarrow G_x\ltimes Y(x):\psi\rightarrow (F(\psi),s(\psi))
$$
and
$$
\bm{Y}'(x')\rightarrow G_{x'}\ltimes Y'(x'):\psi'\rightarrow (F'(\psi'),s(\psi')).
$$
From the commutative diagram we infer that $\Psi$ induces a functor $Y(x)\rightarrow Y'(x')$.
\begin{definition}
Let $F:Y\rightarrow X$ and $F':Y'\rightarrow X'$ be two proper covering functors.
\begin{itemize}
\item[(1)]\ For a pair $(\Psi,\Phi)$ of sc-smooth functors fitting into the commutative diagram
 $$
 \begin{CD}
 Y @>\Psi>> Y'\\
 @V FVV @V F'VV\\
 X@>\Phi>> X', 
 \end{CD}
 $$
we say that $(\Psi,\Phi)$ is an {\bf sc-smooth functor between proper coverings}\index{D- Functor between proper coverings} $F$ and $F'$, written
as 
$$
(\Psi,\Phi):F\rightarrow F'.
$$
\item[(2)]\ An {\bf equivalence between proper covering functors}\index{D- Equivalence between proper coverings} is an sc-smooth functor $(\Psi,\Phi):F\rightarrow F'$
so that $\Phi$ and $\Psi$  are  equivalences of ep-groupoids and for every object $x\in X$ with $x'=\Phi(x)$ the functor $\Psi:Y(x)\rightarrow Y'(x')$
is a bijection on objects.
\end{itemize}
We note that there is a subclass of functors in (1) for which $\Psi:Y(x)\rightarrow Y(\Phi(x))$
is a bijection on objects for every $x\in X$.
\qed
\end{definition}


 
 
 
 









Assume that $\Gamma=(\Psi,\Phi):F\rightarrow F'$ is an equivalence between proper coverings 
and $(\zeta,\xi):F''\rightarrow F'$ an sc-smooth functor. Take the weak fibered products 
of ep-groupoids associated to the diagrams
\begin{eqnarray*}
& Y\xrightarrow{\Psi} Y'\xleftarrow{\zeta} Y''&\\
&X\xrightarrow{\Phi} X'\xleftarrow{\xi} X''.&
\end{eqnarray*}
We obtain $P:=Y \times_{Y'} Y''$ and $Q:=X\times_{X'} X''$.  For  $(y,\psi',y'')\in Y\times_{Y'} Y''$
we consider $(F(y),F'(\psi'),F''(y''))$ and note that 
$$
\Phi(F(y))= F'(\Psi(y))= F'(s(\psi'))=s(F'(\psi'))
$$
and
$$
\xi(F''(y''))= F'(\zeta(y''))=F'(t(\psi'))=t(F'(\psi')),
$$
so that $(F(y),F'(\psi'),F''(y''))\in X\times_{X'}X''$. We abbreviate 
$$
H:P\rightarrow Q,
$$
where $H(y,\psi',y'')=(F(y),F'(\psi'),F''(y''))$. 
Before we give the main result we need to introduce the notion of 
a natural transformation in our context.
\begin{definition}
Let $F$ and $F'$ be proper covering functors and $(\zeta,\xi),(\zeta',\xi'):F\rightarrow F'$ a
functor between proper coverings. A natural transformation $\tau$ is a pairs $(\tau_Y,\tau_X)$
of natural transformations 
$$
\tau_Y:Y\rightarrow \bm{Y}'\ \ \text{and}\ \ \tau_X:X\rightarrow \bm{X}'
$$
of ep-groupoids $\tau_Y: \zeta\rightarrow \zeta'$ and $\tau_X:\xi\rightarrow \xi'$ so that
$$
\tau_X\circ F = \bm{F}'\circ \tau_Y.
$$
We shall write $\tau:(\zeta,\xi)\rightarrow (\zeta',\xi')$. 
\qed
\end{definition}
If $y\in Y$ we have the morphisms $\tau_Y(y):\zeta(y)\rightarrow \zeta'(y)$ so that 
for any morphism $\psi:y_1\rightarrow y_2$ the diagram
$$
\begin{CD}
\zeta(y_1)@>\zeta(\psi)>> \zeta(y_2)\\
@V \tau_Y(y_1) VV   @V\tau_Y(y_2) VV\\
\zeta'(y_1) @>\zeta'(\psi)>> \zeta'(y_2)
\end{CD}
$$
Applying $ \bm{F}'$ to the diagram we obtain the following diagram where $x_i= F(y_i)$
$$
\begin{CD}
\xi(x_1)@>\xi(\bm{F}(\psi))>> \xi'(x_2)\\
@V \tau_X(x_1)VV @V \tau_X(x_2)VV\\
\xi'(x_1) @>\xi'(\bm{F}(\psi))>> \xi'(x_2).
\end{CD}
$$

The following is the main result in this section.
\begin{theorem}\label{THM1165}
Assume that $\Gamma=(\Psi,\Phi):F\rightarrow F'$ is an equivalence between proper coverings and 
$(\zeta,\xi):F''\rightarrow F'$ an sc-smooth functor between proper coverings. With the ep-groupoids 
$P$ and $Q$ defined as the weak fibered products 
$P=Y\times_{Y'}$ and $Q=X\times_{X'} X''$ 
the functor $H:P\rightarrow Q$  defined by
$$
H(y,\psi',y'')=(F(y),F'(\psi'),F(y''))
$$
the following holds.
\begin{itemize}
\item[{\em(1)}]\ The functor $H$ is well-defined and a proper covering functor.
\item[{\em(2)}]\ The functor  pair $(\pi_{Y''},\pi_{X''}):H\rightarrow F''$ is an equivalence of proper covering functors.
\item[{\em(3)}]\ The functor pairs $(\Psi\circ \pi_{Y},\Phi\circ \pi_{X}):H\rightarrow F'$ and 
$(\zeta\circ \pi_{Y''},\xi\circ\pi_{X''}):H\rightarrow F'$ between proper coverings are naturally equivalent.
\end{itemize}
Moreover, if $X''$ is a tame ep-groupoid (so that trivially $Y''$ is tame) it holds that $P$ and $Q$ are tame ep-groupoids.
If $(\zeta,\xi)$ is also an equivalence between proper coverings, then the pair of projections 
$(\pi_{Y},\pi_X)$ is an equivalence as well.
\end{theorem}

\begin{proof}
The lengthy proof is divided into several steps.\par

\noindent {\bf (A)}   $H$ is well-defined on morphisms. Hence $H$ is a well-defined functor between
ep-groupoids $H:P\rightarrow Q$. Moreover $H$ is sc-smooth.\par

The morphism space $\bm{P}$ associated to $P=Y\times_{Y'} Y''$ consists of all tuples
$(\psi,\psi',\psi'')\in \bm{Y}\times\bm{Y}'\times\bm{Y}''$ satisfying
$$
s(\Psi(\psi))\xrightarrow{\psi'} s(\zeta(\psi'')).
$$
Applying $H$ which by definition is $(F(\psi),F'(\psi'),F''(\psi''))$ we compute that
\begin{eqnarray*}
&s(\Phi(F(\psi)))=s(F'(\Psi(\psi)))=s(F'(\psi'))&\\
&s(\xi(F''(\psi'')))=s(F'(\zeta(\psi'')))=F'(s(\zeta(\psi'')))=F'(t(\psi'))=t(F'(\psi'')).&\nonumber
\end{eqnarray*}
Hence
$$
s(\Phi(F(\psi)))\xrightarrow{F'(\psi')}s(\xi(F''(\psi''))).
$$
This shows that $H:P\rightarrow Q$ is a well-defined functor. 
Since $F,F'$ and $F''$ are sc-smooth the same holds for $H$.\par


\noindent {\bf (B)} $H$ is surjective on objects.\par

Pick $(x,\phi',x'')\in Q$. Then $\phi:\Phi(x)\rightarrow \xi(x'')$. Since $F''$ is a proper covering functor 
we can pick $y''\in Y''$ such that $F''(y'')=x''$. Since $F'\circ \zeta(y'')= \xi\circ F''(y'')=\xi(x'')=t(\phi')=s(\phi'^{-1})$
there exists a unique $\psi'^{-1}$ with
$$
F'(\psi'^{-1})=\phi'^{-1}\ \ \text{and}\ \ s(\psi'^{-1})=\zeta(y'').
$$
Clearly
$$
F'(\psi')=\phi'\ \ \text{and}\ \ t(\psi')=\zeta(y'').
$$
Consider $s(\psi')$ and note that $F'(s(\psi'))=s(F'(\psi'))=s(\phi')=\Phi(x)$. 
Since $(\Psi,\Phi):F\rightarrow F'$ is an equivalence between proper covering functors 
we know that $\Psi:Y(x)\rightarrow Y'(\Phi(x))$ is a bijection. Since $s(\psi')\in Y'(\Phi(x))$
we find a unique $y\in Y(x)$ with $\Psi(y)=s(\psi')$. Consequently
$$
(y,\psi',y'')\in P
$$
and $H(y,\psi',y'')=(x,\phi,x'')$. \par

Next we consider $\wt{\alpha}: \bm{P}\rightarrow \bm{Q}{_{s}\times_H} P$ defined by
$$
\wt{\alpha}(\psi,\psi',\psi'')= (H(\psi,\psi',\psi''),(s(\psi),\psi',s(\psi''))).
$$

\noindent{\bf (C)} The map $\wt{\alpha}$ is an sc-diffeomorphism.\par

It is clear that $\wt{\alpha}$ is sc-smooth. 
We can write $\wt{\alpha}$ as 
$$
\wt{\alpha}(\psi,\psi',\psi'')=((F(\psi),F'(\psi'),F''(\psi'')),(s(\psi),\psi',s(\psi''))).
$$
Note that $s(F(\psi))=F(s(\psi))$, $s(F'(\psi'))=F'(s(\psi'))$, and $s(F''(\psi''))=F''(s(\psi''))$.
Let us first show that $\wt{\alpha}$ is a bijection.  So assume 
we are given $((\phi,\phi',\phi''),(y,\psi',y''))$ in $\bm{Q}{_{s}\times_H} P$. 
Hence 
$$
\phi':s(\Phi(\phi))\rightarrow s(\xi(\phi''))\ \ \text{and}\ \ \psi':\Psi(y)\rightarrow \zeta(y''),
$$
and moreover
$$
(F(y),F'(\psi'),F(y''))=(s(\phi),\phi',s(\phi'')).
$$
Since $F(y'')=s(\phi'')$ there exists a unique $\psi''$ with $F''(\psi'')$ and $s(\psi'')=y''$, and similarly 
there exists a unique $\psi$ with $F(\psi)=\phi$ and $s(\psi)=y$ since $F(y)=s(\phi)$. 
We compute 
$$
s(\Psi(\psi))=\Psi(s(\psi))=\Psi(y) =t(\psi')\ \ \text{and}\ \ s(\zeta(\psi''))=\zeta(s(\psi''))=\zeta(y'')=t(\psi').
$$
Consequently $(\psi,\psi',\psi'')\in \bm{P}$ and 
$$
\wt{\alpha}(\psi,\psi',\psi'')=((\phi,\phi',\phi''),(y,\psi',y'')).
$$
The uniqueness  of choices of $\psi$ and $\psi''$ in the previous construction shows that
$\wt{\alpha}$ is also injective.

Next we need to show that $\wt{\alpha}$ is a local sc-diffeomorphism.  For this it suffices 
to analyze the sc-smoothness of the previous construction in the surjectivity proof.
Assume that  $((\phi_0,\phi'_0,\phi''_0),(y_0,\psi'_0,y''_0))$ in $\bm{Q}{_{s}\times_H} P$
is given. Varying $y''$ sc-smoothly near $y''_0$ the data $\zeta(y'')$ varies sc-smoothly.
Using that $t$ is an sc-diffeomorphism there is a unique $\psi'(y'')$ near $\psi'_0$
with 
$$
t(\psi'(y''))=\zeta(y'').
$$
Then s$(\psi'(y''))$ varies sc-smoothly in $y''$ and since $\Psi$ is an equivalence we find
$y=y(y'')$ near $y_0$ varying sc-smoothly in $y''$ with
$$
\Psi(y(y''))=s(\psi'(y'')).
$$
Hence we obtain the sc-smooth map defined near $y''_0$ and given by
$$
y''\rightarrow (y(y''),\psi'(y''),\zeta(y'')).
$$
This map is also a local sc-diffeomorphism onto an open neighborhood in $P$ of the point $(y_0,\psi'_0,y''_0)$.
Moreover, the map $y''\rightarrow H(y(y''),\psi'(y''),\zeta(y''))$ is sc-smooth into $P$
and maps $y''_0$ to $(y_0,\psi'_0,y''_0)$. The source map $s:\bm{Q}\rightarrow Q$
is a local sc-diffeomorphism and we obtain uniquely defined sc-smooth maps defined for $y''$ near $y''_0$
$$
y''\rightarrow (\phi(y''),\phi'(y''),\phi''(y''))\in Q
$$
with $(\phi(y''_0),\phi'(y''_0),\phi''(y''_0))=(\phi_0,\phi'_0,\phi''_0)$, so that
$$
s( (\phi(y''),\phi'(y''),\phi''(y'')))=H(y(y''),\psi'(y''),\zeta(y'')).
$$
Hence we have the sc-smooth map defined for $y''$ near $y''_0$ with image in $\bm{Q}{_{s}\times_H}P$
defined by
$$
y''\rightarrow ((\phi(y''),\phi'(y''),\phi''(y'')),(y(y''),\psi'(y''),y'')).
$$
Since $F(y(y''))=s(\phi(y''))$ we define $\psi(y'')=\alpha^{-1}(\phi(y''),y(y''))$ and observe that 
it is depending sc-smoothly on $y''$.  Similarly using that $F''(y'')= s(\phi''(y''))$ we obtain the sc-smooth
$y''\rightarrow \psi''(y'')=\alpha''^{-1}(\phi''(y''),y'')$. The same gives also $\psi'(y'')$ satisfying
$F'(\psi'(y))=\phi'(y)$ and $s(\psi'(y))= \Psi(y(y''))$. Hence we obtain the sc-smooth map
$$
y''\rightarrow ((\psi(y''),\psi'(y''),\psi''(y''))
$$
in $\bm{Y}\times\bm{Y}'\times\bm{Y}''$. By construction the image
lies
in the sub-M-polyfold $\bm{P}$. Define 
$$
\wt{\beta}(((\phi(y''),\phi'(y''),\phi''(y'')),(y(y''),\psi'(y''),y'')))= ((\psi(y''),\psi'(y''),\psi''(y'')).
$$
We note that
\begin{eqnarray*}
&&\wt{\alpha}\circ \wt{\beta}((\phi(y''),\phi'(y''),\phi''(y'')),(y(y''), \psi'(y''),y''))\\
&=&((\phi(y''),\phi'(y''),\phi''(y'')),(y(y''), \psi'(y''),y'')).
\end{eqnarray*}
where the right-hand side is an sc-smooth coordinate  depending on $y''$ and $\wt{\beta}$ is sc-smooth.
This shows that $\wt{\alpha}$ is an sc-diffeomorphism.\par

\noindent {\bf (D)}  $H:P\rightarrow Q$ is a local sc-diffeomorphism on objects.\par

Let $(x_0,\phi'_0,x''_0)\in Q$. For $x''$ near $x''_0$ we have the sc-smooth coordinates
$x''\rightarrow (x(x''),\phi'(x''),x'')$, where $\phi'(x''_0)=\phi'_0$ and $t(\phi'(x''))=\xi(x'')$.
With $x''\rightarrow s(\phi'(x''))$ being sc-smooth and $\Phi$ being an equivalence we find $x(x'')$ such that
$\Phi(x(x''))=s(\phi'(x''x))$. Pick any point $(y_0,\psi'_0,y''_0)$ with $H(y_0,\psi'_0,y''_0)=(x_0,\phi'_0,x''_0)$.
Using $F''$ we find sc-smooth $x''\rightarrow y''(x'')$ with $F''(y''(x''))=x''$ and similarly 
using $F$ we find $y(x'')$ with $F(y(x''))=x(x'')$. We note that
$$
s(\phi'(x'')) =\Phi(x(x''))=\Phi\circ F(y(x''))=F'\circ \Psi(y(x'')).
$$ 
We find $\psi'(x'')$ such that
$$
F'(\psi'(x''))=\phi'(x'')\ \ \text{and}\ \ s(\psi'(x''))=\Psi(y(x'')).
$$
Then $(y(x''),\psi'(x''),y''(x''))$ depends sc-smoothly on $x''$ and is a local inverse
for $H$.\par

\noindent {\bf (E)}   $(\pi_{Y''},\pi_{X''}): F\times_{F'} F''\rightarrow F''$ is an equivalence of proper covering functors.\par

We know from the constructions in the ep-groupoid framework that $\pi_{Y''}: Y\times_{Y'} Y''\rightarrow Y''$
and $\pi_{X''}: X\times_{X'}X''\rightarrow X''$ are equivalences of ep-groupoids.  We compute on objects
$$
\pi_{X''}\circ H(y,\psi',y'')= \pi_{X'}\circ (F(y),F'(\psi'),F''(y''))= F''(y'') = F''\circ \pi_{Y'}(y,\psi',y'')
$$
and similarly on morphisms, so that we have the commutative diagram of  functors
$$
\begin{CD}
P=Y\times_{Y'} Y'' @> \pi_{Y''} >>Y''\\
@V H VV   @V F'' VV\\
Q=X\times_{X'} X'' @>\pi_{X''}>> X''.
\end{CD}
$$
Consider $q\in Q$ and the associated $P(q)$ and pick any $y''\in Y''(\pi_{X''}(q))$.
With $q=(x,\phi',x'')$ and $y''\in Y''(x'')$.  Then $F''(y'')=x''$ and 
 we find since $t(\phi')=\xi(x'')=\xi\circ F''(y'')=F'\circ \zeta(y'')$ a unique $\psi'\in \bm{Y}'$
 with $F'(\psi')=\phi'$ and $t(\psi')= \zeta(y'')$.  Since $\Phi(x)=s(\phi')=s(F'(\psi'))=F'(s(\psi'))$
 we can consider $\Psi:Y(x)\rightarrow Y'(\Phi(x))$ an by the properties of $\Psi$ there 
 exists a unique $y\in Y(x)$ with $\Psi(y)= s(\psi')$. Then $(y,\psi',y'')\in P(q)$ and
 $$
 \pi_{Y''}(y,\psi',y'')=y''.
 $$
 This shows that $\pi_{Y''}:P(q)\rightarrow Y''(\pi_{X''}(q))$ is surjective, and the uniqueness assertions
 during the proof show that the map is a bijection. \par
 
  \noindent{\bf (F)}  The  functor pairs $(\Psi\circ\pi_Y,\Phi\circ\pi_X)$ and $(\zeta\circ \pi_{Y''},\xi\circ \pi_{X''})$
 are naturally equivalent as functors $H\rightarrow F'$.\par
 
 We define $\tau_{P}:P\rightarrow \bm{Y}'$ and $\tau_{Q}:Q\rightarrow\bm{X}'$ as
 follows
 \begin{eqnarray*}
 &\tau_{P}(y,\psi',y'') = \psi'&\\
 &\tau_{Q}(x,\phi',x'')=\phi'.&
 \end{eqnarray*}
 We compute 
 $$
 \bm{F}'\circ \tau_P(y,\psi',y'')=\bm{F}'(\psi')
 =\tau_{Q}(F(y),\bm{F}'(\psi'),F(y''))=\tau_{Q}\circ H(y,\psi',y'').
 $$
 Hence $(\tau_P,\tau_Q)$ is compatible with $H$ and $F$ in the sense that 
 $\bm{F}'\circ \tau_P =\tau_Q\circ H$.  We compute further that
\begin{eqnarray*}
\Psi\circ \pi_Y(y,\psi',y'')=\Psi(y) \xrightarrow{\psi'} \zeta(y'')=\zeta\circ \pi_{Y''}(y,\psi',y''),
\end{eqnarray*}
which means since $\tau_Y(y,\psi',y'')=\psi'$, that $\tau_P: \Psi\circ\pi_Y\rightarrow \zeta\circ \pi_{Y''}$.
 Similarly we show that 
 $$
 \tau_Q: \Phi\circ \pi_X\rightarrow \xi\circ \pi_{X''}.
 $$
 Hence $(\tau_P,\tau_Q):(\Psi\circ\pi_Y,\Phi\circ \pi_X) \rightarrow (\zeta\circ \pi_{Y''},\xi\circ \pi_{X''})$ as claimed.\par
 

 The assertions about tameness are trivial.  If $X''$ is tame, i.e. the objects M-polyfold is tame, then 
 with $s$ and $t$ being local sc-diffeomorphsims the morphism space $\bm{X}''$ is tame. 
 Since the object space $X\times_{X'}X''$ is locally sc-diffeomorphic to $X''$ it is tame and then the same holds
 for the associated morphism space.  Since $F'':Y''\rightarrow X''$ is a proper covering functor it is a surjective local sc-diffeomorphism implying the tameness for the object space $Y''$ and then by the standard argument for the morphism space. The same argument which we used for $X\times_{X'} X''$ implies that $Y\times_{Y'} Y''$ is tame.
\qed \end{proof}

Consider the category ${\mathcal PC}$\index{${\mathcal{PC}}$} of proper coverings between ep-groupoids and the functors defined above as morphisms. Then we have the special collection  ${\bf E}={\bf E}_{{\mathcal PC}}$\index{${\bf E}_{{\mathcal PC}}$} of equivalences,
and as in the ep-groupoid case we can pass to the category ${\mathcal PC}({\bf E}^{-1})$, i.e. carry out the localization
at ${\bf E}_{\mathcal PC}$. The procedure is similar as in the ep-groupoid case and we just sketch the 
basic points and leave details to the reader.

As before the new category ${\mathcal PC}({\bf E}^{-1})$ has the same objects as the category ${\mathcal PC}$.
In order to define the morphisms in the new category we
consider  diagrams 
$$
d\colon F\xleftarrow{\Gamma} A\xrightarrow{\varepsilon} F'
$$
where $F$, $A$, and $F'$ are proper coverings of ep-groupoids, $\Gamma$ an equivalence of proper coverings, and $\varepsilon$ a functor between proper coverings.
We shall call $d$  a {\bf diagram from $F$ to $F'$} and we shall write $d\colon F\rightarrow F'$.

\begin{definition}\index{D- Common refinement}
Assume we are given two diagrams $d,d'\colon F\rightarrow F'$ between proper coverings.
A {\bf common refinement} for the diagrams $d,d':F\rightarrow F'$ is given 
by equivalences $H:A''\rightarrow A$ and $H':A''\rightarrow A'$ giving the diagram
$$
\begin{CD}
F @< \Gamma<< A @>\varepsilon >> F'\\
  @.         @A H AA   @.\\
@.     A''     @. \\
@.  @V H' VV @.\\
F @<\Gamma' << A' @>\varepsilon' >> F'
\end{CD}
$$
so that $\Gamma \circ H\simeq \Gamma'\circ H'$ and $\varepsilon\circ H\simeq \varepsilon'\circ H'$.
\qed
\end{definition}
Having a common refinement defines an equivalence relation as the following proposition shows.
\begin{proposition}
Assume that $d,d',d'':F\rightarrow F'$ are diagrams between proper coverings.  If $d$ and $d'$ have a common refinement and $d', d''$ have a common refinement,
then $d, d''$ have a common refinement.
\end{proposition}
\begin{proof}
We consider the diagrams 
$$
\begin{array}{cc}
\begin{CD}
F @< \Gamma<< A @>\varepsilon >> F'\\
  @.         @A H AA   @.\\
@.     A''     @. \\
@.  @V H' VV @.\\
F @<\Gamma' << A' @>\varepsilon' >> F'
\end{CD}
&
\begin{CD}
F @< \Gamma'<< A' @>\varepsilon' >> F'\\
  @.         @A K AA   @.\\
@.     B''     @. \\
@.  @V K' VV @.\\
F @<\Gamma''<< B'' @>\varepsilon'' >> F'.
\end{CD}
\end{array}
$$
By assumption 
$$
\Gamma\circ H\simeq \Gamma'\circ H',\ \varepsilon\circ H\simeq \varepsilon'\circ H',\
\Gamma'\circ K\simeq \Gamma''\circ K',\ \varepsilon'\circ K\simeq \varepsilon''\circ K'.
$$
We  take the weak fibered product associated to 
$$
A''\xrightarrow{H'} A' \xleftarrow{K} B''
$$
 resulting in
$A''\times_{A'} B''$. In view of Theorem \ref{THM1165}  the  projections $\pi_{A''}$ and $\pi_{B''}$ are equivalences
between proper coverings  since $H'$ and $K$ are equivalences. Moreover, again by Theorem \ref{THM1165}
$$
H'\circ \pi_{A''}\simeq K \circ \pi_{B"}.
$$
Consider
$$
\begin{CD}
F@<\Gamma<< A @>\varepsilon>> F'\\
@.   @A  H\circ \pi_{A''}AA@.\\
@.    A''\times_{A'} B'' @.\\
@.    @V K'\circ \pi_{B''}VV   @.\\
F @<\Gamma''<< B'' @ >\varepsilon''>> F'.
\end{CD}
$$
We note that 
$$
\Gamma\circ (H\circ \pi_{A''})\simeq \Gamma'\circ H'\circ \pi_{A''}\simeq \Gamma'\circ K\circ \pi_{B''}\simeq\Gamma''\circ (K'\circ \pi_{B''}),
$$
and
$$
\varepsilon\circ (H\circ\pi_{A''})\simeq \varepsilon'\circ H'\circ \pi_{A''}\simeq \varepsilon'\circ (K\circ \pi_{B''}).
$$
This concludes the proof that having a common refinement defines an equivalence relation.
\qed \end{proof}
The morphisms in our new category ${\mathcal PC}({\bf E}^{-1})$ will be the equivalence classes
$[d]$ of diagrams. We need to define a composition. As in the ep-groupoid case 
we define for $d:F\rightarrow F'$ and $d':F'\rightarrow F''$ the composition 
$[d']\circ [d]:F\rightarrow F''$ as follows. Writing more precisely
$$
F\xleftarrow{\Gamma} A\xrightarrow{\varepsilon} F'\xleftarrow{\Gamma'} A'\xrightarrow{\varepsilon'} F''
$$
we take the weak fibered product $A\times_{F'} A'$ associated to the part $A\xrightarrow{\varepsilon} F'\xleftarrow{\Gamma'} A'$ 
and define a new diagram $d''$ by
$$
d''\colon F\xleftarrow{ \Gamma\circ \pi_{A}}  A\times_{F'} A'\xrightarrow{\varepsilon'\circ \pi_{A'}} F''.
$$
As in the ep-groupoid case the equivalence class of the diagram $d''$ is independent of the representatives
picked in $[d]$ and $[d']$. Hence we define 
$$
[d']\circ [d]:= [d''].
$$
The identities in the new category are given by $[F\xleftarrow{1_F} F\xrightarrow{1_F} F]$ and the inverses
to $[F\xleftarrow{\Gamma} A\xrightarrow{\Gamma'} F']$ by $[F'\xleftarrow{\Gamma'} A\xrightarrow{\Gamma}F]$.
The verifications are purely formal and follow the scheme used in the ep-groupoid case.
There exists a natural functor
$$
I: {\mathcal PC}\rightarrow {\mathcal PC}({\bf E}^{-1})
$$
which is the identity on objects and on morphisms $\varepsilon:F\rightarrow F'$  is defined by 
$$
I(\varepsilon) = [F\xleftarrow{1_F} F\xrightarrow{\varepsilon} F'].
$$
\begin{remark}\index{R- On strong polyfold bundles}
We can go one step further and incorporate strong bundles.  The following discussion
uses the results from Section \ref{cov_g} and Section \ref{STE__x}.

Recall from Section \ref{cov_g}
the definition of proper strong bundle covering functors, see Definition \ref{proper_sb_covering}.

Let $(W,\mu)$ and $(V,\tau)$ be strong bundles over ep-groupoids $Y$ and $X$, respectively.
A {\bf proper strong bundle covering functor} is a strong bundle map $A$  (in particular fiberwise linear), for which the diagram
\begin{eqnarray}\label{EQN1111}
\begin{CD}
W @> A>>  V\\
@V P VV @ V Q VV\\
Y @> F >> X
\end{CD}
\end{eqnarray}
is commutative and which has 
the following additional properties.
\begin{itemize}
\item[(1)]\ $A$ is surjective and a local strong bundle isomorphism covering a sc-smooth proper covering functor $F:Y\rightarrow X$.
\item[(2)]\  The preimage $F^{-1}(x)$ of every object $x\in X$  is finite,  and there exist open neighborhoods $U(x)\subset X$ and $U(y)\subset Y$ for every $y\in F^{-1}(x)$, where the sets $U(y)$ are mutually disjoint, such  that the map
$$
A:W\vert U(y)\rightarrow V|U(x)
$$
 is a strong bundle isomorphism for every $y\in F^{-1}(x)$, and
 $$
 F^{-1}(U(x))=\bigcup_{y\in F^{-1}(x)} U(y).
 $$
 \item[(3)]\ The map 
 $$
\bm{W}\rightarrow \bm{V}{_{s}\times_A} W:(\psi,w)\rightarrow ((F(\psi),A(w)),w)
 $$
 is a strong bundle isomorphism covering the sc-diffeomorphism $\bm{Y}\rightarrow \bm{X}{_{s}\times_F}Y:\psi\rightarrow (F(\psi),s(\psi))$. Here the strong bundle projection
 $$
 \bm{V}{_{s}\times_A} W\rightarrow \bm{X}{_{s}\times_F} Y
 $$
  is given by $((\phi,v),w)\rightarrow (\phi,P(w))$.
 \end{itemize}
 For the economy of notation we shall introduce the following notation.  A {\bf proper strong bundle covering} $A$
 refers to $A:W\rightarrow V$ and the rest of the data in 
 the diagram (\ref{EQN1111}) is implicitly assumed.   Sometimes we shall write instead of $A$ more comprehensively
 $A\rightarrow F$ to emphasize the underlying proper covering between ep-groupoids.
 If we need to reveal for an argument more data we use the full diagram (\ref{EQN1111}).
 
 There is a category ${\mathcal SBPC}$ where the objects are proper coverings between strong bundles $A$
 and the morphisms are (pairs of ) functors $a: A\rightarrow A'$. There is a again a natural notion of equivalence
 and one can carry out the associated localization procedure resulting in 
 ${\mathcal SBPC}[{\bf E}_{{\mathcal SBPC}}^{-1}]$. The details are left to the reader.
 \qed
  \end{remark}
 




\begin{partbacktext}
\part{Fredholm Theory in Ep-Groupoids}
\noindent 
In this part we bring the sc-Fredholm theory into the context of ep-groupoids.
We introduce  sc$^+$-multisections and prove associated extension results.
We  introduce the integration results in the ep-groupoid context and discuss
orientation and transversality questions.  The core of  Part {III} consists of the Chapters \ref{CHAPH12} to \ref{CHAPX16}
and extends the work in \cite{HWZ3,HWZ3.5,HWZ7,HWZ7err}.

In Chapter \ref{chap11+} we explore the previous study of the  notions,  which are invariant under equivalences.
This leads to the generalization of the usual finite-dimensional theory of orbifolds and their bundles to the M-polyfold framework.
The results are immediate consequences of the discussion in the core chapters and we allow ourselves to be brief.
In fact, we  restrict ourselves to ourselves to the basic notions and  some sample results.
The reader is encouraged to bring other results into this framework.
The origin of \ref{chap11+} is in the paper \cite{HWZ3.5}.

\end{partbacktext}

\chapter{Sc-Fredholm Sections}\label{CHAPH12}
We shall develop the sc-Fredholm theory for sc-Fredholm section functors $f$. 
  This means we shall discuss their compactness properties
 and develop a transversality and perturbation theory. The functorial property of $f$ means that $f$ locally respects certain symmetries.
 It is a known fact that symmetry and transversality are antagonistic concepts, i.e. in general it is impossible to achieve transversality by using perturbations 
 respecting symmetries. For this reason we have to develop a multi-valued perturbation theory. 

 
 \section{Introduction and Basic Definition}


The definition of an sc-Fredholm section follows immediately from the definitions in the M-polyfold case,
see Definition \ref{oi}.
 We shall consider a strong bundle over an  ep-groupoid $(P:W\rightarrow X,\mu)$ and an sc-smooth section functor 
 $f:X\rightarrow W$. 
 \begin{definition}\index{D- Sc-Fredholm functor}
 The sc-smooth section functor $f$ of $P$ is said to be a {\bf sc-Fredholm section functor}  provided $f$ as an sc-smooth section 
 of the strong bundle $W\rightarrow X$ over the  M-polyfold $X$, the object space, is sc-Fredholm.
 \qed
 \end{definition}
 This means in particular that $f$ is {\bf regularizing} in the following sense.  If $x$ is an object in $X_m$ and $f(x)\in W_{m,m+1}$, then
 $x\in X_{m+1}$. The regularizing property for morphisms holds as well.
To see this, assume that $\phi:x\rightarrow y$ is a morphism in $\bm{X}_{m}$ and $f(\phi)\in \bm{W}_{m,m+1}$.
Using  $f(s(\phi))= s(f(\phi))$ we see that $s(\phi)\in X_{m+1}$ implying that $\phi\in \bm{X}_{m+1}$.
 Moreover, for every smooth object $x\in X$ the germ $(f,x)$ has a filled version $(g,0)$ so that $(g-s,0)$
 for a suitable local sc$^+$-section is conjugated to a basic germ. 
 
In the following discussion we shall introduce the functor versions of the concepts already appearing in the 
M-polyfold version of the sc-Fredholm theory.
 

 
 
 
 \section{Auxiliary Norms}\label{anorms-ssect}
In  Part I  we have introduced  the notion of an  auxiliary norm for  an M-polyfold. In this section we generalize this concept  to ep-groupoids by incorporating  morphisms.
The additional requirement is the compatibility with morphisms.

\begin{definition}[{\bf Auxiliary norm}] \label{auxuilary_norm_def}\index{D- Auxiliary norm for $(P, \mu)$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid according to Definition \ref{strong_bundle_ep}. We denote by $W_{0,1}$ the topological space defined by 
$$
W_{0,1}=\{h\in W\ |\ h\ \text{has bi-regularity}\ \ (0,1)\}, 
$$
and by $P:W_{0,1}\rightarrow X$ the projection onto the object space $X$. The fibers $P^{-1}(x)$  are,  as usual,  Banach spaces.
An {\bf auxiliary norm $N$\index{$N$} for $(P,\mu)$}  is a continuous map $N:W_{0,1}\rightarrow [0,\infty)$ having the following properties.
\begin{itemize}
\item[(1)]\ The restriction of $N$ to each fiber $P^{-1}(x)$ is a complete norm.
\item[(2)]\ If $(h_k)$ is a sequence in $W_{0,1}$ such  that $(P(h_k))$ converges in $X$ to some $x$, and $N(h_k)\rightarrow 0$, then $h_k\rightarrow 0_x$ in $W_{0,1}$.
\item[(3)]\ If  $h=\mu(\phi,k)$ for $\phi\in {\bf X}$ and $k\in W_{0,1}$ satisfying  $s(\phi)=P(k)$,  then 
$$N(h)=N(k).$$
\end{itemize}
\qed
\end{definition}
If we ignore the compatibility with morphisms for the moment,  it is easy to construct an auxiliary norm locally, see Part I.
However, in order to construct an auxiliary norm globally we need partitions of unity and we have to incorporate the compatibility with morphisms. 
These partitions of unity do not have to be sc-smooth, since we do not require $N$ to have smoothness properties. Nevertheless
we need their existence and therefore  have to assume paracompactness of the orbit space $|X|$.
The main result in this section guarantees
an auxiliary norm for strong bundles over ep-groupoids whose orbit spaces  are paracompact.

\begin{theorem}\label{ANorm1-prop}\index{T- Existence of auxiliary norms}
Every strong  bundle $P \colon W\rightarrow X$  over an ep-groupoid $X$ with paracompact orbit space $|X|$ admits
an auxiliary norm.
\qed
\end{theorem}
The proof requires some preparation and we start with continuous partitions of unity. Recall that a subset $A$ of an ep-groupoid $X$  is saturated
provided $A=\pi^{-1}(\pi(A))$, where $\pi:X\rightarrow |X|$ is the quotient map.
\begin{definition}\index{D- Partitions of unity on ep-groupoids}
Let $X$ be an ep-groupoid with paracompact orbit space $|X|$. A {\bf continuous partition of unity of the ep-groupoid}  $X$ 
consists of a family of continuous functions $\beta_\lambda:X\rightarrow [0,1]$, $\lambda\in\Lambda$, defined on the object space $X$ and  possessing the  following properties.
\begin{itemize}
\item[(1)]\ If there exists a morphism $\phi:x\rightarrow y$, then $\beta_\lambda(x)=\beta_\lambda(y)$ for all $\lambda$.
\item[(2)]\ For every  point $x\in X$ there exists a saturated open neighborhood $U(x)$ such  that there are only finitely many indices $\lambda$ for which 
$\supp(\beta_\lambda)\cap U(x)\neq \emptyset$.
\item[(3)]\ $\sum_{\lambda\in\Lambda}\beta_\lambda(x)=1$  for every $x\in X$. The  sum is locally finite in view of  property  (2).
\end{itemize}
\qed
\end{definition}
The existence of a continuous partition of unity for the ep-groupoid $X$ is equivalent to  the existence of such a partition on  the orbit space $|X|$.
Indeed,  if $(\what{\beta}_\lambda)$ is a continuous partition of unity for  $|X|$, then $(\beta_\lambda=\what{\beta}_{\lambda}\circ \pi)$ is one for  $X$. Conversely, a continuous partition of unity $(\beta_\lambda)$
for  $X$ descends, in view of (1),  to one on the quotient space $|X|$.
\begin{definition}
Given an open cover ${(U_\lambda)}_{\lambda\in\Lambda}$ of saturated sets for the ep-groupoid $X$, a {\bf subordinate continuous partition of unity}
is a continuous partition of unity for the ep-groupoid $X$ indexed by the same set , say ${(\beta_\lambda)}_{\lambda\in\Lambda}$ (some of the functions might vanish),
such that $\supp(\beta_\lambda)\subset U_\lambda$ for all $\lambda\in\Lambda$.
\qed
\end{definition}

\begin{proposition}\index{P- Existence of continuous  partitions of unity on ep-groupoids}
Consider an ep-groupoid $X$ with paracompact orbit space $|X|$ . Then for every open cover by saturated sets there exists an subordinate continuous partition of unity for the object M-polyfold  $X$.
\end{proposition}
\begin{proof}
If $(U_\lambda)$ is an open cover of saturated sets, then 
$(\pi(U_\lambda))$ is an open cover of $|X|$ and we can take a subordinate continuous partition of unity $(\what{\beta}_\lambda)$. Then $\beta_\lambda:=\what{\beta}_{\lambda}\circ \pi$ is the desired partition of unity on $X$ where some of the functions $\beta_\lambda$ may vanish identically.
\qed \end{proof}

In order to construct the auxiliary norm, the neighborhoods have to be chosen carefully.
This is accomplished by the following theorem, which will be used quite frequently.
We shall refer to the theorem as the good neighborhood theorem.
\begin{theorem}[{\bf Good Neighborhood Theorem}]\label{river}\index{T- Good neighborhood}
Let $P:W\rightarrow X$ be a strong bundle over an ep-groupoid $X$.
 Then every object $x\in X$ possesses open neighborhoods $U'(x)$ and $U''(x)$ having  the following properties.
\begin{itemize}
\item[{\em (1)}]\ $\cl_X(U'(x))\subset U''(x)$.
\item[{\em (2)}]\ $U''(x)$ admits the  natural $G_x$-action (defined by $(\Phi, \Gamma)$),  which leaves $U'(x)$ invariant,
 i.e., $\Phi (g)(U'(x))=U'(x)$ for all $g\in G_x$. 
\item[{\em (3)}]\ $W\vert U''(x)$ is strong bundle isomorphic to a local model $K\rightarrow O$, where we use the local models  $(O,C,E)$ and $(K, U\triangleleft  F, E\triangleleft F)$.
\item[{\em (4)}]\ A  sequence of morphisms $(\phi_k)\subset {\bf X}$ satisfying $s(\phi_k)\in \cl_X(U''(x))$ and $t(\phi_k)\rightarrow z\in X$ possesses a subsequence converging to 
$\phi\in {\bf X}$ satisfying  $s(\phi)\in\cl_X(U''(x))$ and $t(\phi)=z$.
 \item[{\em (5)}]\ If $U(x)=\pi^{-1}(\pi (U'(x)))$ is the saturation of $U'(x)$, then  $$
(U(x)\setminus U'(x) )\cap \cl_X(U''(x)) =\emptyset.
$$
\end{itemize}
\end{theorem}
\begin{proof}
If $x\in X$ we choose by Theorem \ref{x-local-x} an open neighborhood $V(x)$ on which we have the natural $G_x$-action defined by $(\Phi, \Gamma)$  such that the map  
 $t\colon s^{-1}(\cl_X(V(x)))\rightarrow X$ is proper, and there exists a strong bundle isomorphism between $W|V(x)$ and a local strong bundle model.
 Then we  take open neighborhoods $U''(x)$ and $U'(x)$ satisfying 
$$
U'(x)\subset \cl_X(U'(x))\subset U''(x)\subset \cl_X(U''(x))\subset V(x)
$$
and such that $U'(x)$ and $U''(x)$ are invariant under the diffeomorphisms $\Phi (g)$, $g\in G_x$.  At this point (1)-(4) hold and it remains to prove  (5).

Arguing by contradiction we assume that $(U(x)\setminus U'(x))\cap \cl_X(U''(x))\neq \emptyset$. Hence we  find  a morphism $\phi:y\rightarrow z$ from 
$y\in \cl_X(U''(x))\setminus U'(x)$ to  $z\in U'(x)$.  Since $y,z\in V(x)$ there exists a uniquely determined $g\in G_x$ satisfying
$\phi=\Gamma(g,y)$. Consequently,  $z=t(\Gamma(g,y))=\Phi (g)(y)$. Since $z\in U'(x)$ and $U'(x)$ is invariant,  it follows that $y\in U'(x)$ contradicting $y\not \in U'(x)$.
\qed \end{proof}
Now we can prove the main result.
\begin{proof}[Proof of Theorem \ref{ANorm1-prop}]
Let  $U(x)=\pi^{-1}(\pi(U'(x)))$ be the saturation of $U'(x)$ where $U'(x)$ has the properties listed in Theorem \ref{river}. The sets $|U(x)|=|U'(x)|=\pi(U'(x))$, where $x$ varies over $X$,
define an open cover of $|X|$. Since $\abs{X}$  is assumed to be paracompact, we find a subordinate partition of unity  $(\what{\beta}_x)$ for $|X|$, and define for the open cover $(U(x))$ of $X$ the partition of unity 
$\beta_x=\what{\beta}_x\circ\pi$.
For every $x\in X$ we can take $U'(x)$ and fix a strong bundle isomorphism $\Psi:W|U'(x)\rightarrow K$ covering $\psi:U'(x)\rightarrow O$.
Here we use models $(O,C,E)$ and $(K,C\triangleleft F,E\triangleleft F)$.



On $W|U'(x)\rightarrow U'(x)$ we define the action of $G_x$ by the 
\begin{equation}\label{eq_star}
g\ast w= \mu(\Gamma(g, P(w)),w)\quad \text{for $g\in G_x$, $w\in W\vert U'(x)$}
\end{equation}
recalling that $s( \Gamma(g, P(w)))=P(w)$. We note  that $P(g\ast w)= P(\mu(\Gamma(g,y),w))=t(\Gamma (g, P(w))=\Phi(g)(P(w))$ and hence,
$$P(g\ast w)=\Phi(g)(P(w)).$$
In order to verify that \eqref{eq_star} defines a group action we have to recall from the natural representation in Theorem \ref{x-local-x}, the homeomorphism $\Phi$ and the map $\Gamma$, and from Definition \ref{strong_bundle_ep}, the properties of the strong bundle map $\mu\colon {\bf X}{_{s}\times_P} W\to W$. If $g=1_x$, then $\Gamma (1_x, P(w))=1_x$ and $\mu (1_x, w)=w$ for all $w$, and hence $1_x\ast w=w$. 

Moreover, 
\begin{equation*}
\begin{split}
\gamma\ast (g\ast w)&=\mu (\Gamma (\gamma , P(g\ast w)), g\ast w)=
\mu (\Gamma (\gamma , P(g\ast w), \mu (\Gamma (g, P(w)), w)\\
&=
\mu (\Gamma (\gamma , P(g\ast w)\circ \Gamma (g, P(w)), w).
\end{split}
\end{equation*}
Since $t(\Gamma (g, P(w))=\Phi (g)(P(w))$ and $s(\Gamma (\gamma, P(g\ast w)))=\Phi (\gamma )\Phi (g)(P(w))=\Phi (\gamma \circ g)(P(w))$, the composition above is a morphism
$$P(w)\to \Phi (\gamma \circ g)(P(w)),$$
and hence is equal to 
$\Gamma (\gamma \circ g, P(w))$ in view of the properties of $\Gamma$. Consequently, 
$$\gamma \ast (g\ast w)=\mu (\Gamma (\gamma \circ g, P(w)), w)=(\gamma \circ g)\ast w$$
and \eqref{eq_star} defines indeed a group action of $G_x$.  It is the {\bf natural lift} of the natural $G_x$-action on $U'(x)$ to the bundle $W\vert U'(x)$. 


We define on $W_{0,1}|U'(x)$ the map $N'_x\colon W_{0,1}|U'(x)\rightarrow [0,\infty)$ by 
$$
N_x'(w)=\frac{1}{\abs{G_x}}\cdot \sum_{g\in G_x}\norm{\pr_2\circ\Psi(g\ast w)}_{F_1}.
$$

The map $N_x'$ is invariant under the group action of $G_x$, i.e.,  
$$
N_x'(h\ast w)=N_x'(w)
$$
for all $h\in G_x$ and 
$w\in W_{0,1}\vert U'(x)$.  

Next we extend the definition to $W_{0,1}|U(x)$.
If  $w\in W_{0,1}\vert U(x)$ with base point $y=P(w)\in U(x)$, there is a  morphism $\phi$ satisfying  $s(\phi)=y$ and $t(\phi)\in U'(x)$,  and we 
define 
$$N''_x(w)=N'_x(\mu(\phi,w)).$$
Here, as before,  $\mu$ is the structural map of the strong bundle structure. 
This is well-defined and the extension is compatible with the initial definition of $N_x'$.
 Next we define the function $N_x:W_{0,1}\rightarrow [0,\infty)$ as follows.
$$
N_x(w)=\begin{cases}
0 &\quad  \text{if $P(w)\not\in U(x)$}\\
\beta_x(P(w))\cdot N''_x(w)&\quad  \text{if $P(w)\in U(x)$}.
\end{cases}
$$
In order to show  that $N_x$ is a continuous function we assume that $w_k\rightarrow w$ in $W_{0,1}$.  If $P(w)=y\in U(x)$, then   $y_k=P(w_k) \in U(x)$   for large 
$k$.  Since $U(x)$ is the saturation of $U'(x)$,  we find a morphism $\phi\colon y\rightarrow z$ with $z\in U'(x)$.
We define $w'=\mu (\phi, w)$ so that 
$P(w')=P\mu (\phi, w)=t(\phi)=z\in U'(x)$. For $k$ large we similarly define for the sequence $w_k$ satisfying $P(w_k)=y_k\in U(x)$ the sequence $w_k'=\mu (t\circ s^{-1}(y_k), w_k)$. 
Since $w_k\to w$ in $W_{0,1}$ and $\mu$ and $t\circ s^{-1}$ are local sc-diffeomorphisms, we conclude $w_k'\to w'$.  Therefore, $N_x'(w_k')\to N_x'(w')$ and so, $N_x(w_k)\to N_x(w).$

If $P(w)\not \in U(x)$ we know that $N_x(w)=0$. If $P(w)$ does not belong to the closure of $U(x)$,  the continuity assertion is trivial.
Hence we assume that $P(w)\in \cl_X(U(x))\setminus U(x)$. By construction,  $\supp(\beta_x)$ is a closed subset in $X$ contained in $U(x)$.
We find an open neighborhood $V(P(w))$ in $X$ not intersecting the support of $\beta_x$. If now $w_k\rightarrow w$, then $P(w_k)\in V(P(w))$ for large 
$k$,  and the continuity assertion follows.


Clearly, if $\beta_x(y)\neq 0$,  then $N_x''$,  restricted to the fiber of $W_{0,1}$  over $y$,  is a complete norm.
Assume that $(w_k)$ is a sequence so that $y_k=P(w_k)$ has the properties
\begin{itemize}
\item[(1)]\  $y_k\rightarrow y$ with $\beta_x(y)>0$.
\item[(2)]\ $N_x(w_k)\rightarrow 0$.
\end{itemize}
Then we  find as above an isomorphic sequence $(w_k')$ for which  $P(w'_k)=y_k'\rightarrow y'\in U_x'$. It follows from the construction of $N_x'$
that $w_k'\rightarrow 0_{y'}$ and the same holds evidently for $(w_k)$. 

Finally,  we define the function $N\colon W_{0,1}\to [0,\infty)$ by 
$$
N=\sum_{x\in X} N_x.
$$
Given any $y\in X$ there exists,  by construction,  a saturated open neighborhood $V=V(y)$ in $X$ so that there are only finitely many
$x\in X$ for which $N_x\neq 0$ for the fibers above $y$. This shows that $N$ is continuous. It clearly induces fiber-wise a complete norm on $W_{0,1}$.
Moreover, if $N(w_k)\rightarrow 0$ and $P(w_k)\rightarrow y$ there is at least one $x$ for which  $\beta_x(y)>0$. We conclude
that $w_k\rightarrow 0_y$ in $W_{0,1}$ by the previous discussion.

We have verified that the function $N$ is an auxiliary norm for $(P,\mu)$ and the proof of Theorem \ref{ANorm1-prop} is complete.
\qed \end{proof}

In certain applications we shall need to extend given auxiliary norms
over $\partial X$ to auxiliary norms over
 $X$. The basic result is the following theorem, where the reader should note that we require 
 $X$ to be a tame ep-groupoid.
\begin{theorem}[{\bf Extension of Auxiliary Norms}]\label{EXTT}\index{T- Extension of auxiliary norms}
Let $(P\colon W\rightarrow X,\mu)$ be a strong bundle over a  tame   ep-groupoid $X$ with paracompact orbit space $|X|$.
Suppose $N$ is an auxiliary norm given for $W|\partial X$, i.e., 
$$
N:W_{0,1}|\partial X\rightarrow [0,\infty)
$$
has the properties required in Definition \ref{auxuilary_norm_def}. Then there exists an auxiliary norm $\wtilde{N}:W_{0,1}\rightarrow [0,\infty)$
which coincides over $\partial X$ with $N$.
\end{theorem}
\begin{proof}
It is clear from the proof of Theorem \ref{ANorm1-prop} that we only need to show, for every $x\in \partial X$, that $N$ has
a local extension to a saturated small open neighborhood. The proof of Theorem  \ref{ANorm1-prop} shows how to define 
auxiliary norms on saturated open neighborhoods $U(x)$ for which we assume that $\cl_X(U(x))\cap \partial X=\emptyset$.
Then a partition of unity argument,  as previously used, gives an auxiliary norm for $W_{0,1}\rightarrow X$.

Since the construction is local we can work in local coordinates.  Hence we consider  a strong local bundle $P:K\rightarrow O$,
where $(O,C,E)$ is a tame 
local M-polyfold model and $K\subset C\triangleleft F$ is the image of a strong bundle retraction
$R:U\triangleleft F\rightarrow U\triangleleft F$ covering the sc-smooth retraction $r:U\rightarrow U$ satisfying  $r(U)=O$,  and $U\subset C$ is open in the partial quadrant $C=[0,\infty)^n\oplus H$ in the sc-Banach space $E$. Since $r$ is tame it satisfies $d_C(r(x))=d_C(x)$ for $x\in U$, which will be important. 
We may assume that we work near a point $x_0=(0,h_0)\in O$. (We cannot assume that $h_0\in E$ is zero, since $x_0$ may be on level $0$).
We shall first carry out a local construction, in order to construct $\wtilde{N}$ on $W_{0,1}|U'(x_0)$. Here $U'(x_0)\subset O$ is an open neighborhood
invariant under $G_x$ and $\tilde{N} =N$ on $W_{0,1}|(\partial O\cap U'(x_0))$. 

We  now turn to the details. We abbreviate  $e_0=(1,1,1,\ldots ,1,0)\in C=[0,\infty)^n\oplus H$. Then there exists a $\ssc^0$-function  $\tau\colon C\rightarrow [0,\infty)$ so that for given $(t,h)\in [0,\infty)^n\oplus H$ the vector $(t,h)-\tau(t,h)e_0$ has at least 
one of its first $n$-coordinates vanishing.  The map $\tau$ only depends on $t$, and is given by 
$$
\tau(t,h) =\min\{t_1,\ldots ,t_n\}.
$$
Then the map 
$$
\text{$q\colon C\rightarrow C$, \quad  defined by \quad $q(t,h)=(t,h)-\tau(t)e_0$}, 
$$ 
is a $\ssc^0$-retraction onto $\partial C$.  If  $(t,h)\in  [0,\infty)^n\oplus H$  is near $(0,h_0)$, then  $(t,h)\in U$
and $r(q(t,h))\in U$. Using the tameness property of $r$ we see that  $r(q(t,h))\in O\cap  \partial C =\partial O$. Also for $(t,h)\in \partial O$
it holds that $r(q(t,h))=r(t,h)=(t,h)$
Consequently, 
$$
(t,h)\mapsto r(q(t,h))
$$
is a $\ssc^0$-retraction defined near $(0,h_0)$, which fixes the points in $\partial O$ near $(0,h_0)$.
 For  $((t,h),w)\in K$ in which  $(t,h)$ is close to $(0,h_0)$ and $w$ is on level $1$,   we define $N'$ by 
$$
N'((t,h),w)= N(r(q(t,h)),A(r(q(t,h)))w) + \norm{w-A(r(q(t,h)))w}_{F_1}, 
$$
where $R(u,w)=(r(u),A(u)w)$ is the strong bundle retraction. If $((t,h),w)\in K$ with $(t,h)\in \partial O$ near $(0,h_0)$, then $R((t, h), w)=(r(t, h), A(t, h)w)=((t, h), w)$ and $r(q(t, h))=r(t, h)=(t, h)$. Consequently, 
$$
N'((t,h),w)=N((t,h),w).
$$
Therefore $N'$ extends $N$. At this point we have constructed for $W_{0,1}\vert U'(x_0)$ an extension of $N$, where $U'(x_0)$
is a sufficiently small open neighborhood of $x_0$ in $O$, which we may assume to be invariant under the $G_{x_0}$-action.
Now we average $N'$ over the group $G_{x_0}$ to obtain as a result $N''$. Since $N$ was already compatible with morphisms,  the averaged $N''$ is still an extension 
of $N$. 

At this point we leave the local coordinates. Pulling back the local data by a strong bundle chart we have proved the following local extension result.
Under the assumptions of the theorem there exists for every $x\in \partial X$ an open neighborhood $U'(x)\subset X$ invariant under $G_x$
and an auxiliary norm $N_x'' :W_{0,1}|U'(x)\rightarrow [0,\infty)$ so that $N=N''_x$ on $W_{0,1}|(\partial X\cap U'(x))$.  Moreover,
if $\phi\in {\bf X}$ satisfies  $s(\phi),t(\phi)\in U'(x)$ and $w'=\mu(\phi,w)$, then $N''_x(w)=N_x''(w')$.  By taking $U'(x)$ smaller but still invariant under
$G_x$, we may assume that  every sequence of morphisms $(\phi_k)$ with $s(\phi_k)\in \cl_X(U'(x))$ and $(t(\phi_k))$ in a compact subset, has a convergent
subsequence. We can extend, as already demonstrated  previously in the proof of Theorem \ref{ANorm1-prop}, $N''_x$ to the saturation $U(x)$ of $U''(x)$. 
So far  we have constructed for every $x\in \partial X$ an extension of $N$ to a saturated open neighborhood $U(x)\subset X$.
We already know how to define auxiliary norms for saturated open neighborhoods of points $x\in X\setminus\partial X $.
In this case we may assume that the saturated open neighborhoods are small enough, so that their closures do not intersect $\partial X$. 
Finally,  using a partition of unity argument,  we obtain an auxiliary norm possessing the desired properties. The proof of Theorem \ref{EXTT} 
is complete.
\qed \end{proof}

The strong bundle  $P\colon W\rightarrow X$ over an ep-groupoid is said  to have  {\bf reflexive
$1$-fibers}\index{Reflexive $1$-fibers} if there exists a strong bundle atlas with local strong bundle models $K\subset C\triangleleft F$ in which 
 $F_1$ is a reflexive Banach space, and $C\subset E$ a partial quadrant in a sc-Banach space. Following \cite{HWZ3}
 we introduce the notion of mixed convergence.  
  \begin{definition}[{\bf Mixed convergence}]\label{DEFP1228}\index{D- Mixed convergence}
 A sequence $(w_k)\subset W$ of bi-regularity $(0,1)$, i.e. $w_k\in W_{0,1}$, is said to be {\bf mixed convergent} to
 an element $w\in W_{0,1}$ provided $P(w_k)\rightarrow P(w)=:x$ in $X_0$, and there exists a strong bundle chart
 $\Psi:W|U(x)\rightarrow K\subset E\triangleleft F$ ($F_1$ being reflexive),  
 such  that for  $\Psi(w_k)=(a_k,h_k)$ and $\Psi(w)=(a,h)$  the sequence $h_k$ converges weakly to $h$ in $F_1$,  denoted by $h_k\rightharpoonup h$ in $F_1$.
 We shall write
 $$
 w_k\stackrel{m}{\longrightarrow} w
 $$
if  $w_k$ is mixed convergent to $w$.
\qed
\end{definition}
\begin{remark}\index{R- On mixed convergence}
 The definition does not depend on the choice of the chart $\Psi$. Indeed, if $\Phi:K\rightarrow K'$
is a strong bundle isomorphism (arising as a transition map) and $\Phi(a,h)=(\phi(a),A(a,h))$, we consider a sequence $w_k=(a_k,h_k)\in K$ satisfying $a_k\rightarrow a$ in $E_0$ and 
$h_k\rightharpoonup h$ in $F_1$. The latter implies that $h_k\rightarrow h$ in $F_0$.
Then $\Phi(a_k,h_k)=:(b_k,l_k)$ satisfies $b_k\rightarrow b$ in $E_0'$ and $l_k\rightarrow  l$ in $F_0'$.
For large $k$,  the operator norms of continuous linear operators $A(a_k,\cdot )\colon F_1\rightarrow F_1'$ are uniformly bounded.  Therefore,  the sequence 
$(l_k)=(A(a_k,h_k))$ is bounded in $F_1'$.
From  $h_k\rightarrow h$ in $E_0$ we conclude the convergence  $(b_k,l_k)=\Phi(a_k,h_k)\rightarrow \Phi(a,h)=:(b,l)$ in $E_0'\oplus F_0'$. The boundedness of $(l_k)$ in $F_1'$ and the convergence of $(b_k,l_k)$ on level $0$ 
implies the weak convergence $l_k\rightharpoonup l$ in $F_1'$. 
\qed
\end{remark}
In the context of strong bundles with reflexive fibers we consider special auxiliary norms.
\begin{definition}\index{D- Reflexive auxiliary norm}
Let $P:W\rightarrow X$ be a a strong bundle over an ep-groupoid with reflexive $1$-fibers . A {\bf reflexive auxiliary norm}
$N:W_{0,1}\rightarrow [0,\infty)$ is a continuous map possessing  the following properties.
\begin{itemize}
\item[(0)]\ $N$ is a functor, i.e. if $h'=\mu(\phi,h)$ for $h,h'\in W_{0,1}$ and $\phi:P(h)\rightarrow P(h')$ a morphism in ${\bf X}$, then
$N(h)=N(h')$.
\item[(1)]\ For every $x\in X$ the function $N$,  restricted to the fiber of $W_{0,1}$ over $x$,  is a complete norm.
\item[(2)]\ If $(w_k)$ is a sequence in $W_{0,1}$  satisfying  $P(w_k)\rightarrow x$ in $X$ and $N(w_k)\rightarrow 0$,
then $w_k\rightarrow 0_x$ in $W_{0,1}$.
\item[(3)]\ If $(w_k)\subset W_{0,1}$ is mixed convergent to $w\in W_{0,1}$, then 
$$
N(w)\leq \text{liminf}_{k\rightarrow 0} N(w_k).
$$
\end{itemize}
\qed
\end{definition}
The next  result guarantees the existence of reflexive auxiliary norms for strong bundles $P:W\rightarrow X$
with reflexive $1$-fibers and paracompact orbit spaces $|X|$. 

\begin{theorem}[{\bf Reflexive auxiliary norms}]\label{EXTTT}\index{T- Reflexive auxiliary norms}
We assume 
$ P \colon  W\rightarrow X$ is a strong bundle  with reflexive $1$-fibers, over an ep-groupoid $X$ with paracompact orbit space $|X|$. Then there exists a  reflexive auxiliary norm $N$.  Moreover,  for every
functorial continuous map $f:X\rightarrow (0,\infty)$ i.e., $f$ is invariant under the morphisms, the map $h\rightarrow f(P(h))N(h)$ is a reflexive auxiliary norm.
For every auxiliary norm $N'$, there exist two reflexive auxiliary norms $N_1$ and $N_2$ 
satisfying
$$
N_1\leq N'\leq N_2.
$$
\qed
\end{theorem}
\begin{remark}\index{R- On the constructions of auxiliary norms}
Most of the constructions are similar to the  constructions in Theorem \ref{EXTT}. Before we begin with the proof 
let us note the following facts which are easily verified.
\begin{itemize}
\item[(1)]\ If $N$ is a reflexive auxiliary norm, so is $(f\circ P) \cdot N$, if  $f\colon X\rightarrow (0,\infty)$ is a functorial continuous map.
\item[(2)]\ If  $N_1$ and $N_2$ are two auxiliary norms, there is a function  $f$ as above such  that $N_1\leq (f\circ P) \cdot N_2$.
\item[(3)]\ If $U$ is a saturated open subset of $X$, and $N$ a reflexive auxiliary norm for $W_{0,1}|U$, then,  given a functorial
continuous map $f:X\rightarrow [0,\infty)$ with support $\supp(f)$ contained in $U$, the map $\wtilde{N}:W_{0,1}\rightarrow [0,\infty)$,  
defined by $\wtilde{N}(w)=0$ if $P(w)\not\in U$,  and by $\wtilde{N}(w)=f(P(w))N(w)$ if $P(w)\in U$, has the property that for a mixed convergent sequence 
$w_k\stackrel{m}{\longrightarrow}w$ the estimate $N(w)\leq \text{liminf}_{k\rightarrow \infty} N(w_k)$  holds. 
\end{itemize}
\qed
\end{remark}
\begin{proof}[Theorem \ref{EXTTT}]
It suffices to construct for every $x\in X$ an open saturated neighborhood $U$ and an reflexive auxiliary norm for $W_{0,1}|U$. 
Then the above facts and the construction in Theorem \ref{EXTT} will lead to the desired result.
Around  an object  $x\in X$ we  take a strong bundle chart $\Psi:W|U'(x)\rightarrow K$, where $K\subset C\triangleleft F$,
and $C$ is a partial quadrant in a sc-Banach space. Here $F_1$ is a reflexive Banach space.
We may assume that $U'(x)$ admits the natural $G_x$-action, which has a natural lift 
to $W|U'(x)$, and   
define 
$$
N_{U'(x)}(h) =\frac{1}{|G_x|} \sum_{g\in G_x} \norm{\text{pr}_2\circ \Psi(g\ast h)}_{F_1}.
$$
 We extend $N_{U'(x)}$ to the saturation ${U}(x)=\pi^{-1}(\pi (U'(x))$ of $U'(x)$ as follows.
 If $w\in W_{0,1}|{U}(x)$ there exists a morphism $\phi\colon P(w)\rightarrow y\in U'(x)$
 and we define $N_{{U}(x)}(w)=N_{U'(x)}(w')$, where $w'=\mu(\phi, w)$.
 The definition does not depend on the choice of the morphism $\phi$ as long as it has the stated properties.
 Then $N_{U(x)}$ has the desired properties and the proof is completed by a previous partition of unity argument.
 \qed \end{proof}

We also need for later inductive constructions an extension theorem for reflexive auxiliary norms.

\begin{theorem}[{\bf Extension of reflexive auxiliary norms}]\label{THMOP12213}\index{T- Extension of auxiliary norms}
Let $W$ be a strong bundle with reflexive 1-fibers over the tame  ep-groupoid $X$. We assume that a reflexive auxiliary norm
$N$ is given for $W_{0,1}\vert \partial X$. Then there exists a reflexive auxiliary $\wtilde{N}:W_{0,1}\rightarrow [0,\infty)$ which extends $N$, i.e.
$$
\wtilde{N}|(W_{0,1}|\partial X)= N.
$$
\end{theorem}
\begin{proof}
The local extension defined in Theorem \ref{EXTT} is well-behaved under mixed limits which follows immediately by inspection.
We can define local auxiliary norms over saturated neighborhoods of points $x\in X$ not belonging to the boundary, which are also 
well-behaved with respect to mixed convergence,  and the  argument is completed by partitions of unity,  as in  Theorem \ref{EXTTT}.
\qed \end{proof}


\section{\texorpdfstring{$\bssc^+$}{sssc}-Section  Functors}\label{SECR12.3}
The main point of this subsection is to show that  there is a significant supply of $\ssc^+$-sections under suitable conditions. In addition,  we show that $\ssc^+$-sections defined over the boundary can be extended to the whole ep-groupoid.  For the notion of a sc-smooth bump function in the M-polyfold framework we refer to   Part I.
\begin{definition}\label{d-ep-groupoid_bump}
An ep-groupoid $X$ {\bf admits sc-smooth bump functions}\index{D- Ep-groupoid admitting sc-smooth bump functions} provided for every
object $x$ and every saturated open neighborhood $U(x)$ there exists a sc-smooth map $f\colon X\rightarrow {\mathbb R}$ not identically $0$,  having its support in $U(x)$ and 
satisfying $f(y)=f(z)$ if  there exists a morphism $\phi:y\rightarrow z$.
\qed
\end{definition}
We point out  that in our definition we do not require $f$ to take values in $[0,1]$. 
As we shall see next there is an easy criterion to decide whether  the ep-groupoid admits sc-smooth bump function.

\begin{theorem}\label{t-bump_functions}\mbox{}\index{T- Bump functions}
Let $X$ be an ep-groupoid.
\begin{itemize}
\item[{\em (1)}]\ The ep-groupoid $X$ admits sc-smooth bump functions if and only if the underlying object M-polyfold admits sc-smooth bump functions. 
\item[{\em (2)}]\ If the ep-groupoid $X$ admits sc-smooth bump functions, then there exists for every object $x\in X$ and every saturated open neighborhood
$U(x)$ a sc-smooth bump function $f:X\rightarrow [0,1]$ satisfying $f(x)=1$ and $\supp(f)\subset U(x)$.
\end{itemize}
\end{theorem}
The subtle point  of the statement in (1) is the following. For  ep-groupoids the bump functions are compatible with the morphisms, whereas for the underlying object space $X$ viewed 
as a M-polyfold there is no compatibility condition.  Concerning (2) we note that for a given $x$ all the guaranteed sc-smooth bump functions might not take values in $[0,1]$, and even worse
it could be that $f(x)=0$. However,  the theorem claims that one can construct  sc-smooth bump functions possessing  the additional properties once there is the guaranteed supply of sc-smooth bump functions.
\begin{proof} [Theorem \ref{t-bump_functions}]
(1) We 
first  assume that the ep-groupoid $X$ admits sc-smooth bump functions. We consider the object M-polyfold $X$ and choose a point $x\in X$ and an open neighborhood $U(x)\subset X$ of $x$ in the  M-polyfold $X$.  Then we take a smaller open neighborhood 
$V(x)$ satisfying  $\cl_X(V(x))\subset U(x)$ such that $V(x)$ is equipped with a natural $G_x$-action $\Phi$ as defined in Theorem \ref{x-local-x} and for which, moreover, the map   $t:s^{-1}(\cl_X(V(x)))\rightarrow X$ is proper.
Next we take another open neighborhood $W(x)$ having the following properties.
\begin{itemize}
\item $W(x)\subset \cl_X(W(x))\subset V(x)$.
\item $W(x)$ is invariant under the $G_x$-action $\Phi$.
\end{itemize}
On   the saturation $\wt{W}(x)=\pi^{-1}(\pi(W(x)))$ of $W(x)$ we find,  by assumption,  a sc-smooth bump function $f:X\rightarrow {\mathbb R}$ satisfying $\supp(f)\subset \wtilde{W}(x)$ and $f(y')=f(y'')$ if there is a morphism $\phi\colon y'\to y''$. 
There is a point $z'\in \wtilde{W}(x)$ at which  $f(z')\neq 0$ and there exists   a morphism $\phi\colon z'\rightarrow y$ with $y\in W(x)$, and hence $f(y)=f(z')\neq 0$. Therefore $f$ does not vanish 
on $W(x)$ and we 
define $\beta\colon X\rightarrow {\mathbb R}$ by
\begin{equation}\label{con_xx}
\beta(z)=\begin{cases}
f(z)&\quad  \text{for $z\in W(x)$}\\
0&\quad  \text{for $z\in X\setminus W(x)$}.
\end{cases}
\end{equation}
Then $\beta\not\equiv 0$ and 
$$
\supp(\beta)\subset \cl_X(W(x))\subset V(x)\subset \cl_X(V(x))\subset U(x).
$$
We shall show that $\beta$ is a sc-smooth function, so that that $\beta$ is a sc-smooth bump function having its  support in $U(x)$. 

By construction,  $\beta$ is sc-smooth at all points which do not belong to 
$\cl_X(W(x))\setminus W(x)$.  Hence we only have to consider points $z \in 
\cl_X(W(x))\setminus W(x)$. In the case 
$z\not\in \wtilde{W}(x)$, using that $\supp(f)$ is closed in $X$ and a subset of $\wtilde{W}(x)$, we find an open neighborhood $Q(z)$ not intersecting $\supp(f)$  and hence $\beta=0$ on $Q(z)$.    In the remaining case where $z\in \wtilde{W}(x)$, there exists a morphism $\phi\colon z_0\to z$ for some $z_0\in W(x)$. Since $z\in\cl_X(W(x))\setminus W(x)$, we conclude that 
$z\in V(x)$. But also $z_0\in V(x)$ and therefore by Theorem \ref{x-local-x}, for a suitable $g\in G_x$ we have  
$
\Phi (g)(z_0)=z.
$
From the invariance  of $W(x)$ under the action of $G_x$ we deduce that $z\in W(x)$ contradicting $z\not \in W(x)$ and showing that this case does not occur. We have proved that $\beta$ is a  sc-smooth function with $\supp (\beta)\subset U(x)$.  

Conversely,  we assume that the object M-polyfold $X$ admits sc-smooth bump functions.  For a given $x\in X$ and a saturated open neighborhood
$U(x)$ we choose  an open neighborhood $V(x)$ satisfying  $\cl_X(V(x))\subset U(x)$ such  that on $V(x)$ we have the natural $G_x$-action
and $t:s^{-1}(\cl_X(V(x)))\rightarrow X$ is proper.  We take another open neighborhood $W(x)$ which is invariant under the $G_x$-action
and satisfies $\cl_X(W(x))\subset V(x)$. Then we take a sc-smooth bump function $f\colon X\rightarrow {\mathbb R}$ having its support in $W(x)$ and 
consider $f\colon W(x)\rightarrow {\mathbb R}$. We can average with respect to the group $G_x$ and may assume without loss of generality that
$f$,  on $W(x)$,  is $G_x$-invariant.  Now we define the function $\beta\colon X\rightarrow {\mathbb R}$ by
$$
\beta(y)=
\begin{cases}
f(z)&\quad  \text{if there exists a morphism $\phi\colon z\to y$ with $z\in W(x)$}\\
0&\quad \text{if $y\not\in \pi^{-1}(\pi(W(x))$}.
\end{cases}
$$
The function $\beta$ is well-defined, i.e., it coincides 
with $f$ on $W(x)$. 
Indeed, if $y\in W(x)$ and $\phi\colon z\to y$ for $z\in W(x)$, then $z=\Phi (g)(y)$ for some $g\in G_x$ and hence, in view of the invariance of $W(x)$, 
$f(z)=f(y)$ so that $\beta=f$ on $W(x)$.
Moreover, by construction $\beta\neq 0$ and $\supp(\beta)\subset U(x)$. Further $\beta$ is compatible with morphisms.

It remains to show that $\beta$ is sc-smooth. This is clear at point a  $z\in X\setminus \wt{W}(x)$ and a point $z\in \wt{W}(x)=\pi^{-1}(\pi (W(x)))$.
Hence we only have to consider points $z\in \cl_X(\wtilde{W}(x))\setminus \wtilde{W}(x)$. We shall show that such a point $z$ has an open neighborhood $Q(z)$ not intersecting the support of $\beta$, which will imply the result.  Otherwise,  arguing indirectly,  we find a convergent sequence $z_k\rightarrow z$ with $\beta(z_k)\neq 0$. Then, by the construction
of $\beta$, there exist morphisms $\phi_k$ satisfying  $t(\phi_k)=z_k$ and $s(\phi_k)\in W(x)$. Using the properness, after perhaps taking a subsequence,
we may assume that $\phi_k\rightarrow\phi$. Hence $t(\phi)=z$ and $s(\phi)\in\cl_X(W(x))$. Since $z\not\in \wtilde{W}(x)$
we must have $s(\phi)\not\in W(x)$. We find arbitrarily small open neighborhoods of $s(\phi)$ on which $\beta$ vanishes.
Taking the image under the local sc-diffeomorphism $t\circ s^{-1}$ we see that $z$ has such a neighborhood as well. This leads  to  a contradiction and
the proof of (1)  is complete.\par

(2) If the ep-groupoid $X$ admits sc-smooth bump functions we know from  part (1) that the object M-polyfold admits 
sc-smooth bump functions.  In view of a result in Part I, (Proposition \ref{prop-x5.36}) we find on the object M-polyfold sc-smooth bump functions 
which take values in $[0,1]$, satisfy $f(x)=1$, and have support in the prescribed open neighborhood $U(x)$.  Now carrying out the construction
in (1) for this function  $f$ we first average and then extend to obtain a sc-smooth bump function  on the ep-groupoid 
which,  in addition,  takes values in $[0,1]$ and at the point $x$ the value $1$. This completes the proof of (2). The proof of Theorem \ref{t-bump_functions} is complete.
\qed \end{proof}
Next we use the previous discussion to prove  the existence of suitable $\ssc^+$-sections for strong bundles $(P, \mu)$ over ep-groupoids $X$ admitting sc-smooth bump functions.  Sections $\sigma\colon X\to W$ of strong bundles over ep-groupoids have, of course, to be compatible with morphisms, i.e., they  satisfy
$$
\sigma (t(\phi))=\mu(\phi,\sigma (s(\phi)))\quad  \text{for all $\phi\in {\bf X}$.}
$$
\begin{theorem}\label{LLLOP}\index{T- Existence of $\ssc^+$-sections}
We assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over the ep-groupoid $X$ which admits sc-smooth bump functions, and which has, in addition, a paracompact orbit space $\abs{X}$.
Let $N$ be an auxiliary norm for $(P,\mu)$. 
Given a smooth point $x\in X$ with isotropy $G_x$, a smooth point $e\in W_x$  satisfying $e=\mu (g, e)$ for all $g\in G_x$,  an open neighborhood
$\wh{O}$ of $\pi(x)$ in $|X|$, and $\varepsilon>0$, then there exists a $\ssc^+$-section functor $\sigma\colon X\to W$ possessing  the following properties.
\begin{itemize}
\item[{\em (1)}]\ The support of $\sigma$ is contained  in $\pi^{-1}(\wh{O})$.
\item[{\em (2)}]\ $\sigma(t(\phi))=\mu (\phi, \sigma(s(\phi))$  for all $\phi \in {\bf X}$. 
\item[{\em (3)}]\ $\sigma(x)=e$.
\item[{\em (4)}]\ $N(\sigma(y))\leq N(e)+\varepsilon$ for all $y\in X$.
\end{itemize}
\end{theorem}

The hypothesis that $|X|$ is paracompact is used to insure the existence of auxiliary norms $N$.
The existence of sc-smooth bump functions is used for the actual construction of the functor $\sigma$.

\begin{proof}
We choose  an open neighborhood $U(x)$ of $x$ contained in $\pi^{-1}(\wh{O})$ and having  the following properties.
\begin{itemize}
\item[$\bullet$] The natural $G_x$-action is defined on $U(x)$. 
\item[$\bullet$] $t:s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper.
\item[$\bullet$] There exists a strong bundle isomorphism $\Psi\colon W\vert U(x)\rightarrow K$ which covers  the sc-diffeomorphism $\psi\colon U(x)\rightarrow  O$ satisfying $\psi (x)=0$.  Here we use the local model $(O,C,E)$ for the object M-polyfold $X$ and the model $(K, C\triangleleft F, E\triangleleft F)$ for the local strong bundle 
retract $K=R(U\triangleleft F)$ defined by the retraction $R(u, f)=(r(u), \rho (u)f)$ for $(u, f)\in U\oplus F$. The sc-smooth map $r\colon U\to U$ is a retraction onto $O=r(U)$. The diagram 
$$
\begin{CD}
P^{-1}(U(x))@>\Psi>> K\\
@VV PV  @VV p V\\
U(x)@>\psi>>O
\end{CD}
$$
commutes.
\end{itemize}
We choose a smaller  neighborhood $V(x)$, still invariant under the action of $G_x$,  such  that $\cl_X(V(x))\subset U(x)$ and denote by $\wtilde{V}(x)$ the saturation of $V(x)$.
By construction, $\wtilde{V}(x)\subset \pi^{-1}(\wh{O})$. Then  we take on  the object M-polyfold $X$ a sc-smooth bump
function $f\colon U(x)\rightarrow [0,1]$ satisfying  $f(x)=1$ and having its support in $V(x)$. We also assume that $f$ is invariant under the $G_x$-action.
As used already in the  previous proof  there is a canonical way to extend it to a sc-smooth bump function for the ep-groupoid $X$.
We denote this extension by $\beta$. 

The construction of the desired section $\sigma$ of 
$P\colon W\vert U(x)\to U(x)$ starts in the bundle chart 
$\Psi$. Recalling that $\psi (x)=0$, we denote the image of the distinguished smooth point $e\in W_x$ under the strong bundle isomorphism $\Psi\colon
 W\vert U(x)\to K$ by $\Psi (e)=(0, e')$. We define the section $s'$ of the local bundle $p\colon K\to O$ by 
 $$s'(m)=R(m, e')=(m, \rho (m)e')$$
 for all $m\in O$, so that $s'(0)=R(0, e')=(0, e')$ because $R$ retracts onto $K$.
 
 The strong bundle isomorphism $\Psi\colon  W\vert U(x)\to K$ induces the $G_x$-action on $K$, defined by 
 $$g\ast \Psi (w)=\Psi (g\ast w)\quad \text{and}\quad 
 g\ast \psi (y)=\psi (g\ast y),$$
 for all $g\in G_x$ and $w\in  W\vert U(x)$ and $y\in O$, where $g\ast w=\mu \bigl(\Gamma (g, P(w)), w\bigr)$. Recalling the assumption $e=\mu (g, e)$ on $e\in W_x$ and the property $\Gamma (g, x)=g$ for $g\in G_x$, we deduce that $g\ast e=e$ and 
 $g\ast \Psi (e)=\Psi (g\ast e)=\Psi (e)$ and hence 
 $g\ast (0, e')=(0, e')$ for all $g\in G_x$.  
 
 If $h(y)=\Psi^{-1}(s'(\psi (y)))$ is the pull-back section $h\colon U(x)\to W\vert U(x)$, we introduce for every $g\in G_x$ the section $h_g\colon U(x)\to W\vert U(x)$ by 
 $$h_g(y)=\mu \bigl(\Gamma (g, g^{-1}\ast y), h(g^{-1}\ast y)\bigr)
 $$
 for all $y\in U(x)$. It satisfies $h_g(e)=e$. Averaging 
 these sections over $G_x$ we obtain the section 
 $\sigma''\colon U(x)\to W\vert U(x)$, given by 
 \begin{equation*}
 \begin{split}
 \sigma''(y)&=\dfrac{1}{\abs{G_x}}\sum_{g\in G_x}h_g(y)\\
&=\dfrac{1}{\abs{G_x}}\sum_{g\in G_x}\mu \bigl(\Gamma (g, g^{-1}\ast y), h(g^{-1}\ast y)\bigr).
\end{split}
\end{equation*}
Then $\sigma'' (e)=e$ and we claim that $\sigma''$ is $G_x$-equivariant in the sense that 
\begin{equation}\label{sdouble_equiv}
\sigma''(\gamma\ast y)=\gamma\ast \sigma'' (y)=
\mu \bigl(\Gamma (\gamma, y),\sigma'' (y)\bigr)
\end{equation}
for all $y\in U(x)$ and $\gamma\in G_x$. Indeed, recalling that $g^{-1}\ast (\gamma \ast y)=(g^{-1}\circ \gamma)\ast y$, the left-hand side becomes
\begin{equation}\label{sdouble_equiv_1}
\sigma''(\gamma\ast y)=\dfrac{1}{\abs{ G_x}}\sum_{g\in G_x}
\mu \bigl(\Gamma (g, (g^{-1}\circ \gamma)\ast y), h((g^{-1}\circ \gamma)\ast y)\bigr).
\end{equation}
By the properties of $\Gamma$,
\begin{equation*}
\Gamma (g, (g^{-1}\circ \gamma)\ast y)=
\Gamma (\gamma \circ \gamma^{-1}\circ g, (g^{-1}\circ \gamma)\ast y)=
\Gamma (\gamma, y)\circ 
\Gamma (\gamma^{-1}\circ g, (g^{-1}\circ \gamma)\ast y)
\end{equation*}
Hence, by the properties of the structure map $\mu$,
\begin{equation}\label{sdouble_equiv_2}
\begin{split}
\mu &\bigl(
\Gamma (g, (g^{-1}\circ \gamma)\ast y), h((g^{-1}\circ \gamma)\ast y)\bigr)\\
&=\mu \bigl(
\Gamma (\gamma, y)\circ 
\Gamma (\gamma^{-1}\circ g, (g^{-1}\circ \gamma)\ast y), h((g^{-1}\circ \gamma)\ast y)\bigr)\\
&=\mu \bigl(
\Gamma (\gamma, y), \mu\bigl(
\Gamma (\gamma^{-1}\circ g, (g^{-1}\circ \gamma)\ast y), h((g^{-1}\circ \gamma)\ast y)\bigr)\bigr).
\end{split}
\end{equation}
Therefore, inserting \eqref{sdouble_equiv_2} into \eqref{sdouble_equiv_1}, changing to the summation index $g^{-1}\circ \gamma$ and using the linearity of the map 
$\mu \bigl(\Gamma (\gamma, y), \cdot  \bigr)\colon W_y\to W_{\gamma\ast y}$ we arrive at the formula 
$\sigma'' (\gamma \ast y)=\mu \bigl(\Gamma (\gamma, y), \sigma'' (y)\bigr)$ as claimed. 

Since every morphism $\phi$ connecting two points in $U(x)$ has the form $\phi=\Gamma (g, y)$ for $s(\phi )=y$ and $t(\phi )=g\ast y$ and a unique $g\in G_x$, we deduce from \eqref{sdouble_equiv_2} that 
\begin{equation}\label{sdouble_equiv_4}
\sigma'' (t(\phi))=\mu\bigl(\phi, \sigma'' (s(\phi))\bigr)
\end{equation}
for every morphism $\phi$ between points in $U(x)$. 

The section $\sigma'\colon U(x)\to W\vert U(x)$ defined by $\sigma' (y)=\beta (y)\cdot \sigma'' (y)$ is again a $G_x$-equivariant $\ssc^+$-section. In addition, 
$\sigma'$ has its support in $V(x)$ and satisfies $\sigma' (e)=e$. Finally, we proceed as in the proof of 
Theorem \ref{t-bump_functions} and use the morphisms in $\bx$ to extend the section $\sigma'$ from $U(x)$ to the desired $\ssc^+$-section functor $\sigma\colon X\to W$. It satisfies the properties (1)-(3). The property (4) is achieved by choosing $V(x)$ small enough,
see also Remark \ref{extension-Q} below. The proof of Theorem \ref{LLLOP} is complete.
\qed \end{proof}

\begin{remark}\index{R- Transversality versus functoriality}
As we shall see later on in the Fredholm theory on ep-groupoids or polyfolds, the property of a section of a strong bundle of being functorial
and the property of being transversal are competing and  do quite often  not hold simultaneously. This forces us
to use multivalued sections. Note that in the previous theorem there would be no such section functors $\sigma$ if we would not have required
that $e$ has $G_x$ as an automorphism group. Later on we shall see that such (restricted) section functors $\sigma$ used as perturbations will not be
sufficient to achieve transversality. 
\qed
\end{remark}

Another remark is concerned with the above proof, whose ingredients allow to define $\ssc^+$-sections having  properties required in 
situations in which we try to achieve  transversality.
\begin{remark}\label{extension-Q}\index{R- Extensions of sc$^+$-sections}
Given a smooth point $x\in X$ and a $G_x$-invariant open neighborhood $U(x)$ of $x$, one constructs a $\ssc^+$-section $s$ with desired properties
near $x$ and compatible with the $G_x$-action, i.e., compatible with morphisms whose targets and sources belong to  $U(x)$. Then we can take 
an invariant sc-smooth function  $f:X\rightarrow [0,1]$ with support in $U(x)$ and satisfying $f=1$ near $x$ so that the product $f\cdot s$ is a  $\ssc^+$-section on $U(x)$.
The proof of Theorem \ref{LLLOP} shows how to extend $f\cdot s$ to a $\ssc^+$-section defined on all of $X$. The construction, i.e.,  the choice of $f$
allows to control the size of $f\cdot s$ with respect to the auxiliary norm $N$ and therefore controls the extension $\wtilde{s}$, which is entirely determined by $f\cdot s$.
As this remark shows,  local constructions can always be extended in a controlled way. In applications we shall see local constructions,
where the section attains particular values, or where the linearization at $x$ has certain properties. Basically any finite-dimensional idea
about a perturbation can be implemented in the polyfold set-up.\qed
\end{remark}

We come to the sc-smooth extension of a $\ssc^+$-section defined over the boundary $\partial X$ of an ep-groupoid.
We recall the discussion of local faces in Part I. Namely,  if $(O,C,E)$ is a tame local model,
then there exists an open subset $U$ of $C$ and a sc-smooth retraction $r:U\rightarrow U$ preserving the degeneracy index $d_C$, having $O$ as its image, and for every smooth point $x\in O$ there exists a sc-subspace $A$ of $E_x$ satisfying $T_xO\oplus_{sc} A=E_x$.
\begin{definition}\index{D- $\bssc^+$-section over $\partial X$}
We consider a strong bundle $(P:W\rightarrow X,\mu)$ over the tame ep-groupoid $X$ and assume that  the map $s:\partial X\rightarrow W$ satisfies $P\circ s=Id$. 
Then  $s$ is called  {\bf $\ssc^+$-section defined over the boundary}  provided for every point $x\in \partial X$ and every local face $F$ containing $x$, the restriction 
$s\vert F$ is a $\ssc^+$-section of the bundle $W|F\to F$. 
\qed
\end{definition}
The boundary  $\partial X$ is not a M-polyfold. However,  locally it is the union of a finite number of faces due to the tameness assumption.
These faces are M-polyfolds, which allows us to define some kind of sc-smoothness via the properties of all local restrictions. This control is enough to guarantee
local $\ssc^+$-smooth extensions. 

Recall that for a tame retract $(O,C,E)$ the equality $d_O(x)=d_C(x)$ holds
for $x\in O$, see Proposition \ref{tame_equality}. In particular $\partial O=O\cap \partial C$.
\begin{proposition}\label{hucky}\index{P- Extension of $\ssc^+$-sections}
Let $K\rightarrow O$ be a tame  local strong bundle model, where $K=R(U\triangleleft  F)$ is a strong bundle retract and the strong bundle retraction $R$ covers  the tame retraction
$r:U\rightarrow U$ of the  local model $(O,C,E)$. We assume that $s$ is a $\ssc^+$-section defined on an open neighborhood in $\partial O$
of some $x_0\in \partial O$. Then there exists an open neighborhood $V(x_0)\subset O$ and a $\ssc^+$-section 
$\wtilde{s}$ of $W|V(x_0)$ such that $\wtilde{s}=s$ on $\partial O$ near $x_0$.
\end{proposition}
\begin{proof}
There is no  loss of generality to assume  that $E={\mathbb R}^n\oplus H$, $C=[0,\infty)^n\oplus H$, and $x_0=(0,h_0)$. Possibly $h_0\neq 0$ 
if $x_0$ is not smooth. For a subset $I$ of $\{1,\ldots ,n\}$ and a point $(t,h)$ near $(0,h_0)$, we define 
$$
(t,h)_I = r(t_I,h),
$$
where  $t_I$ is obtained from $t$ by putting  $t_i=0$ if $i\in I$. We define $\wtilde{s}$ on an open neighborhood $V(x_0)$ in $O$ by the following formula
$$
\wtilde{s}(t,h) = \sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j} R((t,h),s((t,h)_I)).
$$
The maps $(t,h)\rightarrow s((t,h)_I)$ are $\ssc^+$-sections of the bundle $O\triangleleft F\to O$ near $x_0$,   implying that $\wtilde{s}$ is a local $\ssc^+$-section.
The following straightforward computation shows that $\wtilde{s}=s$ on $\partial O$ near $x_0$. Namely, considering $(t,h)\in O$ with $t_{i_0}=0$ near $x_0$ and using 
$(t,h)_{\{i_0\}}=r(t_{\{i_0\}},h)=r(t,h)=(t,h)$, we compute 
\begin{equation*}
\begin{split}
&\wt{s}(t, h)=\quad \sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j} s((t,h)_I)\\
&\quad=\sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j, i_0\in I} s((t,h)_I)+ \sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j, i_0\not\in I} s((t,h)_I)\\
&\quad=\sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j-1, i_0\not\in I} s((t,h)_{I\cup\{i_0\}})+ \sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j, i_0\not\in I} s((t,h)_I)\\
&\quad=\sum_{j=0}^{n-1} (-1)^{j} \sum_{|I|=j, i_0\not\in I} s((t,h)_{I})+ \sum_{j=1}^n (-1)^{j+1} \sum_{|I|=j, i_0\not\in I} s((t,h)_I)\\
&\quad=\sum_{j=0}^{n-1} (-1)^{j} \sum_{|I|=j, i_0\not\in I} s((t,h)_{I})+ \sum_{j=1}^{n-1} (-1)^{j+1} \sum_{|I|=j, i_0\not\in I} s((t,h)_I)\\
&\quad= s((t,h)_{\{i_0\}})=s(r(t,h))=s(t,h).
\end{split}
\end{equation*}
\qed \end{proof}
There is a  corollary in the presence of symmetries. 
\begin{corollary}\label{ext_t_t}\index{C- Equivariant extension}
Let  $(O,C,E)$ be  as described in Proposition \ref{hucky},  and $x_0\in \partial O=\partial C\cap O$  a point such  that $G_{x_0}$ acts by sc-diffeomorphisms 
on $O$ with a lift to a strong bundle model $P:K\rightarrow O$. We assume that  $s$ is a $\ssc^+$-section defined on an $G_{x_0}$-invariant open neighborhood of $x_0$ in $\partial O$ and satisfying
$s(g\ast x) =g\ast s(x)$ for $x\in \partial O$ near to $x_0$. Then on a suitable $G_{x_0}$-invariant neighborhood of $x_0$ in $O$ there exists a $\ssc^+$-section $\wh{s}$, which is invariant under the $G_{x_0}$-action and which restricts to $s$ on  $\partial O$ near $x_0$.
\end{corollary}
\begin{proof}
Averaging the extension $\wt{s}$ guaranteed by Proposition \ref{hucky},  
we obtain the local section $\wh{s}$ near $x_0$ in $O$, defined by 
$$
\wh{s}(x)=\frac{1}{|G_{x_0}|} \sum_{g\in G_{x_0}} g^{-1}\ast \left( \wt{s}(g\ast x)\right).
$$
Since $s$  is   by assumption  equivariant,  it follows that $\wh{s}=s$ on $\partial O$ near $x_0$.
\qed \end{proof}

Using this local result we  prove the following extension result.
\begin{theorem}[{\bf Extension of $\ssc^+$-section functors}]\label{extension-ssc-section functors}\index{T- Extensions of $\ssc^+$-functors}
Let  $(P:W\rightarrow X,\mu)$ be  a strong bundle over the  tame ep-groupoid $X$ whose  
orbit space $|X|$ is paracompact.
Suppose that the ep-groupoid admits sc-smooth partitions of unity.  Given a $\ssc^+$-section functor $s$ of $W|\partial X$
and a saturated open neighborhood $U$ of  $\partial X$ in $X$, there exists exists a $\ssc^+$-section functor $\wtilde{s}$ of $P$
supported  in $U$,  which on $\partial X$ restricts to $s$. Moreover,  if an auxiliary norm $N$  and $\delta>0$  are given such that
$N(s(x))<\delta $ for all $x\in \partial X$, then the extension $\wtilde{s}$ can be constructed in such a way that $N(\wtilde{s}(x))\leq\delta $ for all $x\in X$.
\end{theorem}
\begin{proof}
For every $x\in \partial X$ we take the open neighborhood $U(x)\subset X$ guaranteed by Corollary \ref{ext_t_t} and contained in the open neighborhood $U\subset X$ of $\partial X$, such that the section $\wt{s}$ on $U(x)$ is an extension of $s\vert (U(x)\cap \partial X)$.
We extend $\wt{s}$ in an equivariant way to the saturation  $\wt{U}(x)=\pi^{-1}(\pi (U(x))$ of $U(x)$ and denote this extension by  $\wtilde{s}_x$. The complement  $U_\infty=X\setminus\partial X$ of the boundary is saturated and so we obtain a covering of $X$  by the saturated open sets $U_\infty$ and $\wt{U}(x)$, $x\in \partial X$.
Using Theorem \ref{t-bump_functions} (2), we choose a subordinated sc-smooth partition of unity consisting of the sc-smooth bump functions  $\beta_\infty$ and $\beta_x$  on $\wt{U}(x)$ for every $x\in \partial X$ according to Definition \ref{d-ep-groupoid_bump},  where $\beta_x\colon X\to [0,1]$ satisfies  $\beta_x(x)=1$ and $\supp (\beta_x)\subset \wt{U}(x)$.
Using  only the functions $\beta_x$ (and not $\beta_\infty$),  we  define the section 
$\wt{s}$ by 
$$
\wt{s}=\sum_{x\in \partial X}\beta_x \wt{s}_x,
$$
which is a sc-smooth section functor extending $s$ and supported in $U$. 





The map  $z\mapsto  N(\wtilde{s}(z))$ is continuous and 
we find a saturated open neighborhood $V$ of $\partial X$, whose closure is contained in $U$ such  that $N(\wtilde{s}(z))<\delta$ on $V$. Then we 
take another saturated open neighborhood $V'$ of $\partial X$ whose  closure is contained in $V$. The two sets $V$ and $X\setminus \cl_X(V')$ constitute 
an open saturated cover  of  $X$. 
Arguing as before we find 
an associated sc-smooth partition of unity in which the sc-smooth bump function $\beta\colon X\to [0,1]$ has its support in $V'$ and satisfies $\beta=1$ on $\partial X$. Then the product $\beta\cdot \wt{s}$ is an extension of $s$ which satisfies $N((\beta\cdot \wt{s})(x))\leq \delta$ for all $x\in X$. The proof of Theorem 
\ref{extension-ssc-section functors} is complete.
\qed \end{proof}

\section{Compactness Properties}\label{SEC114}
The standing assumption for this section is that $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid. 
We assume that we have fixed an auxiliary norm $N:W_{0,1}\rightarrow {\mathbb R}^+$ (a functor). One can extend $N$ to $W$ by setting
$N(h)=+\infty$ if $h$ is not of bi-regularity $(0,1)$. Hence we may view $N$ as a functor $W\rightarrow {\mathbb R}^+\cup\{+\infty\}$.
Most of the results we shall describe here are straight forward generalizations of the results in Chapter \ref{sec_package}.
We shall denote for a section $f$ of $P$ by $S_f$ the full subcategory of $X$ associated to all zero-objects for $f$, i.e. all $x\in X$ with $f(x)=0$.
\begin{definition}\index{D- Compactness notions}\label{DEFN12.4.1}
Let $f$ be an sc-smooth section functor of $P$, where $(P:W\rightarrow X,\mu)$ is a strong bundle over 
a tame ep-groupoid and $N$ an auxiliary norm. 
\begin{itemize}
\item[(1)]\ We say $f$ has {\bf compact solution set} (in the ep-groupoid sense) \index{Compact solution set, ep-groupoid case} if the orbit space $|S_f|$ associated to $S_f$ is compact.
\item[(2)]\ The section $f$ is said to be {\bf  proper}\index{Proper, ep-groupoid case} if $|S_f|$ is compact and for every auxiliary norm $N$
there exists an open saturated neighborhood $U$ of $S_f$ with the property that the orbit space of the set
$$
\{x\in U\ |\ N(f(x))\leq 1\}
$$
has compact closure.
\end{itemize}
\qed
\end{definition}
These two compactness notions are equivalent for sc-Fredholm sections functors.
The ep-groupoid version of Theorem \ref{x-cc} is given by the following result.
\begin{theorem}\label{THMB1242}
Let $f$ be an sc-Fredholm section of the strong bundle $(P:W\rightarrow X,\mu)$ over an ep-groupoid with paracompact orbit space
$|X|$, which guarantees the existence of auxiliary norms.  The following two statements are equivalent.
\begin{itemize}
\item[{\em(1)}]\ $f$ is proper.
\item[{\em(2)}]\ $f$ has a compact solution set.
\end{itemize}
\end{theorem}
\begin{proof}
(1) $\Rightarrow$ (2).  It is clear that properness implies a compact solution set in the ep-groupoid sense.\par

\noindent (2) $\Rightarrow$ (1). Assume next that $f$ has a compact solution set and an auxiliary norm $N$ is given.  Then we take for every $z\in |S_f|$ 
a representative $x_z\in X$ and we find, employing Theorem \ref{x-cc},  an open neighborhood $U(x_z)$ admitting the natural action
and having the properness property,   so that  
$\Sigma_z:=\{y\in U(x_z)\ |\ N(f(y))\leq 1\}$ satisfies
\begin{itemize}
\item $\cl_{X}(\Sigma_z)$ is compact.
\end{itemize}
This property persists if we replace $U(x_z)$ by a smaller open neighborhood, for which we may assume that it admits the 
natural $G_{x_z}$-action and that it has the property that $\cl_{|X|}(|U|)=|\cl_{X}(U)|$, see Proposition \ref{Prop7.1.9}.
Then the  orbit set 
$$
V_z := |U(x_z)|
$$
is an open neighborhood of $z$. We note that 
$\cl_{|X|}(|\Sigma_z|)$ is compact and contained in $|\cl_{X}(U(x_z))|$. 



Since $|S_f|$ is compact we find finitely many $z_1,...,z_k$ 
so that the corresponding $V_{z_i}$ cover $|S_f|$. 
Denote by $U$ the  saturated open neighborhood of $S_f$ defined by
$$
U=\bigcup_{i=1}^k \pi^{-1}(V_{z_i}).
$$
Then
$$
\cl_{|X|}(|\{x\in U\ |\ N(f(x))\leq 1\}|)\subset 
\bigcup_{i=1}^k \cl_{|X|}( |\Sigma_{z_i}|),
$$
 which proves the claim.
\qed \end{proof}

In order to formulate an ep-groupoid version 
of Theorem \ref{THM528} we need the notion of the reflexive local compactness property in the ep-groupoid context.
\begin{definition}\label{DEFR1243}\index{D- Reflexive local compactness property, ep-groupoid context}
Assume that $P:Y\rightarrow X$ is a strong bundle over an ep-groupoid with reflexive $(0,1)$-fiber and let $f$ be an sc-smooth section functor of $P$, which in addition is regularizing.
We say that $f$ has the {\bf ep-groupoid reflexive local compactness property}  provided for every reflexive auxiliary norm $N$ (a functor)
and every point $x\in X$ there exists an open neighborhood $U(x)$ in $X$, i.e. on level $0$, so that 
$\cl_X\left(  \{y\in U(x)\ |\ N(f(y))\leq 1\}\right) $ is a compact subset of $X$. 
\qed
\end{definition}
Let us discuss this definition in more detail. We need the following fact.
\begin{lemma}\label{LEMM1244}
Let $X$ be an ep-groupoid. The following holds.
\begin{itemize}
\item[{\em(1)}]\ For a saturated subset $\Sigma$ of $X$ the equality $\cl_{|X|}(|\Sigma|) =|\cl_X(\Sigma)|$ holds.
\item[{\em(2)}]\ For a subset $\Sigma$ of $X$  with compact closure the equality $\cl_{|X|}(|\Sigma|) =|\cl_X(\Sigma)|$ holds.
\end{itemize}
\end{lemma}
\begin{proof}
For any subset $\Sigma$ the continuity of $\pi:X\rightarrow |X|:x\rightarrow |x|$ implies the inclusion
 $|\cl_X(\Sigma)|\subset \cl_{|X|}(|\Sigma|) $.\par
 
 \noindent (2)  Assume that $z\in \cl_{|X|}(|\Sigma|)$. We pick a representative $x$ of $z$ and an open neighborhood
 $U(x)$ with the natural $G_x$-action and the properness property. Let $(z_k)\subset |\Sigma|$ with $z_k\rightarrow z$.
 There is no loss of generality assuming that $(z_k)\subset |U(x)|$. We can pick $(x_k)\subset U(x)$ with
 $z_k=|x_k|$ and must have $x_k\rightarrow x$. Since $\Sigma$ is saturated $x_k\in\Sigma$ and we conclude
 that $x\in \cl_X(\Sigma)$, i.e. $z\in |\cl_X(\Sigma)|$.\par
 
 \noindent (2) Pick $z\in \cl_{|X|}(|\Sigma|)$ and  $(z_k)\subset |\Sigma|$
 converging to $z$. We can pick $(x_k)\subset \Sigma$ with $|x_k|=z_k$.
 After perhaps taking a subsequence and using the compactness of $\cl_X(\Sigma)$ we may assume
 that $x_k\rightarrow x\in\cl(\Sigma)$. Then $z=|x|\in |\cl_X(\Sigma)|$.
\qed \end{proof}

Assume that  $f$ has the reflexive local compactness property.
 Given a point $x\in X$ we find an open neighborhood $U(x)$, which is invariant under the $G_x$-action,  having the properness property, i.e.
 $t:s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper, so that 
 $$
 \cl_X(\{y\in U(x)\ |\ N(f(y))\leq 1\})\ \ \text{is compact}.
 $$
Denoting by $\wt{U}(x)$ the saturation of $U(x)$ and using that $f$ and $N$ are functors we observe that 
\begin{eqnarray}\label{EQNNH}
&& \{\wt{y}\in \wt{U}(x)\ |\ N(f(\wt{y}))\leq 1\}\\
& =& \{y\in X\ |\ \exists \ \phi\in\bm{X},\ s(\phi)=y,\ t(\phi)\in U(x)\ \text{and}\ \ N(f(t(\phi)))\leq 1\}\nonumber
\end{eqnarray}
are saturated sets and that 
$$
\cl_X(\{y\in U(x)\ |\ N(f(y))\leq 1\}) \ \ \text{is compact}.
$$
Hence 
$$
\cl_{|X|}(|\{y\in \cl_X(U(x))\ |\ N(f(y))\leq 1\}|) = |\cl_X(\{y\in U(x)\ |\ N(f(y))\leq 1\})|.
$$
Consequently, using (\ref{EQNNH}) 
\begin{eqnarray*}
&& |\cl_X(\{\wt{y}\in \wt{U}(x)\ |\ N(f(\wt{y}))\leq 1\})|\\
 &=&\cl_{|X|}(|\{\wt{y}\in \wt{U}(x)\ |\ N(f(\wt{y}))\leq 1\}|)\\
 &=& |\cl_X(\{y\in U(x)\ |\ N(f(y))\leq 1\})|.
\end{eqnarray*}
Now  the following proposition is easily obtained.
\begin{proposition}
Assume that $P:Y\rightarrow X$ is a strong bundle over an ep-groupoid with reflexive $(0,1)$-fiber and let $f$ be an sc-smooth section functor of $P$, which in addition is regularizing. Then the following three statements are equivalent.
\begin{itemize}
\item[{\em(1)}]\ $f$ has the ep-groupoid reflexive local compactness property.
\item[{\em(2)}]\ For every reflexive auxiliary norm $N$  for $(P:W\rightarrow X,\mu)$ and $z\in|X|$ there exists a saturated open subset $\wt{U}$
with $z\in |\wt{U}|$ so that $|\cl_X(\{y\in \wt{U}\ |\ N(f(y))\leq 1\})|$ is compact.
\item[{\em(3)}]\  For every reflexive auxiliary norm $N$  for $(P:W\rightarrow X,\mu)$ and $z\in|X|$ there exists a saturated open subset $\wt{U}$
with $z\in |\wt{U}|$ so that $\cl_{|X|}(|\{y\in \wt{U}\ |\ N(f(y))\leq 1\}|)$ is compact.
\end{itemize}
\qed
\end{proposition}


A basic result, which generalizes Theorem \ref{THM528} is the following.

\begin{theorem}\index{T- Extension of controlling $(U_\partial, N)$, ep-groupoid context}\label{THMXXX1246}
Assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over the tame ep-groupoid $X$ with paracompact orbit space $|X|$, where $W$ has reflexive $(0,1)$-fibers. Denote by $N$ a reflexive auxiliary norm and let $f$ be an sc-Fredholm functor with compact solution set
having the reflexive local compactness property. Defining  $S_{\partial f}=\{x\in \partial X\ |\ f(x)=0\}$  let $U_\partial\subset \partial X$ be an open saturated neighborhood in $\partial X$ of $S_{\partial f}$ so that $\cl_{|X|}(|\{y\in U_\partial\ |\ N(f(y))\leq 1\}|)$ is compact in $|X|$. Then there exists a saturated open neighborhood  $U$  of $S_f=\{x\in X\ |\ f(x)=0\}$ with the following properties.
\begin{itemize}
\item[{\em(1)}]\ $U\cap\partial X= U_\partial$.
\item[{\em(2)}]\ The closure of $|\{x\in U\ |\ N(f(x))\leq 1\}|$ in $|X|$ is compact.
\end{itemize}
\end{theorem}
\begin{proof}
For $z\in |U_{\partial} |$ we take a representative $x_z$ of $z$. Following the argument of Theorem \ref{THM528}
we find an open neighborhood $U(x_z)$  in $X$ such that one of the following properties holds.
\begin{itemize}
\item[(a)]\ \ $N(f(x))>1$ for $x\in U(x_z)$ and $U(x_z)\cap \partial X\subset U_\partial$.
\item[(a')]\ \  $\cl_X(\{x\in U(x_z)\ |\ N(f(x))\leq 1\})$ is compact and $U(x_z)\cap \partial X\subset U_\partial$.
\end{itemize}
In addition to one of these properties we can always assume the following
\begin{itemize}
\item[(b)] \ $U(x_z)$ admits the natural $G_{x_z}$-action.
\item[(c)]\  $\cl_{|X|}(|U(x_z)|) = |\cl_X(U(x_z))|$.
\end{itemize}
By construction, we obtain for every $z\in |U_{\partial}|$ an open neighborhood $U(x_z)$
with either the properties (a), (b), (b) or the properties (a'), (b), (c).


The set  $\cl_{|X|}(|\{x\in U_\partial\ |\ N(f(x))\leq 1\}|)$ is compact.  We find $\bar{z}_1,...,\bar{z}_\ell\in |U_{\partial} |$ so that 
$$
|\cl_{X}(\{x\in U_\partial\ |\ N(f(x))\leq 1\})|\subset |U(\bar{x}_1)|\cup..\cup |U(\bar{x}_\ell)|,
$$
where $\bar{x}_i=x_{\bar{z}_i}$. Denoting by $\wt{U}(\bar{x}_i)$ the saturation of $U(\bar{x}_i)$ we obtain, since $U_{\partial}$ is saturated that
$$
(\wt{U}(\bar{x}_1)\cup...\cup \wt{U}(\bar{x}_\ell))\cap \partial X\subset U_\partial.
$$
 If $z\in |U_\partial| \setminus  |(\wt{U}(\bar{x}_1)\cup..\cup \wt{U}(\bar{x}_\ell))|$
we must have $N(f(x_z))>1$. Consider the union 
$$
\wt{U}:= \wt{U}(\bar{x}_1)\cup..\cup \wt{U}(\bar{x}_\ell) \cup \bigcup_{z\in |U_\partial| \setminus |(\wt{U}(\bar{x}_1)\cup..\cup \wt{U}(\bar{x}_\ell))|} \wt{U}(x_z).
$$
Here $\wt{U}(x_z)$ is the saturation of $U(x_z)$. Clearly $\wt{U}(x_z)$ does not depend on the choice of $x$ and we shall define
$$
\wt{U}(z):=\wt{U}(x_z).
$$
Then $|\wt{U}(z)|=|U(x_z)|$ and we write with our modified notation
$$
\wt{U} = \wt{U}(z_1)\cup...\cup \wt{U}(z_\ell) \cup \bigcup_{z\in  |U_\partial| \setminus |(\wt{U}(z_1)\cup..\cup \wt{U}(z_\ell))|} \wt{U}(z).
$$
This is an open subset of $X$ satisfying $\wt{U}\cap \partial X=U_\partial$.   Moreover, 
the closure of the orbit space of $\{x\in \wt{U}\ |\  N(f(x))\leq 1\}$ is compact. Indeed, take a sequence $(x_k)\subset \wt{U}$ satisfying $N(f(x_k))\leq 1$.
We may assume up to isomorphism
that   $(x_k)\subset U(\bar{x}_1)\cup..\cup U(\bar{x}_\ell)$ and since the closure of each of the finitely many sets $\{x\in U(\bar{x}_i)\ |\ N(f(x))\leq 1\}$
is compact, we see that $(x_k)$ has a convergent subsequence. The orbit space of the set $\{x\in X\setminus \wt{U}\ |\ f(x)=0\}$ is compact 
and we find finitely many $U(x_i)\subset X\setminus \partial X$, say $i=\ell+1,...,e$, whose orbit spaces cover this compact set so that in addition the closure of each set $\{x\in U(x_i)\ |\ N(f(x))\leq 1\}$ is compact. Moreover, we assume as usual that these sets have the natural action on them.
Finally define with $z_i=|x_i|$ and $\wt{U}(z_i)$ the saturation of $U(x_i)$
$$
U = \wt{U}\cup \wt{U}(z_{\ell+1})\cup...\cup \wt{U}(z_e).
$$
Then $U\cap \partial X=U_\partial$ and $|\cl_X(\{x\in U\ |\ N(f(x))\leq 1\})|$ is compact. The latter
satisfies
$$
|\cl_X(\{x\in U\ |\ N(f(x))\leq 1\})|=\cl_{|X|}(|\{x\in U\ |\ N(f(x))\leq 1\}|)
$$
 in view of Lemma \ref{LEMM1244} since $U$ is saturated.
The proof is complete.
\qed \end{proof}





\section{Orientation Bundle}\label{SEC115}


For many applications of the sc-Fredholm theory orientation questions play an important role.
We already discussed these issues in the context of the M-polyfold theory and we shall generalize the discussion to cover the case
where we deal with an sc-Fredholm section functor of a strong bundle over an ep-groupoid.
We shall denote by $(P:W\rightarrow X,\mu)$ a strong bundle over an ep-groupoid and by $f$ an sc-Fredholm section functor.
Given a smooth $x\in X$ we consider the affine  space of linearizations $\text{Lin}(f,x)$ introduced in Definition \ref{LINUXX}.
The elements of $\text{Lin}(f,x)$ are all linear sc-operators $S:T_xX\rightarrow W_x$ obtained by taking a local sc$^+$-section $s$
satisfying $s(x)=f(x)$ and putting $S:= (f-s)'(x)$. We do not require $s$ to be compatible with the action of the isotropy group $G_x$ of $x$.
Given a morphism $\phi:x\rightarrow x'$ between smooth points we obtain the sc-isomorphism $T\phi:T_xX\rightarrow T_{x'}X$
and define
$$
\phi_\ast :\text{Lin}(f,x)\rightarrow \text{Lin}(f,x'): \phi_\ast S :=  \mu(\phi, S\circ (T\phi)^{-1}).
$$
Of course, we need to verify that this is well-defined.
\begin{lemma}
The following holds for smooth points $x$ and $x'$.
\begin{itemize}
\item[{\em(1)}]\ Given a morphism $\phi:x\rightarrow x'$ and $S\in \text{Lin}(f,x)$ the sc-operator $\phi_\ast S$ belongs to
$\text{Lin}(f,x')$. 
\item[{\em(2)}]\ The map $\phi_\ast :\text{Lin}(f,x)\rightarrow \text{Lin}(f,x')$ is a bijection.
\item[{\em(3)}]\  $({1_x})_\ast = Id_{\text{Lin}(f,x)}$. For morphisms $\phi$ and $\psi$ in $\bm{X}$ with $s(\psi)=t(\phi)$ 
it holds that $(\psi\circ \phi)_\ast =\psi_\ast \circ \phi_\ast$.
\end{itemize}
\end{lemma}
\begin{proof}
Assume that $\phi:x\rightarrow x'$ is a morphism between smooth points. Then $\phi$ extends locally to an sc-diffeomorphism
$\wh{\phi}:(U(x),x)\rightarrow (U(x'),x')$, which can be written as
$$
\wh{\phi}(y) = t\circ (s|U(\phi))^{-1}(y),
$$
where $U(x),U(y),U(\phi)$ are suitable open neighborhoods so that $s:U(\phi)\rightarrow U(x)$ and $t:U(\phi)\rightarrow U(x')$ are sc-diffeomorphisms. The tangent $T\phi: T_xX\rightarrow T_{x'}X$ is an sc-isomorphism and by definition the tangent map associated 
to $\wh{\phi}$ taken  at $x$.
If we take $U(x)$ small enough and in such a way that we have the natural action of $G_x$ 
defined on $U(x)$ the sc-diffeomorphism $\wh{\phi}:U(x)\rightarrow U(x')$ is equivariant with respect to the group homomorphism
$$
\gamma\colon G_x\rightarrow G_{x'}\colon g\rightarrow \gamma(g):= \phi\circ g\circ \phi^{-1}.
$$
We can lift the equivariant $\wh{\phi}$ to a strong bundle isomorphism
$$
\wh{\Phi}: W|U(x)\rightarrow W|U(x'): w\rightarrow \mu((s|U(\phi))^{-1}(P(w)),w)
$$
which at $x$ maps $W_x$ via $\mu(\phi,.)$ to $W_{x'}$. 

If $s_0$ is a local sc$^+$-section defined near $x$ with $s_0(x)=f(x)$. Then $s_1= \wh{\Phi}_\ast s_0$ is a local sc$^+$-section at $x'$
satisfying $s_1(x')=f(x')$. We note that 
$$
\mu(\phi, (f-s_0)'(x)\circ T\phi^{-1}) = (f-s_1)'(x').
$$
From this we see that $\phi_\ast S:= \mu(\phi, S\circ (T\phi)^{-1})$ is well-defined as a map
$$
\text{Lin}(f,x)\rightarrow \text{Lin}(f,x').
$$
This proves (1). The functorial properties in (3) are obvious from the previous discussion.
From (1) and (3) the bijectivity statement (2) is obvious.
\qed \end{proof}
Recall from Section \ref{ORIENTXX}  that for a smooth object $x$ in the object M-polyfold $X$ 
the set $\text{Lin}(f,x)$ is a convex subset of ${\mathcal L}(T_xX,W_x)$, 
which we equip with the induced topology. As such it is a contractible space of Fredholm operators and we can consider 
the determinant bundle over it, which is denoted by $\text{DET}(f,x)$
$$
\text{DET}(f,x)\rightarrow \text{Lin}(f,x).
$$
This topological  line bundle has 
two different orientations which we refer to as the two possible orientations of $(f,x)$. 
There is in general not a preferred orientation, although this might happen in certain cases, for example in Gromov-Witten theory
the complex orientation.
If $\mathfrak{o}$ is one of the orientations we denote by $-\mathfrak{o}$ the other one.
An orientation 
$\mathfrak{o}$ of $(f,x)$ is by definition an orientation for the topological line bundle $\text{DET}(f,x)$.


Assume that $S\in\text{Lin}(f,x)$ and an orientation $\mathfrak{o}$ has been picked for $\text{DET}(f,x)$.
Then $\text{det}(S)$ obtains an orientation $\mathfrak{o}_S$. 
Given a morphism $\phi:x\rightarrow x'$ between smooth points the  orientation $\mathfrak{o}_S$ for $\text{det}(S)$ 
defines naturally an orientation $\phi_\ast\mathfrak{o}_S$ for $\text{det}(\phi_\ast S)$.  This in turn defines an orientation
for $\text{DET}(f,x')$. It does not depend on the specific choice of $S$.   Consequently given 
$\phi:x\rightarrow x'$ an orientation $\mathfrak{o} $ for $\text{DET}(f,x)\rightarrow \text{Lin}(f,x)$
is mapped to an orientation $\phi_\ast\mathfrak{o}$ for $\text{DET}(f,x)\rightarrow \text{Lin}(f,x')$.

We recall from Chapter \ref{ORIENTXX} that,  under the assumption 
that $X$ is tame, given a smooth point $x$ and an orientation for $(f,x)$ there exists a natural orientation  for all $(f,y)$ where $y$ is smooth and belongs to a sufficiently small open neighborhood of $x$. This means given $\mathfrak{o}_x$ there exists a preferred local germ
denoted by $\mathfrak{o}_{(x)}$, which associates to a smooth point $y$ near $x$ an orientation $\mathfrak{o}_{(x)}(y)$ which is obtained
by local propagation from $\mathfrak{o}_x$. There are precisely two such germs, namely $\pm \mathfrak{o}_{(x)}$. 

\begin{definition}\label{DEFNG1252}\index{D- Orientation bundle $\mathscr{O}_f$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over a tame ep-groupoid and $f$ an sc-Fredholm functor.
 The set $\mathscr{O}_f$  consists of all tuples $(x, (\text{DET}(f,x),\mathfrak{o}))$ where $x\in X_\infty$, 
 $\text{DET}(f,x)$ stands for the topological line bundle $\text{DET}(f,x)\rightarrow \text{Lin}(f,x)$ and 
 $\mathfrak{o}$ is an orientation for the latter. 
By $\sigma$ we denote the  natural projection
$$
\sigma\colon \mathscr{O}_f\rightarrow X_\infty,
$$
which is a surjective $(2:1)$-map.  $\mathscr{O}_f$ is turned into a topological space 
by equipping it with the topology ${\mathcal T}$  making every germ $\mathfrak{o}_{(x)}$ continuous. 
We call $(\mathscr{O}_f,{\mathcal T})$ the {\bf orientation bundle} associated to $f$.
\qed
\end{definition}
From the construction it is evident that given $\phi:x\rightarrow x'$ between smooth points the associated local family
$\wh{\Phi}$ covering $\wh{\phi}$ can be used to push forward a germ $\mathfrak{o}_{(x)}$ which is precisely the germ $\mathfrak{o}_{(x')}$,
which at $x'$ is the push forward of the orientation $\mathfrak{o}_x$. 
Let us summarize the previous discussion which follows essentially from the facts established in Chapter \ref{ORIENTXX}.


\begin{theorem}\index{T- Orientation bundle}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over a tame ep-groupoid and $f$ an sc-Fredholm section functor. 
The orientation bundle $\mathscr{O}_f$ associated to the sc-Fredholm section $f$ of $P:W\rightarrow X$ is a topological space
for which 
$$
\sigma: \mathscr{O}_f\rightarrow X_\infty
$$
is a local homeomorphism and the local sections $\mathfrak{o}_{(x)}$ are continuous.
Moreover given $\phi:x\rightarrow x'$   between smooth points the associated local $\wh{\Phi}$ pushes a  local continuous section 
 forward to a continuous local section. 
 \qed
\end{theorem}
Now we are in the position to define orientability of an sc-Fredholm section $f$ of a strong bundle over a tame ep-groupoid
$(P:W\rightarrow X,\mu)$.
\begin{definition}\label{DEFN1254}\index{D- Orientation for sc-Fredholm section functor}
An {\bf orientation} for the  sc-Fredholm section functor $f$ of $P:W\rightarrow X$, where $X$ is tame,  consists of a global continuous section $\mathfrak{o}$ of $\sigma:\mathscr{O}_f\rightarrow X_\infty$,
say
$$
x\rightarrow \mathfrak{o}_x
$$
having the property that for every smooth morphism $\phi\in \bm{X}$ it holds that $\phi_\ast\mathfrak{o}_{s(\phi)}=\mathfrak{o}_{t(\phi)}$.
\qed
\end{definition}
\begin{remark}\index{R- On orientations}
Having orientations for an sc-Fredholm section we obtain natural orientations for the solution spaces assuming
a certain amount of transversality.  Before we study more general cases, 
we consider as an example  a strong bundle $(P:W\rightarrow X,\mu)$ over an ep-groupoid with $\partial X=\emptyset$.
Let $f$ be a compact sc-Fredholm section and assume that for every $x\in X$ with $f(x)=0$ the linearization
is onto.  Further assume that $f$ is oriented by $\mathfrak{o}$. In this case, as  consequences of the compactness assumption
and the regularity assumption $L:=\{x\in X\ |\ f(x)=0\}$ is an \'etale proper  Lie groupoid, see \cite{AR},  in the classical sense having a compact orbit space.
The orientation $\mathfrak{o}$ induces a natural orientation for $T_xL =\text{ker}(f'(x))$ so that in fact $L$ has a natural orientation
and the morphisms respect these orientations. The orbit space $|L|$ is in a natural way a compact oriented orbifold.  
We shall consider generalizations of this result when starting with a $f$ not assuming the transversality condition.
In the case where functorial perturbations are not sufficient to achieve transversality we shall show that after a suitable perturbation
we obtain a branched weighted orbifold, see Chapter \ref{CHAPX16}.
\qed
\end{remark}
The construction of the orientation bundle $\mathscr{O}_f\rightarrow X_\infty$ as well as orientations for them (if they exist) behave well under generalized strong bundle isomorphisms, provided a necessary condition for orientability  holds.
We shall discuss this in more detail in the following.   Assume we are given a strong bundle over a tame ep-groupoid, say $(P:W\rightarrow X,\mu)$,
and an sc-Fredholm section functor $f$ of $P$. Associated to this data we obtain the orientation bundle $\sigma:\mathscr{O}_f\rightarrow X_\infty$ 
which is a topological bundle having as fibers two point sets. Moreover a smooth morphism $\phi:x\rightarrow x'$
defines a bijection between the corresponding fibers. A necessary condition for  orientability  of $f$, i.e. the existence of a continuous 
section functor $\mathscr{o}$ of $\sigma$ is, of course, that elements in $G_x$ for smooth objects $x$ act trivially on $\sigma^{-1}(x)$.
We leave it to the reader to prove the following sufficient and necessary condition of orientability for an sc-Fredholm section functor $f$.
The proof is straight forward.
\begin{proposition}\index{P- Criteria for  orientability}\label{PROPT1256}
An sc-Fredholm section $f$ of the strong bundle over a tame ep-groupoid  is orientable if and only if the following two conditions hold.
\begin{itemize}
\item[{\em(1)}]\ Passing from $\sigma:\mathscr{O}_f\rightarrow X_\infty$ to orbit spaces the continuous map $|\sigma|:|\mathscr{O}_f|\rightarrow |X_\infty|$ has above every class $|x|$ two preimages, i.e. it is $(2:1)$.
\item[{\em(2)}]\ $|\sigma|:|\mathscr{O}_f|\rightarrow |X_\infty|$ admits a global continuous section.
\end{itemize}
\qed
\end{proposition}
The construction of the orientation bundle has some naturality properties.
 \begin{theorem}[Naturality properties of $\mathscr{O}_f$]\index{T- Naturality properties of $\mathscr{O}_f$}\label{THMS1257}
Assume $(P:W\rightarrow X,\mu)$  and $(P':W'\rightarrow X',\mu')$  are strong bundles over tame ep-groupoids and $
\bar{\mathfrak{f}}:W\rightarrow W'$ is  a generalized strong bundle isomorphism covering the generalized isomorphism
$\mathfrak{f}:X\rightarrow X'$.  We assume that $f$ is an sc-Fredholm section functor of $P$ and denote by $f'$ the push-forward sc-Fredholm section.
\begin{itemize}
\item[{\em(1)}]\  With $\sigma$ and $\sigma'$ being the orientation bundles, the generalized 
strong bundle isomorphism induces a fiber-preserving homeomorphism $|\bar{\mathfrak{f}}|_\ast$ fitting into the following commutative diagram
$$
\begin{CD}
|{\mathscr{O}}_f| @> {|\bar{\mathfrak{f}}|}_\ast>> |{\mathscr{O}}_{f'}|\\
@V |\sigma| VV  @V |\sigma'| VV\\
|X_{\infty}| @>|\mathfrak{f}|>> |X'_{\infty}|.
\end{CD}
$$
The construction of $|\bar{\mathfrak{f}}|_\ast$ is functorial.  
\item[{\em(2)}]\ Assume that 
 $\mathsf{o}$ is a continuous section functor of $\sigma$, so that in particular the isotropy groups $G_x$, $x\in X_\infty$, act trivially on $\sigma^{-1}(x)$.
Then $\bar{\mathfrak{f}}$ defines naturally a push-forward $\mathsf{o}'=\bar{\mathfrak{f}}_\ast\mathsf{o}$,
which is a continuous section functor of $\mathscr{O}_{f'}\rightarrow X_\infty'$. 
\end{itemize}
\end{theorem}
\begin{proof}
A representative for $\bar{\mathfrak{f}}$ is a diagram of strong bundle equivalences of the form
$$
\begin{CD}
W @< \Phi<<  V @>\Phi'>> W'\\
@V P VV     @V QVV @V P' VV\\
X @<F<< A @> F'>> X'.
\end{CD}
$$
Then the push-forward by $\Phi'$ of the pull-back of $f$ by $\Phi$ is precisely $f'$.  We 
denote by $f'':A\rightarrow V$ the pull-back of $f$ by $(\Phi,F)$.

Pick any smooth point $x'\in X_\infty'$.  We find a point $a\in A$ and a morphism $\phi'$ resulting in the diagram
$$
F(a)\xleftarrow{F} a\xrightarrow{F'} F'(a)\xrightarrow{\phi'} x'.
$$
Using previously introduced constructions this diagram defines a composition of bijections
$$
\sigma^{-1}(F(x))\rightarrow \sigma''^{-1}(a)\rightarrow \sigma'^{-1}(F'(a))\rightarrow\sigma'^{-1}(x').
$$
Different choices would give
$$
F(b)\xleftarrow{F} b\xrightarrow{F'} F'(b)\xrightarrow{\psi'} x'.
$$
Since $F$ and $F'$ are equivalences the two diagrams are related by morphisms where
the vertical arrows can be canonically filled in using that $F$ and $F'$ are as equivalences fully faithful.
$$
\begin{CD}
F(a)@< F<< a @>F'>> F'(a)@> \phi'>> x'\\
          @V VV                           @V VV       @V\psi'^{-1}\circ\phi'VV    @|\\
F(b)@<F<< b @>F'>> F'(b)@>\psi'>> x'
\end{CD}
$$
These diagrams have canonical lifts to maps between the bundle fibers. 
If the actions of the isotropy groups $G_x$ on the $\sigma^{-1}(x)$ are trivial and in addition we have
a continuous section functor $\mathsf{o}$ of $\sigma$ we can define $\mathsf{o}'$ as follows.
We consider $\mathsf{o}_{F(a)} = (F(a),\text{DET}(f,F(a)),\mathfrak{o}_{F(a)})$. Using the above diagram
and its lift to bundles we obtain an orientation for $\text{DET}(f',x')$ which we denote by $\mathsf{o}'_{x'}$.
Since $\mathsf{o}$ is compatible with morphisms the resulting $\mathsf{o}'_{x'}$ is the same 
if we start with $\mathsf{o}_{F(b)}$. The data in the diagram moves sc-smoothly if we start moving $x'$
which implies that our construction is not only well-defined, but also is continuous. 
We leave it to the reader that representing $\bar{\mathfrak{f}}$ and $\mathfrak{f}$ by a different 
diagram results in the same definition. This is, of course, a consequence of the definition when two diagrams
represent the same generalized isomorphism or bundle map.

If do not impose an assumption on the isotropy groups we see that the above procedure is still
well-defined on the level of orbit spaces and we obtain (1).
\qed \end{proof}



\chapter{\texorpdfstring{Sc$^+$}{sccc}-Multisections}\label{CHAPS13}
In this section we shall introduce the notion of structurable as well as structured sc$^+$-multisections, which will
be needed for a sophisticated perturbation theory.  We first recall some of the relevant properties of ep-groupoids.

\section{Structure Result}
The following fact about ep-groupoids will be used frequently and follows from a previously established result, see Proposition \ref{Prop7.1.9}. Let $X$ be an ep-groupoid, and denote 
as usual the associated morphism M-polyfold by $\bm{X}$.
For every  $x\in X$,  there exists an open neighborhood  $U(x)$ admitting  the natural $G_x$-action and  the target map $t :s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper. We also know that $|U(x)|$ is an open subset of $|X|$ and 
the map $U(x)\rightarrow |U(x)| :y\rightarrow \abs{y}$,  induces a homeomorphism $_{G_{x}}\backslash U(x)\rightarrow |U(x)|$.

\begin{lemma}\label{simple_lemma}
Suppose that $U(x)$ is as described above and let $V$ be a $G_x$-invariant subset of $U(x)$. Then the following statement  are equivalent:
\begin{itemize}
\item[{\em(1)}]\  $\cl_X(V)\subset U(x)$.
\item[{\em(2)}]\  $\cl_{|X|}(|V|)\subset |U(x)|$.
\end{itemize}
\end{lemma}
\begin{proof}
Assuming  (1) we take $z\in \cl_{|X|}(|V|)$ and a sequence $(z_k)\subset  |V|$  such that $z_k\rightarrow z$ in $|X|$. 
Then choosing  points $y_k\in V$ and $y\in X$ satisfying $|y_k|=z_k$ and $|y|=z$, we  find a sequence of morphisms
 $(\phi_k)$ such that  $s(\phi_k)=y_k$ and $t(\phi_k)\rightarrow y$.
Using the properness property of the target map $t\colon s^{-1}(\cl_{X}(V))\to X$,  we may assume,  after perhaps taking a subsequence,  that $\phi_k\rightarrow \phi$ in $\bm{X}$. This implies the convergence $y_k\rightarrow y'$ where $y'$,  in view of the assumption (i), belongs to  $\cl_{X}(V)\subset U(x)$. 
Since $\phi$ is a morphism between $y'$ and $y$, we have $|y'|=\abs{y}=z\in |U(x)|$, proving the statement  (1).

In the other direction,  let $y\in \cl_X(V)$ and $(y_k)$ be a sequence in $V$ satisfying $y_k\rightarrow y$. Then $|y_k|\rightarrow |y|$ so that, by assumption, $|y|\in |U(x)|$. Hence there is a morphism $\phi\colon z\to y$ where $z\in U(x)$. Using that $s$ and $t$ are local sc-diffeomorphisms, we find open neighborhoods $W(z)$, $W(y)$, and $W(\phi)$ such that 
the source and target maps $s\colon W(\phi)\rightarrow W(z)$ and $t\colon  W(\phi)\rightarrow W(y)$ are sc-diffeomorphisms. 
For large $k$, we find morphisms $\phi_k\in W(\phi)$ satisfying $s(\phi_k)=z_k\in W(y)$ and $t(\phi_k)=y_k$. From $y_k\to y$, we conclude the convergence  $\phi_k\to \phi$ and $z_k\to z$.  Since $y_k, z_k\in U(x)$, there are $g_k\in G_x$ such that $\Gamma (g_k, z_k)=\phi_k$.
After perhaps taking a subsequence we may assume that $\Gamma (g, z_k)=\phi_k$. This implies that $y_k=g\ast z_k\to y=g\ast z$ and  shows 
that $y\in U(x)$.

\qed \end{proof}

A crucial concept is that of a good system of open neighborhoods defined next.
\begin{definition}\label{DEFF1}\index{D- Good system}\index{$\mathfrak{U}$}
A collection  $\mathfrak{U}={(U(x))}_{x\in X}$ of open neighborhoods of the points in the ep-groupoid $X$ is called
a {\bf good system} of open neighborhoods if the following holds.
\begin{itemize}
\item[(1)]\ For every $x\in X$, the target map $t\colon s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper.
\item[(2)]\ Every open neighborhood  $U(x)$ is equipped with the natural $G_x$-action.
\item[(3)]\ For every two points $x,x'\in X$,  the open subset $\bm{U}(x, x')$\index{$\bm{U}(x,x')$} of $\bm{X}$, defined by 
$$
\bm{U}(x,x'):=\{\phi\in \bm{X}, \vert \,  \text{$s(\phi)\in U(x)$ and $t(\phi)\in U(x')$}\}, 
$$
has the following property. For every connected component $\Sigma\subset \bm{U}(x,x')$, 
the source map $s\colon \Sigma\rightarrow U(x)$ and the target map $t\colon \Sigma\rightarrow U(x')$ are sc-diffeo\-mor\-phisms onto open subsets of $U(x)$ and $U(x')$, respectively.
\end{itemize}
\qed
\end{definition}
The following obvious result allows us to introduce the notion of refinement of a good system of open neighborhoods.
\begin{proposition}\label{prop_obvious}
Let ${(U(x))}_{x\in X}$ be  a good system of open neighborhoods and $(\wt{U}(x))_{x\in X}$ a family of $G_x$-invariant open neighborhoods satisfying $\wt{U}(x)\subset U(x)$ for all $x\in X$. Then ${(\wt{U}(x))}_{x\in X}$ is a good system of open neighborhoods.
\qed
\end{proposition}
Given ${(U(x))}_{x\in X}$ and open neighborhoods $V(x)$ for every point $x\in X$ we can pick for every $x\in X$ 
a $G_x$-invariant open neighborhood $W(x)$ which is contained in $U(x)\cap V(x)$. As a consequence of the proposition
${(W(x))}_{x\in X}$ is a good system of open neighborhoods.
This prompts the following definition.
\begin{definition} \index{D- Refinement of a good system}\index{D- Subordinate good system}
Let $X$ be an ep-groupoid and $\mathfrak{U}={((U(x))}_{x\in X}$ a good system of open neighborhoods. We say that another good system
$\mathfrak{W}={(W(x))}_{x\in X}$ is a {\bf refinement} provided $W(x)\subset U(x)$ for all $x\in X$.
Given an arbitrary open covering of $X$ be open sets we say that a good system $\mathfrak{U}$  is {\bf subordinate}
provided every $U(x)$ is contained in a set of the open covering.
\qed
\end{definition}
In the following we shall explore the properties of a good system of open neighborhoods $\mathfrak{U}$.
We begin with the study of open invariant neighborhoods $U(x)$ and $U(x')$ equipped with the natural $G_x$ and $G_{x'}$-actions, respectively.  We denote by $\bm{U}(x,x')$ the collection of morphisms in $\bm{X}$ starting in $U(x)$ and ending in $U(x')$.
We define the 
sc-smooth map $G_{x'}\times \bm{U}(x,x')\times G_x\rightarrow \bm{U}(x,x')$  by 
$$
g'\ast\phi \ast g:= \Gamma'(g', t(\phi))\circ\phi\circ \Gamma(g,g^{-1}\ast s(\phi)).
$$
By definition,  $t(g'\ast\phi\ast g) = g'\ast t(\phi)$ and $s(g'\ast\phi\ast g) = g^{-1}\ast s(\phi)$,  so that
$$
g'\ast\phi\ast g\colon  g^{-1}\ast s(\phi)\rightarrow g'\ast t(\phi).
$$
Moreover, if  $h,g\in G_x$ and $g',h'\in G_{x'}$, then 
\begin{equation*}
\begin{split}
&\phantom{=.}(g'h')\ast\phi\ast (gh)\\
&= \Gamma'(g'h',t(\phi))\circ \phi\circ \Gamma(gh,(h^{-1}g^{-1})\ast s(\phi))\\
&= \Gamma'(g',h'\ast t(\phi))\circ\Gamma'(h',t(\phi))\circ\phi\circ  \Gamma(g,g^{-1}\ast s(\phi))\circ \Gamma(h,(h^{-1}g^{-1})\ast s(\phi))\\
&= \Gamma'(g',h'\ast t(\phi))\circ (h'\ast\phi \ast g)\circ \Gamma(h,h^{-1}\ast (g^{-1}\ast s(\phi)))\\
&=\Gamma'(g',t(h'\ast\phi \ast g))\circ (h'\ast\phi \ast g)\circ \Gamma(h, h^{-1}\ast s(h'\ast\phi \ast g))\\
&= g'\ast (h'\ast\phi\ast  g)\ast h.
\end{split}
\end{equation*}
This together with   $1_{x'}\ast \phi\ast 1_x=\phi$ implies that 
$$
G_{x'}\times \bm{U}(x,x')\times G_x\rightarrow \bm{U}(x,x')
$$
defines a right-action of $G_x$ and  a left-action of $G_{x'}$ on $\bm{U}(x,x')$, which are commuting. 
The source map $s:\bm{U}(x,x')\rightarrow U(x)$ is $G_x$ equivariant since
$$
s(\phi\ast g) = s(\phi\circ \Gamma(g,g^{-1}\ast(\phi))) = g^{-1}\ast s(\phi)
$$
when we let $G_x$ act on the right of $U(x)$. Similarly $t:\bm{U}(x,x')\rightarrow U(x')$ satisfies
$$
t(g'\ast \phi) = \Gamma'(g',t(\phi))= g'\ast t(\phi),
$$
where $G_{x'}$ acts from the left, i.e. the natural action of $G_{x'}$.
\begin{definition}\index{D- Natural bi-action on $\bm{U}(x,x')$}
Given $x,x'\in X$ and open neighborhoods $U(x)$ and $U(x')$ with the natural actions by $G_x$ and $G_{x'}$, respectively,
we shall call 
$$
G_{x'}\times \bm{U}(x,x')\times G_x\rightarrow \bm{U}(x,x')
$$
the {\bf natural bi-action}.
\qed
\end{definition}


Before we give a basic existence result for systems of good neighborhoods we shall derive some of their properties with respect to our actions. 
\begin{lemma}
Let  ${(U(x))}_{x\in X}$ be  a good system of open neighborhoods and $\Sigma$ a connected component of $\bm{U}(x,x')$. Then the following assertions hold true.
\begin{itemize}
\item[{\em(1)}]\ If $g'\in G_{x'}$ and $g'\ast\Sigma=\Sigma$,  then $g'=1_{x'}$.
\item[{\em(2)}]\ If $g\in G_x$ and $\Sigma\ast g=\Sigma$,  then $g=1_x$.
\item[{\em(3)}]\ If \  $\Sigma_1$ and $\Sigma_2$ are connected components of $\bm{U}(x, x')$,  then either 
$s(\Sigma_1)=s(\Sigma_2)$ or $s(\Sigma_1)\cap s(\Sigma_2)=\emptyset$.
 The same assertion holds for the target map $t$.
\end{itemize}
\end{lemma}
\begin{proof}
(1) The target map $t\colon \Sigma\rightarrow U(x')$ is a sc-diffeomorphism onto an open subset $O'$.  From $g'\ast\Sigma=\Sigma$ it follows that 
$g'\ast O'=O'$. For  $\phi \in \Sigma$ consider $g'\ast \phi\in \Sigma$ and note that  the morphisms $\phi$ and $g'\ast \phi$ have the same source. Since 
the source map  $s\colon \Sigma\rightarrow U(x)$ is a sc-diffeomorphism onto an open subset of $U(x)$,   we deduce
 that $g'\ast\phi=\phi$. This means  that $\Gamma'(g',t(\phi))\circ \phi=\phi$ and therefore 
$\Gamma'(g',t(\phi))=1_{t(\phi)}$. This implies  that $g'=1_{x'}$, as claimed.  Part (2) is proved similarly.

(3) Assuming that  $s(\Sigma_1)\cap s(\Sigma_2)\neq \emptyset$,  we find morphisms $\phi_1\in \Sigma_1$ and $\phi_2\in\Sigma_2$ 
satisfying $s(\phi_1)=s(\phi_2)$, and a unique $g'\in G_{x'}$ for which 
$$
\phi_2 = \Gamma'(g',t(\phi_1))\circ \phi_1.
$$
Then, considering the sc-smooth map 
$$
\Sigma_1\rightarrow \bm{U}(x,x'), \quad  \phi\mapsto  \Gamma'(g',t(\phi))\circ \phi, 
$$
we deduce that $g'\ast \Sigma_1=\Sigma_2$ since both $\Sigma_1$ and $\Sigma_2$ are connected components of $\bm{U}(x, x')$.
Since $s(g'\ast \Sigma_1)=s(\Sigma_1)$, we see that $s(\Sigma_1)=s(\Sigma_2)$, which proves our claim.  
A similar argument applies to the target map $t$.
\qed \end{proof}

\begin{theorem}[{\bf Extension of good partial systems}]\index{T- Extension of a good partial system}\label{THMX1317}
Let $Y$ be an ep-groupoid and $Q$ an open subset of the object space so that $|Q|=|Y|$.
Equip the   full subcategory associated to $Q$ with the induced structure of an ep-groupoid. 
Assume we are given a good system ${(U(q))}_{q\in Q}$ of open neighborhoods for the ep-groupoid $Q$.
Then given for  every $y\in Y\setminus Q$  an open neighborhood $W(y)\subset Y$, we can find 
open neighborhoods $U(y)$ for $y\in Y\setminus Q$ so that $U(y)\subset W(y)$ and $\mathfrak{U}$
$$
\mathfrak{U}={(U(y))}_{y\in Y}
$$
is a good system of open neighborhoods for $Y$.  
\end{theorem}
\begin{proof}
For $y\in Y\setminus Q$ pick $\psi_y\in \bm{Y}$ with $q_y:= s(\psi_y)\in Q$ and $t(\psi_y)=y$. We find open neighborhoods
$O(\psi_y)$, $O(q_y)$, and $U(y)$ such that the following holds.
\begin{itemize}
\item $s:O(\psi_y)\rightarrow O(q_y)$ and $t:O(\psi_y)\rightarrow U(y)$ are sc-diffeomorphisms.
\item $O(q_y)\subset U(q_y)$ and $O(q_y)$ is invariant under the action on $U(q_y)$.
\item $U(y)$ admits the natural $G_y$-action and has the properness property and is contained in $W(y)$.
\end{itemize}
We note that we can pick these three neighborhoods arbitrarily small. Using the properness property 
of $U(q_y)$, which contains $O(q_y)$,  we can pick $U(y)$ so small that the following holds in addition.
\begin{itemize}
\item For every connected component $\Sigma$ of $\bm{U}(q_y,y)=\{\phi\in \bm{Y}\ |\ s(\phi)\in U(q_y),\ t(\phi)\in U(y)\}$ the maps
$s:\Sigma\rightarrow U(q_y)$ and $t:\Sigma\rightarrow U(y)$ are sc-diffeomorphisms onto their image.
\end{itemize}



At this point we have defined a collection $\mathfrak{U}={(U(y))}_{y\in Y}$ of open neighborhoods, where for $q\in Q$
the open set $U(q)$ is the original given one.  Then $\mathfrak{U}$
clearly satisfies Properties (1) and (2) of Definition \ref{DEFF1}. Next we consider the  Property (3).
If $q_1,q_2\in Q$ we already know that $\bm{U}(q_1,q_2)$ satisfies (3). 
We need to investigate the following three cases for Property (3) which involve new sets.
\begin{itemize}
\item[(1)]\  $\bm{U}(q,y)$ for $q\in Q$ and $y\in Y\setminus Q$.
\item[(2)]\ $\bm{U}(y,q)$ for  $y\in Y\setminus Q$ and $q\in Q$.
\item[(3)]\ $\bm{U}(y,z)$ for $y,z\in Y\setminus Q$.
\end{itemize}
\noindent{\bf Case (1)}  We define an sc-smooth  map $A: \bm{U}(q,y)\rightarrow \bm{U}(q,q_y)$
by 
$$
A(\phi) =[(t|O(\psi_y))^{-1}(t(\phi))]^{-1}\circ\phi.
$$
We note that $A$ is a local sc-diffeomorphism. 
 We  verify
\begin{eqnarray}\label{EQN13X}
s(A(\phi))=   s(\phi)
\end{eqnarray}
and
\begin{eqnarray}\label{EQN13XX}
t(A(\phi)) = t ([(t|O(\psi_y))^{-1}(t(\phi))]^{-1}\circ\phi) =  \wh{\psi}_y^{-1}(t(\phi)),
\end{eqnarray}
where $\wh{\psi}_y:O(q_y)\rightarrow O(y)$ is the sc-diffeomorphism associated to $\psi_y$.
Now we show that $A$  is injective, and hence an sc-diffeomorphism onto its (open) image.
To see the injectivity assume that $A(\phi_1)=A(\phi_2)$. Then we derive from  (\ref{EQN13XX})
that  $t(\phi_1)=t(\phi_2)$ which implies, using the definition of $A$, that $\phi_1=\phi_2$. 
We rewrite (\ref{EQN13XX}) as 
\begin{eqnarray}\label{EQN13Y}
t(\phi)= \wh{\psi}_y\circ t(A(\phi)).
\end{eqnarray}
If $\Sigma\subset \bm{U}(q,y)$ is a connected component, then $A(\Sigma)$ lies in a connected component
$\Sigma'$ of $\bm{U}(q,q_y)$. Since $s|\Sigma'$ and $t|\Sigma'$ are sc-diffeomorphisms onto their images
it follows that $s|\Sigma$ as well as $t|\Sigma$ have the same property.\par

\noindent{\bf Case (2)}  The map $B: \bm{U}(y,q)\rightarrow \bm{U}(q,y):\phi\rightarrow \phi^{-1}$ is an sc-diffeomorphism. Using that $t\circ B =s$ and $s\circ B=t$ the assertion follows from {\bf Case (1)}.\par

\noindent{\bf Case (3)}  The map 
$C:  \bm{U}(y,z)\rightarrow \{\phi\in\bm{Y}\ |\ s(\phi)\in O(q_{y}),\ t(\phi)\in O(q_{z})\}
$
defined by 
$$
C(\phi) =\left ((t|O(\psi_z))^{-1}(t(\phi))\right)^{-1}\circ \phi\circ  ((t|O(\psi_y))^{-1}(s(\phi)))
$$
is an sc-diffeomorphism and 
$$
t(C(\phi))= \wh{\psi}_z^{-1}(t(\phi))\ \ \text{and}\ \ s(C(\phi)) = \wh{\psi}_y^{-1}(s(\phi)).
$$
Moreover $\{\phi\in\bm{Y}\ |\ s(\phi)\in O(q_{y}),\ t(\phi)\in O(q_{z})\}\subset \bm{U}(q_y,q_z)$.
If $\Sigma$ is a connected component in  $\bm{U}(y,z)$ ist image under $C$ lies in a connected component
$\Sigma'$ of $\bm{U}(q_y,q_z)$ on which $t$ and $s$ have the desired properties.
This immediately with the previous discussion implies the desired result.
\qed \end{proof}




The basic result is the following theorem which is concerned with an ep-groupoid  $X$ having a paracompact orbit space.
The paracompactness of $|X|$ is used  in a crucial way. The theorem  shows 
that there exists a system of good open neighborhoods $\mathfrak{U}$ with the $U(x)$ being arbitrarily small.
\begin{theorem}[{\bf Existence of good systems}]\label{xxxx-structure}\index{T- Existence of a good system}
Let $X$ be an ep-groupoid with paracompact  orbit space  and let ${(W(x))}_{x\in X}$ be  collection of open neighborhoods around the points in $X$.
Then there exists a good system of open neighborhoods ${(U(x))}_{x\in X}$ satisfying $U(x)\subset W(x)$ for all $\in X$.
\end{theorem}

\begin{proof} In view of the extension theorem Theorem \ref{THMX1317} it suffices to verify the following assertion.\par

\noindent {\bf Assertion:} There exists an open subset $V$ of $X$ having the property $|V|=|X|$, so that the ep-groupoid 
associated to $V$ admits a good system of open neighborhoods ${(U(x))}_{x\in V}$ with $U(x)\subset V$.
The paracompactness of $|X|$ is important for this part of the construction.\par

By taking suitable smaller subsets for $W(x)$ we may assume without loss of generality that the following holds true.
\begin{description}
\item[(1)]  For every $x\in X$ the map $t:s^{-1}(cl_X(W(x)))\rightarrow X$ is proper.
\item[(2)]  $W(x)$ is equipped with the natural $G_x$-action. 
\end{description}
These will be our standing assumptions for the following constructions.\par

 We start with the open covering ${(|W(x)|)}_{x\in X}$ of $|X|$.
Using the paracompactness of $|X|$ we know that $|X|$ is metrizable by Theorem \ref{ATHOME}.
We can find open subsets $\wt{V}_x$ of $|W(x)|$ so that ${(\wt{V}_x)}_{x\in X}$ is a locally finite open covering of
$|X|$ and $\cl_{|X|}(\wt{V}_x)\subset |W(x)|$. Of course, many of these sets might   be empty. Let $A\subset X$ be the collection of all $x\in X$ with $\wt{V}_x\neq \emptyset$.
 Define for $a\in A$
\begin{eqnarray}
V_a =\pi^{-1}(\wt{V}_a) \cap W(a).
\end{eqnarray}
Note that we write $V_a$ instead of $V(a)$, to indicate that $V_a$ need not to contain the point $a$.
The following holds by construction.
\begin{description}
\item[(3)] $V_a\subset W(a)$ and $V_a$ is invariant under $G_a$ for $a\in A$.
\item[(4)] $\cl_{|X|}(|V_a|)\subset |W(a)|$ for $a\in A$.
\item[(5)] ${(|V_a|)}_{a\in A}$ is a locally finite covering of $|X|$.
\end{description}
It follows that $\cl_X(V_a)\subset W(a)$ for $a\in A$. Consider the open subset $V$ of $X$ defined by
$$
V=\bigcup_{a\in A} V_a.
$$
Clearly $|V|=|X|$.  If $x\in V$ there exist a $G_x$-invariant open neighborhood $U_0(x)$ so that $U_0(x)$ intersects only a finite number
of $\cl_X(V_a)$ nontrivially. The set of such $a$  can be written as
$$
\{a^x_1,...,a^x_{\ell_x}\}.
$$
We may also assume the following after perhaps a renumbering of the $a^x_i$.
\begin{description}
\item[(6)] $\cl_X(U_0(x))\subset V_{a^x_1}$ and $U_0(x)\subset W(x)$.
\item[(7)]  $\cl_X(U_0(x))\subset W(a^x_i)$ for $i\in \{1,...,\ell_x\}$.
\end{description}
For $x\in V$ we consider the set of all morphisms starting in $\cl_X(V)$ and ending in $x$. Since a small open neighborhood
of $|x|$ only intersects a finite number of the $|V_a|$, and using the properness of the associated $t:s^{-1}(\cl_X(W(a)))\rightarrow X$
we deduce that this  set is finite and denote it by $\Theta_x$
$$
\Theta_x =\{\phi\in \bm{X}\ |\ s(\phi)\in \cl_X(V),\ t(\phi)=x\}.  
$$
Given an open neighborhood  ${\mathcal O}$ of $\Theta_x$ we find an open $G_x$-invariant  neighborhood $U_1(x)\subset U_0(x)$
such that $\{\phi\in \bm{X}\ |\ s(\phi)\in \cl_X(V),\ t(\phi)\in U_1(x)\}$ is contained in ${\mathcal O}$.  
This implies, taking ${\mathcal O}$ sufficiently small, and $U_1(x)$ appropriately, that for a connected component $\Sigma$
of $\{\phi\in \bm{X}\ |\ s(\phi)\in V,\ t(\phi)\in U_1(x)\}$ the maps $s|\Sigma$ and $t|\Sigma$ are 
sc-diffeomorphisms onto open subsets of $V$ and $U_1(x)$, respectively.  Define the collection ${(U(x))}_{x\in V}$ by
$U(x)=U_1(x)$. 

At this point we have constructed open neighborhoods $U(x)$ around the points $x\in V$ so that the following holds.
\begin{itemize}
\item[(i)]\ \ \ Each $U(x)$ admits the natural $G_x$-action.
\item[(ii)]\ \ \  $t:s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper.
\item[(iii)]\ \ \ For $x,x'\in V$ the M-polyfold $\bm{U}(x,x')$ has the property that for a connected component $\Sigma$ the maps $s|\Sigma$ and $t|\Sigma$
are sc-diffeomorphisms onto open subsets of $U(x)$ and $U(x')$, respectively.
\end{itemize}
 Hence, we satisfy the definition of a good
system of open neighborhoods but only on $V\subset X$. However, it is important to recall that $|V|=|X|$.
Now employing Theorem \ref{THMX1317} this family of sets can be extended to $X$ and the proof is complete.
\qed \end{proof}



We discuss some of the consequences of having a good system of neighborhoods ${(U(x))}_{x\in X}$ for the ep-groupoid $X$ with paracompact orbit space $|X|$.
Assume that $\Sigma$ is a connected component in ${\bf U}(x,x')$.
Define $O=s(\Sigma)$ and $O'=t(\Sigma)$ and denote by $G_{x,\Sigma}$ the subgroup of $G_x$ consisting of the elements $g\in G_x$ satisfying $ g\ast O =O$.
Similarly we define $G_{x',\Sigma}$ as the subgroup of $G_{x'}$ consisting of all $g'$ with $g'\ast O'=O'$. 
Define the sc-diffeomorphism $D_\Sigma:O\rightarrow O'$ by
$$
D_\Sigma = t\circ (s|\Sigma)^{-1}.
$$
For $g\in G_{x,\Sigma}$ and $z\in O$ we consider $D_\Sigma(g\ast z)$ and $D_\Sigma(z)$.  We pick $\psi, \phi \in \Sigma$
with $s(\psi)=z$ and  $s(\phi)=g\ast z$, i.e. $\psi=(s|\Sigma)^{-1}(z)$ and $\phi=(s|\Sigma)^{-1}(g\ast z)$. Then 
$$
t(\psi)= t\circ (s|\Sigma)^{-1}(z)=D_\Sigma(z)\ \text{and}\ t(\phi)= t\circ (s|\Sigma)^{-1}(g\ast z)= D_\Sigma(g\ast z).
$$
For every $z\in O$ we define the morphism
$$
\Theta_g(z):=[(s|\Sigma)^{-1}(g\ast z)] \circ \Gamma(g,z)\circ [(s|\Sigma)^{-1}(z)]^{-1}: D_\Sigma(z)\rightarrow D_\Sigma(g\ast z),
$$
 which has source and target in $O'$.
For $z\in O$ there exists  a unique $g'_z\in G_{x'}$ that that
$$
\Gamma'(g_z',D_\Sigma(z))= \Theta_g(z).
$$
Since the right-hand side changes smoothly in $z$ it follows that $g_z'$ is independent of $z\in O$. It will be denoted by $g'(g)$ and
it is also clear that $g'(g)\in G_{x',\Sigma}$. Hence we obtain for every $z\in O$ and $g\in G_{x,\Sigma}$  the identity
$$
\Gamma'(g'(g),D_\Sigma(z))=\Theta_g(z).
$$
Applying $t$ we arrive at
$$
g'(g)\ast D_\Sigma(z)= D_\Sigma(g\ast z).
$$
Using the uniqueness of the map $G_{x,\Sigma}\rightarrow G_{x',\Sigma}:g\rightarrow g'(g)$ it follows from 
\begin{eqnarray*}
&& (g'(g)g'(h))\ast D_\Sigma(z)\\
&=&g'(g)\ast(g'(h)\ast D_\Sigma(z))\\
&=& g'(g)\ast (D_\Sigma(h\ast z))\\
&=&D_\Sigma(g\ast (h\ast z))\\
&=& D_\Sigma((gh)\ast z)\\
&=& g'(gh)\ast D_\Sigma(z)
\end{eqnarray*}
that $g'(gh)=g'(g)g'(h)$.
For later reference we note the following proposition.
\begin{proposition}
Let ${(U(x))}_{x\in X}$ a good system of open neighborhoods and  $\Sigma\subset {\bf U}(x,x')$ be a connected component.
Then there exists a uniquely determined group isomorphism $G_{x,\Sigma}\rightarrow G_{x',\Sigma}:g\rightarrow g'(g)$ such that for all $z\in s(\Sigma)$
$$
(s|\Sigma)^{-1}(g\ast z)= g'(g)\ast (s|\Sigma)^{-1}(z)\ast g^{-1}.
$$
\end{proposition}
\begin{proof}
By definition, with $\psi_z = (s|\Sigma)^{-1}(z)$ for $z\in O$ it holds that $D_\Sigma(z)=t(\psi_z)$.  Recall that
$$
\psi_{g\ast z} \circ \Gamma(g,z)\circ \psi_z^{-1}=\Gamma'(g'(g),t(\psi_z)).
$$
Hence
$$
\psi_{g\ast z}\circ \Gamma(g,z) = \Gamma'(g'(g),t(\psi_z))\circ \psi_z = g'(g)\ast \psi_z.
$$
Moreover, we compute 
$$
\psi_{g\ast z}\ast g = \psi_{g\ast z} \circ \Gamma(g,g^{-1}\ast s(\psi_{g\ast z})) = \psi_{g \ast z}\circ \Gamma(g,z).
$$
Putting these facts together we arrive at
$$
\psi_{g\ast z}= g'(g)\ast \psi_z \ast g^{-1}.
$$
\qed \end{proof}

\section{General \texorpdfstring{$\bssc^+$}{bss}-Multisections}\label{multioo}

We shall introduce the notion of a $\ssc^+$-multisection.
Multisections are a particular case of  set-valued sections. Set-valued operators have been used in nonlinear functional analysis for a long time and we refer the reader to \cite{AE}. Our definition is along the lines of the definition introduced  in \cite{CRS} and  related to \cite{FO}. The following definition from \cite{HWZ3.5} brings a definition in  \cite{CRS} into the groupoid framework.

We view the non-negative rational numbers ${\mathbb Q}^+=\Q\cap [0,\infty)$ as a category having only the identities as morphisms.



\begin{definition}[{\bf $\bssc^+$-multisection}] \label{sc+-section-functor}\index{D- $\bssc^+$-multisection}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the ep-groupoid $X$. Then an {\bf $\ssc^+$-multisection} is a %
functor 
$$
\Lambda:W\rightarrow {\mathbb Q}^+
$$
 such that the following local representation 
(called {\bf local section structure})\index{Local section structure} holds true.  Around  every object $x_0\in X$,  there exists an open neighborhood $U(x_0)$ on which the isotropy group $G_{x_0}$ acts by its natural representation, and  finitely many $\ssc^+$-sections
$s_1,\ldots ,s_k :U(x_0) \to W$ (called {\bf local sections}) with associated  positive rational numbers $\sigma_1,\ldots ,\sigma_k$ (called {\bf weights})\index{Weights} satisfying the following properties:
\begin{itemize}
\item[(1)]\ $\sum_{i=1}^k \sigma_i =1.$
\item[(2)]\ $\Lambda(w)=\sum_{i\in \{1,\ldots k\  |\ w=s_i(P(w))\}} \sigma_i$ 
\end{itemize}
for all $w\in W|U(x_0)$, where the empty sum has by definition the value $0$.
We shall refer to the right hand side of the identity (2) 
as a {\bf local representation}\index{Local representation of $\Lambda$} near $x_0$.
\qed
\end{definition}

The functoriality of $\Lambda$ implies that 
$\Lambda (w')=\Lambda (w)$, if there exists a morphism $w\to w'$ in $\bm{W}$. Explicitly,
$$
\Lambda (\mu (\phi, w))=\Lambda (w)
$$ 
for all $(\phi, w)\in \bm{X}_{_{s}\times_P}W$. Hence $\Lambda$ induces a map $\abs{\Lambda}: \abs{W}\to \Q^+$ on the orbit space of $W$.
\begin{definition}\label{DEFNX1322}
\begin{itemize}
\item[(1)]\ The  {\bf domain support}\index{D- Domain support of $\Lambda$} of $\Lambda$ \index{$\text{dom-supp}(\Lambda)$} is the subset of $X$, defined by 
$$
\text{dom-supp}(\Lambda)=
\text{cl}_X\left(\{x\in X\, \vert \, \ \exists
\text{ $w\in W_x\setminus\{0\}$ for which  $\Lambda(w)>0$}\}\right).
$$
\item[(2)]\ The {\bf support of $\bm{\Lambda}$} \index{D- Support of $\Lambda$} is the subset $\supp(\Lambda)$\index{$\supp(\Lambda)$} of $W$ defined by
$$
\supp(\Lambda)=\{w\in W\, \vert \, \Lambda(w)>0\}.
$$
\qed
\end{itemize}
\end{definition}
For every $x\in X$, the set 
$$
\supp(\Lambda)(x)=\{w\in W\,\vert \, \text{$P(w)=x$ and $\Lambda (w)>0$}\}\index{$\supp(\Lambda)(x)$}
 $$
  is finite and 
$$\sum_{w\in \supp(\Lambda)(x)}\Lambda (w)=1.$$
Moreover, if $x\in U(x_0)$, then 
$$
\supp(\Lambda)(x)=\{s_1(x),\ldots ,s_k(x)\}.
$$
\begin{definition}\label{DEF1223}\index{D- Pointwise norm $N(\Lambda)$}
If $N$ is an auxiliary norm for the strong bundle $(P,\mu)$ we define for $x\in X$, 
$$
N(\Lambda)(x)=\max\{N(w)\, \vert \, \text{$w\in\supp(\Lambda)$ satisfying  $P(w)=x$}\}.\index{$N(\Lambda)(x)$}\index{$N(\Lambda)(x)$}.
$$
We shall call $N(\Lambda)$ the {\bf pointwise norm} of the sc$^+$-multisection with respect to the auxiliary norm $N$.
\qed
\end{definition} 
Denoting by  $0_W$  the zero-section of $W$,  we obtain the relations
$$
\text{dom-supp}(\Lambda)=\cl_X(P(\supp(\Lambda)\cap (W\setminus 0_W))) =\cl_X(\{x\in X\ |\ N(\Lambda)(x)>0\}).
$$
\begin{definition}
The $\ssc^+$-multisection is called {\bf trivial  
on the set $V\subset X$} \index{D- $\Lambda$ trivial over $V$} if $\Lambda$ is identically equal to $1$ on the zero-section  over $V$, i.e., $\Lambda (0_x)=1$ for all $x\in V$ (and hence $\Lambda (w_x)=0$ for all $w_x\neq 0_x$).
\qed
\end{definition}
We note that the domain-support of $\Lambda$ is the smallest closed set in $X$ outside of which $\Lambda$ is trivial.
  In general the local representation is not unique. Among the local representations 
there are certain preferable ones. This is discussed next.

Let $\Lambda:W\rightarrow {\mathbb Q}^+$ be an sc$^+$-multisection,  assume $U(x)$ is an open $G_x$-invariant neighborhood
(natural action) so that the properness property holds, 
 and ${(s_j)}_{i\in J}$ is  the associated local section structure with weights $(\sigma_j)$.

We take  a suitable rational number $\sigma=q/p\in (0,1]$ and, for every $j\in J$, a positive integer $k_j$ such that 
$k_j (q/p)=\sigma_j$.  We introduce  a new index set
$\wh{J}$ consisting of all pairs $(j,i)\in J\times \N$ where $1\leq i\leq q k_j$, and new sections $(s_{(j,i)})_{(j, i)\in \wh{J}}$ on $U(x)$ by
$$
s_{(j,i)}=s_j.
$$
The cardinality of the index set $\wh{J}$ is equal to  $p$, 
$$
|\wh{J}|= \sum_{j\in J} q\cdot k_j =\sum_{j\in J} p\cdot \sigma_j = p.
$$
We have replaced the original section $s_j$ having  weight $\sigma_j$ by $(k_j\cdot q)$-many sections $s_{(j, i)}$, 
each having weight $\frac{\sigma_j}{k_j\cdot q} =\frac{1}{p}=\frac{1}{\wh{J}}$. Hence we have constructed a local $\ssc^+$-section structure over $U(x)$
of $p$ many sections having equal weights $1/p$.

Consequently, we may assume that we are given an $\ssc^+$-section structure $(s_i)_{i\in I}$ over $U(x)$ each having weight $1/\abs{I}$. Then
$$
\Lambda(w)=\frac{1}{\abs{I} }\abs{   \{i\in I \, \vert \, s_i(P(w))=w\}    }
$$
for $ w\in W$ satisfying $P(w)\in U(x)$.

 Abbreviating $\wh{I}=I\times G_x$, 
we define, for $(i,g)\in \wh{I}$,  a new $\ssc^+$-section $s_{(i,g)}$  on $U(x)$ by
$$
s_{(i,g)}(g\ast y) =\mu(\Gamma(g,y),s_i(y)).
$$
We have defined a section structure $(s_{(i,g)})_{(i,g)\in\wh{I}}$ over $U(x)$, where each section has the weight $1/\abs{\wh{I}}$, and such that 
$$
\Lambda(w) =\frac{1}{\abs{\wh{I}}} \abs{\{(i, g)\in \wh{I}\, \vert  \,   s_{(i, g)}(P(w))=w\}}
$$
for $w\in W$ satisfying $P(w)\in U(x)$.  Defining the action of $G_x$ on $\wh{I}$ by $g(i, h):=g\ast (i, h)=(i, gh)$ for $(i, h)\in \wh{I}$,  we compute

\begin{equation*}
\begin{split}
s_{g(i,h)}( g\ast y) &=s_{(i,gh)}(g\ast y)\\
&=\mu(\Gamma(gh,h^{-1}\ast y),s_i(h^{-1}\ast y))\\
&=\mu(\Gamma(g, y),\mu(\Gamma(h,h^{-1}\ast y),s_i(h^{-1}\ast y)))\\
&=\mu(\Gamma(g, y),s_{(i,h)}( y))
\end{split}
\end{equation*}

In  other words we can always find a $\ssc^+$-section structure ${(s_i)}_{i\in I}$, where every section carries the same weight $1/|I|$,
the isotropy group
$G_x$ acts on the index set $G_x\times I\rightarrow I$, $(g,i)\rightarrow g(i)$,  and the family of sections has an invariance property with respect to the action
$$
s_{g(i)}(g\ast y)=\mu(\Gamma(g,y),s_i(y)).
$$
This prompts the following definition. 

\begin{definition}\label{XDEF1}
A {\bf symmetric $\ssc^+$-section structure}\index{D- Symmetric sc$^+$-section structure} for 
$$
\Lambda: W\to \Q^+,
$$
a $\ssc^+$-multisection,   on $U(x)$ is a pair $(U(x), (s_i))_{i\in I_x}$  consisting of the 
$G_x$-invariant open neighborhood $U(x)$ such that the target map $t: s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper, a finite family $(s_i)_{i\in I_x}$ of $\ssc^+$-sections  defined on $U(x)$,  and an action of $G_x$ on the index set $I_x$ such that the following holds:
\begin{itemize}
\item[(1)]\ $s_{g(i)}(g\ast y) = \mu(\Gamma(g,y),s_i(y))$ for all $y\in U(x)$, $i\in I_x$, and $g\in G_x$.
\item[(2)]\ $ \Lambda(w) =\frac{1}{|I_x|}|\{i\in I_x\ |\ s_i(P(w))=w\}|$ for all $w\in W$ satisfying $P(w)\in U(x)$.
\end{itemize}
\qed
\end{definition}
It is important to notice that we allow for different $i,i'\in I_x$ that $s_i=s_{i'}$.
From the previous discussion we obtain the following result.
\begin{lemma}
 Every sc$^+$-multisection functor locally admits a symmetric sc$^+$-sec\-tion structure.
 \qed
\end{lemma}
As a first new object we consider tuples $(\Lambda,\mathfrak{U},\mathfrak{S})$, where $\mathfrak{U}$ is a a good system of
open neighborhoods, and $\mathfrak{S}$ a family of sc$^+$-section structures.
\begin{definition}\index{D- System of symmetric sc$^+$-section structures}
A sc$^+$-multisection with a {\bf system of symmetric  section structures} is a tuple $(\Lambda,\mathfrak{U},\mathfrak{S})$,
where $\Lambda:W\rightarrow {\mathbb Q}^+$ is an sc$^+$-multisection, $\mathfrak{U}={(U(x))}_{x\in X}$ is 
a good system of open neighborhoods, and $\mathfrak{S}$ is a family $\left( \mathfrak{s}_x\right)_{x\in X}$,
where for every $x\in X$  there is a given a finite set $I_x$ and a symmetric sc$^+$-section structure $\mathfrak{s}_x=(s_i^x)$ parametrized by $I_x$ and defined on $U(x)$
so that 
$$
\Lambda(w)=\frac{1}{|I_x|}\cdot \sharp \left( \{i\in I_x\ |\ s_i^x(P(w))=w\}\right) .
$$
\qed
\end{definition}
In general the precise parametrization of the $(s_i^x)$ does not matter, and moreover only the germ near $x$ matters.
This leads us to define a notion of equivalence  between sc$^+$-multisections with a system of symmetric section structures.
\begin{definition}\index{D- Decorated sc$^+$-multisection}
Let $(\Lambda,\mathfrak{U},\mathfrak{S})$
and $(\Lambda',\mathfrak{U}',\mathfrak{S}')$ be sc$^+$-multisections with a system of symmetric section structures.
We say that both are equivalent provided $\Lambda=\Lambda'$, and there exists a good system of open neighborhoods
$\mathfrak{U}''$ and for every $x\in X$ an equivariant bijection $b_x:I_x\rightarrow I_{x}'$ such that the following holds.
\begin{itemize}
\item[(1)]\ $U''(x)\subset U(x)\cap U'(x)$ for all $x\in X$.
\item[(2)]\ $s'_{b_x(i)}(y) =  s_i(y)$ for $i\in I_x$ and $y\in U''(x)$.
\end{itemize}
An equivalence class will be denoted by $[\Lambda,\mathfrak{U},\mathfrak{S}]$ and will be called a {\bf decorated
sc$^+$-multisection}. By abuse of notation we shall refer to $\Lambda$ as a decorated sc$^+$-multisection equating
$\Lambda\equiv [\Lambda,\mathfrak{U},\mathfrak{S}]$ if the context is clear.
\qed
\end{definition}



\begin{definition}\index{D- Sum of sc$^+$-multisections}
Let $(P: W\rightarrow X,\mu)$ be a strong bundle over the ep-grouoid $X$, and $\Lambda'$, $\Lambda''$ two decorated $\ssc^+$-multisections.
Then the  sum $\Lambda''=\Lambda'\oplus \Lambda''$\index{$\Lambda'\oplus \Lambda''$} defined as follows
 is a naturally  decorated
sc$^+$-multisection $[\Lambda'',\mathfrak{U}'',\mathfrak{S}'']$, where 
\begin{itemize}
\item[(1)]\  $(\Lambda'\oplus\Lambda'')(w) =\sum_{\{(w',w'')\ |\ w',w''\in W|P(w),\ w'+w''=w\}} \Lambda'(w')\cdot\Lambda''(w'').$
\item[(2)]\  $\mathfrak{U}''$ by $U''(x)=U(x)\cap U'(x)$ for $x\in X$.
\item[(3)]\ $I_x'' =I_x\times I_{x}'$ and $s^{''x}_{(i,i')} := s_i^x + s_{i'}^{'x}$ on $U''(x)$.
\end{itemize}
\qed
\end{definition}
The sum operation is associative and commutative. However, in general, there are no inverses. 
\begin{definition}\index{D- Product $a\odot\Lambda$}\label{D- Scalar product}
Given $(P:W\rightarrow X,\mu)$ and a decorated $\ssc^+$-multisection $\Lambda$ we define for a real number $a$ the {\bf scalar product}
$a\odot\Lambda$\index{$a\odot\Lambda$}, which is another  decorated $\ssc^+$-multisection,  as follows. If $a=0$, then 
$(0\odot \Lambda)(w)=0$ if $w\neq 0$ and $(0\odot \Lambda)(0)=1$. Moreover,  for $a\neq 0$, 
$$
(a\odot \Lambda)(w):=\Lambda\left(\frac{1}{a}w\right).
$$
\qed
\end{definition}
We note that $a\odot\Lambda$ is decorated as well. Namely taking $\mathfrak{U}$ and $\mathfrak{S}={(\mathfrak{s}_x)}_{x\in X}$
from $[\Lambda,\mathfrak{U},\mathfrak{S}]$ the new $\mathfrak{S}'$ is given by the families
$$
\mathfrak{s}_x' ={(a\cdot s_i^x)}_{i\in I_x}.
$$
\begin{lemma}\label{lemma_scalar_prod}\index{L- Scalar product $\beta\odot\Lambda$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid and $\Lambda$ a decorated  $\ssc^+$-multisection.
We assume that $\beta\colon X\rightarrow {\mathbb R}$ is a sc-smooth functor, i.e., $\beta (x)=\beta (x')$ if there is a morphism $\phi: x\to x'$.  Then,  $\beta\odot\Lambda$\index{$\beta\odot\Lambda$},  defined by
$$
(\beta\odot\Lambda)(w)=(\beta(P(w))\odot \Lambda)(w),
$$
is a decorated $\ssc^+$-multisection.
\end{lemma}
\begin{proof}
The proof is trivial.
\qed \end{proof}
Next we consider locally finite sums of decorated sc$^+$-multisections. Recall that a subset $O$ of the ep-groupoid
$X$ is called {\bf saturated}\index{Saturated} provided $O=\pi^{-1}(\pi(O))$.
\begin{definition}\label{locally-finite-family}\index{D- Locally finite family}
We assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid. The family  $(\Lambda_j)_{j\in J}$  of decorated $\ssc^+$-multisections is called 
{\bf locally finite}, provided for every $x\in X$ there exists an open saturated neighborhood $O(x)$ having  the property
that there are only finitely many indices $j\in J$ for which there exist $w\in W\vert O(x)$ satisfying  $w\neq 0$ and $\Lambda_j(w)>0$.
\qed
\end{definition}
We can take the saturated $O(x)$ always in such a way that for every other saturated $O'(x)\subset O(x)$ the 
following equality holds.
\begin{eqnarray*}
\{j\in J\ |\ \exists w\in W|O(x),\ w\neq 0,\ \Lambda_j(w)>0\}\\
=\{j\in J\ |\ \exists w\in W|O'(x),\ w\neq 0,\ \Lambda_j(w)>0\}.
\end{eqnarray*}
In the following we always assume that such a $O(x)$ is taken. 
Assume we are given a family $(\Lambda_j)$ as described in the definition. 
Pick $x\in X$ and take the associated saturated $O(x)$. Denote by $J_x$ the finite set of indices
$j$ for which there exists $w\neq 0$, $w\in W|O(x)$ with $\Lambda_j(w)>0$. For every $j\in J_x$ 
we consider $\Lambda_j$ and $\mathfrak{U}_j$ and $\mathfrak{S}_j$.  We pick $U_j(x)$ and ${(s_{j,i}^x)}_{i\in I_x^j}$.
Then define $U(x)$ by
$$
U(x)=O(x) \bigcap \left(\bigcap_{j\in J_x} U_j(x)\right).
$$
The  index set $I_x$ is defined by $I_x = \prod_{j\in J_x} I_x^j$. The elements of $I_x$ are written as
${(i_j)}_{j\in J_x}$ or $(i_j)$ for short.
We define  $\mathfrak{s}_x ={(s_{i_j})}_{(i_j)\in I_x}$ by
$$
s^x_{(i_j)} = \sum_{j\in J_x} s^{jx}_{i_j}\ \ \text{on}\ \ U(x).
$$
With $\mathfrak{S}={(\mathfrak{s}_x)}_{x\in X}$ and  $\mathfrak{U}={(U(x)}_{x\in X}$ 
the following result is trivial.
\begin{lemma}\index{L- Well-definedness $\oplus_{i\in I}\Lambda_i$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid. If $(\Lambda_i)_{i\in I}$ is a locally finite set of 
decorated $\ssc^+$-multisections, then  the 
sum $\Lambda =\oplus_{i\in I} \Lambda_i$ is a well-defined  decorated $\ssc^+$-multisection $[\oplus_{j\in J}\Lambda_j,\mathfrak{U},\mathfrak{S}]$.
\qed
\end{lemma}





\section{Structurable Sc\texorpdfstring{$^+$}{pp}-Multisections}\label{SECT133}

Assume that $P:W\rightarrow X$ is a strong bundle over an ep-groupoid and $\Lambda:W\rightarrow {\mathbb Q}^+$
a decorated sc$^+$-multisection.
For more complicated constructions, for example extension theorems, it is important that the different symmetric
sc$^+$-section structures are coherent, which means they are related in a suitable sense. This will be discussed in the following.


Assume that $[\Lambda,\mathfrak{U},\mathfrak{S}]$ is a decorated sc$^+$-multisection.
Taking a representative $(\Lambda,\mathfrak{U},\mathfrak{S})$ we have the following data.
\begin{itemize}
\item A good system of open neighborhoods ${(U(x)}_{x\in X}$, see Definition \ref{DEFF1}.
\item For $x\in X$ a symmetric section structure $\mathfrak{s}_x={(s_i^x)}_{i\in I_x}$ for $\Lambda$, see Definition \ref{XDEF1}, where the $s^x_i$ are sc$^+$-sections defined for $W|U(x)$.
\end{itemize}
For the moment we shall only consider the index sets ${(I_x)}_{x\in X}$.
In order to formalize what it means that the local choices of symmetric $\ssc^+$-section structures are coherent  we  
consider diagrams of maps,  written as
\begin{equation}\label{just}
d:I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}, 
\end{equation}
where the maps $a$ and $b$ are surjective and the number of preimages in $a^{-1}(\{i\})$ is independent of $i\in I_x$
and the number of preimages  in $b^{-1}(\{j\})$ is independent of $j\in I_{x'}$.  Reading the  diagram from left to right we refer to \eqref{just} as a {\bf diagram from $I_x$ to $I_{x'}$} \index{$d:I_x\rightarrow I_{x'}$} and with the obvious abbreviation we shall write $d: I_x\rightarrow I_{x'}$.

\begin{definition}\index{D- Equivalence of diagrams}\index{D- Correspondence from $I_x$ to $I_{x'}$}
Two diagrams $d: I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}$ and $d': I_x \stackrel{a'}{\twoheadleftarrow} I \stackrel{b'}{\twoheadrightarrow} I_{x'}$ are called {\bf equivalent} if there exists a bijection $c: I\to I'$ such that
the following diagram is commutative
$$
\begin{CD}
I_x @<a<< I @>b>> I_{x'}\\
@|  @V c VV @|\\
I_x @<a'<< I' @>b'>> I_{x'}.
\end{CD}
$$
We shall refer to the equivalence class $[d]$ of the diagram 
$d: I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}$ as a {\bf correspondence from $I_x$ to $I_{x'}$} and often write $[d]: I_x\to I_{x'}$. 
\qed
\end{definition}
The set of  correspondences $[d]: I_x\to I_{x'}$
will be denoted by 
$$
\mathfrak{J}(x,x'):=\{[d]:I_x\rightarrow I_{x'}\}.\index{$\mathfrak{J}(x,x')$}
$$
\begin{definition}\index{D- Pseudo-inverse $\sharp$}
The {\bf pseudo-inverse} is a  bijection $\sharp: \mathfrak{J}(x,x')\rightarrow \mathfrak{J}(x',x)$ defined by 
$$
[I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}]^\sharp := [I_{x'} \stackrel{b}{\twoheadleftarrow} I \stackrel{a}{\twoheadrightarrow} I_{x}].
$$
\qed
\end{definition}

In view of the  $G_x$ and $G_{x'}$-actions  on the index sets  $I_x$ and $I_{x'}$, respectively, we obtain a bi-action on $\mathfrak{J}(x,x')$
\index{D- Bi-action on $\mathfrak{J}(x,x')$}
$$
G'_{x'}\times \mathfrak{J}(x,x')\times G_{x} \rightarrow \mathfrak{J}(x,x'). 
$$
defined by
$$
g'\ast [I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}]\ast g
:= [I_x \stackrel{g^{-1}\circ a}{\twoheadleftarrow} I \stackrel{g'\circ b}{\twoheadrightarrow} I_{x'}]
$$
Here we use the action of $G_x$ on $I_x$ which means that $g\in G_x$ induces a permutation of $I_x$ written as $g :I_x\rightarrow I_x$.
Similarly for $g'\in G_{x'}$ we have $g':I_{x'}\rightarrow I_{x'}$.

\begin{example}\label{example-simple}
Here is a simple  example. Assume that the index set $I_x$ consists of one point, $I_{x}=\{\ast\}$,  and let 
$$
[d]=[\{\ast\}\twoheadleftarrow I \stackrel{b}{\twoheadrightarrow} I_{x'}] :  \{\ast\}\rightarrow I_{x'}.
$$
Then we have 
$$
g'\ast[d]\ast g= [\{\ast\}\twoheadleftarrow I \stackrel{g'\circ b}{\twoheadrightarrow} I_{x'}]
$$
Using that $g'$ acts on $I_{x'}$ as a permutation, and the map $b: I\to I_{x'}$ is a surjection having the property that the preimages $b^{-1}(\{i\})$ 
have the same cardinality for every $i\in I_{x'}$, one can construct a bijection $c: I\to I$ satisfying $b\circ c = g' \circ b$. Consequently, 
the diagram $\{\ast\}\twoheadleftarrow I \stackrel{g'\circ b}{\twoheadrightarrow} I_{x'}$ is equivalent 
to the diagram   $\{\ast\}\twoheadleftarrow I \stackrel{b}{\twoheadrightarrow} I_{x'}$  and 
$$
g'\ast [\{\ast\}\twoheadleftarrow I \stackrel{b}{\twoheadrightarrow} I_{x'}]\ast g=[\{\ast\}\twoheadleftarrow I \stackrel{b}{\twoheadrightarrow} I_{x'}]
$$
for all $g\in G_x$ and $g'\in G_{x'}$.
\qed
\end{example}

\begin{definition}\index{D- Correspondence}
A {\bf correspondence} between the  two local symmetric sc$^+$-section structures $(U(x),{(s_i^x)}_{i\in I_x})$ at $x$ and $(U(x'),{(s_i^{x'})}_{i\in I_{x'}})$ at $x'$ is a map 
$$
\tau_{x,x'}:\bm{ U}(x,x')\rightarrow \mathfrak{J}(x,x')
$$
having the following properties:
\begin{itemize}
\item[(1)]\ $\tau_{x,x'}$ is locally constant and takes only finitely many values. 
\item[(2)]\ $\tau_{x,x'}(g'\ast\phi\ast g) =g'\ast\tau_{x,x'}(\phi)\ast g$ for all $\phi\in \bm{U}(x,x')$, $g\in G_x$, and $g'\in G_{x'}$.
\item[(3)]\ If $\phi\in \bm{U}(x, x')$ and $I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}$ is a representative of 
 $\tau_{x, x'}(\phi)$, then 
$$
s^{x'}_{b(k)}(t(\psi))=\mu(\psi,s^{x}_{a(k)}(s(\psi)).
$$
for all $k\in I$ and all morphisms $\psi$ belonging to the connected component containing $\phi.$
\end{itemize}
\qed
\end{definition}
\begin{remark}\index{R- On corresponences}
A correspondence is an important piece of information how two different local sc$^+$-section structures are related
over open subsets $O\subset U(x)$ and $O'\subset U(x')$ which are given by the images (via $s$ and $t$)  of a connected component 
$\Sigma$. 
\qed
\end{remark}
The formulation in (3) depends on the choice of representative  $I_x \stackrel{a}{\twoheadleftarrow} I \stackrel{b}{\twoheadrightarrow} I_{x'}$
of $\tau_{x,x'}(\phi)$, but the required property does not.  To see this take a second representative for $\tau_{x,x'}(\phi)$
which together with a bijection $d:I'\rightarrow I$ fits into the following commutative diagram
$$
\begin{CD}
I_x @<a'<< I'@>b'>>I_{x'}\\
@|    @V d VV  @|\\
I_x  @<a<< I@>b>> I_{x'}.
\end{CD}
$$
It holds that $a\circ d=a'$ and $b\circ d=b'$.  This implies in view of the displayed property in (3)
that 
$$
s^{x'}_{b'(k)}(t(\psi))=s^{x'}_{b(d(k))}(t(\psi))=\mu(\psi,s^{x}_{a(d(k))}(s(\psi))=\mu(\psi,s^{x}_{a'(k)}(s(\psi)).
$$

Next we introduce  two  crucial concepts. The first is  that of a structurable $\ssc^+$-multisection functor and the second that of a structured
sc$^+$-multisection functor.
\begin{definition}\index{D- Structurable sc$^+$-multisection}\label{DEFN13.3.6}
Let $P:W\rightarrow X$ be a strong bundle over an ep-groupoid. 
A decorated $\ssc^+$-multisection functor $\Lambda:  W\rightarrow {\mathbb Q}^+$ is said to be {\bf structurable} if the following holds,
where $\Lambda=[\Lambda,\mathfrak{U},\mathfrak{S}]$. There exists a representative $(\Lambda,\mathfrak{U},\mathfrak{S})$
and for every $x,x'\in X$  there is a correspondence $\tau_{x,x'}: \bm{U}(x,x')\rightarrow\mathfrak{J}(x,x')$ 
between local section structures $(U(x), {\mathfrak s}_x)$ and $(U(x'), {\mathfrak s}_{x'})$ which, in addition, satisfies
\begin{itemize}
\item[(1)]\ If $x=x'$ it is required that
$\tau_{x,x}(\Gamma(g,y))=[I_x\stackrel{\id}{\twoheadleftarrow}I_x\stackrel{g}{\twoheadrightarrow} I_x]$ for all $g\in G_x$ and $y\in U(x)$.
\item[(2)]\ $\tau_{x',x}(\phi) = {(\tau_{x,x'}(\phi^{-1}))}^\sharp$ for $\phi\in \bm{ U}(x', x)$.
\end{itemize}
\qed
\end{definition}
\begin{remark}\index{R- On being structurable}
If $\Lambda$ is structurable the definition guarantees the existence of an additional finer structure  and we can consider
$(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$, 
where $\tau$ stands for the collection of all $\tau_{x,x'}$, and $(x,x')$ varies over $X\times X$, and $\mathfrak{I}={(I_x)}_{x\in X}$. 
The notion of being structurable is the key notion. When carrying out constructions one usually takes an associated 
structured version and usually it does not matter which one.
\qed
\end{remark}

The tuple $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ is a useful object in its own right.  Given another such tuple
 $(\Lambda',\mathfrak{U}',\mathfrak{S}',\tau')$ we shall introduce a notion 
 of equivalence.
 \begin{definition}\index{D- Equivalence of $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$}\label{DEFNX13.3.8}
 We call $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ and  $(\Lambda',\mathfrak{U}',\mathfrak{S}',\tau')$ {\bf equivalent} provided the following holds.
 \begin{itemize}
 \item[(1)]\ $\Lambda=\Lambda'$.
 \item[(2)]\ There exists a good system of open neighborhoods $\mathfrak{U}''$ such that $U''(x)\subset U(x)\cap U'(x)$ for all $x\in X$.
 \item[(3)]\ For every $x\in X$ it holds $I_x=I_x'$.
 \item[(4)]\ For $x,x'\in X$ it holds on $\bm{U}''(x,x')=\{\phi\in \bm{X}\ |\ s(\phi)\in U''(x),\ t(\phi)\in U''(x')\}$
 that $\tau_{x,x'}=\tau'_{x,x'}$.
  \end{itemize}
An {\bf equivalence class} is denoted by $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$.\index{$[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$}
\qed
\end{definition}
\begin{remark}
It would have been possible to define a different equivalence relation 
accommodating different choices of sets $I_x$. Namely instead of requiring 
that $I_x=I_x'$ we could have stipulated the existence of $G_x$-equivariant bijections
$b_x:I_x\rightarrow I_x'$ and in addition that $\tau_{x,x'}$ and $\tau'_{x,x'}$
are related by 
$$
b_x\circ a = a'\circ c\ \ \text{and}\ \ b_{x'}\circ b=b'\circ c,
$$
where 
 $$
 \tau_{x,x'}(\phi)=[I_x\stackrel{a}{\twoheadleftarrow} I\stackrel{b}{\twoheadrightarrow}I_{x'}]\ \text{and}\ \tau_{x,x'}'(\phi)=[I_x'\stackrel{a'}{\twoheadleftarrow} I'\stackrel{b'}{\twoheadrightarrow}I_{x'}']
 $$
 and  $c:I\rightarrow I'$ is a bijection.  However, in applications it does not seem 
 too much of a difference in general, and we picked the more restrictive formulation.
 \qed
\end{remark}

\begin{definition}\label{DEF13.3.8}\index{D- Structured ac$^+$-multisection}
An equivalence class $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$ is called a  {\bf structured sc$^+$-multisection}.
We shall often abbreviate $\Lambda\equiv [\Lambda,\mathfrak{U},\mathfrak{S},\tau]$ and call it a structured sc$^+$-multisection
and $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ a {\bf representative} of the structured sc$^+$-multisection.
\qed
\end{definition}






With these definitions we can consider for a strong bundle $P:W\rightarrow X$ over the ep-groupoid $X$ various classes of sc$^+$-multisection functors.
\begin{definition}\index{D- Classes $\Gamma_m^+(P),\Gamma^+_s(P),\Gamma^+_{st}(P)$}\index{$\Gamma_m^+(P),\Gamma^+_s(P),\Gamma^+_{st}(P)$}
\begin{itemize}
\item[(1)]\ $\Gamma_m^+(P)$ denotes the set of sc$^+$-multisection functors.
\item[(2)]\  The set of structurable sc$^+$-multisection functors is denoted by $\Gamma^+_{s}(P)$.
\item[(3)]\  The set of structured sc$^+$-multisection functors is denoted by 
$\Gamma^+_{st}(P)$.
\end{itemize}
\qed
\end{definition}
Clearly,  we have a forgetful map 
$$
\mathsf{forget}:\Gamma^+_{st}(P)\rightarrow \Gamma^+_s(P),\quad \wt{\Lambda}\mapsto \Lambda.
$$
It is clear from the definition that every $\Lambda\in\Gamma^+_s(P)$ can lifted to an element in $\Gamma^+_{st}(P)$ (usually not uniquely).
In fact the definition of a structurable sc$^+$-multisection $\Lambda$ precisely says that there exists $\wt{\Lambda}\in \Gamma^+_{st}(P)$
with $\mathsf{forget}(\wt{\Lambda})=\Lambda$.


The next proposition shows that being structurable is preserved under the sum operation previously introduced 
for two $\ssc^+$-multisection functors. Moreover if $\Lambda_1$ and $\Lambda_2$ are structured so is $\Lambda_1\oplus\Lambda_2$.

\begin{proposition}
Let $P:W\rightarrow X$ be  a strong bundle over the ep-groupoid $X$. %
If $\Lambda_1,\Lambda_2: E\rightarrow {\mathbb Q}^+$ are structurable $\ssc^+$-multisections functors, then $\Lambda_1\oplus \Lambda_2$ is also a structurable $\ssc^+$-multisection  functor. If $\Lambda_1$ and $\Lambda_2$ are structured, the sc$^+$-multisection $\Lambda_1\oplus\Lambda_2$ is naturally structured.
\end{proposition}
\begin{proof}
For $i=1,2$, we lift  the structurable $\ssc^+$-multisection $\Lambda_i$ to 
a structured $\ssc^+$-mutisection and take representatives 
 $(\Lambda_i,\mathfrak{U}_i,\mathfrak{S}_i,\tau_i)$ . 
 In view Proposition \ref{prop_obvious} we may assume that $\mathfrak{U}:=\mathfrak{U}_1=\mathfrak{U}_2$.  We define 
  $I_x=I_x^1\times I^2_{x}$  for $x\in X$. Introduce the family ${\mathfrak I}$ of index sets 
by 
$$
\mathfrak{I} =\{I_x\, \vert \, \ x\in X\},
$$
and the family $\tau$ of maps $\tau_{x, x'}: {\bf U}(x, x')\to {\mathfrak J}(x, x')$ by 
$$
\tau_{x,x'}=\tau^1_{x,x'}\times \tau^2_{x,x'}, $$
where 
the right-hand side is defined as
$$
[I_x^1\stackrel{a^1}{\twoheadleftarrow}I^1\stackrel{b^1}{\twoheadrightarrow} I_{x'}^1]\times [I_x^2\stackrel{a^2}{\twoheadleftarrow}I^2\stackrel{b^2}{\twoheadrightarrow }I_{x'}^1]:=[I_x^1\times I^2_x\stackrel{a^1\times a^2}{\twoheadleftarrow}I^1\times I^2\stackrel{b^1\times b^2}{\twoheadrightarrow} I_{x'}^1\times I^2_{x'}].
$$
Next we  define the  family $\mathfrak{S}={(\mathfrak{s}_x)}_{x\in X}$ of $\ssc^+$-section structures  ${\mathfrak s}^x=( s^x_{(i,j)})_{(i, j)\in I_x}$  on $U(x)$ by  
$$
s_{(i,j)}^x= s_i^{1,x}+s_j^{2,x}.
$$
With the action of $G_x$ on the index set $I_x=I^1_x\times I^2_x$ defined by $g(i, j)=(g(i), g(j))$, the $\ssc^+$-sections structures $s^x_{i, j}$ are symmetric over $U(x)$. 
Moreover, if $x,x'\in X$ and the map $\tau_{x,x'}(\phi): I_{x}\to I_{x'}$ is represented by the diagram 
$$
I_x=I^1_{x}\times I^2_{x}\stackrel{a^1\times a^2}{\twoheadleftarrow}I^1\times I^2\stackrel{b^1\times b^2}{\twoheadrightarrow} I_{x'}^1\times I^2_{x'}=I_{x'},
$$
then  
\begin{equation*}
\begin{split}
s^{x'}_{(b^1(i),b^2(j))}(t(\phi))&= s^{1,x'}_{b^1(i)}(t(\phi)) + s^{2,x'}_{b^2(j)}(t(\phi))\\
&=\mu(\phi,s^{1,x}_{a^1(i)}(s(\phi))) +\mu(\phi,s^{2,x}_{a^2(j)}(s(\phi)))\\
&=\mu(\phi, s^x_{(a^1(i),a^2(j))}(s(\phi)))
\end{split}
\end{equation*}
for all $(i, j)\in I^1\times I^2$, 
showing  the compatibility of the local section structures. Clearly, the maps $\tau_{x, x'}$ are locally constant  and satisfy
$$
\tau_{x,x}(\Gamma (g, y))=[I_x\stackrel{\id }{\twoheadleftarrow}I_x\stackrel{g}{\twoheadrightarrow}I_{x}]
$$
 for all $g\in G_x$ and $y\in U(x)$.  This completes the proof of the proposition.
\qed \end{proof}
\begin{remark}
Observe that in the above construction the structured $\Lambda_1\oplus\Lambda_2$ is in general different from 
$\Lambda_2\oplus \Lambda_1$, since for example  the index sets are different, i.e.  $I_x^1\times I_x^2$ versus $I_x^2\times I^1_x$.
Of course, one could introduce an appropriate notion of equivalence to equate both sums, since the underlying functors
are the same. However, since being structured is an auxiliary concept we shall not study this further. For us the basic notion is being structurable and as such $\Lambda_1\oplus \Lambda_2=\Lambda_2\oplus \Lambda_1$.\qed
\end{remark}





We recall that  given $r\in \R$  and a $\ssc^+$-multisection functor $\Lambda: E\to \Q^+$, the 
$\ssc^+$-multisection functor $r\odot\Lambda$ is defined as follows.  If $r=0$,  it is determined by the requirement
 $(0\odot\Lambda)(0_x)=1$ for $x\in X$, and if $r\neq0$, then $(r\odot \Lambda)(e):=\Lambda(\frac{e}{r})$.
 The following result is obvious.
 \begin{lemma}
Let $P:W\rightarrow X$ be a strong bundle over an ep-groupoid. %
If  $\Lambda:W\rightarrow {\mathbb Q}^+$ is a structurable $\ssc^+$-multisection, then $r\odot\Lambda$ is a structurable $\ssc^+$-multisection for every $r\in {\mathbb R}$. If $\beta:X\rightarrow {\mathbb R}$ is an sc-smooth functor and  $\Lambda$ is a structurable    sc$^+$-multisection
 so is $\beta\odot\Lambda$.
\qed
\end{lemma}
Let $P:W\rightarrow X$ be a strong bundle over the ep-groupoid $X$. 
We call a $\ssc^+$-multisection functor $\Lambda: W\rightarrow {\mathbb Q}^+$ {\bf trivial near a point $x\in X$}\index{Trivial near a point} if  there exists an open neighborhood $O(x)$ of $x$ such that 
$$
\Lambda(0_y)=1\quad \text{for all $y\in O(x)$}.
$$
  This means that $\Lambda$ represents the zero-section 
over $O(x)$.  

Assume that $[\Lambda,\mathfrak{U},\mathfrak{S}]$ is structurable and pick a structured version represented by
$(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$.  Fix for every $x\in X$, where $\Lambda$ is trivial near $x$, a new $G_x$-invariant open neighborhood $U'(x)$ contained in $U(x)$ so that $\Lambda(0_y)=1$ for $y\in U'(x)$. Otherwise keep $U(x)$. This defines a new
$\mathfrak{U}'$. 
 Denote by $T_\Lambda$ the collection of all $x$ so that
$\Lambda$ is trivial near $x$.  By  assumption on $\mathfrak{U}'$ it holds that  $\Lambda(0_y)=1$ for $y\in U'(x)$ for $x\in T_\Lambda$.

For $x\in T_\Lambda$ we redefine $I_x'=\{*\}$, i.e. a one-point set and take as section structure $\mathfrak{s}'_x$, which consists
of the single zero-section over $U(x)$ with weight $1$.
If $x\in X\setminus T_\Lambda$ we define $I_x':=I_x$.
Consider for $x,x'\in X$ 
$$
\tau_{x,x'}:\bm{U}(x,x')\rightarrow \mathfrak{F}(x,x').
$$
Assume that $\tau_{x,x'}$ on a connected component is represented by
$$
I_x\stackrel{a}{\twoheadleftarrow} I\stackrel{b}{\twoheadrightarrow} I_{x'}.
$$
If $x\in T_\Lambda$  we replace $a$ by the unique map $a'$ onto $I_x'$, and if $x'\in T_\Lambda$  we replace  $b$ by the unique map
$b'$ onto $I_{x'}'$.  Through these modifications we obtain $\tau'$.
We replace the representative $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ by 
$(\Lambda,\mathfrak{U},'\mathfrak{S}',\tau')$.  We note that $\tau'$ is a correspondence between the local section structures.
Hence we obtain a new structured $[\Lambda,\mathfrak{U}',\mathfrak{S}',\tau']$,  which has the following  properties
\begin{description}
\item[(1)]  $U'(x)\subset U(x)$ for all $x\in T_\Lambda$ and $U'(x)=U(x)$ for $x\in X\setminus T_\Lambda$.
\item[(2)]  For every point  $x\in T_\Lambda$   we have that $\Lambda(0_y)=1$ for $y\in U'(x)$ and $I_x=\{*\}$.
\end{description}
For the following considerations we need to modify this even further, in fact somewhat drastically.
Pick for $x\in T_\Lambda$ any $U''(x)$ with the natural $G_{x}$-action such that $U''(x)\subset T_\Lambda$.
 For $x\in X\setminus T_\Lambda$ we define $U''(x):=U(x)$.  If $x,x'\in X\setminus T$ define $\tau_{x,x'}':=\tau_{x,x'}$ on $\bm{U}''(x,x')=\bm{U}(x,x')$. If $x\in T_\Lambda$ and $x'\in X\setminus T_\Lambda$ define $\tau_{x,x'}'$ on $\bm{U}''(x,x')$ by
 $$
 \tau_{x,x'}''(\phi) = [I_x=\{*\} \twoheadleftarrow I_{x'} \stackrel{Id}\twoheadrightarrow I_{x'}].
 $$
If $x\in X\setminus T_\Lambda$ and $x'\in T_\Lambda$ we define 
$$
 \tau_{x,x'}''(\phi) = [I_x\stackrel{Id}\twoheadleftarrow I_{x}\twoheadrightarrow I_{x'}=\{*\}].
 $$
In the case of $x,x'\in T_\Lambda$ we define 
$$
 \tau_{x,x'}''(\phi)=[\{\ast\}  \stackrel{Id}\twoheadleftarrow \{*\} \stackrel{Id}\twoheadrightarrow \{*\}].
 $$
With this data we obtain $(\Lambda,\mathfrak{U}'',\mathfrak{S}'',\tau'')$.   The previous construction proves the following result.
\begin{proposition}\label{prop2.34}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the ep-groupoid $X$. Let $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$
be a  structured sc$^+$-multisection and $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ a representative.
  Then there exists a structured  sc$^+$-multisection $[\Lambda,\mathfrak{U}'',\mathfrak{S}'',\tau'']$ where the representative 
   $(\Lambda,\mathfrak{U}'',\mathfrak{S}'',\tau'')$ has the following properties.
   \begin{itemize}
   \item[{\em(1)}]\ For $x\in T_\Lambda$ we have  $I_x''=\{*\}$ and we can take any open neighborhood $U''(x)$ with the property
   that it admits the $G_x$-action and $U''(x)\subset T_\Lambda$. The section structure consists of the single zero-section.
   \item[{\em(2)}]\ For $x\in X\setminus T_\Lambda$ it holds  $U''(x)=U(x)$ and $I_x''=I_x$.
   \item[{\em(3)}]\ For $x,x'\in X\setminus T_\Lambda$ it holds $\tau_{x,x'}''=\tau_{x,x'}$.
   \item[{\em(4)}]\ For $x\in T_\Lambda$ and $x'\in X\setminus T_\Lambda$ we have $\tau_{x,x'}''(\phi)=[\ast\twoheadleftarrow I_{x'}''\stackrel{Id}\twoheadrightarrow I_{x'}'']$ and for $x\in X\setminus T_\Lambda$ and $x'\in T_\Lambda$ we take $\tau_{x,x'}''(\phi)=[I_x\stackrel{Id}\twoheadleftarrow I_x\twoheadrightarrow \{*\}]$.
   \item[{\em(5)}]\ For $x,x'\in T_\Lambda$ we have $\tau_{x,x'}''(\phi)=[\{\ast\}\twoheadleftarrow\{*\}\twoheadrightarrow \{*\}]$.
   \end{itemize}
   \qed
   \end{proposition}
\begin{remark}
The fact that $U''(x)$ for $x\in T_\Lambda$ can be taken arbitrarily subject to the requirements $U''(x)\subset T_\Lambda$
and $U''(x)$ admits the natural $G_x$-action will be important.
\qed
\end{remark}
In view of Proposition \ref{prop2.34} we can make the following definition.
\begin{definition}\index{D- Tightly structured}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid  with paracompact $|X|$.  
A structured $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$ is called {\bf tightly structured} provided there exists a representative
$(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$ having the following properties.
\begin{itemize}
\item[(1)]\ For $x\in T_\Lambda$ we have  $I_x=\{*\}$ and $\mathfrak{s}_x$ consists of the  single zero-section.
 \item[(2)]\ For $x\in T_\Lambda$ and $x'\in X\setminus T_\Lambda$ we have $\tau_{x,x'}(\phi)=[\ast\twoheadleftarrow I_{x'}\stackrel{Id}\twoheadrightarrow I_{x'}]$ and for $x\in X\setminus T_\Lambda$ and $x'\in T_\Lambda$ we have $\tau_{x,x'}(\phi)=[I_x\stackrel{Id}\twoheadleftarrow I_x\twoheadrightarrow \{*\}]$.
   \item[(3)]\ For $x,x'\in T_\Lambda$ we have $\tau_{x,x'}''(\phi)=[\{\ast\}\twoheadleftarrow\{*\}\twoheadrightarrow \{*\}]$.
   \end{itemize}
\qed
\end{definition}
With this definition and employing Propsoition \ref{prop2.34} we obtain the following corollary.
\begin{corollary}
Let $(P:W\rightarrow X,\mu)$ a strong bundle over the ep-groupoid $X$.
For every structurable $\Lambda$ there exists a tightly structured version.
\qed
\end{corollary}

A basic result is the following.  %
\begin{proposition}\label{sum_of_structurable_is_structurable}
Let $P: W\rightarrow X$ be a strong bundle over an ep-groupoid $X$ and let 
 ${(\Lambda_l)}_{l\in L}$ be  a family of structurable $\ssc^+$-multisection functors having locally finite domain supports. 
Then  the sum $\bigoplus_{l\in L}\Lambda_l$ is a structurable $\ssc^+$-multisection functor.
\end{proposition}
\begin{proof}
We consider representatives $(\Lambda_l,\mathfrak{U}^l, \mathfrak{S}^l,\tau^l)$, $l\in L$,
 of   structured versions. For every $l\in L$ set $T_l:=T_{\Lambda_l}$. 
We define a map $X\rightarrow 2^L:x\rightarrow  J_x$ by associating to $x$ the finite set of all $l\in L$ such that
for every open neighborhood $O(x)$ it holds $O(x)\cap (X\setminus T_l)\neq \emptyset$.
In particular we find for every $x\in X$ an open neighborhood $V(x)$ satisfying
\begin{description}
\item[(1)] $V(x)$ admits the natural $G_x$-action.
\item[(2)] $V(x) \subset  T_l $  for all $l\in L\setminus J_x$.
\end{description}
 For $x\in X$ define $U(x)$ by
 $$
 U(x):= V(x)\bigcap\left (\bigcap_{l\in J_x} U^l(x)\right).
 $$
The following holds for $\mathfrak{U}={(U(x))}_{x\in X}$:
\begin{description}
\item[(3)] For $x\in X$ and $l\not\in J_x$ we have  that $U(x)\subset T_l$. 
\item[(4)] If $l\in J_x$ then $U(x)\subset U^l(x)$.
\end{description}
With the above properties guaranteed we can pass, following Proposition \ref{prop2.34}, for every $l\in L$ to a tightly structured version
using the same $\mathfrak{U}$ as a good system of open neighborhoods.  Without loss of generality we may assume therefore
that the $(\Lambda_l,\mathfrak{U}^l, \mathfrak{S}^l,\tau^l)$ already have these properties.  In particular
$\mathfrak{U}=\mathfrak{U}^l$ for $l\in L$.   Define
$$
\Lambda=\bigoplus_{l\in L}\Lambda_l.
$$
We use $\mathfrak{U}$  as a  good system. Define $K^l_x = I^l_x$ if $l\in J_x$ and otherwise $K^l_x=\{*\}$.
The product $K_x$ defined as 
$$
K_x:=\prod_{l\in L} K^l_x
$$
is a finite set. We can view an element $\mathsf{k}\in K_x$ as a map which assigns to $l\in L$ an element $\mathsf{k}(l)\in K^i_x$.
For $\mathsf{k}\in K_x$ we define  $\mathfrak{s}_x ={(s^x_{\mathsf{k}})}_{\mathsf{k}\in K_x}$  on $U(x)$ by
$$
s^x_{\mathsf{k}} = \sum_{l\in L} s^{l,x}_{\mathsf{k}(l)}.
$$
Note that this is a finite sum since up to finitely many $l$ the other terms are the zero-sections.
This gives $\mathfrak{S}={(\mathfrak{s}_x)}_{x\in X}$.  
Next we define $\tau_{x,x'}(\phi)$ on $\bm{U}(x,x')$. The obvious idea is to take the product 
 product of the ${ (\tau^l_{x,x'}(\phi))}_{l\in L}$, but one has to make sure that this is well-defined.
Every $\tau^l_{x,x'}(\phi)$ for $l\in L$ has a representative of the form
$$
I^l_x \twoheadleftarrow \bar{I}^l_x\twoheadrightarrow I^l_{x'}.
$$
Moreover, this diagram takes the following forms given $x$ and $x'$.
\begin{itemize}
\item[(1)]\ With the exception of finitely many $\ell\in L$ : $\{\ast\}\twoheadleftarrow \{\ast\}\twoheadrightarrow \{\ast\}$ for $x,x'\in T_l$ 
\item[(2)]\ For finitely many values of $l\in L$ : $ \{\ast\}\twoheadleftarrow I^l_{x'} \twoheadrightarrow I^l_{x'}$ for $x\in T_l$.
\item[(3)]\ For finitely many values $l\in L$ : $ I^l_x\twoheadleftarrow I^l_{x} \twoheadrightarrow \{\ast\}$ for $x'\in T_l$.
\item[(4)]\  For finitely many values $l\in L$ : $I^l_x \twoheadleftarrow \bar{I}^l_x\twoheadrightarrow I^l_{x'}$ 
\end{itemize}
From this it follows that the product of the $\tau_{x,x'}^l$ is defined and a correspondence.
 \qed \end{proof}


\section{Equivalences, Coverings and Structurability}\label{SECT134}
Next we shall study the properties of structured sc$^+$-multisections with respect to equivalences of strong bundles
and generalized strong bundle isomorphisms, but also with respect to proper covering functors.



\begin{theorem}\label{pullbackX}\index{T- Pull-back of structurable $\Lambda$}
Let $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ be strong bundles over ep-groupoids.
Suppose $\Phi:W\rightarrow W'$ is a strong bundle equivalence covering the equivalence $F:X\rightarrow X'$ and $\Lambda':W'\rightarrow {\mathbb Q}^+$ is a
structurable sc$^+$-multisection functor.
Then the sc$^+$-multisection functors $\Phi^\ast\Lambda':=\Lambda'\circ\Phi$ is  structurable. 
If $\Lambda'$ is structured there is a canonical way to structure $\Phi^\ast\Lambda'$.
\end{theorem}
\begin{proof}
We start by showing that $\Phi^\ast\Lambda' = \Lambda'\circ \Phi$ is structurable.
Fix a structured $[\Lambda',\mathfrak{U}',\mathfrak{S}',\tau']$ with representative $(\Lambda',\mathfrak{U}',\mathfrak{S}',\tau')$.
Recall that we can take the sets in $\mathfrak{U}'$ as small as we wish, so that the other associated new data are just the restrictions of the old data.

For every $x\in X$ we find $U(x)$ with the natural $G_x$-action, so that
\begin{description}
\item[(1)]  $t:s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper, and 
\item[(2)] $F:U(x)\rightarrow F(U(x))$ is an sc-diffeomorphism. 
\item[(3)] $F(U(x))\subset  U'(F(x))$, and without loss of generality $F(U(x))=U'(F(x))$.
\end{description}

We define $I_{x}:=I'_{F(x)}$ and $\mathfrak{U}={(U(x))}_{x\in X}$. Given $x,y\in X$ the equivalence 
$F$ defines an sc-diffeomorphism ${\bf U}(x,y)\rightarrow {\bf U}'(F(x),F(y))$ and we infer that $s:{\bf U}(x,y)\rightarrow U(x)$
and $t:{\bf U}(x,y)\rightarrow U(y)$, when restricted to a connected component,  are sc-diffeomorphisms onto open subsets. 
With other words $\mathfrak{U}$ is a good system of open neighborhoods.

We define $\tau$ by
$$
\tau_{x,y}(\phi):=\tau'_{F(x),F(y)}(F(\phi)).
$$
Finally the symmetric sc$^+$-section structures $\mathfrak{s}_x={(s^x_i)}_{i\in I_x}$ are defined via
$$
\Phi(s^x_i(z)) = {s'}^{F(x)}_i(F(z))\ \text{for}\ z\in U(x),\ i\in I_x,
$$
and determine $\mathfrak{S}$. 
Hence $\Phi^\ast\Lambda'$ is structurable and $[\Phi^\ast\Lambda',\mathfrak{U},\mathfrak{S},\tau]$ is the canonically 
structured version when starting with $[\Lambda',\mathfrak{U}',\mathfrak{S}',\tau']$.
\qed \end{proof}
There is a similar result for the push-forward $F_\ast\Lambda$. However, there is not a canonical structuring 
for the latter. Here we shall also need an extension result which we formulate now.
\begin{proposition}\index{P- Extension of $\Lambda$}\label{PROPEXT}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid and assume that $V$ is an open subset of $X$ satisfying
$|X|=|V|$. We view $V$ as an ep-groupoid and assume $\Lambda:W|V\rightarrow {\mathbb Q}^+$ is a given structured sc$^+$-multisection functor.
Then the following holds.
\begin{itemize}
\item[(1)]\ $\Lambda$ has a canonical extension to $W$ denoted by $\bar{\Lambda}$.
\item[(2)]\  Given open neighborhoods $O(x)$ for $x\in X\setminus V$ the sc$^+$-multisection $\bar{\Lambda}$ has a structured version
so that the induced data to $V$ is the original structured $\Lambda$ and the sets $U(x)$ for $x\in X\setminus V$ are contained in $O(x)$.
\end{itemize}
\end{proposition}
\begin{proof}
(1) For $w\in W$ we can pick find $w'\in W|V$ and $\phi:P(w')\rightarrow P(w)$ such that $\mu(\phi,w')=w$.  We define
$$
\bar{\Lambda}(w):=\Lambda(w').
$$
One easily verifies that this definition does not depend on the choices involved. The extension $\bar{\Lambda}$ is an sc$^+$-multisection functor.
Namely we can take open neighborhoods $U(\phi)$, $U(P(w))$ and $U(P(w'))$ so that
$$
t:U(\phi)\rightarrow U(P(w))\ \ \text{and}\ \ s:U(\phi)\rightarrow U(P(w'))
$$
are sc-diffeomorphisms. We may assume that $U(P(w'))$ is small enough so that it supports a local sc$^+$-section structure.
With the data at hand we can push it forward to $U(P(w))$, where it represents $\bar{\Lambda}$. \par

\noindent (2) For every $q\in V$ we have an open $U(q)\subset V$ invariant under the $G_q$-action, having the properness property
and supporting a symmetric sc$^+$-section structure $\mathfrak{s}_q$. In addition, the collection $\mathfrak{U}={(U(q))}_{q\in V}$,
is a good system for $V$.  In addition we have correspondences $\tau_{q,q'}$ relating the local sc$^+$-section structures.

We employ the extension theorem for $\mathfrak{U}$ and obtain ${(U(x))}_{x\in X}$ which extends $\mathfrak{U}$
and where $U(x)\subset O(x)$ for $x\in X\setminus V$. We also need to extend the correspondences and define specific 
local sc$^+$-section structures. For this we first have a closer look at the proof of Theorem \ref{THMX1317} to see how
data was being moved around. Without loss of generality we assume that $U(x)=O(x)$, where $U(x)$ will be fixed arbitrarily small.

For every $x\in X\setminus V$ we fix $\psi_x\in \bm{X}$ with $q_x:= s(\psi_x)$ and $t(\psi_x)=x$. Moreover, we find open neighborhoods
$O(\psi_x)$, $O(q_x)$, and $U(x)$ having the following properties.
\begin{itemize}
\item $s:O(\psi_x)\rightarrow O(q_x)$ and $t:O(\psi_y)\rightarrow U(x)$ are sc-diffeomorphisms.
\item $O(q_x)\subset U(q_x)$ and $O(q_x)$ is invariant under the $G_{q_x}$-action on $U(q_x)$.
\item  $U(x)$ admits the natural $G_x$-action and has the properness property.
\item  For every connected component $\Sigma$ of $\bm{U}(q_x,x)$ the maps $s:\Sigma\rightarrow U(q_x)$ and $t:\Sigma\rightarrow U(x)$ are sc-diffeomorphisms onto their image.
\end{itemize}
We have seen in Theorem \ref{THMX1317} that ${(U(x))}_{x\in X}$ is a good system. We need to define local section structures on the new sets 
and correspondences for the following types of sets 
\begin{itemize}
\item[(i)]\ \ \ $\bm{U}(q,x)$ for $q\in V$ and $x\in X$.
\item[(ii)]\ \ \ $\bm{U}(x,q)$ for $x\in X$ and $q\in V$.
\item[(iii)]\ \ \ $\bm{U}(x,y)$ for $x, y\in X$.
\end{itemize}
We start with the local sc$^+$-section structures.  Pick $x\in X\setminus V$ and define the  equivariant sc-diffeomorphism
$$
D_x\colon O(q_x) \rightarrow U(x)\colon D(q) =t\circ (s|U(\psi_x))^{-1}(q),
$$
where $\gamma_x:G_{q_x}\rightarrow G_x$ is defined by $\gamma_x(\phi)  \psi_x\circ \phi\circ \psi_x^{-1}$.
With $O(q_x)\subset U(q_x)$ we push forward the restriction of $\mathfrak{s}_{q_x}$ to $O(q_x)$. More precisely with
$\mathfrak{s}_{q_x}={(s_i^{q_x})}_{i\in I_{q_x}}$ we define $I_x:= I_{q_x}$ and $s_i^x$ by
$$
s_i^x(D_x(q)) =\mu((s|O(\psi_x))^{-1}(q),s^{q_x}_i(q))\ \ \text{for}\ \ q\in O(q_x).
$$
We let $G_x$ act on $I_x=I_{q_x}$ by $g(i):= (\gamma_x^{-1}(g))(i)$.  This prescription defines for every $x\in X\setminus V$
a symmetric local sc$^+$-section structure on $U(x)$ representing $\bar{\Lambda}$.

In a next step we have to define the correspondences. In case (i) we take the sc-smooth embedding
$$
A: \bm{U}(q,x)\rightarrow \bm{U}(q,q_x)\colon A(\phi) = [(t|O(\psi_x))^{-1}(t(\phi))]^{-1}\circ \phi,
$$
whose image is $\{\psi\in\bm{X}\ |\ s(\psi)\in U(q),\ t(\psi)\in O(q_x)\}$. We define 
$\tau_{q,x}:\bm{U}(q,x)\rightarrow \mathfrak{I}(q,x)$ by
$$
\tau_{q,x}(\phi):= \tau_{q,q_x}\circ A(\phi).
$$
This map is obviously locally constant since this did hold for $\tau_{q,q_x}$.  Moreover, it defines a correspondence between
the local sc$^+$-section structures as we shall show now. Take $\phi\in \bm{U}(q,x)$ and define 
$$
\psi:= A(\phi) = [(t|O(\psi_x))^{-1}(t(\phi))]^{-1}\circ \phi \in \{\sigma\in\bm{X}\ |\ s(\sigma)\in U(q),\ t(\sigma)\in O(q_x)\}.
$$
Assume $\tau_{q,q_x}(\psi)$ is represented by $I_x\twoheadleftarrow I\twoheadrightarrow I_{q_x}$ with maps $a$ and $b$ so that 
$$
s_{b(i)}^{q_x}(t(\psi))=\mu(\psi, s_{a(i)}^q(s(\psi))).
$$
By construction $\tau_{q,x}(\phi)$ is represented by the same diagram where $I_x=I_{q_x}$ by definition. We compute
\begin{eqnarray*}
s_{b(i)}^x(t(\phi))&=& \mu((s|O(\psi_x))^{-1}(D_x^{-1}(t(\phi))), s_{b(i)}^{q_x}(D_x^{-1}(t(\phi))))\\
&=& \mu((s|O(\psi_x))^{-1}(t(\psi)), s_{b(i)}^{q_x}(t(\psi)))\\
&=&\mu((s|O(\psi_x))^{-1}(t(\psi)), \mu(\psi, s_{a(i)}^q(s(\psi))))\\
&=&\mu((s|O(\psi_x))^{-1}(t(\psi)), \mu(\psi, s_{a(i)}^q(s(\phi))))\\
&=&\mu(\phi, s_{a(i)}^q(s(\phi))).
\end{eqnarray*}
This shows the compatibility.  The case (ii) is similar, where we use the pseudo-inverse of $\tau_{q,x}$. 
In case (iii) we define $\tau_{x,y}$ as follows.  Recall that we have the  sc-diffeomorphism
$$
C:\bm{U}(x,y)\rightarrow \{\phi\in\bm{X}\ |\ s(\phi)\in O(q_x),\ t(\phi)\in O(q_y)\}
$$
defined by
$$
C(\phi) =\left ((t|O(\psi_y))^{-1}(t(\phi))\right)^{-1}\circ \phi\circ \left((t|O(\psi_x))^{-1}(s(\phi))\right).
$$
In this case we define $\tau_{x,y}$ by 
$$
\tau_{x,y}=\tau_{q_x,q_y}\circ C.
$$
Through a straight forward computation as in case (i) one verifies the assertion.
\qed \end{proof}
\begin{theorem}\label{pushforwardX}\index{T- Push-forward of structurable $\Lambda$}
Let $P:W\rightarrow X$ and $P':W'\rightarrow X'$ be strong bundles over ep-groupoids. Assume that $\Phi:W\rightarrow W'$ is a strong bundle equivalence covering the equivalence $F:X\rightarrow X'$ and $\Lambda:W\rightarrow {\mathbb Q}^+$ 
a structurable $\ssc^+$-multisection functor. Then the push-forward $\Phi_\ast\Lambda$  is a  structurable $\ssc^+$-multisection functor. 
\end{theorem}
\begin{proof}
Define  $\Lambda':W'\rightarrow {\mathbb Q}^+$
as follows.  If $w'\in W'$, using the fact that $\Phi$ is a strong bundle equivalence covering the equivalence of ep-groupoids $F$,
we find $w\in W$, $\psi\in \bm{X}'$ such that
$$
w' =\mu'(\psi,\Phi(w))\ \text{and}\ \ \psi:F(P(w))\rightarrow P'(w').
$$
Define $\Lambda'(w'):=\Lambda(w)$ and  note that the definition does not depend on the choices involved.
Hence we have defined, as a functor
$$
\Lambda' \colon W'\rightarrow {\mathbb Q}^+.
$$
We pick a structured version   $[\Lambda, \mathfrak{U},\mathfrak{S},\tau]$  represented by $(\Lambda, \mathfrak{U},\mathfrak{S},\tau)$ of the structurable 
$\ssc^+$-multisection functor $\Lambda: W\to \Q^+$.  Since $F$ is an equivalence, and hence a local sc-diffeomorphism, we may assume, in view of Theorem  \ref{xxxx-structure}, that for every open neighborhood $U(x)\in {\mathfrak U}$ the map $F: U(x)\to F(U(x))$ is a sc-diffeomorphism
and $F(U(x))$ is contained in a set having the properness property.

For every $y\in F(X)$, we choose a point $x_y\in X$ such that $F(x_y)=y$ and  set 
$$
U'(y):= F(U(x_y))\quad \text{and}\quad  I'_y:= I_{x_y}.
$$
We define a $\ssc^+$-section structure $\mathfrak{s}_y'=(s'^{y}_i)_{i\in I'_y}$ on $U'(y)$ as the  
push-forward of $(s^{x_y}_i)_{i\in I_{x_y}}$  by $\Phi$ and obtain
$$
s'^{y}_{i}:= \Phi\circ s^{x_y}_i\circ (F\vert U(x_y))^{-1}\quad \text{for all $i\in I'_{y}$}.
$$
Using the fact that $F$ is faithful and full, the  map $F: \morp (x_{y}, x_{y'})\to \morp (y, y')$ is a bijection. Next we define the action of $G_y'$ on the index set $I_{y}'$ and the maps 
$$
\tau_{y, y'}':  \bm{U}'(y, y')\to {\mathfrak I}'(y, y').
$$
We put $I_{y}':=I_{x_y}$ and define  the action of the isotropy group $G_y'$ on the index set $I_{y}'$ by 
$$
g'(i)=((F|\text{mor}(x_y,x_y))^{-1}(g'))(i), \quad  \text{$g\in G_y'$,\, $i\in I'_{y}$}.
$$
The equivalence $F$ induces an sc-diffeomorphism
$$
\bm{U}(x_y,x_{y'})\rightarrow \bm{U}'(y,y'):\phi \rightarrow F(\phi).
$$
In order to see this, recall that the map is clearly a local sc-diffeomorphism.  
The map is surjective. Indeed, let $\phi'\in \bm{U}'(y,y')$ pick the uniquely determined
points $x\in U(x_y)$ and $x'\in U(x_{y'})$ such that $F(x)=s(\phi')$ and $F(x')=t(\phi')$.
Since $F$ is an equivalence there exists $\phi$ with $s(\phi)=x$ and $t(\phi)=x'$ such that
$F(\phi)=\phi'$. The map is also injective. If $F(\phi_1)=F(\phi_2)$ we see that 
\begin{eqnarray*}
&F(s(\phi_1))= s(F(\phi_1))=s(F(\phi_2))= F(s(F(\phi_2)))\ \ \text{and}&\\
&F(t(\phi_1))= t(F(\phi_1))=t(F(\phi_2))= F(t(F(\phi_2))),&
\end{eqnarray*}
from which we conclude that $\phi_1$ and $\phi_2$ have the same source and target. Since $F$ is faithful
this implies $\phi_1=\phi_2$.

Now we define the maps  $\tau'_{y,y'}: \bm{U}'(y, y')\to {\mathfrak I}'(y, y')$   by   
$$
\tau_{y,y'}'(\phi) = \tau_{x_y,x_{y'}}((F|\bm{U}(x_y,x_{y'}))^{-1}(\phi)), \quad \text{$\phi \in \bm{U}'(y, y')$ }.
$$
One can easily check that with these definitions  the $\ssc^+$-section structure $(s^y_i)_{i\in I'_y}$ is symmetric and  the maps $\tau_{y, y'}'$ are correspondences for all $y, y'\in F(X)$.   

We note that $(\Lambda'|(W'|F(X)),\mathfrak{U}',\mathfrak{S}',\tau')$ 
is a representative for a structured sc$^+$-multisection for the strong bundle $W'|F(X)\rightarrow F(X)$. Note that $F(X)$ is an ep-goupoid
for the induced structure as an open subset of $X'$, and moreover
$|F(X)|=|X'|$. Now we apply Propsition \ref{PROPEXT} and obtain that the extension $\Lambda'$ is structurable.

\qed \end{proof}


The structurable $\ssc^+$-multisections behave nicely with respect to pull-backs by proper covering functors.
\begin{theorem}\label{OTHM1344}\index{T- Pullback by proper covering functors}
Let $(P: E\rightarrow Y,\nu)$, $(Q:W\rightarrow X,\mu)$  be  strong bundles over  ep-groupoids  and $\Phi:E\rightarrow W$ a proper strong bundle covering map covering the proper covering functor $F:Y\rightarrow X$. If 
$\Lambda:W\rightarrow {\mathbb Q}^+$ is a structurable $\ssc^+$-multisection functor, then the pull-back
$\Phi^\ast\Lambda$ is a structurable $\ssc^+$-multisection functor.
\end{theorem}
\begin{proof}
Fix a structured version 
$[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$  of $\Lambda$.
In view of the definition of a proper covering functor, without loss of generality we may assume that the open neighborhoods $U(x)\in {\mathfrak U}$ are sufficiently small 
so that the following holds:
\begin{itemize}
\item[$\bullet$]\  There are finitely many mutually disjoint open neighborhoods $V(y)\subset Y$ around every point 
$y\in F^{-1}(x)$ such that the restrictions $F: V(y)\to U(x)$  are sc-diffeomorphisms and 
 $$
 F^{-1}(U(x))=\bigcup_{z\in F^{-1}(x)}V(z),
 $$
 \item[$\bullet$]\ the open neighborhoods $\mathfrak{V}={(V(y))}_{y\in Y}$ form a good system of open neighborhoods on $Y$. 
 \end{itemize} 
In addition, since $F$ is a proper covering functor, the map $\bm{Y} \to \bm{X}{_{s}\times_F}Y$, defined by 
\begin{equation}\label{prop_cover_sc_diff}
\phi\mapsto (F(\phi),s(\phi)), 
\end{equation}
is a sc-diffeomorphism.

On every open neighborhood $U(x)$,  we are given the symmetric $\ssc^+$-section structure $\mathfrak{s}_x = {(s^x_i)}_{i\in I_x}$ and for every two points $x,x'\in X$ we have correspondences 
$$
\tau_{x,x'}:\bm{U}(x,x')\rightarrow \mathfrak{I}(x,x')
$$
 relating the local section structures ${\mathfrak s}_x$ and ${\mathfrak s}_{x'}$.

For every $y\in F^{-1}(x)$, we take as index set $I_y$ the index set $I_x$ and define the $\ssc^+$-section structure ${\mathfrak s}_y$ on $V(y)$ as the pull-back of
of ${\mathfrak s}_x$, 
\begin{equation}\label{compatibility_prop_cover_pull_back}
\Phi (s^y_i(z))= s^x_i(F(y)),\quad z\in V(y), i\in I_y.
\end{equation}
The action of  the isotropy group $G_y$ on the index set $I_y$ is defined by $g(i)=F(g)(i)$ for $g\in G_y$ and $i\in I_y$. 
Since the map defined in \eqref{prop_cover_sc_diff} is a sc-diffeomorphim, we deduce (for the natural actions) that 
$F(\Gamma^Y (g, z))=\Gamma^X(F(g), F(z))$ for all $g\in G_y$ and $z\in V(y)$.  Using this fact  we conclude that  
the sections defined by \eqref{compatibility_prop_cover_pull_back} are symmetric. Indeed,  we compute for $g\in G_y$, $i\in I_y$, and $z\in V(y)$, 
\begin{equation*}
\begin{split}
\Phi(s^y_{g(i)}(g\ast z))&=s^x_{g(i)}(F(g\ast z)=s^{x}_{F(g)(i)}(F(g)\ast F(z))\\
&=\mu(\Gamma^X(F(g), F(z)), s_i^x(F(z)))\\
&=\mu(F(\Gamma^Y(g, z)), \Phi (s_i^y(z)))\\
&=\Phi (\mu (\Gamma^Y (g, z), s_i^y(z))).
\end{split}
\end{equation*}
Since $\Phi$ is a fiber-wise isomorphism, we conclude that 
$$
s^y_{g(i)}(g\ast z)=\mu (\Gamma^Y (g, z), s_i^y(z))
$$
 which proves our claim.

Having defined the good system of  open neighborhoods $\mathfrak{V}={(V(y))}_{y\in Y}$, the family $\mathfrak{I}=(I_y)_{y\in Y}$ of index sets as well as the family  $\mathfrak{S}={(\mathfrak{s}_y)}_{y\in Y}$ of symmetric $\ssc^+$-section structures we define the family ${\mathfrak \tau}=(\tau_{y, y'})_{y, y'\in X}$ of maps $\tau_{y, y'}: V(y, y')\to \mathfrak{I}(y, y')$ as follows. 
If $y\in F^{-1}(x)$ and $y'\in F^{-1}(x')$,  we put
$$
\tau_{y,y'}(\phi):= \tau_{x,x'}(F(\phi))
$$
for all $\phi \in V(y, y')$. Clearly, the maps $\tau_{y,y'}$ are locally finite and satisfy  $\tau_{y',y}(\phi)=\tau_{y, y'}(\phi^{-1})^\sharp$ for $\phi\in V(y',y)$ and 
$\tau_{y, y}(\Gamma^Y (g, z))=[I_{y}\stackrel{\id}\twoheadleftarrow I_{y}\stackrel{g}\twoheadrightarrow I_{y}]$ for every $g\in G_{y}$ and $z\in V(y)$. Finally, we shall verify the compatibility condition.  
If  $y\in F^{-1}(x)$, $y'\in F^{-1}(x')$, $\phi\in {\bf V}(y,y')$,  and the diagram $I_{y}\stackrel{a}\twoheadleftarrow I\stackrel{b}\twoheadrightarrow I_{y'}$  is a representative of $\tau_{y,y'}(\phi)$, we compute 
\begin{equation*}
\begin{split}
\Phi\circ \nu(\phi,s^y_{a(i)}(s(\phi)))&=\mu(F(\phi),\Phi(s^y_{a(i)}(s(\phi)))\\
&=\mu(F(\phi),s^x_{a(i)}(s(F(\phi))))\\
&=s^{x'}_{b(i)}(t(F(\phi)))\\
&=\Phi\circ s^{y'}_{b(i)}(t(\phi)), 
\end{split}
\end{equation*}
which implies that 
$$
\nu(\phi,s^y_{a(i)}(s(\phi)))=s^{y'}_{b(i)}(t(\phi))
$$\
for every $i\in I$. The proof of the theorem is complete.
\qed \end{proof}
In a next step we introduce the notion of two structured $\ssc^+$-multisection functors $\Lambda_1,\Lambda_2$ being commensurable.
More precisely let $[\Lambda_i,\mathfrak{U}_i,\mathfrak{S}_i,{\tau}_i]$, $i=1,2$,  be structured sc$^+$-mulitsection functors for the strong bundle $P:W\rightarrow X$ over the ep-groupoid $X$ with paracompact orbit space.
\begin{definition}\index{D- Commensurable sum}
Let $P:W\rightarrow X$ be the strong bundle  over the ep-groupoid $X$ having paracompact orbit space and let 
$\Lambda_i\equiv[\Lambda_j,\mathfrak{U}_j,\mathfrak{S}_j,{\tau}_j]$, where  $j=1,2$,  be structured $\ssc^+$-mulitsection functors. 
\begin{itemize}
\item[(1)]\ The functors ${\Lambda}_1$ and ${\Lambda}_2$ are called {\bf  commensurable} if we can take 
representatives for which   $\mathfrak{U}_1=\mathfrak{U}_2$, $\tau_1 =\tau_2$, and 
$I^1_x=I^2_x$ for all $x\in X$. Denote such a choice of compatible data by $\mathfrak{c}$.
\item[(2)]\ The {\bf commensurable sum} of the commensurable $\ssc^+$-multisection functors ${\Lambda}_1$ and ${\Lambda}_2$, for
the data $\mathfrak{c}$, 
denoted by 
$$
{\Lambda}:={\Lambda}_1\boxplus_{\mathfrak{c}} {\Lambda}_2 :W\to 
 {\mathbb Q}^+, 
$$
is defined by $[\Lambda, \mathfrak{U},\mathfrak{S}, \tau]$, where 
the  underlying $\ssc^+$-multisections functor $\Lambda$ is given as follows.  
The symmetric $\ssc^+$-section structure ${\mathfrak{s}}_x=(s^x_i)_{i\in I_x}$ on $U(x)$ is defined by 
$$s^x_i = s_i^{1,x}+s_i^{2,x},$$
and if $x\in X$ and $w\in W$ satisfies $P(w)\in U(x)$, then
$$
\Lambda(w)=\frac{1}{\abs{I_x}}\abs{\{ i\in I_x\, \vert \, s_i^x(P(w))=w\}}.
$$
\end{itemize}
\qed
\end{definition}
The commensurable sum can also be taken when we are given an infinite family 
${([{\Lambda}_j,\mathfrak{U},\mathfrak{S}_j,\tau])}_{j\in J}$, where every two are commensurable 
and in addition the underlying family $(\Lambda_j)$ is locally finite, i.e. there exists for every $x\in X$ an open neighborhood $O=O(x)$
so that with the exception of finitely many indices we have for $w\in W_y$, $y\in O$, that $\Lambda_j(w)=0$ provided $w\neq 0_y$. In this case
$$
\Lambda := \boxplus_{j\in J}^\mathfrak{c} \Lambda_j\ \ \ \text{(Here $\mathfrak{c}$ denotes as before a choice.)}
$$
is well-defined and a structured sc$^+$-multisection functor with data $(\mathfrak{U},\mathfrak{S},\tau)$.
 This is evident and does not require a proof.  The commensurable sum is not intrinsic and depends on choices.
 Nevertheless it is very important in constructions utilizing partition of unity arguments.


\section{Constructions of  Sc\texorpdfstring{$^+$}{yuo}-Multisections}
In this subsection we demonstrate how sc$^+$-multisection with certain properties  can be constructed.


\begin{definition}\label{KDEF}\index{D- Atomic sc$^+$-multisection}
A $\ssc^+$-multisection functor $\Lambda:W\rightarrow {\mathbb Q}^+$ is called  {\bf atomic} if the following conditions are satisfied: 
\begin{itemize}
\item[(1)]\  There exist a point $x\in X$ and $G_x$-invariant open neighborhoods  $U(x)$ and $V(x)$ such  that 
$\cl_X(V(x))\subset U(x)$ and $t: s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper. 
\item[(2)]\ There exists a symmetric $\ssc^+$-section structure $(s_i)_{i\in I_x}$ on $U(x)$ vanishing 
outside of $V(x)$.  
\item[(3)]\ The functor $\Lambda$ is related to the local section structure as follows:
\begin{itemize}
\item[$\bullet$]  If $w\in W$ and $w'=\mu(\phi,w)$, where $\phi : P(w)\to t(\phi)$ is a morphism  such that  $t(\phi)\in U(x)$, then 
$$
 \Lambda(w) = \frac{1}{\abs{I_x}}\abs{ \{i\in I_x\ |\ s_i(P(w'))=w'\}}.
 $$
\item[$\bullet$] If $w\in W$ and there is no morphism $\phi$ satisfying  $s(\phi)=P(w)$ and $t(\phi)\in U(x)$, then 
 $$
 \Lambda(w)=\begin{cases}
1, &\quad  \text{if $w=0$,}\\
0, &\quad  \text{otherwise.}
 \end{cases}
 $$
 \end{itemize}
 \end{itemize}
 \end{definition}
\begin{remark}\index{R- Atomic perturbations}
  In the perturbation theory one often introduces the atomic $\ssc^+$-multi\-section $\Lambda$ by first constructing one section which takes 
 at a prescribed smooth point $x$ a particular value, or has a tangent map with a prescribed property. Then one moves this section around 
 with the action of $G_x$ and finally  extends by a standard procedure. If one perturbs over a compact solution set, then  a finite number of such perturbations added together are sufficient  to achieve transversality. In order to carry out such a procedure one needs the existence of sc-smooth   bump functions but not necessarily sc-smooth partitions of unity.  
 \qed
  \end{remark}

 \begin{theorem}\label{THME1353}\index{T- Structurability}
Let $P:W\rightarrow X$ be a strong bundle over an ep-groupoid %
 If  $\Lambda:W\rightarrow {\mathbb Q}^+$ is an  atomic $\ssc^+$-multisection functor, then 
it  is structurable. 
\end{theorem}
\begin{proof}
We consider  an  atomic $\ssc^+$-multisection functor $\Lambda:W\rightarrow {\mathbb Q}^+$. 
We have  to construct a system of good neighborhoods ${\mathfrak U}=(U(x))_{x\in X}$, the family ${\mathfrak I}=(I_x)_{x\in X}$ of index sets,  the family of correspondences ${\mathfrak \tau}=(\tau_{x, x'})_{x, x'\in X}$, and the family ${\mathfrak S}=({\mathfrak s}_x)_{x\in X}$ of symmetric $\ssc^+$-section structures on $U(x)$ satisfying the compatibility conditions. 



Since $\Lambda$ is atomic   there are $G_{x_0}$-invariant open neighborhoods $U(x_0)$ and $V(x_0)$ such that $\cl_{X}V(x_0)\subset U(x_0)$ and the target map $t: \cl_{X}(s^{-1}(U(x_0))\to X$ is proper. Moreover, on $U(x_0)$, there exists a symmetric $\ssc^+$-section structure ${\mathfrak s}_{x_0}=(s^{x_0}_i)_{i\in I_{x_0}}$ such that the sections $s^{x_0}_i$ vanish on 
$U(x_0)\setminus V(x_0)$ and $\Lambda$ can be written in terms of this data
$$
\Lambda(w)=\frac{1}{|I_{x_0}|}\cdot |\{i\in I_{x_0}\ |\ s_i(P(w))=w\}|\ \ \text{if}\ \ P(w)\in U(x_0).
$$

We take $U(x_0)$ as our first set with index set $I_{x_0}$, and sc$^+$-section structure $\mathfrak{s}_{x_0}={(s^{x_0}_i)}_{i\in I_{x_0}}$.
We define $\tau_{x_0,x_0}:\bm{U}(x_0,x_0)\rightarrow \mathfrak{I}(x_0,x_0)$ by 
$$
\tau_{x_0,x_0}(\Gamma(g,y))=[I_{x_0}\stackrel{Id}\twoheadleftarrow I_{x_0}\stackrel{g}\twoheadrightarrow I_{x_0}]\ \ \text{for}\ \ y\in U(x_0),\ g\in G_{x_0}.
$$
Next consider the points $x\in U(x_0)$. For each of them we pick an open $G_x$-invariant neighborhood
$U(x)$ satisfying $U(x)\subset U(x_0)$ and take $\mathfrak{s}_x:={(s^{x_0}_i|U(x))}_{i\in I_x}$ with $I_x:=I_{x_0}$.
We define a group homomorphism 
$$
\gamma_x:G_x\rightarrow G_{x_0}: g\rightarrow \gamma_x(g) 
$$
where $\gamma_x(g)$ is uniquely determined by the equality  $\Gamma^x(g,x)=\Gamma^{x_0}(\gamma_x(g),x)$.
Here $\Gamma^x$ and $\Gamma^{x_0}$ are associated to the natural representations on $U(x)$ and $U(x_0)$, respectively.
Then $G_x$ acts on $I_x$ by
$$
g(i) :=( \gamma_x(g))(i),\ i\in I_{x}=I_{x_0}.
$$
Given $x,x'\in U(x_0)$ the set $\bm{U}(x,x')$ is an open subset of $\bm{U}(x_0,x_0)$ and
we define $\tau_{x,x'}$ as the restriction of $\tau_{x_0,x_0}$.  

Among the  points $x\in X\setminus U(x_0)$ consider first the points $x$ which have an open neighborhood $O(x)$ 
with the property that $\Lambda(0_y)=1$ for $y\in O(x)$.  In this case fix an open $G_x$-invariant neighborhood
$U(x)$ with the properness property and take as sc$^+$-section structure $\mathfrak{s}_x$ the single zero-section
$s^x_\ast$ parameterized by $I_x=\{*\}$.  

If $x\in X\setminus U(x_0)$ but such a neighborhood $O(x)$ does not exist, we can pick a morphism
$\phi_x$ with $s(\phi_x)=x$ and $t(\phi_x)\in \cl_X(V(x_0))$. We find open neighborhoods $U(\phi_x)$, $U(x)$, and $U'(t(\phi_x))$
such that 
\begin{itemize}
\item $\sigma_x:=t\circ (s|U(\phi_x))^{-1}:U(x)\rightarrow U'(t(\phi_x))$ is an sc-diffeomorphism.
\item  $U'(t(\phi_x))\subset U(t(\phi_x))$.
\end{itemize}
We define $I_x:=I_{t(\phi_x)}$ and take as section structure $\mathfrak{s}_x$ the pull-back of the restriction 
of $\mathfrak{s}_{t(\phi_x)}$ to $U'(t(\phi_x))$.  We define a group isomorphism $\gamma_x:G_x\rightarrow G_{t(\phi_x)}$
by
$$
\gamma_x(g)  =  \phi_x \circ g\circ \phi^{-1}_x
$$
which we use to define the $G_x$-action on $I_x$ by 
$$
g(i):= (\gamma_x(g))(i),\ i\in I_x=I_{t(\phi_x)}=I_{x_0}.
$$
At this point we have defined a family $\mathfrak{U}={(U(x))}_{x\in X}$, an index set $I_x$ for every $x\in X$, together 
with group actions of $G_x$ on $I_x$.  In addition we have defined for every $x\in X$ a sc$^+$-section structure
$\mathfrak{s}_x$.   We also have defined the correspondences $\tau_{x,x'}$ for $x,x'\in U(x_0)$.
We need to define $\tau_{x,x'}$ for the remaining cases. Assume first that $x,x'$ are given outside of $U(x_0)$
such that the previously introduced $\phi_x$ and $\phi_{x'}$ with targets in $\cl_X(V(x_0))$ exist.
Using the sc-embeddings $\sigma_x$ and $\sigma_{x'}$ we can embed 
$\bm{U}(x,x')$ into $\bm{U}(t(\phi_x),t(\phi_{x'}))$ via the map
$$
\phi \rightarrow ( (s|U(\phi_{x'})^{-1}(t(\phi) ) \circ \phi  \circ {(( s|U(\phi_x))^{-1}(s(\phi)))}^{-1},
$$
and define 
$$
\tau_{x,x'}(\phi) := \tau_{t(\phi_x),t(\phi_{x'})} \left(( (s|U(\phi_{x'})^{-1}(t(\phi) ) \circ \phi  \circ {(( s|U(\phi_x))^{-1}(s(\phi)))}^{-1}\right).
$$
Assume next that $|x|\not\in |U(x_0)|$ and $x'$ is arbitrary.
We define
$$
\tau_{x,x'}(\phi)= [\{\ast\}\twoheadleftarrow I_{x'} \stackrel{Id}\twoheadrightarrow I_{x'}].
$$
If $x $ is arbitrary and $x'\in X$ satisfies $|x'|\not\in |U(x_0)|$ we define 
$$
\tau_{x,x'}(\phi) =[I_x\stackrel{Id}\twoheadleftarrow I_x \twoheadrightarrow \{*\}].
$$
The latter two definitions are compatible if $|x|,|x'|\not\in |U(x_0)|$.  On verifies easily that the 
sc$^+$-section structures are compatible via the correspondences.
With this data $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$ is a structured version of $\Lambda$.
\qed \end{proof}



 The following two Theorems  together show that one can construct atomic $\ssc^+$-multisections 
possessing  special properties.
\begin{theorem}[Construction I]\index{T- Construction of $\Lambda$}\label{THMXX1354}
Let $(P:W\rightarrow X,\mu)$  be  a strong bundle over an ep-groupoid admitting smooth bump functions.  We assume that $x$ is a smooth object  and $U(x)$ is a $G_x$-invariant   open neighborhood having the properness property and admitting the natural
$G_x$-action.  Let $V(x)$ be an another open neighborhood such that $\cl_X(V(x))\subset U(x)$ and $V(x)$
is invariant under $G_x$. Then the following statements hold. 
\begin{itemize}
\item[{\em(1)}]\ If $w\in W$ is a smooth vector satisfying  $P(w)=x$,  
then there exists a finite family of $\ssc^+$-section $s_i$, $i\in I$, defined on $U(x)$ vanishing on $U(x)\setminus V(x)$
 and an action of $G_x$ on $I$ satisfying 
$s_{g(i)}(g\ast z) =\mu(\Gamma (g, z),s_i(z))$ for $z\in U(x)$,  and $s_{i_0}(x)=w$ for some $i_0\in I$.
\item[{\em(2)}]\ If $s$ is a $\ssc^+$-section near $x\in U(x)$  satisfying  $s(x)=0$,  then there exists a finite family of $\ssc^+$-sections $s_i$ for $i\in I$, supported  in $U(x)$, vanishing on $U(x)\setminus V(x)$, and an action of  $G_x$ on $I$ such that 
$s_{g(i)}(g\ast z) =\mu(\Gamma (g,z), s_i(z))$ for $z\in U(x)$ and  $i\in I$. 
Moreover,  
$s_{i_0}(y)=s(y)$ for $y$ near  $x$ for some $i_0\in I$.
\end{itemize}
\end{theorem}
\begin{proof}
The proof  is straightforward. In case (1) we fix an open neighborhood $V(x)$ with $\cl_X(V(x))\subset U(x)$
so that $V(x)$ is invariant under the $G_x$-action. We construct in local coordinates a $\ssc^+$-section $s$ satisfying  $s(x)=w$. We multiply 
$s$ with a  sc-smooth bump function $\beta$ supported in $V(x)$ and satisfying $\beta (x)=1$, so that the product $\beta\cdot s$ 
is a $\ssc^+$-section supported in $U(x)$. Recall such $\beta$ exists with arbitrarily small support.
Now,  applying  the $G_x$ action,  we define for every $g\in G_x$ the local $\ssc^+$-section $s_g: U(x)\to W$ by $s_{g}(g\ast z)=\mu(\Gamma (g, z), s_0(z))$ for $z\in U'(x)$, where $s_0=\beta\cdot s$.  Using the properties of the sc-diffeomorphism $\Gamma: G_x\times U(x)\to \{\phi \in {\bf X}\, \vert \, \text{$s(\phi)$ and $t(\phi)\in U(x)$}\}$ and of the structure map $\mu$  one sees that if $g=\text{id}\in G_x$ then $s_{\text{id}}(z)=s_0(z)$. Moreover, for every $g,h\in G_x$ the formula 
$s_{g\circ h}(g\ast z)=\mu (\Gamma (g, z), s_h(z))$ holds for every $z\in U(x)$. Consequently, introducing the finite index set $I=G_x$ and the group isomorphism $\tau: G_x\to \text{Per}(I)$ into the permutations of $I$, defined by $\tau (g)(h)=g\circ h$, we obtain the equation
$$
s_{\tau (g)(h)}(g\ast z)=\mu (\Gamma (g, z), s_h(z))
$$
for every $z\in U(x)$ and $g, h\in G_x$.
This way we obtain a called symmetric section structure near $x$ defined on $U(x)$, where the $s_g$ have support 
in $V(x)$ with $\cl_X(V(x))\subset U(x)$. \par

In case (2) we use a sufficiently concentrated  bump function and define $s_0=\beta\cdot s$.
\qed \end{proof}
The previous proposition tells us how to  obtain locally a $G_x$-invariant family of $\ssc^+$-section supported in a suitable
neighborhood $U(x)$ for which there exists $V(x)$ with $\cl_X(V(x))\subset U(x)$, so that the support is contained in $V(x)$.  Such families can be used to construct atomic $\ssc^+$-multisections as the next result illustrates. 
\begin{theorem}[Construction II]\index{T- Construction of $\Lambda$}\label{THMXX1355}
Let $(P:W\rightarrow X,\mu)$ be  a strong bundle over an ep-groupoid admitting smooth bump functions. 
We assume that $x$ is a smooth point and $U(x)$ an open neighborhood  which is invariant under the natural $G_x$-action having the properness property.  Further, we  let $s_i$, $i\in I$, be a finite number of $\ssc^+$-sections of the strong bundle $W\rightarrow X$ supported in $U(x)$, where we view $X$ just as a M-polyfold.
We assume in  addition that   $G_x$ acts on $I$ such  that $s_{g(i)}(g\ast z)=\mu(\Gamma (g, z),s_i(z))$ for all $z\in U(x)$ and $i \in I$.
Then there exists a uniquely determined atomic $\ssc^+$-multisection $\Lambda$ of  $P$ which is supported in the saturation of $U(x)$ and which over $U(x)$ can be written 
$$
\Lambda(w)=\frac{1}{|I|}\cdot |\{i\in I\ |\ s_i(P(w))=w\}|.
$$
Moreover $\Lambda$ is structurable.
\end{theorem}
\begin{proof}
Let $U(x)$ be an open neighborhood admitting the natural $G_x$-action, so that $t\colon s^{-1}(\cl_X(U(x)))\rightarrow X$ is proper.
We assume we are given a finite set $I$ with an action by $G_x$ and a family of sc$^+$-sections ${(s_i)}_{i\in I}$ of $W|U(x)$
having the following properties.
\begin{itemize}
\item[(i)]\ \ $s_{g(i)}(g\ast y)= \mu(\Gamma(g,y),s_i(y))$ for $y\in U(x)$.
\item[(ii)]\  \ There exists $V(x)$ with $\cl_X(V(x))\subset U(x)$ and invariant under $G_x$, such that
$s_i(y)=0$ for $y\in U(x)\setminus V(x)$. 
\end{itemize}
First we define $\Lambda: W\rightarrow {\mathbb Q}^+$. If $w\in W$ and there exists a morphism 
$\phi$ with $t(\phi)\in U(x)$ and $s(\phi)=P(w)$ we define
$$
\Lambda(w)=\frac{1}{|I|}\cdot |\{i\in I\ |\ s_i(P(w))=w\}|.
$$
If no such $\phi$ exists we define 
$$
\Lambda(w)=\left[\begin{array}{cc}
1&\ \ \text{if}\ w=0_{P(w)}\\
0&\ \ \text{otherwise.}
\end{array}\right.
$$
We need to show that $\Lambda$ can be represented locally by sc$^+$-smooth section structures.\\

In the case that there exist $\phi:P(w)\rightarrow y$ with $y\in U(x)$ we can use the associated local sc-diffeomorphism
$\wh{\phi}$ to pull-back the local section structure and it will represent $\Lambda$ on $W$ restricted to a suitable 
small neighborhood of $P(w)$.\par

In the case that there does not exist a morphism starting at $y=P(w)$ and ending in $U(x)$
we find an open $G_y$-invariant neighborhood $U(y)$ so that $|U(y)|\cap |V(x)|=\emptyset$.  In this case
we take as section structure the single zero section on $U(y)$ which we may assume to possess the properness property.\par

After this discussion we see that $\Lambda$ is an sc$^+$-multisection functor. We have already established
that they are structurable.

\qed \end{proof}
The basic existence result deduced  from the two previous results  is the following theorem which provides in addition  a control  of the size of the sections. 
\begin{theorem}\label{existence_lambda}\index{T- Controlled atomic sc$^+$-multisection}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the ep-groupoid $X$ with paracompact orbit space $|X|$,  which admits sc-smooth bump functions.
Let  $N$ is a given auxiliary norm for $(P,\mu)$. {\em (}It  exists due to  the paracompactness of $|X|${\em)}. 
For every  smooth vector  $w\in W\setminus 0_W$ satisfying $P(w)=x$ and every  open neighborhood $U(x)$ around $x=P(w)$ equipped with the natural $G_x$-action, there exists an atomic $\ssc^+$-multisection  satisfying  the following properties, 
\begin{itemize}
\item[{\em(1)}]\ $\text{dom-supp}(\Lambda)\subset \pi^{-1}(U(x))$.
\item[{\em(2)}]\ $\Lambda(g\ast w)>0$ for all $g\in G_x$.
\end{itemize}
Moreover,  if $s$ is a $\ssc^+$-section defined in the  open neighborhood $U(x)$ and if $\varepsilon>0$, then there exists an atomic $\ssc^+$-multisection $\Lambda$ supported   in $\pi^{-1}(U(x))$ and  satisfying $N(\Lambda)(y)\leq N(s(x))+\varepsilon$ for all $y\in X$,
whose  local section structure near $x$ contains  the 
$\ssc^+$-section $s$ having a positive weight.
\end{theorem}





The importance of atomic $\ssc^+$-section functors comes from the following result.
It states that every structurable $\ssc^+$-multisection functor $\Lambda:W\rightarrow {\mathbb Q}^+$ associated to $P:W\rightarrow X$,
where $|X|$ is paracompact and $X$  admits sc-smooth partitions of unity, can be obtained as   a locally finite commensurable
sum of atomic $\ssc^+$-multisection functors.
\begin{theorem}\index{T- Atomic decomposition}\label{THMX1357}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the ep-groupoid $X$ which has a paracompact orbit space $|X|$ and admits sc-smooth partitions of unity.
We assume that $\Lambda:W\rightarrow {\mathbb Q}^+$ is a  structurable $\ssc^+$-multisection functors. Then there exists a locally finite family of commensurable structured $\ssc^+$-multisection functors 
${([\Lambda_j,\mathfrak{U},\mathfrak{S}_j,\tau])}_{j\in J}$, each having an underlying atomic $\ssc^+$-multisection functor $\Lambda_j$, such that  
$$
[\Lambda,\mathfrak{U},\mathfrak{S},\tau] =\boxplus_{j\in J}[ {\Lambda}_j,\mathfrak{U},\mathfrak{S}_j,\tau].
$$
\end{theorem}
\begin{proof}
We take a structured lift  of $\Lambda$ represented by $(\Lambda,\mathfrak{U},\mathfrak{S},\tau)$.
Setting $\wt{U}(x):=\pi^{-1}(|U(x)|)$ for every $x\in X$, the family ${(\wt{U}(x))}_{x\in X}$ is an open covering of $X$ by saturated sets. By assumption the orbit space $\abs{X}$ is paracompact and $X$ admits sc-smooth partition of unity functors as an ep-groupoid. Consequently, there exists a locally finite refinement $(V_j)_{j\in J}$ of ${(\wt{U}(x))}_{x\in X}$ and,  for every $j\in J$,  a point $x_j\in X$ such that $\cl_{\abs{X}}(V_j)\subset \abs{U(x_j)}$, and, moreover, a sc-smooth partition  of unity $(\beta_j)_{j\in J}$ of functors $\beta_j: X\to [0,1]$ satisfying 
$\supp (\abs{\beta_j})\subset V_j$.

Fixing $j\in J$, we define the $\ssc^+$-section structure $\mathfrak{s}^{j,x}=(s^{j,x}_{i})_{i\in I_x}$ on every $U(x)$ by 
$$s^{j,x}_i(y)=\beta_j(y)\cdot s^x_i(y), $$
which in turn defines the $\ssc^+$-multisection functor  $\Lambda_j$ and the structured 
$$
[\Lambda_j,\mathfrak{U},\mathfrak{S_j},\tau].
$$ 
We claim that,  for every $j\in J$, the functor $\Lambda_j$ is atomic. Since 
$\supp \abs{\beta_j}\subset  V_j \subset |U(x_j)|$, it follows that $\wt{\beta}_j:=\beta_j\vert U(x_j): U(x_j)\rightarrow [0,1]$
vanishes outside of the set $\pi^{-1}(V_j) \cap U(x_j)$ whose closure in $X$ is contained in $U(x_j)$ in view of Lemma \ref{simple_lemma}.
Hence $\Lambda_j$ is atomic and by construction the family $(\Lambda_j)$ is locally finite. By construction
$$
[\Lambda,\mathfrak{U},\mathfrak{S},\tau] =\boxplus_{j\in J} [\Lambda_j,\mathfrak{U},\mathfrak{S}_j,\tau].
$$
The proof is complete.
\qed \end{proof}


\chapter{Extension of Sc\texorpdfstring{$^+$}{pl}-Multisections}\label{CHAPH14}

The main  result in this chapter  concerns an extension  of a structurable  $\ssc^+$-multi\-sec\-tion functor  defined over $\partial X$, i.e.
$\Lambda:W\vert \partial X\rightarrow {\mathbb Q}^+$, 
to  a structurable $\ssc^+$-multisection  functor $\Lambda':W\rightarrow {\mathbb Q}^+$ over all of $W$,   satisfying some additional properties:
$$
[\Lambda:W\vert \partial X\rightarrow {\mathbb Q}^+]\ \   \rightsquigarrow\ \ [\Lambda':W\rightarrow {\mathbb Q}^+].
$$
The additional properties are concerned with the size of the extension and its support.
First we shall provide the appropriate definitions and state the main result, and then we outline 
 the proof so that the reader will be able to follow the sizable construction.
\section{Definitions and Main Result}\label{SECR14.1}

In order to formulate the extension result we need some preparation. We assume that $X$ is a tame ep-groupoid with paracompact orbit space $|X|$ admitting sc-smooth partitions of unity. We note that in general the boundary $\partial X$ is not an ep-groupoid, however, it has enough structure to talk about smooth data on it. 

Recall that a tame M-polyfold  $M$ has for every point $x$ an arbitrarily small open neighborhood $V=V(x)$, so that there are
precisely $d(x)$-many connected components in $\{y\in V\ |\ d(y)=1\}$ having $x$ in its closure, and each such closure
is a sub-M-polyfold, see Corollary \ref{cor_2.42} and Section \ref{subsec_tame_m_polyfolds} for more detail. If we take such a neighborhood small enough we may assume that the properness property holds.
Of course, in addition, we may always assume that we have the natural $G_x$-action on $V(x)$.
Hence we make the following definition. 
\begin{definition}\label{DEF_good_open}\index{D- Good neighborhood of $x\in \partial X$}
Let $X$ be a tame  ep-groupoid and $x\in \partial X$. A {\bf good} open neighborhood $U(x)$ in $\partial X$
is a subset of $\partial X$ which is given as the intersection $U(x)=V(x)\cap \partial X$, where $V(x)$ has the following properties.
\begin{itemize}
\item[(1)]\  $V(x)$ is an open neighborhood of $x$ in $X$ and admits the natural $G_x$-action.
\item[(2)]\  $t:s^{-1}(\cl_X(V(x)))\rightarrow X$ is proper.
\item[(3)]\  There are $d_X(x)$-many  connected components $\theta_i$  in $\{y\in V(x)\ |\ d_X(y)=1\}$ so that their closures $\bar{\theta}_i$
in $V(x)$ contain $x$, and for $y\in V(x)$ it holds that
$$
d_X(y)=\sharp\{i\in \{1,..,d_X(x)\}\ |\ y\in \bar{\theta}_i\}.
$$
\end{itemize}
We shall refer to $V(x)$ as a {\bf good} open neighborhood of $x\in\partial X$ in $X$. Note that the $\bar{\theta}_j$ are tame M-polyfolds. \qed
\end{definition}
\begin{remark}
For the existence of such neighborhoods $V(x)$ see Proposition \ref{FACE_XXXX} and the discussion preceding it.
\end{remark}
Next we shall introduce a class of sc$^+$-multisections over $\partial X$.

\begin{definition}\label{symm}\index{D- Sc$^+$-multisection over $\partial X$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the tame ep-groupoid $X$ with paracompact $|X|$. A functor 
$\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$ is an {\bf sc$^+$-multisection (functor) over $\partial X$} if for every $x\in \partial X$
 there exists 
a good neighborhood $U(x)$ in $\partial X$, an index set $I_x$ with $G_x$-action and a family of section ${(s^x_i)}_{i\in I_x}$
defined for $W|U(x)$ so that 
\begin{itemize}
\item[(1)]\ The restriction of $s_i^x$ to every $\bar{\theta}_j$ is an sc$^+$-section of $W|\bar{\theta_j}$.
\item[(2)]\  $s^x_{g(i)}(g\ast y)=\mu(\Gamma(g,y),s^x_i(y))$ for all $y\in U(x)$.
\item[(3)]\  $\Lambda(w)=\frac{1}{|I_x|}\cdot |\{i\in I_x\ |\ s_i^x(P(w))=w\}|$\ \ for $w\in W$ with $P(w)\in U(x)$.
\end{itemize}
We call $\mathfrak{s}_x={(s^x_i)}_{i\in I_x}$ a {\bf symmetric sc$^+$-section structure}\index{D- Symmetric sc$^+$-section structure} for $\Lambda$ near $x$ (in $\partial X$).
\qed
\end{definition}
\begin{remark}[Extensions]\index{R- Remark concerning extensions}
Let for $x\in \partial X$ be the data as in Definition  \ref{symm} and assume that $X$ admits sc-smooth partitions of unity.
Then it is an easy exercise to show that there exists an open neighborhood $V(x)$ of $x$ in $X$
being invariant under the natural $G_x$-action and sc$^+$-sections ${(\overline{s}_i^x)}_{ i\in I}$ of $W|V(x)$
having the following properties:
\begin{itemize}
\item[(a)]\ $V(x)\cap \partial X=U(x)$.
\item[(b)]\ $\overline{s}_i|U(x)= s_i$ for all $i\in I$.
\item[(c)]\  $\overline{s}^x_{g(i)}(g\ast y) =\mu(\Gamma(g,y),\overline{s}^x_i(y))$ for $y\in V(x)$ and $g\in G$.
\end{itemize}
To see this, we first construct in a straight forward many $V(x)$. 
Pick $i\in I$ and  employ Proposition \ref{hucky}  and a partition of unity argument
to construct $\overline{s}_i^x$.  Then we use the formula (c) to define $s^x_{g(i)}$ for every $g\in G$.
In a next step we pick $i\in I\setminus G(I)$ and repeat the previous step. We are done after a finite number of iterations.
\qed
\end{remark}

Next we shall introduce the notion of good systems of neighborhoods for $\partial X$. 

\begin{definition}\index{D- Good system of neighborhoods ($\partial X$-case}
Let ${(U(x))}_{x\in\partial X}$ be a collection of open neighborhoods $U(x)\subset \partial X$ of points $x\in \partial X$
in $\partial X$.  Then ${(U(x))}_{x\in\partial X}$ is called a {\bf good system} of neighborhoods for $\partial X$ if the following conditions are satisfied:
\begin{itemize}
\item[(1)]\  The $U(x)$ are good neighborhoods in the sense of Definition \ref{DEF_good_open}
\item[(2)]\  For two points $x,x'\in \partial X$,  the  subset $\bm{U}(x,x')=\{\psi\in \bm{X}\ |\ s(\psi)\in U(x),\ t(\psi)\in U(x')\}$ of $\bm{X}$ has  the following property.  There exist good open neighborhoods $V(x)$ and $V(x')$ of $x$ and $x'$ in $X$, see
Definition \ref{DEF_good_open}, restricting to  $\partial X$
as $U(x)$ and $U(x')$ so that
for every connected component $\Sigma\subset \bm{V}(x,x')$ the source map $s:\Sigma\rightarrow V(x)$ and the target map
$t:\Sigma\rightarrow V(x')$ are sc-diffeomorphisms onto open subsets. 
\end{itemize}
\qed
\end{definition}
Given an open covering ${(O(x))}_{x\in\partial X}$ of $\partial X$ ($O(x)$ open in $\partial X$), we can find a good system of open neighborhoods
${(U(x))}_{x\in\partial X}$, $U(x)\subset O(x)$,  by employing Theorem \ref{xxxx-structure} as outlined in the following proof.
\begin{theorem}\label{THMX14.1.15}
Let $X$ be an ep-groupoid with paracompact orbit space $|\partial X|$ and ${(O(x))}_{x\in\partial X}$ an  open cover
of $\partial X$ by open neighborhoods of its points (Here $O(x)$ is open in $\partial X$).  Then there exists a good system of neighborhoods  $ {(U(x))}_{x\in\partial X}$
for $\partial X$
with $U(x)\subset O(x)$ for all $x\in \partial X$.
\end{theorem}
\begin{proof}
Extend the elements of the collection ${(O(x))}_{x\in\partial X}$ to open neighborhoods $\wt{O}(x)$ of $x\in \partial X$
with $\wt{O}(x)\cap \partial X=O(x)$.  By adding open neighborhoods $\wt{O}(x)$ for $x\in X\setminus \partial X$
we obtain the collection  ${(\wt{O}(x))}_{x\in X}$. In view of Theorem \ref{xxxx-structure}
we find a good system of neighborhoods ${(V(x))}_{x\in X}$ with $V(x)\subset \wt{O}(x)$ for $x\in X$.
Then define for $x\in \partial X$ the set $U(x)$ by $U(x):=\partial X\cap V(x)$.
\qed \end{proof}




Now we are in the position to define structured $\ssc^+$-multisection functors for $W\vert \partial X$.
\begin{definition}\label{corr-xxxx}\index{D- Structured $\ssc^+$-multisection ($\partial X$-case)}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over a tame ep-groupoid with paracompact orbit space $|X|$. A {\bf structured} $\ssc^+$-multisection  over $\partial X$ is an equivalence class of tuples $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$ in which  $\Lambda:W\vert \partial X\rightarrow {\mathbb Q}^+$ is a $\ssc^+$-multi\-sec\-tion functor, and
\begin{itemize}
\item[(1)]\  $\mathfrak{U}={(U(x))}_{x\in \partial X}$ is a good system of open neighborhoods for $\partial X$,
\item[(2)]\   $\tau={(\tau_{x,x'})}_{(x,x')\in \partial X\times \partial X}$ is a collection of correspondences
$$
\tau_{x,x'}:\bm{U}(x,x')\rightarrow \mathfrak{J}(x,x'),
$$
Every $\tau_{x,x'}$ only takes finitely many values. 
We assume in addition that 
\begin{itemize}
\item[(a)]\ $\tau_{x',x}(\phi^{-1})=(\tau_{x,x'}(\phi))^\sharp$.
\item[(b)]\  $\tau_{x,x}(\Gamma(g,z))=[I_x\stackrel{Id}{\twoheadleftarrow} I_x\stackrel{g}{\twoheadrightarrow} I_x]$.
\item[(c)]\ $g'\ast\tau_{x,x'}(\phi)\ast g=\tau_{x,x'}(g'\ast\phi\ast g)$ for $g'\in G_{x'}$, $g\in G_x$,
and $\phi\in \bm{U}(x,x')$.
\end{itemize}
\item[(3)]\  $\mathfrak{S}= {(\mathfrak{s}_x)}_{x\in \partial X} $, where $\mathfrak{s}_x$  is a symmetric $\ssc^+$-section structure on $U(x)$ indexed by $I_x$ and representing $\Lambda$:
$$
\Lambda(w)=\frac{1}{|I_x|}\cdot |\{i\in I_x\ |\ s^x_i(P(w))=w\}|\ \ \ \text{if}\ \ P(w)\in U(x).
$$
\item[(4)]\ For $x,x'\in \partial X$ the compatibility condition $s^{x'}_{b(k)}(t(\phi))=\mu(\phi,s^x_{a(k)}(s(\phi)))$, $k\in I$,
for all $\phi\in \bm{U}(x,x')$ holds. Here $a,b$ is the usual data associated to $\tau_{x,x'}(\phi)$, i.e. 
$$
\tau_{x,x'}(\phi) = [I_x\stackrel{a}\twoheadleftarrow I\stackrel{b}\twoheadrightarrow I_{x'}].
$$
\end{itemize}
A $\ssc^+$-multisection functor $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$ is called  {\bf structurable}\index{D- Structurable $\ssc^+$-multisection ($\partial X$-case)} if there exists 
a structured $\ssc^+$-multisection  of the form $[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$, where the notion
of equivalence is similar to the $X$-case, see Definition \ref{DEF13.3.8} and before.
\qed
\end{definition}
For a latter discussion in Section \ref{SECTX16.5}    we note the following result.
\begin{proposition}\label{prop14.1}
Let $(P:W\rightarrow X,\mu)$ and $(P':W'\rightarrow X',\mu')$ be strong bundles over tame ep-groupoids with paracompact orbit spaces
and assume that $\overline{\mathfrak{f}}:W\rightarrow W'$ is a generalized strong bundle isomorphism covering $\mathfrak{f}:X\rightarrow X'$.
Further let $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$ and $\Lambda':W'|\partial X'\rightarrow {\mathbb Q}^+$ be structurable 
sc$^+$-multisection functors in the sense of Definition \ref{corr-xxxx}.  Then $\bar{\mathfrak{f}}^\ast\Lambda'$ defines a structurable 
sc$^+$-multisection functor defined on $W|\partial X$ and $\bar{\mathfrak{f}}_\ast \Lambda$ defines a structurable sc$^+$-multisection functor
on $W'|\partial X'$.
\qed
\end{proposition}
\begin{proof}
Given $\overline{\mathfrak{f}}:W\rightarrow W'$ we take a representative which gives the commutative diagram
$$
\begin{CD}
W @< \Phi << V @> \Psi>> W'\\
@V P VV  @V Q VV @V P' VV\\
X@<E<<  A@> F>>X, 
\end{CD}
$$
where $Q: V\rightarrow A$ is a strong bundle over a tame ep-groupoid, and the horizontal arrows
give strong bundle equivalences. 

Let $\Lambda:W\vert \partial X\rightarrow {\mathbb Q}^+$ be a structurable sc$^+$-multisection functor. 
By an argument  similar to that used in the proof of Theorem \ref{pullbackX} it is a straight forward  exercise to show that $E^\ast\Lambda$ is a  structurable sc$^+$-multisection functor.   Then employing an argument as
in the proof of Theorem \ref{pushforwardX} we see that $\overline{\mathfrak{f}}_\ast \Lambda=F_\ast E^\ast \Lambda 
$ is structurable as well.  The argument for the pullback via $\overline{\mathfrak{f}}$ is similar.
\qed
\end{proof}



One of the  main results in this chapter is the following extension theorem.
\begin{theorem}[$\partial$-Extension Theorem]\label{p-main-p}\index{T- $\partial$-Extension theorem}
Assume  $(P:W\rightarrow X,\mu)$ is   a strong bundle over a tame  ep-groupoid $X$ with paracompact orbit space $|X|$ and $X$, as the M-polyfold,   admits  sc-smooth partitions of unity. 
Let 
$$
\Lambda:W|\partial X\rightarrow {\mathbb Q}^+
$$
be  a structurable $\ssc^+$-multisection functor defined over the boundary and let 
$N:W\rightarrow [0,\infty]$ be an auxiliary norm. 
If $\wt{U}$ is a saturated open neighborhood 
of $\text{dom-supp}(\Lambda)$ in $X$ and $f:X\rightarrow [0,\infty)$ is a continuous functor supported in $\wt{U}$ and satisfying
$N(\Lambda)(x)<f(x)$ for all $x\in \text{dom-supp}(\Lambda)$, then there exists  a structurable $\ssc^+$-multisection functor $\Lambda':W\rightarrow {\mathbb Q}^+$
having  the following properties:
\begin{itemize}
\item[\em{(1)}]\ $N(\Lambda')(x)\leq f(x)$ for all $x\in X$.
\item[\em{(2)}]\ $\text{dom-supp}(\Lambda')\subset \wt{U}$.
\item[\em{(3)}]\ $\Lambda'|(W|\partial X)=\Lambda$.
\end{itemize}
\qed
\end{theorem}
\begin{remark}
The proof of this theorem requires some preparations and is rather involved.
Extension theorems for sc$^+$-section functors are, given sc-smooth partitions of unity,
not very difficult. However, the complexity in the case of multisections is much higher.
\qed
\end{remark}
\section{Good Structured Version of \texorpdfstring{$\Lambda$}{Lam}}
We assume that $\Lambda$  is given as described in Theorem \ref{p-main-p}.
Since   $\Lambda: W|\partial X\rightarrow {\mathbb Q}^+$ is structurable we can take a structured lift
represented by
\begin{eqnarray}\label{display7}
 (\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')
\end{eqnarray}
 In detail this gives 
us the following list of data with certain properties, which will be used in the following.
\begin{description}
\item[{\bf (P1)}]\ \ For every $x\in \partial X$ a good neighborhood $U'(x)$ of $x$ in $\partial X$ which by definition has the following properties
\begin{itemize}
\item[(i)]\ \ $U'(x)=V(x)\cap \partial X$, where $V(x)$ is an open neighborhood of $x$ in $X$ admitting the natural $G_x$-action.
\item[(ii)]\ \ $t:s^{-1}(\cl_X(V(x)))\rightarrow X$ is proper.
\item[(iii)]\ \ There are $d_X(x)$-many connected components $\theta_i$ in 
$$
\{y\in V(x)\ |\ d_X(y)=1\}\subset \partial X,
$$
 so that their closures $\bar{\theta}_i$ in $V(x)$ are tame M-polyfolds containing $x$ and 
$$
d_X(y)=\sharp\{i\in \{1,...,d_X(x)\}\ |\ y\in\bar{\theta}_i\}.
$$
\end{itemize}
\item[{\bf (P2)}]\ \  For every $x\in \partial X$ a finite index set $I_x$ and a symmetric sc$^+$-section structure
$\mathfrak{s}_x'$ given by $s_i'^x$, $i\in I_x$, on $U'(x)$, which represents $\Lambda$ over $U'(x)$,
see Definition \ref{symm}. We abbreviate $\mathfrak{J}={(I_x)}_{ x\in \partial X}$.
\item[{\bf (P3)}]\ \  For $x,x'\in \partial X$ correspondences $\tau_{x,x'}':\bm{U}(x,x')\rightarrow \mathfrak{J}(x,x')$ with the properties listed in Definition \ref{corr-xxxx}. We denote by $v'(x,x')$
the image of $\tau_{x,x'}'$.
\end{description}
We shall modify the given data 
later on. The index sets in $\mathfrak{J}$  will stay unchanged.
In general $\mathfrak{U}'$ will be modified to achieve certain goals.
We denote by $\bm{U}'(x,x')$ the subset of $\partial \bm{X}$ defined by
$$
\bm{U}'(x,x')=\{\phi\in \partial\bm{X} \ |\ s(\phi)\in U'(x),\ t(\phi)\in U'(x')\}.
$$
The first important fact is that 
$$
\tau_{x,x'}':\bm{U}'(x,x')\rightarrow \mathfrak{J}(x,x')
$$
only takes finitely many values.  This defines a subset $v'(x,x')$ of $\mathfrak{J}(x,x')$.  If we replace the $U'(x)$ by smaller $U(x)$
the associated $\tau_{x,x'}$ obtained by restriction takes  values defining a set $v(x,x')\subset v'(x,x')$.

In a first step replace every $U'(x)$ by a smaller $U(x)$ with the same properties, but in addition satisfying
$$
\cl_{|\partial X|}(|U(x)|)\subset |U'(x)|.
$$
This implies $\cl_{X}(U(x))\subset U'(x)$ and the following holds true.
\begin{lemma}
Defining $\bm{U}(x,x'):=\{\phi\in \partial\bm{X}\ |\ s(\phi)\in U(x),\ t(\phi)\in U(x)\}$ the closures of the preimages in $\bm{X}$ under $\tau_{x,x'}|\bm{U}(x,x')$  of two different $[d]\neq [d']$  are disjoint.
\end{lemma}
\begin{proof}
Let  $(\phi_k),(\psi_k)$ be sequences in $\bm{U}(x,x')$ satisfying 
$$
\tau_{x,x'}'(\phi_k)=[d]\ \ \text{and}\ \  \tau_{x,x'}'(\psi_k)=[d'].
$$
Suppose further that $\phi_k\rightarrow \phi_0$ and $\psi_k\rightarrow \phi_0$ in $\bm{X}$ (which implies $\phi_0\in\partial\bm{X}$).
Then $\phi_0\in {\bf U}'(x,x')$ and define  $[d_0]:=\tau_{x,x'}'(\phi_0)$. Since $\tau_{x,x'}':\bm{U}'(x,x')\rightarrow \mathfrak{J}(x,x')$ is locally constant
it follows for large enough $k$
$$
[d]=\tau_{x,x'}'(\phi_k)=[d_0]=\tau_{x,x'}'(\psi_k)=[d'].
$$
This completes the proof.
\qed \end{proof}


In view of the lemma, replacing $\mathfrak{U}'$ by a good system of neighborhoods with smaller sets, we may assume without loss of generality  that $\mathfrak{U}'$ has this property already. It will persist when we replace
these sets by even smaller ones. Hence we have proved.
\begin{proposition}[Good Structured Version]\label{basic-data}\index{D- Good structured version}
Under the assumption of Theorem \ref{p-main-p} we can pick a structured lift $[\Lambda,\mathfrak{U}',\mathfrak{S}',\tau']$
and representative $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$ 
such that the following  property, besides {\bf (P1)-(P3)},  holds in addition.
\begin{itemize}
\item[{\bf (P4)}]\ \ \ For different $[d]\neq [d']$ in $v'(x,x')$ the closures of $\tau_{x,x'}'^{-1}([d])$ and $\tau_{x,x'}'^{-1}([d'])$ in $\bm{X}$ are disjoint.
\end{itemize}
\qed
\end{proposition}

From now on we assume that $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$ 
has, besides {\bf (P1), (P2), (P3)}  the additional property {\bf (P4)}.


\section{Extension of Correspondences}
Under the assumptions of Theorem \ref{p-main-p} we have picked a representative 
$$
(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')
$$
 of a suitable structured version
  satisfying 
{\bf (P1), (P2), (P3), (P4)}. 
In particular we have for every pair $x,x'\in\partial X$ the map
\begin{eqnarray}\label{EQNXX14}
\tau_{x,x'}':\bm{U}'(x,x')\rightarrow \mathfrak{J}(x,x'),
\end{eqnarray}
which defines a correspondence between the section structures. In this section we 
shall show first that there is a canonical extension of every $\tau_{x,x'}'$ 
to an open neighborhood $\wh{O}_{x,x'}$ of $\bm{U}'(x,x')\subset \partial\bm{X}$
in $\bm{X}$.


There exists for every $x\in\partial X$ an open neighborhood $\wt{U}'(x)\subset X$
which has the following property
\begin{itemize}
\item[{\bf (P5)}]\ \ \ \ (i)  $\wt{U}'(x)$ admits the natural action by $G_x$ and has the properness property.
\item[]\ \ \ (ii)  $\wt{U}'(x)\cap \partial X=U'(x)$.
\end{itemize}

It is clear that ${(\wt{U}'(x))}_{x\in\partial X}$ is a covering of $\partial X$ by
sets open in $X$. We define
$$
\wt{\bm{ U}}'(x,x'):=\{\phi\in \bm{X}\ |\ s(\phi)\in \wt{U}'(x),\ t(\phi)\in \wt{U}'(x')\}.
$$
The following proposition is crucial. It is the first step aiming at  extending the maps $\tau_{x,x'}':\bm{U}'(x,x')\rightarrow\mathfrak{J}(x,x')$ to open subsets in $\bm{X}$. The sets $\wt{O}_{x,x'}$ we are going to construct next are an intermediate step
in constructing the sets $\wh{O}_{x,x'}$ previously mentioned (\ref{EQNXX14}).
\begin{lemma}\label{pp-prop-pp}
Under the assumptions of Theorem \ref{p-main-p} consider a representative $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$  of a 
structured lift of $\Lambda$ having the properties {\bf (P1)--(P4)}.  Also let 
${(\wt{U}'(x))}_{x\in\partial X}$ be a covering of $\partial X$ by
sets open in $X$ satisfying {\bf (P5)}.
Then there exists for every $[d]\in v'(x,x')$ an open neighborhood $\wt{O}_{x,x',[d]}$ of $\tau_{x,x'}'^{-1}([d])$ in $\bm{X}$ satisfying the following.
\begin{itemize}
\item[{\em(1)}]\  $\wt{O}_{x,x',[d]}\subset \wt{\bm{U}}'(x,x')$ for all $[d]\in v'(x,x')$.
\item[{\em(2)}]\  $\cl_{\bm{X}}(\wt{O}_{x,x',[d]})\cap \cl_{\bm{X}}(\wt{O}_{x,x',[d']})=\emptyset$ if $[d],[d']\in v'(x,x')$ satisfy $[d]\neq [d']$.
\item[{\em(3)}]\  $h\ast \wt{O}_{x,x',[d]}\ast g=\wt{O}_{x,x',h\ast [d]\ast g}$ for $g\in G_x$ and $h\in G_{x'}$.
\item[{\em(4)}]\  Defining  $\wt{O}_{x,x'}=\bigcup_{[d]\in v'(x,x')} \wt{O}_{x,x',[d]}$ we have  $\wt{O}_{x,x'}\cap\partial\bm{ X}=\bm{U}'(x,x')$.
\end{itemize}
\end{lemma}
\begin{proof}
The sets $\tau_{x,x'}'^{-1}([d])$ for $[d]\in v'(x,x')$ have  mutually disjoint closures in $\bm{X}$, which
lie in $\partial\bm{X}$. Recalling that $\wt{U}'(x)\cap\partial X=U'(x)$ for $x\in \partial X$,  and that
$\bm{U}'(x,x')$ decomposes into the disjoint union 
$$
\bm{U}'(x,x') =\bigcup_{[d]\in v'(x,x')} \tau_{x,x'}'^{-1}([d]),
$$
we note that each $\tau_{x,x'}'^{-1}([d])$ is open and closed in $\bm{U}'(x,x')$.
Of course, $\cl_{\bm{X}}(\tau_{x,x'}'^{-1}([d]))$ is usually larger than $\tau_{x,x'}'^{-1}([d])$.

We can find open neighborhoods 
$\wt{O}'_{x,x',[d]}$ of $\tau_{x,x'}'^{-1}([d])$  in $\bm{X}$ which are contained in $\wt{\bf U}'(x,x')$ and have mutually disjoint closures in $\bm{X}$. 
These sets therefore  satisfy (1) and (2). We also have by construction
$$
\tau'^{-1}_{x,x'}([d])\subset \wt{O}'_{x,x',[d]}\cap \partial \bm{X}.
$$
On the other hand, for  $\phi\in \wt{O}'_{x,x',[d]}\cap \partial\bm{X}$ it follows that $\phi\in \bm{U}'(x,x')$ 
and $\tau_{x,x'}'(\phi)=[d]$ and therefore
$$
\tau_{x,x'}'^{-1}([d]) = \wt{O}'_{x,x',[d]}\cap\partial\bm{X}.
$$
From this and the properties of $\tau'_{x,x'}$ we deduce that for $(h,[d'],g)\in G_{x'}\times v'(x,x')\times G_x$ with $h\ast [d']\ast g=[d]$
it holds that $h\ast \wt{O}'_{x,x',[d']}\ast g$ is an open neighborhood of $\tau_{x,x'}^{-1}([d])$.
Define 
$$
\wt{O}_{x,x',[d]}:=\bigcap_{(h,[d'],g)\in G_{x'}\times v'(x,x')\times G_x,\ h\ast[d']\ast g=[d]} h\ast \wt{O}'_{x,x',[d']}\ast g
$$
Since $\wt{\bm{U}}'(x,x')$ is invariant under the bi-action this defines an open neighborhood of $\tau'^{-1}_{x,x'}([d])$ in ${\bf X}$ contained in  $\wt{\bm{U}}'(x,x')$. Again it holds
$$
\wt{O}_{x,x',[d]} \cap\partial{\bf X} =\tau'^{-1}_{x,x'}([d])\ \text{for all}\ [d]\in v'(x,x').
$$
Then $\wt{O}_{x,x',[d]}$ satisfies (1) and (2) and from the construction it follows that $h\ast\wt{O}_{x,x',[d]}\ast g= \wt{O}_{x,x',h\ast[d]\ast g}$,
so that (3) holds. Finally $\wt{O}_{x,x'}$ has obviously property (4).
\qed \end{proof}
Now we can define the sets $\wh{O}_{x,x'}$ we are interested in.
We denote by $\wh{O}_{x,x'}$\index{$\wh{O}_{x,x'}$} the union of the connected components in $\wt{O}_{x,x'}$ intersecting $\partial\bm{X}$.
This set is bi-invariant and 
\begin{eqnarray}\label{OEQNXXX}
\bm{U}'(x,x')\subset \wh{O}_{x,x'}\subset \wt{O}_{x,x'}\subset  \wt{\bm{U}}'(x,x').
\end{eqnarray}
Each  connected component in $\wh{O}_{x,x'}$ intersects $\partial\bm{X}$, which allows
us to take for $\phi\in \wh{O}_{x,x'}$ an element $\psi\in \wh{O}_{x,x'}\cap \partial\bm{X}\subset \bm{U}'(x,x')$
in the same connected component.
 We  assign to the element
$\phi$ the value $[d]_\phi=\tau_{x,x'}'(\psi)\in v'(x,x')$.  
\begin{lemma}
The map $\phi\rightarrow [d]_\phi$ is well-defined. 
\end{lemma}
\begin{proof}
Assume that $\Sigma$ is a connected component in $\wh{O}_{x,x'}$ and $\psi,\psi'\in\Sigma\cap \partial{\bm{X}}$.
Then there exist $[d],[d']$ such that $\phi\in \wt{O}_{x,x',[d]}$ and $\phi'\in \wt{O}_{x,x',[d']}$. If $[d]\neq [d']$
we know that the closures of these sets are disjoint implying that $\psi$ and $\psi'$ cannot be on the same connected component.
\qed \end{proof}
In view of this lemma we can define 
$$
\wh{O}_{x,x',[d]}=\{\phi\in \wh{O}_{x,x'},\ [d]_\phi=[d]\}, \index{$\wh{O}_{x,x',[d]}$}
$$
and the  set $\wh{O}_{x,x'}$ decomposes as disjoint union 
\begin{eqnarray}\label{req1}
\wh{O}_{x,x'}=\bigcup_{[d]\in v'(x,x')} \wh{O}_{x,x',[d]}.
\end{eqnarray}
We can extend $\tau_{x,x'}':{\bf U}'(x,x')\rightarrow \mathfrak{J}(x,x')$ in a unique way to a locally constant map
$$
\wh{\tau}_{x,x'}:\wh{O}_{x,x'}\rightarrow \mathfrak{J}(x,x'),
$$
which restricted to ${\bf U}'(x,x')$ is $\tau_{x,x'}'$. Namely we define 
\begin{eqnarray}\label{req2}
 \wh{\tau}_{x,x'}(\phi) =[d]\ \text{if}\  \phi\in \wh{O}_{x,x',[d]}.
\end{eqnarray}
We summarize the construction so far as follows.
\begin{proposition}\label{CORR13.6.12}
Under the assumptions of Theorem \ref{p-main-p} consider a representative $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$  of a 
structured lift of $\Lambda$ having the properties {\bf (P1)--(P4)}.  Also let 
${(\wt{U}'(x))}_{x\in\partial X}$ be a covering of $\partial X$ by
sets open in $X$ satisfying {\bf (P5)}. Then there exist for $x,x'\in \partial X$ open subsets $\wh{O}_{x,x'}$ of $\bm{X}$
satisfying
\begin{itemize}
\item[{\em(1)}]\ $\bm{U}'(x,x')\subset \wh{O}_{x,x'}\subset \wt{\bm{U}}'(x,x')$.
\item[{\em(2)}]\  The set $\wh{O}_{x,x'}$ is invariant under the bi-action of $(G_{x'},G_x)$.
\item{\em[(3)}]\ $\tau'_{x,x'}:\bm{U}'(x,x')\rightarrow \mathfrak{J}(x,x')$ has a unique locally constant extension 
$$
\wh{\tau}_{x,x'}:\wh{O}_{x,x'}\rightarrow \mathfrak{J}(x,x')
$$
taking the same values as $\tau_{x,x'}'$.
This extension has the additional properties
$$
\wh{\tau}_{x,x'}(g'\ast\phi\ast g) = g'\ast\wh{\tau}_{x,x'}(\phi)\ast g\ \text{for}\ g\in G_x,\ g'\in G_{x'},\ \phi\in \wh{O}_{x,x'},
$$
and
$$
\wh{\tau}_{x,x}(\Gamma(g,y)) =\tau'_{x,x}(\Gamma(g,z))
$$
for $z\in U'(x)$ and $y\in \wt{U}'(x)$.
\end{itemize}
Importantly $\wh{O}_{x,x'}$ can be written as a disjoint union 
\begin{eqnarray*}
\wh{O}_{x,x'} =\bigcup_{[d]\in v'(x,x')} \wh{O}_{x,x',[d]},
\end{eqnarray*}
with
\begin{eqnarray*}
&\wh{O}_{x,x',[d]}\cap\partial \bm{X} =\tau_{x,x'}'^{-1}([d])\subset \bm{U}'(x,x')&\\
&\tau_{x,x'}'^{-1}([d'])\cap \wh{O}_{x,x',[d]}=\emptyset\ \ \text{for}\  [d']\neq [d].&\nonumber
\end{eqnarray*}
\end{proposition}
\begin{proof}
Follows from Lemma \ref{pp-prop-pp} and the discussion thereafter.
\qed \end{proof}
\begin{remark}\label{remark14.3.4}
At this point we have constructed an extension $\wh{\tau}_{x,x'}:\wh{O}_{x,x'}\rightarrow \mathfrak{J}(x,x')$ for every choice of $x,x'\in\partial X$. Note that $\wh{O}_{x,x'}$ is not(!)  of the form 
$\wt{\bm{U}}(x,x')=\{\phi\in \bm{X}\ |\ s(\phi)\in \wt{U}(x),\ t(\phi)\in \wt{U}(x')\}$
for suitable open sets $\wt{U}(x)$ and $\wt{U}(x')$. This means that at this point $\wh{\tau}_{x,x'}$ has not the form required from a correspondence.  When we finally succeed in constructing a structurable extension $\Lambda'$ of $\Lambda$ we shall obtain a correspondence of the usual form between the local section structures. However, in general, the restriction of the data defining the structure will have little in common
with the original data coming from a structured choice over $\partial X$.  This being said they will however be related on some level. \qed
\end{remark}




Next we pick  for every $x\in \partial X$ an open neighborhood $\wt{U}(x)$ of $x$ in $X$ with the following property.
\begin{itemize}
\item[{\bf (P6)}] \ \ \ (i)  \ $\wt{U}(x)$ admits the natural $G_x$-action
and has the properness property.
\item[]\ \ \ (ii) \ $\cl_{|X|}(|\wt{U}(x)|)\subset |\wt{U}'(x)|\ \text{for} \ x\in \partial X.$
\end{itemize}

In particular it holds that
$$
\cl_X(\wt{U}(x))\subset \wt{U}'(x)\ \text{for}\ x\in \partial X.
$$
We shall write 
 $\wt{\bm{U}}(x,x')$ for $\{\phi\in\bm{X}\ |\ s(\phi)\in \wt{U}(x),\ t(\phi)\in \wt{U}(x')\}$.
 We define 
\begin{eqnarray}
&U(x):=\wt{U}(x)\cap \partial X&\\
&\bm{U}(x,x')=\{\phi\in \bm{X}\ |\ s(\phi)\in U(x),\ t(\phi)\in U(x')\}.\nonumber
\end{eqnarray}
For the following we shall rely on the data already constructed, which satisfies {\bf (P1)---(P6)}.
Together with (\ref{OEQNXXX}) the following holds for the various sets we currently consider
\begin{eqnarray}
&\bm{U}(x,x')\subset cl_{\bm{X}}(\bm{U}(x,x'))\subset \bm{U}'(x,x')\subset \wh{O}_{x,x'}\subset \wt{O}_{x,x'}\subset  \wt{\bm{U}}'(x,x')&\\
&\bm{\wt{U}}(x,x')\subset \cl_{\bm{X}}(\bm{\wt{U}}(x,x'))\subset \bm{\wt{U}}'(x,x').&\nonumber
\end{eqnarray}



The next lemma is the place where we use the paracompactness of $|X|$.
\begin{lemma}\label{Lemma2-62}
Under the assumption that $X$ is an ep-groupoid with paracompact $|X|$ 
there exists a subset $A$ of $\partial X$ and for every $a\in A$  a nonempty open subset $\wt{V}_a$ of $\wt{U}(a)$
with the following properties.
\begin{itemize}
\item[\em{(1)}]\ \  $\cl_{|X|}(|\wt{V}_a|)\subset |\wt{U}(a)|$ for all $a\in A$.
\item[\em{(2)}]\ \  $\wt{V}_a$ is invariant under the natural action of $G_a$ on $\wt{U}(a)$.
\item[\em{(3)}]\ \  ${(|\wt{V}_a|)}_{a\in A}$ is a locally finite covering of $|\partial X|$ by sets open in $|X|$.
\end{itemize}
Note that in general $a\not\in \wt{V}_a$, which is indicated by writing $\wt{V}_a$ instead of $\wt{V}(a)$.
\end{lemma}
\begin{proof}
The collection of open subsets ${(|\wt{U}(x)|)}_{x\in \partial X}$ is an open covering of $|\partial X|$ by sets open in $|X|$.
If we add $|X\setminus \partial X|$ we obtain an open covering of $|X|$.
   Using that $|X|$ is paracompact, and therefore even metrizable, we find a subordinate open, locally finite covering
${(W_a)}_{a\in X}$, where,  of course, most sets are empty. We also may assume that $\cl_{|X|}(W_a)\subset |\wt{U}(a)|$.
We denote by $A\subset \partial X$ the set indexing 
nonempty sets.   Then $\emptyset\neq \cl_{|X|}(W_a)\subset |\wt{U}(a)|$  for $a\in A$.  We define
$$
\wt{V}_a: = \wt{U}(a) \cap \pi^{-1}(W_a).
$$
  Then $\cl_{|X|}(|\wt{V}_a|)\subset | \wt{U}(a)|$ for all $a\in A$ and ${(|\wt{V}_a|)}_{a\in A}$ is a locally finite  covering of $|\partial X|$ by sets open in $|X|$.
\qed \end{proof}

We note that for $a\in A$ the  various sets are related by
\begin{eqnarray}
\emptyset\neq \wt{V}_a\subset  \cl_{X}(\wt{V}_a) \subset \wt{U}(a)\subset\cl_X(\wt{U}(a))\subset  \wt{U}'(a).
\end{eqnarray}
In view of Proposition \ref{CORR13.6.12} we also have for $x,x'\in\partial X$ open subsets $\wh{O}_{x,x'}$ of $\bm{X}$ which satisfy 
\begin{eqnarray}
\wh{O}_{x,x'}\cap\partial \bm{ X} =\bm{U}'(x,x')\subset \wh{O}_{x,x'}\subset \wt{\bm{U}}'(x,x').
\end{eqnarray}
For the next result we use the basic data  $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$ from Proposition \ref{basic-data},  the open sets ${(\wt{U}'(x))}_{x\in \partial X}$ defined 
thereafter satisfying {\bf (P5)}, and the open sets ${(\wt{U}(x))}_{x\in \partial X}$ satisfying 
{\bf (P6)}.  In addition recall  ${(|\wt{V}_a|)}_{a\in A}$ obtained in Lemma \ref{Lemma2-62} and 
\begin{eqnarray}
U(x):=\wt{U}(x)\cap \partial X\ \ \text{and}\ \  U'(x)=\wt{U}'(x)\cap \partial X.
\end{eqnarray}
  The goal in the remaining part of this section 
is to construct for $a\in A$ open subsets $\wh{V}_a\subset\wt{U}'(a)$ of $X$ with suitable properties 
such that in particular
$$
\wh{\bm{V}}_{a,a'}:=\{\phi\in\bm{X}\ |\ s(\phi)\in\wh{V}_a,\ t(\phi)\in \wh{V}_{a'}\}
$$
satisfies $\wh{\bm{V}}_{a,a'}\subset \wh{O}_{a,a'}$ for $a,a'\in A$. This implies as a consequence of Proposition \ref{CORR13.6.12} that,
in particular, the extension $\wt{\tau}_{a,a'}$ is defined on $\wh{\bm{V}}_{a,a'}$. 
We observe that with respect to Remark \ref{remark14.3.4} we are moving in the right direction.
However, we note that $\wh{V}_a$ is in general not a neighborhood of $a$, and the points $a$ 
only belong to the subset $A$ of $\partial X$, rather than allowing all the points in $\partial X$.
 



\begin{lemma}\label{hoofers}
Fixing $a\in A$, for every  $y\in U'(a)$ there exists a finite subset $o(y)\subset A$ and a $G_y$-invariant open neighborhood
$\wt{O}(y)\subset \wt{U}'(a)$ with the following properties.
\begin{itemize}
\item[\em{(1)}]\ \ The orbit set $|\wt{O}(y)|$ intersects $|\wt{V}_b|$ only if $b\in o(y)$.
\item[\em{(2)}]\ \ $g\ast \wt{O}(y) =\wt{O}(g\ast y)$ and $o(y)=o(g\ast y)$ for $g\in G_a$.
\item[\em{(3)}]\ \  For every $b\in o(y)$ it holds that 
$$
\{\phi\in {\bf X}\ |\ s(\phi)\in\wt{O}(y)\cap\wt{U}(a),\ t(\phi)\in \wt{U}(b)\}\subset \wh{O}_{a,b}.
$$
\end{itemize}
\end{lemma}
\begin{proof}
(1) Fix $a\in A$ and pick $y\in U'(a)$. Since ${(|\wt{V}_a|)}_{a\in A}$ is a locally finite  covering of $|\partial X|$ by open subsets in $|X|$
we find a finite subset $o(y)$ of $A$ so that every neighborhood of $|y|$ intersects $|\wt{V}_b|$ for $b\in o(y)$ 
and there exists a sufficiently small neighborhood intersecting these sets only. Hence we find an open neighborhood $\wt{O}(y)$
which is $G_y$-invariant and contained in $ \wt{U}'(a)$ so that (1) holds for $|\wt{O}(y)|$.  \par

\noindent (2) We define for $g\in G_x$ the set 
$\wt{O}(g\ast y):= g\ast \wt{O}(y)$.
Clearly $|\wt{O}(g\ast y)|=|\wt{O}(y)|$, and  $o(g\ast y) =o(y)$ which proves (2). 
We can take $\wt{O}(y)$ as small as we wish.\par


\noindent(3)  We would like to show that (3) can be achieved if $\wt{O}(y)$ is small enough. Here $y\in U'(a)$. Arguing indirectly we find 
  a sequence of morphisms $(\phi_k)\subset\bm{X}$ with the following properties.
  \begin{itemize}
  \item $s(\phi_k)\in \wt{U}(a)$  and  $(s(\phi_k))$ converging to $y$.
\item $t(\phi_k)\in \wt{U}(b_k)$, where $b_k\in o(y)$.
\item $\phi_k\not\in \wh{O}_{a,b_k}$.
\end{itemize}
From the  properness properties of the finitely many $\wt{U}(b_k)$ we deduce that each subsequence of $(\phi_k)$ has a convergent subsequence, where the limit
then satisfies $s(\phi_0)=y\in \cl_X(U(a))$ and $t(\phi_0)\in \cl_X(U(b))$ for some $b\in o(y)$. 
Hence $\phi_0\in \bm{U}'(a,b)$ and therefore $\phi_0\in \wh{O}_{a,b}$. This contradiction implies that for $k$ large we must have that 
$\phi_k\in \bigcup_{b\in o(y)} \wh{O}_{a,b}$. Hence for $\wt{O}(y)$ sufficiently small (3) holds. Taking $\wt{O}(y)$ even smaller
the same must hold for the finitely many $\wt{O}(g\ast y)$.
\qed \end{proof}
We define for $a\in A$ the open subset $\wh{V}_a$ of $X$ by
\begin{eqnarray}
\wh{V}_a =\left(\bigcup_{y\in U'(a)} \wt{O}(y)\right)\cap  \wt{V}_a.
\end{eqnarray}
The collection of open sets ${(\wh{V}_a)}_{a\in A}$  has the following properties.
\begin{proposition}\label{important-xx}
\begin{itemize}
\item[\em{(1)}]\ \ For $a\in A$ the open subset $\wh{V}_a$ of $X$ is $G_a$-invariant and contained in $\wt{V}_a\subset \wt{U}(a)$
\item[\em{(2)}]\ \ $\wh{V}_a\cap \partial X= \wt{V}_a\cap \partial X$ for $a\in A$.
\item[\em{(3)}]\ \ The collection ${(|\wh{V}_a|)}_{a\in A}$ is a locally finite covering of $|\partial X|$ by subsets open in $|X|$.
\item[\em{(4)}]\ \ Defining for $a,a'\in A$ the sets 
$$
\wh{\bm{V}}_{a,a'}:=\{\phi\in {\bm{X}}\ |\ s(\phi)\in \wh{V}_a,\ t(\phi)\in \wh{V}_{a'}\}
$$
 it holds that
$$
\wh{\bm{V}}_{a,a'}\subset \wh{O}_{a,a'}\ \text{for}\ a,a'\in A. 
$$
In particular we can restrict the locally constant map
$\wh{\tau}_{a,a'}:\wh{O}_{a,a'}\rightarrow \mathfrak{J}(a,a')$ to $\wh{\bm{ V}}_{a,a'}$.
\end{itemize}
\end{proposition}
\begin{proof}
By construction $\wh{V}_a$ is open, $G_a$-invariant, and contained in $\wt{V}_a$. This implies (1).\par

Point (2) follows since by construction $\bigcup_{y\in U'(x)} \wt{O}(y)$ contains $\wt{V}_a\cap \partial X$. Hence 
$$
\wh{V}_a\cap \partial X=\partial X\cap \left(\left(\bigcup_{y\in U'(a)} \wt{O}(y)\right)\cap  \wt{V}_a\right)= \wt{V}_a\cap\partial X.
$$
The collection ${(|\wh{V}_a|)}_{a\in A}$ is an open covering of $\partial X$. Since $\wh{V}_a\subset \wt{V}_a$ for $a\in A$
it is in addition locally finite. This gives (3). \par

Point (4)  holds by construction of the sets $\wh{V}_a$ for $a\in A$, see specifically Lemma \ref{hoofers} (3).   With $a,a'\in A$ 
assume that $\phi\in \wh{\bm{V}}_{a,a'}$.  By construction $\wh{V}_a\subset \wt{U}(a)$ and there exists $y\in U'(x)$
such that $s(\phi)\in \wt{O}(y)$. By Lemma \ref{hoofers} (1)  and (3) we must have that $t(\phi) \in \wt{V}_b$ for some 
$b\in o(y)$. Since $\wh{V}_b\subset \wt{V}_b$ we conclude that $a'\in o(y)$ and $\phi\in \wh{O}_{a,a'}$.
\qed \end{proof}
At this point we have constructed for $a\in A$ open subsets $\wh{V}_a$ of $X$ so that
\begin{eqnarray}
\wh{V}_a\subset \wt{V}_a\subset\cl_X(\wt{V}_a)\subset \wt{U}(a)\ \text{for}\ a\in A,
\end{eqnarray}
and
\begin{eqnarray}
|\partial X|  =\bigcup_{a\in A} |\wh{V}_a|.
\end{eqnarray}
Moreover ${(|\wh{V}_a|)}_{a\in A}$ is a locally finite covering of $|\partial X|$ by sets open in $|X|$.
In addition, for $a,a'\in A$ it holds
\begin{eqnarray}
\wh{\bm{V}}_{a,a'}=\{\phi\in \bm{X}\ |\ s(\phi)\in \wh{V}_a,\ t(\phi)\in \wh{V}_{a'}\}\subset \wh{O}_{a,a'},
\end{eqnarray}
so that $\wh{\tau}_{a,a'}$ defines a map 
\begin{eqnarray}
\wh{\tau}_{a,a'}|\wh{\bm{ V}}_{a,a'}: \wh{\bm{ V}}_{a,a'}\rightarrow \mathfrak{J}(a,a').
\end{eqnarray}
Define for $a\in A$ the open subset $V_a$ of $U(a)$ by 
\begin{eqnarray}\label{LLLX1}
V_a =U(a)\cap  \wh{V}_a =U(a)\cap \wt{V}_a
\end{eqnarray}
and note that
\begin{eqnarray}\label{LLLX2}
\cl_{|X|}(|V_a|)\subset |U(a)|.
\end{eqnarray}
Recall also that
$$
U(a)=\partial X\cap \wt{U}(a).
$$
The data we have constructed will be used in the next section.


\section{Implicit Structures and Local Extension}
The set-up is again as described in Theorem \ref{p-main-p} and we assume we have
taken a representative $(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$ satisfying 
{\bf (P1)--(P4)}.  Also let 
${(\wt{U}'(x))}_{x\in\partial X}$ be a covering of $\partial X$ by
sets open in $X$ satisfying {\bf (P5)}, and let ${(\wt{U}(x))}_{x\in\partial X}$ 
satisfy {\bf (P6)}.
We start this section with an important remark.
\begin{remark}\label{I_REMARK}\index{R- Important remark about correspondences}
For the following part of the construction it is {\bf important (!)} to be aware 
of a subtlety, 
which might not be apparent at first sight. For $x,x'\in\partial X$ the maps $\tau'_{x,x'}:{\bf U}'(x,x')\rightarrow \mathfrak{J}(x,x')$, 
 define correspondences between different sc$^+$-section structures.  It is crucial to note 
 that in general the symmetric sc$^+$-section structure 
${(s'^x_i)}_{i\in I_x}$ might implicitly have additional properties over certain subsets of $U'(x)$, which have to be taken into account
to define a structurable extension. For example assume that 
we have morphisms $\psi,\phi,\sigma\in \partial \bm{X}$ so that $s(\psi)=s(\phi)$ and $s(\sigma)=t(\psi)$ and $t(\sigma) = t(\phi)$
so that in addition 
$$
\sigma\circ \psi=\phi,
$$
where $s(\psi), s(\phi)\in U'(x)$, $t(\psi)\in U'(x')$, and $t(\phi)\in U'(x'')$. 
Associated to these three morphisms there are correspondences $\tau'_{x,x'}(\psi)$, $\tau'_{x,x''}(\phi)$, and $\tau'_{x',x''}(\sigma)$. Assume they are represented by the diagrams
$$
I_{x}\stackrel{\alpha}{\twoheadleftarrow} I\stackrel{\beta}{\twoheadrightarrow} I_{x'},\ 
I_{x}\stackrel{\alpha'}{\twoheadleftarrow} I'\stackrel{\beta'}{\twoheadrightarrow} I_{x''},\ \text{and}\ 
I_{x'}\stackrel{\alpha''}{\twoheadleftarrow} I''\stackrel{\beta''}{\twoheadrightarrow} I_{x''}.
$$
It may happen that for $i_1\not\in G_x(i_2)$, where $i_1,i_2\in I_{x}$,  there exist $k\in I, k'\in I', k''\in I''$ such that
$$
i_1 =\alpha(k),\ \beta(k)=\alpha''(k''),\ \beta''(k'') =\beta'(k'),\ \alpha'(k') =i_2.
$$
This forces the equality $s_{i_1}^x(y)=s_{i_2}^x(y)$ for $y\in U'(x)$ near $s(\psi)$. So the global structure described by $\tau'$
forces  additional local conditions. The constructions needed to prove an extension theorem for a structurable sc$^+$-multisection functor has to accommodate this fact. As preparation we introduce some additional structures to keep track of the implicit conditions.
\qed
\end{remark}
In view of this important remark we shall capture the relevant local information from  the global structure 
provided by $\tau'$. As it turns out we only need to study  for most parts 
\begin{eqnarray*}
\left\{\wh{\tau}_{x,x'}:\wh{O}_{x,x'}\rightarrow \mathfrak{J}(x,x')\right\}_{(x,x')\in A\times A}\ \text{and}\ \left\{ \wh{V}_a\right\}_{a\in A}.
\end{eqnarray*}
Recall that 
\begin{eqnarray*}
\cl_X(\wh{V}_a)\subset \wt{U}(a)\ \text{for}\ x\in A, \text{and}\ \wh{V}_a\cap\partial X=V_a,\ a\in A,
\end{eqnarray*}
and according to Proposition \ref{important-xx} with $\wh{\bm{V}}_{a,a'}:=\{\phi\in\bm{X}\ |\ s(\phi)\in \wh{V}_a,\ t(\phi)\in \wh{V}_{a'}\}$ it holds that
$$
\wh{\bm{V}}_{a,a'}\subset \wh{O}_{a,a'}\ \ \text{for}\ \  a,a'\in A.
$$
The following definitions are needed to address the issues raised in Remark \ref{I_REMARK}.
\begin{definition}\index{D- $z$-loop}
 Fix $a\in A$ and 
and let $z\in \wh{V}_a$. A $z$-{\bf loop (for $a$)} of morphisms is given by the following data.
\begin{itemize}
\item[(1)]\   A finite sequence $a_0,...,a_n$ in $A$ satisfying $a_0=a=a_n$.
\item[(2)]\  Morphisms $\phi_0,...,\phi_{n-1}$ with the properties
\begin{itemize}
\item[(a)]\  $t(\phi_j)=s(\phi_{j+1})$ for $j=0,..,n-2$, $s(\phi_0)=z=t(\phi_{n-1})$.
\item[(b)]\  $s(\phi_j)\in \wh{V}_{a_j}$ and $t(\phi_j)\in \wh{V}_{a_{j+1}}$ for $j=0,..,n-1$.
\item[(c)]\  $1_z=\phi_{n-1}\circ..\circ \phi_0$.
\end{itemize}
\end{itemize}
\qed
\end{definition}
Given a $z$-loop $\phi_0,..,\phi_{n-1}$ we note that $\phi_j\in \wh{\bm{V}}_{a_j,a_{j+1}}$.
Consequently we  can consider $\wh{\tau}_{a_j,a_{j+1}}(\phi_j)$ for $j=0,..,n-1$, where the latter are represented by diagrams
$$
I_{a_j}\stackrel{\alpha_j}{\twoheadleftarrow} I_j\stackrel{\beta_j}{\twoheadrightarrow} I_{a_{j+1}}.
$$

\begin{definition}\index{D- $z$-arc}
Fix $a\in A$ and pick $z\in \wh{V}_a$.
A {\bf $z$-arc (for $a$)} associated to the $z$-loop consists of  a sequence of indices $(i_0,i_1,...,i_n)$ satisfying
\begin{itemize}
\item[(1)]\  $i_j\in I_{a_j}$ for $j\in \{0,..,n\}$.
\item[(2)]\   $(i_j,i_{j+1})=(\alpha_j(k_j),\beta_j(k_j))$ for $j\in \{0,...,k-1\}$ and suitable $k_j\in I_j$.
\end{itemize}
\qed
\end{definition}
Note that $i_0,i_n\in I_a$. In general they do not need to be the same and one might view $i_n$ as the `index holonomy' 
of $i_0$ along the $z$-loop. However,  this `holonomy' is not unique, since even using the same $z$-loop and starting with  the same $i_0$,
possible different choices of the $ k_j$ might lead to different endpoints.
\begin{definition}\index{D- $z$-equivalent}
Fix $a\in A$ and 
let $z\in \wh{V}_a$ and $i,i'\in I_a$. We say that $i$ and $i'$ are {\bf $z$-equivalent (for $a$)} if there exists a $z$-arc with
$i_0=i$ and $i_n=i'$.  In this case we  shall write $i\sim_z i'$.
\qed
\end{definition}
We shall denote the $\sim_z$-equivalence class of some index $i\in I_a$ by $[i]^{\sim_z}$,
where
$$
[i]^{\sim_z}:=\{i'\in I_a\ |\ i'\sim_z i\}.
$$
The equivalence relations $\sim_z$ have the following  properties summarized in two results.
The first statement is essentially obvious.
\begin{lemma}
Let $a\in A$ and assume  that $z\in \wh{V}_a$,   $i,i'\in I_a$, and $g\in G_a$. Then 
$i\sim_z i'\ \text{if and only if}\   g(i)\sim_{g\ast z} g(i')$. In particular
$$
[g(i)]^{\sim_{g\ast z}} = g([i]^{\sim_z})\ \ \text{for}\ \ i\in I_a,\ g\in G_a,\ z\in \wh{V}_a.
$$
\end{lemma}
\begin{proof}
If $i\sim_z i'$ there exists a $z$-loop relating $i$ with $i'$. Denote the morphisms in the loop by
$$
\phi_0,...,\phi_{n-1}.
$$
Then $\Gamma(g^{-1},g\ast z),\phi_0,...,\phi_{n-1},\Gamma(g,z)$ is a $g\ast z$-loop and it relates the indices $g(i)$ and $g(i')$. Hence 
$g(i)\sim_{g\ast z} g(i')$. That $g(i)\sim_{g\ast z} g(i')$ implies $i\sim_z i'$ follows similarly.
\qed \end{proof}


\begin{proposition} \label{approx}
The equivalence relations $\sim_z$, $z\in \wh{V}_a$, on $I_a$  have the following properties.
\begin{itemize}
\item[\em{(1)}]\  Let  $z_0\in \wh{V}_{a}$ and $i,i'\in I_a$.   If $i\sim_{z_0} i'$ the same holds for all
$z\in \wh{V}_a$  close to $z_0$.
\item[\em{(2)}]\   If $i,i'\in I_a$ and $(z_k)\subset  V_a$  is a sequence for which $i\sim_{z_k} i'$ and
$z_k\rightarrow z_0\in \cl_X(V_a)$, then there exists an open neighborhood $Q(z_0)\subset U(a)$
for which $s'^a_i(y)=s'^a_{i'}(y)$ if $y\in Q(z_0)$.
\end{itemize}
\end{proposition}
We note that (2) is a particularly important observation.   The proof needs some preparation and the following lemma will be important.
  \begin{lemma}\label{L14.3.7}
 Denote by $X$ an ep-groupoid and  let $x_1,...,x_\ell$ be a finite collection of isomorphic objects. Given open neighborhoods $Q(x_i)$ in $X$ there exist open neighborhoods
  $O(x_i)\subset Q(x_i)$ with the following properties.
  \begin{itemize}
  \item[\em{(1)}]\  Each $O(x_i)$ is equipped with the natural $G_{x_i}$-action.
  \item[\em{(2)}] \ For every morphism $\psi:x_i\rightarrow x_j$ there exists an open neighborhood $W(\psi)$ 
  such that $s:W(\psi)\rightarrow O(x_i)$ and $t:W(\psi)\rightarrow O(x_j)$ are sc-diffeomorphisms. 
  \item[\em{(3)}]\ For $\psi:x_i\rightarrow x_j$ and $\phi:x_j\rightarrow x_k$ the map $m:W(\phi){_{s}\times_t}W(\psi)\rightarrow \bm{X}:(\phi',\psi')\rightarrow \phi'\circ \psi'$
  defines an sc-diffeomorphism onto $W(\phi\circ\psi)$.
  \end{itemize}
   \end{lemma}
\begin{proof}
We prove this result by induction with the respect to the cardinality of the set of isomorphic objects.
The statement for one object is equivalent to the existence of arbitrarily small neighborhoods
with the natural action. Assume we are given isomorphic objects $x_1,...,x_{\ell+1}$. By induction hypothesis 
we find $O'(x_i)$ for $i=1,...,\ell$ with the natural $G_{x_i}$-action, and for every morphism $\psi:x_i\rightarrow x_j$ between these objects an open neighborhood $W(\psi)$ such that $s:W(\psi)\rightarrow O'(x_i)$ and 
$t:W(\psi)\rightarrow O'(x_j)$ are sc-diffeomorphisms, so that (3) holds.  Add the point $x_{\ell+1}$
to our considerations. We pick for every $i=1,..,\ell$ a morphism starting at $x_{\ell+1}$ and ending at $x_i$
$$
\psi_i:x_{\ell+1}\rightarrow x_i.
$$
Associated to $\psi_i$ we have a local sc-diffeomorphism $\wh{\psi}_i$. It is obtained in the usual way  as
$\wh{\psi}_i= t\circ (s|W(\psi_i))^{-1}$, where $W(\psi_i)$ is a suitable open neighborhood so that $s:W(\psi_i)\rightarrow O(x_{\ell+1})$ and $t:W(\psi_i)\rightarrow O(x_i)$ are sc-diffeomorphisms.
We pick $O(x_{\ell+1})$
admitting the $G_{x_{\ell+1}}$-action and so small that $\wh{\psi}_i(O(x_{\ell+1}))\subset O'(x_i)$
and $\wh{\psi}_i:O(x_{\ell+1})\rightarrow \wh{\psi}_{i}(O(x_{\ell+1}))$ is an sc-diffeomorphism.
Define $O(x_i)= \wh{\psi}_{i}(O(x_{\ell+1}))$. 
For $g\in G_{x_{\ell+1}}$ we define $W(g)= \Gamma(g,O(x_{\ell+1}))$, and for  $\psi:x_{\ell+1}\rightarrow x_i$
we define $W(\psi)$  as follows, where we use the unique decomposition $\psi=\psi_i\circ g$ for some $g\in G_{x_{\ell+1}}$.
$$
W(\psi)=\{ (s|W(\psi_i))^{-1}(g\ast z)\circ\Gamma(g,z)\ |\ z\in O(x_{\ell+1})\}.
$$
Let us show that the new set of data is the desired construction associated to the isomorphic objects 
$x_1,..,x_{\ell+1}$.

First we consider $s:W(\psi)\rightarrow O(x_{\ell+1})$ for a $\psi:x_{\ell+1}\rightarrow x_i$.
It follows immediately from the construction that $s$ is an sc-diffeomorphism. Similarly
$t:W(\psi)\rightarrow O(x_i)$ takes the form 
$$
t(\sigma) =\wh{\psi}_i(g\ast s(\sigma))
$$
which implies that $t$ is an sc-diffeomorphism.  This completes the proof of (2).

In order to verify (3) assume that $\psi:x_{\ell+1}\rightarrow x_i$ and $\phi:x_i\rightarrow x_j$.
Consider  
$$
W(\phi){_{s}\times_t} W(\psi)\rightarrow W(\phi\circ\psi).
$$
We first construct an sc-smooth map
$\Delta: W(\psi)\rightarrow W(\phi){_{s}\times_t} W(\psi)$ by
$$
\sigma \rightarrow ((s|W(\phi))^{-1}(t(\sigma)), \sigma)
$$
This map is an sc-diffeomorphism with inverse being the projection onto $W(\psi)$. 
We also note that 
$$
\delta: W(\psi)\rightarrow W(\phi\circ\psi) :\sigma\rightarrow ((s|W(\phi))^{-1}(t(\sigma)))\circ  \sigma)
$$
 is an sc-diffeomorphism
onto $W(\phi\circ \psi)$. Since $m\circ \Delta =\delta$ the result follows.
\qed \end{proof}
\begin{proof}[Proposition \ref{approx}]
(1) For $z_0\in \wh{V}_a\subset \wt{U}(a)$ there exists an open neighborhood of $|z_0|$ only intersecting finitely many $|\cl_X(\wh{V}_y)|$, $y\in A$.
Denote the corresponding $y$ by $a_1,...,a_\ell$. We may assume that $a_1=a$.
A morphism $\psi$ starting 
in $\wh{V}_a$ near $z_0$ and ending in one of the $\wh{V}_y$, $y\in A$,  has to end in one of the $\wh{V}_y$ with $y\in \{a_1,..,a_\ell\}$.
In each of the $\wh{V}_{a_i}$ there can be only a finite number of points which can be reached from $z_0$. 
Denote the collection of all these points, where we vary over the $a_1,...,a_\ell$   by $x_1,...,x_b$, and note that they are all isomorphic. 
Take a $z_0$-loop of morphisms starting and ending at $z_0$ so that the composition is $1_{z_0}$ and the corresponding
$z_0$-arc starts at $i$ and connects it with $i'$. As a consequence of Lemma \ref{L14.3.7}, when slightly moving $z_0$ to $z$ 
the morphisms deform to a $z$-loop and since the $\tau_{a,a'}'$ are locally constant we infer that $i\sim_z i'$.\par

Before we prove (2) we need the following consideration which already was discussed in Lemma \ref{simple_lemma}. Recall from (\ref{LLLX1}) and (\ref{LLLX2}) that $V_a\subset U(a)$ and $\cl_{|X|}(|V_a|)\subset |U(a)|$. In addition $U(a)$
is a good open neighborhood of $a$ in the sense of Definition \ref{DEF_good_open} and it has 
properness property,  which means that $t:s^{-1}(\cl_X(U(a)))\rightarrow X$ is a proper map.
The lemma then asserts 
that $\cl_X(V_a)\subset U(a)$.\par

(2)  In order to prove (2) we pick $z_0\in \cl_X(V_a)$ and with the help
of Lemma \ref{L14.3.7}, brought into the right context,
 we can argue in a similar fashion as before.
 For the point  $z_0\in \cl_X(V_a)$ consider all objects which belong to some $\cl_X(V_b)$, $b\in A$,
and which are isomorphic to $z_0$. We note that there are only finitely many such objects
due to the fact that $(|V_b|)$ is a locally finite covering of $|\partial X|$ and $V_a\subset U(a)$,
and $U(a)$ has the properness property.
Denote these objects (including $z_0)$ by $x_1=z_0,...,x_\ell$ and apply Lemma \ref{L14.3.7}.

Assume that $(z_k)\subset V_a$, $z_k\rightarrow z_0$, and there exists a $z_k$-loop 
with an associated $z_k$-arc relating $i$ and $i'$ such that $i\sim_{z_k} i'$.  If $z_k$ is close enough
to $z_0$ it follows that the occurring morphisms for $z_k$ lie in the $W(\phi)$ for suitable 
$\phi$ as given in Lemma \ref{L14.3.7}. We may assume, starting with sufficiently small $O(x_i)$
that $\tau'_{x_i,x_j}$ is constant on the associated $W(\phi)$. Just taking $k$ large enough  we can take
a loop of morphisms 
starting and ending at $z_0$ and composing to $1_{z_0}$ (having the same combinatorial structure as the $z_k$-loop) so that the index $i$ is related to the index $i'$. This implies  for a suitable open neighborhood $Q(z_0)$,
 that $s'^a_i(y)=s'^a_{i'}(y)$ for $y\in Q(z_0)$. The proof is complete.
\qed \end{proof}

In next step we define a new equivalence relation $\approx_z$ for points  $z\in \cl_X(\wh{V}_a)$.
\begin{definition}\index{$\Theta_z$}
For $a\in A$ and $z\in \cl_X(\wh{V}_a)$
we define the set $\Theta_z$   to consist of all
$(i,i')\in I_a\times I_a$ such that there exists 
$(z_k)\subset \wh{V}_a$ with $i\sim_{z_k} i'$ and $z_k\rightarrow z$. 
We define $i\approx_z i'$\index{$\approx_z$}  provided there exist $i_0,...,i_k\in I_a$  with $(i_p,i_{p+1})\in \Theta_z$ for
$p=0,..,k-1$, and $i_0=i$, $i_p=i'$.
\qed
\end{definition}

It is clear that for $z\in \wh{V}_a$ the equivalence $i\sim_z i'$ implies $i\approx_z i'$.  
Moreover, if $z\in \cl_X(V_a)=\cl_{\partial X}(V_a)$, and $i\approx_z i'$ it follows that $s'^a_i(y)=s'^a_{i'}(y)$ for $y\in Q(z)$, where $Q(z)$ is an open neighborhood
in $\partial X$ contained in $U(z)$, see Proposition \ref{approx} (2).

For the issue discussed in Remark \ref{I_REMARK} the equivalence relation $\sim_z$ encapsulates the requirements.
However, the equivalence relation $\approx_z$ is more convenient for the necessary constructions.
We shall define for given $i\in I_a$ and $z\in \cl_X(\wh{V}_a)$
$$
 [i]^{\approx_z}= \{i'\in I_a\ |\ i'\approx_z i\}.
$$
\begin{lemma}\label{true-y}\index{L- Properties of $\sim_z$ and $\approx_z$}
The following holds true.
\begin{itemize}
\item[\em{(1)}]\  If $i\sim_z i'$ for $z\in\wh{V}_a$, then $i\approx_z i'$.
\item[\em{(2)}]\  If $z\in \cl_X(\wh{V}_a)$ and $g\in G_a$ then $i\approx_z i'$ implies $g(i)\approx_{g\ast z} g(i')$. In particular
$g([i]^{\approx_z})= [g(i)]^{\approx_{g(z)}}$.
\item[\em{(3)}]\   If $z\in \cl_X({V}_a)$ and $i\approx_z i'$ then $s'^{a}_{i}(y)=s'^{a}_{i'}(y)$ for $y\in {U}(a)$ close to $z$.
\item[\em{(4)}]\  With  $i\in I_a$ and  $z_0\in \cl_X(\wh{V}_a)$ there exists an open neighborhood
$\wt{Q}(z_0)$ in $\wt{U}(a)$ so that $[i]^{\sim_z}\subset [i]^{\approx_{z_0}}$ for all $z\in \wh{V}_a\cap \wt{Q}(z_0)$.
\end{itemize}
\end{lemma}
\begin{proof}
(1) and (2) are trivial, and  (3) follows from Proposition  \ref{approx} (2). 
For the  proof of (4) we argue indirectly.  Let  $z_0\in \cl_X(\wh{V}_a)$ and $i\in I_a$.
 Assume there exists
a sequence $(z_k)\subset \wh{V}_a$ satisfying $z_k\rightarrow z_0$ and $i_0\in I_a$ satisfying
$i_0\not\in [i]^{\approx_{z_0}}$ and $i\sim_{z_k} i_0$. Then by definition $i\approx_{z_0} i_0$ implying that
$i_0\in [i]^{\approx_{z_0}}$ giving a contradiction.
\qed \end{proof}


The previous discussion allows us to define open neighborhoods around the points $z\in \cl_X(\wh{V}_a)$ 
with suitable properties, which is accomplished in the next proposition. Recall that for $a\in A$ it holds
that $\cl_X(\wh{V}_a)\subset \wt{U}(a)$.
\begin{proposition}\label{neighbor}
Fix $a\in A$. Then there exists for every $z\in \cl_X(\wh{V}_a)$ an open neighborhood $\wt{\mathsf{O}}(z)$ with the following properties.
\begin{itemize}
\item[\em{(1)}]\ \ $\wt{\mathsf{O}}(z)\subset \wt{U}(a)$.
\item[\em{(2)}]\ \ $\wt{\mathsf{O}}(g\ast z)=g\ast \wt{\mathsf{O}}(z)$ for $g\in G_a$ and $\wt{\mathsf{O}}(z)\cap \wt{\mathsf{O}}(g\ast z)=\emptyset$ if $z\neq g\ast z$.
\item[\em{(3)}] \ \ If $z\in \cl_X(\wh{V}_a)$ and $i\in I_a$  then $[i]^{\sim_y}\subset [i]^{\approx_z}$ for $y\in \wt{\mathsf{O}}(z)\cap \wh{V}_a$.
\item[\em{(4)}]\ \ If $z\in \cl_X(V_a)$ it holds $s_i'^a(y)=s_{i'}'^a(y)$ for $i\approx_z i'$ and $y\in \wt{\mathsf{O}}(z)\cap U(a)$.
\end{itemize}
\end{proposition}
\begin{proof}
This is an immediate consequence of the previous discussion, particularly Lemma \ref{true-y}.
\qed \end{proof} 

The proposition prompts the following definition.
\begin{definition}\label{GOODNEI}
A {\bf good neighborhood system} for $\cl_X(\wh{V}_a)\subset \wt{U}(a)$ is given by a family 
$$
{ \left(\wt{\mathsf{O}}(z)\right)}_{z\in \cl_X(\wh{V}_a)}
$$
of open (in $X$) neighborhoods  with the following properties. 
\begin{itemize}
\item[(1)]\ \  $\wt{\mathsf{O}}(z)\subset \wt{U}(a)$.
\item[(2)]\ \ $\wt{\mathsf{O}}(g\ast z)=g\ast \wt{\mathsf{O}}(z)$ for $g\in G_a$ and $\wt{\mathsf{O}}(z)\cap \wt{\mathsf{O}}(g\ast z)=\emptyset$ if $z\neq g\ast z$.
\item[(3)]\ \ If $z\in \wh{V}_a$ and $i\in I_a$  then $[i]^{\sim_y}\subset [i]^{\approx_z}$ for $y\in \wt{\mathsf{O}}(z)\cap \wh{V}_a$.
\item[(4)]\ \ If $z\in \cl_X(V_a)$ it holds  $s_i'^a(y)=s_{i'}'^a(y)$ for $i\approx_z i'$ and $y\in \wt{\mathsf{O}}(z)\cap U(a)$.
\end{itemize}
\qed
\end{definition}
\begin{remark}
The good neighborhood system captures part of the  implicit information of having a system of correspondences.
Note that the initial choice of ${(V_a)}_{a\in A}$ and the extensions $\wt{V}_a,a\in A$ are important. The existence of such a collection
$(V_a)$ is a consequence of the assumption that $|X|$ is  paracompact.
\qed
\end{remark}
We shall use the previous discussion to define suitable local extensions of some of the local section structures, which are compatible 
with the implicit relations. They will be used later on for the proof of the global extension theorem.

The following constructions are concerned with the $\mathfrak{s}'_a$, $a\in A$,
$$
\mathfrak{s}_a' ={(s^a_i)}_{i\in I_a},
$$
where $s^a_i$ is an sc$^+$-section of $W|U'(a)$.  Recall that 
\begin{eqnarray*}
&\wh{V}_a\subset\cl_{X}(\wh{V}_a)\subset  \wt{U}(a)\subset \wt{U}'(a).
&
\end{eqnarray*}
 Note that $\Lambda$ 
is as an sc$^+$-multisection (without the structuring) completely determined by the collection
of all $\mathfrak{s}_a'$, where $a$ varies in $A$. This is, of course, the case since the collection
$(|V_a|)_{a\in A}$ covers $|\partial X|$, where $V_a=\wh{V}_a\cap\partial X$. 

For the further constructions we shall need extensions of the $s^a_i$ to $\wh{V}_a$ having suitable properties.
The following discussion prepares the construction of such extensions.  Let $z\in \cl_X(\wh{V}_a)\cap \partial X$
and denote by $[z]$ its orbit under the $G_a$-action.
We observe that $I_a$ has different decompositions 
into equivalence classes associated to the different elements $z'\in [z]$ defined by $\approx_{z'}$. 
Fix a $z'\in [z]$ and denote by ${[i_1]}^{\approx_{z'}},...,{[i_k]}^{\approx_{z'}}$ the associated different equivalence 
classes of $I_a$. If we take $z''\in [z]$ and $g\in G_a$ with $g\ast z'=z''$ then 
the collection 
$$
g({[i_j]}^{\approx{z'}}):=\{ g(i)\ |\ i\in {[i_1]}^{\approx{z'}}\}
$$
where $j=1,...,k$ is the set of $\approx_{z''}$ equivalence classes. With other words
$g({[i_j]}^{\approx_{z'}})= {[g(i_j)]}^{\approx_{z''}}$ and 
${[g(i_1)]}^{\approx_{z''}},...,{[g(i_k)]}^{\approx_{z''}}$ are the $\approx_{z''}$-equivalence classes.
Taking a different $g'$ with $g'\ast z'=z''$ only gives a different presentation of these equivalence classes.




\begin{lemma}\label{LEMMX14413}
For fixed $a\in A$ and $z\in \cl_X(\wh{V}_a)\cap \partial X$ define $\wt{\mathsf{O}}([z])$ as the union of all
$\wt{\mathsf{O}}(z')$ with $z'\in [z]$, where $[z]$ is the $G_a$-orbit of $z$.  Fix $z'\in [z]$ 
and let $G_a(z')=\{g\in G_a\ |\ g\ast z'=z'\}$. For $I_a$ let ${[i_1]}^{\approx_{z'}},.., {[i_k]}^{\approx_{z'}}$
be the decomposition of $I_a$ into $\approx_{z'}$-equivalence classes
$$
I_a = {[i_1]}^{\approx_{z'}}\sqcup ......\sqcup {[i_k]}^{\approx_{z'}}.
$$
Then the following holds.
\begin{itemize}
\item[\em{(1)}]\ The action of $G_a(z')$ on $I_a$ preserves the decomposition into the equivalence classes assocoiated
to $\approx_{z'}$.
\item[\em{(2)}]\  For an element $ {[i_j]}^{\approx_{z'}}$ and an element $g$ in the subgroup of $G_a(z')$ consisting of elements 
fixing ${[i_j]}^{\approx_{z'}}$ it holds
$$
s_{i_j}'^a(g\ast y)=\mu(\Gamma(g,y),s_{i_j}'^a(y))\ \ \text{for}\ \  y\in \wt{\mathsf{O}}(z')\cap\partial X,
$$
where we recall that   $s_{i'}'^a(y)=s_{i_j}'^a(y)$ for $y\in \wt{\mathsf{O}}(z')\cap\partial X$ and $i'\in {[i_j]}^{\approx_{z'}}$.
\item[\em{(3)}]\  If for some $g\in G_a(z')$ it holds that $g( {[i_j]}^{\approx_{z'}} )   \neq  [i_j]^{\approx_{z'}}$, which means that these
sets are in fact disjoint, then $g( {[i_j]}^{\approx_{z'}} )= {[g(i_j)]}^{\approx_{z'}}$ and
$$
s_{g(i_j)}'^a(g\ast y) = \mu(\Gamma(g,y), s_{i_j}'^a(y))\ \ \text{for}\ \ y\in \wt{\mathsf{O}}(z')\cap\partial X,
$$
where we recall that   $s_{i'}'^a(y)=s_{i_j}'^a(y)$ for $y\in \wt{\mathsf{O}}(z')\cap\partial X$ and $i'\in {[i_j]}^{\approx_{z'}}$.
\item[\em{(4)}]\  For $z''\in [z]$ different from $z'$ the sections over $\wt{\mathsf{O}}(z'')\cap \partial X$ are determined completely
by the sections over $\wt{\mathsf{O}}(z')\cap \partial X$.
\end{itemize}
\end{lemma}
\begin{proof} (1)  In view of Lemma \ref{true-y} the equivalence $i\approx_z i'$ implies the equivalence
$g(i)\approx_{g(z)} g(i')$ for every $g\in G_a$.  Assuming next that $g\in G_a(z')$ and 
 $i\in {[i_j]}^{\approx{z'}}$ the fact that $g(i) \in {[i_j]}^{\approx{z'}}$ implies $g({[i_j]}^{\approx{z'}})= {[i_j]}^{\approx{z'}}$
 If $g(i)\not\in {[i_j]}^{\approx{z'}}$ the image of ${[i_j}|^{\approx{z'}}$ must be disjoint.\par
 
 \noindent(2)  Assuming that $g\in G_a(z')$ and $g({[i_j]}^{\approx{z'}})= {[i_j]}^{\approx{z'}}$ we compute
 since for $i,i'\in [i_j]$ the associated sections coincide of $\wt{\mathsf{O}}(z)\cap \partial X$
 \begin{eqnarray*}
 s_{i_j}'^a(g\ast y) &=& s_{g(i_j)}'^a(g\ast y)\\
 &=&\mu(\Gamma(g,y),s_{i_j}'^a(y))
 \end{eqnarray*}
 for $y\in \wt{\mathsf{O}}(z)\cap \partial X$.\par
 
 \noindent(3) Assume that $g( {[i_j]}^{\approx_{z'}} )   \neq  [i_j]^{\approx_{z'}}$.  Then 
 \begin{eqnarray*}
 s_{g(i_j)}'^a(g\ast y)&=& \mu(\Gamma(g,y),s_{i_j}'^a(y))
 \end{eqnarray*}
 for $y\in \wt{\mathsf{O}}(z')\cap\partial X$ by the fact that the section structure is symmetric.\par

\noindent(4) The previous points imply that the section structure is determined by knowing it over
$\wt{\mathsf{O}}(z')\cap \partial X$.  Indeed, for every class ${[i_j]}^{\approx_{z'}}$ we have the section
$s_{i_j}'^a |\wt{\mathsf{O}}(z)\cap \partial X$ which we shall denote by $s_j^{z'}$. This section is $g$-equivariant
if $g\ast z'=z'$ and $g({[i_j]}^{\approx_{z'}})={[i_j]}^{\approx_{z'}}$. If $g ({[i_j]}^{\approx_{z'}})={[i_{j'}]}^{\approx_{z'}}$
for some $j'\neq j$ and $g\in G_a(z')$, then the section $s_{j'}^{z'}$ is determined by $s_j^{z'}$ which is statement (3).

Now fix $z''\in [z]$ different from $z'$ and pick $g\in G_a$ satisfying $g\ast z'=z''$.
The decomposition of $I_a$ according to $\approx_{z''}$ is given by 
$$
I_a = {[g(i_1)]}^{\approx_{z''}}\sqcup...\sqcup {[g(i_k)]}^{\approx_{z''}}.
$$
Pick any of these classes, say $ {[g(i_j)]}^{\approx_{z''}}$. Then 
\begin{eqnarray*}
s_{g(i_j)}'^{a}(g\ast y) &=& \mu(\Gamma(g,y),s_{i_j}'^a(y))\ \ y\in \wt{\mathsf{O}}(z')\cap \partial X,
\end{eqnarray*}
which determines $s_{g(i_j)}'^{a}$ on $\wt{\mathsf{O}}(z'')\cap \partial X$ as well as those sections which have index
in $ {[g(i_j)]}^{\approx_{z''}}$.
\qed \end{proof}

What follows is a very important local extension result. 
\begin{proposition}\label{PROP14.4.3}
For fixed $a\in A$ there exists a local sc$^+$-smooth symmetric section structure ${(\wh{s}^a_{i})}_{i\in I_a}$ defined on the open set $\wh{V}_a$
and having the following properties.
\begin{itemize}
\item[\em{(1)}]\  $\wh{s}^a_{i}(y)=s'^a_i(y)$ for all $y\in V_a$ and $i\in I_a$.
\item[\em{(2)}] \  If $z\in \wh{V}_a$ and $i,i'\in I_a$ such that $i\sim_z i'$ then $\wh{s}^a_{i}(z)=\wh{s}^a_{i'}(z)$.
\end{itemize}
\end{proposition}
\begin{proof}
For the fixed $a\in A$ take  a good neighborhood system 
$$
{ \left(\wt{\mathsf{O}}(z)\right)}_{z\in \cl_X(\wh{V}_a)}.
$$
We denote by $[z]$ the $G_a$-orbit generated by $z\in \cl_X(\wh{V}_a)$. We define a $G_a$-invariant subset 
of $\wt{U}(a)$ by
$$
\wt{\mathsf{O}}([z]) =\bigcup_{z'\in [z]} \wt{\mathsf{O}}(z').
$$
Recall that by definition of a good neighborhood system, see Definition \ref{GOODNEI}, the sets  $\wt{\mathsf{O}}(z')$ and $\wt{\mathsf{O}}(z'')$ for $z',z''\in [z]$
are  disjoint unless $z'=z''$.
For every $z'\in [z]$ the index set  $I_a$ is written as disjoint union of equivalence classes $[i]^{\approx_{z'}}$.
We recall the property $g([i]^{\approx_z}) = [g(i)]^{\approx_{g(z)}}$.
For  $y\in \wt{\mathsf{O}}([z])\cap\partial X$ we find $g\in G_a$  such that $y\in \wt{\mathsf{O}}(g\ast z)$. Then, with $z'=g\ast z$
we have that 
\begin{eqnarray}\label{PQEQNX}
s'^{a}_{i}(y)=s'^{a}_{i'}(y) \ \text{if}\ y\in \wt{\mathsf{O}}(z')\cap \partial X\ \text{and}\ i\approx_{z'} i'.
\end{eqnarray}
In the next step we pick for every $[z]$ with $z\in \cl_X(V_a)$ and $i\in I_a$  sc$^+$-smooth $\wh{s}^{[z]}_i:\wh{\mathsf{O}}([z])\rightarrow W$
so that  the following holds.

\begin{itemize}
\item[(A)]\ \ If $[z]\subset  \cl_X(\wh{V}_a)\cap\partial X$ we take sc$^+$-sections $\wh{s}^{[z]}_i$, $i\in I_a$, defined on $\wt{\mathsf{O}}([z])$ such that the following holds.
\begin{itemize}
\item[(i)] \ \ $\wh{s}^{[z]}_i(y)=s'^{a}_i(y)$ for $y\in \partial X\cap \wt{\mathsf{O}}([z])$.
\item[(ii)]\ \  $\wh{s}^{[z]}_{g(i)}(g\ast y)= \mu(\Gamma(g,y),\wh{s}^{[z]}_i(y))$ for all $y\in \wt{\mathsf{O}}([z])$, $g\in G_a$, and $i\in I_a$.
\item[(iii)]\ \ $\wh{s}^{[z]}_i(y)=\wh{s}^{[z]}_{i'}(y)$ for $y\in \wt{\mathsf{O}}(z')$ and $i\approx_{z'} i'$, where $z'\in [z]$.
\end{itemize}
\item[(B)]\ \
For $[z]\subset \cl_X(\wh{V}_a)\setminus \partial X$  we take sc$^+$-sections $\wh{s}^{[z]}_i$, $i\in I_a$, defined on $\wt{\mathsf{O}}([z])$ so that the following holds.
\begin{itemize}
\item[(i)]\ \ $\wh{s}^{[z]}_{g(i)}(g\ast y) =\Gamma(g,\wh{s}^{[z]}_i(y))\ \text{for all}\ y\in \wt{\mathsf{O}}([z]),\ i\in I_a,\ g\in G_a.$
\item[(ii)]\ \  $\wh{s}^{[z]}_{i}(y)=\wh{s}^{[z]}_{i'}(y)$ for $y\in \wt{\mathsf{O}}(z')$ and $i\approx_{z'} i'$, where $z'\in [z]$.
\end{itemize}
\end{itemize}
Note that sections with the above properties can indeed be picked.  To see this recall Lemma \ref{LEMMX14413},
and  assume first
that $[z]\subset \cl_X(\wh{V}_a)\cap\partial X$. Pick a representative $z'\in [z]$ and consider $\wt{\mathsf{O}}(z')$.
For $y\in \wt{\mathsf{O}}(z')\cap \partial X$ (\ref{PQEQNX}) holds. Then $z'$ defines a partition of $I_a$ into equivalence 
classes, say $I_a = {[i_1]}^{\approx_{z'}}\sqcup... \sqcup {[i_k]}^{\approx_{z'}}$ and 
$$
g({[i_j]}^{\approx_{z'}})={[g(i_j)]}^{\approx_{g(z')}}= {[g(i_j)]}^{\approx_{z'}}\ \ \text{if}  \ \ g\ast z'= z'.
$$
  We pick the class ${[i_1]}^{\approx_{z'}}$ and we take an extension of $s_{i_1}'^a|(\wt{\mathsf{O}}(z')\cap \partial X)$
  to $\wt{\mathsf{O}}(z')$. We average this extension with respect to all $g\in G_a(z')$
  which fix ${[i_1]}^{\approx_{z'}}$. The averaged section is still an extension since we extend a section with the same symmetry.
At this point we have constructed 
\begin{eqnarray}\label{EQNC14}
\wh{s}_i^{z'}\ \ \text{of}\ \ W|\wt{\mathsf{O}}(z')\ \ \text{for}\ \ i \in {[i_1]}^{\approx_{z'}}.
\end{eqnarray}
Next we consider ${[i_2]}^{\approx_{z'}}$. If there exists $g\in G_a(z')$ with $g({[i_1]}^{\approx_{z'}})={[i_2]}^{\approx_{z'}}$
we take such a $g$ and define $\wh{s}_{g(i)}^{z'}$ by
$$
\wh{s}_{g(i)}^{z'}(g\ast y) =\mu(\Gamma(g,y),\wh{s}_i^{z'}(y)).
$$
First of all we note that all sections are the same independently of the choice of $i\in {[i_1]}^{\approx_{z'}}$.
The definition also does not depend on the choice of $g$. In fact if there are two such elements $g_1,g_2\in G_a(z')$
we note that $ g_2^{-1}(g_1({[i_1]}^{\approx_{z'}}))={[i_1]}^{\approx_{z'}}$ and since the sections defined in 
(\ref{EQNC14}) have the invariance property with repespect to such elements $g_2^{-1}\circ g_1$ the claim follows.
Hence we obtain
\begin{eqnarray}
\wh{s}_i^{z'}\ \ \text{of}\ \ W|\wt{\mathsf{O}}(z')\ \ \text{for}\ \ i \in {[i_2]}^{\approx_{z'}}.
\end{eqnarray}
If there is no $g\in G_a(z')$ mapping ${[i_1]}^{\approx_{z'}}$ to ${[i_2]}^{\approx_{z'}}$ we deal with the situation
in the same way we obtained (\ref{EQNC14}). Then we take ${[i_3]}^{\approx_{z'}}$ and distinguish the case
if it is related by a group element to $ {[i_1]}^{\approx_{z'}}$ or ${[i_2]}^{\approx_{z'}}$. If that is the case
push forward the data.  If no such relationship exists we deal with the situation as in the case of 
${[i_1]}^{\approx_{z'}}$.  After a finite number of steps we have constructed 
\begin{eqnarray}
\wh{s}_i^{z'}\ \ \text{of}\ \ W|\wt{\mathsf{O}}(z')\ \ \text{for}\ \ i \in I_a.
\end{eqnarray}
This data has the following properties.
\begin{itemize}
\item[(i)]\ \ \ If $g\in G_a(z')$ then $\wh{s}_{g(i)}^{z'}(g\ast y)=\mu(\Gamma(g,y),\wh{s}_{i}^{z'}(y))$ for $y\in \wt{\mathsf{O}}(z')$.
\item[(ii)]\ \ \  If $i\approx_{z'} i'$ then $ \wh{s}_{i}^{z'}=\wh{s}^{z'}_{i'}$.
\item[(iii)]\ \ \  $\wh{s}^{z'}_i(y)=s_i'^a(y)$ for $y\in \wh{\mathsf{O}}(z')\cap X$ and $i\in I_a$.
\end{itemize}

If we take $z''\neq z'$ we fix $g\in G_a$ with $g\ast z'=z''$ and push the data forward. Again the choice of $g$ does not matter
since for two possible choices $g_1$ and $g_2$ we have that $g_2^{-1}\circ g_a\in G_a(z')$ and the data associated
with $z'$ was constructed in such a way that it has an invariance property with respect to the action of $G_a(z')$
and the equivalence relation $\approx_{z'}$.  At this point we have defined $\wh{s}_{i}^{z'}$ for all $z'\in [z]$ which defines
$\wh{s}^{[z]}_i$ of $W|\wt{\mathsf{O}}$.  This gives us a system of sections satisfying $(\mathsf{A})$.
The construction in the case $(\mathsf{B})$ is similar, but easier, since we do not have to extend  sections given on the boundary.

At this point we have constructed for $a\in A$ and a given good neighborhood system for $\cl_X(\wh{V}_a)\subset \wt{U}(a)$,
for every $\wt{\mathsf{O}}([z])$ a system of sections ${(\wh{s}_i^{[z]})}_{i\in I_a}$ with the properties listed above.
The sets 
$$
{(\wt{\mathsf{O}}([z])}_{[z]\in |\cl_X(\wh{V}_a)|}
$$
 define an open covering of $\cl_X(\wh{V}_a)$ by $G_a$-invariant subsets contained in
$\wt{U}(a)$. We take a sub-ordinate functorial sc-smooth partition of unity ${(\sigma_{[z]})}_{\{[z]\}}\cup\{\sigma_\infty\}$ 
indexed by the set $\{[z]\} \cup \{\infty\}$. Here $\infty$ is the index of a map supported in $\wt{U}(a)\setminus \wh{V}_a$.
We disregard this map and only use the  ${(\sigma_{[z]})}_{[z]}$, which satisfy
$$
\text{supp}(\sigma_{[z]})\subset \wt{\mathsf{O}}([z]).
$$
Of course most of these maps vanish. Then we introduce  the maps $\wh{s}^a_i$, $i\in I_a$, which are defined on $\wh{V}_a$ by
$$
\wh{s}^a_i(y)=\sum_{[z]} \sigma_{[z]}(y)\cdot \wh{s}^{[z]}_i(y),\ y\in \wh{V}_a.
$$
By construction it is obvious that the following two properties hold true.
\begin{itemize}
\item[(i)] \ \ \ $\wh{s}^a_{g(i)}(g\ast y) =\mu(\Gamma(g,y),\wh{s}^a_i(y)),\ y\in \wh{V}_a,\ i\in I_a$.
\item[(ii)] \ \ \ $\wh{s}^a_i(y)=s'^{a}_i(y)$ for $y\in \partial X\cap \wh{V}_a$ and $i\in I_a$.
\end{itemize}
Assume next that $i\sim_y i'$ for some $y\in \wh{V}_a$. There are only  finitely many $\sigma_{[z_1]},..,\sigma_{[z_\ell]}$
which are nonzero on
 $y$ and by  construction
$$
\text{supp}(\sigma_{[z_j]})\subset \wt{\mathsf{O}}([z_j]).
$$
For every $[z_j]$ pick $z_j'\in [z_j]$ such that $y\in \wt{\mathsf{O}}(z_j')$.
Since $[i]^{\sim_y}\subset [i]^{\approx_{z_j'}}$ for every $z_j'$, see Definition \ref{GOODNEI} (3),  and $\wh{s}^{[z_j]}_{i}(y)=\wh{s}^{[z_j]}_{i'}(y)$ for
$i\approx_{z_j'} i'$ it follows that
$$
\wh{s}^a_i(y) = \wh{s}^a_{i'}(y) \ \text{provided}\ i\sim_y i'.
$$
\qed \end{proof}
The next section uses the this local result to construct global extensions.



\section{Extension of  the Sc\texorpdfstring{$^+$}{ppl}-Multisection}
Let us summarize the data we are dealing with. We started with an sc$^+$-multisection functor
$$
\Lambda:W|\partial X\rightarrow {\mathbb Q}^+,
$$
and we have fixed a representative  
\begin{eqnarray}\label{ERX1450}
(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')
\end{eqnarray}
 of a structured version.
We fixed $({\wt{U}(x))}_{x\in\partial X}$ admitting the natural $G_x$-action and satsifying $\wt{U}(x)\subset \wt{U}'(x)$.
We have constructed ${(\wh{V}_a)}_{a\in A}$, where $\wh{V}_a$ is open in $X$ and $\cl_X(\wh{V}_a)\subset \wt{U}(a)$.
Moreover, the whole collection ${(|\wh{V}_a|)}_{a\in A}$ is a locally finite open covering of $|\partial X|$. On the associated $\wh{\bm{V}}_{a,a'}$
we have defined a canonical $\wh{\tau}_{a,a'}:\wh{\bm{V}}_{a,a'}\rightarrow \mathfrak{J}(a,a')$ obtained from
the data provided by $\tau'$.
In addition for every $a\in A$ we are given a symmetric sc$^+$-section structure 
\begin{eqnarray}\label{ERX14500}
{(\wh{s}^a_{i})}_{i\in I_a}\ \text{on}\ \ \wh{V}_a
\end{eqnarray}
so that $\wh{s}^a_{i}(y)=s'^a_i(y)$ for $y\in V_a$ and $i\in I_a$ and $\wh{s}^a_{i}(y)=\wh{s}^a_{i'}(y)$ for $y\in \wh{V}_a$
and $i\sim_y i'$.  We shall use this data to define in a suitable way a structurable  extension $\Lambda':W\rightarrow {\mathbb Q}^+$
of $\Lambda$. In this section we first shall construct $\Lambda'$ in a quite specific way and the structurability is addressed in the next section. In  a first step  we  shall decompose $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$ for which we need the following lemma.

\begin{lemma}\label{ABBXZ0}
We work under the assumptions of Theorem \ref{p-main-p}. In particular $X$ is tame and admits sc-smooth partitions of unity as an ep-groupoid. Then there is a collection of  sc-smooth functors $\beta_a:X\rightarrow [0,1]$, $a\in A$,  having the following properties.
\begin{itemize}
\item[\em{(1)}]\  For $a\in A$ the sc-smooth map $\beta_a$ has support in $\pi^{-1}(\pi(\wh{V}_a))$.
\item[\em{(2)}]\   For every $y\in X$ there exists a saturated open neighborhood $Q(y)$ in $X$ such that there are only finitely many $a\in A$ for which
$\beta_a|Q(y)\neq 0$.
\item[\em{(3)}]\  For every $y\in \partial X$ it holds $\sum_{a\in A} \beta_a(y)=1$.
\end{itemize}
\end{lemma}
\begin{proof} 
The collection of sets ${(\pi^{-1}(|\wh{V}_a|))}_{a\in A}$
 together with the open set $\wh{V}_\infty:= X\setminus\partial X$
defines a locally finite open covering of $X$ and we take a subordinate family of partition of unity functors. From these 
we only use the ${(\beta_a)}_{a\in A}$.
\qed \end{proof}
We note that for $a\in A$ it holds
$$
\text{supp}( |\beta_a|)\subset  |\wh{V}_a|,
$$
and consequently
\begin{eqnarray}
\cl_X(\{ y\in \wt{U}(a)\ |\ \beta_a(y)\neq 0\}) \subset \wh{V}_a\ \text{for}\ a\in A.
\end{eqnarray}
The $(\beta_a)$ restricted to $\partial X$ define an sc-smooth partition of unity.  We define structured ${\Lambda}_a:W|\partial X\rightarrow {\mathbb Q}^+$
for $a\in A$  by 
$$
\Lambda_a =(\beta_a|\partial X)\odot \Lambda.
$$
The  structuring data we are going to use comes from (\ref{ERX1450}).
 We take as good system $\mathfrak{U}'$, as index set $\mathfrak{I}$, and as correspondence $\tau'$. The section structure
$\mathfrak{S}_a' ={(\mathfrak{s}_{a,x})}_{x\in \partial X}$ is given by
$$
\mathfrak{s}_{a,x}:\ \ s'^{x}_{a,i}(y)=\beta_a(y)\cdot s'^{x}_i(y)\ \text{for}\ x\in \partial X,\ i\in I_{x},\ y\in U'(x).
$$
We note the following obvious fact.
\begin{lemma}
The structured  $\wt{\Lambda}:=(\Lambda,\mathfrak{U}',\mathfrak{S}',\tau')$ is the commensurable locally finite sum
of the $\wt{\Lambda}_a:=({\Lambda}_a,\mathfrak{U}',\mathfrak{S}'_a,\tau')$
\begin{eqnarray}\label{LEMMX1452}
\wt{\Lambda}=\boxplus_{a\in A} \wt{\Lambda}_a.
\end{eqnarray}
\qed
\end{lemma}
\begin{remark} It is also important to notice that $\Lambda_a$ is completely determined by the symmetric sc$^+$-section structure 
$$
{((\beta_a|U'(a))\cdot s'^a_i)}_{i\in I_a}.
$$
In fact, it is even determined by ${((\beta_a|V_a)\cdot s'^a_i)}_{i\in I_a}$. Of course, as a structured sc$^+$-section functor 
the global knowledge of $\tau'$ is needed. For example we have used it for taking the commensurable sum in (\ref{LEMMX1452}).
\qed
\end{remark} 

We begin now with the important constructions needed  to extend $\Lambda$ to a saturated open neighborhood
of $\partial X$. We fix $a\in A$ and consider $\Lambda_a:W|\partial X\rightarrow {\mathbb Q}^+$.
The local section structure for $\Lambda_a$ is given at $x\in \partial X$ on the set $U'(x)$ by
$$
{(\beta_a\cdot s'^x_i)}_{i\in I_x}.
$$
First we shall only  work on the open sets $\wh{V}_b$, where $b$ varies in $A$. Most of the construction
takes place on $\wh{V}_a$, and we can transport data to other $\wh{V}_b$ with the help of the $\wh{\tau}_{a,b}$. Of course, transporting data around relies on using a choice of morphisms, as well as the correspondences
$\wh{\tau}$. The careful analysis of the implicit structures is needed to avoid ambiguities.


\begin{proposition}
Recall the family ${(\wh{s}_i^a)}_{i\in I_a}$, $a\in A$, see (\ref{ERX14500}), obtained through the local extension procedure in the previous section.
For each given  $a\in A$ there exists for every $b\in A$  a symmetric sc$^+$-section structure ${(\wt{s}_{a,i}^b)}_{i\in I_b}$
where $\wt{s}_{a,i}^b$ is defined on $\wh{V}_b$ and the following holds.
\begin{itemize}
\item[\em{(1)}]\  $\wt{s}_{a,i}^a(y) =\beta_a(y)\cdot \wh{s}^a_{i}(y)$ for $i\in I_a$ and $y\in \wh{V}_a$.
\item[\em{(2)}]\   $\text{supp}(\wt{s}_{a,i}^a)$ is closed in $X$ and contained in $\wh{V}_a$ for $i\in I_a$.
\item[\em{(3)}] \  $\wt{s}^b_{a,i}(y)=\beta_a(y)\cdot s'^{b}_{i}(y)$ for $y\in V_b$,  $b\in A$.
\item[\em{(4)}]\   For  $b,b'\in A$ and $\phi\in \wh{\bf V}_{b,b'}$ with $\wh{\tau}_{b,b'}(\phi)$ given by $[I_{b}\stackrel{\alpha(k)}{\twoheadleftarrow} I\stackrel{\beta(k)}{\twoheadrightarrow} I_{b'}]$ it holds for $k\in I$
$$
\wt{s}^{b'}_{a,\alpha(k)}(t(\phi))=\mu(\phi,\wt{s}^{b}_{a,\beta(k)}(s(\phi))).
$$
\end{itemize}
\end{proposition}
The proof of this result is subtle mainly due to the requirement (4). In fact (4) required the lengthy preparations introducing the equivalence relations  $\sim_z$ and $\approx_z$ in the previous section.
\begin{proof}
In Proposition \ref{PROP14.4.3} we have already constructed a symmetric sc$^+$-section structure $\wh{s}^a_{i}$, $i\in I_a$, on $\wh{V}_a$ which extends 
$s'^a_i$, $i\in I_a$.   We define
$\wt{s}^a_{a,i}$ for $i\in I_a$ by
$$
\wt{s}^a_{a,i}(y)= \beta_a(y)\cdot \wh{s}^a_{i}(y),\ y\in \wh{V}_a.
$$
This defines $\mathfrak{s}^a_a$ and 
 (1) and (2) hold, and in addition (3) for the special case $b=a$.

In a next step we define, keeping the initial $a\in A$ fixed related section structures for all $\wh{V}_b$, where $b\in A$. 
If $b\in A$ such that there is no morphism
starting in $\wh{V}_a$ and ending in $\wh{V}_b$ we associate to every $i\in I_b$ the zero section on $\wh{V}_b$ which defines the symmetric sc$^+$-section structure
$\mathfrak{s}^b_{a}$.  
Suppose that $b\in A$ is such that there exists a morphism starting in $\wh{V}_a$ and ending in $\wh{V}_b$.
In a first step we define $s^b_{a,i'}$ for $i'\in I_b$ on the subset of $\wh{V}_b$ which can be reached by morphisms
starting  in  $\wh{V}_a$ and ending in $\wh{V}_b$. Subsequently we shall see that the extension by zero over the rest 
of the set $\wh{V}_b$ is sc$^+$-smooth.
Pick $\phi\in \wh{\bm{V}}_{a,b}$ and take 
$$
I_a\stackrel{\alpha}{\twoheadleftarrow} I\stackrel{\beta}{\twoheadrightarrow} I_b
$$
 representing
$\wh{\tau}_{a,b}(\phi)$. For given $i'\in I_b$ pick $k\in I$ satisfying $\beta(k)=i'$ and with $i=\alpha(k)$ define
$$
\wt{s}^b_{a,i'}(t(\phi))=\mu(\phi,\wt{s}^a_{a,i}(s(\phi))).
$$
We have to verify that the definition is independent of the choices. Suppose $\psi\in \wh{\bm{V}}_{a,b}$ with $t(\psi)=t(\phi)$ and $\wh{\tau}_{a,b}(\psi)$ is represented
by 
$$
 I_a\stackrel{\gamma}{\twoheadleftarrow} J\stackrel{\delta}{\twoheadrightarrow} I_b.
 $$
  We assume that we have picked $j\in J$ satisfying
$\delta(j)=i'$. We define $e=\gamma(j)$. Using this data the alternative definition for $\wt{s}^b_{a,i'}(t(\phi))$ is given by 
$\mu(\psi,\wt{s}^a_e(s(\psi)))$. We need to show  the equality 
\begin{eqnarray}\label{meretx}
\mu(\phi,\wt{s}^a_{a,i}(s(\phi))) = \mu(\psi,\wt{s}^a_{a,e}(s(\psi))).
\end{eqnarray}
We can write $\psi^{-1}\circ \phi =\Gamma(g,s(\phi))$ for a uniquely determined $g\in G_a$. Hence
$$
\phi=\psi\circ\Gamma(g,s(\phi)).
$$
Since $\phi=\psi\circ\Gamma(g,s(\phi))=\psi\circ\Gamma(g,g^{-1}\ast s(\psi))$ we have that $\phi=\psi\ast g$ implying
$$
\wh{\tau}_{a,b}(\phi)=\wh{\tau}_{a,b}(\psi\ast g) =\wh{\tau}_{a,b}(\psi)\ast g.
$$
Therefore
$$
[I_a\stackrel{\alpha}{\twoheadleftarrow} I\stackrel{\beta}{\twoheadrightarrow} I_b] =[ I_a\stackrel{g^{-1}\circ \gamma}{\twoheadleftarrow} J\stackrel{\delta}{\twoheadrightarrow} I_b],
$$
so that without loss of generality we may assume that $\alpha=g^{-1}\circ \gamma$ and $\beta=\delta$.  With $z=s(\psi)$ we note that
$\psi , \phi^{-1}, \Gamma(g,s(\phi))$ is a $z$-loop and with 
$$
\wh{\tau}_{a,a}(\Gamma(g,s(\phi)))=[I_a\stackrel{Id}{\twoheadleftarrow} I_a\stackrel{g}{\twoheadrightarrow} I_a]
$$
we see that we obtain the $z$-arc $e,i',i,g(i)$ via
$$
e =\gamma(j),\ \delta(j) = i' = \beta(k),\  \alpha(k) = i,\ g(i).
$$
 so that 
\begin{eqnarray}\label{meretxXX}
 e\sim_z g(i).
\end{eqnarray}
Using that 
$$
i' = \beta(k),\ i =\alpha(k) = g^{-1}(\gamma(k)), \ \text{and}\ e=\gamma(j).
$$
we compute
\begin{eqnarray*}
&& \mu(\phi,\wt{s}^a_{a,i}(s(\phi)))\\
&=& \mu(\psi\circ\Gamma(g,s(\phi)),\wt{s}^a_{a,i}(s(\phi)))\\
&=& \mu(\psi,\mu(\Gamma(g,s(\phi)),\wt{s}^a_{a,i}(s(\phi))))\\
&=& \mu(\psi,\wt{s}^a_{a,g(i)}(g\ast s(\phi)))\\
&=&\mu(\psi,\wt{s}^a_{a,g(i)}(s(\psi))).
\end{eqnarray*}
We need to show that $ \mu(\psi,\wt{s}^a_{a,g(i)}(s(\psi)))=\mu(\psi,\wt{s}^a_{a,e}(s(\psi)))$. However, since $e\sim_{s(\psi)} g(i)$, and $z=s(\psi)$, 
see (\ref{meretxXX}),  it follows
that 
\begin{eqnarray*}
\wt{s}^a_{a,g(i)}(s(\psi))&=&\beta_a(s(\psi))\cdot \wh{s}^a_{g(i)}(s(\psi))\\
&=&\beta_a(s(\psi))\cdot \wh{s}^a_{e}(s(\psi))\\
&=&\wt{s}^a_{a,e}(s(\psi))
\end{eqnarray*} 
which proves this  identity, and therefore that $\wt{s}^b_{a,i'}$ is well-defined on all points of $\wh{V}_b$  reachable from
$\wh{V}_a$.  

Next let $z'\in \wh{V}_b$  be in the closure of reachable points from $a$. Hence we find a sequence of morphisms 
$\psi_k$ satisfying $s(\phi_k)\in \wh{V}_a$, $t(\phi_k)\in \wh{V}_b$ and $z_k':= t(\phi_k)\rightarrow z'$. Using properness
we may assume with out loss generality that $\phi_k\rightarrow \phi$ with $s(\phi)\in \cl_X(\wh{V}_a)\subset \wt{U}(a)$ and
$t(\phi)=z'$. If $s(\phi)\in \wh{V}_a$ the point $z'$ is reachable and $\wt{s}^b_{a,i'}$ is already defined. So assume $s(\phi)\not\in \wh{V}_a$.
Then for large $k$ we  already have that $\wt{s}^a_{a,i}$ vanishes in an open neighborhood of $s(\phi_k)$.
Hence it follows that  $\wt{s}^b_{a,i'}$ where defined vanishes on the reachable points near $z'$. Hence we can extend
$\wt{s}^b_{a,i'}$ over the rest  of $\wh{V}_b$ by $0$.  This defines ${(\wt{s}^b_{a,i'})}_{i'\in I_b}$. 
At this point we have constructed for a given $a\in A$
symmetric sc$^+$-section structures ${(\wt{s}_{a,i}^b)}_{i\in I_b}$ for every $b\in A$  such that
$$
\wt{s}_{a,i'}^b(t(\psi))=\mu(\psi,\wt{s}_{a,i}^a(s(\psi)))
$$
provided $i'$ and $i$ correspond under $\wh{\tau}_{a,b}(\psi)$.   The last statement proves (4) for a special case.

In order to prove (4) in generality, still for fixed $a$,  consider $b, b'\in A$ and let
$\psi\in \wh{\bm{V}}_{b,b'}$.   We have to consider several cases.
Assume first that $s(\psi)$ or $t(\psi)$ is reachable from $\wh{V}_a$. In this case both are reachable 
and we find $\phi_1,\phi_2$ with
$$
s(\phi_1)=s(\phi_2)\in\wh{V}_a\ \text{and}\ \psi\circ \phi_1=\phi_2.
$$
In this case, if $i\in I_{b}$ and $i'\in I_{b'}$ correspond under $\wh{\tau}_{b,b'}(\psi)$, we can pick $j\in I_a$
corresponding under $\wh{\tau}_{a,b}(\phi_1) $ to $i$, and  pick $j'\in I_a$ corresponding under $\wh{\tau}_{a,b'}(\phi_2)$ to $i'$.
We note that $j\sim_{s(\phi_1)} j'$. This implies using previous definitions 
\begin{eqnarray*}
&& \wt{s}^{b'}_{a,i'}(t(\psi))\\
&=& \mu(\phi_2,\wt{s}^a_{a,j'}(s(\phi_2)))\\
&=&\mu(\psi\circ\phi_1,\wt{s}^a_{a,j'}(s(\phi_2)))\\
&=&\mu(\psi,\mu(\phi_1,\wt{s}^a_{a,j'}(s(\phi_2))))\\
&=& \mu(\psi,\mu(\phi_1,\wt{s}^a_{a,j'}(s(\phi_1))))\\
&=&\mu(\psi,\mu(\phi_1,\wt{s}^a_{a,j}(s(\phi_1))))\\
&=&\mu(\psi,\wt{s}^b_{a,i}(s(\psi))).
\end{eqnarray*}
At this point we have constructed for  given $a$  a symmetric sc$^+$-section structures  ${(\wt{s}^b_{a,i})}_{i\in I_b}$ on $\wh{V}_b$
for every $b\in A$. Moreover, these sc$^+$-section structures are compatible under the correspondences
$\wh{\tau}_{b,b'}:\wh{\bm{V}}_{b,b'}\rightarrow \mathfrak{J}(b,b')$ and it holds that
$$
\wt{s}^{b}_{a,i}(y) =\beta_a(y)\cdot s'^{b}_i(y)\ \text{for}\ y\in V_b,\ i\in I_b.
$$
\qed \end{proof}
 Define for every $b\in A$
the symmetric sc$^+$-section structure on $\wh{V}_b$
$$
{(\wt{s}^b_i)}_{i\in I_b}
$$
by setting
$$
\wt{s}^b_i=\sum_{a\in A} \wt{s}_{a,i}^b.
$$
This is a locally finite sum and therefore well-defined.  It also extends the section structure of $\Lambda$ on $V_b$.
By construction it is compatible with $\wh{\tau}$. 

At this point we can define for every $b\in A$ 
an sc$^+$-multisection functor ${\Lambda}'_b$ on $W|\wh{V}_b$ by
$$
{\Lambda}'_b(w)=\frac{1}{|I_b|} \cdot |\{i\in I_b\ |\ \wt{s}_i^b(P(w))=w\}|.
$$
If $\phi$ is a morphism starting in $\wh{V}_b$ and ending in $ \wh{V}_{b'}$ it follows with $w'=\mu(\phi,w) $ that
${\Lambda}'_{b'}(w')={\Lambda}'_b(w)$ so that the sc$^+$-multisection functors are compatible.

The symmetric sc$^+$-section structures ${(\wt{s}^b_i)}_{i\in I_b}$ are related by the $\wh{\tau}_{b,b'}:\bm{\wh{V}}_{b,b'}\rightarrow\mathfrak{J}(b,b')$. We shall construct from this data a structurable  sc$^+$-section functor $\Lambda':W\rightarrow {\mathbb Q}^+$
which extends $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$.  We note that the structure data for $\Lambda'$
will in general not restrict to the one originally fixed for $\Lambda$.



Recall that ${(|\wh{V}_b|)}_{b\in A}$ is an open covering of $|\partial X|$. For $|x|\in |X|$ not contained in 
$\bigcup _{b\in A} |\wh{V}_b|$ we can take a representative $x$ and an open neighborhood $\wh{V}_x$ invariant under the natural action,
with the properness property, so that $|\wh{V}_x|$ only contains isomorphism classes of points on which the sections vanish.
We equip $\wh{V}_x$ with the zero section $(s_1^x)$ as section structure and define $I_x=\{1\}$. The correspondence
for $b\in A$ and such a $x$ we define by 
$$
\wh{\tau}_{b,x}(\psi)=[I_b\stackrel{Id}{\twoheadleftarrow} I_b\twoheadrightarrow \{1\}].
$$
Similarly for the reversed pair $(b,x)$. For $x,x'$ as just described we define $\wh{\tau}_{x,x'}(\psi)=[\{1\}\twoheadleftarrow \{1\}\twoheadrightarrow \{1\}]$.

At this point we have defined for a suitable $A'\subset X$, containing $A$, open subsets $\wh{V}_x$
with the natural $G_x$-action and symmetric sc$^+$-section structures compatible for some correspondence.
Moreover
$$
\bigcup_{x\in A'} |\wh{V}_x| =|X|.
$$
Hence the data defines a global sc$^+$-multisection $\Lambda':E\rightarrow {\mathbb Q}^+$ extending
$\Lambda$. By Theorem \ref{criterionn}, which is proved below,  $ \Lambda'$ is structurable. The domain support of $\Lambda'$
has an orbit space  contained in the open neighborhood $\bigcup_{a\in A} |\wh{V}_a|$ of $|\partial X|$.
Define
$$
\wt{U}= \pi^{-1}\left(\bigcup_{a\in A} |\wh{V}_a|\right).
$$
Define the map $h:|X|\rightarrow {\mathbb R}^+$ by
$$
h(|x|) = \text{max} \left(\{N(s_i^x(x))\ |\ i\in I_x\}\right).
$$
Then $h$ is a continuous map and satisfies for $|x|\in |\partial X|$
$$
h(|x|) =N(\Lambda)(x) < f(x).
$$
We can find an sc-smooth functor $\sigma:X\rightarrow {\mathbb R}^+$ such that $\sigma(x)=1$ for $x\in \partial X$
having support in $\wt{U}$ such that 
$$
h(|x|)\cdot \sigma(x)\leq f(x)\ \text{for all}\ x\in X.
$$
Now consider $\sigma\odot \Lambda'$ which is the required extension. Since $\Lambda'$ is structurable according to Theorem \ref{criterionn} the same is true
for $\sigma\odot\Lambda'$. This completes modulo the structurability assertion the proof of Theorem \ref{p-main-p}.



The following result is a very useful criterion for structurability and applies to the situation in the previous section.
\begin{theorem}\label{criterionn}
Let  $P:W\rightarrow X$ be a strong bundle over the ep-groupoid $X$ having a paracompact orbit space $|X|$ and let
$\Lambda:W\rightarrow {\mathbb Q}^+$  be  A $\ssc^+$-multisection functor. We assume that there exists a subset $A$ of $X$ and for every $a\in A$ an open neighborhood $U(a)$ and an open subset $V_a\subset U(a)$ with the following properties (a)--(c): 
\begin{itemize}
\item[{\em (a)}] \ \ $U(a)$ is $G_a$-invariant and the target map $t: s^{-1}(\cl_X (U(a)) \to X$ is proper. 
\item[{\em (b)}] \ \ $V_a$ is $G_a$-invariant and $\cl_{|X|}(|V_a|)\subset |U(a)|$.
\item[{\em (c)}]\ \ $\bigcup_{a\in A} |V_a| =|X|$.
\end{itemize}
In addition we assume that the following two properties hold true.
\begin{itemize} 
\item[{\em (d)}]\ \ For every $a\in A$, there exists a symmetric $\ssc^+$-section structure $\mathfrak{s}^a={(s_i^a)}_{i\in I_a}$ on $V_a$ indexed by a finite set $I_a$ such that if $w\in W$ satisfies $P(w)\in V_a$, then 
$$
\Lambda(w)=\frac{1}{|I_a|} |\{i\in I_a\, \vert \,  s^a_i(P(w))=w\}|.
$$
\item[{\em (e)}] \ \ For every $a,a'\in A$, with $\bm{V}_{a,a'}:=\{\phi\in\bm{X}\ |\ s(\phi)\in V_a,\ t(\phi)\in V_{a'}\}$, 
there exists a 
 correspondence 
 $$
 \tau_{a,a'}:\bm{V}_{a,a'} \rightarrow \mathfrak{J}(a,a')
 $$
  relating the section structures $\mathfrak{s}^a$ and $\mathfrak{s}^{a'}$ over $V_a$ and $V_{a'}$ and only taking finitely many values.
\end{itemize}
Then  $\Lambda$ is a $\ssc^+$-structurable multisection functor.
\end{theorem}
\begin{proof}
Define  the open subset $V=\bigcup_{a\in A} V_a$ of $X$.  It has the  property that $|V|=|X|$  and inherits the structure of an ep-groupoid
for which the inclusion functors $F: V\rightarrow X$ is an equivalence of ep-groupoids. In the same way the inclusion functor
$\Phi: W|V\rightarrow W$ is a strong bundle equivalence. Clearly 
$$
\Phi_\ast (\Lambda|(W|V)) =\Lambda
$$
and in view of this fact, employing Theorem \ref{pushforwardX},   it suffices to show that $\Lambda|(W|V)$ is structurable.

In order to show the structurability of $\Lambda|(W|V)$ there is no loss of generality viewing $\Lambda$
as an sc$^+$-multisection functor on $W\rightarrow V$. Then the data given in the hypothesis of the theorem provides
us with an open covering ${(V_a)}_{a\in A}$. First we shall pick a map $V\rightarrow A:x\rightarrow a_x$ so that 
$x\in V_{a_x}$ and we pick an open neighborhood $Q(x)$ so that for the natural $G_{a_x}$-action
on $U(a_x)$ it holds that $g\ast x=g$ implies $g\ast Q(x)=Q(x)$. We define a local symmetric sc$^+$-section structure 
on $Q_x$ by restricting  the data from $V_{a_x}$. More precisely we define $\bar{I}_x:= I_{a_x}$
$$
\bar{\mathfrak{s}}_x\colon\ \ \  \bar{s}_i^x := s^{a_x}_i\ \text{for}\ \ i\in I_{a_x}.
$$
The group $G_x$ acts on $\bar{I}_x$  as follows. For $g\in G_x$ there exists a unique $h_g\in G_{a_x}$ with $\Gamma(h_g,x)=g$
and we define $g(i):= h_g(i)$, so that we act through a subgroup of $G_{a_x}$.   

Given $x,x'\in V$ we consider $\bm{Q}(x,x')$ which is an open subset of $\bm{V}(a_x,a_{x'})$ which allows us to restrict
$\tau_{a_x,a_{x'}}$. Hence we define
$$
\bar{\tau}_{x,x'} :\bm{Q}(x,x')\rightarrow {\mathfrak{J}}(x,x')
$$
as follows.   We note that by construction ${\mathfrak{J}}(x,x'):=\mathfrak{J}(a_x,a_{x'})$ and 
$$
\bar{\tau}_{x,x'}(\phi) :=\tau_{a_x,a_{x'}}(\phi).
$$
We gather the data as follows. We define $\bar{\mathfrak{U}}={(Q(x))}_{x\in V}$,  $\bar{\mathfrak{S}}={(\bar{\mathfrak{s}}_x)}_{x\in V}$, and
$\bar{\tau} ={(\bar{\tau}_{x,x'})}_{(x,x')\in V\times V'}$.

We show that $(\Lambda,\bar{\mathfrak{U}}, \bar{\mathfrak{S}},\bar{\tau})$ is a structured version of $\Lambda$, which will
complete the proof of the theorem. First of all we have for every $x\in V$ an open neighborhood $Q(x)$ with the natural $G_x$-action
and a symmetric sc$^+$-section structure $\bar{\mathfrak{s}}_x$ representing $\Lambda$. Moreover, given 
$x,x'\in V$ we have a correspondence 
$$
\bar{\tau}_{x,x'}:\bm{Q}(x,x')\rightarrow \mathfrak{J}(x,x')
$$
which only takes finitely many values,  and is locally constant.  Moreover, by construction if $\phi\in \bm{V}(x,x')$
then $\bar{\tau}_{x,x'}(\phi)= \tau_{a_x,a_{x'}}(\phi)$. Assume the latter is represented by the diagram
$$
I_{a_x}\stackrel{\alpha}{\twoheadleftarrow} I\stackrel{\beta}{\twoheadrightarrow} I_{a_{x'}}.
$$
Then by hypothesis $s^{a_{x'}}_{\beta(k)}(t(\phi))=\mu(\phi,s^{a_x}_{\alpha(k)}(s(\phi)))$ which precisely implies
$$
\bar{s}_{\beta(k)}^{x'}(t(\phi))=\mu(\phi,\bar{s}^{x}_{\alpha(k)}(s(\phi))).
$$
Moreover, using previous definitions
\begin{eqnarray*}
\bar{\tau}_{x,x}(\Gamma_x(h,y))=\tau_{x,x}(\Gamma_{a_x}(g,y))
= \left[I_{a_x}\stackrel{Id}{\twoheadleftarrow} I_{a_x}\stackrel{g}{\twoheadrightarrow} I_{a_x}\right]
= \left[\bar{I}_x\stackrel{Id}{\twoheadleftarrow} \bar{I}_{x}\stackrel{h}{\twoheadrightarrow} \bar{I}_{x}\right]
\end{eqnarray*}
\qed \end{proof}

\section{Remarks on Inductive Constructions}
The main result Theorem \ref{p-main-p} proved in the previous sections 
stated that a structurable sc$^+$-multisection defined on the boundary of a tame ep-groupoid  can be extended
as a structurable sc$^+$-multisection. In applications, very often, the perturbations 
are constructed inductively and additional problems arise. For example, if the underlying ep-groupoid
has a boundary with corners and it is face-structured the inductive procedure might define
perturbations over some of the faces so that the (global) sc$^+$-multisection on the boundary has to be assembled
from the pieces defined on the faces. Of course, that can only be accomplished provided the sc$^+$-multisections
 on the intersection of faces 
coincide. In order to extend the sc$^+$-multisection it is important to have a structuring of the assembled
sc$^+$-multisection.  The structuring data for  the sc$^+$-multisections on the faces
 is in general a consequence of the inductive
scheme, and a matter of the concrete situation and will not be discussed here. 
Here we shall restrict ourselves to highlight the compatibility issue of the data coming from
the different faces if we have a boundary with corners. We shall also restrict ourselves
to the case where $X$ is a face-structured ep-groupoid. More general
situations are possible, but left to future discussions.

Let $X$ be a face-structured tame ep-groupoid and $P:W\rightarrow X$ a strong bundle.  
In this case a face $F$ is saturated and has the structure of a sub-M-polyfold.
Equipping $F$ with the induced M-polyfold structure, it becomes with the associated morphism set
an ep-groupoid.  If $x\in \partial X$ and $U(x)$ an open neighborhood in $X$ 
with the natural $G_x$-action it follows that $g\ast (F\cap U(x))=F\cap U(x)$ for all faces $F$ 
which contain $x$. Recall that there are exactly $d_X(x)$-many of such faces, where $d_X$ is the degeneracy index.
Denote by ${\mathcal F}_X$\index{${\mathcal F}_X$} the set of faces, where by assumption every $F$ is a sub-ep-groupoid
with the induced structure being that of a tame face-structured ep-groupoid. 
We denote by ${\mathcal F}_{X,x}$\index{${\mathcal F}_{X,x}$} the collection of all faces containing $x$. As already pointed out it holds that 
$d_X(x)=\sharp{\mathcal F}_{X,x}$.

We assume that for every face $F$ we are given a structured sc$^+$-multisection functor 
$$
\wt{\Lambda}_F=[\Lambda_F,\mathfrak{U}_F,\mathfrak{S}_F,\tau_F]
$$
for $W|F$. A representative of $\wt{\Lambda}_F$ is given by $(\Lambda_F,\mathfrak{U}_F,\mathfrak{S}_F,\tau_F$,
where $\Lambda_F:W|F\rightarrow {\mathbb Q}^+$ is a functor and for every $x\in F$ 
a  good neighborhood $U_F(x)\subset F$ has been given. This means $U_F(x)$ admits the natural $G_x$-action 
and $t:s^{-1}(\cl_F(U_F(x)))\rightarrow F$ is proper. Moreover we are given for every $x\in F$ an index set $I_x^F$ 
with an action by $G_x$ and a symmetric section structure $\mathfrak{s}_x^F$, given by
$$
{(s^x_{F,i})}_{i\in I_x^F}.
$$
Moreover, for $x,x'\in F$ a correspondence $\tau_{F,x,x'}:\bm{U}_F(x,x')\rightarrow \mathfrak{J}_F(x,x')$
is given relating in the usual way the section structures associated to $x$ and $x'$, respectively.
We note that we can always shrink the sets $U_F(x)$ restrict $\tau_{F,x,x'}$. 


We consider the assignment ${\mathcal F}_X\ni F\rightarrow \wt{\Lambda}_F$ and shall formulate 
a compatibility condition.
\begin{definition}\index{D- Restriction $\wt{\Lambda}_{F|F'}$}
Given a face $F'\in {\mathcal F}_X$ the restriction of $\wt{\Lambda}_F$ to $W|(F\cap F')$ denoted by
$\wt{\Lambda}_{F|F'}$ is defined as follows, where 
$$
\wt{\Lambda}_{F|F'} =[\Lambda_{F|F'}, \mathfrak{U}_{F|F'},\mathfrak{S}_{F|F'},\tau_{F|F'}]
$$
and the following data is obtained by taking a representative $(\Lambda_F,\mathfrak{U}_F,\mathfrak{S}_F,\tau_F)$ 
of $\wt{\Lambda}_F$
\begin{itemize}
\item[(1)] \  $\Lambda_{F|F'}=\Lambda_F|(W|(F\cap F'))$.
\item[(2)] \  $\mathfrak{U}_{F|F'} = {(U_F(x)\cap F')}_{x\in F\cap F'}$, where $\mathfrak{U}_F ={(U_F(x))}_{x\in F}$ is a good system of open neighborhoods.
\item[(3)] \  $\mathfrak{S}_{F|F'}= {(\mathfrak{s}^{F|F'}_x)}_{x\in F\cap F'}$, where 
$\mathfrak{s}^{F|F'}_x$ is the symmetric sc$^+$-section structure obtained from $\mathfrak{s}^F_x$
by restricting the $s^x_i, i\in I_x^F$ to $U_F(x)\cap F'$.
\item[(4)] \  The correspondences $\tau_{F|F',x,x'}$ are the restrictions of $\tau_{F,x,x'}$ for $x,x'\in F\cap F'$
to $\{\phi\in \bm{X}\ |\ s(\phi)\in U_F(x)\cap F',\ t(\phi)\in U_F(x)\cap F'\}$.
\end{itemize}
\qed
\end{definition}
The compatibility condition is now given as follows.
\begin{definition}\index{D- Compatibility for $(\wt{\Lambda}_F)$}
Let $P:W\rightarrow X$ be a strong bundle over a tame face-structured ep-groupoid
and denote by ${\mathcal F}_X$ the set of faces. Assume that $F\rightarrow \wt{\Lambda}_F$
is an assignment which associates to a face $F\in {\mathcal F}_X$ a structure sc$^+$-multisection
on $W|F$.  Then the assignment is said to be compatible provided for every choice 
of faces $F,F'$ the equality
$$
\wt{\Lambda}_{F|F'}=\wt{\Lambda}_{F'|F}
$$
holds.
For a compatible assignment we define $\wt{\Lambda}_{F\cap F'}=\wt{\Lambda}_{F|F'}$.
\qed
\end{definition}
With this definition we see that $\wt{\Lambda}_{F\cap F'}$ is a structured sc$^+$-multisection 
of $W|(F\cap F')$.  A face of $F\cap F'$ is obtained by intersecting $F\cap F'$ with a suitable
$F''\in {\mathcal F}_X$. Then the compatibility allows us to consider 
$$
\wt{\Lambda}_{F\cap F'},\ \wt{\Lambda}_{F\cap F''},\ \text{and}\ \ \wt{\Lambda}_{F'\cap F''}.
$$
We note that $F\cap F'\cap F''$ is a common face of these three ep-groupoids and the restriction 
of the structures sc$^+$-multisections defines a common $\wt{\Lambda}_{F\cap F'\cap F''}$.
This can be done for an arbitrary number of faces.  

We note that as a consequence of the compatibility condition it holds that 
for 
$$
I^F_x=I^{F'}_x \ \ \text{for}\  F, F'\in {\mathcal F}_{X,x}
$$
We shall abbreviate $I_x:= I_x^F$ and also write $\mathfrak{J}(x,x')$ instead of $\mathfrak{J}_F(x,x')$.
 Moreover on $U_F(x)\cap U_{F'}(x)$ we have the equality
$s^x_{F,i}(y)=s^x_{F',i}(y)$ for $i\in I_x$.  We shall take for every $x\in \partial X$ a good open neighborhood
$V(x)$ of $x$ in $X$ such that  $U(x)=V(x)\cap \partial X$ satisfies
$$
U(x)\cap F\subset U_F(x)\ \ \text{for all}\ F\in {\mathcal F}_{F,x}.
$$

\begin{theorem}\index{T- Extensions for compatible $(\wt{\Lambda}_F)$}
Let $P:W\rightarrow X$ be a strong bundle over a tame face-structured ep-groupoid
and ${\mathcal F}_X\ni F\rightarrow \wt{\Lambda}_F$ be a an assignment of compatible
structured sc$^+$-multisection functors defined on the various $W|F$. Then 
this data defines a naturally structured $\wt{\Lambda}: W|\partial X\rightarrow {\mathbb Q}^+$.
In particular the underlying $\Lambda$ has an extension to $W|X$. The extension 
can be chosen to satisfy certain size restrictions, see Theorem \ref{p-main-p}.
\end{theorem}
\begin{proof}
The compatibility condition implies immediately that $\Lambda:W|F\rightarrow {\mathbb Q}^+$ 
given by
$$
\Lambda(w) =\Lambda_F(w)\ \ \text{for}\ P(w)\in F,\ F\in {\mathcal F}_{X,P(w)}
$$
is a well-defined functor. As already explained we have fixed 
for every $F\in {\mathcal F}_X$ a representative 
$$
(\Lambda_F,\mathfrak{U}_F,\mathfrak{S}_F,\tau_F)
$$
so that for every $x\in \partial X$ there exists an open neighborhood $U(x)\subset \partial X$
coming from a good open neighborhood $V(x)$ in $X$ such that $U(x)=V(x)\cap\partial X$ and 
$U(x)\cap F\subset U_F(x)$ for all $F\in {\mathcal F}_{X,x}$.  Moreover
it holds that 
$$
s^x_{F',i}(y)=s^x_{F,i}(y)\ \text{for} \ i\in I_x,\  y\in U(x)\cap F\cap F'.
$$ 
This allows us to define a symmetric sc$^+$-section structure $\mathfrak{s}_x={(s^x_i)}_{i\in I_x}$ on $U(x)$ by
$$
s^x_i(y)=s^x_{F,i}(y)\ \text{for}\ y\in F\cap U(x).
$$
We do this for every $x\in \partial X$. Finally we define the correspondences as follows.  
For $x\in \partial X$ and $x'\in \partial X$ consider $\bm{U}(x,x')$ which consists of all morphisms 
$\phi$ with $s(\phi)\in U(x)$ and $t(\phi)\in U(x')$. If $s(\phi)\in F\cap U(x)$ then necessarily $t(\phi)\in F\cap U(x')$.
Hence $\phi\in \bm{ U}_F(x,x')$. We can define 
$$
\tau_{x,x'}(\phi) =\tau_{F,x,x'}(\phi).
$$
This is well-defined since $\tau_{F,x,x'}(\phi)=\tau_{F',x,x'}(\phi)$ if $s(\phi)\in F\cap F'$.
Moreover, it follows from the definition that the map $\tau_{x,x'}:\bm{U}(x,x')\rightarrow \mathfrak{J}(x,x')$
is locally constant. It is also easy to verify that $\tau_{x,x'}$ relates the two local section structures.
Our desired structured sc$^+$-multisection for $W|\partial X$ is given by
$[\Lambda,\mathfrak{U},\mathfrak{S},\tau]$.  At this point we can apply Theorem \ref{p-main-p}
to construct the extension.
\qed \end{proof}







\chapter{Transversality and Invariants}\label{CHAPX16}
In this chapter we shall describe some elements of a global perturbation theory.


\section{Natural Constructions}\label{SEC141}
We assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid and  consider for a smooth $x\in X$ the set of all sc-Fredolm operators $L\colon T_xX\rightarrow W_x$.  We define 
the set $\text{Gr}_F(x)$ whose elements are finite formal sums with non-negative rational coefficients of  sc-Fredholm operators.
An element of $\text{Gr}_F(x)$ has the form  
$$
\mathsf{L}=\sum\sigma_L\cdot L,
$$
where all $\sigma_L$ are non-negative and only a finite number are nonzero, and $L:T_xX\rightarrow W_x$.
Finally we put
$$
\text{Gr}_F(X)=\bigcup_{x\in X_\infty} \text{Gr}_F(x). \index{${\text{Gr}}_F(x)$}
$$
and write  $\pi:\text{Gr}_F(X)\rightarrow X_\infty$ for the  natural projection.
Note that for a smooth $x$, a sc-Fredholm operator $L:T_xX\rightarrow W_x$, and a morphism $\phi$ with $s(\phi)=x$ 
we can define $\phi_\ast L:T_{t(\phi)}X\rightarrow W_{t(\phi)}$ by 
$$
\phi_\ast L \circ T\phi (h) =\mu(\phi, L(h)),\ h\in T_xX.
$$
Hence $\phi:x\rightarrow y$ defines a bijection $\text{Gr}_F(x)\rightarrow \text{Gr}_F(y)$ via
$$
\phi_\ast(\sum\sigma_L\cdot L) =\sum\sigma_L\cdot \phi_\ast L.
$$
Elements in 
$\text{Gr}_F(X)$ can be viewed as objects of a category, where the morphism set consists of all pairs 
$(\phi,\mathsf{L})$ with $s(\phi)=\pi(\mathsf{L})$. The source map and target map are given by
$$
s(\phi,\mathsf{L})=\mathsf{L}\ \ \text{and}\ \  t(\phi,\mathsf{L})=\phi_\ast \mathsf{L}.
$$
The first result is the following.
\begin{theorem}[Well-defined $\mathsf{T}_{(f,\Lambda)}$]\label{THM1511} \index{T- Well-defined  $\mathsf{T}_{(f,\Lambda)}$}
Assume $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid,  $f$ an sc-Fredholm section, and 
 $\Lambda:W\rightarrow {\mathbb Q}^+$ an sc$^+$-multisection. Then there exists an associated section functor
 $\mathsf{T}_{(f,\Lambda)}$ of $\text{Gr}_F(X)\rightarrow X_\infty$ uniquely characterized by the following properties.
 \begin{itemize}
 \item[{\em(1)}] \  $\mathsf{T}_{(f,\Lambda)}(x)=0$ for $x\in X_\infty\setminus \supp(\Lambda\circ f)$.
 \item[{\em(2)}]\  For $x\in \supp(\Lambda\circ f)$ and any local sc$^+$-section structure ${(s_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ describing 
 $\Lambda$ around $x$ it holds 
 $$
 \mathsf{T}_{(f,\Lambda)}(y) = \sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot (f-s_i)'(y)\ \ \text{for smooth}\ \ y \ \text{near}\ x.
 $$
 \end{itemize}
\end{theorem}
\begin{remark}\index{R- On linearizations}
If $f(y)-s_i(y)\neq 0$ the expression $(f-s_i)'(y)$ is not defined, but it is also not counted towards the sum.
Setting the empty sum equal to $0$ property (1) follows from (2).
\qed
\end{remark}
\begin{proof}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, $f$ an sc-Fredholm section and $\Lambda$ an sc$^+$-multisection.
Assume that $x\in \supp(\Lambda\circ f)$  and pick an open neighborhood $U(x)$ with the natural $G_x$-action and 
a local sc$^+$-section structure ${(s_i)}_{i\in I}$, ${(\sigma))}_{i\in I}$.
We need to analyze the formal sum
$$
\sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot (f-s_i)'(y)\ \ \text{for}\ \  y\in U(x)\cap X_\infty.
$$
Without loss of generality we may assume that $X=O$, where $(O,C,E)$ is a local model and  $x=0\in O$.
Also $W\rightarrow O$ is a strong bundle model and the local sc$^+$-section structure 
${(s_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$, is defined on $O$.
\begin{proposition}\label{PROP1561}
There exists a sequence $(x_k)\subset  O$
with $x_k\neq 0$ and $x_k\rightarrow 0$ with the following property.
\begin{itemize}
\item For $i,i'\in I_e$ it holds that $s_i=s_{i'}$ near $x_k$.
\end{itemize}
\end{proposition}
The proof of the proposition relies on several lemmata.
\begin{lemma}
 Equip $O$ with the metric $d$ induced from $E_0$ and pick $y\in O$. 
Define $B_\varepsilon(y)=\{z\in O\ |\ d(z,y) < \varepsilon\}$ for some $\varepsilon>0$, and 
assume that $B_\varepsilon(y)$ can be written as a finite union 
$$
B_\varepsilon(y)=\bigcup_{i\in I} \Sigma_i
$$
of closed subsets $\Sigma_i$ of $B_\varepsilon(y)$. Then at least one of the sets $\Sigma_i$ has a nonempty interior.
\end{lemma}
\begin{proof}
Pick any $z\in B_\varepsilon(y)$ and, since every $\Sigma_i$ is closed, we can pick a $\delta$ such that
\begin{itemize}
\item $B_\delta(z)\subset B_\varepsilon(y)$.
\item For every $i\in I$ it holds that  $B_\delta(z)\cap\Sigma_i=\emptyset$ if and only if $z\not\in\Sigma_i$.
\end{itemize}
Denote by $K\subset I$ the subset consisting of the indices $i$ with $z\not\in \Sigma_i$. 
We note that moving $z$ slightly still $z\not\in\Sigma_i$ for $i\in K$.
We use this as follows. Take $i_1\in I\setminus K$ so that $z\in\Sigma_{i_1}$. If $z$ does not lie in the interior 
we can move it slightly to obtain $z_1$ so that $z_1\not\in \Sigma_i$ for $i\in K':=K\cup\{i_1\}$.
Define $K_1=\{i\in I\ |\ z_1\not\in\Sigma_i\}$. 
 We continue this process which at each step increases the set $K$ by at least one element and note that before we run out of indices
we find one for which $z$ lies in the interior. 
\qed \end{proof}
\begin{lemma}
Let $y\in O$ and $\varepsilon>0$. Then there exists a point $z\in O$ with $d(z,y)<\varepsilon$,
a  $\delta>0$, and a partition $I_1,...,I_p$ of $I$ such that 
\begin{itemize}
\item[{\em (1)}]\  $B_\delta(z)\subset B_\varepsilon(y)$.
\item[{\em(2)}]\ $s_i(w)=s_{i'}(w)$ for $w\in B_\delta(z)$, $i,i'\in I_e$ and $e=1,..,p$.
\item[{\em(3)}] \  $s_i(w)\neq s_j(w)$ for $w\in B_\delta(z)$ and $i\in I_e$, $j\in I_{e'}$ for $e\neq e'$.
\end{itemize}
\end{lemma}
\begin{proof}
Take a point $y\in O$ and fix an index $i_1\in I$. Consider on ${B}_\varepsilon(y)$ 
the sets $\Sigma_{j}:=\{z\in {B}_\varepsilon(y)\ |\ s_j(z)=s_{i_1}(z)\}$ and define $\bigcup_{j\neq i_1} \Sigma_j$. The latter set is closed 
in $B_\varepsilon(y)$. 
If its complement in ${B}_\varepsilon(y)$ is nonempty we can pick a point $z_1$ which has a neighborhood $B_{\delta_1}(z_1)$
on which every $s_j$ is point-wise different from $s_{i_1}$. We define $I_1=\{i_1\}$.
If $ \bigcup_{j\neq i_1} \Sigma_j={B}_\varepsilon(y)$
then there exists $j\neq i_1$ for which $\Sigma_{j}$  has a nonempty interior. We can take a point $z$ in this interior
and by slightly moving it we may assume that either $z$ belongs to the interior of some $\Sigma_k$ or it does not belong to
$\Sigma_k$. We pick such a $z_1$ and define $I_1=\{j\in I\ |\ s_j(z_1)=s_{i_1}(z_1)\}$. We also find $\delta >0$ such that
\begin{itemize}
\item $s_i(w)=s_{i'}(w)$ for $w\in B_{\delta_1}(z_1)$ and $i,i'\in I_1$.
\item  $B_{\delta_1}(z_1)\subset B_\varepsilon(y)$.
\item  $s_k(w)\neq s_{i}(w)$ for $w\in B_{\delta_1}(z_1)$, $i\in I_1$ and $k\not\in I_1$.
\end{itemize}
We note that moving $z_1$ less than $\delta_1$  the properties listed above are still true for a suitably
chosen smaller $\delta_2$.

In a next step we take an index $i_2\not\in I_1$ (if $I_1\neq I$)  and find $z_2$ with $d(z_2,z_1)<\delta_1/4$
and argue as before to obtain a set $I_2$ disjoint from $I_1$ which has the above properties 
for some $\delta_2< \delta_1/4$ and $I_2$. Note that the properties above persist for $I_1$ and
$\delta_2$ as well.  Proceeding inductively we obtain $\delta>0$ and $z$ having the properties
stated in the lemma.
\qed \end{proof}
\begin{proof}[Proof of Proposition \ref{PROP1561}]
We pick a sequence of points $(y_k)$  in $O$ with $y_k\neq 0$ and $y_k\rightarrow 0$.
We also take a sequence $\varepsilon_k\rightarrow 0$. We find sequences $(z_k)$ and $\delta_k>0$
such that $d(y_k,z_k)<\varepsilon_k$ and  the following holds:
\begin{itemize}
\item For every $k$ there is a partition of $I$, say $I=I^k_1\sqcup....\sqcup I^k_{p_k}$
so that $s_i(w)=s_{i'}(w)$ for $d(w,z_k)<\delta_k$ and $i,i'\in I^k_e$, where $e\in \{1,..,p_k\}$.
\item $s_i(w)\neq s_j(w)$ for $d(z_k,w)<\delta_k$, $i\in I^k_e$, $j\in I^k_{e'}$ and $e\neq e'$.
\end{itemize} 
After perhaps taking a first subsequence of $(z_k)$ we may assume that $I_1^k$ is constant.
Then we can take  of this subsequence another  subsequence so that $I^k_2$ is constant.
Proceeding this way we find after a finite sumber of steps a sequence $(x_k)$ converging to $0$
so that the assertion of our proposition holds. 
\qed \end{proof}

Next take a second local sc$^+$-section  structure ${(t_j)}_{j\in J}$, ${(\tau_j)}_{j\in J}$, where 
we again work on the local model $W\rightarrow O$ with $x=0$.  Define a partition of $J$
denoted by $J_1^k,...,J_p^k$ by setting
$$
J_e^k=\{j\in J\ |\ t_j(x_k)=s_{i_e}(x_k)\},
$$
where $i_e\in I_e$.  After taking a subsequence of $(x_k)$  we may assume that this partition
is independent of $k$.  Hence, without loss of generality  we  conclude for  $(x_k)$
that there are partitions 
$$
I=I_1\sqcup..\sqcup I_e\ \ \text{and}\ \ J=J_1\sqcup...\sqcup J_e
$$
where $I_e $ and $J_e$ correspond via the requirement that $s_{i_e}(x_k)=t_{j_e}(x_k)$. Moreover
$s_i=s_{i'}$ near $x_k$ if and only if they belong to the same $I_e$ and the same for $(t_j)$ with respect to
the partition of $J$. Also note that $t_j(z)=t_{j'}(z)$ for $z$ near $x_k$ provided $j,j'$ belong to the same $J_e$.
We deduce for $z$ near $x_k$
$$
\sum_{i\in I_e} \sigma_i =\Lambda(s_{i_e}(z))=\sum_{j\in J_e} \tau_j.
$$
We can say for $z$ near $x_k$  that the sc$^+$-section  $z\rightarrow s_{i_e}(z)$ occurs with multiplicity $\sigma^e:=\sum_{i\in I_e}\sigma_i$
and similarly $t_{j_e}$ which equals $s_{i_e}$ for $z$ near $z_k$ occurs with the multiplicity $\tau^e:=\sum_{j\in J_e}\tau_j$
which equals $\sigma^e$.  Of course, $s_{i_e}$ and $t_{j_e}$ are equal near $x_k$.
We note that the formal sums
$$
\sum_{e=1}^p \sigma^e\cdot T(f-s_{i_e})(x_k)
$$
and
$$
\sum_{e=1}^p \tau^e\cdot T(f-t_{j_e})(x_k)
$$
are equal and converge to $ \sum_{e=1}^p \sigma^e\cdot T(f-s_{i_e})(0)$ and 
$\sum_{e=1}^p \tau^e\cdot T(f-t_{j_e})(0)$ respectively, which have to be equal. Moreover, it follows
that
$$
\sum_{i\in I} \sigma_i\cdot T(f-s_i)(0)=\sum_{j\in J} \tau_j\cdot T(f-t_j)(0).
$$
Since $f(0)=s_i(0)$ and $f(0)=t_j(0)$ we conclude that 
$$
\sum_{i\in I} \sigma_i\cdot (f-s_i)'(0)=\sum_{j\in J} \tau_j\cdot (f-t_j)'(0).
$$
This completes the proof of Theorem \ref{THM1511}.
\qed \end{proof}
In view of the fact that 
$$
\mathsf{T}_{(f,\Lambda)}:X_\infty\rightarrow \text{Gr}_F(X)
$$
is well-defined we can make the following definition.
\begin{definition}\index{$\mathsf{T}_{(f,\Lambda)}$}\index{D- Linearization of $\Lambda\circ f$}
Let $(P:W\rightarrow X,\mu)$  be a strong bundle over an ep-groupoid,  $f$ an sc-Fredholm section, and 
 $\Lambda:W\rightarrow {\mathbb Q}^+$ an sc$^+$-multisection. We shall call 
 $\mathsf{T}_{(f,\Lambda)}$ the {\bf linearization of $\Lambda\circ f$} at the points in $\supp(\Lambda\circ f)$.
 Also we shall call for $x\in\supp(\Lambda\circ f)$ the expression  $\mathsf{T}_{(f,\Lambda)}(x)$ the linearization 
 of $\Lambda\circ f$ at $x$.
\end{definition}
As we shall see transversality questions are related to the behavior of $\mathsf{T}_{(f,\Lambda)}$.
We note that there is also an oriented version of the previous discussion which, however, is postponed to Section 
\ref{SEC153}.   



\section{Transversality and Local Solution Sets}


In applications involving complicated moduli spaces it often occurs that perturbations  have to adhere to additional structures, limiting the transversality which can be achieved.
  The properties of  $\mathsf{T}_{(f,\Lambda)}$  control the geometry of 
$\supp(\Lambda\circ f)$ to first order.  Before we go deeper into transversality questions it is worthwhile to point out that as a rule of thumb
every transversality question within the polyfold theory can be resolved, provided  related finite-dimensional questions in an orbibundle context can be solved. Hence, the reader familiar with standard finite-dimensonal transversality questions, will be able to apply her/his insights in the polyfold context.


\begin{definition}\index{D- Transversality}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, 
$f$ an sc-Fredholm section functor, and $\Lambda$ an sc$^+$-multisection.
\begin{itemize}
\item[(1)]\  $(f,\Lambda)$ is said to be {\bf transversal}\index{D- Transversal pair $(f,\Lambda)$} provided for every $x\in \supp(\Lambda\circ f)$
the linearization $\mathsf{T}_{(f,\Lambda)}$ at the point $x$ is a nonzero combination of surjective sc-Fredholm operators, i.e. if ${(s_i)}_{i\in I}$
is a local sc$^+$-section structure for $\Lambda$, and $f(x)=s_i(x)$ for $i\in I$, then all the $(f-s_i)'(x):T_xX\rightarrow W_x$ are surjective.
\item[(2)]\   If $x\in X$ with $\Lambda\circ f(x)>0$ we say that $(f,\Lambda)$ is {\bf transversal at $x$}\index{D- Transversal at $x$} provided
$\mathsf{T}_{(f,\Lambda)}(x)$ is a nonzero combination of surjective sc-Fredholm operators.
\end{itemize}
We shall say that $\mathsf{T}_{(f,\Lambda)}(x)$ is {\bf onto} or {\bf surjective} \index{Surjectivity of  $\mathsf{T}_{(f,\Lambda)}(x)$} at a point $x$  in $\supp(\Lambda\circ f)$ provided every
occurring sc-Fredholm operator with positive weight is onto.
\qed
\end{definition}


This notion of transversality has strong implications provided $d_X(x)=0$. 
\begin{theorem}[Interior local perturbation]\label{THM1524}\index{T- Interior local perturbation}
Assume  $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid, 
$f$ an sc-Fredholm section functor, and $\Lambda$ an sc$^+$-multisection functor.
Suppose   $x\in \supp(\Lambda\circ f)$ with $d_X(x)=0$  and $(f,\Lambda)$ is transversal  at $x$.  
Then there exists an open neighborhood $U(x)$ equipped with the natural $G_x$-action so that the following holds true
with $M_{U(x)}=\{y\in U(x)\ |\ \Lambda\circ f(y)>0\}$.
\begin{itemize}
\item[{\em (1)}]\  $d_X(y)=0$ for all $y\in U(x)$.
\item[{\em(2)}] \ $\mathsf{T}_{(f,\Lambda)}(y)$ is onto for every $y\in M_{U(x)}$.
\item[{\em (3)}] \  There exist submanifolds  ${(M_i)}_{i\in I}$ and positive rational weights ${(\sigma_i)}_{i\in I}$ 
with the following properties:
\begin{itemize}
\item[{\em (a)}] \ Every $M_i$ has $d_{M_i}\equiv 0$ and therefore has a natural (classical) smooth manifold structure.
\item[{\em (b)}]\ Every $M_i$ is properly embedded in $U(x)$.
\item[{\em (c)}]\ $M_{U(x)} =\bigcup_{i\in I} M_i$. 
\item[{\em (d)}]\ For every $y\in U(x)$ the identity 
$\Lambda\circ f(y)=\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i$
holds.
\item[{\em(e)}] \  $T_{(f,\Lambda)}(y) =\sum_{\{i\in I\ |\ f_i(y)=s_i(y)\}} \sigma_i\cdot (f-s_i)'(y)$ for $y\in U(x)$ and $T_{(f,\Lambda)}(y)$ is surjective
provided $y\in \supp(\Lambda\circ f)$.
\end{itemize}
\end{itemize}
\end{theorem}
\begin{proof}
This follows  from Theorem \ref{IMPLICIT0}. Pick an open neighborhood $U'(x)$
which allows the natural $G_x$-action and a local sc$^+$-section structure ${(s_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$ on $U'(x)$
representing $\Lambda$ over $U'(x)$.

By assumption $f(x)=s_i(x)$ for $i\in I$.  Since $\mathsf{T}_{(f,\Lambda)}(x)$ is onto it follows that $(f-s_i)'(x)$ is onto
and the implicit function theorem gives for every $i\in I$ a solution set $M_i$ containing $x$ so that there exists an open neighborhood
$U_i(x)$ satisfying
\begin{itemize}
\item $M_i'=\{y\in U_i(x)\ |\ f(y)=s_i(y)\}$, $d_{M_i'}\equiv  0$, and $M_i'$ is a submanifold and consequently has 
an equivalent smooth manifold structure without boundary.
\item $(f-s_i)'(y):T_yX\rightarrow W_y$ is surjective for every $y\in M_i'$.
\end{itemize}
We find an open neighborhood $U(x)\subset U'(x)\bigcap\left(\bigcap_{i\in I} U_i(x)\right)$ which is invariant under $G_x$.
Then we define $M_i:=M_i'\cap U(x)$, and  by construction for $y\in M_{U(x)}:=\{y\in U(x)\ |\ \Lambda\circ f(y)>0\}$ the assertion 
(3) holds.
\qed \end{proof}
\begin{remark}\index{R- On transversality theory using sc$^+$-multisections}
We observe that on the ep-groupoid $U(x)$ the functor $\Theta:U(x)\rightarrow {\mathbb Q}^+$
defined by
$$
U(x)\rightarrow {\mathbb Q}^+:z\rightarrow \Lambda\circ f(z)
$$
is a branched, tame  ep$^+$-subgroupoid of $U(x)$ with support $M_{U(x)}$. We may think of transversality theory
as finding small $\Lambda:W\rightarrow {\mathbb Q}^+$ so that $\Lambda\circ f$ becomes a branched ep$^+$-subgroupoid, see Definition \ref{DEF912},
or at least a functor with reasonable properties.
\qed
\end{remark}

The situation becomes more complicated at points $x$ with $\Lambda\circ f(x)>0$ and $d_X(x)\geq 1$.
In this case we need additional information. For example if  $\partial X$ has some structure
near $x$ and $(\Lambda,f)$  lies in a reasonable position to $\partial X$ the solution space associated to $\Lambda\circ f(y)>0$ will have a good structure near $x$.
A version of Definition \ref{new_good_position_def} reads as follows.
\begin{definition}\index{D- Good position of $(f,\Lambda)$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, $f$ an sc-Fredholm section and $\Lambda$
an sc$^+$-multisection functor. 
Assume that $x\in \partial X$ satisfies $\Lambda\circ f(x)>0$.
We say that $(f,\Lambda)$ is in {\bf good position} at $x$ provided
\begin{itemize}
\item[(1)] \  $X$ is tame near $x\in X$.
\item[(2)] \ $(f,\Lambda)$ is transversal  at $x$, i.e. $\mathsf{T}_{(f,\Lambda)}(x)$ is surjective.
\item[(3)]\   The surjective sc-Fredholm operators $L_i$  of $\mathsf{T}_{(f,\Lambda)}(x)=\sum_{i\in I}\sigma_i\cdot L_i$
have kernels $\ker(L_i)$ which are in good position to the partial quadrant $C_xX$, see Definition \ref{mission1}.
\end{itemize}
\qed
\end{definition}
Next we describe the solution set near a point $x$ with $d_X(x)\geq 1$ and $\Lambda\circ f(x)>0$.
\begin{theorem}[Boundary local perturbation]\label{THMXXC1525} \index{T- Boundary local perturbation}
 Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, $f$ an sc-Fredholm section and $\Lambda$
 a sc$^+$-multisection functor.
 Suppose $x\in \partial X$ with $\Lambda\circ f(x)>0$ and $(f,\Lambda)$ is in good position at $x$.  
 There exist an open neighborhood $U(x)$ with the natural $G_x$-action, tame submanifolds  ${(M_i)}_{i\in I}$ and positive rational weights ${(\sigma_i)}_{i\in I}$ 
with the following properties, where $M_{U(x)}=U(x)\bigcap\left(\bigcup_{i\in I} M_i\right)$.
\begin{itemize}
\item[{\em (1)}]\  Every $M_i$ is properly embedded in $U(x)$.
\item[{\em (2)}]\ $\mathsf{T}_{(f,\Lambda)}(y)$ is surjective for all $y\in M_{U(x)}$ and the kernels of the 
surjective sc-Fredholm operators with positive weights are in good position to $C_yX$.
\item[{\em (3)}] \ For every $y\in U(x)$ the identity 
$\Lambda\circ f(y)=\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i$
holds.
\end{itemize}
Note that the tame $M_i$ have equivalent smooth structures as manifolds with boundary with corners.
We also note that by definition $\Lambda\circ f: U(x)\rightarrow {\mathbb Q}^+$ is a tame (see Definition \ref{TAMERXX}) branched ep$^+$-subgroupoid,
since it is represented by tame $M_i$. The same conclusion holds if (2) is replaced by the general position requirement 
that the restrictions of $T_{(f,\Lambda)}(y)$ to $T_y^RX$ are surjective, see also the upcoming Definition \ref{DEFRT1535}.
 \end{theorem}
 \begin{proof}
 The proof follows along the lines of the proof of Theorem \ref{THM1524} using as ingredient
 the implicit function theorem for sc-Fredholm sections in the M-polyfold context, when
 the linearization is onto and the kernel is in good position to a tame $\partial X$, see Theorem \ref{IMPLICIT0}.
 We leave the details to the  reader.
 \qed \end{proof}
Before we start with the global perturbation theory we make a remark concerning orientations.
The details will be carried out in a larger context in Section \ref{SEC153}.
\begin{remark}[Formalism for orientations]\index{R- On the formalism for orientations}
Using results from Section \ref{SEC141} we can extend the previous discussion and incorporate 
orientations. 
In  this case we start with a strong bundle over an ep-groupoid $(P:W\rightarrow X, \mu)$, and oriented 
sc-Fredholm section functor $(f,\mathfrak{o})$ and an sc$^+$-multisection $\Lambda:W\rightarrow {\mathbb Q}^+$.
Assume that $(f,\Lambda)$ is transversal  at $x$,  and if $d_X(x)\geq 1$ we assume in addition that it is in good position.
Then we  can write with  the help of a local branching structure on $U(x)$, involving tame $M_i$ and suitable weights,
$$
\Lambda\circ f(y) = \sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i,\ \ y\in U(x).
$$
This time, however, each $M_i$ inherits an orientation $o_i$ from $\mathfrak{o}$, which we have to keep track of.
For this we consider the formal sum
$$
\mathsf{T}_{((f,\mathfrak{o}),\Lambda)}(y) =\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i\cdot ((f-s_i)'(y),o_{(f-s_i)'(y)})
$$
for $y\in M_{U(x)}$. Since the $(f-s_i)'(y)$ are surjective and oriented we obtain an orientation $o_{i,y}$ for $T_yM_i$ 
so that we can pass to the formal sum
$$
\wh{\mathsf{T}}_{((f,\mathfrak{o}),\Lambda)}(y)=\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i\cdot (T_yM_i,o_{i,y}).
$$
 A priori all this might depend on the choice of the local sc$^+$-section structure, but as we shall see later it does not.
 We note that  $\wh{\mathsf{T}}_{((f,\mathfrak{o}),\Lambda)}$ can be viewed as an oriented lift of 
 the tangent $\mathsf{T}_{\Lambda\circ f}$ of the ep$^+$-subgroupoid $\Lambda\circ f$.
  The upshot will be that $\wh{\mathsf{T}}_{((f,\mathfrak{o}),\Lambda)}$
 is the natural orientation of $\Lambda\circ f$ coming from $(f,\mathfrak{o})$.  
 \qed
 \end{remark}

 
 
 
 
\section{Perturbations}
In this section we shall consider a strong bundle $(P:W\rightarrow X,\mu)$ over a tame ep-groupoid.   Assume that $f$ is an sc-Fredholm section functor
 of $P$. Then the associated solution category is $S_f=\{x\in X\ |\ f(x)=0\}$ and we assume as a standing assumption that
 the orbit space $|S_f|$ is compact, see Section \ref{SEC114}. Our aim is to study perturbations of $f$. As already previously pointed out,  as a rule of thumb, whatever would be possible in finite dimensions by multisection perturbations, will be possible in the ep-groupoid set-up as well (provided we have
 sc-smooth bump functions).
 Moreover, in most cases, what would be possible in a Sard-Smale perturbation theory without symmetries, see \cite{Smale}, 
 is possible to achieve by sc$^+$-multisection perturbations in cases of symmetry, i.e. the ep-groupoid setup.
 The price to be paid, since the latter is a perturbation theory over ${\mathbb Q}$, is that on a homological level, when studying solution spaces, 
 only a theory over ${\mathbb Q}$ can be used, unless, of course, one can use in a given instance less general perturbations, f. e. single-valued perturbations.
 
We  equip $W$  with an auxiliary 
 norm $N:W_{0,1}\rightarrow {\mathbb R}^+$, see Definition \ref{auxuilary_norm_def}. We can always extend 
 an auxiliary norm to all of $W$ by defining $N(h)=+\infty$ if $h$ is not of bi-regularity $(0,1)$. Hence without loss of generality 
 we always assume that $N:W\rightarrow {\mathbb R}^+\cup\{+\infty\}$.
As a consequence of the discussion in Section \ref{SEC114} there exists an open saturated  neighborhood $U$ of the {\bf solution category}\index{Solution category $S_f$}\index{$S_f$}
$S_f=\{x\in X\ |\ f(x)=0\}$ so that 
the orbit space of the set $\{x\in U\ |\ N(f(x))\leq 1\}$ has compact closure in $|X|$. 
\begin{definition}\index{D- Compactness control $(N,U)$}
Assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over the ep-groupoid $X$ having a paracompact orbit space $|X|$.
Let $N:W\rightarrow [0,\infty]$ be an auxiliary norm and $f$ an sc-Fredholm section functor. Denote by $S_f$  the solution category associated to $f$.
Suppose that $U$ is a saturated open neighborhood of $S_f$.  
 We shall say that $(N,U)$ {\bf controls
the compactness} of $f$ provided the set $\{x\in U\ |\ N(f(x))\leq 1\}$ has an orbit space in $|X|$ which has a compact closure.
\qed
\end{definition}

In the following the relevant data for us is $(P:W\rightarrow X,\mu)$, $f$, and $(N,U)$.
Here $(P,\mu)$ is a strong bundle, $f$ is an sc-Fredholm section, and $(N,U)$  controls compactness, where $U$ is saturated open neighborhood of $S_f$.
We also assume that $X$ admits sc-smooth bump functions so that we can construct sc$^+$-multisections.
One of the aims  of the following considerations is to show the existence of many sc$^+$-multisection functors $\Lambda:W\rightarrow {\mathbb Q}^+$,
having domain support in $U$, having small point-wise norm, say  $N(\Lambda)(x)<1$ for $x\in X$, such that 
$$
\Lambda\circ f:X\rightarrow {\mathbb Q}^+
$$
is a tame branched ep$^+$-subgroupoid, and possibly having other additional properties.  The point-wise norm $N(\Lambda)$ is introduced in
Definition \ref{DEF1223}.
\begin{remark}\index{R- Bump functions or geometric perturbations}
In general we need the existence of sc-smooth bump functions to construct the sc$^+$-multisections for our perturbations.
In concrete situations,  one might be able to use more geometric maps to construct these perturbations. In these cases
compactness after perturbation might not follow from general principles and would have to be checked. 
\qed
\end{remark}



\begin{definition}\index{D- Admissible perturbation}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, $f$ an sc-Fredholm section functor 
with $|S_f|$ being compact. Assume  $N$ is  an auxiliary norm and $U$ a saturated open neighborhood of $S_f$, so that $(N,U)$ controls compactness.
 An {\bf $(N,U)$-admissible perturbation} for $f$  is an sc$^+$-multisection $\Lambda:W\rightarrow {\mathbb Q}^+$
so that $N(\Lambda)(x)\leq 1$ for all $x\in X$ and the set
$$
\{x\in X\ |\ \exists\ t\in[-1,1]\ \text{with}\ (t\odot \Lambda)(f(x))>0\}
$$
is a subset of $U$.
\qed
\end{definition}
For example if the domain support of $\Lambda$ belongs to $U$ and $N(\Lambda)(x)\leq 1$ for all $x\in X$, then 
$\Lambda$ is admissible.   Indeed, assume that  $x\not\in U$ and solves $\Lambda\circ f(x)>0$.   Then  $\Lambda(h)=0$ for $h\in W_x\setminus \{0_x\}$, which implies
that $f(x)=0$ so that $x\in S_f\subset U$ giving a contradiction.
Admissible perturbations behave well under products. To see this assume we have two sets of data and take the product
so that $f\times f'$ is an sc-Fredholm section of $W\times W'\rightarrow X\times X'$. The auxiliary norm is defined
by $(N\times N')(h,h') =\text{max}\{N(h),N'(h')\}$. Given for the  two problems sc$^+$-section functors $\Lambda$ and $\Lambda'$, 
we define $\Lambda\times\Lambda':W\times W'\rightarrow {\mathbb Q}^+$ by
$$
(\Lambda\times\Lambda')(h,h')=\Lambda(h)\cdot \Lambda'(h'),
$$
which defines an sc$^+$-multisection functor.
Assume that $\Lambda$ is admissible with respect to $(N,U)$ and $\Lambda'$ with respect to $(N',U')$.
We observe that 
$$
(N\times N')(\Lambda\times\Lambda')(x,x')=\text{max}\{N(\Lambda)(x),N'(\Lambda')(x')\}\leq 1.
$$
Moreover assume that $(t\odot (\Lambda\times\Lambda'))\circ (f\times f')(x,x')>0$. This implies  that
$((t\odot \Lambda)\circ f(x))\cdot ((t\odot\Lambda')\circ f'(x'))>0$ from which we deduce that $(x,x')\in U\times U'$.
Note that we used the identity $t\odot(\Lambda\times\Lambda') = (t\odot\Lambda)\times (t\odot\Lambda')$.
\begin{remark}\index{R- On fibered products of sc$^+$-multisection functors}
The reader should note that if $\Lambda$ has domain support in $U$, and $\Lambda'$ domain support in $U'$,
the domain support of $\Lambda\times \Lambda'$ lies in $(U\times X' )\cup (X\times U')$ and not necessarily in 
$U\times U'$.  
\qed
\end{remark}
Next we define what it means to be in general position.
\begin{definition}\index{D- General position}\label{DEFRT1535}
Let $f$ be an sc-Fredholm section of $P$ where $(P:W\rightarrow X,\mu)$ is a strong bundle over a tame ep-groupoid $X$.
Assume further that $\Lambda:W\rightarrow {\mathbb Q}^+$ is an sc$^+$-multisection. 
We say that $(f,\Lambda)$ is in {\bf general position} provided for every $x\in \supp(\Lambda\circ f)$
the linearization $\mathsf{T}_{(f,\Lambda)}(x)$ restricted to the reduced tangent space at $x$ is surjective, i.e.
if $\mathsf{T}_{(f,\Lambda)}(x)=\sum_{i\in I} \sigma_i\cdot L_i$, where $\sigma_i>0$, then 
$$
L_i|T_x^RX:T^R_xX\rightarrow W_x
$$
is surjective for every $i\in I$. This is a natural extension of the Definition \ref{DEF_539}.
We shall call the restriction of $\mathsf{T}_{(f,\Lambda)}(x)$ to $T^R_xX$ the {\bf reduced linearization}\index{D- Reduced linearization} and denote it by
$\mathsf{T}_{(f,\Lambda)}^R(x)$. Hence $\mathsf{T}_{(f,\Lambda)}^R(x)=\sum_{i\in I} \sigma_i\cdot L_i|T^R_xX$.
\qed
\end{definition}
\begin{remark}\index{R- On good position and general position}
If $(f,\Lambda)$ is in general position then for every $x\in \supp(\Lambda\circ f)$ the linearization  $\mathsf{T}_{(f,\Lambda)}(x)$
is onto. If $x$ also happens to belong to the boundary $\partial X$ we have that $\mathsf{T}_{(f,\Lambda)}(x)$ is in good position, in fact even in general position.
In particular it follows that $\Lambda\circ f:X\rightarrow {\mathbb Q}^+$ is a tame branched ep$^+$-groupoid.\qed
\end{remark}
The next result shows that we always can force by a small perturbation a general position. Of course, if the perturbations are restricted 
by additional requirements that might not be possible. The reader should recall Theorem \ref{p:=}, Theorem \ref{thm_pert_and_trans} and Theorem \ref{SARD}
which deal with the case of strong bundles over a tame M-polyfold. The ideas used there are straight forward generalizations of the finite-dimensional case.
The following result is an adaption to the corresponding ep-groupoid case. The proof of this theorem follows along the lines of a similar result in \cite{HWZ3.5}. 

\begin{theorem}[General Position]\label{THM1536}\index{T- General position}
Assume $(P:W\rightarrow X,\mu)$  is a strong bundle over a tame ep-groupoid admitting sc-smooth bump functions, and 
 $f$ a  sc-Fredholm section functor with compact solution set $|S_f|$. Let $N$ be an 
 auxiliary norm and $U$ be a saturated subset of $X$ containing $S_f$
 so that $(N,U)$ controls compactness. Given  any continuous functor $h:X\rightarrow (0,1]$, 
 there exists an sc$^+$-multisection functor $\Lambda:W\rightarrow {\mathbb Q}^+$ with the following properties.
 \begin{itemize}
 \item[{\em (1)}] \  $N(\Lambda)(x)<h(x)$ for all $x\in X$.
 \item[{\em (2)}]\   The domain support of $\Lambda$ is contained in $U$.
 \item[{\em (3)}]\ $\mathsf{T}_{(f,\Lambda)}$ is surjective on $\supp(\Lambda\circ f)$.
 \item[{\em (4)}] \  For $x\in \supp(\Lambda\circ f)$ the kernels of the operators from $\mathsf{T}_{(f,\Lambda)}(x)$ are in general position
 to $\partial X$.
 \end{itemize}
 In particular $\Lambda\circ f:X\rightarrow {\mathbb Q}^+$ is a compact, tame, branched ep$^+$-subgroupoid.
 Also the perturbation $\Lambda$ can be taken  to be structurable (!).
 \end{theorem}
\begin{proof}
 We shall construct a structurable perturbation 
with the claimed properties. Point (4) is equivalent to the requirement that for $x\in \supp(\Lambda\circ f)$ the 
reduced linearization $T^R_{(f,\Lambda)}(x)$ is onto. The basic idea of the proof is as follows. One constructs for a large parameter space ${\mathbb R}^h$, i.e. 
$h>>0$, a family $\Lambda_t:W\rightarrow {\mathbb R}^{2n}$, $t\in {\mathbb R}^h$,  of structured sc$^+$-multisections, so that $\Lambda_0$ is the zero-section with weight $1$
and $\wt{\Lambda}:{\mathbb R}^h\times W\rightarrow {\mathbb Q}^+$ is an sc$^+$-multisection functor for the pull-back of $W$ by
${\mathbb R}^h\times X\rightarrow X$. The $\Lambda_t$ are constructed from local pieces with suitable properties so that
the  set $\{0\}\times S_f$ belongs to $\supp(\wt{\Lambda}\circ \wt{f})$, where $\wt{f}$ is defined by $\wt{f}(t,x)=(t,f(x))$, and moreover
$\mathsf{T}_{(\wt{f},\wt{\Lambda})}(0,x)$ is surjective for $x\in S_f$ when restricted to ${\mathbb R}^h\times T^R_xX$, or equivalently
the reduced $\mathsf{T}_{(\wt{f},\wt{\Lambda})}^R(0,x)$ are surjective.
This then implies that the solution set consisting of all $(t,y)$ near $\{0\}\times S_f$ is a finite-dimensional tame 
branched ep-subgroupoid. Applying an obvious  branched ep$^+$-groupoid version of Theorem \ref{SARD} the preimage of a suitable(!) small regular value $t_0$
for the projection
to ${\mathbb R}^h$ is the desired solution space and $\Lambda_{t_0}$ the structurable perturbation. Suitable here means that it is a regular value for restrictions to intersection of faces. The details are as follows.  \par

\noindent {\bf Local constructions at $x\in S_f$ with $d_X(x)=0$:} We pick smooth $w^1,...,w^\ell$ in $W_x$
so that $R(f'(x))$ together with $w^1,...,w^\ell$ span $W_x$. 
Pick an open neighborhood $U(x)$ which admits the $G_x$-action,
 has the properness property, so that in addition every $y\in U(x)$ satisfies $d_X(y)=0$. Let $V(x)$ be an open neighborhood
which is invariant under $G_x$ satisfying $\cl_X(V(x))\subset U(x)$. 
For every $w^j$ we can find an sc$^+$-section $s^j_1$ having the properties
\begin{itemize}
\item $s_1^j$ is defined on   $U(x)$  and $s_1^j(y)=0$ for $y\in U(x)\setminus V(x)$.
\item $s^j_1(x)=w^j$.
\item $N(s_1^j(y))\leq \text{min}\{1,h(y)\}$ for $y\in U(x)$.
\end{itemize}
Define  $s^{x,1}_{t}$ for $t\in {\mathbb R}^\ell$ by
$$
s^{x,1}_t(y)=\sum_{j=1}^\ell t_j\cdot s^j_1(y)\ \ \text{for}\ \ y\in U(x),\ t\in {\mathbb R}^\ell.
$$
We consider the local sc-Fredholm section $(t,y)\rightarrow f(y) -s^{x,1}_t(y)$ and note that the linearization at $(0,x)$ is surjective. 
Using the group elements  $g\in G_x$ we define for $y\in U(x)$ and $t\in {\mathbb R}^\ell$ 
$$
s^{x,g}_t(y) =\mu(\Gamma(g,g^{-1}\ast y),s^{x,1}_t(g^{-1}\ast y)).
$$
Of course, with $e\in G_x$ being the unit element we have that $s^{x,e}_t=s^{x,1}_t$.
Since $f(g\ast y) =\mu (\Gamma(g,y),f(y))$ it follows immediately  that the linearization of
$$
(t,y)\rightarrow f(y)-s^{x,g}_t(y)
$$
at $(0,x)$ is also surjective for every $g\in G$. The collection ${(s^{x,g}_t)}_{g\in G_x}$ is for fixed $t$ a symmetric local sc$^+$-section structure
and defines (for fixed $t$)  an atomic sc$^+$-multisection functor $\Lambda_t$. Hence for fixed $t$ it is structurable. 
Moreover, we can view ${\mathbb R}^\ell\times W$ as a strong bundle over ${\mathbb R}^\ell\times X$
and define $\wt{\Lambda}:{\mathbb R}^\ell\times W\rightarrow {\mathbb Q}^+$ by $(t,y)\rightarrow \Lambda_t(y)$.
We  define $\wt{f}(t,y)=(t,f(y))$, which is also an sc-Fredholm section. Clearly, since $x\in S_f$, it follows
that $(0,x)\in \supp(\wt{\Lambda}\circ \wt{f})$.  The linearization $\mathsf{T}_{(\wt{f},\wt{\Lambda})}(0,x)$  is by the previous 
discussion surjective  and from the local implicit function theorem we deduce the following.\par

\begin{itemize}
\item[(Interior)] \ \ \ \ \ \ \ \ \ \ There exists $\varepsilon_x>0$, and an open neighborhood $Q(x)$, invariant under $G_x$, and   contained in $U(x)$ 
such that $\{t\ |\ |t|<\varepsilon_x\}\times Q(x):(t,y)\rightarrow \Lambda_t^x\circ f(x)$ is a tame ep$^+$-subgroupoid. In addition, 
for $(t,y)$ in its support the linearization $\mathsf{T}_{(\wt{f}, \wt{\Lambda})}(t,y)$ is surjective. In particular, for every $x\in S_f\cap Q(x)$ the linearization 
$T_{(\wt{f},\wt{\Lambda})}(0,x)$ is surjective. The same assertion also holds for points $x$ in the saturation of $Q(x)$.
\end{itemize}



\noindent {\bf Local constructions at $x\in S_f$ with $d_X(x)\geq 1$:}  This part is similar to  the previous one, but we need
to be more careful in the construction, since ultimately we need to move the perturbed solution set into a general position.
We can find $U(x)$ and $V(x)$ as before, so that in addition $U(x)\cap \partial X$ has $d_X(x)$-many local faces, say $\Theta_1,...,\Theta_d$,
where $d=d_X(x)$. Then any finite intersection $\Theta_I=\bigcap_{i\in I} \Theta_i$  of such faces is a tame M-polyfold $\Theta_I$ containing $x$. Moreover $T_x^RX \subset T_x\Theta_I$.  We pick $w^1,...,w^\ell\in W_x$ such that the image of $f'(x)|T_X^RX$ together with the $w_i$
spans $W_x$. Of course, we can pick the $w_i$ as small as we wish. Now we proceed as in the previous case and construct
$\Lambda_t^x$, which again for fixed $t$ is structurable since it is atomic. By construction the associated $(\wt{f},\wt{\Lambda})$ 
is in general position at $(0,x)$. By the corresponding implicit function theorem we deduce the following.\par

\begin{itemize}
\item[(Boundary)] \ \ \ \ \ \ \ \ \ \ There exists $\varepsilon_x>0$, and an open neighborhood $Q(x)$ invariant under $G_x$  contained in $U(x)$ 
such that $\{t\ |\ |t|<\varepsilon_x\}\times Q(x):(t,y)\rightarrow \Lambda_t^x\circ f(x)$ is a tame ep$^+$-subgroupoid so that
for $(t,y)$ in its support the linearization $\mathsf{T}_{(\wt{f}, \wt{\Lambda})}(t,y)$ when restricted to the reduced tangent space
at $(t,y)$ is surjective. In particular, for every $x\in S_f\cap Q(x)$ the reduced linearization $\mathsf{T}^R_{(\wt{f},\wt{\Lambda})}(0,x)$ is surjective.
The same holds for $x\in S_f$ belonging in addition to the saturation of $Q(x)$.
\end{itemize}

\par


\noindent{\bf From local to global:} The collection ${|Q(x)|}_{x\in S_f}$ is an open covering of the compact set $|S_f|$.
We find finitely many points $x_1,...,x_k$ with the property
$$
|S_f|\subset \bigcup_{i=1}^k |Q(x_i)|.
$$
We abbreviate by $Q$ the union of the $Q(x_i)$ and by $\wt{Q}$ the saturation of $Q$. Then 
$$
S_f\subset \wt{Q}\subset U.
$$
We take the data associated to the $x_i$ previously constructed. Define $\bar{\ell}=\ell_{x_1}+...+\ell_{x_k}$
and ${\mathbb R}^{\bar{\ell}}={\mathbb R}^{\ell_{x_1}}\oplus...\oplus {\mathbb R}^{\ell_{x_k}}$ and for $t=(t_1,...,t_k)\in {\mathbb R}^{\bar{\ell}}$
$$
\Lambda_t (w) =\left(\bigoplus_{i=1}^k \Lambda_{t_i} \right)(w).
$$
Then every $\Lambda_t:W\rightarrow {\mathbb Q}^+$ is a structurable sc$^+$-multisection functor. In addition the 
associated $\wt{\Lambda}:{\mathbb R}^{\bar{\ell}}\times W\rightarrow {\mathbb Q}^+$  is an sc$^+$-multisection functor.
If $x\in Q$ we find $i$ so that an isomorphic $x'$ belongs to $Q(x_i)$. The properties of $(\wt{f},\wt{\Lambda})$ at $(0,x')$ are the same 
as those of $(0,x)$. From the  construction it follows that 
\begin{eqnarray}
\mathsf{T}_{(\wt{f},\wt{\Lambda})}^R(0,x)\ \ \text{is onto for all}\ \ x\in S_f.
\end{eqnarray}
We also note that there exists $\varepsilon_0>0$ so that $N(\Lambda_t)(x)<1$ for all $x\in X$, provided $|t|\leq \varepsilon_0$.
Since $(N,U)$ controls compactness and the domain support of every $\Lambda_t$ belongs to $U$ it follows that
\begin{eqnarray}
\{(t,x)\in {\mathbb R}^{\bar{\ell}}\times X\ |\ |t|\leq \varepsilon_0,\ \Lambda_t(f(x))>0\}\ \ \text{is compact.}
\end{eqnarray}
As a consequence of the implicit function theorem, f.e. use Theorem \ref{THMXXC1525},  we find $\varepsilon\in (0,\varepsilon_0]$ such that 
$$
\wt{\Theta}: \{t\in {\mathbb R}^{\bar{\ell}}\ | |t|<\varepsilon\}\times X\rightarrow {\mathbb Q}^+:(t,y)\rightarrow \Lambda_t\circ f(y)
$$
is a tame branched ep$^+$-subgroupoid, having the property that for $(t,y)\in \supp (\wt{\Theta})$ the reduced linearization 
$\mathsf{T}^R_{(\wt{f},\wt{\Lambda})}(t,y)$ is surjective. As a consequence $\wt{\Theta}$ can be locally written 
as with weights and a local branching structure consisting of tame M$^+$-polyfolds, or equivalently classically smooth manifolds
with boundaries with corners.  In order to find a specific value $t_0$ for which the perturbation $\Lambda_{t_0}$ has
the desired property we use a modification of the argument given in the proof of Theorem \ref{thm_pert_and_trans}. 
This is being discussed next.\par


\noindent{\bf Achieving global transversality:}  
At this point we can consider the map
\begin{eqnarray}\label{EQNXX1537}
\left\{(t,y)\in {\mathbb R}^{\bar{\ell}}\times X\ |\ |t|< {\varepsilon},\ \bar{\Lambda}_t(f(y))>0\right\}\rightarrow {\mathbb R}^{\bar{\ell}}:(t,y)\rightarrow t.
\end{eqnarray}
For $(t_0,x_0)$ in this set we can consider $d_X(x_0)$ and find an open neighborhood of the form $\wt{U}(t_0,y_0)=\{t\ |\ |t-t_0|<\delta\}\times U(x_0)$,
having the following properties.
\begin{itemize}
\item $U(x_0)$ admits the natural $G_{x_0}$-action and the properness property.
\item $U(x_0)$ contains $d_X(x_0)$-many local faces containing $x_0$.
\item On $\wt{U}(t_0,x_0)$ the branched ep$^+$-subgroupoid can be written with a local branching structure as
$$
\Lambda_t(f(x))=\frac{1}{|I|}\cdot |\{i\in I\ |\ (t,y)\in M_i\}|.
$$
\item Each $M_i$ is a smooth manifold with boundary with corners properly embedded in $\wt{U}(t_0,x_0)$
and the intersection of $M_i$ with an arbitrary number of local faces is a smooth manifold with boundary with corners.
\item For $(t,y)\in M_i$ it holds that $\mathsf{T}^R_{(\wt{f},\wt{\Lambda})}(t,x)$ is surjective. 
\end{itemize}
Denote by ${\mathcal F}$ the intersection of a finite number of local faces in $\wt{U}(t_0,x_0)$. The empty intersection 
we define to be $\wt{U}(t_0,x_0)$. Associated to ${\mathcal F}$ we have the smooth manifolds with boundary with corners
${\mathcal F}\cap M_i$, where $i\in I$.  Now we consider for ever ${\mathcal F}$ (there are a finite number of such intersections)
and $i\in I$ the map
$$
{\mathcal F}\cap M_i\rightarrow {\mathbb R}^{\bar{\ell}}:(t,x)\rightarrow t.
$$
For each such map there is a set of measure zero $Z_{i,{\mathcal F}}$ so that ${\mathbb R}^{\bar{\ell}}\setminus Z_{i,{\mathcal F}}$ 
consists of regular values. Denote by $Z$ the finite union of the $Z_{i,{\mathcal F}}$ which again has measure zero.
For $t$ in the complement the collection of all $(t,y)\in M_i$ is a smooth manifold with boundary with corners 
in general position to the boundary of ${\mathbb R}^{\bar{\ell}}\times X$. See the proof of Theorem 5.21 in \cite{HWZ3.5} for 
the argument proving the latter well-known fact of a parametrized transversality theory. A countable number of such sets $\wt{U}(t_0,x_0)$ have saturations 
which 
cover the set in (\ref{EQNXX1537}). Hence we find a set of measure zero in ${\mathbb R}^{\bar{\ell}}$ so that for $t$ in its complement 
(which contains points arbitrarily close to $0$) the perturbation $\Lambda_t$ has the desired properties. By slightly modifying the proof,
using the compactness of the closure of the orbit space of the set in (\ref{EQNXX1537}) even a discussion of a finite number of sets as
above suffices.
\qed \end{proof}



The standard example of a transversal extension theorem is given by the following result.

\begin{theorem}[Transversal Extension Theorem] \label{THM1537}\index{T- Transversal extension}
Assume that $(P:W\rightarrow X,\mu)$  is a strong bundle over a tame ep-groupoid and 
 $f$ a  sc-Fredholm section functor with compact solution set, i.e. $|S_f|$ is compact. We assume that $|X|$ is paracompact and $X$ admits sc-smooth partitions of unity.
  Let $N$ be an auxiliary norm and $U$ a saturated subset of $X$
 so that $(N,U)$ controls compactness.
 Suppose further that  $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$ is an $(U,N)$-admissible,  structurable 
 sc$^+$-multisection so that there exists a continuous functor $h:X\rightarrow (0,1]$ 
 with 
 $$
 N(\Lambda)(x)<h(x)\ \ \text{for all}\ \ x\in\partial X,
 $$
  and $\mathsf{T}_{(f|\partial X,\Lambda)}(x)$
 is surjective with respect to intersections of local faces for every smooth $x$ in $\partial X$. Then there exists a structurable  sc$^+$-multisection
 $\wt{\Lambda}:W\rightarrow {\mathbb Q}^+$ with the following properties.
 \begin{itemize}
 \item[{\em (1)}] \  $\wt{\Lambda}|(W|\partial X)=\Lambda$.
 \item[{\em (2)}] \  The domain support of $\wt{\Lambda}$ is contained in $U$ and $N(\wt{\Lambda})(x)<h(x)$ for all $x\in X$, i.e. $\wt{\Lambda}$ is $(N,U)$ admissible.
 \item[{\em (3)}] \  $\mathsf{T}_{(f,\Lambda)}$ is onto on $\supp(\Lambda\circ f)$.
 \end{itemize}
 Moreover, $\wt{\Lambda}\circ f:X\rightarrow {\mathbb Q}^+$ is a compact,  tame, branched ep$^+$-subgroupoid.
 \end{theorem}
\begin{proof}
We are given the saturated open subset $U$ of $X$ so that $(N,U)$ controls compactness.
Over the boundary we have the sc$^+$-multisection functor $\Lambda: W|\partial X\rightarrow {\mathbb Q}^+$ which is structurable and
satisfies for $x\in\partial X$ the inequality $N(\Lambda)(x)<h(x)$. We first take a continuous functor $h':X\rightarrow [0,1]$ satisfying 
$N(\Lambda)(x)<h'(x)<h(x)$ for $x\in \partial X$ and which is supported in $U$.
We apply Theorem \ref{p-main-p} and obtain a structurable extension 
$\Lambda':W\rightarrow {\mathbb Q}^+$ of $\Lambda$ which satisfies $N(\Lambda')(x)\leq h(x)$ for all $x\in X$ and has the domain support in $U$. 
The sc$^+$-multisection $\Lambda'$ extends $\Lambda$. By the assumptions on $\Lambda$ we find for every $x\in \partial X$ with $\Lambda\circ f(x)>0$
an open neighborhood $Q(x)\subset U$ admitting the natural $G_x$-action and having the properness property so that 
$$
\mathsf{T}_{(f,\Lambda')}^R(y)\ \ \text{is onto for}\ \ y\in U(x).
$$
The saturation of the union of all these $Q(x)$ defines a saturated open neighborhood of $\{y\in\partial X\ |\ \Lambda\circ f(y)>0\}$ and is contained
in $U$. At this point we have transversality for our solution set near $\partial$. For $x\in U\setminus Q$ with $\Lambda'\circ f(x)>0$ we note that $d_X(x)=0$
and we can argue as in Theorem \ref{THM1536} to construct parameter-depending perturbations we achieve local transversality. Using the compactness
of the orbit space of the support of $\Lambda'\circ f$ we can construct a structurable $\Lambda_t$ with domain support away from $\partial X$, but contained in $U$,
so that the structurable $\Lambda_t\oplus\Lambda'$ where $t\in {\mathbb R}^\ell$ has the property that
$$
(t,y)\rightarrow (\Lambda_t\oplus\Lambda')\circ f(x)
$$
has near $(0,x)$ with $x\in S_f$ the property that $\mathsf{T}_{(\wt{f},\wt{\Lambda})}^R(0,x)$ is onto. Then for arbitrarily small
$t$ we obtain the perturbation $\wt{\Lambda}:=\Lambda_t\oplus \Lambda'$ with the desired properties.
\qed \end{proof} 

There is an obvious corollary dealing with homotopy invariance. 
\begin{corollary}\label{CORRX1539}
Assume that $(P:W\rightarrow X,\mu)$ is a strong bundle over an ep-groupoid with $d_X\equiv 0$ and paracompact orbit space $|X|$.  Let $f$ be an sc-Fredholm functor
for which $|S_f|$ is compact.  
\begin{itemize}
\item[{\em (1)}]\   Fix an auxiliary norm $N$ and a saturated open neighborhood $U$ of $S_f$  so that $(N,U)$ controls compactness.
Then there exists a structurable  sc$^+$-multisection functor $\Lambda$ with domain support in $U$ and satisfying $N(\Lambda)(x)<1$ for all $x\in X$
having the property that $\mathsf{T}_{(f,\Lambda)}(x)$ is onto for all $x\in \supp(\Lambda\circ f)$. In particular $\Theta=\Lambda\circ f$ is a tame weighted 
ep$^+$-subgroupoid for which the orbit space of the support is compact. Let us call $(N,U,\Lambda)$ a structurable regular perturbation of $f$.
\item[{\em (2)}]\   Assume that $(N^i,U^i,\Lambda^i)$ for $i=0,1$ are regular perturbations of $f$.  Define $\wt{X}=[0,1]\times X$ and $\wt{W}=[0,1]\times W$, so that 
$\wt{W}\rightarrow\wt{X}$ is a strong bundle. Also define the sc-Fredholm section $\wt{f}$ by $\wt{f}(t,x)=(t,f(x))$. Then there exists an auxiliary
norm $N$ for $\wt{W}$ which over $i=0,1$ restricts to $N^i$ and a saturated open neighborhood $U$ of $S_{\wt{f}}$ restricting over $i=0,1$ to $U^i$
so that $(N,U)$ controls compactness.
\item[{\em (3)}] \  There exists a structurable regular perturbations $(N,U,\Lambda)$, where $\Lambda$ over $i=0,1$ is identical to $\Lambda^i$.
\end{itemize}
\end{corollary}
\begin{remark}\index{R- Topological content and orientations}
We note that the topological content is possibly empty since we do not have an orientation and we do a perturbation theory over ${\mathbb Q}$.
However, immediately, if we are in the case that $f$ is oriented it follows that $\Lambda\circ \wt{f}$ has a natural orientation and we obtain invariants.
For this see the next section.
\qed
\end{remark}
\begin{proof}[Corollary \ref{CORRX1539}]
By applying a special case of Theorem \ref{THM1536} we find a structurable  sc$^+$-multisection  $\Lambda_0$ with domain support in $U$
satisfying $N(\Lambda_0)(x)<1$ for all $x\in X$, so that $\mathsf{T}_{(f,\Lambda_0)}$ is onto on $\supp(\Lambda_0\circ f)$.
Then $\Theta_0=\Lambda_0\circ f$ is a compact branched ep$^+$-subgroupoid.   Assume we have also picked a second structurable
$\Lambda_1$ with similar properties.  Consider the tame ep-groupoid $[0,1]\times X$ equipped with the obvious projection
$[0,1]\times X\rightarrow X$. We can pull-back the strong bundle and obtain the strong bundle $\wt{W}\rightarrow [0,1]\times X$.
The fiber over $(t,x)$ is $W_x$ and $N$ defines an auxiliary norm on $\wt{W}$ which denote by $\wt{N}$. Define $\wt{U}=[0,1]\times X$.
Then $(\wt{N},\wt{U})$ controls compactness for the sc-Fredholm section $\wt{f}$ defined by $\wt{f}(t,x)=f(x)$. 
Applying Theorem \ref{THM1537} we find a structurable $\wt{\Lambda}$ for $\wt{W}$ with $\wt{N}(\wt{\Lambda})(t,x)<1$ for $(t,x)\in [0,1]\times X$
so that restricted to $\wt{W}|(\{i\}\times X)=W$ for $i=0,1$ we obtains $\Lambda_i$.  Hence $\wt{\Theta}:=\wt{\Lambda}\circ \wt{f}$ defines a tame, compact, branched ep$^+$-subgroupoid which restricts to $\{i\}\times X=X$ as $\Theta_i$.  This means we obtain a compact cobordism $\wt{\Theta}$  between $\Theta_0$ and $\Theta_1$.

 Assume that $(N,U)$ and $(N',U')$ control compactness and we have  associated sc$^+$-multisections
$\Lambda$ and $\Lambda'$.  Then we define  $U''=U\cap U'$ and $N''=\text{max}\{N,N'\}$ and note that $(N'',U'')$ also controls compactness.
We can take an associated $\Lambda''$. Then $\Lambda''$ is controlled  by $(N,U)$ as well as $(N',U')$. Hence we can connect in a controlled way
$\Lambda$ with $\Lambda''$ and $\Lambda''$ with $\Lambda'$, i.e. $\Lambda$ with $\Lambda'$.   
\qed \end{proof}



\section{Orientations and Invariants}\label{SEC153}
Next  we consider an oriented version of the previous  discussion.
We note that trans\-ver\-sality and orien\-tation are separate issues. Hence we may assume that transversality is already achieved
before we consider the orientation question.
The set-up is given by the following data.
\begin{eqnarray}\label{ASSUMP}
\text{\bf Assumptions}
\end{eqnarray}
\begin{itemize}
\item  A strong bundle over a tame ep-groupoid $(P:W\rightarrow X,\mu)$.
\item  An oriented sc-Fredholm section  functor $(f,\mathfrak{o})$, where we assume that $f$ has a compact solution set, i.e. 
$|S_f|$ is compact.  
\item A sc$^+$-multisection $\Lambda:W\rightarrow {\mathbb Q}^+$ such that $\mathsf{T}_{(f,\Lambda)}$ is onto
on $\supp(\Lambda\circ f)$,  and at points  $x\in \partial X\cap \supp(\Lambda\circ f)$ we assume that the kernels
of $\mathsf{T}_{(f,\Lambda)}$ are in good position to $\partial X$.
\item $\Lambda\circ f:X\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subgroupoid. (Note that this condition
says that at the boundary the behavior is resonable.)
\end{itemize}
Such data can be obtained by starting with an oriented sc-Fredholm section $(f,\mathfrak{o})$ 
and by applying perturbation theory to obtain $\Lambda$ with the above properties. 
Then $\Theta:X\rightarrow {\mathbb Q}^+$ defined by 
$$
\Theta:=\Lambda\circ f
$$
is a tame,  branched ep$^+$-subgroupoid. Hence we have the tangent functor
$$
\mathsf{T}_\Theta:X_\infty\rightarrow \text{Gr}(X).
$$
In order to orient $\Theta$ we need a suitable lift $\wh{\mathsf{T}}_\Theta:X_\infty\rightarrow \wh{\text{Gr}}(X)$.
The interesting fact, proved here, is that the orientation $\mathfrak{o}$ of $f$ defines a natural lift
$$
\wh{\mathsf{T}}_{(\Theta,\mathfrak{o})}:X_\infty\rightarrow \wh{\text{Gr}}(X).
$$
 In order to prove this 
we need some preparation.
Starting point is the data from Assumption \ref{ASSUMP}.
Then for  every smooth $x$ the convex set of sc-Fredholm operators
$(f-s)'(x):T_xX\rightarrow W_x$, where $s$ is a local sc$^+$-section with $s(x)=f(x)$, have induced orientations with suitable properties, see Section \ref{SEC115}.

For a smooth point $x$ denote by $\wh{\text{Gr}}_F(x)$ \index{$\wh{\text{Gr}}_F(x)$} the set of finite formal
sums $\sum_{\wh{L}} \sigma_{\wh{L}}\cdot \wh{L}$, where $\wh{L}=(L,o)$ is an oriented 
sc-Fredholm operator, $L:T_xX\rightarrow W_x$.  That means $o$ is an orientation of $\text{det}(L):= \Lambda^{max}\ker(L)\otimes (\Lambda^{max}\text{coker}(L))^\ast$. In the formal sum  the weights are nonnegative rational numbers and only a finite number of them are nonzero.
We define 
$$
\wh{\text{Gr}}_F(X):=\bigcup_{x\in X_\infty} \wh{\text{Gr}}_F(x).
$$
There is a natural projection $\wh{\pi}:\wh{\text{Gr}}_F(X)\rightarrow X_\infty$.
As before we can view $ \wh{\text{Gr}}_F(X)$ as the object set of a category.
The morphism set has the elements $(\phi,\wh{\mathsf{L}})$ where $\wh{\pi}(\wh{\mathsf{L}})=s(\phi)$.
The source and target maps are defined by $s(\phi,\wh{\mathsf{L}})=\wh{\mathsf{L}}$ and 
$t(\phi,\wh{\mathsf{L}})=\phi_\ast (\wh{\mathsf{L}})$. For an oriented $(L,o)$ we define
$\phi_\ast(L,o)=(\phi_\ast L,\phi_\ast\mathfrak{o})$.  

Forgetting orientations defines a 2-1 forgetful functor $\mathsf{f}_F$ fitting into the following diagram
$$
\begin{CD}
\wh{\text{Gr}}_F(X) @>\mathsf{f}_F>> \text{Gr}_F(X)\\
@V\wh{\pi} VV @V\pi VV\\
X_\infty @= X_\infty
\end{CD}
$$
We have seen that associated to $(f,\Lambda)$ there is a well-defined section functor 
$\mathsf{T}_{(f,\Theta)}$ of $\pi$.  As it turns out if $f$ is oriented there is a canonical lift
$\wh{\mathsf{T}}_{(f,\Lambda)}$ to a section functor of $\wh{\pi}$ such that
$$
\mathsf{f}_F\circ \wh{\mathsf{T}}_{(f,\Lambda)}={\mathsf{T}}_{(f,\Lambda)}.
$$
Let $x\in \supp(\Lambda\circ f)$, take an open neighborhood $U(x)$ with the natural $G_x$-action
and a local sc$^+$-section structure ${(s_i)}_{i\in I}$, ${(\sigma_i)}_{i\in I}$. Then 
$$
\mathsf{T}_{(f,\Lambda)}(y) =\sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot (f-s_i)'(y)\ \ \text{for}\ \ y\in U(x).
$$
This representation does not depend on the choice of the local sc$^+$-section structure. 
Since $f$ is oriented by $\mathfrak{o}$ every $(f-s_i)'(y)$ inherits an orientation $o_{i,y}$.
We define
$$
\wh{\mathsf{T}}_{((f,\mathfrak{o}),\Lambda)}(y)=\sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot ((f-s_i)'(y),o_{i,y})\ \ \text{for}\ \ y\in U(x)
$$
This definition does not depend on the choice of the local sc$^+$-section structure since the occurring
operators in the formal sum are independent of such choices.

Since for $y\in \supp(\Lambda\circ f)$  the operators occurring in the linearization $\mathsf{T}_{(f,\Lambda)}(y)$
are surjective we obtain an orientation $o_{i,y}$ for $\ker((f-s_i)'(y))$. If we vary $y$ in 
 $M_i = \{y\in U(x)\ |\ f(y)=s_i(y)\}$ the orientations $o_{i,y}$ vary continuously defining an orientation $o_i$ for $M_i$.
 Now we define 
 $$
 \wh{\mathsf{T} }_{(\Theta,\mathfrak{o})}(y) =\sum_{\{i\in I\ |\ y\in M_i\}} \sigma_i\cdot T_y(M_i,o_i).
 $$
 Note that the right-hand sum equals
 $$
 \sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot (\ker((f-s_i)'(y)),o_{i,y}),
 $$
 where $o_{i,y}$ is the orientation of $\Lambda^{max}\ker((f-s_i)'(y))$ which can be canonically identified with the
 orientation of $\det((f-s_i)'(0))$ via  identifying $\Lambda^{max}\ker((f-s_i)'(y))$
  with $(\Lambda^{max}\ker((f-s_i)'(y)))\otimes {\mathbb R}^\ast=\det((f-s_i)'(0))$.
\begin{theorem}[Canonical Orientation $\wh{\mathsf{T}}_{(\Lambda\circ f,\mathfrak{o})}$]\label{THM1541}
\index{T- Canonical orientation $\wh{\mathsf{T}}_{(\Lambda\circ f,\mathfrak{o})}$}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid, $(f,\mathfrak{o})$ an oriented sc$^+$-Fredholm section functor, and $\Lambda:W\rightarrow {\mathbb Q}^+$ an sc$^+$-multisection so that Assumption \ref{ASSUMP} holds. Then 
with $\Theta:=\Lambda\circ f:X\rightarrow {\mathbb Q}^+$ the functor 
 $\mathsf{T}_{\Theta}:X_\infty\rightarrow \text{Gr}(X)$ has a canonical lift 
$$
\wh{\mathsf{T}}_{(\Theta,\mathfrak{o})}:X_\infty\rightarrow \wh{\text{Gr}}(X),
$$
characterized by by
$$
 \wh{\mathsf{T} }_{(\Theta,\mathfrak{o})}(y)=\sum_{\{i\in I\ |\ f(y)=s_i(y)\}} \sigma_i\cdot (\ker((f-s_i)'(y)),o_{i,y}),
 $$
 where we use the identifications explained above.
 \qed
 \end{theorem}

\begin{definition}\index{D- Canonical orientation for $\Lambda\circ f$}\label{DEF1542}
Under Assumption \ref{ASSUMP} we
 call $\wh{\mathsf{T}}_{(\Lambda\circ f,\mathfrak{o})}$ defined in Theorem \ref{THM1541} the {\bf canonical orientation}
for $\Theta=\Lambda\circ f$.
\qed
\end{definition}

Next we incorporate differential forms into the picture.  We obtain the following result, which is a consequence of the preceding discussion.
\begin{theorem}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over the tame ep-groupoid $X$ and $(f,\mathfrak{o})$ an oriented
sc-Fredholm section of Fredholm index $k$ so that $|S_f|$ is compact. Assume that $N$ is an auxiliary norm and 
$U$ a saturated open neighborhood of $S_f$ so that $(N,U)$ controls compactness. We assume that $\Lambda:W\rightarrow {\mathbb Q}^+$
is an sc$^+$-multisection functor with domain support in $U$ satisfying
\begin{itemize}
\item[{\em (1)}] \ $N(\Lambda)(x)\leq 1$ for $x\in X$.
\item[{\em (2)}]\   $\mathsf{T}_{(f,\Lambda)}(x)$ is onto for all $x\in \supp(\Lambda\circ f)$. 
\item[{\em (3)}]\  $\mathsf{T}_{(f,\Lambda)}(x)$ for $x\in \partial X\cap \supp(\Lambda\circ f)$ is in good position to $\partial X$
\end{itemize}
Then $\Theta:=\Lambda\circ f$ is a compact, tame,  branched ep$^+$-subgroupoid, which is naturally oriented by $\mathfrak{o}$ via 
Theorem \ref{THM1541} and Definition \ref{DEF1542}, and $\partial\Theta$ has an induced orientation, Definition \ref{DEF936}. Then for every sc-differential form $\omega$ on $X$ of degree $(k-1)$
it holds that
$$
\oint_{(\Theta,\mathfrak{o})}d\omega =\oint_{\partial(\Theta,\mathfrak{o})} \omega.
$$
\qed
\end{theorem}
In view of Corollary \ref{CORRX1539} and the previous theorem we obtain the following result,
whose easy proof is left to the reader.
\begin{corollary}
Let $(P:W\rightarrow X,\mu)$ be a strong bundle over an ep-groupoid $X$ with paracompact orbit space and $d_X\equiv 0$.
Assume that $f$ is an sc-Fredholm section with $|S_f|$ being compact and $\mathfrak{o}$ is an orientation for $f$.
Then there exists a well-defined map
$$
\Phi_{(f,\mathfrak{o})}: H^\ast_{dR}(X)\rightarrow {\mathbb R}
$$
uniquely characterized for a homogenous element $[\omega]$ by
$$
\Phi_{(f,\mathfrak{o})} ([\omega]) = \oint_{(\Lambda\circ f,\mathfrak{o})}\omega,
$$
where $(N,U,\Lambda)$ is a regular perturbation and $\Lambda\circ f$ is oriented via the canonical orientation 
coming from $(f,\mathfrak{o})$, also denoted by $\mathfrak{o}$.
\qed
\end{corollary}

\begin{remark}\index{R- Invariants by triangulations}
There is another way to associate invariants to sc-Fredholm functors with compact moduli space. Namely for carefully 
chosen perturbations it is possible to triangulate the weighted solution set and to produce a chain with rational coefficients.
This is not carried out here and is left to the reader.
\qed
\end{remark}





\chapter{Polyfolds}\label{chap11+}
  We start by defining the notion of a polyfold, which is the generalization of 
   an orbifold with boundary and corners to the sc-smooth framework.
   All the results follow from the ep-groupoid case and the study of the concepts which behave well
   under generalized isomorphisms. As a consequence we allow our arguments to be quite brief.
  
   

\section{Polyfold Structures}\label{polyy}

This section capitalizes on the nice transformation properties of  previously introduced objects under equivalences,
and on the  compatibility  with the localization process. This allows to collect several results using a general  formalism.
Here is the basic definition.
\begin{definition}\label{SECDEF121}
Let $Z$ be a topological space. A {\bf polyfold structure}\index{D- Polyfold structure} for $Z$ is  a pair $(X,\beta)$ consisting of a ep-groupoid  $X$ and a homeomorphism
$\beta\colon |X|\rightarrow Z$.  
\qed
\end{definition}
The  polyfold structure $(X,\beta)$ relates the  ep-groupoid $X$ with the  topological space $Z$ via a homeomorphism
$\beta:|X|\rightarrow Z$.  One should view it as a additional structure on a topological space, which turns $Z$ into some kind 
of smooth space. In some sense $(X,\beta)$ is a generalization of a smooth atlas. 

The orbit space  $\abs{X}$ of an ep-groupoid  $X$ is a locally metrizable, regular, Hausdorff space (
Section \ref{section1.3_top_prop}) and therefore $Z$ must have the same  properties in order 
to admit a polyfold structure. If we know that $Z$ is a paracompact topological space  which  admits a polyfold structure, then  it follows via the Nagata-Smirnov Theorem that
$Z$ is metrizable. We summarize this in the following proposition.
\begin{proposition}
If a topological space $Z$ admits a polyfold structure its topology is locally metrizable and regular Hausdorff.
If a paracompact topological space admits a polyfold structure, then its topology is metrizable.
\qed
\end{proposition}
We distinguish different types of polyfold structures depending on properties of the ep-groupoid $X$.
The polyfold structure $(X,\beta)$  is called {\bf tame},\index{Tame polyfold structure} if the ep-groupoid $X$ is tame.
The polyfold structure $(X,\beta)$ is called {\bf face-structured}\index{Face-structured polyfold structure} if  $X$ is face-structured,
and it is called {\bf weakly face-structured}\index{Weakly face-structured polyfold structure} provided $X$ is weakly face-structured,
see Definition \ref{DEF1113}.

In order to introduce the notion of equivalent polyfold structures we recall from 
Section  \ref{section2.3_localization} that a generalized isomorphism 
$$
\mathfrak{f}=[X\xleftarrow{F}A\xrightarrow{G}Y]\colon X\to Y
$$
 between ep-groupoids induces the canonical homeomorphism 
$$\abs{\mathfrak{f}}=\abs{G}\circ \abs{F}^{-1}\colon \abs{X}\to \abs{Y}$$
between the orbit spaces. It does not depend on the choice of the diagram from the equivalence class. The inverse generalized isomorphism, 
$$
\mathfrak{f}^{-1}=[Y\xleftarrow{G}A\xrightarrow{F}X]\colon Y\to X,
$$
is  also a generalized isomorphism  and $\abs{\mathfrak{f}^{-1}}=\abs{\mathfrak{f}}^{-1}\colon \abs{Y}\to \abs{X}.$
The composition $\mathfrak{g}\circ \mathfrak{f}\colon X\to Z$ of two generalized isomorphisms 
$\mathfrak{f}\colon X\to Y$ and $\mathfrak{g}\colon Y\to Z$ is again a generalized isomorphism, and the induced homeomorphism $\abs{\mathfrak{f}\circ \mathfrak{g}}$ between orbit spaces satisfies 
$$\abs{\mathfrak{g}\circ \mathfrak{f}}=\abs{\mathfrak{g}}\circ \abs{\mathfrak{f}}\colon \abs{X}\to \abs{Z}$$
in view of Proposition \ref{equal_prop}. We also recall Theorem \ref{THMX10316} which asserts that for two generalized
isomorphisms $\mathfrak{f}:\mathfrak{f}':X\rightarrow Y$ the equality $|\mathfrak{f}|=\mathfrak{f}'|$ implies that $\mathfrak{f}=\mathfrak{f}'$.
We  define the  equivalence  of two polyfold  structures as follows.

\begin{definition}[{\bf Equivalent polyfold structures}] 
Two polyfold structures $(X,\alpha)$ and $(Y,\beta)$ for the topological space $Z$ are {\bf equivalent}\index{D- Equivalent  polyfold structures}
 provided there exists a generalized isomorphism
$\mathfrak{f}:X\rightarrow Y$ satisfying $\alpha=\beta \circ |\mathfrak{f}|$.  (As pointed out, $\mathfrak{f}$ is necessarily unique.)
\qed
\end{definition}
Now we can introduce the notion of a polyfold.
\begin{definition}[{\bf Polyfold}]
A {\bf polyfold} \index{D- Polyfold}  is a pair $(Z,c)$ consisting of a topological space $Z$ equipped with an equivalence class $c$
of polyfold structures.
\qed
\end{definition}
Most of the time we shall suppress $c$ in the notation and talk simply  about the polyfold $Z$. Of course, a topological space $Z$ might be a polyfold in different ways.
Next we shall study  properties which behave well with respect to equivalent polyfold structures.

\begin{proposition}\index{P- Existence of bump functions under equivalence}
For two equivalent polyfold  structures $(X,\alpha)$ and $(Y,\beta)$  of the topological space $Z$ the following holds.
\begin{itemize}
\item[{\em (1)}] \ $X$ admits sc-smooth bump functions if and only the same holds for $Y$.
\item[{\em (2)}]\   $X$ admits sc-smooth partitions of unity (as ep-groupoid)  if and only if the same holds for $Y$.
\end{itemize}
\end{proposition}
\begin{proof}
By assumption there exists a generalized isomorphism $[d]:X\rightarrow Y$. Taking a representative we obtain the diagram
$$
d\colon X\xleftarrow{F}A\xrightarrow{G}Y
$$
 involving  only  equivalences. 
If $X$ admits sc-smooth bump functions, there exists, by definition, a sc-smooth bump function in every open set. Since $F$ is a local sc-diffeomorphism, the same is true for the ep-groupoid $A$, and using that also $G$ is a local sc-diffeomorphism this also  holds for the image of $G$. If $y\not \in G(A)$, we find using that $G$ is essential surjective  a point $a\in A$ and a morphism $\psi\colon G(a)\to y$ in $\bm{Y}$. It has a unique extension to a local sc-diffeomorphism denoted by $\wh{\psi}$. The composition 
$\wh{\psi}\circ G$ is a local sc-diffeomorphism satisfying $\wh{\psi}\circ G(a)=y$ which allows to construct bump functions in a small neighborhood of $y$ outside of the image of $G$.

In order to see (2) assume that $X$ admits sc-smooth partitions of unity.  Take any open covering of the object space $Y$ by saturated open
sets, say $(U_\lambda)$. Denote by $\mathfrak{f}:X\rightarrow Y$ the generalized isomorphism satisfying $\beta\circ |\mathfrak{f}|=\alpha$ and by 
 $(V_\lambda)$ the covering of $X$ by saturated open subsets defined by
$$
|\mathfrak{f}|(|V_\lambda|)= |U_\lambda|.
$$
By assumption we can pick a subordinate sc-smooth partition of unity $(\sigma_\lambda)$ for $(V_\lambda)$. 
Define $\tau_\lambda$ by by $\tau_\lambda(y) := \sigma_\lambda(x)$, where $|\mathfrak{f}|(|x|)=|y|$.
It is an easy exercise that each $\tau_\lambda$ is sc-smooth and that $(\tau_\lambda)$ is an sc-smooth partition of unity subordinate 
to $(U_\lambda)$.
\qed \end{proof}
Sc-smooth bump functions or sc-smooth partitions of unity are important for constructions. In view of the proposition
the following definitions can be made.


\begin{definition}
We consider the  polyfold $(Z,c)$.
\begin{itemize}
\item[(1)]\  The polyfold $Z$ is called {\bf paracompact}\index{D- Paracompact polyfold}  if  the underlying topological space $Z$ is paracompact.
\item[(2)]\   The polyfold $Z$ is said to {\bf admit sc-smooth bump functions}\index{D- Polyfold admitting bump functions} provided there exists a  polyfold structure $(X,\alpha)\in c$ whose ep-groupoid $X$ admits sc-smooth bump functions. Note that also the  equivalent polyfold structures $(Y,\beta)\in c$ will have this property.
\item[(3)]\ The polyfold $Z$ is said to {\bf admit sc-smooth partitions of unity}\index{D- Polyfold admitting partions of unity} provided this  is true for a model $(X,\alpha)\in c$. Then this is true for the other models in $c$ as well.
\end{itemize}
\qed
\end{definition}
Our next aim is to construct a category ${\mathcal P}$ whose objects are polyfolds $(Z,c)$ and whose morphisms are what we shall call sc-smooth maps between them.  The definition of the morphisms needs some preparation.
For this let us  first consider another category,  called the {\bf category of polyfold structures}\index{Category of polyfold structures}, and denoted by  ${\mathcal P}{\mathcal S}$.\index{${\mathcal P}{\mathcal S}$}
The objects  in ${\mathcal P}{\mathcal S}$ are the  polyfold structures $(X,\alpha)$.
This means that $X$ is an ep-groupoid and 
$$
\alpha:|X|\rightarrow Z_\alpha
$$
 is a homeomorphism to the topological space $Z_\alpha$.
The {\bf morphisms}
$$
(\mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta)
$$
 consist of pairs $(\mathfrak{f},f)$ in which  $f:Z_\alpha\rightarrow Z_\beta$ is a continuous map
and $\mathfrak{f}:X\rightarrow Y$ is a generalized (sc-smooth) map between ep-groupoid, i.e. $\mathfrak{f}$ is an equivalence class of diagrams
$$
d\colon X\xleftarrow{F}A\xrightarrow{\Phi} Y,
$$
where  $F$ is an equivalence of ep-groupoids and $\Phi$ a sc-smooth functor. Moreover,  
 $$
 f\circ\alpha = \beta\circ |\mathfrak{f}|.
 $$
We can visualize the structure by the following diagram, where the left-hand side stands for the diagram on right-hand side. 
 Of course, the top part does not make sense as a commutative diagram of maps, since $\mathfrak{f}$ is only a generalized isomorphism.
($\mathfrak{f}$  establishes locally a correspondence up to isomorphism between open subsets in the object spaces $X$ and $Y$, so that one has to interpret the upper part of the diagram accordingly.)
 \begin{equation*}
 (\mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta) \quad \quad  \quad 
 \begin{CD}
 X @>\mathfrak{f}>> Y\\
 @V\pi_X VV @V \pi_Y VV\\
 |X|       @>|\mathfrak{f}|>> |Y|\\
 @V\alpha VV  @V\beta VV\\
 Z_{\alpha} @>f >>  Z_{\beta}.
 \end{CD}
 \end{equation*}
 The upper diagram is the part which defines the sc-smooth structure.
The composition of two morphisms is defined  by 
$$
(\mathfrak{f},f)\circ (\mathfrak{g},g)=(\mathfrak{f}\circ\mathfrak{g},f\circ g),
$$
and the identity elements have the form $1_{(X,\alpha)}=(1_{[1_X]},Id_{Z_\alpha})$.
The {\bf  isomorphisms} in ${\mathcal P}{\mathcal S}$ are  the pairs $(\mathfrak{f},f):(X,\alpha)\rightarrow (Y,\beta)$ in which $f\colon Z_\alpha\rightarrow Z_\beta$  is a homeomorphism 
and $\mathfrak{f}:X\rightarrow Y$ a generalized isomorphism between the ep-groupoids satisfying $|\mathfrak{f}|= \beta^{-1}\circ f\circ\alpha$.
As a consequence of Theorem \ref{THMX10316} the generalized isomorphism $\mathfrak{f}$ is uniquely determined by $f$. Of course, not every homeomorphism $f$ is induced by such
a $\mathfrak{f}$. 

We now consider a polyfold $(Z,c)$ and choose a polyfold structure  $(X,\alpha)\in c$.  Then $c$ consists of all objects $(Y,\beta)$ in ${\mathcal P}{\mathcal S}$
for which  there exists an isomorphism $( \mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta)$ 
between the polyfold structures of the special form $(\mathfrak{f},Id_Z)$. Roughly speaking we consider
for a given $(X,\alpha)$ all the diagrams of the form below, where $\mathfrak{f}$ is a generalized isomorphism.
$$
\begin{CD}
X @>\mathfrak{f}>> Y\\
@V \alpha\circ \pi_X VV @ V\beta\circ \pi_Y VV\\
Z @=  Z
\end{CD}
$$
The diagram has to be understood in the sense that there exists a generalized isomorphism 
for which $|\mathfrak{f}|$ fits into the obvious commutative diagram. Since $|\mathfrak{f}|$
is completely determined we obtain, as already mentioned before, the uniqueness of $\mathfrak{f}$.

We might identify $c$ with this particular subcategory (which is not full). 
This allows us, given polyfolds $(Z,c)$ and $(W,d)$,  to define the notion of equivalence of morphisms $(\mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta)$ between the polyfold structures $(X,\alpha)\in c$ and $(Y,\beta)\in d$.

\begin{definition}[{\bf Equivalence of morphisms}] \index{D- Equivalence of morphisms in ${\mathcal P}{\mathcal S}$}
Let $(Z,c)$ and $(W,d)$ be polyfolds and assume that $(X,\alpha),(X',\alpha')$ are  two polyfold structures in $c$ and $(Y,\beta),(Y',\beta')$ two polyfold structures in $d$.   The two morphisms
$(\mathfrak{f},f):(X,\alpha)\rightarrow (Y,\beta)$ and $(\mathfrak{f}',f'):(X',\alpha')\rightarrow (Y',\beta')$ in  ${\mathcal P}{\mathcal S}$ {\bf are 
equivalent} if  there exist  two isomorphisms $(\mathfrak{h},Id_Z):(X,\alpha)\rightarrow (X',\alpha')$ and $(\mathfrak{k},Id_W):(Y,\beta)\rightarrow (Y',\beta')$ in ${\mathcal P}{\mathcal S}$ satisfying $(\mathfrak{f}',f')\circ (\mathfrak{h},Id_Z)=(\mathfrak{k},Id_W)\circ (\mathfrak{f},f),$ as illustrated in the diagram
\begin{equation*}
\begin{CD}
(X,\alpha)@>(\mathfrak{f},f)>>(Y,\beta)\\
@V(\mathfrak{h},Id_Z)VV  @V(\mathfrak{k}.Id_W)VV\\
(X',\alpha')@>(\mathfrak{f}',f')>>(Y,\beta').
\end{CD}
\end{equation*}
\qed
\end{definition}
An equivalent pair $(\mathfrak{f},f)\sim (\mathfrak{f}',f')$ necessarily satisfies  $f=f'\colon Z\rightarrow W$.
If $(Z,c)$ and $(W,d)$ are two polyfolds and $(X,\alpha)\in c$ and $(Y,\beta)\in d$ two polyfold structures, then  a morphism
$(\mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta)$ determines for two other  polyfold structures $(X',\alpha')\in c$ and $(Y',\beta')\in d$ the equivalent morphism 
$(\mathfrak{k}^{-1}\circ \mathfrak{f}\circ \mathfrak{h},f)\colon (X',\alpha')\rightarrow (Y',\beta')$, where $(\mathfrak{h},Id_Z)\colon (X',\alpha')\rightarrow (X,\alpha)$ 
and $(\mathfrak{k},Id_W)\colon (Y',\beta')\rightarrow (Y,\beta)$ are morphisms between the polyfold structures. 
\begin{remark}
If $f:Z\rightarrow W$ is a homeomorphism between polyfolds and $(X,\alpha)$ and $(Y,\beta)$
are polyfold structures, then there is at most one generalized isomorphism $\mathfrak{f}:X\rightarrow Y$
satisfying $f\circ\alpha =\beta\circ |\mathfrak{f}|$. However if $f$ is just a continuous map
there might be none, or perhaps many generalized sc-smooth map $\mathfrak{f}:X\rightarrow Y$
such that $f\circ\alpha =\beta\circ |\mathfrak{f}|$. So the uniqueness is special for homeomorphisms.
This is also a known fact in the orbifold world.
\qed
\end{remark}

\begin{definition}[{\bf Sc-smooth maps}] \label{sc-smooth_ map_pol}\index{D- Sc-smooth map between polyfolds}
A  sc-smooth  map $\what{f}:(Z,c)\rightarrow (W,d)$ between two polyfolds
is  an equivalence class $\what{f}=[(\mathfrak{f},f)]$ of morphisms between representatives
of the structures $c$ and $d$.  
\qed
\end{definition}

\begin{remark}
From a practical perspective one can  think of a sc-smooth map $\what{f}:(Z,c)\rightarrow (W,d)$
as a morphism $(\mathfrak{f},f):(X,\alpha)\rightarrow (Y,\beta)$ consisting of  a continuous map  $f:Z\rightarrow W$ 
and a generalized sc-smooth map $\mathfrak{f}:X\rightarrow Y$  satisfying  $f=\beta\circ |\mathfrak{f}|\circ\alpha^{-1}$.
Since $f:Z\rightarrow W$ is independent of the elements $(\mathfrak{f},f)$ in $\what{f}$
we shall often identify $\what{f}\equiv f$. However, the actual overhead (over $f$) is important for constructions
because  only on the level of the ep-groupoids   the sc-smoothness is captured. 
\qed
\end{remark}

\begin{definition}[{\bf Composition}] \index{D- Composition of sc-smooth polyfold maps}
The {\bf composition} $\wh{g}\circ \wh{f}\colon (Z, c)\to  (V,e)$ of the sc-smooth maps
$$
\text{$\what{f}:(Z,c)\rightarrow (W,d)$\quad  \text{and}\quad  $\what{g}:(W,d)\rightarrow (V,e)$}
$$
between polyfolds is defined via representatives as the  equivalence class
$$
\what{g}\circ\what{f}=[(\mathfrak{g}\circ\mathfrak{f},g\circ f)]
$$
in which
$(\mathfrak{f},f)\colon (X,\alpha)\rightarrow (Y,\beta)$ and $(\mathfrak{g},g)\colon (Y,\beta)\rightarrow (U,\gamma)$ are representatives of  $\what{f}$ and $\what{g}$, respectively.
The definition does not depend on the choices involved.
\qed
 \end{definition}

We are ready to introduce the polyfold category  ${\mathcal P}$.

\begin{definition}[{\bf Polyfold category ${\mathcal P}$}] \label{polyfold_category_def} The {\bf polyfold category}\index{D- Polyfold category} ${\mathcal P}$\index{${\mathcal P}$} has as objects the polyfolds $(Z,c)$ and as morphisms the sc-smooth maps $\what{f}:(Z,c)\rightarrow (W,d)$.
Further,  $1_{(Z,c)}=[([1_X],Id_Z)]$, where $(X,\alpha)\in c$. 
\qed
\end{definition}
The {\bf degeneracy index} \index{$d_{(X,\beta)}$}
$
d_{(X,\beta)}\colon (Z, c)\to  {\mathbb N}$ of the polyfold structure $(X, \beta)\in c$ is defined by  
$$
d_{(X,\beta)}(z):=d_X(x),\quad z\in Z,
$$
where $x\in X$ satisfies  $\beta(|x|)=z$. 
Since $s$ and $t$ are local sc-diffeomorphisms,  the definition does not depend on the
choice of $x$ as long as $\beta(|x|)=z$.  Even more is true.
\begin{lemma}
If $(X,\beta)$ and $(X',\beta')$ are two equivalent polyfold structures on $Z$, then 
$$
d_{(X,\beta)}=d_{(X',\beta')}.
$$
\end{lemma}
\begin{proof}
By the definition of equivalence there exists a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$ satisfying  $\beta'\circ|\mathfrak{f}|=\beta$.
Let $z\in Z$ and choose points  $x\in X$ and $x'\in X'$ satisfying $\beta(|x|)=z=\beta(|x'|)$. We can represent $\mathfrak{f}$ by a diagram of equivalences
$$
X\xleftarrow{F}A\xrightarrow{F'} X'.
$$ 
Using that $F$ and $F'$ are equivalences,  we find a point $a\in A$ and morphisms $\phi:F(a)\rightarrow x$ and $\phi':F'(a)\rightarrow x'$.
This implies the equalities 
$$
d_{(X,\beta)}(z)=d_X(x)=d_X(F(a))=d_A(a)=d_{X'}(F'(a))=d_{X'}(x')=d_{(X',\beta')}(z)
$$
and the proof is complete. 
\qed \end{proof}
As a consequence we can define the degeneracy index map  for a polyfold.
\begin{definition}[{\bf Degeneracy index for polyfolds}] \index{D- Degeneracy index}
For  a polyfold $(Z,c)$ there exists a well-defined map $d_Z:Z\rightarrow {\mathbb N}$, called {\bf degeneracy index},\index{$d_Z$}
which has the property that for every polyfold structure $(X,\beta)\in c$  the identity
$$
d_Z(z)=d_X(x),
$$
holds, provided $\beta(|x|)=z$.
\qed
\end{definition}

Similarly  as we defined sub-M-polyfolds we define sub-polyfolds. 
\begin{definition}[{\bf Sub-polyfold}] \index{Sub-polyfold} A subset $B\subset Z$ of a polyfold $(Z, c)$ is called a {\bf sub-polyfold}\index{D- Subpolyfold} of $(Z,c)$ if there exists 
a polyfold structure $(X,\alpha)\in c$ such  that the saturated subset $A$ of $X$,  defined by 
$$
A= (\alpha\circ \pi)^{-1}(B), 
$$
is an ep-subgroupoid. Here $\pi\colon X\to \abs{X}$ is the usual projection onto the orbit space.
\qed
\end{definition}
\begin{remark}
If  $(Y,\beta)$ is another representative of $c$, then there exists  a generalized isomorphism $\mathfrak{f}:X\rightarrow Y$
satisfying $\beta\circ |\mathfrak{f}|=\alpha$. 
Let $\pi:X\rightarrow |X|$ and $\pi:Y\rightarrow |Y|$ be  the quotient maps. If the saturated subset $A = (\alpha\circ \pi)^{-1}(B)$ of $X$  is an ep-subgroupoid of $X$, then 
$A$ is a sub-M-polyfold of the object space $X$, and,  as we have shown,  the associated full subcategory is in a natural way an ep-groupoid.
If the diagram  $X\xleftarrow{F} C\xrightarrow{G} Y$ represents  $\mathfrak{f}$, the preimage of $A$ under $F$ is an ep-subgroupoid of $C$ 
and the saturation of its image in $Y$ is an ep-subgroupoid as well. Let us denote the latter by $A'$. Then obviously, 
$$
A' = (\beta\circ \pi')^{-1}(B).
$$
Hence, in the above definition,  the choice of a representative in $c$ does not matter.  We note that the generalized isomorphism
$\mathfrak{f}:X\rightarrow Y$ induces a generalized isomorphism $\mathfrak{f}_{A}:A\rightarrow A'$ between the ep-groupoids satisfying  
$$
(\beta| (\pi'(A')))\circ |\mathfrak{f}_A|=\alpha|(\pi(A)).
$$
Therefore with $|A|=\pi(A)$ and $|A'|=\pi'(A')$ it follows
that  
$$
(A,\alpha|(|A|))\ \ \text{and}\ \ (A',\beta\vert(|A'|))
$$
 are equivalent polyfold structures on $B$.
This shows that a subpolyfold inherits in a natural way a polyfold structure.
\qed
\end{remark}

Having the degeneracy index $d_Z$ we shall define the boundary of $Z$.
\begin{definition} \label{boundary_polyfold}\index{D- Boundary of a polyfold}
The {\bf boundary of  a polyfold } $Z$,  denoted by $\partial Z$,   is the collection of all points $z$ satisfying $d_Z(z)\geq 1$. 
\end{definition}
In general the boundary of a polyfold is just a set without any obvious meaningful geometric structure.
This changes for tame polyfolds, a concept we will introduce below.
\begin{example}
If $X={\mathbb R}^2$  we have the group action of $G={\mathbb Z}_2$, where the nontrivial element acts by $(x,y)\rightarrow (x,-y)$. 
We obtain the translation groupoid $G\ltimes {\mathbb R}^2$, which is an ep-groupoid (even tame). The degeneration index vanishes identically. We can identify the orbit space homeomorphically
with $Z={\mathbb R}\times [0,\infty)$ via $\beta:|(x,y)|\rightarrow (x,|y|)$. Hence $(X,\beta)$ defines a polyfold structure on $Z$. The boundary of $Z$ as a polyfold is empty, though as a manifold
it would be non-empty. Hence one has to be somewhat cautious talking about boundaries, since the geometric intuition might be misleading.
\qed
\end{example}

In order to introduce tame polyfolds we first prove the following simple lemma.
\begin{lemma}
We assume that the   polyfold structures $(X,\alpha)$ and $(Y,\beta)$ for $Z$ are equivalent. If the ep-groupoid $X$ is tame so is $Y$.
\end{lemma}
\begin{proof}
By definition of the equivalence of polyfold structures, there is a generalized isomorphism $\mathfrak{f}:X\rightarrow Y$ between ep-groupoids satisfying
$$
\beta\circ|\mathfrak{f}|=\alpha.
$$
The generalized isomorphism $\mathfrak{f}$ can be represented by a diagram 
$$
X\xleftarrow{F} A\xrightarrow{G} Y.
$$
 On the object level $F$ and $G$ are local sc-diffeomorphisms.
If any of the three ep-groupoids is tame, then all the others are as well.
\qed \end{proof}
The lemma allows to define a tame polyfold.

\begin{definition}[{\bf Tame polyfold}] \index{D- Tame polyfold}
A polyfold $(Z,c)$ is said to be {\bf tame} if  at least one (and then all) of the defining polyfold structures $(X,\beta)\in c$
has $X$ as  a tame ep-groupoid.
\qed
\end{definition}

If  $F:X\rightarrow Y$ is an  equivalence  between tame ep-groupoids or more generally a generalized isomorphism, we know from Remark \ref{REM1116}  that if one of the ep-groupoids is face-structured, so is the other.
This has an immediate consequence for generalized isomorphisms for which the same result holds.
\begin{definition}
A polyfold $(Z,c)$ is said to be {\bf  face-structured}\index{D- Face-structured polyfold} provided it is tame 
and for an admissible polyfold structure $(X,\alpha)\in c$ the ep-groupoid   $X$  is face-structured.
A {\bf face} $A$ of $Z$ is  by definition  the image of a face $F$ of $X$ under the map $\alpha\circ \pi:X\rightarrow Z$.
For a point $z\in Z$ the degeneracy index $d_Z(z)$ equals precisely the number of faces $z$ belongs to.
We call $(Z,c)$  {\bf weakly face-structured}\index{D- Weakly face-structured polyfold}  if   it is tame
and if for $(X,\alpha)\in c$ the ep-groupoid $X$ has  the property that the underlying object M-polyfold is face-structured.
\qed
\end{definition}

The following result is a consequence of a previous result saying that the property of being face-structured behaves well under generalized
isomorphisms.


\begin{proposition}
Every face $A$ of a face structured polyfold $(Z,c)$ has a natural polyfold structure $(A,c\vert A)$.
\qed
\end{proposition}

\section{Tangent of a Polyfold}
Let us show next that a polyfold $(Z,c)$ has a tangent space which again is a polyfold, denoted by $T(Z,c)=(TZ,Tc)$ and equipped 
with a sc-smooth map $p:TZ\rightarrow Z$.  The tangent space at a point will not be a vector space, but a quotient
of a vector space by a linear group action. 

We need some preparation and note that if  $(Z,x)$ is a polyfold, we can employ the degeneracy index
$d_Z:Z\rightarrow {\mathbb N}$ to define the subsets $Z_i$ by
$$
Z_i = \{z\in Z\ |\ d_Z(z)\geq i\}
$$
for $i\in {\mathbb N}$.
Clearly $Z_0=Z$ and $...\subset Z_{i+1}\subset Z_i..\subset Z_0=Z$.
The subsets $Z_i$ have natural polyfold structures $c^i$ defined as follows. If $(X,\alpha)\in c$
then the homeomorphism $\alpha:|X|\rightarrow Z$ defines a bijection
$\alpha^i: |X^i|\rightarrow Z_i$ and we can equip $Z_i$ with the unique topology making $\alpha^i$
a homeomorphism. Since $X^i$ is an ep-groupoid we see that $(X^i,\alpha^i)$ defines a polyfold structure
on $Z_i$. If $(X,\alpha),\ (Y,\beta)\in c$ it follows that $(X^i,\alpha^i)$ and $(Y^i,\beta^i)$ are equivalent
polyfold structures for $Z_i$. We shall write $Z^i$ for the set $Z_i$ equipped with the polyfold structure
$c^i$ and refer to the polyfold $(Z^i,c^i)$ or $Z^i$ for short. We shall call it the polyfold obtained
from $(Z,c)$ by raising the index by $i$
$$
(Z,c)^i:= (Z^i,c^i).
$$


Now we are in the position to carry out the tangent construction. Applying the tangent functor $T$ to the ep-groupoid $X$ we obtain the tangent ep-groupoid $TX$. The tangent 
$$
T\mathfrak{f}\colon TX\rightarrow TY
$$
of a generalized isomorphism $\mathfrak{f}=[X\xleftarrow{F} A\xrightarrow{H} Y]$ between ep-groupoids is defined as the generalized isomorphism
$$
T\mathfrak{f}=T[X\xleftarrow{F} A\xrightarrow{H} Y]:=[TX\xleftarrow{TF} TA\xrightarrow{TH} TY]
$$
between the tangent ep-groupoids, $T\mathfrak{f}\colon TX\to TY$. Since $TF$ and $TH$ are equivalences between ep-groupoids in view of Theorem \ref{gertrude}, the generalized map $T\mathfrak{f}\colon TX\to TY$ is indeed a generalized isomorphism. In view of Theorem \ref{TANGENTXXX} it is independent of the choice of the representative in the equivalence class $\mathfrak{f}$ of diagrams.
The following Lemma is a trivial consequence of Theorem \ref{THMX10316}.


\begin{lemma}\label{dafe}
If the two morphisms  $( \mathfrak{f},f)$ and $(\mathfrak{g},g)\colon (X,\alpha)\rightarrow (Y,\beta)$ between polyfold structures of $Z$ satisfy $f=g=\text{id}_Z$,  then 
$$
\mathfrak{f}=\mathfrak{g}\ \ \text{and}\ \ T\mathfrak{f}=T\mathfrak{g}.
$$
\end{lemma}
\begin{proof}
We assume that the diagram $d\colon X\xleftarrow{F}A\xrightarrow{G} Y$ represents $\mathfrak{f}$ and $d'\colon X\xleftarrow{F'}B\xrightarrow{G'} Y$ represents
$\mathfrak{g}$. From  $\beta\circ \abs{\mathfrak{f}}=\alpha =\beta\circ \abs{\mathfrak{g}}$ we conclude 
\begin{equation}\label{iiii}
|\mathfrak{f}|=|\mathfrak{g}|,
\end{equation}
which implies in view of Theorem \ref{THMX10316} that $\mathfrak{f}=\mathfrak{g}$ and therefore
$T\mathfrak{f}=T\mathfrak{g}$.
\qed \end{proof} 

We fix an  admissible polyfold structure 
$(X,\alpha)$ of the polyfold $(Z, c)$ and  take the tangent $TX$ of the ep-groupoid $X$. If $(Y,\beta)$ is an equivalent  polyfold structure, meaning there exists the isomorphism $(\mathfrak{f},Id_Z):(X,\alpha)\rightarrow (Y,\beta)$, Lemma \ref{dafe} tells us that $\mathfrak{f}$ and therefore 
$$
T\mathfrak{f}\colon TX\rightarrow TY
$$
between the tangent ep-groupoids are well-defined and unique. 

Now we shall define the tangent space $T(Z,c)$ of the polyfold $(Z,c)$.
For a point $z\in Z$ on level $1$, i.e. $z\in Z_1$,  and a polyfold structure $(X,\alpha)\in c$, we introduce  equivalence classes of tuples $[(z,(X,\alpha),h)]$ in which 
 $h\in T_xX$ and $\alpha(|x|)=z$. The equivalence is   defined as follows. 

If $(z,(X,\alpha),k)$ with $k\in T_yX$ is another such tuple
we call  $(z,(X,\alpha),h)$ equivalent to $(z,(X,\alpha),k)$ if  there exists 
a morphism $\phi\colon x\rightarrow y$ satisfying $T\phi (h)=k$. 
(The linear map $T\phi$ is defined since $\phi\in {\bf X}_1$.)
We denote the collection of these  equivalence classes by
$$
T^{(X,\alpha)}(Z,c) =\bigcup_{z\in Z_1} \{z\}\times \{[(z,(X,\alpha),h)]\}.
$$
Associated with  the generalized  isomorphism $\mathfrak{f}\colon X\rightarrow Y$ satisfying $\beta\circ|\mathfrak{f}|=\alpha$, we obtain the  uniquely determined canonical bijection
$$
T^{(X,\alpha)}(Z,c)\rightarrow T^{(Y,\beta)}(Z,c),\quad [(z,(X,\alpha),h)]\rightarrow [(z,(Y,\beta),|T\mathfrak{f}|(|h|))].
$$
Identifying the points via the canonical bijections we obtain a  set which we 
denote by 
$$
T(Z,c)\index{$T(Z,c)$}.
$$ 
This set is,  by definition,   the {\bf tangent space}\index{Tangent space of a polyfold} of $(Z,c)$,   as a set. Its elements are equivalence classes of equivalence classes
$$
[[(z,(X,\alpha),h)]].
$$
For every $(X,\alpha)\in c$ we have a natural map $T\alpha: |TX|\rightarrow T(Z,c)$ defined by
$$
T\alpha(|h|) = [[(z,(X,\alpha),h)]],
$$
where $h\in T_xX$ and $x\in X_1$ with $\alpha(|x|)=z$. This map is a bijection and fits into the commutative diagram
$$
\begin{CD}
|TX| @>T\alpha >>  T(Z,c)\\
@V |\tau_X| VV   @V\tau_ZVV\\
|X^1| @>\alpha >>      Z^1.
\end{CD}
$$
Given $(X,\alpha)$ and $(Y,\beta)$ in $c$ there exists a unique $\mathfrak{f}:X\rightarrow Y$
satisfying $\beta\circ |\mathfrak{f}|=\alpha$, defining $T\mathfrak{f}:TX\rightarrow TY$.
We note that 
$$
T\beta\circ |T\mathfrak{f}|=T\alpha.
$$
From these facts and the paracompactness discussion of ep-groupoids the following result follows immediately.
\begin{lemma}\label{l_para}
The set $T(Z,c)$ has a unique natural topology ${\mathcal T}$ for which for every $(X,\alpha)$
the map $T\alpha:|TX|\rightarrow T(Z,c)$ is a homeomorphism. The topology is regular and Hausdorff.
In particular if $(Z,c)$ is paracompact the same holds
for ${\mathcal T}$.
\qed
\end{lemma}

Next we define the polyfold structure on the topological space $T(Z,c)$.  
With the polyfold structure $(X,\alpha)$ for $(Z,c)$ we associate a polyfold structure $(TX, T\alpha)$ for the topological space $T(Z, c)$ by taking the tangent $TX$ of the ep-groupoid $X$ and the  homeomorphism
$$
T\alpha\colon |TX|\rightarrow T(Z,c).
$$
The pair $(TX,T\alpha)$ defines a polyfold structure on the topological space  $T(Z, c)$. 
Indeed, if $(Y, \beta)\in c$ and if  $\mathfrak{f}:X\rightarrow Y$ is the generalized isomorphism satisfying $\beta\circ|\mathfrak{f}|=\alpha$, then
$T\mathfrak{f}:TX\rightarrow TY$ satisifies
$$
T\beta\circ |T\mathfrak{f}|=T\alpha.
$$
Therefore,  the polyfold structures $(TX, T\alpha)$ for  $T(Z,c)$ associated with the polyfold structures $(X, \alpha)$ for $(Z, c)$ are all equivalent. 


\begin{definition}[{\bf Tangent of $(Z, c)$}]
By $Tc$ we denote the equivalence class of  all polyfold structures for the topological space $T(Z,c)$
equivalent to those of the form  $(TX,T\alpha)$ for $T(Z, c)$ associated with the polyfold structures $(X,\alpha)$ of the polyfold $(Z,c)$. Then the pair $(T(Z, c), Tc)$ is a polyfold,  called the {\bf tangent of the polyfold $(Z,c)$},  and 
abbreviated by 
$T(Z,c)\index{D- Tangent of a polyfold}$.
\qed
\end{definition}
The continuous canonical projection map 
$$
p:T(Z, c)\rightarrow (Z^1, c^1)
$$
is defined, for $(X, \alpha)\in c$, by 
$$
p([[(z,(X,\alpha),h]])=z.
$$  
The  map $p$  comes from the  sc-smooth map
$$
[(P^{(X,\alpha)},p)]:T(Z,c)\rightarrow (Z^1,c^1)
$$
between the two polyfolds. Indeed, if $(TX, T\alpha)$ is the polyfold structure of $T(Z, c)$ 
associated with the polyfold structure $(X,\alpha)$ of $(Z, c)$, the generalized sc-smooth 
map  $P^{(X,\alpha)}\colon TX\rightarrow X^1$ between the ep-groupoids is the equivalence class 
$$P^{(X,\alpha)}=[TX\xleftarrow{1_{TX}}TX\xrightarrow{P}X^1]$$
where $P\colon TX\to X^1$ is the  canonical sc-smooth functor,   defined by 
$P(h)=x,$
if $h\in T_xX$ and $(X,\alpha)\in c$. 
It satisfies 
$$
p\circ T\alpha=\alpha\circ |P^{(X,\alpha)}|. 
$$
Hence, the sc-smooth map 
$[(P^{(X,\alpha)},p)]\colon T(Z,c)\rightarrow (Z^1,c^1)$ between the polyfolds induces,  on the topological level, the continuous projection  $p$. It  is the canonical sc-smooth bundle projection
to which we refer to sometimes as $p:TZ\rightarrow Z^1$,  if $c$ is understood.

\begin{theorem}\index{T- Tangent functor for polyfolds}
In the polyfold  category ${\mathcal P}$ introduced in Definition \ref{polyfold_category_def} there  exists a natural functor $T$, called the  {\bf tangent functor}\index{Tangent functor for polyfolds}\, which associates with the polyfold $(Z, c)$ its tangent $T(Z, c)$ and with a sc-smooth map $\wh{f}\colon (Z, c)\to (W, d)$ between polyfolds according to Definition \ref{sc-smooth_ map_pol}, its tangent $T\wh{f}\colon T(Z, c)\to T(W, d)$.  
\end{theorem}
\begin{proof}
We have already constructed $T$ on the objects of ${\mathcal P}$ and now consider a sc-smooth map  $\wh{f}\colon (Z,c)\rightarrow (W,d)$ between polyfolds. By definition, $\wh{f}=[( \mathfrak{f},f)]$ where $f\colon Z\to W$ is a continuous map and $\mathfrak{f}\colon X\to Y$ is a generalized map between ep-groupoids satisfying $f\circ \alpha =\beta \circ \abs{\mathfrak{f}}$  for the polyfold structures $(X, \alpha)\in c$ and $(Y, \beta)\in d$. We define its tangent  map 
$$T\wh{f}=[( T\mathfrak{f},Tf)]\colon T(Z, c)\to T(W, d)$$
by 
$$
Tf([[(z,(X,\alpha),h)]])=[[(f(z),(Y,\beta),k)]]  
$$
where $|k|=|T\mathfrak{f}|(|h|)$. 
One easily verifies that $T$ is a functor.
\qed \end{proof}

Next we study sc-differential forms on the polyfold $(Z, c)$ and choose 
a polyfold structure $(X, \alpha)$ in $ c$, so that $\alpha:|X|\rightarrow Z$ is a homeomorphism.
If $(X',\alpha')\in c$ is another polyfold structure for $(Z, c)$, then there exists a unique  sc-smooth generalized isomorphism $\mathfrak{h}:X\rightarrow X'$ between ep-groupoids satisfying
\begin{equation}\label{fish}
\alpha'\circ |\mathfrak{h}|=\alpha.
\end{equation}
 If $\omega\in \Omega^\ast_{ep,\infty}(X)$ is a sc-form on $X$, then the push-forward sc-form $\mathfrak{h}_\ast\omega\in 
\Omega^\ast_{ep,\infty}(Y)$ is well-defined,  and by Theorem \ref{OOmaine} does not depend  on $\mathfrak{h}$ provided \eqref{fish} holds.
The same is true  for the pull-back of a form $\omega'\in \Omega^\ast_{ep,\infty}(Y)$.

As a consequence of the previous discussion we shall  define the notion of a sc-differential form on a polyfold $Z$.
\begin{definition}\label{def_2.70}
 A {\bf sc-differential form on the polyfold $(Z,c)$}  is an equivalence class $[(\omega,(X,\alpha)]$  where $(X,\alpha)$ is a polyfold structure in $c$
and $\omega\in \Omega_{ep,\infty}(X)$ a sc-differential form on $X$. The equivalence is defined as follows,  
$$(\omega,(X,\alpha))\sim(\tau,(Y,\beta))$$
for $(X, \alpha)$ and $(Y, \beta)$ in $c$, if  there exists a generalized isomorphism 
 $\mathfrak{h}:X\rightarrow Y$ between ep-groupoids satisfying 
 $\beta \circ \abs{\mathfrak{h}}=\alpha$ and 
$\tau=\mathfrak{h}_\ast\omega$.
\end{definition}
We denote by $\Omega_{sc}^\ast(Z,c)$ the collection of sc-differential forms on $(Z,c)$.  This is a vector space with the operations defined by 
$$
[(\omega,(X,\alpha))]+\lambda[(\tau,(X,\alpha))]=[(\omega+\lambda\tau,(X,\alpha))].
$$
The exterior differential $d=d_Z$ is defined as
$$
d[(\omega,(X,\alpha))]=[(d\omega,(X,\alpha))].
$$
If 
$$
\what{f}:(Z,c)\rightarrow (Z',c')
$$
is a sc-smooth map between the two polyfolds,  and 
if $(X,\alpha)\in c$ and $(X',\alpha')\in c'$ are polyfold structures, then there exists a representative $(\mathfrak{f},f)$, where $f:Z\rightarrow Z'$ is a continuous map
and $\mathfrak{f}:X\rightarrow X'$ a generalized map between ep-groupoids, and we define the {\bf pull-back} of  $[(\omega',(X',\alpha')]\in \Omega_{sc}^\ast(Z',c')$ by 
$$
(\what{f})^\ast [(\omega',(X',\alpha'))] = [(\mathfrak{f}^\ast\omega',(X,\alpha))].
$$
By construction,  
$$
d_Z\circ \what{f}^\ast =\what{f}^\ast\circ d_{Z'}.
$$
We can summarize the discussion, which reduces it to the already discussed
ep-groupoid case,  in  the following theorem.
\begin{theorem}
Given a polyfold $(Z,c)$,  there is an associated deRham complex $(\Omega^\ast_{sc}(Z,c),d)$. A  sc-smooth map
$\what{f}:(Z,c)\rightarrow  (Z',c')$ between polyfolds induces  the co-chain map
$$
\text{$\what{f}^\ast\colon \Omega^\ast_{sc}(Z',c')\rightarrow \Omega^\ast_{sc}(Z,c)$ \quad satisfying $\ d_Z\circ \what{f}^\ast=\what{f}^\ast\circ d_{Z'}$}.
$$
Moreover,  the usual functorial properties hold.
\end{theorem}




\section{Strong Polyfold Bundles}
We shall introduce the notion of a strong polyfold bundle. The basic building blocks are again 
equivalence classes of strong bundles over ep-groupoids, quite in the spirit of the previous discussions.
Since there are no new ideas needed we allow ourselves to be somewhat sketchy.

The polyfold $(Z, c)$ is a topological space $Z$ equipped with an equivalence class $c$ of polyfold structures $(X, \alpha)$. Similarly we are going to define the strong polyfold bundle $(p\colon Y\to Z, \ov{c})$ over the polyfold $(Z, c)$ as a continuous and surjective map $p$ between the topological spaces equipped with an equivalence class $\ov{c}$ of strong polyfold bundle structures for $p$.
\begin{definition}[{\bf Strong polyfold bundle structures}]
Let $Y$  and $Z$ be two topological spaces and let 
$$p\colon Y\to Z$$
be 
a continuous and surjective map.
 A {\bf strong polyfold bundle structure}\index{D- Strong polyfold bundle structure} for $p\colon Y\rightarrow Z$ is a tuple 
 $$
 ((P\colon W\rightarrow X,\mu),\Gamma,\gamma)
 $$ 
 consisting of a 
strong bundle  $(P\colon W\rightarrow X,\mu)$ over the  ep-groupoid $X$, a the homeomorphism $\Gamma\colon |W|\rightarrow Y$ covering the homeomorphism $\gamma\colon |X|\rightarrow Z$ so that $p\circ \Gamma = \gamma\circ |P|$, as illustrated in the diagram
\begin{equation*}
\begin{CD}
W@>>> \abs{W}@>\Gamma>>Y \\
@V PVV @V\abs{P}VV   @VVp V\\
X@>>> \abs{X} @>\gamma>>Z,\\
\end{CD}
\end{equation*}
where the horizontal arrows on the left are the maps passing to  orbits.
\qed
\end{definition}
The smoothness properties of $p:Y\rightarrow Z$ are described by $(P:W\rightarrow X,\mu)$.  In general the latter 
is only taken up to (some notion of) equivalence, which is explained now.
\begin{definition}[{\bf Equivalence of strong polyfold bundle structures}]\index{D- Equivalence of strong polyfold bundle structures}
 Two strong polyfold bundle structures 
 $$
 ((P\colon W\to X, \mu), \Gamma, \gamma)\ \ \text{and}\ \ 
((P'\colon W'\to X', \mu'), \Gamma', \gamma')
$$ 
for the map 
 $$p\colon Y\to Z$$
 are {\bf equivalent} if there exists a generalized strong bundle isomorphism
 $$
\mathfrak{F}\colon W\to W'
 $$
  covering the generalized isomorphism $\mathfrak{f}\colon X\to X'$ between ep-groupoids and satisfying  
 \begin{align*}
 \gamma'\circ \abs{\mathfrak{f}}=\gamma\quad \text{and}\quad \Gamma'\circ \abs{\mathfrak{F}}&=\Gamma.
  \end{align*}
 The situation is illustrated in the diagrams 
 \begin{equation*}
 \begindc{\commdiag}[500]
\obj(1,1)[aa]{$W$}
\obj(3,1)[ap]{$W'$}
\obj(1,0)[bb]{$X$}
\obj(3,0)[bp]{$X'$}
\mor{aa}{ap}{$\mathfrak{F}$}
\mor{aa}{bb}{$P$}[\atright,\solidarrow]
\mor{ap}{bp}{$P'$}
\mor{bb}{bp}{$\mathfrak{f}$}
\enddc
\qquad \qquad  \qquad 
\begindc{\commdiag}[500]
\obj(2,2)[yy]{$Y$}
\obj(1,1)[ww]{$\abs{W}$}
\obj(3,1)[wp]{$\abs{W'}$}
\obj(1,0)[xx]{$\abs{X}$}
\obj(3,0)[xp]{$\abs{X'}.$}
\obj(2,-1)[zz]{$Z$}
\mor{ww}{yy}{$\Gamma$}
\mor{wp}{yy}{$\Gamma'$}[\atright,\solidarrow]
\mor{ww}{wp}{$\abs{\mathfrak{F}}$}
\mor{ww}{xx}{$\abs{P}$}[\atright,\solidarrow]
\mor{wp}{xp}{$\abs{P'}$}
\mor{xx}{xp}{$\abs{\mathfrak{f}}$}
\mor{xx}{zz}{$\gamma$}[\atright,\solidarrow]
\mor{xp}{zz}{$\gamma'$}
\enddc
\end{equation*}
\qed
 \end{definition}
 An equivalence class $\ov{c}$ of strong bundle structures for $p\colon Y\to Z$ induces an equivalence class $c$  of polyfold structures for the polyfold $(Z, c)$.

 \begin{definition}
 A {\bf strong polyfold bundle}\index{D- Strong polyfold bundle}
  $(p:Y\rightarrow Z,\bar{c})$ consists of a surjective continuous map $p:Y\rightarrow Z$  between topological spaces and  an equivalence class $\bar{c}$ of strong polyfold bundle structures for $p$.
\qed
 \end{definition}


\begin{definition}
The strong polyfold bundle  $(p\colon Y\rightarrow Z,\bar{c})$ is called  
\begin{itemize}
\item[(1)]  \ {\bf tame}\index{D- Tame strong polyfold bundle} if the  polyfold $(Z,c)$ is tame.
\item[(2)]\  {\bf weakly face-structured}\index{D- Weakly face-structured} if $(Z,c)$ is weakly face-structured.
\item[(3)]\  {\bf face-structured} \index{D- Face structured} if$(Z,c)$ is face-structured.
\end{itemize}
\qed
\end{definition}
Next we introduce the category ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$ \index{Category  ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$} of {\bf strong polyfold bundle structures}. \index{Category of strong bundle structures} 
The objects of the category are the tuples
$$
\mathsf{S}=((P:W\rightarrow X,\mu), \Gamma,\gamma), 
$$
consisting of a strong bundle $(P:W\rightarrow X,\mu)$ over an ep-groupoid and homeomorphisms 
$\Gamma:|W|\rightarrow Y$ and $\gamma:|X|\rightarrow Z$, where $Y$ and $Z$ are topological spaces (depending on $\mathsf{S}$).
We note that $\gamma \circ |P|\circ \Gamma^{-1}:Y\rightarrow Z$ is a surjective continuous map and we shall denote it by $p$ so that
$$
p:Y\rightarrow Z.
$$
View this as a kind of bundle situation. We note that $Y=Y_{\mathsf{S}}$, $Z=Z_{\mathsf{S}}$, and $p=p_{\mathsf{S}}$.
The following discussion essentially is parallel to the discussion in the polyfold case. 
We shall call $\mathsf{S}$ a {\bf strong polyfold bundle structure} on $p_{\mathsf{S}}$, i.e. $p:Y\rightarrow Z$.
It is sometimes convenient to view $\mathsf{S}=((P:W\rightarrow X,\mu), \Gamma,\gamma)$ as 
$\mathsf{S}=((P:W\rightarrow X,\mu), \Gamma,\gamma,p)$, where $p$ is, of course, redundant information.


\begin{definition}\index{D- The category ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$}
A {\bf morphism}  in the category ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$ between two objects $\mathsf{S}$ and $\mathsf{S}'$
with  $\mathsf{S}= ((P\colon W\rightarrow X,\mu), \Gamma,\gamma)$ and $\mathsf{S}'=
((P'\colon W' \rightarrow X',\mu'), \Gamma',\gamma')$
is a $4$-tuple $( \mathfrak{A}, \mathfrak{a},A,a)$ in which $A\colon Y\to Y'$ and $a\colon Z\to Z'$ are continuous maps between topological spaces satisfying 
$$
p_{\mathsf{S}'}\circ A=a\circ p_{\mathsf{S}},
$$
i.e., $A\colon Y\to Y'$ is a bundle map covering the map $a\colon Z\to Z'$. Here $p_{\mathsf{S}}:Y\rightarrow Z$ and $p_{\mathsf{S}'}:Y'\rightarrow Z'$ is the data associated to $\mathsf{S}$ and $\mathsf{S}'$, respectively.
Moreover, $\mathfrak{A}\colon W\to W'$ is a generalized strong bundle map covering the generalized map $\mathfrak{a}\colon X\to X'$    between the underlying ep-groupoids and satisfying the compatibility conditions
$$
\text{$\Gamma' \circ |\mathfrak{A}| = A\circ \Gamma$\quad \text{and}\quad
$\gamma'\circ |\mathfrak{a}| =a\circ \gamma.$}
$$
The morphism $( \mathfrak{A}, \mathfrak{a},A,a)$  is {\bf invertible} (i.e. an isomorphism) if the continuous maps $A\colon Y\to Y'$ and $a\colon Z\to Z'$ are homeomorphism, and $\mathfrak{A}\colon W\to W'$ is a generalized strong bundle isomorphism covering the generalized isomorphism $\mathfrak{a}\colon X\to X'$ between ep-groupoids.
\qed
\end{definition}
The definition is illustrated by the following diagrams.
$$
\begin{array}{ccc}
\begin{CD}
W @>\mathfrak{A}>> W'\\
@V PVV @V P' VV\\
X @>\mathfrak{a}>> X'
\end{CD}
&
\begin{CD}
|W|@ >|\mathfrak{A}| >> |W'|\\
@V \Gamma VV     @V \Gamma' VV\\
Y @> A>> Y'
\end{CD}
&
\begin{CD}
|X| @>|\mathfrak{a}|>> |X'|\\
@V\gamma VV  @V \gamma' VV\\
Z @> a>> Z'
\end{CD}
\end{array}
$$
The composition of two morphisms is defined by
$$
(\mathfrak{A}',\mathfrak{a}',A',a')\circ (\mathfrak{A},\mathfrak{a},A,a)=(\mathfrak{A}'\circ\mathfrak{A},\mathfrak{a}'\circ\mathfrak{a},A'\circ A, a'\circ a).
$$
To simplify the notation we shall abbreviate the morphism 
$$
(\mathfrak{A},A):=(\mathfrak{A}, \mathfrak{a},A,a),
$$
keeping in mind the underlying maps $(\mathfrak{a},a).$
Generalizing the polyfold map we next introduce the notion of a sc-smooth {\bf strong bundle map} between two strong polyfold bundles 
$$
(p\colon Y\rightarrow Z, \ov{c})\quad \text{and}\quad (p'\colon Y'\rightarrow Z', \ov{c}').
$$
Starting with  the strong polyfold bundle $(p\colon Y\rightarrow Z, \ov{c})$ the equivalence class $\ov{c}$ of polyfold structures consists of all the objects 
$$
\mathsf{S}= ((P\colon W\to X, \mu), \Gamma, \gamma)
$$
 of the category ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$, for which there exists an isomorphism $(\mathfrak{A},A)$ between them of the special form $(\mathfrak{A},Id_Y)$, where $p= \gamma\circ |P|\circ \Gamma^{-1}$.
We now proceed as in the polyfold case.  Take two morphisms
$(\mathfrak{A}_0,A_0)$  and $( \mathfrak{A}_1,A_1)$  in the category 
${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$, where 
\begin{equation*}
\begin{split}
( \mathfrak{A}_0,A_0)\colon& ((P_0\colon W_0\to X_0, \mu_0), \Gamma_0, \gamma_0, p\colon Y\to Z)\\
&\quad \to ((P'_0\colon W'_0\to X'_0, \mu'_0), \Gamma'_0, \gamma'_0, p'\colon Y'\to Z')
\end{split}
\end{equation*}
and 
\begin{equation*}
\begin{split}
( \mathfrak{A}_1,A_1)\colon &((P_1\colon W_1\to X_1), \mu_1), \Gamma_1), \gamma_1, p\colon Y\to Z)\\
&\quad  \to 
((P'_1\colon W_1'\to X_1', \mu_1'), \Gamma_1', \gamma_1', p'\colon Y'\to Z')
\end{split}
\end{equation*}
for two polyfold polyfold bundle structures for $p\colon Y\to Z$, and two polyfold bundle structures for $p'\colon Y'\to Z'$.

\begin{definition}[{\bf Equivalence of morphisms in ${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$}]
The two morphisms $( \mathfrak{A}_0,A_0)$  and $( \mathfrak{A}_1,A_1)$ are {\bf equivalent} if there exists an isomorphism $(\mathfrak{H},Id_Y)$ between the polyfold bundle structures of $p$ and an isomorphism $(\mathfrak{H}',Id_{Y'})$ between the polyfold bundle structures of $p'$ satisfying 
$$
(\mathfrak{A}_1,A_1)\circ ( \mathfrak{H},Id_{Y})=( \mathfrak{H}',Id_{Y'})\circ (\mathfrak{A}_0,A_0).
$$
\qed
\end{definition}
From the definition it follows that $A_1=A_0:Y\rightarrow Y'$.  We also have that $a_1=a_0:Z\rightarrow Z'$. 
In particular the following  diagram holds.
$$
\begin{CD}
|W_0|@>\Gamma_0>> Y @< \Gamma_1 << |W_1|\\
@V|\mathfrak{A}_0| VV   @ V AVV @ V |\mathfrak{A}_1| VV\\
|W_0'|     @>\Gamma_0' >>   Y' @< \Gamma_1' << |W_1'|
\end{CD}
$$
In addition the generalized isomorphisms $\mathfrak{H}:W_0\rightarrow W_1$ and $\mathfrak{H}':W_0'\rightarrow W_1'$ satisfy
$$
\mathfrak{A}_1\circ \mathfrak{H} = \mathfrak{H}'\circ \mathfrak{A}_0.
$$
These diagrams induce similar diagrams for the base spaces.
\begin{definition}[{\bf Strong polyfold bundle maps}] 
A sc-smooth strong polyfold bundle  map
$$\wh{F}\colon (p\colon Y\to Z, \ov{c})\to  (p'\colon Y'\to Z', \ov{c}')$$
is an equivalence class $( \mathfrak{A},A)$ of morphism in 
${\mathcal S}{\mathcal P}{\mathcal B}{\mathcal S}$.
\qed
\end{definition}





\begin{definition}[{\bf Auxiliary norm on strong polyfold bundles}]
\index{D- Auxliary norms for srong polyfold bundles}
An {\bf auxiliary norm} $n$  of a strong polyfold bundle  $(p\colon Y\to  Z, \ov{c})$ over the polyfold $Z$  is a continuous map
$$n\colon Y_{(0,1)}\rightarrow [0,\infty)
$$
with the property,  that for every strong bundle structure $m=((P\colon W\rightarrow X, \mu),\Gamma,\gamma)$  there exists  an auxiliary norm
$N\colon W_{0,1}\rightarrow [0,\infty)$ satisfying  
$$
n(\Gamma (\abs{e}  ))= N (e)
$$
 for every $e\in E_{0,1}$. Here the subset $Y_{0,1}\subset Y$ is given by 
 $Y_{0,1}=\Gamma (\abs{W_{0,1}})$. It is independent of the choice of the strong bundle structure $m\in \ov{c}$ used.
 \qed
\end{definition}

We assume that the polyfold structure $((P'\colon W'\to X',\mu'), \Gamma', \gamma')\in \ov{c}$ possesses the auxiliary norm $N'$. Then every equivalent polyfold structure 
 $((P\colon W\to X,\mu), \Gamma, \gamma)\in \ov{c}$ possesses, in view of Theorem \ref{prop_auxiliary_norm}, 
the auxiliary norm $N=[D]^\ast N'$ which is defined as follows. We choose a representative diagram $W\xleftarrow{\Phi}W''\xrightarrow{\Psi}W'$ for $[D]$. Fixing $e\in W$, we find, using that $\Phi$ is an equivalence, a point $e''\in W''$ and  morphism $\Phi (e'')\to e$ and define 
$$
N(e)=([D]^\ast N') (e):=N'(e'),
$$
 where $e'=\Psi (e'')$. Since $N'\colon W'\to \R^+$ is a functor, the definition does not depend of the choice of the representative diagram. From 
$\abs{[D]}(\abs{e})=\abs{\Psi}\circ \abs{\Phi}^{-1}(\abs{e})=\abs{\Psi}(\abs{e''})=\abs{e'}$ and $\Gamma'\circ \abs{[D]}=\Gamma$, we conclude that 
$$n(\Gamma (\abs{e}  )=N(e)=N'(e')=n(\Gamma' (\abs{e'}  ).$$

Therefore, the auxiliary norm $n$ on the strong polyfold bundle $p$ is well-defined if one of the strong polyfold structures in $\ov{c}$ possesses an auxiliary norm. According to Theorem \ref{ANorm1-prop} this happens if $p\colon Y\to Z$ is a paracompact polyfold $Z$. 

\begin{proposition}[{\bf Existence of an auxiliary norm}]\label{existence_auxiliary_norm} 
A strong polyfold bundle $(p\colon Y\rightarrow Z, \ov{c})$ over a paracompact base polyfold $Z$ possesses an auxiliary norm $n\colon Y_{0,1}\to \R^+$.
\qed
\end{proposition}

\begin{remark}\index{R- Remark on auxiliary norms}
We should remark that an auxiliary norm $n$ is, in general, not a norm on a fiber which is not necessary a vector space.
\qed
\end{remark}



\begin{definition}[{\bf Reflexive $1$-fibers}]\label{DEF1228}\index{D- Strong polyfold bundle with reflexive $1$-fiber}
A strong polyfold bundle $p\colon Y\rightarrow Z$ is said to have {\bf reflexive $1$-fibers}  if there exists a strong polyfold  structure 
$\mathfrak{m}=((P\colon W\rightarrow X, \mu),\Gamma,\gamma)$ in which the fibers  $W_{0,1}$ are reflexive Banach spaces. (The equivalent strong polyfold bundle structures then have also reflexive $1$-fibers).
\qed
\end{definition}


\begin{definition}
[{\bf Reflexive auxiliary norm}]\label{DEF1229}\index{Reflexive auxiliary norm}
A {\bf reflexive auxiliary norm}  of strong polyfold bundle $(p\colon Y\to Z, \ov{c})$ possessing reflexive fibers is an auxiliary norm $n\colon Y_{0,1}\to \R^+$ for which there exists a {\bf reflexive} auxiliary norm $N\colon W_{o,1}\to \R^+$ in a model $m=((P\colon W\to X,\mu), \Gamma, \gamma)\in \ov{c}$ satisfying $n(\Gamma (\abs{w}))=N(w)$ for all $w\in W_{0,1}$.
\qed
\end{definition}
\begin{definition}[{\bf Mixed convergence for $p$}]
Let $(p\colon Y\to Z, \ov{c})$ be a strong polyfold bundle having reflexive $1$-fibers. A sequence $(y_k)\subset Y_{0,1}$ is called {\bf mixed convergent} to $y\in Y_{0,1}$, if there exists a reflexive auxiliary norm $N\colon W_{0,1}\to \R^+$ in the model $m\in \ov{c}$ such that the sequence $\Gamma^{-1}(y_k)\subset \abs{W_{0,1}}$ and the point $\Gamma^{-1}(y)$ have representative $w_k$ resp. $w$ in $W_{0,1}$, for which $w_k\xrightarrow{m}w$ in $W_{0,1}$.
\qed
\end{definition}

From Theorem \ref{EXTTT} we deduce the following result.
\begin{theorem}\index{T- Reflexive auxiliary norms}
Let $p\colon Y\rightarrow Z$ be a strong polyfold bundle over the paracompact polyfold $Z$. If  $p$ has reflexive $1$-fibers, then 
the following holds.
\begin{itemize}
\item[{\em (1)}] \ \ The bundle $p$ admits a reflexive auxiliary norm $n$.
\item[{\em (2)}] \ \ For every  auxiliary norm $n$  for $p$ there exist reflexive auxiliary norms $n_1$ and $n_2$ for $p$ 
satisfying
$$
n_1\leq n\leq n_2.
$$
\end{itemize}
\qed
\end{theorem}

The theorem guarantees a large supply of reflexive auxiliary norms for $p$. Let us collect  some of the properties of such an auxiliary norm.
\begin{proposition}\index{P- Mixed convergence in polyfold bundles}
 If $(p\colon Y\rightarrow Z, \ov{c})$ is a strong polyfold bundle over the paracompact polyfold $Z$ possessing reflexive $1$-fibers, then the following holds for a reflexive auxiliary norm $n$ for $p$.
\begin{itemize}
\item[{\em (1)}] \  If $(y_k)\subset Y_{0,1}$ satisfies $p(y_k)\rightarrow z$ and $n(y_k)\rightarrow 0$,
then $y_k\rightarrow 0_{z}$ in $Y_{0,1}$.
\item[{\em (2)}]\  If $(y_k)$ is mixed convergent to $y\in Y_{0,1}$, then 
$$
n(y)\leq \liminf_{k\rightarrow\infty} n(y_k).
$$
\end{itemize}
\qed
\end{proposition}
In the case that the polyfold $Z$ is paracompact and hence, as we have pointed out, metrizable, an extension results for auxiliary norms defined on the boundary $\partial Z$ to the whole of $Z$ are available.  These results are based on Theorem \ref{EXTT} and 
Theorem \ref{THMOP12213} in the case of reflexive auxiliary norms, and use the fact that 
auxiliary norms behave well under generalized strong bundle isomorphisms. Pullbacks and push-forwards under the  latter
also preserve the relexiveness property.
\begin{theorem}\index{T- Extension of auxiliary norms}\label{THMX2213X}
Let $(p:Y\rightarrow Z,\bar{c})$ be a strong polyfold bundle over the tame paracompact
polyfold $Z$ and assume that $n: Y_{0,1}|\partial Z\rightarrow {\mathbb R}^+$ is an auxiliary norm. Then the following holds true.
\begin{itemize}
\item[(1)]\ Then there exists an auxiliary norm $\overline{n}:Y_{0,1}\rightarrow {\mathbb R}^+$
which extends $n$.
\item[(2)]\ If $n$ is reflexive the extension $\overline{n}$ be be taken to be reflexive as well.
\end{itemize}
\qed
\end{theorem}




A strong polyfold bundle $(p\colon Y\to Z, \ov{c})$ possesses a canonical zero section $z\mapsto 0_z$ induced from the zero sections of the strong bundles $(P\colon W\to X,\mu)$ in the overhead $\ov{c}$.
In view the discussion of the behavior of sc-smooth section of strong bundles over ep-groupoids under generalized strong bundle maps in Section \ref{STE__x}
we can define sc-smooth sections of strong polyfold bundles. The constructions  turn out to be compatible with sc-Fredholm sections and $\ssc^+$-sections.


We start with the  strong polyfold bundle $p\colon Y\rightarrow Z$ and choose a strong polyfold bundle structure  $((P\colon W\to X, \mu), \Gamma, \gamma),$ where 
$P\colon W\rightarrow X$ is a strong bundle over the ep-groupoid $X$ and  $\Gamma\colon \abs{W}\rightarrow Y$ is  a homeomorphism  covering the homeomorphism $\gamma\colon \abs{X}\rightarrow Z$ satisfying $p\circ \Gamma=\gamma \circ \abs{P}.$


In this bundle structure  a sc-smooth section is, by definition, a pair $(f,F)$ in which $f\colon Z\to Y$ is  a continuous section of the strong polyfold bundle $p$,  and $F\colon X\to W$ is a sc-smooth functor of the strong bundle $P$, such that 
$$
\Gamma\circ |F|= f\circ \gamma\quad  \text{on}\ \ |X|.
$$
We represent these  data as a tuple $(f,\Gamma, W,F)$. If we take  a different strong polyfold bundle chart 
$((P'\colon W'\to X', \mu'), \Gamma', \gamma')$ for $p$ we obtain the tuple 
$(f',\Gamma',W',F')$ and introduce the equivalence relation 
$$(f,\Gamma, W,F) \sim(f',\Gamma',W',F'),$$ defined by the requirement $f=f'$ and there exists a generalized strong bundle isomorphism $\mathfrak{A}\colon W\rightarrow W'$ satisfying
$$
\Gamma' \circ |\mathfrak{A}| =\Gamma\quad  \text{and}\quad   \mathfrak{A}_\ast F= F'.
$$
We recall that if $\mathfrak{A}=[W\xleftarrow{\Phi}W''\xrightarrow{\Psi}W']$, then $\mathfrak{A}_\ast=\Psi_\ast\circ \Phi^\ast$.
This defines an equivalence relation $\sim$.


\begin{definition}\index{D- Strong bundle section}
A {\bf sc-smooth section of the strong polyfold bundle} $p\colon Y\rightarrow Z$ consists of an equivalence class
$[(f,\Gamma,W,F)]$, where $(W,\Gamma)$ is an admissible  strong bundle structure for $p$,  $F$ is a sc-smooth section functor
of the strong bundle $P\colon Y\to X$ over the ep-groupoid $X$, and $f$ is a continuous section of $p$ satisfying 
$$f\circ \gamma= \Gamma\circ |F|.$$
\qed
\end{definition}

Any admissible strong bundle structure $(P:W\rightarrow X,\Gamma,\gamma)$ of a strong polyfold bundle $p\colon Y\rightarrow Z$
defines a bi-level structure $Y_{m,k}$ with $0\leq k\leq m+1$ on $Y$.  In particular,  $Y_{0,1}$ is a topological space with a surjective continuous map  $p=p_{0,1}\colon Y_{0,1}\rightarrow Z$. 

\begin{definition}\index{D- $\ssc^+$-polyfold section}
A {\bf $\ssc^+$-smooth section of the strong polyfold bundle} $p\colon Y\rightarrow Z$ consists of an equivalence class
$[(f,\Gamma,W,F)]$, where $(W,\Gamma)$ is an admissible  strong bundle structure for $p$,  $F$ is a $\ssc^+$-smooth section functor
of $P\colon W\rightarrow X$, and $f$ is a continuous section of $p\colon Y_{0,1}\rightarrow Z$ satisfying 
 $$f\circ\gamma= \Gamma\circ \abs{F}.$$
 \qed
\end{definition}
\section{Branched Finite-Dimensional Orbifolds}
The definition of a polyfold utilizes  the notion of a generalized isomorphism.
Our aim 
is to introduce the concept of a branched (weighted) suborbifold of $Z$ as well as  related notions.
That this is possible is rooted in the fact that  a branched ep$^+$-subgroupoid
is well-behaved under generalized isomorphisms. This allows to combine the discussions
in Chapters \ref{CHAPTER_9} and \ref{CHAPTER_11}.  The following results
are easily reduced to already established facts. 

Assume that $(Z,c)$ is a polyfold and $(X,\alpha)\in c$ a polyfold structure. 
As shown in Theorem \ref{THM1133} a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$
can be used to push-forward or pull-back branched ep$^+$-subgroupoids $\Theta$.  Moreover the 
operations $\mathfrak{f}_\ast$ and $\mathfrak{f}^\ast$ preserve many of the properties
such a branched ep$^+$-subgroupoid may have. Namely being closed or compact, being of manifold-type or being of orbifold-type, as well as the dimensional decomposition,
see Definition \ref{DEF915} (closed or compact), Definition \ref{DEF917} (manifold-type or orbifold-type), and Proposition \ref{PROP919} (dimensional decomposition).
Moreover, if $\Theta$ is tame this property is preserved under pull-backs and push-forwards.

\begin{definition}\index{D- Branched suborbifold}
A {\bf branched (weighted) suborbifold} of $(Z,c)$ is an equivalence class
$\theta\equiv [\Theta,(X,\alpha)]$, where $(X,\alpha)\in c$ and $\Theta:X\rightarrow {\mathbb Q}^+$
is a branched ep$^+$-subgroupoid. Here $(\Theta,(X,\alpha))$ and $(\Theta',(X',\alpha'))$
are equivalent provided there exists a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$ 
satisfying
\begin{itemize}
\item[(1)]\ $\alpha'\circ |\mathfrak{f}|=\alpha$.
\item[(2)]  \ $\mathfrak{f}^\ast\Theta'=\Theta$.
\end{itemize}
\qed
\end{definition}
Given $\theta$ and two representatives $(\Theta,(X,\alpha))$ and $(\Theta',(X',\alpha'))$,
 we note that $|\Theta'|\circ |\mathfrak{f}| =|\Theta|$, which implies
that 
$$
|\Theta|\circ \alpha^{-1} = |\Theta'|\circ |\mathfrak{f}|\circ \alpha^{-1} =|\Theta'|\circ \alpha'^{-1}.
$$
This means that we obtain a well-defined map $Z\rightarrow {\mathbb Q}^+$, again denoted by $\theta$, by defining, using a representative $(\Theta,(X,\alpha))$
$$
\theta= |\Theta|\circ \alpha^{-1}.
$$
Of course, there is a lot of overhead associated to this map.

\begin{definition}\index{D- Types of branched suborbifolds}
Let $\theta$ be a branched suborbifold of $(Z,c)$, and let $(\Theta,(X,\alpha))$ 
be a representative of $\theta$. 
\begin{itemize}
\item[(1)] \ $\theta$ is called {\bf closed} provided $\Theta$ is closed.
\item[(2)]  \ $\theta$ is called {\bf compact} provided $\Theta$ is compact.
\item[(3)]  \ $\theta$ is said to be of {\bf manifold-type} provided $\Theta$ is of manifold-type.
\item[(4)] \ $\theta$ is said to be of {\bf orbifold-type} provided $\Theta$ is of orbifold-type.
\item[(5)]   \ $\theta$ is said to be {\bf tame} provided $\Theta$ is tame.
\end{itemize}
\qed
\end{definition}
As a consequence of previously established results
we obtain the following proposition.
\begin{proposition}
If $\theta$ is a branched suborbifold of the polyfold $(Z,c)$
let $A=\supp(\theta)$ be the subset of all $z\in Z$ with $\theta(z)>0$
which is a topological subspace of $Z$. If $\theta$ is of manifold-type,
then $A$ has a natural smooth manifold structure, and if $\theta$ is of orbifold-type,
then $A$ has a natural smooth orbifold structure.  Both these structures
are  induced from the overhead
of $(Z,c)$.
\end{proposition}
\begin{proof}
This follows from Proposition \ref{PROPY918} and Theorem \ref{THM1133}.
\qed \end{proof}
We can also define orientations for branched suborbifolds using Theorem \ref{THM1135}.
\begin{definition}\label{DEFNX16.31}
Let $(Z,c)$ be a polyfold. An {\bf oriented branched suborbifold} \index{D- Oriented branched suborbifold} of $(Z,c)$
is given by an equivalence class $[(\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha)]$,
where $(X,\alpha)\in c$ and $(\Theta, \wh{\mathsf{T}}_\Theta)$ is an oriented
branched ep$^+$-subgroupoid. The equivalence 
$$
((\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha))\sim ((\Theta',\wh{\mathsf{T}}_{\Theta'}),(X',\alpha'))
$$
is defined by requiring the existence of a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$
satisfying
$$
\mathfrak{f}^\ast(\Theta',\wh{\mathsf{T}}_{\Theta'})=(\Theta,\wh{\mathsf{T}}_{\Theta})\ \text{and}\ \alpha'\circ|\mathfrak{f}|=\alpha.
$$
\qed
\end{definition}
We shall simplify notation by setting $\wh{\theta}=[(\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha)]$.

Next we introduce the notion of differential form on a polyfold $(Z,c)$.
\begin{definition}
Given $(X,\alpha)\in c$ a {\bf sc-differential form} is given by an equivalence class
$[\omega,(X,\alpha)]$, where $\omega\in \Omega^\ast_{ep,\infty}(X)$.
Here
$$
(\omega,(X,\alpha))\sim (\omega',(X',\alpha'))
$$
provided there exists a generalized isomorphism $\mathfrak{f}:X\rightarrow X'$
satisfying $\alpha'\circ |\mathfrak{f}|=\alpha$ and $\mathfrak{f}\omega'=\omega$.
\qed
\end{definition}
Given an sc-smooth map $\wh{g}:(Z,c)\rightarrow (Z',c')$ 
the pull-back $\wh{g}^\ast [(\omega',(X',\alpha'))]$ is defined by 
$$
\wh{g}^\ast [(\omega',(X',\alpha'))] = [(\mathfrak{g}^\ast\omega',(X,\alpha))].
$$
One easily verifies that this is well-defined.
Next we introduce the exterior derivative.
\begin{definition}
The exterior derivative $d$ is defined by
\begin{eqnarray}
d([(\omega,(X,\alpha))]) =[(d\omega,(X,\alpha))]
\end{eqnarray}
\qed
\end{definition}
In view of Theorem \ref{OOmaine} this is well-defined and
\begin{eqnarray}
d_{(Z,c)} \left(\wh{g}^\ast  [(\omega',(X',\alpha'))]\right)= \wh{g}^\ast \left(d_{(Z',c')}  [(\omega',(X',\alpha'))]\right).
\end{eqnarray}
As we have seen in Section \ref{SECX9.2}, Proposition \ref{PROPX9.2.15}
a branched ep$^+$-subgroupoid $\Theta:X\rightarrow {\mathbb Q}^+$
 has a well-defined boundary $\partial\Theta:X\rightarrow {\mathbb Q}^+$.
 In general $\partial\Theta$ does not have pleasant properties unless
 $\Theta$ lies in a sufficiently nice position to the boundary, for example
 if $\Theta$ is tame. In the case that $\Theta$ is tame 
 we not only can define $\partial\Theta$, but it also makes sense to talk
 about its orientation.  Namely of given the tame, oriented branched 
 ep$^+$-groupoid $(\Theta,\wh{\mathsf{T}}_\Theta)$  the boundary $\partial\Theta$
 has an induced orientation $\wh{\mathsf{T}}_{\partial\Theta}$ and we define
 $$
 \partial(\Theta,\wh{\mathsf{T}}_\Theta):=(\partial\Theta,\wh{\mathsf{T}}_{\partial\Theta}).
 $$
In view of Theorem \ref{THMX11.3.9} this data behaves well with respect to generalized
isomorphisms and this will allow us ultimately to state a version of Stokes' Theorem.
Indeed, we can define for an oriented, tamed,
branched ep-groupoid $\wh{\Theta}$
$$
\partial([(\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha)])
=[(\partial\Theta,\wh{\mathsf{T}}_{\partial\Theta}),(X,\alpha)],
$$
and this definition is compatible with the notion of our equivalence relation,
which one easily derives
employing Theorem \ref{THMX11.3.9}.  With other words 
the following definition makes sense.
\begin{definition}
Let $(Z,c)$ be a polyfold and $\wh{\theta}\equiv [(\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha)]$
an oriented, tame, branched sub-orbifold, i.e. $\wh{\Theta}$ is an oriented, tame, branched
ep$^+$-subgroupoid. Then the {\bf boundary} \index{D- Boundary of a tame, oriented, branched orbifold} $\partial\wh{\theta}$ is defined
by $[\partial(\Theta,\wh{\mathsf{T}}_\Theta),(X,\alpha)]$,
where $\partial(\Theta,\wh{\mathsf{T}}_\Theta)$ is defined in Definition \ref{DEF936}.
\qed
\end{definition}

Finally we use the constructions and results in Section \ref{SECRTY114}
to formulate the Stokes Theorem.  Recall  Remark \ref{REM1142} and 
 assume that $Z$ is a polyfold,
$[(\Theta,\wh{\mathsf{T}}_{\Theta}),(X,\alpha)]$ is an oriented, tame, compact, branched sub$^+$-polyfold of dimension $n$, and $[\omega, (X,\alpha)]$
an sc-differential form of degree $n-1$. In order to simplify notation we put 
$$
\wh{\theta}=[(\Theta,\wh{\mathsf{T}}_{\Theta}),(X,\alpha)]\ \ \text{and}\ \ \tau=[\omega,(X,\alpha)].
$$
We can define $d\tau:=[d\omega,(X,\alpha)]$ and $\partial\wh{\theta}:=
[(\partial\Theta,\wh{\mathsf{T}}_{\partial\Theta}),(X,\alpha)]
$.
These are all objects associated to $Z$, but one needs the overhead to describe the structures.
We can define branched integration as follows.  Let $S\subset Z$ be the support of $\theta$ 
defined as the subset consisting of points $z\in Z$ with $|\Theta|\circ \alpha^{-1}(z)>0$. This definition 
is independent of the representative for $\wh{\theta}$. We denote similarly by $\partial S$ the support
of $\partial\theta$. Pushing forward the Lebesgue $\sigma$-algebras for $|\supp(\Theta)$ and
$|\supp(\partial\Theta)|$ we obtain the corresponding $\sigma$-algebras for $S$ and $\partial S$, respectively. The definition of the latter does not depend on the representative which was taken.  

Given a $n$-form $\tau$ on $Z$ and an oriented, tame, compact, branched sub-orbifold $\wh{\theta}$ of dimension $n$
we define
$$
\oint_{\wh{\theta}}\tau:= \oint_{\wh{\Theta}}\omega = \mu_{\omega}^{\wh{\Theta}}(|\supp(\Theta)|).
$$
The definition does not depend on the choice of the representatives to define it.  There is a similar
definition for a $(n-1)$-form $\tau'$ for the boundary case.
$$
\oint_{\partial\wh{\theta}} \tau' :=\oint_{\partial\wh{\Theta}} \omega' =\mu_{\omega'}^{\partial\wh{\Theta}}(|\supp(\partial\Theta|)).
$$
On the ep-groupoid level Stokes' theorem holds and consequently it holds
in the polyfold context as well.
\begin{theorem}[Stokes]\index{T- Polyfold Stokes}
Given a polyfold $(Z,c)$, a differential $(n-1)$-form $\tau=[\omega,(X,\alpha)]$
with $(X,\alpha)\in c$, and an oriented, tame, compact, branched sub-orbifold
$\wh{\theta}=[(\Theta,\wh{\mathsf{T}}_{\Theta}),(X,\alpha)]$ of dimension $n$
the Stokes type formula
$$
\oint_{\wh{\theta}} d\tau = \oint_{\partial\wh{\theta}}\tau
$$
holds.
\qed
\end{theorem}

\section{Sc\texorpdfstring{$^+$}{pl}-Multisections}\label{SECTX16.5}
In this section we shall employ previously established results concerning sc$^+$-multi\-sec\-tion functors, see Section \ref{SECT133}.
From Theorem \ref{pullbackX} and Theorem \ref{pushforwardX} we know that structurable sc$^+$-multisection functors 
are well-behaved under pullbacks and push-forwards.  The  previously established
fact that structurability behaves well under generalized
strong bundle isomorphisms follows immediately.  Consequently, we obtain a notion of sc$^+$-multisections for strong polyfold bundles.
 As we shall see, also  the pullback of a structurable sc$^+$-multisection  by a proper strong polyfold bundle covering  is structurable.


\begin{definition}\index{D- Sc$^+$-multisection}
Let $(p:Y\rightarrow Z,\bar{c})$ be a strong polyfold bundle.  An {\bf sc$^+$-mul\-tisec\-tion} 
$$
\lambda:Z\rightarrow {\mathbb Q}^+
$$
is  given by an equivalence class
$\lambda\equiv[(\lambda,\Gamma,W,\Lambda)]$, where $(W,\Gamma)$ is an admissible strong bundle structure
$$
\begin{CD}
|W| @>\Gamma>> Y\\
@V |P| VV     @ Vp VV\\
|X| @>\gamma >>  Z
\end{CD}
$$
and $\Lambda: W\rightarrow {\mathbb Q}^+$ a sc$^+$-multisection functor having the property
$$
\lambda \circ \Gamma| (|w|) = \Lambda(w)\ \ \text{for all}\ \ w\in W.
$$
Here $(\lambda,\Gamma,W,\Lambda)$ is {\bf equivalent} to $(\lambda',\Gamma',W',\Lambda')$ provided
$\lambda=\lambda'$, and there exists a generalize strong bundle isomorphism $\bar{\mathfrak{f}}:W\rightarrow W'$,
covering the generalized isomorphism $\mathfrak{f}:X\rightarrow X'$, fitting into the commutative diagram
$$
\begin{CD}
|W| @>|\bar{\mathfrak{f}}|  >> |W'|\\
@V |P| VV  @V |P'| VV\\
|X| @>|\mathfrak{f}| >> |X'|
\end{CD}
$$
and satisfying $\Lambda =\bar{\mathfrak{f}}^\ast\Lambda'$.
\qed
\end{definition}
In Definition \ref{DEFNX1322} we introduced the notion of the domain support for a sc$^+$-multi\-sec\-tion functor,
and we can introduce a related notion here.
\begin{definition}
For the sc$^+$-multisection  $\lambda:Y\rightarrow {\mathbb Q}^+$ the  {\bf domain support}\index{D- Domain support of $\lambda$} is defined by
$$
\text{dom-supp}(\lambda)=\cl_Z(\{z\in Z\ |\ \exists \ y\in p^{-1}(z),\ \text{with}\ \lambda(z)>0\}).
$$ 
\qed
\end{definition}
\begin{remark}
Incidentally, if we consider a representative $(\lambda,\Gamma,W,\Lambda)$, then $\Lambda$
induces a homeomorphism 
$\Gamma : \vert\text{dom-supp}(\Lambda)\vert\rightarrow\text{dom-supp}(\lambda)$.
\qed
\end{remark}

Given an auxiliary norm $n:Y\rightarrow [0,\infty]$ we can measure the point-wise  size of a sc$^+$-multisection
$\lambda:Y\rightarrow {\mathbb Q}^+$ by defining
\begin{eqnarray}
n(\lambda)(z) =\text{max}\{ n(y)\ |\ y\in p^{-1}(z),\ \lambda(y)\neq 0\}.
\end{eqnarray}
Then $n(\lambda):Z\rightarrow {\mathbb R}$ is a continuous map.

Since structurability is well-behaved under generalized strong bundle isomorphisms the following definition makes sense.
\begin{definition}\index{D- Structurable sc$^+$-multisection}
Let $(p:Y\rightarrow Z,\bar{c})$ be a strong polyfold bundle and $\lambda:Z\rightarrow {\mathbb Q}^+$ a 
sc$^+$-multisection.  We say that $\lambda$ is {\bf structurable} if one, and therefore all of its representatives $\Lambda:W\rightarrow {\mathbb Q}^+$ are structurable.  
\qed
\end{definition}

Assume that we are given a a strong polyfold bundle $p:Y\rightarrow X$ 
with a tame paracompact base $X$, an auxiliary norm
$n:Y_{0,1}\rightarrow {\mathbb R}^+$, and a functor 
$\lambda:Y|\partial Z\rightarrow {\mathbb Q}^+$.  
In a first step we define what is means that $\lambda$ is a sc$^+$-multisection.
\begin{definition}\index{D- Sc$^+$-multisection over $\partial Z$}
A sc$^+$-multisection of $\lambda$ of $Y|\partial Z$ is an equivalence class
$$
\lambda\equiv [(\lambda,\Gamma,W,\Lambda)],
$$
 where $P:W\rightarrow X$
is an sc-smooth local model for $p:Y\rightarrow Z$, and $\Lambda:W|\partial X\rightarrow
{\mathbb Q}^+$ an sc$^+$-multisection functor satisfying
$$
\lambda\circ \Gamma(\vert w\vert) =\Lambda(w)\ \ \text{for all}\ w\in W,\ P(w)\in \partial X.
$$
Two tuples $(\lambda,\Gamma,W,\Lambda)$ and $(\lambda',\Gamma',W',\Lambda')$ are said to be equivalent provided $\lambda=\lambda'$ and the there exists a generalized strong bundle isomorphism 
$$
\begin{CD}
W @>\overline{\mathfrak{f}} >> W'\\
@ V P VV @V P' VV\\
X @>\mathfrak{f} >>  X'
\end{CD}
$$
(the diagram interpreted with the usual care) such that 
 $$
 \Lambda =\overline{\mathfrak{f}}^\ast\Lambda'\ \ \text{and}\ \ \ \Gamma'\circ \vert\overline{\mathfrak{f}}\vert = \Gamma.
 $$
\qed
\end{definition}
Using Definition \ref{corr-xxxx} and Proposition \ref{prop14.1}
we can define structurable sc$^+$-multi\-sec\-tions over $\partial Z$.
\begin{definition}\index{D- Structurable sc$^+$-multisection over $\partial Z$}
Let $p:Y\rightarrow Z$ be a strong bundle over the tame paracompact polyfold $Z$.
Assume that $\lambda: Y|\partial Z\rightarrow {\mathbb Q}^+$ is an sc$^+$-multisection 
over the boundary $\partial Z$. We say that $\lambda$ is {\bf structurable} provided
one of its representative $(\lambda,\Gamma,W,\Lambda)$ has a structurable $\Lambda:W|\partial X\rightarrow {\mathbb Q}^+$.
\end{definition}



Using Theorem \ref{p-main-p} we can state an extension theorem for structurable sc$^+$-multi\-sect\-ions. 


\begin{theorem}
Let $(p:Y\rightarrow Z,\bar{c})$ be a strong polyfold bundle over the tame paracompact polyfold $Z$.
We assume that $Z$ admits sc-smooth partitions of unity. Denote by $n:Y\rightarrow [0,\infty]$ an auxiliary norm
and $\lambda :Y|\partial Z\rightarrow {\mathbb Q}^+$ a structurable sc$^+$-multisection. Assume that
$\wt{U} \subset Z$ is an open neighborhood of $\text{dom-supp}(\lambda)$ and $f:Z\rightarrow[0,\infty)$ a continuous map
with support in $\wt{U}$ satisfying $n(\lambda)(z)<f(z)$ for $z\in \text{dom-supp}(\lambda)$. 
Then there exists a structurable sc$^+$-multisection $\lambda':Y\rightarrow {\mathbb Q}^+$ with the following properties.
\begin{itemize}
\item[{\em(1)}]\ $n(\lambda')(z)\leq f(z)$ for all $z\in Z$.
\item[{\em(2)}]\ $\text{dom-supp}(\lambda')\subset \wt{U}$.
\item[{\em(3)}]\ $\lambda'|(Y|\partial Z)=\lambda$.
\end{itemize}
\qed
\end{theorem}
As a corollary of 
Theorem \ref{OTHM1344} and the study of proper coverings up to equivalences in Section \ref{SQWERTY116}
one is  able to define the pull-back of a sc$^+$-multisections by a proper covering.
We leave the details to the reader.  

In practice, when one uses the theory to define invariants via sc-Fredholm theory, 
 it is usually easier to work in  an ep-groupoid model.  One producea the invariants 
 in this context, and then  concludes from the transformation properties
 of generalized isomorphisms, that the invariants are independent of the choices.
 Particularly, invariants involving proper coverings, need the fine structure provided
 by the ep-groupoid description.




\section{Fredholm Theory}
In this section we develop the sc-Fredholm theory for sc-smooth sections of strong polyfold bundles.
Essentially this is an exercise about the sc-Fredholm theory in ep-groupoids and its behavior with respect to equivalences.

With   $p:Y\rightarrow Z$ being a strong polyfold bundle recall that an sc-smooth section 
is given by an equivalence class $[(f,\Gamma,W,F)]$, where $(W,\Gamma)$ is a strong bundle structure for
$p$, i.e. 
$$
\begin{CD}
|W|  @>\Gamma>>  Y\\
@V|P| VV   @V p VV\\
|X| @>\gamma>>   Z,
\end{CD}
$$
$F$ is an sc-smooth section of $P:W\rightarrow X$ and $f$ is a continuous section of $p$  such that 
$$
\Gamma \circ |F|  = f\circ \gamma.
$$
Here $\Gamma$ and $\gamma$ are homeomorphisms.  
  Assume that $(f,\Gamma,W,F)$ is a representative of the equivalence class and that $F$ is an sc-Fredholm section.
If $(f,\Gamma',W',F')$ is another representative we can conclude that $F'$ is an sc-Fredholm section 
of $P':W'\rightarrow X'$.  In order to see this note that $F$ and $F'$ are related by a strong bundle isomorphism
$$
\begin{CD}
W@> \mathfrak{F}>>  W'\\
@V P VV @V P'VV\\
X @>\mathfrak{f} >> X",
\end{CD}
$$
where one has to exercise the usual caution when interpreting this diagram.
We have already seen that sc-Fredholm sections transform well under push-forwards and 
pull-backs of strong bundle maps.  Since the action of $\mathfrak{F}$  on $F$ can be represented 
as a pull-back followed by a push-forward and since $F'=\mathfrak{F}_\ast F$ it follows that 
$F'$ is sc-Fredholm. See Theorem \ref{useful} and Theorem \ref{Push-Forw-prop} for the necessary background material. As a consequence of this discussion we can give the definition of an sc-Fredholm section 
of a strong polyfold bundle.


\begin{definition}\index{D- Polyfold Fredholm section}
A {\bf sc-smooth Fredholm section} of the strong polyfold bundle  $p:Y\rightarrow Z$ consists of an equivalence class
$[(f,\Gamma,W,F)]$, where $(W,\Gamma)$ is an admissible  strong bundle structure for $p$,  $F$ is a sc-smooth Fredholm section functor
of the strong bundle $P\colon W\rightarrow X$, and $f$ is a continuous section of $p$ satisfying  
$$f\circ \gamma= \Gamma\circ \abs{F}.
$$
\qed
\end{definition}

The following compactness definition is basic.
\begin{definition}\index{D- Compact polyfold Fredholm section}\index{Compact solution set}
Let $f\equiv [(f,\Gamma,W,F)]$ be an sc-Fredholm section of the strong polyfold bundle $p:Y\rightarrow Z$.
Then $f$ is said to have a {\bf compact solution} set provided the collection of all $z\in Z$ such that $f(z)=0$ is a compact subset of $Z$.
\end{definition}

Due to the fact that for an sc-Fredholm section in the ep-groupoid setting different compactness notions are equivalent we obtain the following 
stability result as a consequence of Theorem \ref{THMB1242}.
\begin{theorem}
Let $f\equiv [(f,\Gamma,W,F)]$ be an sc-Fredholm section of the strong polyfold bundle $p:Y\rightarrow Z$, where $Z$ is paracompact.
Suppose that $n:Y_{0,1}\rightarrow {\mathbb R}^+$ is an auxiliary norm and $f$ has a compact solution set.
Then there exists an open neighborhood $U$ of $S_f=\{z\in Z\ |\ f(z)=0\}$ such that the closure of the set of all
$z\in U$ with $n(f(z))\leq 1$ is compact.
\end{theorem}
\begin{proof}
We take a model $P:W\rightarrow X$, which by assumption will be a strong bundle over the ep-groupoid $X$.
By assumption $X$ has a paracompact orbit space $|X|$.  Moreover, we are given an sc-Fredholm section functor $F$ of $P$
which fits into the commutative diagram
$$
\begin{CD}
|W| @> \Gamma >> Y\\
@A |F| AA     @A f AA\\
|X| @>\gamma>> Z,
\end{CD}
$$
where $\Gamma$ and $\gamma$ define the strong polyfold bundle structure. The auxiliary norm $n$ is represented in 
the model by $N:W_{0,1}\rightarrow {\mathbb R}^+$.  Employing Theorem \ref{THMB1242} we conclude that not only
 $S_F=\{x\in X\ |\ F(x)=0\}$ has a compact orbit space $|S_F|$, but that also there exists a saturated open neighborhood
 $U'$ of $S_F$ so that the closure of the orbit space of $\{x\in U'\ |\ N(F(x))\leq 1\}$ is compact.  
 Then $U=|U'|$ has the desired properties.
\qed \end{proof}
We can consider oriented sc-Freholm sections of strong polyfold bundles, since orientations of sc-Fredholm section also behave well under generalized strong bundle isomorphisms.  
We begin by reviewing the orientation discussion in the ep-groupoid setting.
Assume that $P:W\rightarrow X$ is a strong bundle over the tame ep-groupoid $X$ and $F$ an sc-Fredholm functor.
As constructed in Section \ref{SEC115} there is a well-defined orientation bundle, see Definition \ref{DEFNG1252}, associated to $f$
and denoted by
$$
\sigma:\mathscr{O}_F\rightarrow X_\infty.
$$
Here $\mathscr{O}_F$ is a topological space, $\sigma$ is a local homeomorphism and 
the map $\sigma$ is a $2:1$ covering.  As discussed in Section \ref{SEC115},
given a  point $x\in X_\infty$, there exist precisely two local continuous
section germs denoted by $\pm\mathfrak{o}_{(x)}$. Of course, there is no preferred local choice.
 The value at $x$ is denoted by $\pm\mathfrak{o}_x$.
Given a smooth morphism $\phi\in \bm{X}$, i.e. $\phi\in \bm{X}_\infty$, we obtain a local
germ of sc-diffeomorphism 
$$
\wh{\phi}:U(s(\phi))\rightarrow U(t(\phi))
$$
 between small open neighborhoods in $X$
and this germ can be lifted to a local strong bundle isomorphism $\wh{\Phi}: W|U(s(\phi))\rightarrow W|U(t(\phi))$,
which can used to push $\mathfrak{o}_{(x)}$ forward.
In particular $\phi$ defines a push forward $\phi_\ast\mathfrak{o}_x$.
Recall that $F$ is orientable provided $\sigma:\mathscr{O}_F\rightarrow X_\infty$ admits a global continuous
section $\mathsf{o}$ with the property that
$$
\phi_\ast \mathsf{o}_{s(\phi)} = \mathsf{o}_{t(\phi)}\ \ \text{for all  morphisms in}\ \ \bm{X}_\infty.
$$
With other words $\mathsf{o}$ is a continuous section functor of $\sigma$.
The choice of a specific section functor  $\mathsf{o}$ is called an orientation for $F$ and denoted by $\mathsf{o}_F$.
If $|X_\infty|$ is connected, we see that there is at most one orientation, and if $F$  is orientable there are precisely two possible orientations.  

Relevant for our orientation discussion in the polyfold framework is Theorem \ref{THMS1257}
which we recall for convenience. We have adapted the notation to the current situation\par

\noindent{\bf Theorem \ref{THMS1257}\textcolor{red}{.}}
Assume $(P:W\rightarrow X,\mu)$  and $(P':W'\rightarrow X',\mu')$  are strong bundles over tame ep-groupoids and $
\bar{\mathfrak{f}}:W\rightarrow W'$ is  a generalized strong bundle isomorphism covering the generalized isomorphism
$\mathfrak{f}:X\rightarrow X'$.  We assume that $F$ is an sc-Fredholm section functor of $P$ and denote by $F'$ the push-forward sc-Fredholm section.
\begin{itemize}
\item[(1)]\  With $\sigma$ and $\sigma'$ being the orientation bundles, the generalized 
strong bundle isomorphism induces a fiber-preserving homeomorphism $|\bar{\mathfrak{f}}|_\ast$ fitting into the following commutative diagram
$$
\begin{CD}
|{\mathscr{O}}_F| @> {|\bar{\mathfrak{f}}|}_\ast>> |{\mathscr{O}}_{F'}|\\
@V |\sigma| VV  @V |\sigma'| VV\\
|X_{\infty}| @>|\mathfrak{f}|>> |X'_{\infty}|.
\end{CD}
$$
The construction of $|\bar{\mathfrak{f}}|_\ast$ is functorial.  
\item[(2)]\ Assume that 
 $\mathsf{o}$ is a continuous section functor of $\sigma$, so that in particular the isotropy groups $G_x$, $x\in X_\infty$, act trivially on $\sigma^{-1}(x)$.
Then $\bar{\mathfrak{f}}$ defines naturally a push-forward $\mathsf{o}'=\bar{\mathfrak{f}}_\ast\mathsf{o}$,
which is a continuous section functor of $\mathscr{O}_{F'}\rightarrow X_\infty'$. 
\end{itemize}
\qed\par
Now we are ready for the discussion of orientations for sc-Fredholm sections of strong bundles over tame polyfolds.
From Proposition \ref{PROPT1256} we can conclude the following. Let $P:W\rightarrow X$ be a strong bundle over a tame ep-groupoid with a paracompact orbit space and $F$ is a sc-Fredholm section. We denote by $\sigma:\mathscr{O}_F\rightarrow X_\infty$ the orientation bundle. 
Then $F$ is orientable provided the following two conditions hold.
\begin{itemize}
\item[(1)]\ The continuous map $\vert\sigma\vert:\vert\mathscr{O}_F\vert\rightarrow \vert X_\infty\vert$ has above every class $\vert x\vert$ precisely two preimages.
\item[(2)]\ $\vert\sigma\vert:\vert\mathscr{O}_F\vert\rightarrow \vert X_\infty\vert$ admits a global continuous section.
\end{itemize}
A choice of section of $\vert\sigma\vert$ then by definition is an orientation of $F$. An orientation for $ [(f,\Gamma,W,F)]$ can be defined as a choice of orientation for a representative $(W,F)$. If we take another representative 
$(W',F')$ we obtain via Theorem \ref{THMS1257} an induced orientation. Hence we see that there is a well-defined notion of orientation.
\begin{definition}\index{D- Orientation for $f$}
An {\bf orientation} (if it exists) for a sc-Fredholm section $f$ of the tame strong polyfold bundle $p:Y\rightarrow Z$ consists
of the choice of an orientation for a representative $(W,F)$.
\qed
\end{definition}
As a simple application we note the following result where we use generic perturbations of $f$ by sc$^+$-multi\-sections $\lambda$.
For such a $\lambda$ the maps $\theta =\lambda\circ f:Z\rightarrow {\mathbb Q}^+$ defines branched suborbifold
of $Z$ and if $f$ is oriented $\theta$ has  a natural orientation. This follows from the discussion in Section \ref{SEC153}.
See in particular Theorem \ref{THM1541} and the subsequent Definition \ref{DEF1542}.
\begin{theorem}
Let $p:Y\rightarrow Z$ be a strong polyfold bundle over the paracompact polyfold $Z$  with $\partial Z=\emptyset$.
Assume that $f$
is an oriented sc-Fredholm section of $p$ with compact solution set. Suppose the Fredholm index is $k$.
Let $n:Z_{0,1}\rightarrow {\mathbb R}^+$ be an auxiliary norm and $U$ an open neighborhood of $S_f=\{z\in Z\ |\ f(z)=0\}$
so that $(n,U)$ control compactness. Then, for given sc$^+$-multisection $\lambda$ controlled by $(n,U)$,
so that $f,\lambda)$ is in general position, the integral $\oint_{\wh{\theta}} \tau$ 
for  given  closed sc-differential $k$-form $\tau$ on $Z$ is well-defined and independent of the perturbation $\lambda$.
Moreover, the integral only depends on the cohomology class $[\tau]$. Here $\wh{\theta}$ is $\theta=\lambda\circ f$ equipped
with the inherited orientation from $f$.
\qed
\end{theorem}



We leave it to the reader to bring more of the results from Part III into the current context. We just note that 
that as along as the definitions and results are invariant under generalized strong bundle isomorphisms 
a result in the polyfold context can be obtained.  In application it is usually advantageous to work in 
the ep-groupoid context, however, sometimes the polyfold formulation allows for more compact statements, in particular
if the overhead is suppressed in the statements.








\begin{partbacktext}
\part{Fredholm Theory in Groupoidal Categories}
\noindent  In this part we shall bring the ep-groupoid theory into the more general framework
of groupoidal categories. First we shall develop the theory of sc-smooth structures on a certain class of groupoidal categories,
This is followed by a theory of sc-Fredholm section functors. Finally we develop in Chapter \ref{CHAPTER19X}  useful ideas to construct polyfold structures in applications. For example the papers \cite{FH2,FH3} are build on this framework.  In \cite{H2} an application of the ideas to Gromov-Witten theory
is outlined.
\end{partbacktext}




\chapter{Polyfold Theory for  Categories}\label{CHAPX17}
In this part we shall develop a theory of Fredholm functors for certain categories.
The hard work has already been done in the previous parts.  The resulting theory
is very convenient in applications since it provides a transparent language 
with a large body of results. The construction of symplectic field theory is an excellent example for the use of this `categorical  polyfold theory'. 
We refer the reader to \cite{FH2}  for the illustration of the methods
in this highly nontrivial example.

The  motivated reader is also invited to turn the Gromov-Witten (GW) example into the categorical framework.
The reference \cite{H2} gives an outline of such a theory. The paper \cite{HWZ5} gives a complete and detailed construction of GW, however,  the motivation of this paper was to 
discuss the issues and to show  how they can be phrased and dealt with in the polyfold framework.  The aim was not to give an abstract stream-lined
proof in which important issues might not be as visible, since they are taken care of by the `machinery'.   Of course, once one has enough experience and knows the inner workings 
of the machinery, it perfectly makes sense to use the technology in a slick and stream-lined way, which is the approach to SFT in \cite{FH2}.
Using ideas from  \cite{FH2}, for example the  construction functors for polyfolds, and some of the technical work in \cite{HWZ5},   the 
theory  in the current  book allows a rather fast and complete construction of the Gromov-Witten invariants.

In the following we assume the reader familiar with the material of Part I to Part III and we allow ourselves at time 
to be sketchy if the constructions and arguments are straight forward.

\section{Polyfold Structures and Categories}


The starting point is a category $\mathscr{C}$ with additional  structures. Usually we shall denote the object class
associated to $\mathscr{C}$ by $\text{obj}(\mathscr{C})$ and the morphism class by $\text{mor}({\mathscr{C}})$.
However, we sometimes find it convenient to abbreviate $C=\text{obj}(\mathscr{C})$ and $\bm{C}=\text{mor}({\mathscr{C}})$
if the context is clear.  We shall  consider categories where every morphism is an isomorphism.
In this case we can consider for every object $\alpha$ the class $|\alpha|$  of objects isomorphic to $\alpha$.
The {\bf orbit space}\index{Orbit space} $|\mathscr{C}|$ of $\mathscr{C}$ is the class consisting of all isomorphism classes of objects. 

\begin{definition}\label{DEF_GCT}\index{D- GCT}
A {\bf GCT}, where GC stands for groupoidal category and T for topology, is given by a pair
$(\mathscr{C},{\mathcal T})$, where $\mathscr{C}$ is a category having the following three properties.
\begin{itemize}
\item[(1)]\  The orbit space ${\abs{\mathscr{C}}}$ of the category $\mathscr{C}$ is a set.
\item[(2)]\ The set of morphisms between any two objects is finite.
\item[(3)]\  All morphisms are isomorphisms.
\end{itemize}
In addition  ${\mathcal T}$ is a topology on the orbit set $|{\mathscr{C}}|$ which is metrizable.
Instead of saying $(\mathscr{C},{\mathcal T})$ is  a GCT we sometimes say it is groupoidal category with (metrizable) topology, where it is understood
that the topology is defined on the orbit space.
 We also sometimes refer to the GCT $\mathscr{C}$ and suppress the topology in the notation.
 \qed
\end{definition}

Our main goal is to define the notion of an sc-smooth structure on $(\mathscr{C},{\mathcal T})$. It will turn out that 
this is the starting point for a very rich theory, which is a mixture of a generalized differential geometry,
blended with nonlinear functional analysis and category theory. 

\begin{definition}\index{D- Translation groupoid}
 Given a M-polyfold $O$,  a finite group $G$, and a group homomorphism 
 $\gamma:G\rightarrow \text{Diff}_{sc}(O)$, denote the associated group action by sc-diffeomorphisms by
$$
G\times O\rightarrow O: (g,x)\rightarrow g\ast x,\ \ \text{where}\ g\ast x=\gamma(g)(x).
$$
The  {\bf translation groupoid}\index{Translation groupoid} $G\ltimes O$ associated to $(O,G,\gamma)$ is the category
with $\text{obj}(G\ltimes O)=O$ and $\text{mor}(G\ltimes O)=G\times O$. The source and target maps are defined by
$$
s(g,x)=x\ \text{and}\ \ t(g,x) =g\ast x,
$$
so that $(g,x)$ is viewed as a morphism $(g,x):x\rightarrow g\ast x$.
\qed
\end{definition}
One easily verifies that $G\ltimes O$ is an ep-groupoid. For the following we note that ${_G}\backslash O=|G\ltimes O|$ is a metrizable space. Namely take any metric $d'$ on $O$ and average to obtain the metric $d$ defined by
$$
d(q,q') =\frac{1}{|G|}\cdot  \sum_{g\in G} d'(g\ast q,g\ast q').
$$
Then define $\bar{d}$ on the quotient by 
$$
\bar{d}([q],[q']):= \text{min}_{g,g'\in G} d(g\ast q,g'\ast q').
$$
The building blocks for our upcoming theory are given in the following definition.
\begin{definition}\index{D- Local uniformizer}\index{D- Tame local unifomizer}
Let $\mathscr{C}$ be a GCT and $\alpha$ an object in ${\mathscr{C}}$. A {\bf local uniformizer}\index{Local uniformizer} for $\mathscr{C}$ at $\alpha$ is a covariant functor $\Psi:G\ltimes O\rightarrow \mathscr{C}$ such that the following holds.
\begin{itemize}
\item[(1)] \  $G\ltimes O$ is a translation groupoid associated to the M-polyfold $O$ equipped with an sc-smooth action by a finite group $G$, i.e. the data $(O,G,\gamma)$. 
\item[(2) ]\   $O$ is  paracompact (and hence metrizable).
\item[(3)] \  The functor $\Psi$ is injective on objects and there exists $q_0\in O$ with $\Psi(q_0)=\alpha$.
Moreover $\Psi$ is  full and faithful, i.e. fully faithful.
\item[(4)] \  The induced map $|\Psi|:{_{G\backslash}O}\rightarrow |\mathscr{C}|$ is a homeomorphism onto an open neighborhood $U$ of $|\alpha|$ in $|\mathscr{C}|$.
\end{itemize}
Associated to a local uniformizer $\Psi$ we have its {\bf footprint}\index{Footprint} defined by
$$
\text{footprint}(\Psi)=|\Psi(O)|,
$$
which is an open subset of $|\mathscr{C}|$.   If $O$ is tame we shall refer to $\Psi$ as a {\bf tame local uniormizer}.
\qed
\end{definition}
Denote local uniformizers  at objects $\alpha$ and $\alpha'$ by $\Psi$ and $\Psi'$. 
\begin{definition}\index{D- Transition set}
The {\bf transition  set}  ${\bm{M}}(\Psi,\Psi')$  is defined as the weak fibered product associated to the diagram 
$$
O\xrightarrow{\Psi} \mathscr{C}\xleftarrow{\Psi'} O'.
$$
It consists of all tuples $(q,\phi,q')\in O\times \bm{C} \times O'$ so that $\phi:\Psi(q)\rightarrow \Psi'(q')$.
\qed
\end{definition}
We first note that given three objects we have the following {\bf structure maps}\index{Structure maps} for associated local uniformizers
$\Psi,\Psi'$ and $\Psi''$.
\begin{itemize}
\item[(1)] \ \ \ The {\bf source and target maps}\index{Source map}\index{Target map} $s:{\bm{M}}(\Psi,\Psi')\rightarrow O:(q,\phi,q')\rightarrow q$ and $t:{\bm{M}}(\Psi,\Psi')\rightarrow O':(q,\phi,q')\rightarrow q'$.
\item[(2)]\ \ \  The $1$-map or {\bf unit map} \index{Unit map} $O\rightarrow {\bm{M}}(\Psi,\Psi):q\rightarrow (q,1_{\Psi(q)},q)$
\item[(3)] \ \ \ The {\bf inversion map}\index{Inversion map} ${\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi',\Psi):(q,\phi,q')\rightarrow (q',\phi^{-1},q)$.
\item[(4)] \ \ \ The {\bf multiplication map}\index{Multiplication map} ${\bm{M}}(\Psi',\Psi''){_{s}\times_t}{\bm{M}}(\Psi,\Psi')\rightarrow{\bm{M}}(\Psi,\Psi'')$ defined by
$$
m((q',\phi',q''),(q,\phi,q'))= (q,\phi'\circ\phi,q'').
$$
\end{itemize}

Denote the category of sets by $\text{SET}$. We shall write $\mathscr{C}^-$ for the category obtained from $\mathscr{C}$ by keeping all objects,
but only allowing the identities as morphisms.
\begin{definition}\index{D- Uniformizer construction}
A {\bf uniformizer construction} is given by  a functor  $F:\mathscr{C}^-\rightarrow \text{SET}$  
which associates
to an object $\alpha$ a set of local uniformizers $F(\alpha)$ at $\alpha$.
\qed
\end{definition}
\begin{remark}\label{REM1716} \index{R- On uniformizer constructions}
Here are some remarks about functors $F$ and the way they occur in applications.\par

\noindent  a) A unformizer construction appears in application usually as a well-defined recipe for a construction involving
for a given object $\alpha$ set-many choices resulting in the set $F(\alpha)$. \par

\noindent b) In many circumstances we have more structure, namely
$F$ is in fact a functor $F:\mathscr{C}\rightarrow \text{SET}$ reflecting the often occurring feature 
that given an isomorphism $\phi:\alpha\rightarrow \alpha'$ one can 
 establish a  bijective correspondence between the choices available for $\alpha$ and $\alpha'$, 
resulting in a bijection $F(\phi):F(\alpha)\rightarrow F(\alpha')$. \par

\noindent c)   In many cases,  $F(\phi)$ even has a geometric interpretation and the following describes the additional structures which one might see.
A frequent situation is as follows.  Given $\Psi\in F(\alpha)$ and $\phi:\alpha\rightarrow \alpha'$ define $\Psi'=F(\phi)(\Psi)$.  By construction $\Psi:G\ltimes O\rightarrow \mathscr{C}$ and $\Psi':G'\ltimes O'\rightarrow \mathscr{C}$.  Assume  there exists a well-defined group isomorphism $\gamma_{(\phi,\Psi)}:G\rightarrow G'$ and an equivariant
sc-diffeomorphism $\sigma_{(\phi,\Psi)}:O\rightarrow O'$ defining an sc-diffeomorphic functor
$$
\bar{\sigma}_{(\phi,\Psi)}:=\gamma_{(\phi,\Psi)}\ltimes \sigma_{(\phi,\Psi)}:G\ltimes O\rightarrow G'\ltimes O'.
$$
Having  the functors $\Psi$ and $\Psi'\circ \bar{\sigma}_{(\phi,\Psi)}$ defined on $G\ltimes O$ we assume that 
there is a natural construction of a natural transformation 
$$
\tau_{(\phi,\Psi)}: \Psi\rightarrow \Psi'\circ \bar{\sigma}_{(\phi,\Psi)}.
$$
In particular, for $q\in O$ the object $\Psi(q)$ and the object $\Psi'(\sigma_{(\phi,\Psi)}(q))$ are isomorphic via
$\tau_{(\phi,\Psi)}(q)$. For $g\in G$ the morphism $(g,q)$ which induces $\Psi(g,q):\Psi(q)\rightarrow \Psi(g\ast q)$
corresponds to $\Psi'(\bar{\sigma}_{(\phi,\Psi)}(g,q)):\Psi'(\sigma_{(\phi,\Psi)}(q))\rightarrow \Psi'(\sigma_{(\phi,\Psi)}(g\ast q))$.
The latter comes from the commutative diagram
$$
\begin{CD}
\Psi(q) @> \Psi(g,q)>> \Psi(g\ast q)\\
@V \tau_{(\phi,\Psi)}(q)VV @V \tau_{(\phi,\Psi)}(g\ast q)VV\\
\Psi'({\sigma}_{(\phi,\Psi)}(q) )@>\Psi'(\bar{\sigma}_{(\phi,\Psi)}(g,q))>>\Psi'(\sigma_{(\phi,\Psi)}(g\ast q))
\end{CD}
$$
In many cases the constructions  $(\phi,\Psi)\rightarrow \sigma_{(\phi,\Psi)}$, $(\phi,\Psi)\rightarrow \gamma_{(\phi,\Psi)}$,
and $(\phi,\Psi)\rightarrow \tau_{(\phi,\Psi)}$ satisfy the following compatibilities
\begin{itemize}
\item[(1)] \  $\sigma_{(\phi',F(\phi)(\Psi))}\circ\sigma_{(\phi,\Psi)}=\sigma_{(\phi'\circ\phi,\Psi)}$.
\item[(2)] \  $\gamma_{(\phi',F(\phi)(\Psi))}\circ \gamma_{(\phi,\Psi)}=\gamma_{(\phi'\circ \phi,\Psi)}$.
\item[(3)] \   $\tau_{(\phi',F(\phi)(\Psi))}(\sigma_{(\psi,\Psi)}(q))\circ\tau_{(\phi,\Psi)}(q)=\tau_{(\phi'\circ \phi,\Psi)}(q)$ for $q\in O$.
\end{itemize}
\qed
\end{remark}



\begin{definition}\index{D- Polyfold structure for $(\mathscr{C},{\mathcal T})$}
A {\bf polyfold structure}   for the GCT  $\mathscr{C}$ consists of two constructions:
\begin{itemize}
\item[(1)]\ \ \ A uniformizer construction  $F:\mathscr{C}^-\rightarrow \text{SET}$.
\item[(2)]\ \ \  A construction of  a M-polyfold structure for every transition set $\bm{M}(\Psi,\Psi')$, where $\Psi\in F(\alpha)$ and $\Psi'\in F(\alpha')$.
\end{itemize}
These two constructions satisfy the following compatibility conditions:
\begin{itemize}
\item[(a)] \ \ \ The source and target maps 
$$
O\xleftarrow{s} \bm{M}(\Psi,\Psi')\xrightarrow{t} O'
$$
 are local sc-diffeomorphisms.
\item[(b)] \ \ \ The unit map $u: O\rightarrow \bm{M}(\Psi,\Psi)$ and the inversion map $\iota:\bm{M}(\Psi,\Psi')\rightarrow \bm{M}(\Psi',\Psi)$ are sc-smooth.
\item[(c)] \ \ \ The multiplication map ${\bm{M}}(\Psi',\Psi''){_{s}\times_t}{\bm{M}}(\Psi,\Psi')\rightarrow{\bm{M}}(\Psi,\Psi'')$ is sc-smooth.
\end{itemize}
 We shall refer to $(F,{\bm{M}})$ as a {\bf polyfold structure}\index{Polyfold structure}. If all local uniformizers associated to $F$ are tame, we shall  call it a {\bf tame polyfold construction}\index{Tame polyfold construction}.  A {\bf polyfold}\index{D- Polyfold} $\mathscr{C}$ consists of a GCT $\mathscr{C}$
 together with a polyfold structure $(F,\bm{M})$ 
\qed
\end{definition}
We can draw the following consequences from this definition. 
\begin{lemma}\label{LEMMX17.1.8}
Given $\Psi:G\ltimes O\rightarrow {\mathcal S}$ in $F(\alpha)$ with $\Psi(q)=\alpha$
the map 
\begin{eqnarray}\label{EQNX17.1}
\hat{\Psi}: G\ltimes O\rightarrow \bm{M}(\Psi,\Psi):(g,p)\rightarrow (p,\Psi(g,p),g\ast p)
\end{eqnarray}
 is 
a sc-diffeomorphism. Moreover, for given $(q,g,q)\in \bm{M}(\Psi,\Psi)$, $g\in G=G_\alpha$,
there exists an open neighborhood $U(q,g,q)$ characterized by the property that
$$
s:U(q,g,q)\rightarrow O
$$
is an sc-diffeomorphism. Further it holds that $U(q,g,q)\cap U(q,g',q)=\emptyset $ for $g\neq g'$
and 
$$
\bm{M}(\Psi,\Psi)=\bigcup_{g\in G} U(q,g,q).
$$
In addition it holds that $t:U(q,g,q)\rightarrow O$ is given by $t(p,\phi,p')= g\ast p$.
\end{lemma}
\begin{proof}
By assumption $\Psi: G\ltimes O\rightarrow {\mathcal S}$ is injective on objects and fully faithful.
If $g\in G$ and $p\in O$ then $\Psi(g,p):\Psi(p)\rightarrow \Psi(g\ast p)$ which implies
that $(p,\Psi(g,p),g\ast p)\in \bm{M}(\Psi,\Psi)$. Moreover the map  in (\ref{EQNX17.1})
is injective since $\Psi$ is injective on objects and $\Psi$ is faithful. 
Given $p, p'\in O$ and $(p,\phi,p')\in \bm{M}(\Psi,\Psi)$ the fact that $\Psi$
is full implies that there exists $(g,p)$ with $\Psi(g,p) = \phi$ which also implies that $g\ast p=p'$.
This shows that the map in (\ref{EQNX17.1}) is a bijection. 
From $s\circ \hat{\Psi}(g,p)= p$ we conclude that $\hat{\Psi}$ is a local sc-diffeomorphism, since $s$ has this property.
Of course, with $\hat{\Psi}$ being a bijection we conclude that it is a sc-diffeomorphism.
Since $\{g\}\times O$ is open in $G\times O$ we see that the map 
$$
O\rightarrow \bm{M}(\Psi,\Psi):p\rightarrow (p,\Psi(g,p),g\ast p)
$$
is an sc-diffeomorphism onto some open subset. which we shall denote by $U(q,g,q)$.
We note that $(q,g,q)\in U(q,g,q)$.  It is clear that by construction $U(q,g,q)$ and $U(q,g',q)$ are disjoint if $g\neq g'$ and further that
$$
\bm{M}(\Psi,\Psi)=\bigcup_{g\in G} U(q,g,q).
$$
Clearly $s:U(q,g,q)\rightarrow O$ has the form $s(p,\phi,p')=p$. From
$$
\hat{\Psi}(g,p)=(p,\Psi(g,p),g\ast p)
$$
 it follows that $t\circ \hat{\Psi}(g,p)= g\ast p$ implying that if 
$(p,\phi,p')\in U(q,g,q)$ we must have $p'=g\ast p$ and consequently $t(p,\phi,p')=g\ast p$.
\qed \end{proof}



Assume we are given a polyfold structure $(F,{\bm{M}})$ for $\mathscr{C}$. 
We can connect this structure to the theory of ep-groupoids as follows.
Using that $|\mathscr{C}|$ is a set and ${\mathcal T}$ a metrizable topology we can pick a set  of uniformizers $\bm{\Psi}:={(\Psi_\lambda)}_{\lambda\in\Lambda}$ covering the orbit set of $\mathscr{C}$, i.e. 
$$
|\mathscr{C}| =\bigcup_{\lambda\in\Lambda} \text{footprint}(\Psi_\lambda).
$$
Recall that the footprints are open subsets.
We shall refer to $\bm{\Psi}$ as a {\bf covering set of uniformizers}\index{Covering set of uniformizers}, or just simply 
as a {\bf covering set}.
By definition $\Psi_\lambda : G_\lambda\ltimes O_\lambda\rightarrow \mathscr{C}$, and 
we associate to this family the M-polyfolds
$$
X=\bigsqcup_{\lambda\in\Lambda} O_\lambda\ \ \text{and}\ \ {\bm{X}}=\bigsqcup_{(\lambda,\lambda')\in \Lambda\times\Lambda} {\bm{M}}(\Psi_\lambda,\Psi_{\lambda'}).
$$
We  define source and target maps $s,t:{\bm{X}}\rightarrow X$ by associating 
to $(q_\lambda,\phi,q_{\lambda'})$ the objects
$$
s(q_\lambda,\phi,q_{\lambda'})=q_\lambda\ \ \text{and}\ \ t(q_\lambda,\phi,q_{\lambda'})=q_{\lambda'}.
$$
These maps are local sc-diffeomorphisms, since $(F,{\bm{M}})$ defines a polyfold structure.
It follows immediately that the global inversion map
$\iota:{\bm{X}}\rightarrow {\bm{X}}:(q_\lambda,\phi,q_{\lambda'})\rightarrow (q_{\lambda'},\phi^{-1},q_{\lambda})$ 
is an sc-diffeomorphism and the unit map $u:X\rightarrow {\bm{X}}$ is sc-smooth. Since $s$ and $t$ are
local sc-diffeomorphisms,  ${\bm{X}}{_{s}\times_t}{\bm{X}}$ has a natural M-polyfold structure 
and it follows that the multiplication map is sc-smooth. In summary the family $\bm{\Psi}$
defines a small category $X=X_{\bm{\Psi}}$ where the object and morphism set carry M-polyfold structures
for which the standard structure maps are sc-smooth and $s$ and $t$ are local sc-diffeomorphisms.
However, more is true.

\begin{theorem}\index{T- Category associated to $\bm{\Psi}$}
Let $(F,\bm{M})$ be a polyfold construction for the GCT $\mathscr{C}$. Then the  small category $X_{\bm{\Psi}}$ associated to the covering set of uniformizers $\bm{\Psi}$
has the structure of an ep-groupoid. If $(F,\bm{M})$ is tame then $X_{\bm{\Psi}}$ is a tame ep-groupoid.
\end{theorem}
\begin{proof}
It suffices to verify the properness property.
We find an open neighborhood $V=V(q_\lambda)\subset O_\lambda$ so that
$V$ admits the natural action of the stabilizer group $G_{q_\lambda}$ of $g_\lambda$
and $|\Psi_\lambda| : {_{G_{q_\lambda}}\backslash} V\rightarrow |\Psi_\lambda(V)|$  is a homeomorphism.
Since $|\mathscr{C}|$ is metrizable it is in particular normal and we find an open neighborhood $W$ of $|\Psi_\lambda(q_\lambda)|$ with $\cl_{|\mathscr{C}|}(W)\subset |\Psi_\lambda(V)|$. Define $U\subset O_\lambda$ to consist
of all $p_\lambda$ satisfying
$$
|\Psi_\lambda(p_\lambda)|\in W.
$$
Then $U$ is an open neighborhood of $q_\lambda$ in $O_\lambda$ and we shall show that
it has the desired properties.  Assume that $(q_k,\phi_k,p_k)$ is a sequence of elements in ${\bm{X}}$
such that $q_k\in \cl_X(U)$ and $(p_k)$ belongs to a compact subset $K$ in $X$.
After perhaps taking a subsequence we may assume that $p_k\in O_{\lambda'}$ and $p_k\rightarrow p_0$.
Since $|\Psi_{\lambda}(q_k)|=|\Psi_{\lambda'}(p_k)|\rightarrow |\Psi_{\lambda'}(p_0)|$ it follows
that $|\Psi_{\lambda'}(p_0)|\in \cl_{|\mathscr{C}|}(W)\subset V$. Using that
$$
|\Psi_\lambda| : {_{G_{q_\lambda}}\backslash} V\rightarrow |\Psi_\lambda(V)|
$$
is a homeomorphism we conclude that a subsequence of $(q_k)$ is convergent.
\qed \end{proof} 
 In view of the theorem we can associate to a covering set of uniformizers $\bm{\Psi}:={(\Psi_\lambda)}_{\lambda\in\Lambda}$
 an ep-groupoid $X_{\bm{\Psi}}$. In addition, we can define a functor
 $$
 \Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C}
 $$
 by associating to $q_\lambda\in O_\lambda$ the object $\Psi_\lambda(q_\lambda)$ and to a morphism
 $(q_\lambda,\phi,q_{\lambda'})$ the morphism $\phi$.
 
 
 
 \begin{lemma}
 The functor $\Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C}$ is an equivalence of categories
 and $|\Gamma_{\bm{\Psi}}|:|X_{\bm{\Psi}}|\rightarrow |\mathscr{C}|$ is a homeomorphism.
 \end{lemma}
 \begin{proof}
 Since the footprints cover $|\mathscr{C}|$ it follows that $\Gamma_{\bm{\Psi}}$ is {\bf essentially surjective}\index{Essentially surjective}, i.e.
 for every object $\alpha$ in $\mathscr{C}$ there exists $x\in X_{\bm{\Psi}}$ and $\phi\in \bm{C}$ satisfying
 $$
 \Gamma_{\bm{\Psi}}(x)\xrightarrow{\phi} \alpha.
 $$
 Given two objects $q_\lambda, q_{\lambda'}$ the map
 $$
 \Gamma_{\bm{\Psi}}:{\bm{X}}(q_\lambda,q_{\lambda'})\rightarrow {\bf C}(\Psi_\lambda(q_\lambda),\Psi_{\lambda'}(q_{\lambda'}))
 $$
 is trivially a bijection.  This shows that  $\Gamma_{\bm{\Psi}}$ is an equivalence of categories.
 From this it follows immediately that $| \Gamma_{\bm{\Psi}}|$ is a bijection.
 Since the $\Psi_\lambda$ are uniformizers we infer that $|\Gamma_{\bm{\Psi}}|$  is a homeomorphism.
\qed \end{proof}

Given a polyfold structure $(F,\bm{M})$ for the GCT $\mathscr{C}$ the above discussion shows that we can construct
an sc-smooth small category  $X_{\bm{\Psi}}$ with some additional features, i.e. an ep-groupoid, and an equivalence of categories 
to $\mathscr{C}$. The construction of $X_{\bm{\Psi}}$ involved choices. However, as we shall see next, the results 
of two different choices are (sc-smoothly) Morita-equivalent in a canonical way, i.e. there exists a canonical generalized isomorphism
 $$
 \mathfrak{f}:X_{\bm{\Psi}}\rightarrow X_{\bm{\Psi}'}
 $$
 compatible, in some sense, with the equivalences $\Gamma_{\bm{\Psi}}$ and $\Gamma_{\bm{\Psi}'}$.
In order to see this assume that $\bm{\Psi}$ and $\bm{\Psi}'$ are two covering sets of uniformizers associated
to $(F,{\bm{M}})$. Then the union $\bm{\Psi}''$
also has footprints covering the orbit space. We obtain natural inclusion functors
$$
X_{\bm{\Psi}}\xrightarrow{A} X_{\bm{\Psi}''}\ \ \text{and}\ \ X_{\bm{\Psi}'}\xrightarrow{A'}X_{\bm{\Psi}''}.
$$
One readily verifies that $A$ and $A'$ are sc-smooth equivalences between ep-groupoids. We also note that
$$
\Gamma_{\bm{\Psi}}= \Gamma_{\bm{\Psi}''}\circ A\ \ \text{and}\ \ 
\Gamma_{\bm{\Psi}'}= \Gamma_{\bm{\Psi}''}\circ A'.
$$
We take  the weak fibered product $X_{\bm{\Psi}}\times_{X_{\bm{\Psi}''}}X_{\bm{\Psi}'}$ associated to the diagram 
$$
X_{\bm{\Psi}}\xrightarrow{A} X_{\bm{\Psi}''}\xleftarrow{A'} X_{\bm{\Psi}'}.
$$
This is an ep-groupoid 
and the projections onto the factors give equivalences of ep-groupoids resulting in the diagram
\begin{eqnarray}\label{polq1}
d\colon X_{\bm{\Psi}}\xleftarrow{\pi_1}   X_{\bm{\Psi}}\times_{X_{\bm{\Psi}''}}X_{\bm{\Psi}'}\xrightarrow{\pi_2}                      X_{\bm{\Psi}'}.
\end{eqnarray}
This diagram $d$ defines a generalized isomorphism $[d]:X_{\bm{\Psi}}\rightarrow X_{\bm{\Psi}'}$.
One also verifies easily that $|\Gamma_{\bm{\Psi}'}|\circ |[d]| =|\Gamma_{\bm{\Psi}}|$ and we can summarize the discussion as follows,
where we appeal to the definition of a polyfold structure on a topological  space as given in Definition \ref{SECDEF121}.
\begin{theorem}\label{THMX17110}\index{T- Morita equivalence}
The construction associating to a covering set of uniformizers $\bm{\Psi}$ 
the ep-groupoid $X_{\bm{\Psi}}$ produces for different families $\bm{\Psi}$ and $\bm{\Psi}'$ 
ep-groupoids and a natural generalized isomorphism 
$$
\mathfrak{f}\colon X_{\bm{\Psi}}\rightarrow X_{\bm{\Psi}'},
$$
which is the identity if $\bm{\Psi}=\bm{\Psi}'$.
If $\mathfrak{f}$ is associated to $(\bm{\Psi},\bm{\Psi}')$ and $\mathfrak{f}'$ to $(\bm{\Psi}',\bm{\Psi}'')$, then 
$\mathfrak{f}'\circ\mathfrak{f}$ is associated to $(\bm{\Psi},\bm{\Psi}'')$.
The generalized isomorphism $\mathfrak{f}:X_{\bm{\Psi}}\rightarrow X_{\bm{\Psi}'}$ associated to (\ref{polq1})
satisfies $|\Gamma_{\bm{\Psi}'}|\circ |\mathfrak{f}| =|\Gamma_{\bm{\Psi}}|$.
Consequently the pairs $(X_{\bm{\Psi}},|\Gamma_{\bm{\Psi}}|)$ define
equivalent polyfold structures on the metrizable space $|\mathscr{C}|$ and consequently $|\mathscr{C}|$ is naturally a paracompact polyfold.
\qed
\end{theorem}
In view of this theorem we can associate to a polyfold  structure for the GCT $\mathscr{C}$
a polyfold structure for the underlying metrizable space $|\mathscr{C}|$. With other words we have a forgetful functor
$$
(\text{GCT-polyfold}\ \  \mathscr{C})\ \ \ \rightsquigarrow \ \ (\text{Paracompact topological polyfold}\  |\mathscr{C}|).
$$
This procedure
loses the algebraic knowledge of the underlying category structure, but keeps
some information about it in the form of the Morita equivalence class of ep-groupoids.
Theorem \ref{THMX17110} is important for constructions in the categorical context since it allows to transfer
any notion which behaves well with respect to generalized isomorphisms. Since the arguments are usually straight forward
we allow ourselves to be sketchy at times.
\begin{remark}\index{R- Unions of covering families}
Assume that $X$ and $X'$ are ep-groupoids constructed from covering families $\bm{\Psi}$ and $\bm{\Psi}'$.
We denote by $X''$ the ep-groupoid associated to the union of the two covering families.
The weak fibered product $X\times_{X''} X'$ has as objects the tuples $(q_\lambda,(q_\lambda,\phi,q_{\lambda'}'),q_{\lambda'}')$,
where $q_\lambda$ is an object in $O_\lambda$, $q_{\lambda'}'\in O_{\lambda'}'$, and $(q_\lambda,\phi,q_{\lambda'}')$ is a morphism
in $X''$  between $q_\lambda$ and $q_{\lambda'}'$.
We define  
$$
\tau: X\times_{X''} X'\rightarrow \bm{C}: (q_{\lambda},(q_{\lambda},\phi,q_{\lambda'}'),q_{\lambda'}')\rightarrow \phi
$$
which associates to an object in $X\times_{X''} X'$ a morphism in $\mathscr{C}$. It turns out that $\tau$ 
is a natural transformation between $\Gamma\circ \pi_1$ and $\Gamma'\circ\pi_2$ which define equivalences 
$$
X\times_{X''} X'\rightarrow \mathscr{C}.
$$
\qed
\end{remark}
In the following  we shall carry over parts of the discussion of ep-groupoids and the concepts
which are compatible with generalized isomorphisms.
With $\mathscr{C}$ being equipped with a polyfold structure we obtain a filtration 
$\mathscr{C}_i$ for $i\in {\mathbb N}$. Namely we can pick for an object $\alpha$
a uniformizer $\Psi\in F(\alpha)$,  and writing $\alpha=\Psi(q)$ with $q\in O$ we can say
that $\alpha$ has {\bf regularity}\index{Regularity of an object} $i\in {\mathbb N}\cup \{\infty\}$ provided $q\in O_i$.
Of course, if $i<k$ and $q\in O_k$ it also has regularity $i$. Usually, for constructions it only matters that an object has a sufficient amount of regularity, or is smooth, i.e. belongs to all $O_i$. We can define $\text{reg}(\alpha)\in {\mathbb N}\cup\{+\infty\}$ as the maximal $i$ (including $\infty$)
such that $\alpha$ has this regularity. This all is well-defined, independent of the choice of $\Psi\in F(\alpha)$.  If $\alpha$ and $\alpha'$
are isomorphic they have the same regularity. This follows from the fact that $s$ and $t$ are local sc-diffeomorphisms.
As a consequence we obtain a {\bf regularity filtration}\index{Regularity filtration of $\mathscr{C}$}
$$
\mathscr{C}_\infty\rightarrow...\rightarrow \mathscr{C}_i\rightarrow \mathscr{C}_{i-1}...\rightarrow \mathscr{C}_0=\mathscr{C},
$$
which also descends to isomorphism classes.
As in the case of M-polyfolds or ep-groupoids the full subcategory $\mathscr{C}_i$ for a  $i\in {\mathbb N}$
has a natural polyfold structure as well. To see this we start with the equivalence 
$$
\Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C},
$$
which induces the homeomorphism $|\Gamma_{\bm{\Psi}}|\colon |X_{\bm{\Psi}}|\rightarrow |\mathscr{C}|$.
As we already have seen $|X|$ is metrizable and in particular paracompact. This implies that $|X^i|$ is paracompact and therefore metrizable
and consequently $|\mathscr{C}_i|$ has a natural metrizable topology, see Section \ref{section1.3_top_prop} for the relevant discussion.
In particular $\mathscr{C}_1$ is a GCT.
Define 
$$
F^1:\mathscr{C}_1\rightarrow \text{SET}
$$
by associating to $\alpha$ the collection $F^1(\alpha)$ of all $\Psi^1:G\ltimes O^1\rightarrow \mathscr{C}_1$.
Here $\Psi^1$ is obtained from $\Psi$ by lifting the index by $1$. We define for $\Psi^1$ and $\Psi^{'1}$
the M-polyfold ${\bm{M}}_{F^1}(\Psi^1,\Psi^{'1})$ as follows
$$
{\bm{M}}_{F^1}(\Psi^1,\Psi^{'1}):=({\bm{M}}(\Psi,\Psi'))^1,
$$
with the natural identification,  observing that the right-hand side has a natural M-polyfold structure.
The following result is obvious.
\begin{theorem}\label{THMX17111} \index{T- Natural polyfold structure for $\mathscr{C}_1$} 
Given the polyfold structure $(F,{\bm{M}})$ for $\mathscr{C}$ the full subcategory $\mathscr{C}_1$ is in a natural way a GCT
and, moreover, has the natural polyfold structure $(F^1,{\bm{M}}_{F^1})$. 
\qed
\end{theorem}
If $\mathscr{C}$ is equipped with a polyfold structure we shall write $\mathscr{C}^1$ for the category
$\mathscr{C}_1$ equipped with the induced natural polyfold structure. We also define
$$
\mathscr{C}^{i+1}:={(\mathscr{C}^i)}^1.
$$ 
\begin{definition}
Assume $\mathscr{C}$ is equipped with a polyfold structure. The degeneracy functor
$$
d:\mathscr{C}\rightarrow {\mathbb N}
$$
is defined by $d(\alpha):=d_O(q)$, where $\Psi\in F(\alpha)$ and $\Psi(q)=\alpha$. 
Here $d_O$ is the degeneracy index on $O$, where $\Psi:G\ltimes O\rightarrow \mathscr{C}$.
The {\bf boundary} $\partial\mathscr{C}$  of $\mathscr{C}$ is the full subcategory associated to objects of degeneracy at least $1$.
\qed
\end{definition}



\section{Tangent Construction}\label{TANGENTX172}
In this section we shall  introduce the tangent construction, which associates to a GCT $\mathscr{C}$ a  $GTC$ $T\mathscr{C}$ together with a projection
functor
$$
P\colon T\mathscr{C}\rightarrow \mathscr{C}^1
$$
and equips $T\mathscr{C}\rightarrow \mathscr{C}^1$ with the structure of a so-called  polyfold bundle, which induces the already given structure on $\mathscr{C}^1$. A polyfold bundle is a weaker notion than that of a strong bundle in the categorical context,  introduced later in Section \ref{CHAP176-}.


Given an object $\alpha$ in $\mathscr{C}_1$ we pick $\Psi, \Psi'\in F(\alpha)$, written as 
$$
\Psi\colon G\ltimes O\rightarrow \mathscr{C}\ \ \text{and}\ \ \Psi'\colon  G\ltimes O'\rightarrow \mathscr{C},
$$
and consider tuples $(\alpha,\Psi,h)$, with $h\in T_qO$ and   $\Psi(q)=\alpha$, and similarly 
$(\alpha,\Psi',h')$, with  $h'\in T_{q'}O'$, where by  $q'\in O'$ we denote the point satisfying $\Psi'(q')=\alpha$.
We shall define a notion of equivalence for two such tuples $(\alpha,\Psi,h)$ and $(\alpha,\Psi',h')$.

In order to do so we fix the tuple $(q,1_\alpha,q')\in \bm{M}(\Psi,\Psi')$,  and using that the source and target maps $s$ and $t$ are local sc-diffeomorphisms 
we find open neighborhoods $U(q)$, $U(q')$ and $U(q,1_\alpha,q')$ such that 
$$
s\colon U(q,1_\alpha,q')\rightarrow U(q)\ \ \text{and}\ \ t\colon U(q,1_\alpha,q')\rightarrow U(q')
$$
are sc-diffeomorphisms defining an sc-diffeomorphism $\sigma:U(q)\rightarrow U(q')$ by $\sigma(p) = t\circ (s|U(q,1_\alpha,q'))^{-1}(p)$.
We declare $(\alpha,\Psi,h)$ and $(\alpha,\Psi',h')$ to be {\bf equivalent}, i.e. 
$$
(\alpha,\Psi,h)\sim (\alpha,\Psi',h'),
$$
 provided 
$$
T\sigma(q)h=h'.
$$
\begin{lemma}\index{L- Equivalence relation $\sim$}
 ``$\sim$" defines an equivalence relation on the tuples $(\alpha,\Psi,h)$.
 \end{lemma}
\begin{proof}
Clearly $(\alpha,\Psi,h)\sim (\alpha,\Psi,h)$ since for $(q,1_\alpha,q)$ the local sc-diffeomor\-phism $\sigma$ is the identity.
The symmetry of the relation, i.e. $(\alpha,\Psi,h)\sim (\alpha,\Psi',h')$ implies $(\alpha,\Psi',h')\sim(\alpha,\Psi,h)$,
follows from the fact that the local sc-diffeomorphisms associated to $(q,1_\alpha,q')$ 
and $(q',1_\alpha,q)$ are inverse to each other.  For the transitivity property consider $(\alpha,\Psi,h)\sim (\alpha,\Psi',h')$
and $(\alpha,\Psi',h')\sim (\alpha,\Psi'',h'')$. Then with $\sigma$ corresponding to $(q,1_\alpha,q')$ and $\sigma'$ to $(q',1_\alpha,q'')$ 
we have 
$$
h'= T\sigma(q)(h)\ \ \text{and}\ \ h''=T\sigma(q')(h').
$$
This implies $h'' = T\sigma(q')\circ T\sigma(q)(h)$. We note that for $p$ near $q$ it holds that 
\begin{eqnarray*}
\sigma'\circ \sigma (p) &=& t\circ (s|U(q',1_\alpha,q''))^{-1} \circ t\circ  (s|U(q,1_\alpha,q'))^{-1}(p)\\
&=& t\circ (s|U(q,1_\alpha,q''))^{-1}(p)\\
&=&\sigma''(p)
\end{eqnarray*}
which implies that $h'' = T\sigma''(q)(h)$ and proves our assertion.  
\qed \end{proof}
We shall write $[\alpha,\Psi,h]$\index{$[\alpha,\Psi,h]$} for the equivalence class containing $(\alpha,\Psi,h)$.
\begin{definition}\index{D- Tangent vector at $\alpha$}
Let $\mathscr{C}$ be a GCT equipped with a polyfold structure. Given an object $\alpha$ in $\mathscr{C}_1$
we call an equivalence class $[\alpha,\Psi,h]$, where $\Psi\in F(\alpha)$, say $\Psi:G\ltimes O\rightarrow \mathscr{C}$,
and $h\in T_qO$ with $\Psi(q)=\alpha$ a 
 {\bf tangent vector}
at $\alpha$.
\qed
\end{definition}
 Note that $\alpha$ needs to be of regularity one in order to be able to talk about tangent vectors.
\begin{definition}\index{D- Tangent space $T_\alpha\mathscr{C}$}
Given a GCT $\mathscr{C}$ equipped with a polyfold structure,  we define for an object $\alpha$ of regularity $1$ the {\bf tangent space} $T_\alpha\mathscr{C}$
as the set of equivalence classes $[\alpha,\Psi,h]$.
\qed
\end{definition}
 The set $T_\alpha\mathscr{C}$ carries the structure  of a real vector space by setting
$$
[\alpha,\Psi,h]+\lambda[\alpha,\Psi,k]=[\alpha,\Psi,h+\lambda k].
$$
We can equip $T_\alpha\mathscr{C}$  with the structure of a Banach space by requiring 
that
the linear bijection
$$
S_\Psi\colon T_\alpha\mathscr{C}\rightarrow T_qO\colon [\alpha,\Psi,h]\rightarrow h
$$
is a topological linear isomorphism. The Banach space structure on $T_\alpha\mathscr{C}$ does not depend on the choice 
of $\Psi\in F(\alpha)$, since  $S_{\Psi'}\circ S_{\Psi}^{-1}(h)=T\sigma(q)(h)$ is a topological linear isomorphism.
We also note that for smooth objects $T_\alpha\mathscr{C}$   is naturally a sc-Banach space. 
Hence we obtain the following result.
\begin{proposition}\index{P- Banach space $T_\alpha\mathscr{C}$}
Given a GCT $\mathscr{C}$ equipped with a polyfold structure $(F,\bm{M})$, there exists for every $\alpha$ in $\mathscr{C}_1$ a natural associated Banach space $T_\alpha\mathscr{C}$
called the tangent space at $\alpha$. In case that $\alpha$ is smooth $T_\alpha\mathscr{C}$ has a natural sc-structure.
\qed
\end{proposition}
At this point we have a construction which, starting with a GTC $\mathscr{C}$ equipped with a polyfold structure,
associates to every objects $\alpha\in \mathscr{C}_1$  a Banach space $T_\alpha\mathscr{C}$. We shall show that 
this extends to a functor $\mathscr{C}_1\rightarrow \text{Ban}$, where $\text{Ban}$ \index{$\text{Ban}$} is the {\bf category of Banach spaces}\index{Category of Banach spaces: Ban} with the morphisms being topological linear isomorphisms.

For this assume  that $\phi:\alpha\rightarrow \alpha'$ is an isomorphism belonging to level $1$ and let $[\alpha,\Psi,h]$
be an element in $T_\alpha\mathscr{C}$.
We consider the transition M-polyfold $\bm{M}(\Psi,\Psi')$ and pick $q_0\in O$ satisfying $\Psi(q_0)=\alpha$ and $q_0'$
with $\Psi'(q_0')=\alpha'$. Take open neighborhoods $U(q_0)$, $U(q_0,\phi,q_0')$, and $U(q_0')$ such that $s:U(q_0,\phi,q_0')\rightarrow U(q_0)$ and $t:U(q_0,\phi,q_0')\rightarrow U(q_0')$ are sc-diffeomorphisms. Then $\sigma:U(q_0)\rightarrow U(q_0')$
defined by 
$$
\sigma(q) =t\circ (s|U(q_0,\phi,q_0'))^{-1}(q)
$$
is an sc-diffeomorphism satisfying $\sigma(q_0)=q_0'$. We define $T\phi:T_\alpha\mathscr{C}\rightarrow T_{\alpha'}\mathscr{C}$ 
\index{$T\phi:T_\alpha\mathscr{C}\rightarrow T_{\alpha'}\mathscr{C}$} by
$$
T\phi([\alpha,\Psi,h])=[\alpha',\Psi',T\sigma(q_0)(h)].
$$
Assume next that $\psi:\alpha'\rightarrow \alpha''$ and pick $\Psi''\in F(\alpha'')$. Then, with the obvious notation
\begin{eqnarray*}
&&T\psi(T\phi([\alpha,\Psi,h]))=T\psi([\alpha',\Psi',T\sigma(q_0)(h)])\\
& =&[\alpha'',\Psi'',T\sigma'(q_0')(T\sigma(q_0)(h))]=[\alpha'',\Psi'',T\sigma''(q_0)(h)].
\end{eqnarray*}
Summarizing, we obtain the following result.
\begin{proposition}\index{P- The functor $\mu_{\mathscr{C}}$}  \label{PROPU1725}
Given a GCT $\mathscr{C}$ equipped with a polyfold structure $(F,\bm{M})$ there exists a well-defined functor 
$$
\mu_{\mathscr{C}}: \mathscr{C}_1\rightarrow \text{Ban},
$$
 which associates to an object $\alpha$ on level $1$ the Banach space $T_\alpha\mathscr{C}$ and to a morphism
 $\phi:\alpha\rightarrow \alpha'$ the linear isomorphism $T\phi$.
 \qed
 \end{proposition}
 As we shall see next the tangent spaces $T_\alpha\mathscr{C}$ fit in some sense sc-smoothly together.
 The category $T\mathscr{C}$\index{$T\mathscr{C}$}, which we are going to define, will have as objects all the equivalence classes $[\alpha,\Psi,h]$,
 where $\alpha$ varies over $\mathscr{C}_1$. We shall use the functor $\mu_{\mathscr{C}}$ to carry out the construction.
 As obvious data we have the   projection functor $P:T\mathscr{C}\rightarrow \mathscr{C}_1$,  which for the moment
 is only defined on the object level by
\begin{eqnarray}\label{EQN172-}
P([\alpha,\Psi,h])=\alpha.
\end{eqnarray}
As morphisms we take the tuples $([\alpha,\Psi,h],\phi,T\phi([\alpha,\Psi,h]))$, where 
$\alpha$ is an object in $\mathscr{C}_1$, $[\alpha,\Psi,h]\in T_{\alpha}\mathscr{C}$ and $\phi$ is a morphism in
$\mathscr{C}$ with $s(\phi)=\alpha$ and $t(\phi)=\alpha'$. We view the morphism as
$$
([\alpha,\Psi,h],\phi,T\phi([\alpha,\Psi,h])): [\alpha,\Psi,h]\rightarrow T\phi([\alpha,\Psi,h]),
$$
so that 
\begin{eqnarray*}
& s([\alpha,\Psi,h],\phi,T\phi([\alpha,\Psi,h]))=[\alpha,\Psi,h]& \\
& t([\alpha,\Psi,h],\phi,T\phi([\alpha,\Psi,h]))=T\phi([\alpha,\Psi,h]).&
\end{eqnarray*}
For convenience of notation we shall often write a tangent vector $[\alpha,\Psi,h]$ as $\bar{h}$ and a morphism
$([\alpha,\Psi,h],\phi,[\alpha',\Psi',h'])$ as $\Phi$ or $\Phi:\bar{h}\rightarrow \bar{h}'$, or $(\bar{h},\phi,\bar{h}')$, or $(\bar{h},\phi,T\phi(\bar{h}))$,
which depends on the situation. 
We define $P$ on morphisms as
$$
P(\bar{h},\phi,\bar{h}')=\phi,
$$
which together with (\ref{EQN172-}) defines a functor 
\begin{eqnarray}
P:T\mathscr{C}\rightarrow \mathscr{C}_1.
\end{eqnarray}
Consider any object $\alpha$ belonging to $\mathscr{C}_1$ and pick $\Psi\in F(\alpha)$ which we write as 
$$
\Psi:G\ltimes O\rightarrow \mathscr{C}.
$$
We define with $\tau:TO\rightarrow O^1$
being the sc-smooth bundle projection the tangent $T\Psi$, say 
\begin{eqnarray}
T\Psi: G\ltimes TO \rightarrow T\mathscr{C}
\end{eqnarray}
by 
$$
T\Psi(h) = [\Psi(\tau(h)), \Psi', T\sigma(h)].
$$
 Here $\Psi'\in F(\tau(h))$ and $\sigma$ is the local sc-diffeomorphism 
associated to the element $(\tau(h),1_{\Psi(\tau(h))},q')\in \bm{M}(\Psi,\Psi')$, where $\Psi'(q')=\Psi(\tau(h))$. The definition involves the choice 
of a $\Psi'$ for every $p= \tau(h)$, but as we shall see  it is independent of such a choice since it is compensated for by $\sigma$, which changes 
with $\Psi'$.  Given a morphism $(g,h):h\rightarrow g\ast h$ in $G\ltimes TO$, say $h\in T_qO$,  we define $T\Psi(h)\rightarrow T(\Psi(g,q))(T\Psi(h))$
by
$$
T\Psi(g,h) = (T\Psi(h),\Psi(g,q),T(\Psi(g,q))(T\Psi(h))).
$$
Note that the morphism $\Psi(g,q):\Psi(q)\rightarrow \Psi(g\ast q)$ for $q\in O_1$ has the associated tangent operator
$$
T(\Psi(g,q)):T_{\Psi(q)}\mathscr{C}\rightarrow T_{\Psi(g\ast q)}\mathscr{C},
$$
introduced in Proposition \ref{PROPU1725}.
\begin{lemma}
$T\Psi: G\ltimes TO \rightarrow T\mathscr{C}$ is well-defined.
\end{lemma}
\begin{proof}
Assume $p\in O^1$ is fixed and pick $\Psi',\Psi''\in F(\Psi(p))$. With $G'$ being the isotropy group of $\Psi(p)$
and writing 
 $$
 \Psi':G'\ltimes O'\rightarrow \mathscr{C}\ \ \text{and} \ \ \Psi'':G'\ltimes O''\rightarrow \mathscr{C}
 $$
consider the points  $q'\in O'$ and $q''\in O''$
satisfying  $\Psi'(q')=\Psi''(q'')=\Psi(p)$. The local sc-diffeomorphism $\sigma$ with $\sigma(p)=q'$ is associated by the usual construction
to $(p,1_{\Psi(p)},q')\in \bm{M}(\Psi,\Psi')$ and $\sigma'$ with $\sigma'(p)=q''$ to $(p,1_{\Psi(p)},q'')\in \bm{M}(\Psi,\Psi'')$.
Consider with $\beta=\Psi(p)$ the tuples 
$$
(\beta,\Psi',T\sigma(p)(h))\ \ \text{and}\ \ (\beta,\Psi'',T\sigma'(p)(h)).
$$
 These tuples are equivalent 
since with $\sigma''$ associated to $(q',1_\beta,q'')\in \bm{M}(\Psi',\Psi'')$ we have that 
$$
\sigma''\circ \sigma =\sigma' \ \ \text{near}\ \ p.
$$
Hence $T\sigma''(q') T\sigma(p) = T\sigma'(p)$, which implies that 
$$
[\beta,\Psi',T\sigma(p)(h)] =[\beta,\Psi'', T\sigma'(p)(h)].
$$
Therefore $T\Psi$ is well-defined.
\qed \end{proof}
Assume that $\Psi_1\in F(\alpha)$ and $\Psi_2\in F(\alpha')$, which can be written
as
$$
\Psi_1:G\ltimes O\rightarrow \mathscr{C}\ \ \text{and}\ \ \Psi_2:G'\ltimes O'\rightarrow \mathscr{C}
$$
are given.
For $(o,\phi,o')\in \bm{M}(\Psi_1,\Psi_2)$ we can pick open neighborhoods
$$
U(o),\ U(o,\phi,o')\ \ \text{and}\ \ U(o')
$$
 such that  
$$
s:U(o,\phi,o')\rightarrow U(o)\ \ \text{and}\ \ t:U(o,\phi,o')\rightarrow U(o')
$$
are sc-diffeomorphisms. There exists a well-defined map $U(o)\ni q\rightarrow \phi_q$ such that
$$
(s|U(o,\phi,o'))^{-1}(q) = (q,\phi_q,\sigma(q)),
$$
where $\sigma(q) =t\circ (s|U(o,\phi,o'))^{-1}(q)$.  The existence of this well-defined map is, of course,
a consequence of having a polyfold structure on $\mathscr{C}$. Hence we 
have the assignment 
$$
q\rightsquigarrow \left[\Psi_1(q)\xrightarrow{\phi_q} \Psi_2(\sigma(q))\right]\ \ \ \text{for}\ \ q\in U(o).
$$
Using this assignment we lift it to the tangent level by defining 
\begin{eqnarray}\label{EQNXX67}
k\rightsquigarrow\left[T\Psi_1(k)\xrightarrow{T\phi_q} T\Psi_2(T\sigma(k))\right]\ \ \ \text{for}\ \  k\in T_qU(o),\ q\in U(o)^1.
\end{eqnarray}
We note that all the ingredients are well-defined and the diagrams, which depend on $q$, make sense.  
We record (\ref{EQNXX67}) as having the family of morphisms in $T\mathscr{C}$ given as
$$
k\rightarrow\Phi_k:=(T\Psi_1(k),\phi_{\tau(k)},T\Psi_2(T\sigma(k)))\ \ \text{for}\ \ k\in TU(o).
$$
The  tuples
$(k,\Phi_k,T\sigma(k))$ belong to $\bm{M}(T\Psi_1,T\Psi_2)$ and  we obtain the map
\begin{eqnarray}\label{LEMMX1727}
TU(o)\rightarrow \bm{M}(T\Psi_1,T\Psi_2): k\rightarrow (k,\Phi_k,T\sigma(k)).
\end{eqnarray}

\begin{lemma}
The following holds.
\begin{itemize}
\item[{\em (1)}] \  The  construction of a map as in (\ref{LEMMX1727}) can be done for all $(o,\phi,o')\in \bm{M}(\Psi_1,\Psi_2)$ on level $1$, and 
consequently every  element in $\bm{M}(T\Psi_1,T\Psi_2)$ lies in the image of such a map.
\item[{\em (2)}]\   Consider two such maps $TU(o)\rightarrow \bm{M}(T\Psi_1,T\Psi_2): k\rightarrow (k,\Phi_k,T\sigma(k))$
and $TU(o_1)\rightarrow \bm{M}(T\Psi_1,T\Psi_2): k\rightarrow (k,\Phi_k^1,T\sigma'(k))$.
If the images of these maps intersect nontrivially,  the transition map has the form $k\rightarrow k$.
\end{itemize}
\end{lemma}
\begin{proof}
(1) is obvious. In order to prove (2) assume the images intersect. In this case we find $k_0\in TU(o)\cap TU(o')$ such that 
 $$
 (k_0,\Phi_{{k_0}},T\sigma(k_0))=(k_0,\Phi^1_{k_0},T\sigma'(k_0)).
 $$
Underlying is the  identity $(q_0,\phi_{q_0},\sigma(q_0))=(q_0,\phi_{q_0}',\sigma'(q_0))$, where $q_0=\tau(k_0)$.
This implies that the data near $q_0$ coincides as well (using the properties of a polyfold structure on $\mathscr{C}$) and the definitions. Consequently  the transition map is the identity.
\qed \end{proof} 
As a consequence we can view the 
maps $k\rightarrow (k,\Phi_k, T\sigma(k))$ as inverses of charts which are sc-smoothly compatible.
There is a uniquely defined topology ${\mathcal T}$  on $\bm{M}(T\Psi_1,T\Psi_2)$ making these maps homeomorphisms
onto open sets. 
\begin{definition}\index{D- Natural topology on $\bm{M}(T\Psi_1,T\Psi_2)$}
Let $\Psi_i\in F(\alpha_i)$ for $i=1,2$. Then the topology ${\mathcal T}$ defined on $\bm{M}(\Psi_1,\Psi_2)$ is called the {\bf natural topology}.
\end{definition}
The natural topology has very good properties.
\begin{proposition}
The natural  topology ${\mathcal T}$ on $\bm{M}(T\Psi_1,T\Psi_2)$  is metrizable.
The source and target maps are local homeomorphisms. The inversion maps are  homeomorphisms
and the unit maps as well as the multiplication maps are continuous.
\end{proposition}
\begin{proof}
We first shall proof that ${\mathcal T}$ is metrizable.
Using the Nagata-Smirnov Theorem it suffices to show that ${\mathcal T}$ is Hausdorff, regular, locally metrizable,
and paracompact.\par

\noindent{\bf Hausdorff:}  For $j=1,2$ let $(k_j,\Phi_j,k_j')$ be two different points in
$\bm{M}(T\Psi_1,T\Psi_2)$. We find  two natural maps 
$$
TU(o_i)\rightarrow \bm{M}(T\Psi_1,T\Psi_2): k\rightarrow (k,\Phi_k^i,T\sigma_i(k))
$$
for $i=1,2$. If the images are disjoint we obtain immediately disjoint open neighborhoods.
If the images intersect the transition map is of the form $k\rightarrow k$ and we may assume
that the two natural maps coincide. Since $k_1\neq k_2$ we find disjoint open neighborhoods in 
$TU(o)$ and the images of these neighborhoods provided us with disjoint open neighborhoods.\par

\noindent{\bf Local Metrizibility:} Since $\bm{M}(T\Psi_1,T\Psi_2)$ is locally homeomorphic to a M-polyfold via the source map $s$  it is locally metrizable.\par

\noindent{\bf Regularity:}  
Take a point $(k,\Phi,k')$ and a closed subset $A$ of $\bm{M}(T\Psi_1,T\Psi_2)$ not containing this point.
We find an open neighborhood $U(k,\Phi,k')$ and an open neighborhood $U(k)$ so that 
$$
s:U(k,\Phi,k')\rightarrow U(k) \ \ \text{is an sc-diffeomorphism.}
$$
 Since $TO$ is metrizable we can find an open neighborhood $W(k)\subset TO$
with $ \cl_{TO}(W(k))\subset U(k)$ and we can take a continuous function $\beta:U(k)\rightarrow [0,1]$
which takes the value $0$ at $k$ and the value $1$ on $U\setminus \cl_{TO}(W)$. 
If $(h,\Phi',h')\in U(k,\Phi,k')$ we define $\bar{\beta}(h,\Phi',h')=\beta(h)$ and otherwise it takes the value $1$.
This map is continuous. \par

\noindent{\bf Paracompactness:}  Consider the local homeomorphism $s:\bm{M}(\Psi_1,\Psi_2)\rightarrow O$.
For every $q\in O$ there exist only a finite number of points lying above it. Hence we find finitely many open sets
$U_1,...,U_{k(q)}$ in $\bm{M}(\Psi_1,\Psi_2)$ and an open neighborhood $U(q)$ so that
$$
s:U_i\rightarrow U(q)
$$
is an sc-diffeomorphism. Since $O$ is metrizable and therefore paracompact we find a locally finite covering ${(K_\lambda)}_{\lambda\in\Lambda}$
of $O$ consisting of closed sets so that $K_\lambda\subset U(q_\lambda)$. Then we take the preimages
and obtain $\wt{K}_{\lambda,i}$, where $\lambda$ varies in $\Lambda$ and $i\in \{1,...,k(q_\lambda)\}$.
Then the $\wt{K}_{\lambda,i}$ are paracompact closed subsets of $\bm{M}(T\Psi_1,T\Psi_2)$.
The whole collection $(\wt{K}_{\lambda,i})$ is a covering of $\bm{M}(T\Psi_1,T\Psi_2)$ by closed sets.
The covering is also locally finite. Hence the Hausdorff topological space $\bm{M}(T\Psi_1,T\Psi_2)$
has been written as a locally finite covering of closed paracompact sets. This implies paracompactness of
$\bm{M}(T\Psi_1,T\Psi_2)$ since it is Hausdorff and regular.
\par

\noindent  The verification of the properties of the structure maps is straight forward. 
\qed \end{proof}
Having the topology in place we can equip $\bm{M}(T\Psi_1,T\Psi_2)$ with a M-polyfold structure.


\begin{proposition}
The metrizable spaces $\bm{M}(T\Psi,T\Psi')$  have natural M-polyfold structures for which 
the maps $s:\bm{M}(T\Psi,T\Psi')\rightarrow TO$ and $t:\bm{M}(T\Psi,T\Psi')\rightarrow TO'$
are local sc-diffeomorphisms, the inversion map 
$$
\bm{M}(T\Psi,T\Psi')\rightarrow \bm{M}(T\Psi',T\Psi)
$$
is an sc-diffeomorphism and the unit map and multiplication maps are sc-smooth.
\end{proposition}
\begin{proof}
We use the maps $TU(o)\rightarrow \bm{M}(T\Psi_1,T\Psi_2): k\rightarrow (k,\Phi_{\tau(k)}, T\sigma(k))$
as charts and since the transition maps are identities we obtain a M-polyfold structure. 
With this definition all source maps are sc-smooth and local sc-diffeomorphisms.  A target map $t$ in local coordinates
has the form
$$
k\rightarrow T\sigma(k)
$$
and this expression is sc-smooth and a local sc-diffeomorphism. The other maps have also local expressions 
which are sc-smooth. We leave the details to the reader.
\qed \end{proof}

Starting with a a GCT $\mathscr{C}$ equipped with a polyfold structure $(F,\bm{M})$ we described several constructions.
The first construction defines a groupoidal category $T\mathscr{C}$ together with a functor $P:T\mathscr{C}\rightarrow \mathscr{C}_1$
so that the fibers $P^{-1}(\alpha)$ are Banach spaces. We shall show soon that $|T\mathscr{C}|$ carries a natural metrizable topology.
A second construction associates to $\Psi\in F(\alpha)$ with $\alpha\in \mathscr{C}_1$, say $\Psi:G\ltimes O\rightarrow \mathscr{C}$ 
a functor 
$$
T\Psi: G\ltimes TO\rightarrow  T\mathscr{C}.
$$
A third construction associates to $\Psi$ and $\Psi'$ as just described a natural M-polyfold structure on $\bm{M}(T\Psi,T\Psi')$.
The canonical map 
$$
\bm{M}(T\Psi,T\Psi')\rightarrow \bm{M}(\Psi^1,\Psi'^1):(k,(T\Psi(k),\phi,T\Psi'(k')),k')\rightarrow(\tau(k),\phi,\tau'(k))
$$
is sc-smooth since in suitable local coordinates it takes the form 
$$
k\rightarrow \tau(k).
$$
This is a bundle situation for which we have a natural system of charts. 
Pick $(o,\phi,o')$ on level $1$. Then we find open neighborhoods $U(o,\phi,o')$ and $U(o)$ in $\bm{M}(\Psi,\Psi')$ and $O$
such that $s:U(o,\phi,o')\rightarrow U(o)$ is an sc-diffeomorphism. We lift the level by one and obtain the sc-diffeomorphism
$s:U(o,\phi,o')^1\rightarrow U(o)^1$ which we may take as (M-polyfold valued) chart.
Then we obtain the commutative diagram
$$
\begin{CD}
\bm{M}(T\Psi,T\Psi')|U(o,\phi,o')^1 @> s>>  TU(o)\\
@VVV @V \tau VV\\
U(0,\phi,o')^{1} @>s>>  U(o)^1,
\end{CD}
$$
which defines a bundle chart.   We also have the commutative diagram
$$
\begin{CD}
G\ltimes TO  @> T\Psi>> T\mathscr{C}\\
@VVV  @VVV\\
G\ltimes O^1    @> \Psi^1 >>  \mathscr{C}^1,
\end{CD}
$$
where on the bottom we have a unformizer for the polyfold $\mathscr{C}^1$. In order to see this diagram as a bundle uniformizer
we need to equip $|T\mathscr{C}|$ with a metrizable topology.
The collection of isomorphism classes in $T\mathscr{C}$ is a set,  and as we shall see next 
the orbit space $|T\mathscr{C}|$ carries a natural metrizable topology. 
\begin{proposition}
The orbit space $|T\mathscr{C}|$ carries a natural metrizable topology. In particular $T\mathscr{C}$ is in a natural way a GCT.
Moreover $|P|:|T\mathscr{C}|\rightarrow |\mathscr{C}_1|$ is continuous. (Recall that $\mathscr{C}_1$ is a GCT.)
\end{proposition}
\begin{proof}
Pick a covering family $\bm{\Psi}$ and construct the associated ep-groupoid $X=X_{\bm{\Psi}}$ together with the natural equivalence 
$$
\Gamma:=\Gamma_{\bm{\Psi}}\colon X\rightarrow \mathscr{C},
$$
which induces a homeomorphism between the orbit spaces. Then $X$ is a metrizable ep-groupoid
implying that $TX$ is a metrizable ep-groupoid, see Section \ref{section_Tangent_Ep-Groupoid}.  We define 
\begin{eqnarray}\label{EQNW17211}
T\Gamma:TX\rightarrow T\mathscr{C}
\end{eqnarray}
as follows. Recall that the object M-polyfold is the disjoint union of $O_\lambda$,  and $q_\lambda\in O_\lambda$ is mapped
by $\Gamma$ to the object $\Psi_\lambda(q_\lambda)$. With $\alpha=\Psi_\lambda(q_\lambda)$ pick $\Psi\in F(\alpha)$ and assume that $\alpha$ is on level one.
Assuming that  $\Psi(q)=\alpha$ we obtain the element $(q_{\lambda},1_{\alpha},q)\in \bm{M}(\Psi_\lambda,\Psi)$ and  as before
the sc-diffeomorphism 
$$
\sigma:(U(q_\lambda),q_\lambda)\rightarrow (U(q),q).
$$
Then we define for $h_\lambda \in T_{q_\lambda}O_\lambda$ 
$$
T\Gamma( h_\lambda) = [\Psi_{\lambda}(q_\lambda), \Psi, T\sigma(q_\lambda)(h_\lambda)].
$$
Passing to orbit spaces we obtain the bijection
$$
|T\Gamma| \colon |TX|\rightarrow |T\mathscr{C}|.
$$
The orbit space $|TX|$ has a natural metrizable topology since $X$ is metrizable, see Theorem \ref{paraXCV}, and consequently defines a metrizable topology
on $|T\mathscr{C}|$. It is easily verified that the definition of the topology on $|T\mathscr{C}|$ does not depend on the choice of
the covering family $\bm{\Psi}$. 
\qed \end{proof}

Hence, starting with $(F,\bm{M})$ for the GCT $\mathscr{C}$ we have constructed a GCT $T\mathscr{C}$ together with
$P:T\mathscr{C}\rightarrow \mathscr{C}_1$ which induces a continuous map between orbit spaces.
We also constructed a functor $TF:\mathscr{C}_1^-\rightarrow \text{SET}$
which associates to $\alpha$ the set $TF(\alpha)$ consisting of all $T\Psi$ with $\Psi\in F(\alpha)$. These we view as the commutative diagrams
$$
\begin{CD} 
G\ltimes TO @> T\Psi>> T\mathscr{C}\\
@VVV @V P VV\\
G\ltimes O^1 @>\Psi^1 >>  \mathscr{C}_1.
\end{CD}
$$
The top horizontal map is fiber-wise a topological linear isomorphism. Passing to orbit spaces 
$|T\Psi|$ and $|\Psi^1|$ become homeomorphisms onto open sets. In addition we have a construction $\bm{M}$
which associates to $T\Psi_1$ and $T\Psi_2$ the structure of a bundle over an M-polyfold 
$$
\bm{M}(T\Psi_1,T\Psi_2)\rightarrow \bm{M}({(\Psi_1)}^1,{(\Psi_2)}^1).
$$
We  associate to $\alpha$
the collection $TF(\alpha)$ of all $T\Psi$, where $\Psi$ varies in $F(\alpha)$. In this way we keep track of the bundle structure
and we obtain the construction $(TF,\bm{M})$ for the diagram $T\mathscr{C}\rightarrow \mathscr{C}_1$ between GCT's
and equip this with a polyfold bundle structure. Then $TF:\mathscr{C}_1^-\rightarrow \text{SET}$ is a functor.

A slightly weaker construction produces the functor $TFP:=TF\circ P: T\mathscr{C}\rightarrow \text{SET}$. Here we forget 
about the bundle structure and just consider the GCT $T\mathscr{C}$.
 The polyfold structure $TFP$ associates to $k\in T_\alpha\mathscr{C}$ the set $TF(P(k))$ consisting of all $T\Psi$, where
$\Psi$ varies over $\Psi\in F(\alpha)$. Hence, if $k,k'\in T_\alpha\mathscr{C}$ it holds that $TF(P(k))=TF(P(k'))$ and consequently
$TFP:T\mathscr{C}\rightarrow \text{SET}$. 



Summarizing the construction we obtain the following result.
\begin{theorem}
Let $\mathscr{C}$ be a GCT equipped with a polyfold structure $(F,\bm{M})$. Then there exists a natural construction 
of a category $T\mathscr{C}$ called the {\bf tangent category}\index{Tangent category} and a simultaneous polyfold structure
for $T\mathscr{C}\rightarrow \mathscr{C}_1$ denoted by $(TF,\bm{M})$. 
\end{theorem}
 We can visualize the two different constructions as follows
$$
\mathscr{C} \ \ \ \  \rightsquigarrow  \ \ \ \   T\mathscr{C}\ \ \ \text{This associates to a polyfold another one}.
$$
The bundle view-point is represented by 
 the following diagram
$$
\mathscr{C} \ \ \ \  \rightsquigarrow \ \ \ \    \begin{CD} 
T\mathscr{C}\\
@V P VV\\
\mathscr{C}^1
\end{CD}
\ \ \ \text{This associates to a polyfold a polyfold bundle.}
$$
\begin{remark}\label{REMARG238}\index{R-  Remark on how to transport notions and results over to the categorical setting}
There are many constructions and notions we can carry over from the M-polyfold or ep-groupoid situation.
Let $\mathscr{C}$ be a polyfold and $\alpha$ a smooth object. Then the tangent $T_\alpha\mathscr{C}$ is
an sc-Banach space.  We can define the {\bf  partial cone}\index{Partial cone $C_\alpha\mathscr{C}\subset T_\alpha\mathscr{C}$} $C_\alpha\mathscr{C}\subset T_\alpha\mathscr{C}$ and the {\bf reduced tangent space}\index{Reduced tangent $T^R_\alpha\mathscr{C}$} $T^R_\alpha\mathscr{C}$ following
Definition \ref{reduced_cone_tangent}. These can be defined in the obvious way for an sc-smooth model
$X$ and pushed forward via $T\Gamma$, where $\Gamma:X\rightarrow \mathscr{C}$ is the associated 
equivalence.  In the case that $\mathscr{C}$ is tame the partial cone will be a partial quadrant
and we can define what it means that a finite-dimensional linear subspace is in {\bf good position}\index{Good position to $C_\alpha\mathscr{C}$} to $C_\alpha\mathscr{C}$.
\qed
\end{remark}
\section{Subpolyfolds}
Let the GCT $\mathscr{C}$ be equip\-ped with a polyfold structure $(F,\bm{M})$.
\begin{definition}\index{D- Subpolyfold}
A {\bf subpolyfold} $\mathscr{A}$ of $\mathscr{C}$ is a saturated full subcategory such that for 
an object $\alpha$ in $\mathscr{A}$ and $\Psi\in F(\alpha)$, say $\Psi:G\ltimes O\rightarrow \mathscr{C}$,
the set of all objects $A_\Psi\subset O$ with $\Psi(A)\subset \mathscr{A}$ is a sub-M-polyfold of $O$.
\qed
\end{definition}
Although the definition seems to require to check the properties of $\mathscr{A}$ with respect to all $\Psi$, a collection which is not even a set in general, this is not true. In fact, it only has to be 
checked with respect any covering family $\bm{\Psi}$. In this spirit we give an alternative definition.
\begin{definition}[Alternative Definition of subpolyfold]  Let the GCT $\mathscr{C}$ be equip\-ped with a polyfold structure
$(F,\bm{M})$. A saturated full subcategory $\mathscr{A}$ is subpolyfold provided for a suitable sc-smooth local model
$X_{\bm{\Psi}}$ with natural equivalence $\Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C}$
the preimage $A$ under $\Gamma_{\bm{\Psi}}$ is an ep-subgroupoid in the sense of Definition \ref{Xep-subgroupoid}.
\qed
\end{definition}
\begin{remark}\index{R- On the equivalence of subpolyfold notions}
Note that the choice of $X_{\bm{\Psi}}$ in the definition does not matter.  We leave it to the reader to verify that 
the two given definitions of a subpolyfold are equivalent.
\qed
\end{remark}
Given a subpolyfold $\mathscr{A}$ of $\mathscr{C}$ we shall show next that it inherits 
from the structure on $\mathscr{C}$ a natural polyfold structure.
For every object $\alpha$ and $\Psi\in F(\alpha)$
$$
\Psi:G\ltimes O\rightarrow \mathscr{C}
$$
 define $\Psi_{\mathscr{A}}:G\ltimes A_\Psi\rightarrow \mathscr{A}$
as the restriction of $\Psi$. Cleary $\Psi_{\mathscr{A}}$ is injective on objects and fully faithful. Moreover,
we have the commutative diagram
$$
\begin{CD}
|G\ltimes A_\Psi| @>|\Psi_\mathscr{A}|>>| \mathscr{A}|\\
@VVV  @VVV\\
|G\ltimes O| @>|\Psi| >>  |\mathscr{C}|
\end{CD}
$$
where the horizontal maps are homeomorphic maps onto the open images, and the vertical maps
are topological embeddings, which in fact is even true level-wise. Hence every $\Psi_{\mathscr{C}}$ is a uniformizer.
We obtain a functor $F_{\mathscr{A}}:\mathscr{A}^-\rightarrow \text{SET}$ which associates to an object $\alpha$ the 
set of unifomizers $F_{\mathscr{A}}(\alpha)$ consisting of all $\Psi_\mathscr{A}$, where $\Psi$ varies in $F(\alpha)$.
Given two uniformizers $\Psi_\mathscr{A}$ and $\Psi_{\mathscr{A}}'$ associated to objects $\alpha$ and $\alpha'$ in $\mathscr{A}$
we consider the associated transition set $\bm{M}(\Psi_\mathscr{A},\Psi_\mathscr{A}')$ which is a subset of 
$\bm{M}(\Psi,\Psi')$.
\begin{lemma}
$\bm{M}(\Psi_\mathscr{A},\Psi_\mathscr{A}')$ is a sub-M-polyfold of $\bm{M}(\Psi,\Psi')$.
\end{lemma}
\begin{proof}
For $(o,\phi,o')\in \bm{M}(\Psi_{\mathscr{A}},\Psi_{\mathscr{A}}')$ we find open neighborhoods $U(o,\phi,o')$ in 
$\bm{M}(\Psi,\Psi')$ and $U(o)$ in $O$ such that $s:U(o,\phi,o')\rightarrow U(o)$ is an sc-diffeomorphism. Then $A_\Psi\cap U(o)$ is a sub-M-polyfold of $U(o)$ and also of $O$ and the preimage of $U(o)\cap A_\Psi$ under $s$ is precisely 
$U(o,\phi,o')\cap \bm{M}(\Psi_{\mathscr{A}},\Psi_{\mathscr{A}}')$. This implies that $\bm{M}(\Psi_{\mathscr{A}},\Psi_{\mathscr{A}}')$ is a sub-M-polyfold of $\bm{M}(\Psi,\Psi')$.
\qed \end{proof}
Since the $\bm{M}(\Psi_\mathscr{A},\Psi_\mathscr{A}')$ are sub-M-polyfolds, it follows that the associated 
structural maps are sc-smooth, since they are restrictions of the ambient structural maps for the $\bm{M}(\Psi,\Psi')$.
Summarizing we obtain a polyfold construction $(F_\mathscr{A},\bm{M})$ for the subpolyfold $\mathscr{A}$.
Hence we have proved.
\begin{proposition}
Given a GCT $\mathscr{C}$ with polyfold structure $(F,\bm{M})$ and a subpolyfold $\mathscr{A}$, the 
full subcategory $\mathscr{A}$ as stand-alone GCT inherits a natural polyfold structure $(F_\mathscr{A},\bm{M})$.
\qed
\end{proposition}

A typical example of subpolyfolds are  local faces or faces if the category is face-structured.
First we introduce the notion of faces into the current context.
\begin{definition}\index{D- Face of $\mathscr{C}$}
Assume the GCT $\mathscr{C}$ is equipped with a tame polyfold structure. A {\bf face} of $\mathscr{C}$ 
is the full subcategory $\mathscr{C}_\theta$ associate to the closure $\theta$ in $|\mathscr{C}|$ 
of a connected component $\theta^\circ$ in $\{z\in |\mathscr{C}|\ |\ d_{|\mathscr{C}|}(z)=1\}$.
We say that $\mathscr{C}$ is {\bf face-structured} provided every $z\in |\mathscr{C}|$ belongs to precisely $d(z)$-many $\theta$.
\qed
\end{definition}
Assume that $X_{\bm{\Psi}}$ is an sc-smooth model of $\mathscr{C}$ and $\Gamma_{\bm{\Psi}}: X_{\bm{\Psi}}\rightarrow \mathscr{C}$ the natural equivalence.
Passing to orbit spaces we obtain the homeomorphism
$$
|\Gamma_{\bm{\Psi}}|: |X_{\bm{\Psi}}|\rightarrow |\mathscr{C}|,
$$
which preserves the induced degeneracy index. Hence the closures of connected components
in the subspaces defined by $d_{|X_{\bm{\Psi}}|}$ and $d_{|\mathscr{C}|}$ correspond.
In view of Definition \ref{DEF1113} the faces of $X_{\bm{\Psi}}$ and 
$\mathscr{C}$ correspond. 
In particular,  the tame $\mathscr{C}$ is face-structured if and only if any of its sc-smooth models $X_{\bm{\Psi}}$ is face-structured. This follows from the discussion after Definition \ref{DEF1113}.  
\begin{proposition}
Assume the GCT $\mathscr{C}$ is equipped with a tame polyfold structure $(F,\bm{M})$.
   If $\mathscr{C}$ is face structured, every face is a subpolyfold.\qed
\end{proposition}





\section{Branched Ep\texorpdfstring{$^+$}{plll}-Subcategories}
The branched ep$^+$-subcategories are important since they appear as the solution spaces
for sc-Fredholm section functors.
Assume that $\mathscr{C}$ is a GCT equipped with a polyfold structure.
\begin{definition}
A functor $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ is called a branched ep$^+$-subcategory
provided for an object $\alpha$ and $\Psi\in F(\alpha)$ the functor $\Theta\circ\Psi:G\ltimes O\rightarrow {\mathbb Q}^+$
is a branched ep$^+$-subgroupoid in the sense of Definition \ref{DEF912}.
\qed
\end{definition}
Again, the property of being a branched ep$^+$-subcategory only has to be checked 
for a covering set of uniformizers. 
More precisely, if $\bm{\Psi}={(\Psi_\lambda)}_{\lambda\in\Lambda}$  is a covering set of uniformizers and for every $\Psi_\lambda$
the functor $\Theta\circ\Psi_\lambda$ is a a branched ep$^+$-subgroupoid, the same property holds for an arbitrary $\Psi$ coming from 
$F$.  Consider $\Gamma:X\rightarrow \mathscr{C}$, where $\Gamma$ and $X$ are associated to the covering family $\bm{\Psi}$.
Given $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ we define the {\bf pull-back}\index{Pull-back $\Gamma_{\bm{\Psi}}^\ast\Theta$} by 
$$
\Gamma^\ast\Theta :=\Theta\circ\Gamma,
$$
which defines a functor $X\rightarrow {\mathbb Q}^+$.  Given $\Theta:X\rightarrow {\mathbb Q}^+$ we can also define a {\bf push forward}
$$
\Gamma_\ast\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+
$$
as follows. Given an object $\alpha$ of $\mathscr{C}$ pick an object $x\in X$ so that there exists a morphism $\phi:\Gamma(x)\rightarrow \alpha$
and define $(\Gamma_\ast\Theta)(\alpha):=\Theta(x)$. This is possible since $\Gamma$ as an equivalence is essentially surjective.
 One easily verifies that this  is well-defined.
The following facts are obvious.
\begin{proposition}\label{XPROP1742}
Assume $X_{\bm{\Psi}}$ is a sc-smooth model for $\mathscr{C}$ (equipped with $(F,\bm{M})$) and $\Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C}$ is the canonical equivalence. Then the following holds.
\begin{itemize}
\item[{\em (1)}] \ If $\Theta:X_{\bm{\Psi}}\rightarrow {\mathbb Q}^+$
is a branched ep$^+$-subgroupoid, then $(\Gamma_{\bm{\Psi}})_\ast\Theta$ is a branched ep$^+$-subcategory.
\item[{\em (2)}]\   If $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subcategory, then $\Gamma_{\bm{\Psi}}^\ast\Theta$
is a branched ep$^+$-subgroupoid.
\end{itemize}
\qed
\end{proposition}
Given two covering families $\bm{\Psi}$ and $\bm{\Psi}'$ with associated equivalences $\Gamma:X\rightarrow \mathscr{C}$ and $\Gamma':X'\rightarrow \mathscr{C}$ denote by $\mathfrak{f}:X\rightarrow X'$ the canonical generalized isomorphism. Recall that we can use $\mathfrak{f}$ to push forward or pull back branched ep$^+$-subgroupoids. The reader will easily verify the identities
$$
\mathfrak{f}^\ast (\Gamma')^\ast \Theta = \Gamma^\ast\Theta \ \text{and}\ \ \Gamma_\ast\Theta' = \Gamma'_\ast\mathfrak{f}_\ast\Theta',
$$
for $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ and $\Theta':X\rightarrow {\mathbb Q}^+$.

\begin{definition}\index{D- Compact $\Theta$}
Assume that $\mathscr{C}$ is a polyfold and $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subcategory.
\begin{itemize}
\item[(1)] \  We say $\Theta$ is {\bf compact} provided the orbit space $|\supp(\Theta)|$ is a compact subset
of $|\mathscr{C}|$.
\item[(2)] \  We say $\Theta$ is {\bf tame}\index{D- Tame $\Theta$} if for a suitable covering family $\bm{\Psi}$ with associated
$\Gamma:X\rightarrow \mathscr{C}$ the pull-back $\Gamma^\ast\Theta$ which is a branched ep$^+$-subgroupoid is tame. We note that this is well-defined since for two different choices of covering family
the generalized isomorphism $\mathfrak{f}:X\rightarrow X'$ via pull-back or push-forward of
branched ep$^+$-subgroupoids preserves tameness.
\end{itemize}
\qed
\end{definition}



In view of Proposition \ref{XPROP1742} we can define following Definition \ref{DEF917} 
branched ep$^+$-subcategories which are of manifold-type or orbifold type. 
\begin{definition}\label{GHDEF}
Let $\mathscr{C}$ be a polyfold and $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ a branched
ep$^+$-subcategory. 
\begin{itemize}
\item[(1)] \  We say that $\Theta$ is of {\bf manifold-type} provided between any two objects 
$\alpha$ and $\alpha'$ in $\supp(\Theta)$ there is at most one morphism, and in addition
$\Theta$ only takes the values $0$ and $1$.
\item[(2)]\   $\Theta$ is said to be of {\bf orbifold type} provided $\Theta$ only takes the values $0$ and $1$.
\item[(3)] \ We say $\Theta$ is tame provided for $\alpha$ being in the support of $\Theta$ and $\Psi\in F(\alpha)$
the functor $\Theta\circ \Psi:G\ltimes O\rightarrow {\mathbb Q}^+$ is a tame branched ep$^+$-subgroupoid. Equivalently
for an sc-smooth model $X$ the functor $\Theta\circ \Gamma:X\rightarrow {\mathbb Q}^+$ is tame branched ep$^+$-subgroupoid.
\end{itemize}
\qed
\end{definition}
As a consequence of Proposition \ref{PROPY918} we obtain the following result.
\begin{proposition}
Let the GCT $\mathscr{C}$ be equipped with a polyfold structure $(F,\bm{M})$ and
assume that $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subcategory.
\begin{itemize}
\item[{\em (1)}] \  If $\Theta$ is of manifold-type then $S=|\supp(\Theta)|$ has in a natural way the structure
of a smooth finite-dimensional manifold (the M$^+$-polyfold version).
\item[{\em (2)}] \ If $\Theta$ is of orbifold-type then $S=|\supp(\Theta)|$ has a natural smooth orbifold structure
(the M$^+$-polyfold version).
\end{itemize}
\end{proposition}
See Remark \ref{remark918} concerning our notion of smooth manifold or orbifold.
\begin{proof}
We reduce the consideration to Proposition \ref{PROPY918}.  Let $\bm{\Psi}$ be a covering set of uniformizers and $X=X_{\bm{\Psi}}$ be the associated ep-groupoid and 
$\Gamma:X\rightarrow \mathscr{C}$ the corresponding equivalence. If follows from the 
definition that $\Theta\circ\Gamma$ is of manifold or orbifold-type in the ep-groupoid 
sense, see Definition \ref{DEF917}, if and only if $\Theta$ is of the corresponding type
defined in Definition \ref{GHDEF}.  Assume that $\bm{\Psi}'$ is a second 
covering set defining $X'$ and $\Gamma':X'\rightarrow \mathscr{C}$. There exists a 
natural generalized isomorphism $\mathfrak{f}:X\rightarrow X'$ satisfying 
\begin{eqnarray}\label{OPEQN007}
|\Gamma|=|\Gamma'|\circ |\mathfrak{f}|,
\end{eqnarray}
and
$$
\Theta\circ\Gamma' = \mathfrak{f}_\ast (\Theta\circ\Gamma).
$$
In the case that $\Theta$ is of manifold-type the generalized isomorphism $\mathfrak{f}$ induces
a classically smooth diffeomorphism 
$$
|\supp(\Theta\circ \Gamma)|\xrightarrow{|\mathfrak{f}|} |\supp(\Theta\circ\Gamma')|
$$
There exists a unique manifold structure on $|\supp(\Theta)|$
for which $|\Gamma|:|\supp(\Theta\circ\Gamma)|\rightarrow |\supp(\Theta)|$ is a diffeomorphism
and this structure is independent of the choice of the covering family in view of
(\ref{OPEQN007}).  

In the case of $\Theta$ being of orbifold type the argument is similar and $|\mathfrak{f}|$
is a smooth orbifold maps. Details are left to the reader.
\qed \end{proof}

As we shall see a branched ep$^+$-subcategory $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ has, as in  the ep$^+$-subgroupoid case,
a tangent functor $T\Theta:T\mathscr{C}\rightarrow {\mathbb Q}^+$ as well as the associated section functor 
$\mathsf{T}_\Theta$, which is being used to define orientations via suitable lifts, see Definition \ref{DEFNX9212} and Theorem \ref{P15.2*1}.

The tangent $T\Theta:T\mathscr{C}\rightarrow {\mathbb Q}^+$ is defined as follows.  We pick a covering family $\bm{\Psi}$
and obtain the associated equivalence $\Gamma:X\rightarrow \mathscr{C}$. We can take the tangent $T(\Gamma^\ast\Theta)$
which is a branched ep$^+$-subgroupoid $T(\Gamma^\ast\Theta):TX\rightarrow {\mathbb Q}^+$. Then we use $T\Gamma:TX\rightarrow T\mathscr{C}$ to push it forward to obtain
$$
(T\Gamma)_\ast (T(\Gamma^\ast\Theta)):T\mathscr{C}\rightarrow {\mathbb Q}^+.
$$
This construction might depend a prior on the choice of $\bm{\Psi}$, but this turns out to be not the case. 
Namely with $\mathfrak{f}:X\rightarrow X'$ being the canonical generalized isomorphism it follows that $T\mathfrak{f}:TX\rightarrow TX'$
is the canonical isomorphism for the uniformizer construction for $T\mathscr{C}$. Using that
$$
\mathfrak{f}_\ast (\Gamma^\ast\Theta)=(\Gamma'^\ast\Theta)
$$
it follows that
$$
T\mathfrak{f}_\ast (T(\Gamma^\ast\Theta))= T(\Gamma'^\ast\Theta).
$$
Pushing forward by $T\Gamma'$ we obtain
\begin{eqnarray*}
   (T\Gamma')_\ast (T({(\Gamma')}^\ast\Theta))= (T\Gamma')_\ast T\mathfrak{f}_\ast (T(\Gamma^\ast\Theta))= (T\Gamma)_\ast (T(\Gamma^\ast\Theta)).
\end{eqnarray*}
\begin{definition}\index{D- Tangent of $\Theta$}
Let $\mathscr{C}$ be a polyfold and $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subcategory.
The well-defined $T\Theta: T\mathscr{C}\rightarrow {\mathbb Q}^+$ given via a covering set $\bm{\Psi}$ and $\Gamma:X\rightarrow \mathscr{C}$ by
$$
T\Theta:=(T\Gamma)_\ast (T(\Gamma^\ast\Theta)),
$$
is called the {\bf tangent} of $\Theta$.
\qed
\end{definition}
Next we introduce $\mathsf{T}_\Theta$.
Starting with the polyfold $\mathscr{C}$ we define a functor on the full subcategory associated to the smooth objects denoted by
$$
\nu\colon \mathscr{C}_\infty\rightarrow \text{SET}.
$$
We associate to $\alpha$ the set $\nu(\alpha)$ consisting of finite formal sums $\sum \sigma_L\cdot L$, where $\sigma_L\geq 0$ is a rational
number and for almost all $L$ the number is zero. Moreover $L\subset T_\alpha\mathscr{C}$ is a smooth finite-dimensional linear subspace. If $\phi:\alpha\rightarrow \alpha'$ we define 
$$
\nu(\phi)\colon\nu(\alpha)\rightarrow \nu(\alpha') : \sum \sigma_L\cdot L\rightarrow \sum \sigma_L\cdot \phi_\ast L,
$$
where $\phi_\ast L:= T\phi (L)$ and $T\phi:T_\alpha\mathscr{C}\rightarrow T_{\alpha'}\mathscr{C}$ is the sc-operator 
associated to $\phi$. Associated to $\nu$ we have the category ${\mathcal L}_\nu$ whose objects are the pairs
$(\alpha,\mathsf{L})$, with $\mathsf{L}\in\nu(\alpha)$. This category fibers over $\mathscr{C}_\infty$
$$
{\mathcal L}_\nu\rightarrow \mathscr{C}_\infty:(\alpha,\mathsf{L})\rightarrow \alpha.
$$
In order to stay consistent with the notation introduced in the ep-groupoid case
we set $\text{Gr}(\mathscr{C}):={\mathcal L}_\nu$,
so that
$$
\text{Gr}(\mathscr{C})\rightarrow \mathscr{C}_\infty.
$$
To a given  branched ep$^+$-subcategory $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ we can associate 
a section functor $\mathsf{T}_{\Theta}$ of $\text{Gr}(\mathscr{C})\rightarrow \mathscr{C}_\infty$ as follows.
Take an sc-smooth model $X$ associated to a covering family $\bm{\Psi}$ and the canonical equivalence 
$$
\Gamma:X\rightarrow \mathscr{C} 
$$
with associated tangent functor $T\Gamma:TX\rightarrow T\mathscr{C}$, see (\ref{EQNW17211}). 
Then $\Gamma^\ast\Theta$ is a branched ep$^+$-subgroupoid which has an associated section functor
$\mathsf{T}_{\Gamma^\ast\Theta}$ of $\text{Gr}(X)\rightarrow X_\infty$.  Since $\Gamma^\ast\Theta$ is a functor and has near a point $x$ in the support
a particular local representation it follows that $\mathsf{T}_{\Gamma^\ast\Theta}(x)$ is invariant under all
$T\phi$, where $\phi\in G_x$, i.e. with $\sum\sigma_L\cdot L= \mathsf{T}_{\Gamma^\ast\Theta}(x)$ it holds
\begin{eqnarray}
T\phi(\sum\sigma_L\cdot L) =\sum \sigma_L\cdot L\ \ \text{for all}\ \phi\in G_x.
\end{eqnarray}
Observe that for a smooth $x\in X$ with $\Gamma(x)=\alpha$ a smooth finite-dimensional subspace 
$L$ of $T_xX$ is mapped by $T\Gamma$ to a finite-dimensional linear subspace of $T_\alpha\mathscr{C}$.
This also defines a map for the finite sums $\sum \sigma_L\cdot L$.  Hence we can transport for smooth $x\in X$
the finite combination via $T\Gamma$ to a finite combination of smooth finite-dimensional subspaces of $T_\alpha\mathscr{C}$.
We also have to make a definition for an arbitrary smooth $\alpha$ which might not lie in the image of $\Gamma$.
Here the fact that $\Gamma$ is essentially surjective will be important.
Assume that $x\in X$ is smooth and $\alpha$ is an object in $\mathscr{C}$ and $x\in X$  such that there exists a morphism
$\phi:\Gamma(x)\rightarrow \alpha$. Then the image of the finite sum $\mathsf{T}_{\Gamma^\ast\Theta}(x)$
under first applying $T\Gamma$ and then $T\phi$ is not depending on the choice of $\phi$
since the formal sum is invariant under the action of the isotropy group.
Therefore there is a well-defined push-forward operation $T\Gamma_\ast(\mathsf{T}_{\Gamma^\ast\Theta})$
which defines a section of $\text{Gr}(\mathscr{C})\rightarrow \mathscr{C}_\infty$.
\begin{proposition}
Let the GCT $\mathscr{C}$  be equipped with the polyfold structure $(F,\bm{M})$ and
let $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ be a branched ep$^+$-subcategory.
Then there exists a well-defined  section $\mathsf{T}_\Theta$ of $\text{Gr}(\mathscr{C})\rightarrow \mathscr{C}_\infty$
uniquely defined as follows.
Given a covering family $\bm{\Psi}$ with associated ep-groupoid $X$ and equivalence
$\Gamma:X\rightarrow \mathscr{C}$ the identity
$\mathsf{T}_\Theta = T\Gamma_\ast\mathsf{T}_{\Theta\circ\Gamma}$
holds.
\qed
\end{proposition}
The straight forward proof is left to the reader.
Next we introduce the important notion of an orientation. Again the basic constructions needed are those carried out in the ep-groupoid context, see  Section \ref{SECXV93}. 
We assume that the GCT $\mathscr{C}$ has been equipped with  a polyfold structure $(F,\bm{M})$. 
For a smooth object $\alpha$ in $\mathscr{C}$ we consider the tangent space $T_\alpha\mathscr{C}$ 
and consider finite sums 
$$
\wh{\mathsf{L}}=\sum\sigma_{\wh{L}} \cdot \wh{L},
$$
where all $\sigma_{\wh{L}}$ are non-negative rational numbers and almost all of these numbers are zero, and
$\wh{L}$ are smooth oriented finite-dimensional subspaces of the sc-Banach space $T_\alpha\mathscr{C}$.
The collection of such finite formal sums associated to $\alpha$ is denoted by $\wh{\text{Gr}}(\alpha)$ and the union
of all such objects is denoted by $\wh{\text{Gr}}(\mathscr{C})$, where the objects vary over all smooth ones.
We obtain
$$
\wh{\text{Gr}}(\mathscr{C})\rightarrow \mathscr{C}_\infty.
$$
There is a forgetful functor $\mathsf{f}:\wh{\text{Gr}}(\mathscr{C})\rightarrow \text{Gr}(\mathscr{C})$
which just forgets the orientations.  Given a covering set $\bm{\Psi}$ with associated equivalence 
$\Gamma:X\rightarrow \mathscr{C}$ and section functor $\wh{\mathsf{T}}$ of $\wh{\text{Gr}}(\mathscr{C})\rightarrow \mathscr{C}_\infty$
we can define a pull-back denoted by $T\Gamma^\ast\mathsf{T}$, as follows.  If $x\in X$ is smooth first evaluate $\mathsf{T}$ on 
the image $\Gamma(x)$ giving the formal sum $\sum \sigma_{\wh{L}} \wh{L}$, and then taking the preimages under the linear sc-operator
$T\Gamma(x):T_xX\rightarrow T_{\Gamma(x)}\mathscr{C}$. We define accordingly
$$
(T\Gamma^\ast\wh{\mathsf{T}})(x):= T\Gamma(x)^{-1}\left(\wh{\mathsf{T}}(\Gamma(x))\right).
$$
\begin{definition}\label{DEFX1746}
Let $\mathscr{C}$ be a polyfold and $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ 
be a branched ep$^+$-subcategory with the section  functor $\mathsf{T}_\Theta$ of $\text{Gr}(\mathscr{C})\rightarrow \mathscr{C}_\infty$. An orientation 
for $\Theta$ is a section functor $\wh{\mathsf{T}}_\Theta$ of $\wh{\text{Gr}}(\mathscr{C})\rightarrow \mathscr{C}_\infty$ such that
$$
\mathsf{f}\circ \wh{\mathsf{T}}_\Theta = \mathsf{T}_\Theta,
$$
having the additional property that for a covering set $\bm{\Psi}$ with associated
$\Gamma:X\rightarrow \mathscr{C}$ the pull-back $T\Gamma^\ast \wh{\mathsf{T}}_\Theta$
is an orientation for $\Gamma^\ast \Theta$ in the ep-groupoid sense according to Definition \ref{DEFNC932}.
\qed
\end{definition}
\begin{remark}
The part of Definition \ref{DEFX1746} requiring that he pull-back $T\Gamma^\ast \wh{\mathsf{T}}_\Theta$
is an orientation for $\Theta\circ\Gamma$ can be replaced by requiring that for an object $\alpha$ in $\supp(\Theta)$ and $\Psi\in F(\alpha)$
the pull back $T\Psi^\ast \wh{\mathsf{T}}_\Theta$ is an orientation for $\Theta\circ\Psi.$
\qed
\end{remark}

\section{Sc-Differential Forms and Stokes}
Let $\mathscr{C}$ be a polyfold. Our next goal is the definition of sc-differential forms on $\mathscr{C}$ and the associated de Rham complex.
Denote by $P:T\mathscr{C}\rightarrow \mathscr{C}^1$ the tangent bundle. On the categorical level we can build the $k$-fold
Whitney sum
$$
\oplus^k T\mathscr{C}\rightarrow \mathscr{C}_1.
$$
\begin{proposition}\index{P- Whitney sum polyfold bundle structure}
If $\mathscr{C}$ is a polyfold the $k$-fold Whitney sum has a natural structure as polyfold bundle
$$
\oplus^k T\mathscr{C}\rightarrow \mathscr{C}^1.
$$
\end{proposition}
\begin{proof}
Pick an object $\alpha$ in $\mathscr{C}_1$ and $\Psi\in F(\alpha)$, say $\Psi:G\ltimes O\rightarrow \mathscr{C}$.   Then $T\Psi$ fits into the commutative diagram
$$
\begin{CD}
TO @> T\Psi >> T\mathscr{C}\\
@V p VV   @V P VV\\
O^1 @> \Psi^1>> \mathscr{C}^1.
\end{CD}
$$
The collection of such $T\Psi$ defines the polyfold bundle structure for $T\mathscr{C}\rightarrow \mathscr{C}^1$ inducing 
the existing structure on $\mathscr{C}^1$.  

Given a morphism $(g,h)$ in $G\ltimes TO$, where $g\in G$ and $h\in T_qO$,  we have that 
$$
T\Psi(g,h)= (T\Psi(h),\Psi(g,q),T(\Psi(g,q))(T\Psi(h))).
$$
Here $T(\Psi(g,q))$ is the tangent of $\Psi(g,q):q\rightarrow g\ast q$.
 The $k$-fold Whitney sum $\oplus^k TO$ has the structure of a M-polyfold bundle 
over $O^1$, see Section \ref{subs_sc_differential}.
 We shall define $\oplus^kT\Psi$ covering $\Psi^1$ so that this data defines the structure for $
\oplus^k T\mathscr{C}\rightarrow \mathscr{C}_1$.  These functors
$$
\oplus^k T\Psi: G\ltimes \oplus ^k TO\rightarrow \oplus^k T\mathscr{C}
$$
are given as follows.  On objects 
$(h_1,...,h_k)$, where $h_i\in T_qO$,
$$
(\oplus^k T\Psi)(h_1,...,h_k)=(T\Psi(h_1),...,T\Psi(h_k)).
$$
A morphism $(g,(h_1,...,h_k)):(h_1,..,h_k)\rightarrow (g\ast h_1,...,g\ast h_k)$ is mapped as
\begin{eqnarray*}
&&(\oplus^k T\Psi)(g,(h_1,...,h_k))\\
& =&((T\Psi(h_1),\Psi(g,x),T(\Psi(g,x))(T\Psi(h_1))),......,\\
&&\ \ \ \ \ \ \ \ \ \ \ (T\Psi(h_k),\Psi(g,x),T(\Psi(g,x))(T\Psi(h_k)))).
\end{eqnarray*}
Given an object $\alpha$ of regularity $1$ we can associate to it the set consisting of all
$\oplus^k T\Psi$ where $\Psi$ varies over $F(\alpha)$. These cover $\Psi^1$ and fit into the commutative diagram
$$
\begin{CD}
\oplus^k TO @> \oplus^k T\Psi >> \oplus^k T\mathscr{C}\\
@V \oplus^k p VV   @V \oplus^k P VV\\
O^1 @> \Psi^1 >> \mathscr{C}^1.
\end{CD}
$$
The transition sets 
$\bm{M}(\oplus^k T\Psi,\oplus^k T\Psi')$ can be identified with a $k$-fold Whitney sum 
of $\bm{M}(T\Psi,T\Psi')\rightarrow\bm{M}(\Psi^1,\Psi'^1)$ which allows to define the bundle structure. This equips $\bm{M}(\oplus^k T\Psi,\oplus^k T\Psi')\rightarrow \bm{M}(\Psi^1,\Psi'^1)$ with the structure of a M-polyfold bundle and metrics for the orbit spaces.
It follows immediately that the source and target maps are sc-smooth local bundle isomorphisms.
 Clearly
$\oplus^k T\mathscr{C}$ is a GCT and it is easily verified  that the  $\oplus^kT\Psi$ together with the $\Psi^1$
have the polyfold bundle uniformizer properties.  
 \qed \end{proof}
Next we consider functors $\omega:\oplus^k T\mathscr{C}\rightarrow {\mathbb R}$ which are skew-symmetric, 
so that for $T\Psi$ the functor $\omega_{\,\Psi}:= \omega\circ (T\Psi\oplus..\oplus T\Psi)$ is sc-smooth 
$$
\omega_{\,\Psi}: TO\oplus..\oplus TO\rightarrow {\mathbb R}.
$$
Notationally we shall use the abbreviation
$$
\Psi^\ast \omega := \omega\circ \oplus^k T\Psi.
$$
If $\omega$ is such that $\omega_{\,\Psi}$ is sc-smooth for a covering set of uniformizers, then the smoothness holds
for any uniformizer coming from $F$. 
\begin{definition}
Assume a functor $\omega:\oplus^k T\mathscr{C}\rightarrow {\mathbb R}$, which is skew-symmetric and linear in each argument, 
is given. We say that $\omega$ is {\bf sc-smooth} provided there exists a covering set of uniformizers $\bm{\Psi}$
so that $\omega_{\,\Psi}$ is sc-smooth for every $\Psi\in \bm{\Psi}$.  We denote by $\Omega^k(\mathscr{C})$ the real vector space
consisting of the functors $\omega$ just defined.
\qed
\end{definition}
If $\mathscr{C}$ is equipped with a polyfold structure the same is true for $\mathscr{C}^i$, where $i=0,1,....$,
and the inclusion functors 
$$
\mathscr{C}^{i+1}\rightarrow \mathscr{C}^i
$$
are sc-smooth. Indeed, for  a uniformizer $\Psi$ we obtain the commutative diagram
$$
\begin{CD}
O^{i+1}  @>\Psi^{i+1}>> \mathscr{C}^{i+1}\\
@V\text{incl}VV   @V\text{incl} VV\\
O^{i} @>\Psi^{i}>>  \mathscr{C}^{i}
\end{CD}
$$
from which we see that the local representative for the inclusion $\text{incl}$ is an sc-smooth inclusion $O^{i+1}\rightarrow O^i$.
We can pass to tangents giving us
$$
\begin{CD}
T(O^{i+1}) @> T(\Psi^{i+1}) >> T(\mathscr{C}^{i+1})\\
@V VV @VVV\\
T(O^i) @> T(\Psi^i) >>  T(\mathscr{C}^i)
\end{CD}
$$
Here the vertical maps are inclusions. Given $\omega$ on $\oplus^k T(\mathscr{C}^i)$ we can pull it back to $\oplus^k T(\mathscr{C}^{i+1})$.
Hence we obtain 
$$
\Omega^k(\mathscr{C})\rightarrow\Omega^k(\mathscr{C}^1)\rightarrow....
$$
and can pass to the direct limit denoted by $\Omega^k_\infty(\mathscr{C})$. This can be done for every integer $k\geq 0$ and we define
$\Omega^\ast_\infty(\mathscr{C})$ to be the direct sum of all the $\Omega^k_\infty(\mathscr{C})$.
An element is denoted by $[\omega]$. We shall call $[\omega]$ {\bf homogeneous}\index{Homogeneous element} provided it belongs to some $\Omega^k_\infty(\mathscr{C})$. 
An element $[\omega]\in \Omega^k_\infty(\mathscr{C})$ has representatives $\omega$ 
defined on $\Omega^k(\mathscr{C}^i)$ which are of class sc$^i$. 

Recall from Section \ref{subs_sc_differential} that the exterior derivative
$d:\Omega^k(O^{i+1})\rightarrow \Omega^{k+1}(O^i)$ is well-defined and as a consequence 
we obtain
$$
d:\Omega^k_\infty(O)\rightarrow \Omega^{k+1}_\infty(O)
$$
by having $d$ act on $[\omega]$ via $d([\omega])=[d\omega]$. Using this fact we can define
$d$ on $\Omega^\ast_\infty(\mathscr{C})$ via uniformizers as $[\omega]\rightarrow [d\omega]$, where,
assuming the homogeneous case, 
for a representative $\omega$ in $\Omega^k(\mathscr{C}^{i+1})$ the representative $d\omega\in \Omega^{k+1}(\mathscr{C}^i)$ is given by
\begin{eqnarray}
 (d\omega)\circ \oplus^{k+1} T\Psi =  d(\omega\circ \oplus^kT\Psi)
\end{eqnarray}
for every uniformizer $\Psi$ or equivalently  (viewed on the right $i$-level) 
$$
\Psi^\ast d\omega = d(\Psi^\ast\omega).
$$
Again one only needs a covering set of unifomizers.  As a consequence, alternatively we can defined $d$ by taking a covering set $\bm{\Psi}$ of uniformizers and assume that $[\omega]$ is a homogeneous 
element in $\Omega^k_\infty(\mathscr{C})$. Associated to the covering set we have the sc-smooth model $X$ and equivalence
$$
\Gamma:X\rightarrow \mathscr{C}.
$$
We can represent a homogeneous $[\omega]$ for a $i\geq 2$ by some $\omega\in \Omega^k(\mathscr{C}^i)$. Then $\Gamma^\ast\omega =\omega\circ \oplus^kT\Gamma$ is at least sc$^1$ and defined on $T(X^i)\oplus..\oplus T(X^i)\rightarrow X^{i+1}$.
On the ep-groupoid we can apply the exterior derivative to obtain $d(\Gamma^\ast\omega)$ and we can push the result forward.
Then the definition $d[\omega] =[\Gamma_\ast d(\Gamma^\ast\omega)]$ is independent of the choices involved and it follows  that $d\circ d=0$ since it holds for ep-groupoids.
\begin{definition}\index{D- de Rham complex}
Let $\mathscr{C}$ be a GCT equipped with a polyfold structure $(F,\bm{M})$. Then 
$(\Omega^\ast_\infty(\mathscr{C}),d)$ is called the {\bf de Rham complex} associated to the polyfold $\mathscr{C}$.
\end{definition}

Having introduced sc-differential forms on polyfolds and oriented branched ep$^+$-subcategories we can introduce $\oint_{\wh{\Theta}}[\omega]$,
which is the integration of an sc-differential form over an oriented tame branched ep$^+$-subcategory provided the latter has a support with a compact orbit space. The definition of such an integration is being done via the use of an sc-smooth model, so that we can employ the results from Section \ref{IandST}. 
\begin{theorem}\label{THJK1754}
Assume that $[\omega]\in \Omega^k_\infty(\mathscr{C})$ and $\wh{\Theta}:\mathscr{C}\rightarrow {\mathbb Q}^+$ is a tame, oriented, branched ep$^+$-subcategory so that $\supp(\Theta)$ has a compact orbit space. Given a covering set $\bm{\Psi}$ with associated 
sc-smooth model $X$ and equivalence $\Gamma:X\rightarrow \mathscr{C}$ introduce the oriented $\Theta\circ\Gamma$, $\Gamma^\ast\wh{\mathsf{T}}_\Theta$, abbreviated by $\wh{\Theta}_{\,\bm{\Psi}}$
and the sc-smooth differential form $[\omega_{\,\bm{\Psi}}]=[\Gamma^\ast\omega]$. Then the branched integral in the ep-groupoid sense 
$$
\oint_{{\wh{\Theta}}_{\,\bm{\Psi}}}[\omega_{\,\bm{\Psi}}]
$$
has a value which is independent of the choice of the covering family $\bm{\Psi}$.  In particular the definition 
$$
\oint_{\wh{\Theta}} [\omega]:= \oint_{{\wh{\Theta}}_{\,\bm{\Psi}}}[\omega_{\,\bm{\Psi}}]
$$
is independent of the choice of $\bm{\Psi}$.
\end{theorem}
\begin{proof}
The basic input comes from Section \ref{SECRTY114}, where the compatibility of the relevant notions 
with respect to equivalences was discussed in depth.  Assume that we have taken two different covering sets of uniformizers $\bm{\Psi}$ and $\bm{\Psi}'$ resulting in two sc-smooth models and 
equivalences 
$$
\Gamma:X\rightarrow \mathscr{C}\ \ \text{and}\ \ \Gamma':X'\rightarrow \mathscr{C}.
$$
Denote by $\mathfrak{f}:X\rightarrow X'$ the associated natural generalized isomorphism. 
Considering $\wh{\Theta}_\Gamma:=(\Gamma^\ast\Theta$, $\Gamma^\ast\wh{\mathsf{T}}_\Theta)$ and
$\wh{\Theta}_{\Gamma'}:=(\Gamma'^\ast\Theta$, $\Gamma'^\ast\wh{\mathsf{T}}_\Theta)$ 
we note that 
$$
\mathfrak{f}^\ast\wh{\Theta}_{\Gamma'} =\wh{\Theta}_\Gamma.
$$
Similarly with $[\omega_{\,\bm{\Psi}}]$ and $[\omega_{\,\bm{\Psi}'}]$ being the pull-back forms
it holds hat
$$
\mathfrak{f}^\ast[\omega_{\,\bm{\Psi}'}]=[\mathfrak{f}^\ast\omega_{\,\bm{\Psi}'}]=[\omega_{\,\bm{\Psi}}].
$$
Applying Theorem \ref{THM1141} we compute with $K=|\supp(\Theta)|$
\begin{eqnarray*}
 \oint_{\wh{\Theta}_{\,\bm{\Psi}}}[\omega_{\,\bm{\Psi}}]&:=& \oint_{\wh{\Theta}_{\,\bm{\Psi}}}\omega_{\,\bm{\Psi}}
=\mu_{\omega_{\,\bm{\Psi}}}^{\wh{\Theta}_{\,\bm{\Psi}}}(|\Gamma|^{-1}(K))\\
&=& \mu_{\mathfrak{f}_\ast \omega_{\,\bm{\Psi}}}^{\mathfrak{f}_\ast\wh{\Theta}_{\,\bm{\Psi}}}(|\mathfrak{f}|\circ |\Gamma|^{-1}(K))=\mu_{\omega_{\,\bm{\Psi}'}}^{\wh{\Theta}_{\,\bm{\Psi}'}}(|\Gamma'|^{-1}(K))\\
&=&\oint_{\wh{\Theta}_{\,\bm{\Psi}'}}\omega_{\,\bm{\Psi}'}
=\oint_{\wh{\Theta}_{\,\bm{\Psi}'}}[\omega_{\,\bm{\Psi}'}].
\end{eqnarray*}
In view of this argument we can define $\oint_{\wh{\Theta}}[\omega]$ by picking a covering set of uniformizers and setting
\begin{eqnarray}
\oint_{\wh{\Theta}}[\omega] := \oint_{\wh{\Theta}_{\,\bm{\Psi}}}[\omega_{\,\bm{\Psi}}].
\end{eqnarray}
\qed \end{proof}
The  definition of the integral $\oint_{\wh{\Theta}}[\omega]$ is reduced to the computation of an integral
in the ep-groupoid setting, where we know that Stokes' Theorem holds. Hence it is not unreasonable to
expect that in our more general set-up a Stokes' Theorem holds as well, which turns out to be true.
In order to formulate the result we need to define a boundary integral based on a similar construction 
for ep-groupoids. 

First we need to introduce the boundary of $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$.
We start Given a  branched ep$^+$-subcategory $\wh{\Theta}:\mathscr{C}\rightarrow {\mathbb Q}^+$
defined on the polyfold $\mathscr{C}$. We take a covering set $\bm{\Psi}$ of uniformizers with associated sc-smooth model $X$ and equivalence $\Gamma:X\rightarrow{\mathbb Q}^+$.   Then $\Gamma^\ast\Theta:X\rightarrow{\mathbb Q}^+$
is a branched ep$^+$-subgroupoid and following Definition \ref{DEF9214} there is an associated
functor $\partial(\Gamma^\ast\Theta):X\rightarrow {\mathbb Q}^+$ with support in $\partial X$.
We define 
$$
\partial\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+: \alpha\rightarrow \Gamma_\ast(\partial(\Gamma^\ast\Theta).
$$
The definition does not depend on the choice of $\bm{\Psi}$. If $\bm{\Psi}'$ is a second covering family defining $\Gamma':X'\rightarrow \mathscr{C}$ we obtain the natural generalized isomorphism
$\mathfrak{f}:X\rightarrow X'$ which satisfies, as we recall $|\Gamma'|\circ |\mathfrak{f}|=|\Gamma$.
Since $\mathfrak{f}_\ast (\partial(\Gamma^\ast\Theta))=\partial(\Gamma'^\ast\Theta)$ in view of Theorem 
\ref{THMX1138} it follows that 
$$
\Gamma_\ast(\partial(\Gamma^\ast\Theta)=\Gamma'_\ast(\partial(\Gamma'^\ast\Theta)).
$$
\begin{definition}\index{D- Boundary $\partial\Theta$}
Assume that $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ is a branched ep$^+$-subcategory,
where $\mathscr{C}$ is a polyfold.  Then $\partial\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ defined 
via a covering family $\bm{\Psi}$ and associated $\Gamma:X\rightarrow \mathscr{C}$
by
$$
\partial\Theta : = \Gamma_\ast(\partial(\Gamma^\ast\Theta))
$$
is well-defined and independent of the choices and called the {\bf boundary} of $\Theta$.
\qed
\end{definition}
As already explained in the context of ep-groupoids, although $\partial\Theta$ is well-defined
it usually does not have very good differential geometric properties.  One needs to impose additional
requirements to make sure that $\partial\Theta$ is sufficiently nice.  
We recall that for a branched ep$^+$-subcategory $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$
the notions of being compact, tame, and oriented are well-defined.
As a consequence of  Theorem \ref{THM9510} and using that our relevant notions are well-behaved
under generalized isomorphisms 
we obtain the following theorem by arguments similar to those in the proof of Theorem 
\ref{THJK1754}.
\begin{theorem}\label{SOS1756}\index{T- Boundary integration}
Consider a polyfold  $\mathscr{C}$ and $\wh{\Theta}:\mathscr{C}\rightarrow {\mathbb Q}^+$ 
which is an oriented, tame, compact, branched ep$^+$-subcategory of dimension $n$. Let the orientation of $\Theta$ be given by $\wh{\mathsf{T}}_{\Theta}:\mathscr{C}_\infty\rightarrow \wh{\text{Gr}}(\mathscr{C})$.
Denote by $\partial\wh{\Theta}$ the boundary of $\Theta$ equipped with the induced
orientation $\wh{\mathsf{T}}_{\partial\Theta}$.  Given $[\omega]\in \Omega^{n-1}_\infty(\mathscr{C})$ there is a well-defined integral $\oint_{\partial\wh{\Theta}}[\omega]$. This integral is defined by taking 
a covering set $\bm{\Psi}$ with associated $\Gamma:X\rightarrow \mathscr{C}$ via
$$
\oint_{\partial\wh{\Theta}}[\omega] := \oint_{\partial(\Gamma^\ast\wh{\Theta})}[\omega_{\,\bm{\Psi}}],
$$
and the definition does not depend on the choice of the covering family.
\qed
\end{theorem}
Having Theorem \ref{THJK1754} and Theorem \ref{SOS1756} in place we can state the
Stokes Theorem. The proof is immediate since the statement is equivalent to the the ep-groupoid version.
\begin{theorem}[Stokes Theorem]\index{T- Stokes Theorem in polyfolds}
Let $\mathscr{C}$ be a polyfold and $\wh{\Theta}:\mathscr{C}\rightarrow {\mathbb Q}^+$ 
a tame, compact, oriented, branched ep$^+$-subcategory of dimension $n$. For  $[\omega]\in\Omega^{n-1}_\infty(\mathscr{C})$ the following identity holds.
\begin{eqnarray}
\oint_{\wh{\Theta}}d[\omega] =\oint_{\partial\wh{\Theta}} [\omega].
\end{eqnarray}
\end{theorem}
The Stokes Theorem plays an important role when defining invariants of moduli spaces obtained
as from solution categories of sc-Fredholm section functors after a slight perturbation by an sc$^+$-multisection functor.


 \section{Strong Bundle Structures}\label{CHAP176-}

The strong bundles over polyfolds, which we are going to consider arise in the following  way.
We denote by $\mathscr{C}$ a GCT equipped with a polyfold structure $(F,\bm{M})$ and we assume 
we are given a functor $\mu:\mathscr{C}\rightarrow \text{Ban}$. We shall abbreviate $\wh{\phi}:=\mu(\phi)$ 
and consider a category $\mathscr{E}=\mathscr{E}_\mu$, whose objects are pairs $(\alpha,e)$, where $e\in\mu(\alpha)$.
A morphism in $\mathscr{E}$ is a pair $(\phi,e)$, where $e\in \mu(s(\phi))$ and $(\phi,e)$ is  seen as
$$
(\phi,e):(s(\phi),e)\rightarrow (t(\phi),\wh{\phi}(e)),
$$
covering the underlying $\phi$
$$
\begin{CD}
(s(\phi),e) @> (\phi,e)>> (t(\phi),\wh{\phi}(e))\\
@VVV @VVV\\
s(\phi) @>\phi >> t(\phi).
\end{CD}
$$
We shall denote by $P:\mathscr{E}\rightarrow \mathscr{C}$ the natural projection functor which on objects takes the form
$P(\alpha,e)=\alpha$ and on morphisms $P(\phi,e)=\phi$.  The preimage of an object $\alpha$ is a Banach space, where the vector space operations are defined
$$
(\alpha,e)+\lambda\cdot (\alpha,e')=(\alpha,e+\lambda\cdot e').
$$
We also note that for a  given morphism the preimage $P^{-1}(\phi)$ is a Banach space, where the operations are defined similarly by
$$
(\phi,e)+\lambda\cdot (\phi,e')=(\phi,e+\lambda\cdot e').
$$
\begin{definition}[Vector Bundle GCT]\index{D- Vector bundle GCT}
Let $\mathscr{C}$ be a GCT. A {\bf vector bundle GCT} over $\mathscr{C}$ consists of a functor 
$\mu:\mathscr{C}\rightarrow \text{Ban}$ and a metrizable topology ${\mathcal T}$ on $|\mathscr{E}_\mu|$ such that the following holds. 
\begin{itemize}
\item[(1)]\ \ For every object $\alpha$ the natural map $P^{-1}(\alpha)\rightarrow |\mathscr{E}|$ is continuous.
\item[(2)] \ \ The map $|P|:|\mathscr{E}|\rightarrow |\mathscr{C}|$ is surjective, continuous and open.
\end{itemize}
\qed
\end{definition}
We would like to equip $P:\mathscr{E}\rightarrow \mathscr{C}$ with what we shall call the structure of a strong bundle over a polyfold for which the sc-smooth models are
strong bundles over ep-groupoids, which have been introduced previously.
To explain this we consider as the building blocks the  strong local bundles
$K\rightarrow O$ equipped with an action by strong bundle isomorphisms of a finite group $G$.  Hence we obtain translation groupoids fibering over each other
$$
p\colon G\ltimes K\rightarrow G\ltimes O.
$$
Then $p$ is a functor which on objects maps $h\in K_x$ to $x$ and maps the morphism $(g,h)$ to the morphism $(g,x)$.
Given an object $\alpha$ in $\mathscr{C}$, we are interested in functors  
$$
\bar{\Psi}:G\ltimes K\rightarrow \mathscr{E},
$$
where $p:K\rightarrow O$ is a strong bundle over the M-polyfold $O$ and the $G$-action on $O$ lifts to an action by strong bundle 
maps $K\rightarrow K$. Moreover, $\bar{\Psi}$ is injective on objects, fully faithful and fiberwise a topological linear isomorphism.
In addition we require that for a suitable $q\in O$ we have that $\bar{\Psi}(0_q)=(\alpha,0)$.
By mapping $q\in O$ first to $0_q\in K_q$ and then to $P(\bar{\Psi}(0_q))$ we obtain a functor
$$
\Psi: G\ltimes O\rightarrow \mathscr{C}
$$
which is injective on objects, and fully faithful. 
We obtain the commutative diagram
$$
\begin{CD}
G\ltimes K @>\bar{\Psi} >>   \mathscr{E}\\
@V p VV   @V P VV\\
G\ltimes O  @>\Psi >>   \mathscr{C}.
\end{CD}
$$  
Recall that by assumption we have a polyfold construction $(F,\bm{M})$ for $\mathscr{C}$. We can therefore say
that $\bar{\Psi}$ is compatible with the polyfold structure for $\mathscr{C}$ provided the underlying $\Psi$ belongs to $F(\alpha)$.


\begin{definition}\index{D- Strong polyfold bundle}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a vector bundle GCT, which is associated to a polyfold $\mathscr{C}$, a functor $\mu:\mathscr{C}\rightarrow \text{Ban}$ and a topology ${\mathcal T}$ on $|\mathscr{E}|$.
 A {\bf strong bundle uniformizer} for $P$ at the object $\alpha$ consists of a covariant functor
$\bar{\Psi}\colon G\ltimes K\rightarrow \mathscr{E}$ covering a $\Psi\in F(\alpha)$ that the following holds.
\begin{itemize}
\item[(1)]\   $G\ltimes K$ is the translation groupoid associated to the strong bundle $p:K\rightarrow O$ equipped with the action of a finite group by strong bundle isomorphisms.
\item[(2)] \  The functor $\bar{\Psi}$ is fully faithful and fiberwise a topological linear Banach space isomorphism, i.e.
for every $q\in O$ the map
$$
K_q \rightarrow P^{-1}(\Psi(\alpha)): k\rightarrow \bar{\Psi}(k)
$$
is a Banach space isomorphism.
\item[(3)] \ The induced map $|\bar{\Psi}|:|K|\rightarrow |\mathscr{E}|$ is a homeomorphism onto an open subset of the form $|P|^{-1}(U)$, covering the homeomorphism
$|\Psi|:|O|\rightarrow U$.
\end{itemize}
\qed
\end{definition}
The {\bf footprint}\index{Footprint} of $\bar{\Psi}$ is $|P|^{-1}(U)$ and it covers the {\bf base footprint}\index{Base footprint} $U$ of the underlying $\Psi$.  

\begin{definition}
Let $\mathscr{C}$ by a GCT equipped with a polyfold construction $(F,\bm{M})$ and assume $P:\mathscr{E}\rightarrow \mathscr{C}$
is a vector bundle GCT associated to $\mu:\mathscr{C}\rightarrow \text{Ban}$ and the topology ${\mathcal T}$. A {\bf compatible strong bundle uniformizer construction}
is given by a functor $\bar{F}:\mathscr{C}^-\rightarrow \text{SET}$ which associates to an object $\alpha$ a set $\bar{F}(\alpha)$ of strong bundle uniformizers
$$
\bar{\Psi}: G\ltimes K\rightarrow \mathscr{C},
$$
so that $(\alpha,0)$ is in the image and the induced $\Psi:G\ltimes O\rightarrow \mathscr{C}$ belongs to $F(\alpha)$.
\qed
\end{definition}
It is clear that given two strong bundle uniformizers $\bar{\Psi}$ and $\bar{\Psi}'$ we can form the transition set
$\bm{M}(\bar{\Psi},\bar{\Psi}')$ defined as a the weak fibered product associated to the diagram
$$
K\xrightarrow{\bar{\Psi}}\mathscr{E}\xleftarrow{\bar{\Psi}'} K'.
$$
Hence an element takes the form $(k,(\phi,\bar{\Psi}(k)),k')$ with $\phi:\Psi(p(k))\rightarrow \Psi'(p'(k'))$ being a morphism in $\mathscr{C}$ and $\bar{\Psi}'(k') =\mu(\phi)(\bar{\Psi}(k))$.
With $\Psi$ and $\Psi'$ being the underlying uniformizers we obtain a natural map
$$
\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'): (k,(\phi,\bar{\Psi}(k)),k')\rightarrow (p(k),\phi,p'(k')),
$$
where the fibers are Banach spaces in a natural way.  
We leave it to the reader to write down all the usual structural maps 
which are assumed to be fiberwise linear. For example the source maps fit into the commutative diagram
$$
\begin{CD}
\bm{M}(\bar{\Psi},\bar{\Psi}') @> s>>  K\\
@VVV @V p VV\\
\bm{M}(\Psi,\Psi') @> s>> O.
\end{CD}
$$
Finally we can define what it means to have a strong bundle construction. 
\begin{definition}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a vector bundle GCT, which is associated to a polyfold $\mathscr{C}$
and a functor $\mu:\mathscr{C}\rightarrow \text{Ban}$ and a topology ${\mathcal T}$ on $|\mathscr{E}|$.  A {\bf strong polyfold bundle construction}
for $P:\mathscr{E}\rightarrow \mathscr{C}$ compatible with the polyfold structure $(F,\bm{M})$ for the GCT $\mathscr{C}$ consists of a functor
$\bar{F}:\mathscr{C}^-\rightarrow \text{SET}$ associating to an object $\alpha$ a set of strong bundle uniformizers 
$$
\bar{\Psi}:G\ltimes K\rightarrow \mathscr{E}
$$
at $\alpha$ so that the underlying functors $\Psi:G\ltimes O\rightarrow \mathscr{C}$ belong to $F(\alpha)$. In addition we are given a strong bundle construction 
for every 
$$
\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'),
$$
 where the structure on the base is the already existing one 
coming from the polyfold structure for $\mathscr{C}$. The data $(\bar{F},\bm{M})$ has the property that for the strong bundle structures
all structural maps are strong bundle maps and have the usual properties, listed below for the reader, otherwise. We shall call $(\bar{F},\bm{M})$ a {\bf strong polyfold bundle structure}\index{D- Strong polyfold bundle structure}
for $P:\mathscr{E}\rightarrow \mathscr{C}$ compatible with the polyfold structure $(F,\bm{M})$ for $\mathscr{C}$.
\qed
\end{definition}
Assume we are given the polyfold $\mathscr{C}$, the functor $\mu:\mathscr{C}\rightarrow\text{Ban}$
and the topology ${\mathcal T}$ for $|\mathscr{E}|$.  If $(\bar{F},\bm{M})$ is the strong polyfold bundle construction (covering $(F,\bm{M})$) we are in the following situation.  Every transition set 
$\bm{M}(\bar{\Psi},\bar{\Psi}')$ comes equipped with a strong bundle structure for 
$\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')$, with the induced structure on the base being
the already existing one.  The source and target maps form sc-smooth strong bundle maps, which are local strong bundle isomorphisms
$$
\begin{CD}
K @< s<<  \bm{M}(\bar{\Psi},\bar{\Psi}')@>t>>  K'\\
@V p VV    @VVV @V p'VV\\
O @< s<<   \bm{M}(\Psi,\Psi') @> t>> O'.
\end{CD}
$$
The inversion map $\iota$ defined by $\iota(k,(\phi,\bar{\Psi}(k)),k')=(k',(\phi^{-1},\bar{\Psi}'(k')),k)$
covers the inversion map on the base and is an sc-smooth strong bundle isomorphism
$$
\begin{CD}
\bm{M}(\bar{\Psi},\bar{\Psi}')@>\iota>> \bm{M}(\bar{\Psi}',\bar{\Psi})\\
@VVV @VVV\\
\bm{M}(\Psi,\Psi') @>\iota>> \bm{M}(\Psi',\Psi).
\end{CD}
$$
The unit map $u$ is an sc-smooth strong bundle map fitting into the diagram
$$
\begin{CD}
K @> u>>  \bm{M}(\bar{\Psi},\bar{\Psi})\\
@V p VV   @VVV \\
O@>u>>   \bm{M}(\Psi,\Psi).
\end{CD}
$$
Finally the multiplication map is an sc-smooth strong bundle map fitting into the commutative diagram
$$
\begin{CD}
\bm{M}(\bar{\Psi}',\bar{\Psi}''){_{s}\times_t}\bm{M}(\bar{\Psi},\bar{\Psi}')@>m>> \bm{M}(\bar{\Psi},\bar{\Psi}'')\\
@VVV  @VVV\\
\bm{M}({\Psi}',{\Psi}''){_{s}\times_t}\bm{M}({\Psi},{\Psi}')@>m>> \bm{M}({\Psi},{\Psi}'').
\end{CD}
$$


\section{Proper Covering Constructions}\label{SECV17.7}
In applications the covering construction is important and is closely related to the construction for ep-groupoids given in 
Section \ref{SQWERTY116}.
\begin{definition}\index{D- Proper covering functor}\label{DEFNX17.7.1}
Let $\mathscr{A}$ and $\mathscr{B}$ be two GCT's. We say 
 that  the functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$  is a {\bf proper covering  functor} of GCT's provided the following holds
 \begin{itemize}
 \item[(1)]\  $|\mathsf{P}|:|\mathscr{A}|\rightarrow |\mathscr{B}|$ is continuous and surjective.
 \item[(2)]\      $\mathsf{P}$   on objects is finite-to-one and surjective.
 \item[(3)]\   For every $z\in |\mathscr{B}|$ and the points $y_1,...,y_k\in |\mathsf{P}|^{-1}(z)$
 there exists an open neighborhood $U(z)$ and mutually disjoint open neighborhoods $U(y_i)$ 
 such that
 $$
 |\mathsf{P}|^{-1}(U(z))= \bigcup_{i=1}^k U(y_i).
 $$
 \item[(4)] \  The map $\bm{A}\rightarrow \bm{B}{_{s}\times_{\mathsf{P}}}A:\phi\rightarrow (\mathsf{P}(\phi),s(\phi))$ is a bijection.
 \end{itemize}
Here $\bm{A}$ and $\bm{B}$ stand for the morphism classes and $A$ for the object class.
\qed
\end{definition}
Our aim is to equip $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ with an sc-smooth structure
which reflects the covering property, and  in addition defines polyfold structures for $\mathscr{A}$ and $\mathscr{B}$.  

\begin{remark}\index{R- On uniformizer constructions for GCT's}
Recall that a uniformizer construction for a GCT $\mathscr{C}$ can be viewed as follows.  Given an object $\alpha$
we obtain the associated category having this single object $\alpha$ and as morphisms the isotropy group $G=G_\alpha$.  We write it as $G\ltimes\{\alpha\}$.
Then the uniformizer construction consists of a method of associating to the object $\alpha$ a M-polyfold
$O$ and to the morphisms a representation in $\text{Diff}_{sc}(O)$, together with a functor from 
the associated translation groupoid $G\ltimes O$ into $\mathscr{C}$. The construction $\bm{M}$
then `certifies' the compatibility of the various uniformizers. The construction we need for $\mathsf{P}$ generalizes this picture,  
and the basic building blocks have already been  described in Definition \ref{DEFR845} with the basic idea
of a geometric lift.
\qed
\end{remark}

Starting with $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ we pick an object $\beta$ in $\mathscr{B}$ and note
that $\mathsf{P}^{-1}(\beta)$ consists of finitely many objects $\alpha_1,..,\alpha_k$.  Consider the associated
full subcategory denoted by $\mathscr{A}_\beta$ with object set $A_\beta=\{\alpha_1,..,\alpha_k\}$.
The functor $\mathsf{P}$ induces the covering functor
\begin{eqnarray}\label{EQN1713}
\mathsf{P}_\beta:\mathscr{A}_\beta\rightarrow G_\beta\ltimes \{\beta\}.
\end{eqnarray}
In order to define the uniformizers we have to describe the type of  domains we would like to have. The domains should be geometric lifts of the covering functor $\mathsf{P}_{\beta}$ in (\ref{EQN1713}) in the sense of Definition \ref{DEFR845}. 
The only difference is that we shall use pointed spaces as objects.
\begin{definition}
We denote by $\text{Diff}_{sc}^\ast$
the category whose objects are M-polyfolds together with a distinguished point and the morphisms are sc-diffeomorphisms preserving the distinguished points.
More precisely, an object in $\text{Diff}_{sc}^\ast$\index{$\text{Diff}_{sc}^\ast$} is a pair $(O,o)$ with $O$ being a M-polyfold and $o\in O$. 
A morphism $f:(O,o)\rightarrow (O',o')$ is an sc-diffeomorphism $f:O\rightarrow O'$ with $f(o)=o'$.
\qed
\end{definition}\index{D- Category $\text{Diff}_{sc}^\ast$}

The relevant domains for our upcoming functor constructions are associated 
to the following functorial data.
\begin{itemize}
\item[(i)] \ \ A choice of  functors $\mathsf{A}: \mathscr{A}_\beta\rightarrow \text{Diff}^\ast_{sc}$ and $\mathsf{B}:G_\beta\ltimes \{\beta\}\rightarrow \text{Diff}_{sc}^\ast$.
\item[(ii)]\ \   A natural transformation $\tau:\mathsf{A}\rightarrow \mathsf{B}\circ \mathsf{P}_\beta$.
\end{itemize}
The functor $\mathsf{B}$  associates to the (single) object $\beta$  a pointed M-polyfold $(O_\beta,o_\beta)$ with distinguished point $o_\beta\in O_\beta$.
To  a morphism $g\in G_\beta$ it associates an sc-diffeomorphism
$$
g \ast : (O_\beta,o_\beta)\rightarrow (O_\beta,o_\beta): q\rightarrow g\ast q
$$
preserving $o_\beta$. The functoriality guarantees that $g\ast(h\ast q)=(g\circ h)\ast q$.
This data will define the ep-groupoid $G_\beta\ltimes O_\beta$, which contains the distinguished object $o_\beta$.

 Associated to an object $\alpha$ in $\mathscr{A}_\beta$ we have a pointed M-polyfold
$({O}_\alpha,{o}_a)$ and associated to a morphism ${\phi}:\alpha\rightarrow \alpha'$ an sc-diffeomorphism
$$
\phi\ast:(O_\alpha,o_\alpha)\rightarrow (O_{\alpha'},o_{\alpha'}):o\rightarrow \phi\ast o.
$$
Again functoriality implies if $s(\phi')=t(\phi)$ that $\phi'\ast (\phi\ast q)=(\phi'\circ\phi)\ast q$
for $q\in O_{s(\phi)}$.
The natural transformation $\tau:\mathsf{A}\rightarrow \mathsf{B}\circ \mathsf{P}_\beta$ defines an
sc-diffeomorphisms for every object $\alpha$ in $\mathscr{A}_\beta$
$$
\tau_\alpha:(O_\alpha,o_\alpha)\rightarrow (O_\beta,o_\beta),
$$
so  that we obtain  for every morphism $\phi:\alpha\rightarrow \alpha'$ in $\mathscr{A}_\beta$  a commutative diagram of sc-diffeomorphisms
$$
\begin{CD}
(O_\alpha,o_\alpha) @>\phi\ast >> (O_{\alpha'},o_{\alpha'})\\
@V\tau_\alpha VV   @V \tau_{\alpha'} VV\\
(O_\beta,o_\beta) @> (\mathsf{P}_\beta(\phi))\ast >> (O_\beta,o_\beta).
\end{CD}
$$
We can take the disjoint union of the $O_\alpha$ denoting it by $E$, i.e.
\begin{eqnarray}
E=\bigsqcup_{\alpha\in \mathsf{P}^{-1}(\beta)} O_\alpha,
\end{eqnarray}
 and view it as
the object M-polyfold of an ep-groupoid, where the morphisms are pairs
$(\phi,o)$, $\phi\in \bm{A}_\beta$ with $o\in O_{s(\phi)}$, $s(\phi,o)=o$ and $t(\phi,o)=\phi\ast o$, i.e.
$$
(\phi,o):o\rightarrow \phi\ast o.
$$
We denote the morphism set by $\bm{E}$. It is the disjoint union
of all $\{\phi\}\times O_{s(\phi)}$, where $\phi$ varies over the morphisms 
in $\mathscr{A}_\beta$
\begin{eqnarray}
\bm{E} =\bigsqcup_{\phi\in \bm{A}_\beta} \left(\{\phi\}\times O_{s(\phi)}\right).
\end{eqnarray}
Each of the sets $\{\phi\}\times O_{s(\phi)}$ carries
a natural M-polyfold structure coming from the identification with $O_{s(\phi)}$. 
Hence $\bm{E}$ has a natural M-polyfold structure.
It is a trivial exercise to equip $E\equiv (E,\bm{E})$
with the structure of an ep-groupoid. The source map is given by $s(\phi,o)=o$
and the target map by $t(\phi,o)=\phi\ast o$.  We have the natural local sc-diffeomorphism on the object level
\begin{eqnarray}\label{EQNX11.75}
\wh{\tau}:E\rightarrow O_\beta
\end{eqnarray}
mapping $o\in O_\alpha$ to $\tau_\alpha(o)$. The preimages of the distinguished point $o_\beta$ in $O_\beta$ are
the distinguished points $o_\alpha\in O_\alpha$ for $\alpha\in A_{\beta}=\mathsf{P}^{-1}(\beta)$. 
 Then we can view $\wh{\tau}$ as a map
$$
\wh{\tau}:(E,A_\beta)\rightarrow (O_\beta,\beta).
$$
The morphisms 
$(\phi,o)$ are mapped by 
\begin{eqnarray}
\bm{\wh{\tau}}:\bm{E}\rightarrow G_\beta\times O_\beta: \bm{\wh{\tau}}(\phi,o)=(\mathsf{P}_\beta(\phi),\wh{\tau}(o)),
\end{eqnarray}
 which obviously is a local sc-diffeomorphism.  This together with (\ref{EQNX11.75}) shows that
 $\wh{\tau}\equiv (\wh{\tau},\bm{\wh{\tau}})$ defines a functor
\begin{eqnarray}
 \wh{\tau}:E\equiv (E,\bm{E})\rightarrow G_\beta\ltimes O_\beta.
\end{eqnarray}
 Finally we note that the map
$$
\bm{E}\rightarrow \text{mor}(G_\beta\ltimes O_\beta){_{s}\times_{\wh{\tau}}} E: (\phi,o)\rightarrow ((\mathsf{P}_\beta(\phi),\wh{\tau}(o)),o)
$$
is an sc-diffeomorphism. With other words $\wh{\tau}:E\rightarrow G_\beta\ltimes O_\beta$ is a proper covering map
between ep-groupoids of a particular form and it can be considered as a geometric lift of $\mathsf{P}_\beta:\mathscr{A}_\beta\rightarrow G_\beta\ltimes \{\beta\}$.  
The previous discussion motivates the next definition.
\begin{definition}\label{DEFQ1773}\index{D- Proper covering model}
A {\bf proper ep-groupoid covering model} consists of a translation groupoid $G\ltimes O$ associated to a finite group $G$ acting by sc-diffeomorphisms on a M-polyfold $O$, a distinguished point $\bar{o}\in O$ which is fixed by 
$G$, an ep-groupoid $E$, and a sc-smooth  functor $\wh{\tau}:E\rightarrow G\ltimes O$
having the following properties.
\begin{itemize}
\item[(1)]\  $\wh{\tau}:E\rightarrow O$ is a surjective local sc-diffeomorphism on the object level.
\item[(2)]\  For every $y\in \wh{\tau}^{-1}(\bar{o})$ there exists an open neighborhood $U(y)$
such that the $U(y)$ are mutually disjoint and
$$
\wh{\tau}^{-1}(O) = \bigcup_{y\in \wh{\tau}^{-1}(\bar{o})} U(y),
$$
and  for every such $y$ the map $\wh{\tau}:U(y)\rightarrow O$ is an sc-diffeomorphism.
\item[(3)] \  The map $\Gamma:\bm{E}\rightarrow (G\ltimes O){_{s}\times_{\wh{\tau}}}E$ given by
$$
\psi\rightarrow (\wh{\tau}(\psi),s(\psi))
$$
is an sc-diffeomorphism.
\end{itemize}
\qed
\end{definition}
\begin{remark}\label{REM17.7.5}
Compare the previous definition with Definition \ref{d-proper_covering} and the structural results
Theorem \ref{STRUC_1} and Theorem \ref{STRUC_2}.
\qed
\end{remark}
Let us show that the definition describes the previously discussed model in the case that the base M-polyfold is  connected.
Let $\wh{\tau}:E\rightarrow G\ltimes O$ be a proper ep-groupoid covering model in the sense 
of Definition \ref{DEFQ1773} with distinguished point $\bar{o}$. Suppose further that $O$ is connected. 
We consider the category $G\ltimes \{\bar{o}\}$ and denote by $\mathscr{A}_{\bar{o}}$
the full subcategory of $E$ associated to the object set $A_{\bar{o}}=\wh{\tau}^{-1}(\bar{o})$.
Denote by $\mathsf{P}:\mathscr{A}_{\bar{o}}\rightarrow G\ltimes\{\bar{o}\}$ the restriction of $\wh{\tau}$.
Using that $O$ is connected we infer that every $U(y)$ is connected. We associate to a morphism $\psi\in \bm{E}$ the pair $(y_{s(\psi)},y_{t(\psi)})\in A_{\bar{o}}^2$, so that
$$
s(\psi)\in U(y_{s(\psi)})\ \ \text{and}\ \ t(\psi)\in U(y_{t(\psi)}).
$$
\begin{lemma}
The map $\bm{E}\rightarrow A_{\bar{o}}^2:\psi\rightarrow (y_{s(\psi)},y_{t(\psi)})$ 
is locally constant, i.e. continuous.
\end{lemma}
\begin{proof}
The maps $\psi\rightarrow s(\psi)$ and $\psi\rightarrow t(\psi)$ are continuous and the sets $U(y)$
are open.  Hence the set of all $\psi$ with $(s(\psi),t(\psi))\in U(y)\times U(y')$
is open. 
\qed \end{proof}
Recall that the map
$$
\Gamma:\bm{E}\rightarrow (G\times O){_{s}\times_{\wh{\tau}}} E:\psi\rightarrow (\wh{\tau}(\psi),s(\psi))
$$
is a sc-diffeomorphism. For the following denote by $\tau_y:U(y)\rightarrow O$ the 
restriction of $\wh{\tau}$.  We obtain a map
$$
A_{\bar{o}}\rightarrow \text{mor}(\text{Diff}^\ast_{sc}):y\rightarrow \tau_y.
$$
For $\phi\in \bm{A}_{\bar{o}}$ denote by $\bm{E}_\phi$ the connected component
of $\bm{E}$ containing $\phi$. 
\begin{lemma}
If $\phi,\phi'\in \bm{A}_{\bar{o}}$ are two different elements then $\bm{E}_\phi\cap \bm{E}_{\phi'}=\emptyset$. Further we have the identity
$$
\bm{E} =\bigcup_{\phi\in \bm{A}_{\bar{o}}} \bm{E}_\phi.
$$
\end{lemma}
\begin{proof}
Take $\psi\in \bm{E}$ with $s(\psi)\in U(y)$ and $t(\psi)\in U(y')$. 
The map $\Gamma:{\bf E}\rightarrow (G\ltimes O){_{s}\times_{\wh{\tau}}}E:\psi\rightarrow (\wh{\tau}(\psi),s(\psi)) $ is a sc-diffeomorphism and denote the image of $\psi$ 
 by $((g_\psi,\wh{\tau}(s(\psi))),s(\psi))$.
Take a continuous path $\gamma:[0,1]\rightarrow O$ connecting
$\wh{\tau}(s(\psi))$ at time $a=0$ with $\bar{o}$ at time $1$, and consider the continuous path 
$$
[0,1]\rightarrow (G\times O)\times U(y): a\rightarrow ((g_\psi,\gamma(a)),\tau_y^{-1}(\gamma(a))).
$$
Then we obtain the continuous path
$$
[0,1]\rightarrow \bm{E}:a\rightarrow \Gamma^{-1}((g_\psi,\gamma(a)),\tau_y^{-1}(\gamma(a)))
$$
starting at $\psi$ and ending at the element $\phi_\psi:=\Gamma^{-1}((g_\psi,\bar{o}),y)$.
This shows that every $\psi$ belongs to some $\bm{E}_\phi$.

Assume next that $\phi,\phi'\in A_{\bar{o}}$ belong to the same path component. Take 
a continuous path $\wh{\gamma}$ connecting them. Then 
$$
\Gamma\circ \wh{\gamma}(a)= ((g_a,o_a),q_a).
$$
Clearly $g_a$ has to be independent of $a$ and we write $g=g_a$.
Then $\Gamma(\phi)=((g,\bar{o}),y)$ and $\Gamma(\phi')=((g,\bar{o}),y)$ which implies $\phi=\phi'$.
\qed \end{proof}
The maps $\psi\rightarrow y_{s(\psi)}$, $\psi\rightarrow y_{t(\psi)}$, and $\psi\rightarrow g_\psi$
are constant on $\bm{E}_\phi$.  Hence, if $\phi:y\rightarrow y'$, then 
$y_{s(\psi)}=y$, $y_{t(\psi)}=y'$, and $g_\psi= g_\phi$, where $\Gamma(\phi)=((g_\phi,\bar{o}),y)$.
\begin{lemma}
The following identity holds on $\bm{E}_\phi$, where $\phi:y\rightarrow y'$
$$
t(\psi)   = \tau_{y'}^{-1}(g_\phi \ast\tau_y(s(\psi))).
$$
\end{lemma}
\begin{proof}
If $\psi\in \bm{E}_\phi$, where $\phi:y\rightarrow y'$,  then
$\wh{\tau}(\psi) = (g_\phi,\wh{\tau}(s(\psi)))$ and consequently
$$
\tau_{y'}(t(\psi))=\wh{\tau}(t(\psi))=t(\wh{\tau}(\psi))= g_\phi\ast \wh{\tau}(s(\psi))=g_\phi\ast \tau_y(s(\psi)).
$$
This implies
$$
t(\psi)=\tau_{y'}^{-1}(g_\phi\ast \tau_y(s(\psi))).
$$
\qed \end{proof}
Given $\phi\in \bm{A}_{\bar{o}}$ we define the sc-diffeomorphism
$$
\phi\ast :U(s(\phi))\rightarrow U(t(\phi)): \phi\ast q =\tau_{t(\phi)}^{-1}(g_\phi\ast \tau_{s(\phi)}(q)).
$$
If $\phi,\phi'\in \bm{A}_{\bar{o}}$ with $t(\phi)=s(\phi')$ we compute
$$
(\phi'\circ\phi)\ast q = \phi'\ast(\phi\ast q)
$$
using that $(g_{\phi'\circ\phi},\bar{o})=\wh{\tau}(\phi'\circ\phi)=\wh{\tau}(\phi')\circ\wh{\tau}(\phi)=(g_{\phi'}g_\phi,\bar{o})$. We define the functor $\mathsf{A}:\mathscr{A}\rightarrow \text{Diff}^\ast_{\text{sc}}$ by
$y\rightarrow (U(y),y)$ and $\phi\rightarrow \phi\ast$. The functor $\mathsf{B}$ associates to $\bar{o}$ the pointed M-polyfold $(O,\bar{o})$.  The natural transformation $\tau:\mathsf{A}\rightarrow \mathsf{B}\circ\mathsf{P}$ associates to $y\in A$ the sc-diffeomorphism ${\tau}_y$. 
It is an easy exercise that the proper covering functor $\wh{\tau}: F\rightarrow G\ltimes O$ associated to the data $\mathsf{A},\mathsf{B},\tau$
is isomorphic to the $\wh{\tau}:E\rightarrow G\ltimes O$ we started with.








Next we are in the position to define the notion of uniformizer in the current context.
\begin{definition}\label{DEFR1774}\index{D- Proper covering uniformizer}
Let $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ be a proper covering functor between two GCT's. 
A {\bf proper covering uniformizer} at the object $\beta$  in $\mathscr{B}$ with isotropy $G=G_\beta$, consists of a pair of functors
$\wh{\Psi}:E\rightarrow \mathscr{A}$ and $\Psi:G\ltimes O_\beta\rightarrow \mathscr{B}$, where 
$\wh{\tau}:E\rightarrow G\ltimes O_\beta$ is a proper ep-groupoid covering model, see Definition \ref{DEFQ1773}, such that the following holds.
\begin{itemize}
\item[(1)]\  The distinguished point $o_\beta\in O_\beta$ is mapped by $\Psi$ to $\beta$, and the distinguished points $o_\alpha\in O_\alpha$ with $\alpha\in \mathsf{P}^{-1}(\beta)$ 
are mapped bijectively by $\wh{\Psi}$ to the points in $\mathsf{P}^{-1}(\beta)$.
\item[(2)]\   $\Psi$ and $\wh{\Psi}$ are fully faithful, injective on objects,  and fit into the commutative functor diagram
$$
\begin{CD}
E @>\wh{\Psi} >> \mathscr{A}\\
@V\wh{\tau} VV  @V \mathsf{P}VV\\
G\ltimes O_\beta@>\Psi>>  \mathscr{B}.
\end{CD}
$$
\item[(3)]\   On the object level the preimage of $\Psi(O_\beta)$ under $\mathsf{P}$ is the image of $\wh{\Psi}$.
\item[(4)]\  There exists an open neighborhood $U$ of $|\beta|$ in $|\mathscr{B}|$
such that $|\Psi|:|G\ltimes O_\beta|\rightarrow U$ and $|\wh{\Psi}|:|E|\rightarrow |\mathsf{P}|^{-1}(U)$
are homeomorphisms.
\end{itemize}
\qed
\end{definition}
We note that passing to orbit spaces we obtain the commutative diagram
$$
\begin{CD}
|E| @>|\wh{\Psi}| >> |\mathsf{P}|^{-1}(U)\\
@V|\wh{\tau}| VV  @V |\mathsf{P}|VV\\
|G\ltimes O_\beta|@>|\Psi|>> U.
\end{CD}
$$
Here the horizontal arrows are homeomorphisms. The local singularity structure of $|\mathsf{P}|$ is
that given by $|\wh{\tau}|$.
\begin{remark}
Let us also note that $\Psi:G\ltimes O_\beta\rightarrow \mathscr{B}$ is a uniformizer in the usual sense,
but that $\wh{\Psi}$ is not.  In fact, the latter is defined on a special ep-groupoid.
Note, however that the restrictions of $\wh{\Psi}$ to $G_{\alpha}\ltimes O_\alpha$ for $\alpha\in \mathsf{P}^{-1}(\beta)$
are uniformizers.  Nevertheless we shall refer to $\wh{\Psi}$ also as a uniformizer.
\qed
\end{remark}

\begin{definition}\label{DEFF1775}\index{D- Proper covering uniformizer construction}
Let $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ be a proper covering functor between two GCT's.
A {\bf proper covering uniformizer construction} for $\mathsf{P}$ consists of a functor $F:\mathscr{B}^-\rightarrow \text{SET}$ which associates to an object $\beta$ a set $F(\beta)$ of proper covering uniformizers, see Definition \ref{DEFR1774},
$$
\begin{CD}
E @>\wh{\Psi} >> \mathscr{A}\\
@V\wh{\tau} VV  @V \mathsf{P}VV\\
G\ltimes O_\beta@>\Psi>>  \mathscr{B}
\end{CD}
$$
with $\Psi(o_\beta)=\beta$. 
\qed
\end{definition}
Given a proper covering uniformizer construction for $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ 
we  consider as usual the associated transition sets. In our case, since a uniformizer is a pair,
we obtain the diagram
\begin{eqnarray}\label{EQWE1714}
\bm{M}(\wh{\Psi},\wh{\Psi}')\xrightarrow{\mathsf{p}} \bm{M}(\Psi,\Psi').
\end{eqnarray}
Here the  set $\bm{M}(\wh{\Psi},\wh{\Psi}')$ consists of all tuples $(e,\phi,e')$, where $\phi$ is a morphism
in $\mathscr{A}$ between $\wh{\Psi}(e)$ and $\wh{\Psi}'(e')$
$$
\bm{M}(\wh{\Psi},\wh{\Psi}')=\left\{(e,\phi,e')\ |\ e\in E,\ e'\in E',\ \phi\in \text{mor}(\wh{\Psi}(e),\wh{\Psi}'(e'))\right\},
$$
the set $\bm{M}(\Psi,\Psi')$
is defined as usual, and the map $\mathsf{p}$ is defined as follows
\begin{eqnarray}
\mathsf{p}(e,\phi,e')=(\wh{\tau}(e),\mathsf{P}(\phi),\wh{\tau}'(e')).
\end{eqnarray}
\begin{definition}\label{DEFG1776}\index{D- Proper polyfold covering structure}
Let $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ be a proper covering functor between two GCT's.
A {\bf proper  polyfold covering structure} for $\mathsf{P}$ consists of a pair $(F,\bm{M})$,
where $F$ is a proper covering uniformizer construction and $\bm{M}$ is a construction
of M-polyfold structures for the transition sets $\bm{M}(\Psi,\Psi')$ and $\bm{M}(\wh{\Psi},\wh{\Psi}')$
so that $\mathscr{A}$ and $\mathscr{B}$ for the induced structures become polyfolds and the map
$\mathsf{p}$ defined in (\ref{EQWE1714}) becomes a local sc-diffeomorphism.
A {\bf proper polyfold covering functor} consists of a  proper covering functor between two GCT's,
say $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$, equipped with a proper polyfold covering  structure.
\qed
\end{definition}
Next we shall study properties of $\mathsf{p}:\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow\bm{M}(\Psi,\Psi')$ in more detail.
\begin{lemma}\label{LEMM1776}
Assume we are given a proper covering uniformizer construction $(F,\bm{M})$  for $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$. 
For uniformizer pairs $(\wh{\Psi},\Psi)$ and $(\wh{\Psi}',\Psi')$ and the associated transition sets, we  have a well-defined bijective map
\begin{eqnarray}\label{GEQ1714}
\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}}E
\end{eqnarray}
mapping $(e,\phi,e')$ to $(\mathsf{p}(e,\phi,e'),s(e,\phi,e'))= ((\wh{\tau}(e),\mathsf{P}(\phi),\wh{\tau}'(e')),e)$. 
Here $\wh{\tau}:E\rightarrow G_\beta\ltimes O_\beta$, with $\wh{\Psi}:E\rightarrow \mathscr{A}$ and $\Psi: G_\beta\ltimes O_\beta\rightarrow \mathscr{B}$, and similarly for $\wh{\tau}'$.
\end{lemma}
\begin{proof}
To see that the map defined in (\ref{GEQ1714}) is bijective
 let us first show that it is injective.
Assume that  $(e,\phi,e')$ and $(e_1,\phi_1,e'_1)$ are mapped to the same point, implying
$$
((\wh{\tau}(e),\mathsf{P}(\phi),\wh{\tau}'(e')),e)=((\wh{\tau}(e_1),\mathsf{P}(\phi_1),\wh{\tau}'(e_1')),e_1).
$$
This implies that $e=e_1$ and moreover
$$
s(\phi)=\wh{\Psi}(e)=\wh{\Psi}(e_1)=s(\phi_1)\ \ \text{and}\ \ 
 \mathsf{P}(\phi)=\mathsf{P}(\phi_1).
$$
Since $\mathsf{P}$ is a proper covering map between categories it follows from these latter identities
that $\phi=\phi_1$.  Since $\wh{\Psi}'$ is injective on objects it follows that  $e'=e'_1$ and
 injectivity is established.

In order to establish surjectivity assume that 
$$
((\wt{e},\wt{\phi},\wt{e}'),e)\in \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}}E
$$
 is given. Then  $\wh{\tau}(e)=\wt{e}$  and $\wt{\phi}:\Psi(\wt{e})\rightarrow \Psi'(\wt{e}')$ hold.
From Definition \ref{DEFF1775} we deduce that  
$$
\mathsf{P}(\wh{\Psi}(e)) =\Psi (\wh{\tau}(e))=\Psi(\wt{e}),
$$
implying $s(\wt{\phi}) = \Psi(\wt{e}) =\mathsf{P}(\wh{\Psi}(e))$.
 Since $\mathsf{P}$ is a proper covering functor, there exists a unique
morphism $\phi$ with $s(\phi)=\wh{\Psi}(e)$ so that $\mathsf{P}(\phi)=\wt{\phi}$. The object $t(\phi)$ satisfies
$$
\mathsf{P}(t(\phi))=t(\mathsf{P}(\phi))=t(\wt{\phi})= \Psi'(\wt{e}').
$$
In view of property (3) in Definition \ref{DEFR1774} 
$t(\phi)$ belongs to the image of the objects  $E'$ under $\wh{\Psi}'$ and consequently for 
a uniquely determined $e'\in E'$ with $\wh{\Psi}'(e') =t(\phi)$ we  obtain the object $(e,\phi,e')$
in $\bm{M}(\wh{\Psi},\wh{\Psi}')$ which satisfies 
$$
(e,\phi,e')\rightarrow (\mathsf{p}(e,\phi,e'), e)=((\wt{e},\wt{\phi},\wt{e}'),e).
$$
The surjectivity has been established.
\qed \end{proof}
In view of Lemma \ref{LEMM1776} the map
$$
\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}}E
$$
is a bijection. However, more is true.
\begin{proposition}
Assume that $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ is a proper polyfold covering functor.
Then for two uniformizers the map
$$
\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}}E
$$
is an sc-diffeomorphism.
\end{proposition}\index{P- Pullback $\mathsf{P}^\ast\Theta$}
\begin{proof}
 From the sc-smoothness of $\mathsf{p}$ it follows that the above map is sc-smooth. Since
$\mathsf{p}$ is a local sc-diffeomorphism and the same holds for $\wh{\tau}$ it follows that our map has to be a local sc-diffeomorphism, which of course is together with the other properties only possible if the map is a global sc-diffeomorphism. 
\qed \end{proof}
Given a proper polyfold covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ 
a {\bf covering family of uniformizers}\index{Covering family of uniformizers} ${(\wh{\Psi}_\lambda,\Psi_\lambda)}_{\lambda\in\Lambda}$ for $\mathsf{P}$
is a family such that ${(\Psi_\lambda)}_{\lambda\in\Lambda}$ is a covering family for $\mathscr{B}$.
Associated to a such a family we have the covering of ep-groupoids
$\wh{\tau}_\lambda:E_\lambda\rightarrow G_\lambda\ltimes O_\lambda$ fitting into the diagram
$$
\begin{CD}
E_\lambda@>\wh{\Psi}_\lambda>> \mathscr{A}\\
@V\wh{\tau}_\lambda VV @V \mathsf{P} VV\\
G_\lambda\ltimes O_\lambda@>\Psi_\lambda >>  \mathscr{B}.
\end{CD}
$$
Denote by $E$ the disjoint union of all the object M-polyfolds $E$  and similarly by $X$ the union of the $O_\lambda$, i.e.
$$
E=\bigsqcup_{\lambda\in\Lambda} E_\lambda\ \ \text{and}\ \ X=\bigsqcup_{\lambda\in\Lambda} O_\lambda.
$$
Then we obtain a surjective  local sc-diffeomorphism $\wh{\tau}:E\rightarrow X$ by setting
$$
\wh{\tau}(e_\lambda) = \wh{\tau}_\lambda(e_\lambda)\ \ \text{for}\ \ e_\lambda\in E_\lambda.
$$
We can turn $E$ and $X$ into ep-groupoids
and $\wh{\tau}$ into a proper covering functor of ep-groupoids by defining $\bm{E}$ and $\bm{X}$ as follows
$$
\bm{E}=\bigsqcup_{(\lambda,\lambda')\in\Lambda\times\Lambda} \bm{M}(\wh{\Psi}_\lambda,\wh{\Psi}_{\lambda'})\ \ \text{and}\ \ \bm{X}=\bigsqcup_{(\lambda,\lambda')\in\Lambda\times\Lambda} \bm{M}({\Psi}_\lambda,{\Psi}_{\lambda'}).
$$
Then, as previously seen $E\equiv (E,{\bf E})$ and $X\equiv(X,{\bf X})$ are ep-groupoids. One easily verifies 
that $\wh{\tau}$ extends naturally to a proper covering functor, denoted by  $\wh{\tau}$,  between these ep-groupoids.
Of course, a different covering family produces a different proper covering functor and the different choices
 are related by some kind Morita equivalence. We leave it to the reader to work out the straight-forward,
but somewhat lengthy details. We call $\wh{\tau}:E\rightarrow X$ an sc-smooth model for the proper polyfold covering functor
$\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$. Of course, it comes with a natural pair of equivalences
\begin{eqnarray}\label{ERQN1779}
\begin{CD}
E @>\wh{\Gamma}>> \mathscr{A}\\
@V \wh{\tau} VV @V \mathsf{P} VV\\
X @>\Gamma>>  \mathscr{B}.
\end{CD}
\end{eqnarray}
Next we consider the behavior of branched ep$^+$-subcategories with respect to proper polyfold covering functors.
\begin{proposition}
Assume that $\mathsf{P}:\mathscr{A}\rightarrow \mathsf{B}$ is a proper polyfold covering functor
and $\Theta:\mathscr{B}\rightarrow {\mathbb Q}^+$ a branched ep$^+$-subcategory. 
View $\mathscr{A}$ and $\mathscr{B}$ with the induced structures as polyfolds. The pull-back functor
$$
\mathsf{P}^\ast\Theta :
\mathscr{A}\rightarrow {\mathbb Q}^+
$$
defined by $\mathsf{P}^\ast\Theta:=\Theta\circ \mathsf{P}$ is a branched ep$^+$-subcategory.
Moreover the following holds.
\begin{itemize}
\item[{\em(1)}]\  If $\Theta$ is of manifold type also $\mathsf{P}^\ast\Theta$ is of manifold type.
\item[{\em(2)}]\   If $\Theta$ is of orbifold type also $\mathsf{P}^\ast\Theta$ is of orbifold type.
\item[{\em (3)}]\   If $\Theta$ is tame also  $\mathsf{P}^\ast\Theta$ is tame.
\item[{\em (4)}]\   If $\Theta$ is compact also $\mathsf{P}^\ast\Theta$ is compact.
\end{itemize}
\end{proposition}
\begin{proof}
We take a sc-smooth  model $\wh{\tau}:E\rightarrow X$ as in (\ref{ERQN1779}). Then, by definition,
$\Theta$ is a branched ep$^+$-subcategory
if and only if $\Gamma^\ast\Theta$ is a branched ep$^+$-subgroupoid.  It is an easy exercise that the pull-back
of a branched ep$^+$-subgroupoid by a proper covering functor $\wh{\tau}:E\rightarrow X$ between ep-groupoids
is a branched ep$^+$-subgroupoid of $E$.  Consequently $\wh{\tau}^\ast(\Gamma^\ast\Theta)$ is a branched ep$^+$-subgroupoid of $E$, which implies that $\wh{\Gamma}_\ast(\wh{\tau}^\ast(\Gamma^\ast\Theta))$ is a branched ep$^+$-subcategory of $\mathscr{A}$.  From the identity
\begin{eqnarray*}
\mathsf{P}^\ast\Theta&=& \wh{\Gamma}_\ast (\wh{\tau}^\ast(\Gamma^\ast\Theta))
\end{eqnarray*}
we obtain the desired result that $\mathsf{P}^\ast\Theta$ is a branched ep$^+$-subcategory.
All the procedures in the proof of the previous result preserve the tameness property, which yields (3).
Assume that $\Theta$ only takes the values $\{0,1\}$. Then the same is true for $\mathsf{P}^\ast\Theta$.
This proves (2). 

 In order to show (1) assume that $\alpha$ and $\alpha'$ are two objects 
with $\Theta\circ\mathsf{P}(\alpha)=1$ and $\Theta\circ\mathsf{P}(\alpha')=1$. Consider 
two  isomorphisms $\phi,\phi':\alpha\rightarrow \alpha'$. Then  $\mathsf{P}(\phi), \mathsf{P}(\phi'):\mathsf{P}(\alpha)\rightarrow \mathsf{P}(\alpha')$ and it follows from the fact that $\Theta$ is of manifold-type that
$\mathsf{P}(\phi)=\mathsf{P}(\phi')$. Define the element  $\sigma:=\phi'\circ\phi^{-1}$ in $G_{\alpha'}$
and note that  $\mathsf{P}(\sigma)=1_{\mathsf{P}(\alpha')}$.
Since $\mathsf{P}$ is a proper covering functor the map
$$
\bm{A}\rightarrow \bm{B}{_{s}\times_{\mathsf{P}}}A:\psi\rightarrow (\mathsf{P}(\psi),s(\psi))
$$
is a bijection. As we have shown it holds that $\sigma$ is mapped as
$$
\sigma\rightarrow (\mathsf{P}(\sigma),s(\sigma))= (1_{\mathsf{P}(\alpha')},\alpha').
$$
Since $1_{\alpha'}$ is also mapped to $(1_{\mathsf{P}(\alpha')},\alpha')$ we conclude that
$\sigma=1_{\alpha'}$ or equivalently $\phi=\phi'$.
This proves (1).

By the assumption in (4)  $|\supp(\Theta)|$ is compact. Consider $|\supp(\Theta\circ\mathsf{P})|$
and take a sequence $(\wt{z}_k)$ in the latter and define $z_k=|\mathsf{P}|(\wt{z}_k)$. There is no loss of generality assuming the $z_k\rightarrow z\in |\supp(\Theta)|$. We take a proper covering uniformizer around $\beta$ with $|\beta|=z$,
 and we can represent the sequences, after perhaps passing to subsequences by $(o_k)\subset O_b$ with
$\Psi(o_\beta)=\beta$ and $o_k\rightarrow o_\beta$. Moreover, we find  $(e_k)\subset E$ with $\wh{\tau}(e_k)=o_k$. 
We may assume that $(e_k)$ lies in a connected component sc-diffeomorphic to $O_\beta$ from which
it follows that $(e_k)$ converges.
\qed \end{proof}

Finally, we shall briefly discuss the situation of strong bundles in the covering context.
Assume that  $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$
is a proper polyfold covering functor. We have to consider strong bundles over $\mathscr{A}$ and $\mathscr{B}$
and in order that they fit into our covering scheme we need to impose some additional structure.
As before we denote by $\text{Ban}$ the category whose objects are Banach spaces and the morphisms 
are topological linear isomorphisms.  We assume we are given functors
$$
\mu:\mathscr{B}\rightarrow \text{Ban}\ \ \text{and}\ \ \wt{\mu}:\mathscr{A}\rightarrow \text{Ban}
$$
together with a natural transformation $\gamma: \wt{\mu}\rightarrow \mu\circ\mathsf{P}$.  This implies 
that for every object $\alpha$ in $\mathscr{A}$ we are given Banach spaces $\wt{\mu}(\alpha)$ and
$\mu(\mathsf{P}(\alpha))$ together with a linear topological isomorphism
$$
\gamma_\alpha:\wt{\mu}(\alpha)\rightarrow \mu(\mathsf{P}(\alpha)),
$$
so that a morphism $\phi:\alpha\rightarrow \alpha'$ produces a topological linear isomorphism
$\wt{\mu}(\phi):\wt{\mu}(\alpha)\rightarrow \wt{\mu}(\alpha')$ and $\mu(\mathsf{P}(\phi)):\mu(\mathsf{P}(\alpha))\rightarrow
\mu(\mathsf{P}(\alpha'))$ fitting into the commutative diagram 
$$
\begin{CD}
\wt{\mu}(\alpha) @>\wt{\mu}(\phi)>> \wt{\mu}(\alpha')\\
@V\gamma_\alpha VV @V \gamma_{\alpha'} VV\\
\mu(\mathsf{P}(\alpha))@>\mu(\mathsf{P}(\phi))>> \mu(\mathsf{P}(\alpha')).
\end{CD}
$$
Associated to $\wt{\mu}$ we can define as before $\wt{\mathscr{W}}$ having as objects 
$(\alpha,\wt{w})$ defining the functor $\wt{P}:\wt{\mathscr{W}}\rightarrow \mathscr{A}$. The base is already equipped 
with a polyfold structure. Associated to $\mu $ we obtain $P:\mathscr{W}\rightarrow \mathscr{B}$, where again the base
has a polyfold structure.  We define $\wt{\mathsf{P}}:\wt{\mathscr{W}}\rightarrow \mathscr{W}$ on objects  by
$$
 (\alpha,\wt{e})\rightarrow (\mathsf{P}(\alpha),\gamma_\alpha(\wt{e})),
$$
and on morphisms by
$$
(\phi,\wt{w})\rightarrow (\mathsf{P}(\phi),\gamma_{s(\phi)}(\wt{w})).
$$
With these definitions we obtain the commutative functor diagram
\begin{eqnarray}\label{XXXX4567}
\begin{CD}
\wt{\mathscr{W}}@ >\wt{P}>>  \mathscr{A}\\
@V \wt{\mathsf{P}} VV      @V\mathsf{P}VV\\
\mathscr{W} @> P>> \mathscr{B},
\end{CD}
\end{eqnarray}
where the vertical arrows are proper covering functors, and $\mathsf{P}$ already is a proper polyfold covering functor.
One needs to introduce structures which turn the first vertical arrow into a proper strong bundle covering functor.
This necessary structure is indicated by the following diagram, where  in the bottom plane 
we have the diagram (\ref{XXXX4567})
$$
\begin{tikzcd}[row sep=scriptsize, column sep=scriptsize]
& \wt{W} \arrow[dl] \arrow[rr] \arrow[dd] & & E \arrow[dl] \arrow[dd] \\
W \arrow[rr, crossing over] \arrow[dd] & & X \\
& \wt{\mathscr{W}} \arrow[dl] \arrow[rr] & & \mathscr{A} \arrow[dl] \\
\mathscr{W} \arrow[rr] & &\mathscr{B} \arrow[from=uu, crossing over]\\
\end{tikzcd}
$$
and the vertical arrows stand for uniformizers. The  right-hand face depicts the proper polyfold covering structure 
where the uniformizers are defined on $E\rightarrow X$. In  the top plane we need to pick strong bundles
$\wt{W}\rightarrow X$ and $W\rightarrow X$ over-ep-groupoids and a strong bundle map which is also is  covering map,
but isomorphic between the fibers.  Since the data in the vertical face on the right is induced by data on the left
we only have to explain the requirements for the diagram
\begin{eqnarray}
\begin{CD}
\wt{W} @>>>\wt{\mathscr{W}}\\
@V F VV @V\wt{\mathsf{P}}VV\\
W@>>>\mathscr{W}.
\end{CD}
\end{eqnarray}
With the objects introduced previously we are given the GCT $\wt{\mathscr{W}}$ whose objects
are pairs $(\alpha,\wt{w})$ with $\alpha$ an object in $\mathscr{A}$ and $\wt{w}\in \wt{\mu}(\alpha)$.
The morphisms have the form $(\phi,\wt{w})$ with $\wt{w}\in \wt{\mu}(s(\phi) )$.  Similarly
$\mathscr{W}$ has as objects $(\beta,w)$ with $w\in \mu(\beta)$ and morphisms $(\psi,w)$
satisfying $w\in \mu(s(\psi))$.  The proper covering  functor
$$
\wt{\mathsf{P}}\colon \wt{\mathscr{W}}\rightarrow \mathscr{W}
$$
is defined on objects by $(\alpha,\wt{w})\rightarrow (\mathsf{P}(\alpha),\gamma_{\alpha}(\wt{w}))$ and on morphisms 
by $ (\phi,\wt{w})\rightarrow (\mathsf{P}(\phi),\gamma_{s(\phi)}(\wt{w}))$.  We note that for fixed $\alpha$ the map
$(\alpha,\wt{w})\rightarrow (\mathsf{P}(\alpha),\gamma_\alpha(\wt{w}))$ is a linear topological isomorphism 
between Banach spaces. We would like to model the situation with strong bundles over ep-groupoids
denoted by $\wt{W}$ and $W$. Hence $\wt{W}$ and $W$ are strong bundles over ep-groupoids and 
$A:\wt{W}\rightarrow W$ is a proper strong bundle covering functor in the sense of Definition \ref{proper_sb_covering},
where we suppress here the underlying base data. A uniformizer construction for our current situation 
gives for an object $\beta$ in the base of $\mathscr{W}$ a functor $\Psi:W\rightarrow \mathscr{W}$
which maps a uniquely determined object $(o_\beta,0)$ to $(\beta,0_{\mu(\beta)})$ and is a linear isomorphism
between fibers.  Similarly $\wt{\Psi}:\wt{W}\rightarrow \wt{\mathscr{W}}$. The other requirements are similar to those 
explained in the case of proper covering functors. In our context all occurring maps in the transition sets
have to be in addition strong bundle maps.   We leave the remaining  details to the reader.

\chapter{Fredholm Theory in Polyfolds}\label{CHAPX18}
This chapter is concerned with the sc-Fredholm theory, which is the main topic of this book. We have discussed sc-Fredholm section functors
in great detail in the context of strong bundles over ep-groupoids and we shall carry the ideas over to the categorical context. 


We assume we are given a GCT $\mathscr{C}$ equipped with a polyfold structure $(F,\bm{M})$
and a functor $\mu:\mathscr{C}\rightarrow \text{Ban}$ defining the bundle $P:\mathscr{E}\rightarrow \mathscr{C}$.
Suppose  that $\mathscr{E}$ is equipped with a strong bundle structure $(\bar{F},\bm{M})$ inducing the 
previously defined polyfold structure on $\mathscr{C}$.  Recall that $|\mathscr{C}|$ and $|\mathscr{E}|$
have as consequence of the definition of  a GCT metrizable topologies and $|P|:|\mathscr{E}|\rightarrow |\mathscr{C}|$ is continuous.


We shall study sc-Fredholm section functors of $P$ and 
we shall describe how some of the material developed in the ep-groupoid context can be generalized to the categorical context.
Many of the concepts can be carried over just using an sc-smooth model $X_{\bm{\Psi}}$ and the natural equivalence 
of categories $\Gamma_{\bm{\Psi}}:X_{\bm{\Psi}}\rightarrow \mathscr{C}$ together with the bundle version
$$
\begin{CD}
W_{\bm{\Psi}} @>\bar{\Gamma}_{\bm{\Psi}}>>  \mathscr{E}\\
@V p VV @V P VV\\
X_{\bm{\Psi}}  @>\Gamma_{\bm{\Psi}}>> \mathscr{C}.
\end{CD}
$$
Alternatively we can study, more locally, the diagrams
$$
\begin{CD}
G\ltimes K @>\bar{\Psi}>>   \mathscr{E}\\
@V p VV    @V P VV\\
G\ltimes O @>\Psi >>   \mathscr{C},
\end{CD}
$$
where $\bar{\Psi}\in \bar{F}(\alpha)$ covering $\Psi\in F(\alpha)$.  If $f:\mathscr{C}\rightarrow \mathscr{E}$ is a section functor,
we obtain for every choice $\bar{\Psi}$ a local representative $f_{\bar{\Psi}}: O\rightarrow K$, which is $G$-equivariant.
The properties relevant for our studies are those which can be defined by imposing requirements on ${(f_{\bar{\Psi}})}_{\bar{\Psi}\in\bm{\bar{\Psi}}}$,
where $\bm{\bar{\Psi}}$ is a covering family, and where the definition does not depend on the covering family which has been chosen. 
The sc-Fredholm property is of this kind.









\section{Basic Concepts}
Assume that $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong bundle over a polyfold with the structure defined by $(\bar{F},\bm{M})$.
\begin{definition}\label{DEFG1811}
A section functor $f$ of $P:\mathscr{E}\rightarrow \mathscr{C}$ is called an {\bf sc-Fredholm section functor} provided for any object $\alpha$ and $\bar{\Psi}\in \bar{F}(\alpha)$
a strong bundle uniformizer
$\bar{\Psi}:G\ltimes K\rightarrow \mathscr{C}$ covering $\Psi$ the representative $f_{\bar{\Psi}}:O\rightarrow K$ is sc-Fredholm in the sense
of Definition \ref{DEFX3116}.
\qed
\end{definition}
\begin{remark}\index{R- On sc-Fredholm  section functors}
 (a) Assume we are given a covering family $\bm{\bar{\Psi}}$ for $P$, i.e. the underlying $\bm{\Psi}$ is a covering family for $\mathscr{C}$.
If $f$ is a section functor such that all $f_{\bar{\Psi}}$, $\bar{\Psi}\in \bm{\bar{\Psi}}$,  are sc-Fredholm sections it follows that for an arbitrary object $\alpha$ and $\bar{\Psi}\in \bar{F}(\alpha)$
the representative $f_{\bar{\Psi}}$ is sc-Fredholm.  This is an easy exercise. So the sc-Fredholm property is checkable with a covering family.
As a consequence the pull-back of $f$ by $\bar{\Gamma}_{\bm{\bar{\Psi}}}:W_{\bm{\bar{\Psi}}}\rightarrow \mathscr{E}$ denoted by
$f_{\bm{\bar{\Psi}}}$ is an sc-Fredholm section of a strong bundle over an ep-groupoid if and only if $f$ is sc-Fredholm.\par

\noindent(b)  If $f$ is an sc-Fredholm section functor it follows that $f$ is regularizing. Indeed, if $\alpha$ is an object
in $\mathscr{C}_m$ and $f(\alpha)\in \mathscr{E}_{m,m+1}$, then $\alpha\in \mathscr{C}_{m+1}$.\par

\noindent(c) A definition,  which is equivalent to Definition \ref{DEFG1811}, requires $f$ to be regularizing
as described in (b) and being sc-smooth, which can be checked by a covering family. Moreover, it stipulates that for every smooth $z\in |\mathscr{C}|$ there exists an object $\alpha$
with $|\alpha|=z$ and $\bar{\Psi}\in\bar{F}(\alpha)$, with underlying $\Psi$ satisfying $\Psi(\bar{q})=\alpha$,
so that $(f_{\bar{\Psi}},\bar{q})$ is an sc-Fredholm germ in the sense of Definition \ref{oi}.
\qed
\end{remark}
Assume that $f$ is an sc-Fredholm section functor and $\alpha$ an object satisfying $f(\alpha)=0$. The tangent $T_\alpha\mathscr{C}$ is an sc-Banach space
and there is a well-defined linearization $f'(\alpha):T_\alpha\mathscr{C}\rightarrow \mathscr{E}_\alpha$ which is an sc-Fredholm functor.
It is defined as follows.  Take $\bar{\Psi}\in\bar{F}(\alpha)$ covering $\Psi$ and consider a tangent vector $[\alpha,\Psi,h]$. The linearization is defined by
\begin{eqnarray}\label{linXXXc}
f'(\alpha)([\alpha,\Psi,h])= (\alpha,\bar{\Psi}(q_0)(f_{\bar{\Psi}}'(h))),
\end{eqnarray}
where $f_{\bar{\Psi}}'(q_0):T_{q_0}O\rightarrow K_{q_0}$ is the linearization of $f_{\bar{\Psi}}$ at $q_0$, which satisfies $\Psi(q_0)=\alpha$.
The definition does not depend on the choice of $\bar{\Psi}$.
\begin{definition}\label{QWDEF1812}\index{D- Linearization $f'(\alpha)$}
The sc-Fredholm operator $f'(\alpha):T_\alpha\mathscr{C}\rightarrow \mathscr{E}_\alpha$ which via (\ref{linXXXc}) 
is well-defined, is called the {\bf linearization} of the sc-Fredholm section functor $f$ at the solution object $\alpha$.\qed
\end{definition}
Note that we  can also define a set of linearizations at smooth objects, which are not necessarily solution objects.
For this we take a uniformizer $\bar{\Psi}$ at $\alpha$ and obtain $f_{\bar{\Psi}}:O\rightarrow K$.
Denote by   $q_0$ the point which satisfies $\Psi(q_0)=\alpha$. For every local sc$^+$-section $s$ defined 
near $\bar{q}$, satisfying $s(q_0)=f_{\bar{\Psi}}(q_0)$ we can take the linearization
$(f_{\bar{\Psi}}-s)'(q_0):T_{q_0}O\rightarrow K_{q_0}$. The collection of all
$$
f_s'(\alpha)([\alpha,\Psi,h])=(\alpha,\bar{\Psi}(q_0)((f_{\bar{\Psi}}-s)'(q_0)(h)))
$$
consists of linear sc-Fredholm operators,  which all differ by sc$^+$-operators and therefore 
have the same index. The collection is independent of the choice of $\bar{\Psi}$ at $\alpha$.
\begin{definition}\index{D- Set of lineraizations}
The {\bf set of linearizations} of the sc-Fredholm section functor $f$ of $P:\mathscr{E}\rightarrow \mathscr{C}$
at the smooth object $\alpha$ is denoted by $\text{Lin}(f,\alpha)$. The index $\text{ind}(f,\alpha)$
is the Fredholm index of any of its elements in $\text{Lin}(f,\alpha)$.
\qed
\end{definition}
We note that if $\alpha$ is a zero object the set of linearizations consists of one element, namely the one defined
in Definition \ref{QWDEF1812}.


If $\phi:\alpha\rightarrow \alpha'$ is a morphism between two smooth objects and $f(\alpha)=0$, then $f(\alpha')=0$ as well.  Moreover,
with $T\phi: T_\alpha\mathscr{C}\rightarrow T_{\alpha'}\mathscr{C}$ and $\wh{\phi}:=\mu(\phi):\mu(\alpha)\rightarrow \mu(\alpha')$ being the lift by $\mu:\mathscr{C}\rightarrow \text{Ban}$, it holds that 
$$
\wh{\phi}\circ f'(\alpha) = f'(\alpha')\circ T\phi.
$$
Given  $\phi:\alpha\rightarrow \alpha'$ between smooth objects we obtain an induced map
$$
\phi_\ast :\text{Lin}(f,\alpha)\rightarrow\text{Lin}(f,\alpha'): \phi_\ast(L)= \wh{\phi}\circ L\circ T\phi^{-1}.
$$
Clearly $\phi'_\ast\circ\phi_\ast=(\phi'\circ\phi)_\ast$ and $({1_\alpha})_\ast=Id$.  As we have seen in the discussion
of sc-Fredholm section functors, in the context of ep-groupoids,  the set of linearizations is important when
discussion orientation questions.

Let us state a version of the implicit function theorem in the categorical context, which is based 
on results on ep-groupoids. We denote for a polyfold $\mathscr{C}$ and an open subset $U$ of $|\mathscr{C}|$
by $\mathscr{C}_U$ the
full subcategory associated to objects with $|\alpha|\in U$. 
\begin{theorem}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong bundle over a tame polyfold and $f$ an sc-Fredholm section functor. Assume that the smooth object $\alpha$ satisfies $f(\alpha)=0$ and the linearization
$f'(\alpha): T_\alpha\mathscr{C}\rightarrow \mathscr{E}_\alpha$ is surjective and the kernel $\ker(f'(\alpha))$
is in good position to the boundary (see Remark \ref{REMARG238}). Then there exists an open neighborhood $U$ of $|\alpha|$ in $|\mathscr{C}|$ so that the following holds.
\begin{itemize}
\item[{\em(1)}]\   The functor 
$\Theta\colon \mathscr{C}_U\rightarrow \{0,1\}$ defined by 
$$
\Theta(\beta)=\left[\begin{array}{cc}
1&\ \text{if}\ \  f(\beta)=0\\
0&\ \text{if}\ \  f(\beta)\neq 0
\end{array}
\right.
$$ 
is a tame orbifold-type ep$^+$-subcategory. 
\item[{\em(2)}]\    For  every object $\beta$ in $\mathscr{C}_U$ with
$\Theta(\beta)=1$ the linearization $f'(\beta)$ is surjective and the kernel lies in good position to the boundary.
\end{itemize}
Note that $|\supp(\Theta)|$ is in a natural way a smooth orbifold with boundary with corners.
That means that the local model is smooth manifold with boundary with corners divided out by a finite 
group action.
\qed
\end{theorem}
\begin{proof}
The result is a consequence of Theorem  \ref{THM1524}, Theorem \ref{THMXXC1525}, and Proposition 
\ref{PROPY918}.
\qed \end{proof}
\begin{remark}\index{R- Philosophy of perturbations}
Define $\Lambda:\mathscr{E}\rightarrow \{0,1\}$ by associating to the zero vectors the value $1$
and to other vectors the value $0$. Then, as we shall see   later on, $\Lambda$  is an sc$^+$-multisection  functor
and $(f,\Lambda)$ will be in good position at $\alpha$. 
With this definition it holds that $\Theta =\Lambda\circ f$ and the good position of $(f,\Lambda)$ at $\alpha$
implies that $\Theta$ is an ep$^+$-subcategory on a suitable $\mathscr{C}_U$.
 As we already have seen in the ep-groupoid case
it holds more generally that for a pair $(f,\Lambda)$ in sufficiently generic position (to be made precise)
the associated $\Lambda\circ f$ is a branched  ep$^+$-subcategory.
\qed
\end{remark}
Next we import the notion of an auxiliary norm  from the ep-groupoid context into the categorical framework. We assume that we have a strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$.
Recall that $\mathscr{E}$ has double filtration $\mathscr{E}_{m,k}$ for $0\leq k\leq m+1$.
\begin{definition}\label{FGH1890}\index{D- Auxiliary norm}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong bundle over a polyfold. 
An {\bf auxiliary norm} is a functor $N:\mathscr{E}\rightarrow [0,\infty]$ having the following properties.
\begin{itemize}
\item[(1)] \  If $e\in \mathscr{E}\setminus\mathscr{E}_{0,1}$ then  $N(e)=+\infty$.
\item[(2)]  \   $N$ defines on each fiber of $\mathscr{E}_{0,1}$  a complete norm.
\item[(3)] \  Given a sequence $(|h_k|)\subset |\mathscr{C}_{0,1}|$ satisfying $|P(h_k)|\rightarrow  |\alpha|$ and $|N|(|h_k|)\rightarrow 0$ it holds  $|h_k|\rightarrow |0_\alpha|$ in $|\mathscr{E}_{0,1}|$. 
\end{itemize}
\qed
\end{definition}
An easy lemma whose proof is left to the reader gives an alternative description of an auxiliary norm.
\begin{lemma}
Assume that $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong bundle over a polyfold and $N:\mathscr{C}\rightarrow [0,\infty]$ a functor.
Then $N$ is an auxiliary norm if and only if for a covering subset of strong bundle uniformizers $\bm{\bar{\Psi}}$ the functor 
$N_{\bm{\bar{\Psi}}}=N\circ\bar{\Gamma}_{\bm{\bar{\Psi}}}: W_{\bm{\bar{\Psi}}}\rightarrow [0,\infty]$ is an auxiliary 
norm for the strong bundle over the ep-groupoid $W_{\bm{\bar{\Psi}}}\rightarrow X_{\bm{\Psi}}$.
\qed
\end{lemma}
In order to introduce the notion of a reflexive auxiliary norm we distinguish a particular class of strong polyfold bundles $P:\mathscr{E}\rightarrow \mathscr{C}$.
\begin{definition}
We say that $P$ has reflexive $(0,1)$-fibers provided for every object $\alpha$
the fiber $(P^{-1}(\alpha))_{(0,1)}$ is a reflexive Banach space.
\qed
\end{definition}
We note that this can be checked on the orbit space in the following sense.  
If $z\in |\mathscr{C}|$ take an $\alpha$ representing $z$. If the $(0,1)$-fiber over
$\alpha$ is reflexive the same  will hold for any other $\alpha'$ isomorphic to $\alpha$.
If $p: W\rightarrow X$ is a local model for $P$ 
$$
\begin{CD}
W @>\bar{\Gamma}>>  \mathscr{E}\\
@V p VV   @V P VV\\
X @>\Gamma>> \mathscr{C}
\end{CD}
$$
and $|\Gamma(x)|=|\alpha|$, it follows that ${(W_x)}_{(0,1)}$ is a reflexive Banach space.
With other words any sc-smooth model has reflexive $(0,1)$-fibers. Following Definition \ref{DEFP1228}
we introduce the notion of mixed convergence.
\begin{definition}\index{D- Mixed convergence}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle with reflexive $(0,1)$-fibers.
We say a sequence $(y_k)\subset |\mathscr{E}_{(0,1)}|$ is {\bf mixed convergent} to $y\in |\mathscr{E}_{0,1}|$ provided
$|P|(y_k)|\rightarrow |P|(y)$ (on level $0$) and for a choice of uniformizer $\bar{\Psi}$ covering $\Psi$
at a representative $\alpha$ for $|P|(y)$, say
$$
\begin{CD}
G\ltimes K@>\bar{\Psi}>> \mathscr{E}\\
@Vp VV  @V P VV\\
G\ltimes O @>\Psi >>  \mathscr{C}
\end{CD}
$$
with $\Psi(x)=\alpha$, we can pick for large $k$ representatives $e_k\in K$ with $|\bar{\Psi}(e_k)|=y_k$
and $e$ with $p(e)=x$ and $|\bar{\Psi}(e)|=y$ such that $e_k\xrightarrow{m} e$ (mixed convergent, see Definition \ref{DEFP1228}).
\qed
\end{definition}
Having defined mixed convergence we introduce the notion of a reflexive auxiliary norm.
\begin{definition}\index{D- Reflexive auxiliary norm}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle with reflexive $(0,1)$-fibers and $N$ an auxiliary norm for $P$.  We say that $N$ is a {\bf reflexive auxiliary norm}, if besides the usual properties
of an auxiliary norm given in Definition \ref{FGH1890}, the following property holds.
If $(y_k)\subset |\mathscr{E}_{(0,1)}|$ is mixed convergent to $|y|\in |\mathscr{E}_{0,1}|$, then for suitable representatives 
$(e_k)$ and $e$ for $(y_k)$ and $y$ it holds
$$
N(e)\leq \text{liminf}_{k\rightarrow\infty} N(e_k)
$$
Alternatively we could require $|N|(y)\leq \text{liminf}_{k\rightarrow\infty} |N|(y_k)$.
\qed
\end{definition}
We can transport all results about auxiliary norms in the ep-groupoid context over to the categorical 
case, where $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong polyfold bundle. For this 
we just take an sc-smooth local model
$$
\begin{CD} 
W @>\bar{\Gamma} >>  \mathscr{E}\\
@V p VV   @V PVV\\
X@>\Gamma>> \mathscr{C}
\end{CD}
$$
and note that given an auxiliary norm $n$ for $p$ the push forward $N:= \bar{\Gamma}_\ast n$
is an auxiliary norm for $P$.  If $n$ is reflexive so is $N$.  Since $|\mathscr{C}|$ is by definition paracompact and therefore metrizable it follows that $|X|$ is metrizable and therefore paracompact. The choice of local
sc-smooth model does not matter since the notions around auxiliary norms are well-behaved 
under generalized strong bundle isomorphisms in the ep-groupoid context.
Consequently we can apply
Theorem \ref{EXTTT} and obtain the existence of an reflexive auxiliary norm on $P$, provided it has
reflexive $(0,1)$-fibers. Applications of  Theorem \ref{EXTT} and Theorem \ref{THMOP12213} provide 
extension theorems. 
\begin{theorem}\label{THG18112}\index{T- Existence of auxiliary norms}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle. Then the following holds.
\begin{itemize}
\item[{\em (1)}]\   $P$ admits an auxiliary norm.
\item[{\em(2)}] \ If $P$ has reflexive $(0,1)$-fibers, there exists for every auxiliary norm $N'$ for $P$ two reflexive 
auxiliary norms $N_1$ and $N_2$ satisfying $N_1\leq N'\leq N_2$.
\item[{\em (3)}]\  If $P$ is defined over a tame polyfold an auxiliary norm defined on $\mathscr{E}|\partial\mathscr{C}$
can be extended to $P$.  In the case that $P$ has reflexive $(0,1)$-fibers a reflexive auxiliary norm
on $\mathscr{E}|\partial\mathscr{C}$ can be extended as a reflexive auxiliary norm.
\end{itemize}
\qed
\end{theorem}
We leave it to the reader to transport other interesting results around auxiliary norms 
into the categorical context.



\section{Compactness Properties}
The starting point is a strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$
and an sc-Fredholm section functor $f$ of $P$. Given an sc-smooth model associated to a covering family $\bm{\bar{\Psi}}$ we obtain $p:W\rightarrow X$ and the sc-Fredholm section $f_{\bm{\bar{\Psi}}}$ which fit into the commutative diagram
$$
\begin{CD}
W @>\bar{\Gamma}>> \mathscr{E}\\
@A f_{\bm{\bar{\Psi}}} AA    @ A f AA\\
X @>\Gamma>>  \mathscr{C}.
\end{CD}
$$
Many compactness properties are statements which can be formulated in terms of orbit spaces. We note that $|\Gamma|$ and $|\bar{\Gamma}|$ are homeomorphisms
fitting into the commutative diagram
$$
\begin{CD}
|W |@>|\bar{\Gamma}|>> |\mathscr{E}|\\
@A |f_{\bm{\bar{\Psi}}}| AA    @ A |f| AA\\
|X| @<|\Gamma|^{-1}<<  |\mathscr{C}|
\end{CD}
$$
resulting in the relationship
\begin{eqnarray}
|f| =|\bar{\Gamma}|\circ |f_{\bm{\bar{\Psi}}}|\circ |\Gamma|^{-1}
\end{eqnarray}
which allows us to carry over compactness concepts discussed in the ep-groupoid context in Section 
\ref{SEC114}.  If $f$ is an sc-Fredholm section functor of $P$ we define the associated {\bf solution category}\index{Solution category $S_f$}
$S_f$ to be the full subcategory of $\mathscr{C}$ associated to objects $\alpha$ satisfying $f(\alpha)=0$. Since $f$ is regularizing a solution object is smooth.
\begin{definition} \index{D- Reflexive local compactness property, category context}
 We say that the sc-Fredholm section functor $f$ of $P$ defines a {\bf compact moduli space}\index{D- Compact moduli space}
provided the orbit space $|S_f|$ of the solution category is compact. We refer to $|S_f|$ as the {\bf coarse moduli space} associated to $f$.\index{D- Coarse moduli space}
\qed
\end{definition}
Having a compact moduli space for an sc-Fredholm section functor implies the seemingly stronger 
properness property, which follows from Theorem \ref{THMB1242}.
\begin{theorem}[Stability of compactness]\index{T- Stability of compactness}\label{THMX18.2.2}
Let $f$ be an sc-Fredholm section functor of the strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$ having a compact (coarse) moduli space $|S_f|$. Then given an auxiliary norm $N:\mathscr{E}\rightarrow [0,\infty]$
there exists an open neighborhood $U$ of $|S_f|$ in $|\mathscr{C}|$ such that the closure of the set
$\{z\in U\ | |N|\circ |f|(z)\leq 1\}$ (on level $0$) is compact.
\qed
\end{theorem}
This result is important, since as a consequence compactness is not being destroyed by small perturbations, and prompts the
following definition.
\begin{definition}\index{D- Controls compactness}
Let $P:\mathscr{E}\rightarrow \mathscr{S}$ be a strong polyfold bundle, $N:\mathscr{E}\rightarrow [0,+\infty]$ be an auxiliary norm,
and $f$ an sc-Fredholm section functor for which $|S_f|$ is compact. Given an open neighborhood $U$ f $|S_f|$ we say that
$(N,U)$ {\bf controls compactness} for $f$ provided  $\cl_{|\mathscr{C}|}(\{z\in U\ |\ |N|\circ |f|(z)\leq 1\})$ is compact.
\end{definition}

In many applications a stronger form of compactness holds with important additional properties, which were discussed in the ep-groupoid context in Section \ref{SEC114}. We first discuss a version of the reflexive local compactness property as given in Definition \ref{DEFR1243}. We note that Definition \ref{DEFR1243} could have formulated equivalently  in terms of orbit spaces, and the following definition is a straight forward generalization 
of such a reformulation. 
\begin{definition}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle with reflexive $(0,1)$-fibers and 
$f$ an sc-Fredholm section functor. We say that $f$ has the (categorical) {\bf reflexive local compactness property}
provided for every reflexive auxiliary norm $N:\mathscr{C}\rightarrow [0,\infty]$ and every point $z\in |\mathscr{C}|$
there exists an open neighborhood $U(z)$ in $|\mathscr{C}|$ such that the closure of the 
set $\{y\in U(z)\ |\ |N|\circ |f|(y)\leq 1\}$ is compact in $|\mathscr{C}|$. 
\qed
\end{definition}
\begin{remark}\index{R- On the categorical reflexive local compactness property}
Note that $z\in |\mathscr{C}|$ is not(!) required to satisfy $|f|(z)=0$. 
For example if $z\in |\mathscr{C}|_0\setminus |\mathscr{C}|_1$ then $|f|(z)\not\in |\mathscr{E}_{0,1}|$ since otherwise, by the regularizing property, we conclude that $z\in |\mathscr{C}_1|$.
Consequently, we infer that $|N|\circ |f|(z)=+\infty$. Using the reflexive local compactness property we see
that  for  a suitable open neighborhood $U(z)$ it holds that $|N|\circ |f|(y)>1$ for $y\in U(z)$. 
Indeed, otherwise there exists a sequence $z_k\rightarrow z$ with $|N|\circ |f|(z_k)\leq 1$.
From this we deduce that $|N|\circ |f|(z)\leq \text{liminf}_{k\rightarrow\infty} |N|\circ |f|(z_k)\leq 1$ giving a contradiction.
Consequently  $\cl_{|\mathscr{C}|}(\{y\in U(z)\ |\ N\circ |f|(z)\leq 1\})=\emptyset$, which is compact.
\qed
\end{remark}


From Theorem \ref{THMXXX1246} we obtain the following extension theorem which frequently appears 
in inductive constructions for moduli spaces with some Floer-theoretic structure.
\begin{theorem}\label{THEMG1824}\index{T- Controlled extension of neighborhoods}
Assume that $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong polyfold bundle  over the tame
$\mathscr{C}$ with reflexive $(0,1)$-fibers
and $f$ an sc-Fredholm section functor.  Assume that $N:\mathscr{C}\rightarrow [0,\infty]$
is a reflexive auxiliary norm and $f$ has a compact moduli space and also the reflexive local compactness property.
Let $S_{\partial f}$ be the solution category associated to $\partial f:=f|\partial\mathscr{C}$ and $U_\partial\subset |\partial\mathscr{C}|$
an open neighborhood of the compact $|S_{\partial f}|$  in $|\partial\mathscr{C}|$ such that the closure 
of $\{z\in U_\partial\ |\ |N|\circ |f|(z)\leq 1\}$ is compact in $|\mathscr{C}|$. Then there exists an open neighborhood
$U$ of the coarse moduli space $|S_f|$ with the following properties.
\begin{itemize}
\item[{\em (1)}]\ \ $U\cap |\partial\mathscr{C}|=U_\partial$.
\item[{\em(2)}]\ \ The closure of $\{z\in U\ |\ |N|\circ |f|(z)\leq 1\}$ in $|\mathscr{C}|$ is compact, i.e. $(N,U)$ controls compactness for $f$.
\end{itemize}
\qed
\end{theorem}
\begin{remark}
 In applications a situation where $N$ at the beginning is only defined for $\mathscr{E}|\partial\mathscr{C}$ arises frequently. 
In this case we can make statements about compactness properties of $\partial f$ involving $N$.
In a next step one would apply Theorem \ref{THG18112} (3) to extend $N$ over $\mathscr{E}$.
Theorem \ref{THEMG1824} then allows to extend $U$ by keeping track of compactness properties.
\qed
\end{remark}



\section{Sc\texorpdfstring{$^+$}{qq}-Multisection Functors}
At this point we consider strong polyfold bundles $P:\mathscr{E}\rightarrow \mathscr{C}$.
We shall use auxiliary norms and if $P$  has reflexive $(0,1)$-fibers  we may assume the auxiliary norm
to be reflexive.
In this section we shall derive important results about sc$^+$-multisections. Since the relevant notions 
behave well under generalized isomorphisms all results which are available in the ep-groupoid
context are also available in the categorical context. We shall exploit this for 
the main notions and leave it to the reader to deal with the remaining concepts.

\begin{definition}\index{D- Sc$^+$-mulisection functor}
A {\bf sc$^+$-multisection functor} for $P:\mathscr{E}\rightarrow \mathscr{C}$ is a functor 
$\Lambda:\mathscr{E}\rightarrow {\mathbb Q}^+$ such that for a sc-smooth model
$p:W\rightarrow X$ and associated equivalences $\bar{\Gamma}$ and $\Gamma$ the functor 
$$
\bar{\Gamma}^\ast\Lambda := \Lambda\circ\bar{\Gamma}:W\rightarrow {\mathbb Q}^+
$$
is an sc$^+$-multisection functor in the ep-groupoid sense, see Definition \ref{sc+-section-functor}.
\qed
\end{definition}
\begin{remark}
The definition does not depend on the choice of sc-smooth model which follows 
from the behavior of sc$^+$-multisection functors in the ep-groupoid context under 
generalized strong bundle isomorphisms.
\qed
\end{remark}

Given an auxiliary norm $N:\mathscr{E}\rightarrow [0,\infty]$ we can describe the size
of an sc$^+$-multisection functor by the functor $N(\Lambda):\mathscr{C}\rightarrow [0,\infty)$ which we call the 
{\bf point-wise norm}\index{Point-wise norm of $\Lambda$} of $\Lambda$. It is defined for an object $\alpha$ by
$$
N(\Lambda)(\alpha):= \text{max}\{N(\alpha,e)\ |\ (\alpha,e)\in P^{-1}(\alpha),\ \Lambda(\alpha,e)>0\}.
$$
Of course, $|N(\Lambda)|:|\mathscr{C}|\rightarrow [0,\infty)$ provides the same information and 
we shall also refer to it as the point-wise norm. 

For applications the structurable sc$^+$-multsection functors are important and they are defined as follows.
\begin{definition}\label{KLOP000}\index{D- Structurable sc$^+$-multisection functor}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle.  A  sc$^+$-multisection functor 
$\Lambda:\mathscr{E}\rightarrow {\mathbb Q}^+$  is said to be {\bf structurable} provided
for a suitable sc-smooth model $p:W\rightarrow X$ the pull-back $\bar{\Gamma}^\ast\Lambda$ is structurable.
\qed
\end{definition}
As we have seen in Section \ref{SECT134}, in the ep-groupoid context,  the notion of being structurable is being preserved by pull-backs and push-forwards by strong bundle maps and therefore also by
generalized strong bundle isomorphisms. Therefore it does not matter in Definition \ref{KLOP000}
which sc-smooth model is being taken.  If $\Lambda_i:\mathscr{E}\rightarrow {\mathbb Q}^+$, $i=1,2$,
we define the functor $\Lambda_1\oplus\Lambda_2$ by
$$
(\Lambda_1\oplus\Lambda_2)(\alpha,e)=\sum_{e'+e''=e} \Lambda_1(\alpha,e')\cdot\Lambda_2(\alpha,e''),
$$
where $e,e',e''\in \mu(\alpha)$. For a functor  $\beta:\mathscr{C}\rightarrow {\mathbb R}$ we
define $f\odot\Lambda:\mathscr{E}\rightarrow {\mathbb Q}^+$ by 
$$
(\beta\odot\Lambda)(\alpha, e):=\left[ \begin{array}{cc}
\Lambda(\alpha, \beta(\alpha)^{-1}\cdot e) & \text{if}\ \beta(\alpha)\neq 0\\
1 &\text{if}\ \beta(\alpha)=0,\ e=0\\
0&\text{if}\ \beta(\alpha)=0,\ e\neq 0
\end{array}
\right.
$$
From the results in Section \ref{SECT133} we obtain
the following theorem.
\begin{theorem}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle. If
$\Lambda_1,\Lambda_2:\mathscr{E}\rightarrow {\mathbb Q}^+$ are structurable sc$^+$-multisection vectors
and $\beta:\mathscr{C}\rightarrow {\mathbb R}$ is an sc-smooth functor, then 
$$
\Lambda_1\oplus \Lambda_2\ \ \text{and}\ \ \beta\odot\Lambda_1
$$
are structurable sc$^+$-multisection functors.
\qed
\end{theorem}
Structurability is  preserved by pull-backs via proper covering functors. 
This gives the following result which is a consequence of Theorem \ref{OTHM1344}.
\begin{theorem}
Let  $\wt{\mathsf{P}}:\wt{\mathscr{W}}\rightarrow \mathscr{W}$ be an sc-smooth strong bundle proper covering functor between the strong polyfold bundles $\wt{P}:\wt{\mathscr{W}}\rightarrow \wt{\mathscr{C}}$
and $P:\mathscr{W}\rightarrow \mathscr{C}$, or more precisely
$$
\begin{CD}
\wt{\mathscr{W}}@>\wt{\mathsf{P}}>> \mathscr{W}\\
@V\wt{P}VV @V P VV\\
\wt{\mathscr{C}}@> \mathsf{P}>> \mathscr{C}.
\end{CD}
$$
If $\Lambda:\mathscr{W}\rightarrow {\mathbb Q}^+$ is a structurable sc$^+$-multisection functor,
then also $\wt{\mathsf{P}}^\ast\Lambda$ is a structurable sc$^+$-multisection functor.
\qed
\end{theorem}
At this point we have discussed the basic results about sc$^+$-multisections and specifically structurable ones.
In the next section we discuss the construction of sc$^+$-multisection functors as well as extension theorems.

\section{Constructions and Extensions}\label{SERC184}
In order to construct sc$^+$-mulisection functors we need  sc-smooth partitions of unity or at least sc-smooth bump functions.
\begin{definition}\index{D- Admitting sc-smooth partitions of unity}\index{D- Admitting sc-smooth bump functions}
We say that the polyfold $\mathscr{C}$ admits {\bf sc-smooth partitions of unity} or {\bf sc-smooth bump functions}
provided it holds for an sc-smooth model.  
\qed
\end{definition}
\begin{remark}\index{R- On sc-smooth partitions of unity}
The existence of sc-smooth partitions of unity or sc-smooth bump functions is being preserved
under generalized isomorphisms between ep-groupoids and therefore the specific sc-smooth model
occurring in the previous definition does not matter.  If the sc-smooth model $X$, which has a metrizable 
orbit space $|X|$, admits as a M-polyfold sc-smooth partitions of unity then it admits an sc-smooth 
partition of unity in the ep-groupoid sense, i.e. the maps are functors, see the discussion in Subsection \ref{SCPART}.
\qed
\end{remark}
For the next consideration we assume that we  are given a strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$ admitting sc-smooth bump functions.  Consider a smooth object  $\alpha$ with isotropy group $G$ and   let $\bar{\Psi}$ be a strong bundle
uniformizer in $\bar{F}(\alpha)$. This gives us the diagram
$$
\begin{CD}
G \ltimes K @>\bar{\Psi}>> \mathscr{E}\\
@V p VV   @V P VV\\
G\ltimes O @>\Psi>> \mathscr{C}.
\end{CD}
$$
Denote by $\bar{q}\in O$ the unique point satisfying $\Psi(\bar{q})=\alpha$.  Since $|\mathscr{C}|$ is metrizable we can pick an open neighborhood $V$ of $\bar{q}$ in $O$ which is invariant under the $G$-action such that $\cl_{|\mathscr{C}|}(|\Psi(V)|) \subset |\Psi(O)|$. Assume that $(\alpha,e)$ is a smooth vector in $\mathscr{E}$ and let $\bar{h}$ be the preimage
in $K$ under $\bar{\Psi}^{-1}$.
Using sc-smooth bump functions  we can construct an sc$^+$-section $s_1$ on $O$ which vanishes outside of $V$
and satisfies $s_1(\bar{q})=\bar{h}$. Applying the $g$-action we obtain $s_g:O\rightarrow K$ defined by
$$
s_g(g\ast q)=g\ast s_1(q)\ \ \text{for}\ \ q\in O.
$$
Then $s_{1_G}=s_1$ and ${(s_g)}_{g\in G}$ is a symmetric sc$^+$-section structure which vanishes
outside of $V$.
Define $\Lambda:\mathscr{C}\rightarrow {\mathbb Q}^+$ as follows. For $\bar{\Psi}(h)$ with $h\in K$
we define 
$$
\Lambda(\bar{\Psi}(h))=\frac{1}{|G|}\cdot \sharp{\{g\in G\ |\ s_g(p(h))=h\}}.
$$
If $(\beta,e)$ is an object in $\mathscr{E}$ and there exists $(\phi,e):(\beta,e)\rightarrow (t(\phi),\wh{\phi}(e))$
with $t(\phi)\in \Psi(O)$ we define with $\bar{\Psi}(h')=(t(\phi),\wh{\phi}(e))$
$$
\Lambda(\beta,e):=\Lambda(\bar{\Psi}(h')),
$$
where we note that the right-hand side has been previously defined.  
The definition also does not depend on the choice of $\phi$
as long as $t(\phi)\in\Psi(O)$. In the remaining cases
there does not exists $\phi:\beta\rightarrow t(\phi)$ with $t(\phi)\in \Psi(O)$. In this case we define
$$
\Lambda(\beta,e)=\left[\begin{array}{cc}
1 & \ \ \text{if}\ \ e=0\\
0&\ \ \text{otherwise}.
\end{array}
\right.
$$
\begin{proposition}
The previous construction defines an sc$^+$-multisection functor $\Lambda:\mathscr{E}\rightarrow {\mathbb Q}^+$ with $\Lambda(\alpha,e)>0$.  In a suitable sc-smooth model $p:W\rightarrow X$ the pull-back $\bar{\Gamma}^\ast
\Lambda$ is atomic and consequently structurable. Hence $\Lambda$ is a structurable sc$^+$-multisection functor 
for $P$.
\end{proposition}
\begin{proof}
The easy proof is left to the reader and follows immediately from the theory in Chapter \ref{CHAPS13}
discussing sc$^+$-multisection functors in the ep-groupoid context, specifically Theorem \ref{THME1353}.
\qed \end{proof}
The previous result shows how we can construct global structurable sc$^+$-multisec\-tions 
using one uniformizer.  Of course, we could apply the procedure at a finite number of objects 
producing $\Lambda_1,...,\Lambda_k$ which could be summed up to produce $\Lambda=\Lambda_1\oplus..\oplus\Lambda_k$.
More generally,  using an sc-smooth model 
$$
\begin{CD}
W @>\bar{\Gamma} >> \mathscr{E}\\
@V p VV @V P VV\\
X@>\Gamma>> \mathscr{C}
\end{CD}
$$
we can construct for $P:\mathscr{E}\rightarrow \mathscr{C}$ sc$^+$-multisection functors
with a variety of properties by just making the appropriate constructions for $P:W\rightarrow X$ in the ep-groupoid context and 
pushing the data forward by $\bar{\Gamma}$. Chapter \ref{CHAPS13} demonstrated in detail
the wealth of possibilities. We leave the details to the reader and only mention the following extension result
which is the categorical version of Theorem \ref{p-main-p} and can be proved by using an sc-smooth model.
\begin{theorem}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle over a tame polyfold
and assume that $\mathscr{C}$ admits sc-smooth partitions of unity and $N:\mathscr{E}\rightarrow [0,\infty]$ is a given auxiliary norm. Assume that $\Lambda: \mathscr{E}|\partial \mathscr{C}\rightarrow {\mathbb Q}^+$
is a structurable sc$^+$-multisection functor with domain support $\text{dom-supp}(\Lambda)$.
Let $V$ be an open neighborhood of $|\text{dom-supp}(\Lambda)|\subset |\partial\mathscr{C}|$ 
in $|\mathscr{C}|$ and $\beta :\mathscr{C}\rightarrow [0,\infty)$ a continuous functor with 
$|\supp(\beta)|\subset V$ and satisfying
$$
N(\Lambda)(\alpha)< \beta(\alpha)\ \text{for}\ \alpha\ \text{belonging to}\ \text{dom-supp}(\Lambda).
$$
Then there exists a structurable sc$^+$-multisection functor $\Lambda':\mathscr{E}\rightarrow {\mathbb Q}^+$
such that 
\begin{itemize}
\item[{\em (1)}]\ $N(\Lambda')(\alpha)\leq \beta(\alpha)$ on $\mathscr{C}$.
\item[{\em(2)}]\   $|\text{dom-supp}(\Lambda')|\subset V$.
\item[{\em (3)}]\   $\Lambda'|(\mathscr{E}|\partial\mathscr{C})=\Lambda$.
\end{itemize}
\qed
\end{theorem}

\section{Orientations}
In order to use the moduli space $|S_f|$ associated to an sc-Fredholm section functor
to produce invariants we need to perturb it in general by a small generic sc$^+$-multisection functor 
$\Lambda$ to obtain a branched ep$^+$-subcategory $\Theta=\Lambda\circ f$ from which we are  going 
to extract  invariants. Unless $\Lambda$ is single-valued one cannot expect to obtain meaningful
invariants,  unless we also have  an orientation for $\Theta$. As discussed in the ep-groupoid case 
such orientations for $\Lambda\circ f$ are  naturally induced by an orientation for $f$.  In this section 
we import the ideas from the ep-groupoid setting to the categorical set-up, see Section \ref{SEC153}
for the ep-groupoid situation.

Define for a smooth object $\alpha$ the set $\wh{\text{Gr}}_F(\alpha)$ to consist of finite, non-negative rational,
formal
sums $\wh{\mathsf{L}}=\sum_{\wh{L}}\sigma_{\wh{L}}\cdot \wh{L}$, where $\wh{L}=(L,o)$ is an oriented sc-Fredholm operator, and 
$$
L\colon T_\alpha\mathscr{C}\rightarrow \mathscr{E}_\alpha,
$$
with $\mathscr{E}_\alpha=P^{-1}(\alpha)$. That means that only a finite number of the $\sigma_{\wh{L}}$ are non-zero,
and in this case positive rational numbers.
 The collection of all $(\alpha,\wh{\mathsf{L}})$
defines the objects of a category denoted by $\wh{\text{Gr}}_F(\mathscr{C})$ which fibers over
the full subcategory $\mathscr{C}_\infty$ associated to smooth objects in $\mathscr{C}$
$$
\wh{\pi}\colon \wh{\text{Gr}}_F(\mathscr{C})\rightarrow\mathscr{C}_\infty: (\alpha,\wh{\mathsf{L}})\rightarrow \alpha.
$$
The morphisms in $\wh{\text{Gr}}_F(\mathscr{C})$ are pairs $(\phi,\wh{\mathsf{L}})$,
where $\phi$ is a smooth morphism in $\mathscr{C}$ and $s(\phi)=\wh{\pi}(\alpha,\wh{\mathsf{L}})$.
Here $s(\phi,\wh{\mathsf{L}})=(s(\phi),\wh{\mathsf{L}})$ and $t(\phi,\wh{\mathsf{L}})= (t(\phi),\phi_\ast\wh{\mathsf{L}})$ where
$$
\phi_\ast\wh{\mathsf{L}}=\phi_\ast\left(\sum_{\wh{L}}\sigma_{\wh{L}}\wh{L}\right)=\sum_{\wh{L}}\sigma_{\wh{L}}\cdot
\phi_\ast\wh{L},
$$
with  $\phi_\ast(L,o)=(\phi_\ast L,\phi_\ast o)$ and  $\phi_\ast L =\mu(\phi)\circ L\circ T\phi^{-1}$,
so that
$$
(\phi,\wh{\mathsf{L}}):(s(\phi),\wh{\mathsf{L}})\rightarrow (t(\phi),\phi_\ast(\wh{\mathsf{L}})).
$$
In a next step we define the notion of an orientation for an sc-Fredholm section functor of a strong polyfold bundle
$P:\mathscr{E}\rightarrow \mathscr{C}$. For a smooth object $\alpha$ we can consider the convex set of linearizations
$\text{Lin}(f,\alpha)$ consisting of previously defined sc-Fredholm operators $L:T_\alpha\mathscr{C}\rightarrow \mathscr{E}_\alpha$. Just viewing the operators as classical linear Fredholm operators between the Banach spaces on level $0$
we obtain a contractible convex space of Fredholm operators so that the associated determinant bundle 
has two possible orientations.  Following  the ep-groupoid case, see Definition \ref{DEFNG1252}, and properly translated into our set-up we can build a category whose objects are $(\alpha,(\text{DET}(f,\alpha),\mathfrak{o}))$
where $\text{DET}(f,\alpha)$ stands for the topological line bundle $\text{DET}(f,\alpha)\rightarrow \text{Lin}(f,\alpha)$
and $\mathfrak{o}$ for an orientation of the latter.  If we have picked an orientation
$\mathfrak{o}$ the only other possible orientation is then $-\mathfrak{o}$.
The class of all such objects is denoted by ${\mathscr{O}}_f$ and it fibers over $\mathscr{C}_\infty$ via
$$
\sigma\colon {\mathscr{O}}_f\rightarrow \mathscr{C}_\infty:(\alpha,(\text{DET}(f,\alpha),\mathfrak{o}))\rightarrow \alpha.
$$
The morphisms have the form $(\phi,(\text{DET}(f,\alpha),\mathfrak{o}))$ with $s(\phi)=\alpha$,
where we view such a morphisms as 
$$
(\phi,(\text{DET}(f,\alpha),\mathfrak{o})):(\alpha, (\text{DET}(f,\alpha),\mathfrak{o}))\rightarrow
(t(\phi),  (\text{DET}(f,t(\phi)),\phi_\ast(\mathfrak{o}))).
$$
\begin{definition}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle and $f$ an sc-Fredholm section functor.
The category $\sigma: \mathscr{O}_f\rightarrow \mathscr{C}_\infty$ fibering over the smooth object category 
is called the {\bf orientation category} associated to $f$.
\qed
\end{definition}
We note that a smooth morphism $\phi:\alpha\rightarrow \alpha'$ lifts to a bijection
$\phi_\ast$ between two-point sets
$$
 \{(\text{DET}(f,\alpha),\mathfrak{o}),(\text{DET}(f,\alpha),-\mathfrak{o})\}\rightarrow
\{(\text{DET}(f,\alpha'),\mathfrak{o}'),(\text{DET}(f,\alpha'),-\mathfrak{o}' )\}.
$$
If $\alpha$ has nontrivial isotropy  it can in principle happen that for a suitable
$g\in G_\alpha$ it holds that $g_\ast (\text{DET}(f,\alpha),\pm\mathfrak{o})=(\text{DET}(f,\alpha),\mp\mathfrak{o})$,
which obstructs orientability of $f$.

Next we introduce the notion of an orientation, which defined by several properties. We shall begin 
with the more algebraic requirements. An orientation, if it exists, associates in particular to a smooth object $\alpha$ one of the two possible orientations 
for $\text{DET}(f,\alpha)$, i.e. it is  a section functor $\mathsf{o}$ of $\sigma$ and can be written as 
$$
\alpha\rightarrow \mathsf{o}_\alpha = (\alpha,(\text{DET}(f,\alpha),\mathfrak{o}_\alpha)).
$$
Moreover, $\mathsf{o}$ is assumed to be a functor, so that the choice of orientations is compatible with
morphisms
$$
\mathsf{o}_{t(\phi)}=\phi_\ast\mathsf{o}_{s(\phi)}\ \ \text{for smooth morphisms}\ \phi.
$$
Besides these purely functorial properties one needs a version of local propagation, i.e. local continuity
as in the ep-groupoid case, see Section \ref{SECTX65} and specifically Definition \ref{SDEF6511}.
We need some preparation.  Given $\bar{\Psi}\in \bar{F}(\alpha)$ for a smooth object $\alpha$ we obtain the commutative 
functor diagram
$$
\begin{CD}
G_\alpha\ltimes K@>\bar{\Psi} >> \mathscr{E}\\
@Af_{\bar{\psi}}AA @A fAA\\
G_\alpha\ltimes O @ >\Psi>>  \mathscr{C}.
\end{CD}
$$
For a smooth element $q\in O$   the map
$$
\bar{\Psi}_\ast\colon {\mathcal L}(T_qO,K_q)\rightarrow {\mathcal L}(T_{\Psi(q)}\mathscr{C},\mathscr{E}_{\Psi(q)}):L\rightarrow \bar{\Psi}(q)\circ L\circ (T\Psi(q))^{-1}
$$
defines a bijection between sc-operators and preserves several types of maps.
For example sc-Fredholm operators are mapped to sc-Fredholm operators
and sc$^+$-operators are mapped to sc$^+$-operators.  Given an sc-Fredholm operator $L$ above $q$,
an orientation $\mathfrak{o}$ for $\det(L)$ is mapped canonically to an orientation $\bar{\Psi}(q)_\ast \mathfrak{o}$
 of $\det(\bar{\Psi}_\ast L)$ using the linear isomorphisms
$T\Psi(q)$ and $\bar{\Psi}(q)$ which establish  correspondences between the kernels and co-kernels.
Hence we have a push-forward operation for orientations which we denote by $\bar{\Psi}_\ast$ and its inverse is
the pull-back $\bar{\Psi}^\ast$.
As a consequence, given a section functor $\mathsf{o}$ for $\sigma:\mathscr{O}_f\rightarrow \mathscr{C}_\infty$ 
we can consider the associated $\mathsf{o}_{\bar{\Psi}} =\bar{\Psi}^\ast\mathsf{o}$, which associates to
$\text{DET}(f_{\bar{\Psi}},q)$ an orientation ${(\mathsf{o}_{\bar{\Psi}})}_q$.

Given a smooth morphism $\phi:\alpha\rightarrow \alpha'$, $\bar{\Psi}\in \bar{F}(\alpha)$ and $\bar{\Psi}'\in\bar{F}(\alpha')$
we obtain associated to $\Phi=(\bar{q},\phi,\bar{q}')$, where $\Psi(q)=\alpha$, $\Psi'(\bar{q}')=\alpha'$,  a local sc-diffeomorphism 
$\wh{\Phi}: (U(\bar{q}),\bar{q})\rightarrow (U(\bar{q}'),\bar{q}')$.  This local sc-diffeomorphism together 
with its lift $\bar{\Phi}$ to the bundles allows to pull-back the germ of $\mathsf{o}_{\bar{\Psi}'}$ near $\bar{q}'$ 
and we obtain near $\bar{q}$ the following identity of germs
$$
\bar{\Phi}^\ast \mathsf{o}_{\bar{\Psi}'} =\mathsf{o}_{\bar{\Psi}}\ \ \text{near}\ \ \bar{q}.
$$
The pull-back operation $\bar{\Phi}$ has clearly a continuity property. 
\begin{definition}\index{D- Continuity property of $\mathsf{o}$}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle and $f$ an sc-Fredholm section functor.
Denote by $\sigma:\mathscr{O}_f\rightarrow \mathscr{C}_\infty$ the associated orientation category.
Let $\mathsf{o}$ be a section functor of $\sigma$. We say that $\mathsf{o}$ has the {\bf continuity property},
provided for every class $z\in |\mathscr{C}_\infty|$, representative $\alpha_z$ of $z$ and $[\bar{\Psi}:G\ltimes K\rightarrow \mathscr{C}]\in\bar{F}(\alpha_z)$, where $p:K\rightarrow O$, $\bar{o}\in O$ with $\Psi(\bar{o})=\alpha$, the following holds.
If $f_{\bar{\Psi}}:O\rightarrow K$ is the local representative of $f$ equipped with the orientations $\bar{\Gamma}^\ast\mathsf{o}$, then the orientations near $\bar{o}$ are related by continuation.
\qed
\end{definition}
\begin{remark}\index{R- On the continuity property of $\mathsf{o}$}
The above definition requires an orientation check for a set of objects $\{\alpha_z\ |\ z\in |\mathscr{C}_\infty|\}$,
where we pick for every $z$ a $\bar{\Psi}_z\in \bar{F}(\alpha_z)$. If we take now an arbitrary $\bar{\Psi}$
in some $\bar{F}(\alpha)$ the sc-smoothness of the associated strong transition bundle guarantees
that also with respect to $\bar{\Psi}$ we have local continuity. This follows from the previous discussion.
\qed
\end{remark}
\begin{definition}[Orientation for $f$]\index{D- Orientation for $f$}
Let $P:\mathscr{E}\rightarrow \mathscr{C}$ be a strong polyfold bundle and $f$ an sc-Fredholm section functor.
An {\bf orientation} for $f$ is given by a  section functor $\mathsf{o}$ of $\sigma:{\mathcal O}_f\rightarrow \mathscr{C}_\infty$  which has the continuity property. If such a section $\mathsf{o}$ exists we call $f$ {\bf orientable}.\index{D- Orientable sc-Fredholm section functor}
\qed
\end{definition}
\begin{remark}
We leave the verification of the following to the reader. If $f$ is an orientable sc-Fredholm section functor of $P$
then $\sigma:{\mathcal O}_f\rightarrow \mathscr{C}_\infty$, when passing to orbit spaces, defines 
a ${\mathbb Z}_2=\{-1,1\}$-bundle over $|\mathscr{C}_\infty|$ which we denote by 
$|\sigma|:|{\mathcal O}_f|\rightarrow |\mathscr{C}_\infty|$.  An orientation  $\mathsf{o}$ defines a continuous section $|\mathsf{o}|$ of $|\sigma|$.
Moreover, $f$ is orientable provided $|\sigma|:|{\mathcal O}_f|\rightarrow |\mathscr{C}_\infty|$ is a $(2:1)$-map and admits a continuous section.
See also Proposition \ref{PROPT1256} for the ep-groupoid case.
\qed
\end{remark}
Assume that $f$ is an sc-Fredholm section of the strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$.
Given two different covering families $\bm{\Psi}$ and $\bm{\Psi}'$ we obtain
$$
\begin{array}{cc}
\begin{CD}
W @>\bar{\Gamma}>> \mathscr{E}\\
@A f_{\bm{\bar{\Psi}}} AA @A f AA\\
X @>\Gamma>> \mathscr{C}
\end{CD}\ \ \ 
&\ \ \ 
\begin{CD}
W' @>\bar{\Gamma}'>> \mathscr{E}\\
@A \bar{f}_{\bm{\bar{\Psi}}'} AA @A f AA\\
X' @>\Gamma'>> \mathscr{C}.
\end{CD}
\end{array}
$$
The following holds true.
\begin{proposition} 
Assume that $f$ is an sc-Fredholm section functor of the strong polyfold bundle $P:\mathscr{E}\rightarrow \mathscr{C}$.
\begin{itemize}
\item[{\em (1)}] \  The orientability of $f$ is equivalent to the orientability of $f_{\bm{\bar{\Psi}}}$.
\item[{\em (2)}]\   An orientation for $f$ pulls-back to an orientation for $f_{\bm{\bar{\Psi}}}$ and an orientation
for $f_{\bm{\bar{\Psi}}'}$.
\item[{\em (3)}]\  Given orientations $\mathsf{o}$ for $f_{\bm{\bar{\Psi}}}$ and $\mathsf{o}'$
for $f_{\bm{\bar{\Psi}}'}$ they correspond to the same orientation for $f$ provided the natural generalized
strong bundle isomorphism $\bar{\mathfrak{f}}:W_{\bm{\bar{\Psi}}}\rightarrow W_{\bm{\bar{\Psi}}'}$
covering $\mathfrak{f}:X_{\bm{\Psi}}\rightarrow X_{\bm{\Psi}'}$  pulls back $\mathsf{o}'$ to $\mathsf{o}$.
\end{itemize}
\end{proposition}
\begin{proof}
The proof goes along the lines of the proof of Theorem \ref{THMS1257} and is left to the reader.
\qed \end{proof}








\section{Perturbation Theory}
We assume that $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong polyfold bundle over a tame $\mathscr{C}$, and $N:\mathscr{E}\rightarrow [0,\infty]$  an auxiliary norm. We study sc-Fredholm section functors $f$ of $P$ which have compact moduli spaces
$|S_f|$. We can fix an open neighborhood $U$ of $|S_f|$ so that 
$$
\cl_{|\mathscr{C}|}(\{z\in U\ |\ |N|\circ |f|(z)\leq 1 \})\ \ \text{is compact}.
$$
We shall use the latter fact to show that there are many structurable sc$^+$-multisection functors $\Lambda:\mathscr{E}\rightarrow {\mathbb Q}^+$, which are small with respect to $(N,U)$, which controls compactness,
so that $\Theta:\mathscr{C}\rightarrow {\mathbb Q}^+$ defined by
$$
\Theta(\alpha) =\Lambda\circ f(\alpha)
$$
is a  ep$^+$-subcategory with the standard properties:
\begin{itemize}
\item[(1)]\  $|\supp(\Theta)|\subset U$.
\item[(2)]\  $\Theta$ is compact.
\item[(3)]\ $f'(\alpha):T_\alpha\mathscr{C}\rightarrow P^{-1}(\alpha)$ is surjective for every $\alpha$ belonging to the support of $\Theta$.
\item[(4)]\ In addition we can force good boundary behavior, for example $\Theta$ is in general position
or in in good position, both implying that $\Theta$ is tame.
\end{itemize}
In applications, depending on the situation, we might be able to take a $\Lambda$ which only takes the values
$\{0,1\}$ to achieve the above.  In this case $|\supp(\Theta)|$ has naturally the structure of a compact orbifold with boundary and corners.  If we know in addition that between any two objects in the support of $\Theta$ there is at most one 
morphism it follows that $|\supp(\Theta)|$ has naturally the structure of a smooth compact manifold with boundary with corners. If in addition $f$ is oriented via $\mathsf{T}_f$ it follows that $|\supp(\Theta)|$ is naturally oriented either as an orbifold or manifold.
Of course, as in the ep-groupoid case, a general perturbation for which $\Theta$ is a branched ep$^+$-subcategory is always possible.
The following results are immediate corollaries of results proved in the ep-groupoid context.

\begin{theorem}
Assume that $P:\mathscr{E}\rightarrow \mathscr{C}$ is a strong polyfold bundle over a tame $\mathscr{C}$ admitting sc-smooth bump functions and $f$ is an sc-smooth section functor of $P$ with compact $|S_f|$. Assume that $N:\mathscr{E}\rightarrow [0,\infty]$
is an auxiliary norm and $U$ an open neighborhood of $|S_f|$ so that $(N,U)$ controls compactness. Let $h:\mathscr{C}\rightarrow (0,1]$
be a continuous functor. Then there exists an sc$^+$-multisection functor $\Lambda:\mathscr{C}\rightarrow {\mathbb Q}^+$ with the following properties.
\begin{itemize}
\item[{\em (1)}]\   $N(\Lambda)(\alpha) < h(\alpha)$ for all objects in $\mathscr{C}$.
\item[{\em (2)}]\   The domain support of $\Lambda$ is contained in $\mathscr{C}_U$.
\item[{\em(3)}]\   $\mathsf{T}_{(f,\Lambda)}$ is surjective for objects in $\supp(\Lambda\circ f)$.
\item[{\em (4)}]\   For an object in $\supp(\Lambda\circ f)$ the kernels of the operators $\mathsf{T}_{(f,\Lambda)}(\alpha)$
are in general position to $\partial\mathscr{C}$.
\end{itemize}
In particular $\Lambda\circ f:\mathscr{C}\rightarrow {\mathbb Q}^+$ is a compact, tame, branched ep$^+$-subcategory.
Further the perturbation $\Lambda$ can be taken structurable.
\end{theorem}
\begin{proof}
Follows directly from Theorem \ref{THM1536} by studying the question in a smooth model.
\qed \end{proof}
We can also easily bring Theorem \ref{THM1537} into the polyfold context. As an exercise the reader  might also prove a version of  Theorem \ref{THMX5.3.12} for the  ep-groupoid case, and its polyfold generalization. Another good and useful exercise is the generalization of Theorem \ref{MORSE-type} to an ep-groupoid as well as a categorical context.



\chapter{General Constructions}\label{CHAPTER19X}
In this chapter we shall describe several basic constructions which are very useful in applications, i.e. 
the construction of moduli spaces in concrete situations.  In  \cite{FH2} we shall describe new tools in the context
of symplectic geometry, which focus on developing a modular approach to the construction of moduli spaces in symplectic geometry. The procedure 
leads to polyfold structures on certain groupoidal categories $\mathscr{S}$, strong bundle structures for $P:{\mathcal E}\rightarrow \mathscr{S}$,
and a Fredholm theory for certain section functors of $P$. The theory in Chapters \ref{CHAPX17} and \ref{CHAPX18} then allows to construct moduli spaces.


\section{The Basic Constructions}\label{SECX19.1}
We start with a familiar definition.
\begin{definition}\index{D- Groupoidal category}\label{DEFNX19.1.1}
A category  $\mathscr{S}$ is said to be a {\bf groupoidal  category} provided the following holds.
\begin{itemize}
\item[(1)]\   Every morphism is an isomorphism.
\item[(2)]\   Between any two objects 
there are at most only a finite number of morphisms.
\item[(3)]\  The class of isomorphism classes of objects is a set.
\end{itemize}
\qed
\end{definition}
We shall obtain the polyfold structure on $\mathscr{S}$, and later on similarly the strong bundle structure 
on $P:{\mathcal E}\rightarrow \mathscr{S}$,  as a consequence of a particular kind of construction, which we shall introduce now.
This type of  construction will produce in the case of a groupoidal category $\mathscr{S}$ the following at the same time.
\begin{itemize}
\item[$\bullet$] A natural topology ${\mathcal T}$ on the orbit space $|\mathscr{S}|$. In case ${\mathcal T}$ is metrizable 
the pair $(\mathscr{S},{\mathcal T})$ is a GCT, see Definition \ref{DEF_GCT}.
 \item[$\bullet$] A  structure for the GCT $(\mathscr{S},{\mathcal T})$, which is a polyfold structure provided ${\mathcal T}$ is metrizable.
\end{itemize}

That ${\mathcal T}$ is metrizable has to be studied in any given context by an adhoc method. It will turn out that ${\mathcal T}$ is always locally metrizable, i.e.
every point in $|\mathscr{S}|$ will have an open neighborhood on which the topology is metrizable. This, of course, does not imply that the topology is Hausdorff.
There are criteria, which we shall
describe later,  which are easy to apply in practice, and which  guarantee that ${\mathcal T}$ is Hausdorff and completely regular. 
If one can show that in addition the topology is second countable, Urysohn's metrizability theorem implies that ${\mathcal T}$ is metrizable ({\bf Urysohn's metrization theorem}\index{Urysohn's metrization theorem}: A second countable, regular Hausdorff space is metrizable.).
In many applications this is not too difficult to show.  Alternatively,  if ${\mathcal T}$ is paracompact (rather than second countable) in addition to being
regular and Hausdorff,  the Nagata-Smirnov theorem implies metrizability as well. ({\bf Nagata-Smirnov metrization theorem}: A topological space is metrizable if and only if it is regular, Hausdorff and has a countably locally finite basis, i.e the topology has a basis which is a countable union of sets of open sets which are locally finite.  In particular, a paracompact regular Hausdorff space, which is locally metrizable is metrizable, see \cite{RS})\index{Nagata-Smirnov metrization theorem}. 



We need the following definition.
\begin{definition}
Let $\mathscr{S}$ be a groupoidal category and $\alpha$ an object with isotropy group $G$.
We shall call a functor  
$$
\Psi:G\ltimes O\rightarrow \mathscr{S}
$$
a {\bf uniformizer}\index{D- Uniformizer  at $\alpha$} at $\alpha$ provided it has  the following properties.
\begin{itemize}
\item[(1)] \  $G\ltimes O$ is the translation groupoid consisting of the M-polyfold $O$ with  $G$ acting by sc-diffeomorphism.
\item[(2)] \  $\Psi$ is injective on objects and fully faithful.
\item[(3)] \ There exists $\bar{o}\in O$ with $\Psi(\bar{o})=\alpha$.
\end{itemize}
\qed
\end{definition}

We denote by $\mathscr{S}^-$ the category which has the same objects as $\mathscr{S}$,
but only has the identities as morphisms.
 The first part of the data is
given by a functor 
$$
F:\mathscr{S}^-\rightarrow \text{SET}
$$
 associating to every object $\alpha$ (with automorphism group $G$)
a set $F(\alpha)$ consisting of uniformizers at $\alpha$.
\begin{definition}\index{D- Uniformizer construction}
Given a groupoidal category $\mathscr{S}$ a functor $F:\mathscr{S}^-\rightarrow \text{SET}$,
which associates to an object $\alpha$ a set of uniformizers $F(\alpha)$ at $\alpha$ is called
a {\bf uniformizer construction}.
\qed
\end{definition}
\begin{remark} \index{R- Functoriality of uniformizer constructions}
In most applications $F$ is in fact a functor defined on $\mathscr{S}$. That means  that 
given a morphism $\Phi:\alpha\rightarrow \alpha'$ we obtain a bijection $F(\Phi):F(\alpha)\rightarrow F(\alpha')$.
As  part of the constructions in many cases  even more is true and  $F(\Phi)$ will have  a geometric meaning, see 
for example Remark \ref{REM1716}.
\qed
\end{remark}

Once $F$ is given, we can consider  the transition sets ${\bm{M}}(\Psi,\Psi')$ associated
to the functors $\Psi$ and $\Psi'$. 
For $\Psi\in F(\alpha)$ and $\Psi'\in F(\alpha')$ the  {\bf transition set}
${\bm{M}}(\Psi,\Psi')$\index{Transition set}  is given as the weak fibered product associated to the diagram
$$
O\xrightarrow{\Psi} \mathscr{S} \xleftarrow{\Psi'} O'.
$$
More precisely 
$$
{\bm{M}}(\Psi,\Psi')=\{(o,\Phi,o')\ |\ o\in O,\ o'\in O',\ \Phi:\Psi(o)\rightarrow\Psi'(o')\}.
$$
This construction comes with several maps called {\bf structure maps}\index{Structure maps}. Namely 
\begin{itemize}
\item $s:{\bm{M}}(\Psi,\Psi')\rightarrow O:(o,\Phi,o')\rightarrow o$, the {\bf source map}.
\item  $t:{\bm{M}}(\Psi,\Psi')\rightarrow O':(o,\Phi,o')\rightarrow o'$, the {\bf target map}.
\item  $u:O\rightarrow {\bm{M}}(\Psi,\Psi):o\rightarrow (o,1_{\Psi(o)},o)$, the {\bf unit map}.
\item $\iota:{\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi',\Psi):(o,\Phi,o')\rightarrow (o',\Phi^{-1},o')$, the {\bf inversion map}.
\item $m:{\bm{M}}(\Psi',\Psi''){_{s}\times_t}{\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi,\Psi'') :m((o',\Phi',o''),(o,\Phi,o'))=(o,\Phi'\circ\Psi,o'')$, the {\bf multiplication map}.
\end{itemize}
Given  $F$, we have for every object $\alpha$ a set of fully faithful functors $\Psi:G\ltimes O\rightarrow \mathscr{S}$ 
 having $\alpha$ in the image. Of course,
there is at this point no compatibility requirement between different uniformizers. Also note that we cannot talk about continuity properties
of $|\Psi|$ since $|\mathscr{S}|$ is not even equipped with a topology yet.






The second set of data, denoted by ${\mathcal F}$, consists of  a construction involving the transition sets.
It  associates to $h=(o,\Phi,o')\in {\bm{M}}(\Psi,\Psi')$ a germ of map 
$$
F_h:{\mathcal O}(O,o)\rightarrow ({\bm{M}}(\Psi,\Psi'),h)
$$
having the following properties, were we abbreviate $f_h:= t\circ F_h$, which is a germ of map $f_h:{\mathcal O}(O,o)\rightarrow {\mathcal O}(O',o')$.
We can think of $F_h$ as a map defined on an open neighborhood of $o$.


\noindent{\bf (A) Diffeomorphism Property:}  The germs $f_h:{\mathcal O}(O,o)\rightarrow {\mathcal O}(O',o')$ are local sc-diffeomorphisms, and 
$s(F_h(q))=q$ for $q$ near $o$. If $\Psi=\Psi'$ and $h=(o,\Psi(g,o),g\ast o)$ then $F_h(q) = (q,\Psi(g,q),g\ast q)$ for $q$ near $o$, so that $f_h(q)=g\ast q$.


\noindent{\bf (B) Stability Property:}  $F_{F_{h}(q)}(p)= F_h(p)$ for $q$ near $o=s(h)$ and $p$ near $q$.


\noindent{\bf (C) Identity Property:}  $F_{u(o)}(q) =u(q)$ for $q$ near $o$.


\noindent{\bf (D) Inversion Property:} $F_{\iota(h)}(f_h(q)) = \iota(F_h(q))$ for $q$ near $o=s(h)$.

\noindent{\bf (E) Multiplication  Property:}   If $s(h')=t(h)$ then $f_{h'}\circ f_h(q)=f_{m(h',h)}(q)$ for $q$ near $o=s(h)$ and 
 $m(F_{h'}(f_h(q)),F_h(q))=F_{m(h',h)}(q)$ for $q$ near $o=s(h)$.


\noindent{\bf (F) $\bm{M}$-Hausdorff Property:}  For different $h_1,h_2\in {\bm{M}}(\Psi,\Psi')$ with $o=s(h_1)=s(h_2)$  the images under $F_{h_1}$ and $F_{h_2}$ of small neighborhoods $o$ are disjoint.

\begin{definition}\label{DEFNX19.1.5}
The construction ${\mathcal F}$ is called a {\bf transition construction}\index{Transition construction}  associated to the uniformizer construction $F$.
\qed
\end{definition}

Usually, in applications,  the constructions $F$ and  ${\mathcal F}$ are natural and the listed properties are consequences of this naturality.
\begin{definition}\label{DEF1916}\index{D- Basic construction}
Given a groupoidal category $\mathscr{S}$ we shall refer to $(F,{\mathcal F})$, where the  functor $F:\mathscr{S}^-\rightarrow\text{SET}$ is a uniformizer
construction and ${\mathcal F}$ is an associated transition construction,  \index{Transition construction} 
 as a {\bf basic construction}\index{Basic construction}.
 \qed
\end{definition}
\begin{remark}\index{R- Remarks on transition constructions}
The Properties (A) and  (D)  say that there exist for $h\in \bm{M}(\Psi,\Psi')$ with $h=(o,\Phi,o')$ open neighborhoods $V(o)$ and $V(o')$
with the property that $f_h:(V(o),o)\rightarrow (V(o'),o')$ is an sc-diffeomorphism, and $F_{\iota(h)}(f_h(q))=\iota(F_h(q))$ for $q\in V(o)$.
Of course if $\Psi=\Psi'$ the transition set $\bm{M}(\Psi,\Psi)$ has a special form and consists of all $(q,\Psi(g,q),g\ast q)$, with $q\in O$ and $g\in G$.
In this special case (A) requires that on a suitable open neighborhood $V(o)$ it holds  $f_{(o,\Psi(g,o),g\ast o)}(q)=g\ast q$ and $F_{(o,\Psi(g,o),g\ast o)}(q)=(q,\Psi(g,q),g\ast q)$.

The Property (C) stipulates the existence of $V(o)$ with $F_{u(o)}(q)=u(q)$ for $q\in V(o)$. From the multiplication property with $h'=(o',\Phi',o'')$ 
we have the existence of three open neighborhoods $V(o)$, $V(o')$, and $V(o'')$ such that $f_h:(V(o),o)\rightarrow (V(o'),o')$ and $f_{h'}:(V(o'),o')\rightarrow (V(o''),o'')$
are sc-diffeomorphisms  and the following holds $f_{h'}\circ f_h(q)=f_{m(h',h)}(q)$ for $q\in V(o)$ and $m(F_{h'}(f_h(q)),F_h(q))=F_{m(h',h)}(q)$ for $q\in V(o)$.
These are, given the underlying structures, natural properties.  All these properties persist if we pass to smaller neighborhoods.

The properties we have discussed  allow us to consider $F_h(q)$ as an element close to $h$ in $\bm{M}(\Psi,\Psi')$ provided $q$ is close to $s(h)$.
The Stability Property (B) then says that the map  $F_{h^\ast}$ for $h^\ast$ near $h$ is the same as $F_h$, i.e. a stability property of the constuction. More precisely
(B) guarantees given $h=(o,\Phi,o')\in \bm{M}(\Psi,\Psi')$ an open neighborhood, again denoted by $V(o)$,
such that $F_{F_h(q)}(p)=F_h(p)$ for $q\in V(o)$ provided $p\in V(o)$ and $p$ is close to $q$.

The Hausdorff property just says that two different elements $h_1$ and $h_2$ with the same source should be considered as far apart
given our notion of `nearness' coming from $F_h$.
\qed
\end{remark}

In the following we shall derive the important  properties of a basic construction. The two important facts are that a basic construction defines
a natural topology ${\mathcal T}$ on the orbit space $|\mathscr{S}|$. This topology in general does not need to be well-behaved, and its properties 
in concrete situation have to be investigated. Moreover a basic construction defines also a metrizable topology on every $\bm{M}(\Psi,\Psi')$.


\section{The Natural Topology \texorpdfstring{${\mathcal T}$}{T} for \texorpdfstring{$\vert\mathscr{S}\vert$}{S}}   \label{SECNX19.2}
The starting point is a groupoidal category $\mathscr{S}$ and a basic construction  $(F,{\mathcal F})$.
Associated to the basic construction  there is a natural topology ${\mathcal T}$ on $|\mathscr{S}|$, which we shall construct now.
\begin{definition}\label{DEF1921}
Assume $\mathscr{S}$ is a groupoidal category and $(F,{\mathcal F})$ a basic construction.
The collection ${\mathcal T}$ of subsets of $|\mathscr{S}|$ consists of all subsets $U$ of $|\mathscr{S}|$ so that for every point $z\in U$
there exists an object $\alpha_z$ with $|\alpha_z|=z$,  $\Psi\in F(\alpha_z)$, and an open neighborhood
$V(\bar{o})$, where $\Psi(\bar{o})=\alpha_z$, such that $|\Psi(V(\bar{o}))|\subset U$.
\qed
\end{definition}
The basic topological result is given by the following theorem.
\begin{theorem}\label{TOPOLOGY}
Assume that we are given for the groupoidal category $\mathscr{S}$ a basic construction $(F,{\mathcal F})$.
Then the following holds.
\begin{itemize}
\item[{\em (1)}]\  The set ${\mathcal T}$ defined in Definition \ref{DEF1921} defines a topology on $|\mathscr{S}|$.
\item[{\em (2)}]\   With $\Psi\in F(\alpha)$, say $\Psi:G\ltimes O\rightarrow \mathscr{S}$, and an open subset $V$ of $O$
the set $|\Psi(V)|$ is open in $|\mathscr{S}|$.
\item[{\em (3)}]\ With $\Psi$ as above $|\Psi|: {_G\backslash O} \rightarrow |\mathscr{S}|$ is a homeomorphism onto an open neighborhood of $|\alpha|$.
\item[{\em (4)}]\    For the topology ${\mathcal T}$ every point has a countable neighborhood basis.
\item[{\em (5)}]\   Every point in $|\mathscr{S}|$ has (for ${\mathcal T}$) an open neighborhood which is metrizable.
({\em (5)} implies {\em(4)}).

\end{itemize}
\end{theorem}
\begin{remark}\index{R- On Hausdorffness}
There is in general no reason that ${\mathcal T}$ is Hausdorff.  We shall address this question and the related 
metrizability   question for ${\mathcal T}$ later on.
\end{remark}
\begin{proof}
\noindent (1) By the definition  of ${\mathcal T}$ it is clear that $\emptyset$ and $|\mathscr{S}|$ belong to $\mathscr{S}$.
If ${(U_\lambda)}_{\lambda\in\Lambda}$ is a family of sets in ${\mathcal T}$ it follows immediately from the construction
that $U=\bigcup_{\lambda\in\Lambda} U_\lambda$ belongs to ${\mathcal T}$. 

Let $U_1,...,U_k$ be a finite
family of elements in ${\mathcal T}$ and $z\in U:=\bigcap_{i=1}^k U_i$. 
For $z\in U_i$ we find 
$\Psi_i:G_i\ltimes O_i\rightarrow \mathscr{S}$ with $\Psi_i(\bar{o}_i)=\alpha_i$ and $|\alpha_i|=z$ 
so that for a suitable open neighborhood $V_i'$ of $\bar{o}_i$ we have  
$$
|\Psi_i(V_i')|\subset U_i.
$$
 We find  $h_i=(\bar{o}_1,\Phi_i,\bar{o}_i)\in {\bm{M}}(\Psi_1,\Psi_i)$ and take the associated germs $f_{h_i}:{\mathcal O}(O_1,\bar{o}_1)\rightarrow {\mathcal O}(O_i,\bar{o}_i)$.
By replacing $V_1' $ by a possibly  smaller  open neighborhood $V_1$ of $\bar{o}_1$ we may assume that all $V_i:=f_{h_i}(V_1)$ are open and contained in $V_i'$. In addition we may assume that $F_{h_i}$ is defined on $V_1$. Since $f_{h_i}=t\circ F_{h_i}$
it follows that $|\Psi_i(f_{h_i}(v))|=|\Psi_1(v)|$ for $v\in V_1'$ and consequently
$|\Psi_1(V_1)|\subset U$, which completes the proof that ${\mathcal T}$ is a topology.\par



\noindent (2) Assume that $\Psi(\bar{o})= \alpha$.  Let  $V\subset O$ be open and consider
the set $|\Psi(V)|$.  Take $z'\in |\Psi(V)|$ and  an object $\alpha'$ with $|\alpha'|=z'$.
Pick $\Psi'\in F(\alpha')$ with  $\Psi'(\bar{o}')=\alpha'$. For a suitable $o\in V$ we find an element
$h=(\bar{o}',\Phi,o)\in{\bm{M}}(\Psi',\Psi)$. Take the associated germ $f_h$.  We find an open neighborhood
$V'$ of $\bar{o}'$ which is sc-diffeomorphically mapped onto an open neighborhood of $o$ which we may assume
to be contained in $V$. This shows that $z'\in |\Psi'(V')|\subset |\Psi(V)|$, using that $F_h(q')=(q',\Phi_h(q'), f_h(q'))$,
implying $|\Psi(f_h(q'))|=|\Psi'(q')|$. \par

\noindent (3)  In view of (2) the set $U=|\Psi|({_G\backslash} O)=|\Psi(O)|$ is an open neighborhood of $|\alpha|$.
Consider $|\Psi|:{_G\backslash} O\rightarrow U$. This map is a bijection since $\Psi$ is fully faithful.
We first show the continuity. Pick a point $G\ast o$ in ${_G\backslash} O$ and define $z'=|\Psi(G\ast o)|$.
Pick an open neighborhood $V$ around $z'$. We find $\alpha'$ representing $z'$ and $\Psi'\in F(\alpha')$ 
so that $\Psi'(\bar{o}')=\alpha'$ and $|\Psi'(W')|\subset V$ for a suitable open neighborhood $W'$ of $\bar{o}'$.
We find an element $h=(o,\Phi,\bar{o}')$ and take the corresponding $f_h$. For a sufficiently small
open neighborhood $W$ of $o$  the open image $f_h(W)$ is contained in $W'$. Moreover for $w\in W$
$$
s(F_h(w))=w\ \text{and}\ \ t(F_h(w))=f_h(w),
$$
where $F_h$ has the form  $F_h(w)=(w,\Phi_w,f_h(w))$. Therefore $\Phi_w:\Psi(w)\rightarrow \Psi'(f_h(w))$ and
$$
|\Psi(w)| = |\Psi'(f_h(w))|
$$
implying $|\Psi(W)|\subset |\Psi'(W')|$. Then $|\Psi(G\ast W)|\subset V$. This proves continuity.
Since for an open subset $A$ in $O$ the image $|\Psi(A)|$ is open we conclude that $|\Psi|$ is open
and this completes the proof of (3). \par

\noindent (4) For given $z\in |\mathscr{S}|$ pick an object $\alpha$ satisfying $z=|{\alpha}|$ and $\Psi\in F(\alpha)$.
Let $\Psi(\bar{o})=\alpha$ and note that $\bar{o}$ has a countable neighborhood basis in $O$, say
$$
 V_1\supset V_2\supset V_3\supset...
 $$
In view of (2)  every $|\Psi(V_i)|$ is an open neighborhood 
of $z$. Pick any open neighborhood $U$ of $z$. We have to show that for sufficiently large $i$ 
it holds $|\Psi(V_i)|\subset U$.  We find $\Psi'\in F(\alpha')$ with $z=|\alpha'|$ and an open neighborhood
$V'$ of $\bar{o}'$, where $\Psi'(\bar{o}')=\alpha'$, with $|\Psi'(V')|\subset U$.  Since we have a morphism $\Phi:\Psi(\bar{o})\rightarrow \Psi'(\bar{o}')$
can take $f_h$, where $h=(\bar{o},\Phi,\bar{o}')$. We find $i$ such that $f_h(V_i)\subset V'$. 
This proves that $z\in |\Psi(V_i)|\subset U$.\par

\noindent (5) For $z\in |\mathscr{S}|$ pick an object $\alpha$ with $|\alpha|=z$ and $\Psi\in F(\alpha)$.  Then 
$$
\Psi:G\ltimes O\rightarrow \mathscr{S}
$$
with $\Psi(\bar{o})=\alpha$.  Then $|\Psi|(|G\ltimes O|)|=|\Psi(O)|$ is an open neighborhood of $z$ in view of (3).
Since the M-polyfold $O$ is metrizable we can pick a metric $\bar{d}$, and average this metric with respect to $G$
to obtain an invariant metric $d$ for $O$. This induces a metric $\rho$ for ${_G\backslash} O$ from which we conclude that
the open neighborhood $|\Psi(O)|$ of $z$ is metrizable.
\qed \end{proof}
\begin{remark}\index{R- On topological questions}
Starting with a groupoidal category $\mathscr{S}$ and a basic construction $(F,{\mathcal F})$ we obtain a  natural 
locally metrizable topology ${\mathcal T}$ for the orbit space $|\mathscr{S}|$. 
If by an adhoc method one can verify that ${\mathcal T}$ is Hausdorff, regular, and second countable it follows
that $(\mathscr{S},{\mathcal T})$ is a GCT and the theory developed in Chapters   \ref{CHAPX17} and \ref{CHAPX18} is applicable.
The metrizability question will be investigated in more depth in Section \ref{SECX194}.
\qed
\end{remark}

\section{The Natural Topology for \texorpdfstring{${\mathbf M}(\Psi,\Psi')$}{MPP}}\label{SECXN19.3}
As before we assume that we are given a basic construction $(F,{\mathcal F})$ for the groupoidal category $\mathscr{S}$.
We have shown that $|\mathscr{S}|$ carries a natural topology ${\mathcal T}$, which is locally metrizable.
We shall  show next that the transition sets ${\bm{M}(\Psi,\Psi')}$ carry natural topologies as well.

\begin{definition}\index{D- Topology ${\mathcal T}_{\Psi,\Psi'}$}
Let ${\mathcal T}_{\Psi,\Psi'}$ be the set consisting of subsets $W$ of ${\bm{M}}(\Psi,\Psi')$
having the following property. Given $h=(o,\Phi,o') \in W$ there exists an open neighborhood
$V$ of $o$ in $O$ such that $F_h(V)\subset W$.
\qed
\end{definition}

The basic result is the following.
\begin{theorem}\label{bold_M}
Let $(F,{\mathcal F})$ be a basic construction for the groupoidal category $\mathscr{S}$. Then the set
 ${\mathcal T}_{\Psi,\Psi'}$ is a topology on ${\bm{M}}(\Psi,\Psi')$. This topology is metrizable. Furthermore
the following properties hold:
\begin{itemize}
\item[{\em (1)}] \  The source map $s:{\bm{M}}(\Psi,\Psi')\rightarrow O$ is  a local homeomorphism.
\item[{\em (2)}]\   The target map $t:{\bm{M}}(\Psi,\Psi')\rightarrow O'$ is  a local homeomorphism.
\item[{\em (3)}]\   The unit map $u:O\rightarrow {\bm{M}}(\Psi,\Psi)$ is continuous.
\item[{\em (4)}]\   The inversion map $\iota:{\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi',\Psi)$ is a homeomorphism.
\item[{\em (5)}]\ The multiplication map
$m\colon \bm{M}(\Psi',\Psi''){_{s}\times_t}\bm{M}(\Psi,\Psi')\rightarrow \bm{M}(\Psi,\Psi'')$
 is continuous.
\end{itemize}
\qed
\end{theorem}
The proof of Theorem \ref{bold_M} requires some preparation and will be a consequence of the following discussion.
\begin{proposition}
The collection of subsets ${\mathcal T}_{\Psi,\Psi'}$ of ${\bm{M}}(\Psi,\Psi')$ is a topology and the following holds.
\begin{itemize}
\item[{\em (1)}]\   Given $h=(o,\Phi,o')$ there exists an open neighborhood $V$ of $o$ in $O$ so that
for every open subset $W$ of $V$ the image $F_h(W)$ belongs to ${\mathcal T}_{\Psi,\Psi'}$.
\item[{\em (2)}]\   If $W$ is as in (1) the map $F_h:W\rightarrow {\bm{M}}(\Psi,\Psi')$ is continuous.
\item[{\em (3)}]\   The topology  ${\mathcal T}_{\Psi,\Psi'}$  is Hausdorff.
\end{itemize}
\end{proposition}
\begin{proof}
By construction $\emptyset$, ${\bm{M}}(\Psi,\Psi')$,  and any union of elements in ${\mathcal T}_{\Psi,\Psi'}$ belong to
${\mathcal T}_{\Psi,\Psi'}$. Let $W_1,...,W_k$ be a finite collection of elements in ${\mathcal T}_{\Psi,\Psi'}$.
Assume that $h=(o,\Phi,o')\in W:=\bigcap_{i=1}^k W_i$.  For every $i$ we find an open neighborhood 
$V_i$ of $o$ such that $F_h(V_i)\subset W_i$. Consequently $F_h(\bigcap_{i=1}^k V_i)\subset W$.
This proves the  assertion that ${\mathcal T}_{\Psi,\Psi'}$ is a topology on $\bm{M}(\Psi,\Psi')$.\par

\noindent (1)   We note that there exist open neighborhoods $V$ of $o$ and $V'$ of $o'$ 
so that $f_h:V\rightarrow V'$ is an sc-diffeomorphism mapping $o$ to $o'$ and in addition
$$
F_{F_h(q)}(p)=F_h(p)\ \ \text{for}\ q\in V,\ p\in V.
$$
We also have that 
$$
s(F_h(q))=q\ \ \text{and}\ \ t(F_h(q))=f_h(q)\ \ \text{for all}\ q\in V.
$$
Let $W\subset V$ be an open subset and consider $F_h(W)$.
Take any $h'\in F_h(W)$ and note that there is a unique way to write it as
$F_h(q)=h'$.
Recall that 
$$
F_{F_h(q)}(p)=F_h(p)\ \ \text{for all}\ p\ \text{near} \ q.
$$
Hence the image of a small open neighborhood of $q$ is contained in $F_h(W)$. This proves that $F_h(W)$ is open. \par

\noindent (2) We start with $F_h:V(o)\rightarrow \bm{M}(\Psi,\Psi')$, where $o=s(h)$, 
and consider for  $q\in W\subset V$ the element  $k=F_h(q)$. Assume an open neighborhood $P$ of $k$ is given. We can take 
a small open neighborhood  of $k$ of the form $F_{k}(U)$, where $U$ is a sufficiently small open neighborhood of $o'=s(k)$ such that 
$F_k(U)\subset P$ and 
 $F_k(p)=F_h(p)$ for $p$ close to $o'$. Hence $F_h(U)\subset P$ and this proves continuity.\par

\noindent (3) Assume next that $h_i=(o_i,\Phi_i,o_i')$, for $i=1,2$, are two different elements in ${\bm{M}}(\Psi,\Psi')$.
Using the $\bm{M}$-Hausdorff property  and the previous discussion we conclude that these points have disjoint open neighborhoods.
\qed \end{proof}

Given a basic construction for the groupoidal category $\mathscr{S}$ we have just shown that  every transition set 
$\bm{M}(\Psi,\Psi')$ carries a natural Hausdorff topology.
We shall show next that the structural maps have the required continuity/homeomorphism properties, which will complete 
the proof of Theorem \ref{bold_M}, with the exception that  the metrizability of the topology ${\mathcal T}_{\Psi,\Psi'}$ still has to be shown.
\begin{proposition}
Let $\alpha,\alpha'$ and $\alpha''$ be three objects and $\Psi\in F(\alpha)$, $\Psi'\in F(\alpha')$, and $\Psi''\in F(\alpha'')$.
The following holds.
\begin{itemize}
\item[{\em (1)}]\   The source map $s:{\bm{M}}(\Psi,\Psi')\rightarrow O$ is  a local homeomorphism.
\item[{\em(2)}]\   The target map $t:{\bm{M}}(\Psi,\Psi')\rightarrow O'$ is  a local homeomorphism.
\item[{\em (3)}]\   The unit map $u:O\rightarrow {\bm{M}}(\Psi,\Psi)$ is continuous.
\item[{\em(4)}]\ The inversion map $\iota:{\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi',\Psi)$ is a homeomorphism.
\item[{\em(5)}]\  The multiplication map $m$ is continuous.
\end{itemize}
\end{proposition}
\begin{remark}\index{R- On transitions}
\noindent (a) Assuming that the proposition holds we note that the unit map $u$ is a homeomorphism onto its image, which is an open subset 
of $\bm{M}(\Psi,\Psi)$. Indeed, the map $u:O\rightarrow \bm{M}(\Psi,\Psi)$ is an injection.
Pick $o\in O$ and recall that $F_{u(o)}$ maps a small open neighborhood of $o$ to an open neighborhood of $u(o)$.
Since $F_{u(o)}(q)=u(q)$ for $q$ near $o$ we infer that the image of $u$ is open. 
Then $s|u(O)\rightarrow O$ as  a bijective local homeomorphism is a homeomorphism and the inverse to $u:O\rightarrow u(O)$.\par

\noindent (b) The multiplication is a local homeomorphism. Indeed, assume that we are given $h'\in \bm{M}(\Psi',\Psi'')$ and $h\in \bm{M}(\Psi,\Psi')$,
with $s(h')=t(h)$ and define $h''=m(h',h)$.  We find an open neighborhoods $U(s(h))$ of $s(h)$, $U(t(h))$ of $t(h)$,   $U(h)$ of $h$, $U(h')$ of $h'$ so that 
the following maps are homeomorphisms
\begin{itemize}
\item[] $s:U(h)\rightarrow U(s(h))$, $t:U(h)\rightarrow U(t(h))$, $f_h:U(s(h))\rightarrow U(t(h))$.
\item[] $s:U(h')\rightarrow U(t(h))$.
\end{itemize}
Then the fibered product $ {\bm{M}}(\Psi',\Psi''){_{s}\times_t}{\bm{M}}(\Psi,\Psi')$ near $(h',h)$ is homeomorphically
parametrized by the map 
$$
q\rightarrow ((s|U(t(h)))^{-1}(f_h(q)),(s|U(s(h)))^{-1}(q)),
$$
 where $q\in U(s(h))$. Then
$$
s(m(((s|U(t(h)))^{-1}(f_h(q)),(s|U(s(h)))^{-1}(q))) =q
$$
which implies the assertion.
\qed
\end{remark}
\begin{proof}
(1) Let $h=(o,\Phi,o')\in {\bm{M}}(\Psi,\Psi')$. Then $s(h)=o$ and 
$$
s(F_h(q))=q\ \text{for}\ q\ \ \text{near}\ o.
$$ 
Given a sufficiently small open neighborhood $U$ of $o$ we know that $V=F_h(U)$ is an open neighborhood 
of $h$ and trivially $s(V)\subset U$. This proves continuity of $s$.  Next consider $s:F_h(U)\rightarrow U$. 
We also know that $F_h:U\rightarrow F_h(U)$ is injective in view of $s\circ F_h(q)=q$ for $q\in U$ and by construction
the map is surjective, and hence a bijection. Clearly $F_h:U\rightarrow F_h(U)$ is a continuous inverse for $s$. \par

\noindent (2) Since $t=s\circ \iota$ the assertion (2) follows from (4).\par

\noindent (3) Let $o\in O$ and $h=u(o)$. Take a sufficiently small open neighborhood $V$ around $o$.
Then $F_{u(o)}(V)=\{(q,1_{\Psi(q)},q)\ |\ q\in V\}$ is open and $u(V)=F_{u(o)}(V)$ implying continuity.\par

\noindent (4) Clearly $\iota$ is a bijection. If $h\in {\bm{M}}(\Psi,\Psi')$  let $h'=\iota(h)$. 
Pick a small neighborhood around $h'$. We may assume that it has the form $F_{h'}(V')$ with
$V'$ an open neighborhood of $o'=s(h')=t(h)$. If $V'$ is small enough we find $V=V(o)$ so that
$f_h:V\rightarrow V'$ is an sc-diffeomorphism.  Using that 
$$
\iota(F_h(q)) = F_{h'}(f_h(q))\ \ \text{for}\ \ q\ \text{near}\ o
$$
it follows that $\iota(F_h(V))= F_{h'}(V')$ showing continuity. Interchanging the role of $\Psi$ and $\Psi'$
we see that the inverse of $\iota$ is also continuous.\par

\noindent (5) Consider $m\colon \bm{M}(\Psi',\Psi''){_{s}\times_t}\bm{M}(\Psi,\Psi')\rightarrow \bm{M}(\Psi,\Psi'')$
and fix $h=(o,\Phi,o')$ and $h'=(o',\Phi',o'')$ so that $m(h',h)=(o,\Phi'\circ\Phi,o'')=:h''$. Assume we are given an open neighborhood of $h''$.
We may assume that it has the form $W'':=F_{h''}(U)$ for a suitable open neighborhood $U$ of $o$.  If we take $U$ small enough we may 
assume that $F_{h''}:U\rightarrow W''$ is a homeomorphism. We also may assume that 
$f_h:(U,o)\rightarrow (U',o')$ is a homeomorphism for a suitable open neighborhood $U'$ of $o'$ so that in addition
defining  $W= F_{h}(U)$ and $W'=F_{h'}(U)$ 
$$
F_h:U\rightarrow W \ \ \ \text{and}\ \ \ F_{h'}:U'\rightarrow W'
$$
are homeomorphisms. Given an  element 
$$
(k',k)\in W'{_{s}\times_t}W 
$$
we find a unique $u\in U$ such that $F_h(u)=k$ and $t(k)=t\circ F_h(u))=f_h(u)=s(k') = F_{h'}(f_h(u))$. This implies
$$
 k'\circ k = F_{h'}(f_h(u))\circ F_h(u)= F_{h''}(u)\in W.
$$ 
\qed \end{proof}

The desired metrizability property is proved in the next proposition.
\begin{proposition}
For every pair $\Psi\in F(\alpha)$ and $\Psi'\in F(\alpha')$ the topology ${\mathcal T}_{\Psi,\Psi'}$
on the transition set ${\bm{M}}(\Psi,\Psi')$ is metrizable.
\end{proposition}
\begin{proof}
First of all we note that ${\bm{M}}(\Psi,\Psi')$ is locally metrizable since it is locally homeomorphic to a metrizable space.
We have already proved that it is Hausdorff.  It suffices to show that the space is paracompact.
Then the Nagata-Smirnov metrization theorem implies that the space is metrizable.

Let ${(V_\lambda)}_{\lambda\in\Lambda}$ be an open covering of ${\bm{M}}(\Psi,\Psi')$. We have to show that it admits 
a subordinate locally finite open cover. Given an element $o\in O$,  there are at most $\sharp G'$-many 
$h\in {\bm{M}}(\Psi,\Psi')$ with $s(h)=o$.  Denote them by $h^o_1,..,h^o_{k_o}$. 
We find a sufficiently small open neighborhood $V(o)$ of $o$ and $U(h^o_i)$ so that
\begin{itemize}
\item[(i)] \ \ \ $s:U(h^o_i)\rightarrow V(o)$ is a homeomorphism.
\item[(ii)]\  \ \ The $U(h^o_i)$ are mutually disjoint.
\item[(iii)] \ \ \ For every $i$ there exists a $\lambda_i$ such that $U(h^o_i)\subset V_{\lambda_i}$.
\end{itemize}
Since $O$ is metrizable we find a locally finite subcover subordinate to $(V(o))_{o\in O}$.
We find a subset $K\subset O$ and nonempty open sets $W_o$ for $o\in K$ so that
$({W_o})_{o\in K}$ covers $O$, $W_o\subset V(o)$, and the cover is locally finite.
We do not require $W_o$ to be an open neighborhood of $o$.
We define 
$$
V(o,i):= (s|U(h^o_i))^{-1}(W_o)\ \text{for}\ o\in K,\ i\in \{1,..,k_o\}.
$$
Then $(V(o,i))$, which is indexed by $o\in K$ and $i\in \{1,...,k_o\}$,  consists of open sets and is subordinate to $(V_\lambda)$. If $h\in {\bm{M}}(\Psi,\Psi')$
consider $q=s(h)$. We find $o\in K$ such that $q\in W_o$ and $h$ belongs to one of the $V(o,i)$.
This shows that $(V(o,i))$ is an open covering of ${\bm{M}}(\Psi,\Psi')$ subordinate to the original $(V_\lambda)$.

Let us show that the covering is locally finite.  Pick $h\in {\bm{M}}(\Psi,\Psi')$ and define $q=s(h)$.
We find an open neighborhood $A$ of $q$ which only intersects finitely many of the $W_o$. 
Taking $A$ small enough we find an open neighborhood $B$ of $h$ so that $s:B\rightarrow A$ is a homeomorphism.
Assume $V(o,i)$ intersects $B$. Then $s(V(o,i))$ and $s(B)$ intersect, implying that $W_o$ and $A$ intersect.
This implies that there are only finitely many $V(o,i)$ intersecting $B$. This shows that ${\bm{M}}(\Psi,\Psi')$
is paracompact.
\qed \end{proof}
\begin{remark}
Given a groupoidal category $\mathscr{S}$ and a basic construction $(F,{\mathcal F})$ for $\mathscr{S}$
we have shown that the orbit space $|\mathscr{S}|$ carries a natural topology ${\mathcal T}$, which is locally metrizable,
and every transition set $\bm{M}(\Psi,\Psi')$ carries a natural metrizable topology, so that all structure maps 
are continuous, $s$ and  $t$ are local homeomorphisms, and $\iota$ is a homeomomorphism.
We investigate the metrizability properties for ${\mathcal T}$ in the next section.
\qed
\end{remark}


\section{Metrizability Criterion for \texorpdfstring{${\mathcal T}$}{TT}}\label{SECX194}
Next we consider  the metrizability question  for  ${\mathcal T}$ which we have mentioned before.
For this we introduce a useful criterion, called the  properness property.
We recall that the $\bm{M}(\Psi,\Psi')$ are metrizable topological spaces. 
\begin{definition}\label{DEF1941}\index{D- Properness property}
Assume that the groupoidal category $\mathscr{S}$ admits the basic construction  $(F,{\mathcal F})$.
\begin{itemize}
\item[(1)]\   We say that {\bf properness property (v1)} holds, 
provided for   $\Psi\in F(\alpha)$  and given $o\in O$ there exists an open neighborhood $U=U(o)$ in $O$
so that for any  $\Psi'\in F(\alpha')$, $\Psi':G'\ltimes O'\rightarrow \mathscr{S}$,  the metrizable space 
${\bm{M}}(\Psi,\Psi')$ has the property  that every sequence $(h_k)$ in ${\bm{M}}(\Psi,\Psi')$ with $s(h_k)\in U$ and $t(h_k)\in O'$ convergent in $O'$
has a convergent subsequence in $\bm{M}(\Psi,\Psi')$.
\item[(2)]\  We say that {\bf properness property (v2)} holds, provided for every uniformizer $\Psi$ the following holds with respect to ${\mathcal T}$.
Given $o\in O$ there exists an open neighborhood  $U=U(o)$ in $O$
so that $\cl_{|\mathscr{S}|}(|\Psi(U(o))|)\subset |\Psi(O)|$. 
\item[(3)]\  We say that {\bf properness property (v3)} holds provided for every $\Psi:G\ltimes O\rightarrow \mathscr{S}$
the following property holds true.  Given $o\in O$ there exists an open neighborhood $U=U(o)\subset O$ such that 
for a sequence $(q_k)\subset U(o)$ the convergence of $|\Psi(q_k)|$ in $(|\mathscr{S}|,{\mathcal T})$ to some 
$z$ implies that a suitable subsequence of $(q_k)$ converges to an element in $\cl_O(U(o))\subset O$.
\end{itemize}
The following proposition shows that the three formulations of a properness property are equivalent.
In the future, if $(F,{\mathcal F})$, satisfies one of the properties (and therefore all three) we shall say that the {\bf properness property} holds.
\qed
\end{definition}

\begin{proposition}\index{P- Equivalence of properness criteria}
Assume that  $(F,{\mathcal F})$ is a basic construction for the groupoidal category $\mathscr{S}$ and let ${\mathcal T}$ be the associated
topology for $|\mathscr{S}|$.  Then the three properness properties formulated in Definition \ref{DEF1941} are equivalent.
\end{proposition}
\begin{proof}
\noindent (1) implies (2):  By assumption, given $o\in O$ there exists an open neighborhood
$U(o)\subset O$ which satisfies the properness property (v1).  We shall show that $U(o)$ satisfies (v2).
Assuming  that (2) does not hold,  arguing indirectly  we may assume that $\cl_{|\mathscr{S}|}(|\Psi(U(o))|)\not\subset |\Psi(O)|$.
This implies that there exists a sequence $(q_k)\subset U(o)$ such that $|\Psi(q_k)|\rightarrow z\in |\mathscr{S}|$,
where $z\not\in |\Psi(O)|$. We pick $\alpha'$ with $|\alpha'|=z$ and $\Psi'\in F(\alpha')$,  and find for large 
$k$ an element $h_k\in \bm{M}(\Psi,\Psi')$ with $s(h_k)=q_k$ and $t(h_k)=p_k\rightarrow
\bar{o}'$ with $\Psi'(\bar{o}')=\alpha'$. In view of (1) we may assume after perhaps taking a subsequence that $h_k\rightarrow h$ in $\bm{M}(\Psi,\Psi')$. The element $h$ satisfies
$s(h)\in cl_O(U(o))$ and $t(h)=\bar{o}'$. Hence $z=|\alpha'|\in |\Psi(O)|$, which is a contradiction.\par

\noindent  (2) implies (3): We take the open neighborhood $U=U(o)$ guaranteed by (2) and show
that $U$ has the properties stated in (3). Pick any sequence $(q_k)\subset U$ and assume that $|\Psi(q_k)|\rightarrow z$  with respect to ${\mathcal T}$.
Then, in view of (2), we deduce that $z\in \cl_{|\mathscr{S}|}(\Psi(U)|)\subset |\Psi(O)|$. Hence we can find $\bar{q}\in O$ satisfying $|\Psi(\bar{q})|=z$.
Since $|\Psi|:|G\ltimes O|\rightarrow |\Psi(O)|$ is a homeomorphism we find a sequence $(g_k)\subset G$ satisfying
$$
g_k\ast q_k\rightarrow \bar{q}.
$$
After perhaps taking a subsequence we may assume that $(g_k)$ is a constant sequence associated to $g\in G$,  and therefore, without loss of generality
$$
q_k\rightarrow g^{-1}\ast \bar{q}.
$$
Hence  $(q_k)$ converges to an element in $\cl_O(U)\subset O$.\par


\noindent (3) implies (1):   Given $\Psi:G\ltimes O\rightarrow \mathscr{S}$ let $o\in O$ be a given point. 
By assumption we  find an open neighborhood $U=U(o)$ in $O$ such that (iii) holds. 
Assume $\Psi':G'\ltimes O'\rightarrow \mathscr{S}$ and $(h_k)\subset \bm{M}(\Psi,\Psi')$
is a sequence satisfying $q_k:=s(h_k)\in U$ and $(p_k:=t(h_k))$ is a convergent sequence in $O'$, say converging to $p$.
Then $|\Psi'(t(h_k))|$ converges to some element $z\in |\mathscr{S}|$. In view (3) we may assume without loss of generality 
that $q_k\rightarrow q $ in $O$, where $q\in \cl_O(U)$.  Hence $(h_k)\subset \bm{M}(\Psi,\Psi')$
has the property that $s(h_k)\rightarrow q\in O$ and $t(h_k)\rightarrow p\in O'$. 

Consider the set of morphisms 
in $\mathscr{S}$ having source $\Psi(q)$ and target in $\Psi'(O')$. This collection is a finite set and contains at most 
$\sharp G'$-many elements. Denote them by $\Phi_1,...,\Phi_\ell$. We find with $\bar{h}_i=(q,\Phi_i,{(\Psi')}^{-1}(t(\Phi_i)))$ open neighborhoods 
$U(q)$ and $U(\bar{h}_i)$ for $i=1,..,\ell$ such that
$$
s:U(\bar{h}_i)\rightarrow U(q)
$$
is a homeomorphism.
We know that for large $k$ the point $q_k=s(h_k)$ belongs to $U(q)$. Fix a sufficiently large  $k$ so that $s(h_k)=q_k\in U(q)$.
We fix $i$ and  we find an element  $\wt{h}_k\in  U(\bar{h}_i)$ satisfying 
$$
s(h_k) =s(\wt{h}_k).
$$
Write $\wt{h}_k= (q_k,\wt{\Phi}_k,r_k)$, where $\Psi'(r_k)=t(\wt{\Phi}_k)$. We note that $t(h_k)$ and $t(\wt{h})$ only differ by 
the action of a suitable $g'_k$, i.e. 
$$
h_k  =m((r_k,\Psi'(g'_k,r_k),g'_k\ast r_k), \wt{h}_k).
$$
After perhaps taking a subsequence we can replace the $g_k'$ by a constant sequence $g'$ and obtain
$$
h_k=m((r_k,\Psi'(g',r_k),g'\ast r_k), \wt{h}_k).
$$
Since $\wt{h}_k = (s|U(\bar{h}_i))^{-1}(q_k)\rightarrow (s|U(\bar{h}_i))^{-1}(q)$ and therefore $r_k\rightarrow r$ 
we find that $(r_k,\Psi'(g',r_k),g'\ast r_k)\rightarrow (r,\Psi'(g',r),g'\ast r)$. From the continuity of $m$ we conclude the convergence 
of $(h_k)$.
\qed \end{proof}
Next we consider the ramifications of the properness condition.
\begin{proposition}
Assume that $(F,{\mathcal F})$ is a basic construction for the groupoidal category $\mathscr{S}$,
and ${\mathcal T}$ is the natural topology for $|\mathscr{S}|$, which is locally metrizable.
 If the construction satisfies the properness property, then ${\mathcal T}$ is Hausdorff and completely regular.
 \end{proposition}
 \begin{proof}
 For  $|\alpha|\neq |\alpha'|$ we pick $\Psi\in F(\alpha)$ and $\Psi'\in F(\alpha')$
 so that $\Psi(\bar{o})=\alpha$ and $\Psi'(\bar{o}')=\alpha'$. Around the points 
 $\bar{o}$ and $\bar{o}'$ we pick monotonic neighborhood bases $U_k=U_k(\bar{o})$ and
 $U'_k = U'_k(\bar{o}')$. Then $(|\Psi(U_k)|)$ and $(|\Psi(U_k)|)$ are neighborhood bases
 for $|\alpha|$ and $|\alpha'|$, respectively.  We show that they do not intersect for large $k$.
 Arguing indirectly we find sequences
 $o_k\rightarrow \bar{o}$ with $o_k\in U_k$ and $o'_k\in U'_k$ with $o'_k\rightarrow \bar{o}'$
 such that $|\Psi(o_k)|=|\Psi'(o_k')|$. Hence we find $h_k\in \bm{M}(\Psi,\Psi')$
 with $s(h_k)=o_k$ and $t(h_k)=o'_k$.   Using the properness property we may
 assume without loss of generality that $h_k\rightarrow h$ which implies that $|\alpha|=|\alpha'|$
 which contradicts our initial assumption.  This proves that ${\mathcal T}$ is Hausdorff.
 
 Next we show that ${\mathcal T}$ is completely regular. For this take a point 
 $z$ and a closed subset $A$ of $|\mathscr{S}|$ not containing $z$.  We pick $\alpha$
 with $|\alpha|=z$ and $\Psi\in F(\alpha)$. Then $\Psi:G\ltimes O\rightarrow \mathscr{S}$
 and $\Psi(\bar{o})=\alpha$ for a suitable $\bar{o}$.  We can  pick an open $G$-invariant neighborhood $U$ of $\bar{o}$ such that $|\Psi(U)|\cap A=\emptyset$ and, moreover
 we can pick the $G$-invariant $V=V(\bar{o})$ with $\cl_O(V)\subset U$ so that
 $V$ satisfies $\cl_{|\mathscr{S}|}(|\Psi(V)|) \subset |\Psi(U)|$. 
 Then $\cl_O(V)\subset U\subset O$ and we can take a continuous map
 $\beta:O\rightarrow [0,1]$ with $\beta(\bar{o})=0$ and $\beta|(O\setminus V)\equiv 1$.
 Also, perhaps using an averaging procedure we map assume that $\beta$ is invariant 
 with respect to the $G$-action. Then $\beta$ descends to a continuous function
 $\bar{\beta}:|\Psi(O)|\rightarrow [0,1]$, which we extend by the value $1$. This map
 $\bar{\beta}:|\mathscr{S}|\rightarrow [0,1]$ is continuous and has the desired properties.
 Indeed, we can argue using sequences, since every point has a countable neighborhood basis. 
 Let $z\in |\mathscr{S}|$ and assume that $z_k\rightarrow z$. If $z\in |\Psi(O)|$ we see that for large $k$
 it holds that $z_k\in |\Psi(O)|$. We can pick $q_k,q\in O$ with $q_k\rightarrow q$, $|\Psi(q_k)|=z_k$, and $|\Psi(q)|=z$.
 Then $\bar{\beta}(z_k)-\bar{\beta}(z)=\beta(q_k)-\beta(q)\rightarrow 0$. If $z\not\in |\Psi(O)|$, we find an open neighborhood
 $W=W(z)$ such that $|\Psi(V)|\cap W=\emptyset$. This immediately implies the continuity assertion since for large $k$
 we must have $z_k\in W$ so that $\bar{\beta}(z_k)=1=\bar{\beta}(z)$.  If we cannot find such a $W$ there exists a sequence 
 $(q_k)\subset V$ with $|\Psi(q_k)|\rightarrow z$. Applying the properness property we may assume without loss of generality that
 $q_k\rightarrow q\in \cl_O(V)\subset U\subset O$ and therefore $z=|\Psi(q)|$ implying that $z\in |\Psi(O)|$ giving a contradiction.
 This shows that the topology ${\mathcal T}$ is completely regular.
  \qed \end{proof}

The main result in this section is given by the following theorem which summarizes the essence of the previous discussion.
Recall that the natural topology is always locally metrizable and the properness
assumption implies in addition that it is Hausdorff and completely regular.
\begin{theorem}\label{MET}
Let $\mathscr{S}$ be a groupoidal category and $(F,{\mathcal F})$ a basic construction
for which the properness assumption holds.
\begin{itemize}
\item[{\em (1)}]\  If  ${\mathcal T}$ is second countable, then it is metrizable.
\item[{\em (2)}]\  If ${\mathcal T}$ is paracompact, then it is metrizable.
\end{itemize}
\end{theorem}
\begin{proof}
\noindent (1)  By Urysohn's metrization theorem a topological space which is Hausdorff,
completely regular and second countable is metrizable.\par

\noindent (2) A  locally metrizable space, which in addition is Hausdorff, completely regular
and paracompact is metrizable by the Nagata-Smirnov metrization theorem.
\qed \end{proof}

Finally we note the following result.
\begin{proposition}\index{P- Metrizability characterization}
Let $\mathscr{S}$ be a groupoidal category and $(F,{\mathcal F})$ a basic construction.
Denote by ${\mathcal T}$ the natural topology on $|\mathscr{S}|$. Then the following statements are equivalent.
\begin{itemize}
\item[{\em(1)}] \  ${\mathcal T}$ is metrizable.
\item[{\em(2)}]\  $(F,{\mathcal F})$ satisfies the properness property and ${\mathcal T}$ is paracompact.
\end{itemize}
\end{proposition}
\begin{proof}
\noindent (2) implies (1):  This follows from the previous discussion.\par

\noindent (1) implies (2):  A metrizable space is paracompact. We have to show that the metrizability of ${\mathcal T}$ requires the basic construction 
to satisfy one of the properness conditions.  Let $\Psi:G\ltimes O\rightarrow \mathscr{S}$ be a uniformizer at $\alpha$. 
Denote by $\bar{o}\in O$ the element mapped to $\alpha$. We know that $|\Psi|: {_G\backslash}O\rightarrow |\Psi(O)|$ is a homeomorphism and $|\alpha|\in |\Psi(O)|$.
Since ${\mathcal T}$ is metrizable we can pick an open neighborhood $V$ of $|\alpha|$ such that $\cl_{|\mathscr{S}|}(V)\subset |\Psi(O)|$. 
Denote by $U\subset O$ the preimage of $V$ under $\Psi$, which is a $G$-invariant open subset.

We verify  that (v3) holds. Assume that $(q_k)\subset U$ and $|\Psi(q_k)|\rightarrow z$ in $|\mathscr{S}|$. By construction 
$|\Psi(q_k)|\in V$ so that $z\in \cl_{|\mathscr{S}|}(V)\subset |\Psi(O)|$. Hence we find $\bar{q}\in O$ with $|\Psi(\bar{q})|=z$.
Since $|\Psi|:{_G\backslash}O\rightarrow |\Psi(O)|$ is a homeomorphism we find a sequence $(g_k)\subset G$ such that
$$
g_k\ast q_k\rightarrow \bar{q}.
$$
After perhaps taking a subsequence we may assume that $(g_k)$ is a constant sequence and without loss of generality
$q_k\rightarrow g^{-1}\ast \bar{q}=:q$. This completes the proof.
\qed \end{proof}


\section{The Polyfold Structure for \texorpdfstring{$(\mathscr{S},{\mathcal T})$}{ST}}\label{SECNX19.5}
We assume that $\mathscr{S}$ is a groupoidal category and $(F,{\mathcal F})$ a basic construction.
The associated natural topology for the orbit space $|\mathscr{S}|$ is denoted by ${\mathcal T}$.
We have seen that every ${\bm{M}}(\Psi,\Psi')$ has a natural metrizable topology for every pair
$(\Psi,\Psi')$. For this topology the source and target maps are local homeomorphisms and the other structure maps
are continuous.  We also equipped $|\mathscr{S}|$ with a topology ${\mathcal T}$ so that every point has
a countable neighborhood basis of open sets.
Recall that  for every  object $\alpha$ and $\Psi\in F(\alpha)$ the map on orbit space
$$
|\Psi|:{_G\backslash} O\rightarrow |\mathscr{S}|
$$
is a homeomorphism onto an open neighborhood of $|\alpha|$ in $|\mathscr{S}|$.
Using this fact and the previous discussion we can prove the following theorem.
\begin{theorem}\label{THMX19.5.1}
The metrizable  space ${\bm{M}}(\Psi,\Psi')$ has a natural  M-polyfold structure for which $s$ and $t$ are local sc-diffeomorphisms. 
\end{theorem}
\begin{proof}
As we shall see there is a sc-smooth atlas for ${\bm{M}}(\Psi,\Psi')$ which has transition maps of a simple form.
That this is the case is immediate apparent in the case $\bm{M}(\Psi,\Psi)$. In this case we have a bijection
$\tau:G\times O\rightarrow \bm{M}(\Psi,\Psi):(g,o)\rightarrow (o,\Psi(g,o),g\ast o)$. The sc-smooth atlas for
$\bm{M}(\Psi,\Psi)$ will define a M-polyfold structure for which the bijection $\tau$ is an sc-diffeomorphism
and $G\times O$ is equipped with the natural M-polyfold structure coming from $O$ (and the trivial structure on the finite set $G$).

Recall that with $h=(o,\Psi(g,o),g\ast o)$ the germ $F_h$ as the form 
$$
F_h(q)=(q,\Psi(g,q),g\ast q)
$$
 and for a small open neighborhood
$U$ of $o$ the map $F_h:U\rightarrow F_h(U)$ is a homeomorphism and $F_h(U)\in {\mathcal T}_{\Psi,\Psi}$.
We see that $s_h:F_h(U)\rightarrow U: s_h(o,\Psi(g,o),g\ast o)=o$ is precisely the inverse of $F_h$. We also 
note that if $F_h(U)\cap F_{h'}(U')\neq \emptyset$ the transition map $s_{h'}\circ s_h^{-1}$ has the form
$$
s_{h'}\circ s_h^{-1}(q)=q.
$$
This shows that the system $(s_h)$ is an sc-smooth atlas.  Moreover
$$
s_h\circ \tau(g,q)  = q
$$
proving that $\tau$ is an sc-diffeomorphism. 

We next consider the general case and as before we shall show that the source maps define an sc-smooth atlas. Again it will turn out that the 
transition maps take an easy form.
Pick $h\in {\bm{M}}(\Psi,\Psi')$ and pick open neighborhoods $U(h)$, $U(o)$, where $o=s(h)$, with the following properties
\begin{itemize}
\item[(i)] \ \ \  $s:U(h)\rightarrow U(o)$ is a homeomorphism, denoted by $s_h$.
\item[(ii)] \ \ \ $F_h:U(o)\rightarrow U(h)$ is the inverse of $s_h$. 
\item[(iii)] \ \ \ $t(F_h(q))=f_h(q)$ for $q\in U(o)$.
\end{itemize}
We shall show that the collection $(s_h)$, where $h$ varies over ${\bm{M}}(\Psi,\Psi')$,
has sc-smooth overlaps, i.e. $s_{h'}\circ s_h^{-1}:s_h(U(h)\cap U(h'))\rightarrow s_{h'}(U(h)\cap U(h'))$
is sc-smoth. This, of course, will imply that ${\bm{M}}(\Psi,\Psi')$ has a natural  M-polyfold structure. 

Assuming  $q\in s_h(U(h)\cap U(h'))$ we compute 
$$
s_{h'}\circ s_h^{-1}(q)= s_{h'}\circ F_h (q)=s(F_h(q))=q.
$$
This shows that ${\bm{M}}(\Psi,\Psi')$ has a tame M-polyfold structure and by construction
$s$ is a local sc-diffeomorphism.  The same holds for $t$. To see this fix $h\in {\bm{M}}(\Psi,\Psi')$
and consider $s_h:U(h)\rightarrow U(s(h))$. Then 
$$
t\circ s_h^{-1} (q) =t\circ F_h(q)=f_h(q)
$$
which is sc-smooth and a local sc-diffeomorphism. 
\qed \end{proof}

\begin{corollary}
Given $\Psi,\Psi',\Psi''$ associated to the objects $\alpha,\alpha',\alpha''$, consider
$$
{\bm{M}}(\Psi,\Psi'),\ {\bm{M}}(\Psi',\Psi''), \  \text{and}\ \ {\bm{M}}(\Psi,\Psi'')
$$
with their natural M-polyfold structures.
Then all structure maps are sc-smooth.
\end{corollary}
\begin{proof}
We begin with the unit map $u:O\rightarrow {\bm{M}}(\Psi,\Psi)$. Then $s\circ u(o)=o$ and since 
$s$ is a local sc-diffeomorphism we conclude that $u$ is sc-smooth.

Next we consider the inversion map $\iota:{\bm{M}}(\Psi,\Psi')\rightarrow {\bm{M}}(\Psi',\Psi)$. Fix $h=(o,\Phi,o')$
and let $h'=(o',\Phi^{-1},o)=\iota(h)$. Then $F_h:U(o)\rightarrow U(h)$ for suitable open neighborhoods 
is an sc-diffeomorphism and  for $q$ near $o$ we compute
$$
t(\iota(F_h(q))= t(F_{h'}(f_h(q)).
$$
Since $t$,$f_h$, and  $F_{h'}$ are local sc-diffeomorphisms we see that the left-hand side is sc-smooth.
Since $t$ and $F_h$ are local sc-diffeomorphisms we concluded that $\iota $ is sc-smooth.

Finally we consider the multiplication map $m$.  Assume that $h\in \bm{M}(\Psi,\Psi')$ and $h'\in \bm{M}(\Psi',\Psi'')$
satisfying $t(h)=s(h')$. 
Using that for $q$ near $o=s(h)$ we have the relationship
$$
m(F_{h'}(f_h(q)),F_h(q))=F_{m(h',h)}(q)
$$
we see that the right-hand side is a local sc-diffeomorphism, which implies the same for the expression
on the left. We note that
$$
q\rightarrow (F_{h'}(f_h(q)),F_h(q)) = m((f_{h}(q),\Phi_{f_h(q)}',f_{m(h',h)}(q)),(q,\Phi_q,f_h(q)))
$$
is the inverse of a  local chart in the fibered product ${\bm{M}}(\Psi',\Psi''){_{s}\times_t}{\bm{M}}(\Psi,\Psi')$.
Hence $m$ is sc-smooth.
\qed \end{proof}



In view of the discussion in this section we can conclude the following.
\begin{theorem}
Given a basic construction $(F,{\mathcal F})$ for $\mathscr{S}$, which satisfies the properness property and for which  the natural topology ${\mathcal T}$ is either 
second countable or paracompact there is an underlying natural  polyfold structure $(F,{\bm{M}})$ for $\mathscr{S}$. 
If the uniformizers $\Psi:G\ltimes O\rightarrow \mathscr{S}$ associated to $F$ have tame domains $O$ the polyfold structure is tame.
\qed
\end{theorem}

\begin{remark}\index{R- Comment on polyfold constructions}
In applications the category $\mathscr{S}$ very often is constructed having a geometric purpose in mind
and more often than not there is a natural  uniformizer construction $F$,  
and a transition construction ${\mathcal F}$.  In a first step
one obtains the natural topology ${\mathcal T}$ for $|\mathscr{S}|$
as well as the metrizable topologies for the transition sets $\bm{M}(\Psi,\Psi')$.
In fact,  the latter even carry natural M-polyfold structures.  We recall that ${\mathcal T}$ is locally metrizable.
After checking that
$(F,{\mathcal F})$ has, indeed, the properness property one concludes that ${\mathcal T}$ 
is locally metrizable, Hausdorff, and completely regular.  These facts imply that for a given 
compact subset $K$ of  $|\mathscr{S}|$ there exists an open neighborhood $U=U(K)$ which is paracompact and hence metrizable,
given the already established properties of ${\mathcal T}$.
This sometimes is all what one needs in applications.  In case that ${\mathcal T}$ is also second countable 
we note that ${\mathcal T}$ is metrizable and for such basic constructions $(F,{\mathcal F})$ we have just 
shown that there is an associate polyfold construction $(F,\bm{M})$. The same  holds if ${\mathcal T}$ is paracompact.  We also note that if all uniformizers $\Psi$ associated to $F$ are tame, i.e. the domains are tame, the resulting polyfold construction is tame.
\qed
\end{remark}



\section{A Strong Bundle Version}\label{SECX19.6}
In order to equip $P:{\mathcal E}\rightarrow \mathscr{S}$ with a strong bundle structure, there is a similar scheme as in the 
$\mathscr{S}$-case,  and we allow ourselves to be somewhat sketchy. Here $\mathscr{S}$ and ${\mathcal E}$ are  groupoidal categories, so that in addition the fibers $P^{-1}(\alpha)$ are equipped with Banach space structures.
The morphisms in ${\mathcal E}$ are assumed to be  linear lifts associated to the underlying morphisms in $\mathscr{S}$. More precisely, for two objects $\alpha$ and $\alpha'$ in $\mathscr{S}$
and an isomorphism $\Phi:\alpha\rightarrow \alpha'$ there exists a well-defined topological linear isomorphism
$$
\wh{\Phi}:P^{-1}(\alpha)\rightarrow P^{-1}(\alpha').
$$ 
We shall call $\wh{\Phi}$ the {\bf lift}  of $\Phi$ \index{$\wh{\Phi}$}\index{Lift of $\Phi$} and we assume that the procedure 
$\Phi\rightarrow \wh{\Phi}$ has the obvious properties
\begin{itemize}
\item[(i)] \ \ $\wh{1_\alpha} = Id_{P^{-1}(\alpha)}$.
\item[(ii)] \ \ If $s(\Phi)=t(\Phi')$ then $\wh{\Phi'\circ \Phi}= \wh{\Phi}'\circ \wh{\Phi}$. 
\end{itemize}
A morphism in ${\mathcal E}$ is assumed to be of the form $(\Phi,e)$ with $s(\Phi)=P(e)$
so that 
$$
s(\Phi,e)=e\ \ \text{and}\ \ t(\Phi,e) =\wh{\Phi}(e).
$$
Of course, there is no difference if the morphisms are taken as tuples $(e,\wh{\Phi},e')$, where $e'=\wh{\Phi}(e)$, since
the two descriptions are canonically isomorphic. We take the shorter one, i.e. the first one.
Hence 
$$
e\xrightarrow{(\Phi,e)} \wh{\Phi}(e)\ \ \text{or}\ \ e\xrightarrow{(\Phi,e)} e'\ \ (\text{provided}\ \ e'=\wh{\Phi}(e)\ ).
$$
Having these assumptions on ${\mathcal E}$ there is an alternative description of our data, which is the most useful.
We have seen this already in the ep-groupoid context.
Denote by $\text{Ban}$ the category whose objects are Banach spaces and where the morphisms 
are linear topological isomorphisms.  Then $P:{\mathcal E}\rightarrow \mathscr{S}$, with the structures
described above, gives a covariant
functor 
$$
\mu:\mathscr{S}\rightarrow \text{Ban}.
$$
Indeed, on objects $\mu(\alpha):=P^{-1}(\alpha)$, and on morphisms 
$$
\mu(\Phi) =\wh{\Phi}.
$$
The original $P:{\mathcal E}\rightarrow \mathscr{S}$ can be,  up to natural isomorphism, reconstructed from $(\mathscr{S},\mu)$.

Given a groupoidal category $\mathscr{S}$ and a functor
$\mu:\mathscr{S}\rightarrow \text{Ban}$ we can define a category ${\mathcal E}_\mu$
as follows. The objects are the pairs $(\alpha,e)$ with $e\in \mu(\alpha)$, and the morphisms 
are the pairs $(\Phi,e)$  with $e\in \mu(s(\Phi))$, viewed as morphisms 
$$
(\Phi,e):e\rightarrow \mu(\Phi)(e).
$$
In view of this discussion we study $P_\mu:{\mathcal E}_\mu\rightarrow \mathscr{S}$ associated to a functor $\mu:\mathscr{S}\rightarrow \text{Ban}$ and abbreviated by $P:{\mathcal E}\rightarrow \mathscr{S}.$ 

\begin{definition}\index{D- Strong bundle unifomizer}\label{DERG19.9}
Consider $(\mathscr{S},\mu)$, where $\mathscr{S}$ is a groupoidal category and $\mu :\mathscr{S}\rightarrow \text{Ban}$ a functor. Denote the associated functor diagram by $P:{\mathcal E}\rightarrow \mathscr{S}$. A {\bf strong bundle uniformizer} at the object $\alpha$ is a functor 
$$
\bar{\Psi}: G\ltimes K\rightarrow {\mathcal E}
$$
with the following properties.
\begin{itemize}
\item[(1)] \  $p:K\rightarrow O$ is a strong bundle over  a M-polyfold,  and $G$ acts by strong bundle diffeomorphisms. Moreover $G\ltimes K$ is the associated translation groupoid.  The functor 
$\bar{\Psi}$ is a  topological linear isomorphism between fibers. In addition there exists
a uniformizer at $\alpha$ denoted by $\Psi:G\ltimes O\rightarrow \mathscr{S}$ fitting into the commutative diagram
$$
\begin{CD}
G\ltimes K @>\bar{\Psi}>> {\mathcal E}\\
@V Id\ltimes p VV     @V P VV\\
G\ltimes O   @>\Psi >>   \mathscr{S}.
\end{CD}
$$
Note that $\Psi$ is completely determined by $\bar{\Psi}$.
\item[(2)] \   $\bar{\Psi}$  is injective on objects and fully faithful.
\item[(3)] \   There exists $0_{\bar{o}}\in K_{\bar{o}}$ with $\Psi(\bar{o})=\alpha$ and
$\bar{\Psi}(0_{\bar{o}}) = (\alpha,0_{\mu(\alpha)})$.
\end{itemize}
\qed
\end{definition}
\begin{remark}\label{remark19.8}
We can also require, more generally, that $p:W\rightarrow E$ is a strong bundle over an ep-groupoid
and that $\bar{\Psi}$ and $\Psi$ are fully faithful functors, which both are injective on objects and fit into the commutative diagram
$$
\begin{CD}
W @>\bar{\Psi}>> {\mathcal E}\\
@V p VV     @V P VV\\
E   @>\Psi >>   \mathscr{S},
\end{CD}
$$
and that a distinguished point $e\in E$ is mapped to the given object $\alpha$ and consequently $\bar{\Psi}(0_e)=(\alpha,0_{\mu(e)})$.
Of course, we also assume that $\bar{\Psi}$ is fiber-wise a topological  linear isomorphism.
Hence, rather than taking $G\ltimes K\rightarrow G\ltimes O$ as local models one could take $W\rightarrow E$.
\qed
\end{remark}
From the definition it follows that a strong bundle uniformizer $\bar{\Psi}:G\ltimes K\rightarrow {\mathcal E}$
at $\alpha$ induces a strong bundle uniformizer $\Psi:G\ltimes O\rightarrow \mathscr{S}$.
\begin{definition}\index{D- Strong bundle uniformizer construction} 
A {\bf strong bundle unformizer construction} is a functor $\bar{F}:\mathscr{S}^-\rightarrow \text{SET}$ associating to every object $\alpha$ a set of strong bundle uniformizers $ \bar{F}(\alpha)$.
\qed
\end{definition}
Associated to $\bar{F}$ we have the underlying uniformizer construction $F$ for $\mathscr{S}$.
Given $\bar{F}$ we can build for $\bar{\Psi}\in \bar{F}(\alpha)$ and $\bar{\Psi}'\in \bar{F}(\alpha')$
the transition set $\bm{M}(\bar{\Psi},\bar{\Psi}')$ associated to the functor diagram
$$
K\xrightarrow{\bar{\Psi}}  {\mathcal E} \xleftarrow{\bar{\Psi}'} K',
$$
which covers 
$$
O\xrightarrow{\Psi} \mathscr{S} \xleftarrow{\Psi} O'.
$$
The elements in the transition set have the form $(a,(\Phi,e),a')$, where  $e\in \mu(s(\Phi))$, $\bar{\Psi}(a)=(s(\Phi),e)$
and $\bar{\Psi}'(a') = (t(\Phi),\wh{\Phi}(e))$. Since $e$ is determined by $a$ via $\bar{\Psi}$, and $\Phi$ acts as a linear map,
i.e. $\wh{\Phi}=\mu(\Phi)$,  we just write
$(a,\Phi,a')$ instead of $(a,(\Phi,e),a')$.
There exists a natural map 
$$
\bm{m}\colon \bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')
$$
defined by
$$
\bm{m}(a,\Phi,a')= (p(a),\Phi,p'(a')).
$$
The fibers of $\bm{m}$ are Banach spaces. Indeed, with $(o,\Phi,o')$ being the base point,
the elements above it consist of all $(a,\Phi,{(\bar{\Psi}')}^{-1}\circ \wh{\Phi}\circ \bar{\Psi}(a))$, where $a\in p^{-1}(o)$.  The structure maps associated to strong bundle unifomizers are given as follows and are linear on the fibers
and cover those for the underlying unifomizer construction. 
\begin{description}
\item[$\bullet$]  The {\bf source map}\index{Bundle source map}
$$
\begin{array}{cc}
\begin{CD}
\bm{M}(\bar{\Psi},\bar{\Psi}') @> s >>  K \\
@V\bm{m} VV                                   @ V p VV    \\     
\bm{M}(\Psi,\Psi') @> s >>                    O
 \end{CD}
&\ \ \ \ 
\begin{CD}
 (a, \Phi,a') @>>>   a\\
 @V VV      @V VV \\
     (p(a),\Phi, p'(a')) @>>>   p(a).
\end{CD}
\end{array}
$$
\item[$\bullet$] The {\bf target map}\index{Bundle target map}
$$
\begin{array}{cc}
\begin{CD}
\bm{M}(\bar{\Psi},\bar{\Psi}') @> t >>  K' \\
@V\bm{m} VV                                   @ V p' VV    \\     
\bm{M}(\Psi,\Psi') @> t >>                    O'
 \end{CD}
&\ \ \ \ 
\begin{CD}
 (a, \Phi,a') @>>>   a'\\
 @V VV      @V VV \\
     (p(a),\Phi, p'(a')) @>>>   p'(a').
\end{CD}
\end{array}
$$
\item[$\bullet$] The {\bf unit map}\index{Bundle unit map}
$$
\begin{array}{cc}
\begin{CD}
K @> u >> \bm{M}(\bar{\Psi},\bar{\Psi})\\
@V p VV        @V\bm{m} VV\\
O @> u>>   \bm{M}(\Psi,\Psi')
\end{CD}
&\ \ \ \
\begin{CD}
a @>>>   (a,{1}_{\Psi(p(a))},a)\\
@VVV @VVV\\
p(a) @>>>   (p(a),1_{\Psi(p(a))},p(a)).
\end{CD}
\end{array}
$$
\item[$\bullet$] The {\bf inversion map}\index{Bundle inversion map}
$$
\begin{CD}
\bm{M}(\bar{\Psi},\bar{\Psi}') @>\iota>>  \bm{M}(\bar{\Psi}',\bar{\Psi})\\
@V\bm{m} VV    @V\bm{m} VV \\
\bm{M}(\Psi,\Psi') @>\iota >> \bm{M}(\Psi',\Psi)
\end{CD}
$$
$$
\begin{CD}
(a,{\Phi},a')  @>>> (a',{\Phi}^{-1}, a)\\
@ VVV @VVV \\
(p(a),\Phi,p'(a'))  @>>> (p'(a'),\Phi^{-1},p(a)).
\end{CD}
$$
\item[$\bullet$] The {\bf multiplication map}\index{Bundle multiplication map}, where $o=p(a), o'=p'(a'), o''=p''(a'')$
$$
\begin{CD}
\bm{M}(\bar{\Psi}',\bar{\Psi}''){_{s}\times_t} \bm{M}(\bar{\Psi},\bar{\Psi}') @> m>> \bm{M}(\bar{\Psi},\bar{\Psi}'')\\
@V \bm{m}{_{s}\times_t}\bm{m}  VV @ V \bm{m} VV\\
\bm{M}(\Psi',\Psi''){_{s}\times_t} \bm{M}({\Psi},{\Psi}') @> m>> \bm{M}({\Psi},{\Psi}'')
\end{CD}
$$
$$
\begin{CD}
((a',{\Phi}',a''),(a,{\Phi},a')) @>>>   (a,{\Phi}'\circ {\Phi},a'')\\
@VVV @VVV\\
((o',\Phi',o''),(o,\Phi,o')) @>>>   (o,\Phi'\circ\Phi,o'').
\end{CD}
$$
\end{description}
\mbox{}

Next we need a construction $\bar{\mathcal F}$ which extends ${\mathcal F}$ in the $\mathscr{S}$-case.  
Recall that ${\mathcal F}$  associates to $h =(o,\Phi,o')\in \bm{M}(\Psi,\Psi')$ a germ
of map
$$
F_h :{\mathcal O}(O,o)\rightarrow ( \bm{M}(\Psi,\Psi'),h).
$$
We can write $F_h$ as
$$
F_h(u) =(u,\Phi_u, f_h(u)),
$$
where $\Phi_u:\Psi(u)\rightarrow \Psi'(f_h(u))$. This morphism lifts to the linear isomorphism
$$
\wh{\Phi}_u: P^{-1}(\Psi(u))\rightarrow P^{-1}(\Psi'(f_h(u)))
$$
and suggests to define  $\bar{F}_h$  as follows
$$
\bar{F}_h(a) = (a, {\Phi}_{p(a)},  a'(a)),
$$
where $a'(a)$ is uniquely determined by $\bar{\Psi}'(a'(a))= \wh{\Phi}_{p(a)} (a)$.
The germ  $\bar{F}_h$ is defined on $K|{\mathcal O}(O,o)$ and covers $F_h$.
$$
\begin{CD}
K|{\mathcal O}(O,o) @> \bar{F}_h >> \bm{M}(\bar{\Psi},\bar{\Psi}')\\
@Vp VV @V \bm{m} VV\\
{\mathcal O}(O,o) @ > F_h >> \bm{M}(\Psi,\Psi')
\end{CD}
$$
We observe that 
$$
\bm{m}(\bar{F}_h(a)) = F_h(p(a)), 
$$
so that the definition of $\bar{F}_h$ is a natural way to lift $F_h$.  We can define 
$\bar{f}_h: K|{\mathcal O}(O,o)\rightarrow K'|{\mathcal O}(O',o')$ covering $f_h$
by
$$
\bar{f}_h (a)= t\circ \bar{F}_h(a).
$$
We require the following properties:
\begin{definition}\index{D- Transition requirements for strong bundles}
The following properties imposed on $\bar{\mathcal F}$ and ${\mathcal F}$
are referred to as {\bf transition requirements} for strong bundles.
\begin{itemize}
\item[(A)]\ {\bf Diffeomorphism Property}:  The germs $\bar{f}_h=t\circ\bar{F}_h:K|{\mathcal O}(O,o)\rightarrow K'|{\mathcal O}(O',o')$ are local strong bundle isomorphisms covering $f_h$
$$
\begin{CD}
K|{\mathcal O}(O,o)@>\bar{f}_h >> K'|{\mathcal O}(O',o')\\
@V p VV   @V p'VV\\
{\mathcal O}(O,o)@> f_h >>{\mathcal O}(O',o')
\end{CD}
$$
 and $s(\bar{F}_h(a))=a$ for $a\in K$ with $p(a)$ near $o$. If $\bar{\Psi}=\bar{\Psi}'$
and $h=(o,\Psi(g,o),g\ast o)$ it holds $\bar{F}_h(a)=(a,{\Psi}(g,p(a)),g\ast a)$ if $p(a)$ is near $o$. In particular
$\bar{f}_h(a)=g\ast a$ (covering $f_h(p(a))= g\ast (p(a))=p(g\ast a)$.).


\item[(B)]\ {\bf Stability Property}:  $\bar{F}_{F_{h}(q)}(a)= \bar{F}_h(a)$ for $q$ near $o=s(h)$ and $a$ such that $p(a)$
 is near $q$.


\item[(C)]\  {\bf Identity Property}:  $\bar{F}_{u(o)}(a) = (a,{1}_{\Psi(p(a))},a) =u(a)$ for $p(a)$ near $o$.

\item[(D)]\  {\bf Inversion Property}: $\bar{F}_{\iota(h)}(\bar{f}_h(a)) = \iota(\bar{F}_h(a))$ for $a$ such that $p(a)$ is near $o=s(h)$.

\item[(E)]\ {\bf Multiplication  Property}:   If $s(h')=t(h)$ then $\bar{f}_{h'}\circ \bar{f}_h(a)=\bar{f}_{m(h',h)}(a)$ for $p(a)$ near $o=s(h)$ and 
 $m(\bar{F}_{h'}(\bar{f}_h(a)),\bar{F}_h(a))=\bar{F}_{m(h',h)}(a)$ for $p(a)$ near $o=s(h)$.


\item[(F)]\ $\bm{M}$-{\bf Hausdorff Property}: The $F_h$ underlying $\bar{F}_h$ has the property 
that for different $h_1,h_2\in {\bm{M}}(\Psi,\Psi')$ with $o=s(h_1)=s(h_2)$  the images under $F_{h_1}$ and $F_{h_2}$ of small neighborhoods $o$ are disjoint.
\end{itemize}
\qed
\end{definition}
\begin{definition}\index{D- Basic strong bundle construction}
Given a pair $(\mathscr{S},\mu)$, where $\mathscr{S}$ is a groupoidal category, and $\mu:\mathscr{S}\rightarrow \text{Ban}$ is a covariant functor with associated  $P:{\mathcal E}\rightarrow \mathscr{S}$,
we shall refer to the construction $(\bar{F},\bar{\mathcal F})$, where $\bar{F}$ is a strong bundle uniformizer construction, and $\bar{\mathcal F}$ is an associated strong bundle transition construction as
as {\bf basic strong bundle construction}  for $(\mathscr{S},\mu)$.
\qed
\end{definition}

At this point we can run through the construction in the $\mathscr{S}$-case and equip 
$P:{\mathcal E}\rightarrow \mathscr{S}$ with a strong bundle structure, provided the underlying 
basic construction for $\mathscr{S}$ induces a polyfold construction for $\mathscr{S}$.



\subsection*{Natural Topology $\bar{\mathcal T}$}

For the following discussion we  assume that starting with $(\mathscr{S},\mu)$ we have a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $P:{\mathcal E}\rightarrow \mathscr{S}$ covering $(F,{\mathcal F})$.
In a first step we define a topology $\bar{\mathcal T}$ for $|{\mathcal E}|$. 
\begin{definition}\label{DEF1964}
A subset $\wh{U}$ of $|{\mathcal E}|$ belongs to $\bar{\mathcal T}$ provided for every $\bar{z}\in \wh{U}$
there exists an object $\alpha$ in $\mathscr{S}$ with $|\alpha|=z:=|P|(\bar{z})$, $\bar{\Psi}\in\bar{F}(\alpha)$
$$
\bar{\Psi}:G\ltimes K\rightarrow {\mathcal E},
$$
a point $a\in K$ with $|\bar{\Psi}(a)|=\bar{z}$, and an open neighborhood 
$\wh{V}$ of $a$ in $K$ such that $|\bar{\Psi}(\wh{V})|\subset \wh{U}$.
\qed
\end{definition}
The underlying basic construction $(F,{\mathcal F})$ defines the topology ${\mathcal T}$
for $|\mathscr{S}|$.  The following is easily verified using the continuity of the strong bundle maps
$p:K\rightarrow O$. The following result is an analogue to Theorem \ref{TOPOLOGY}.

\begin{theorem}\index{T- Natural topology $\bar{\mathcal T}$}
Assume we are given a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $(\mathscr{S},\mu)$
with underlying basic construction $(F,{\mathcal F})$. Then the following holds.
\begin{itemize}
\item[{\em (1)}]\  The set $\bar{\mathcal T}$ is a topology on $|{\mathcal E}|$. 
\item[{\em (2)}]\  For $\bar{\Psi}\in \bar{F}(\alpha)$, $\bar{\Psi}:G\ltimes K\rightarrow {\mathcal E}$,  and $\wh{W}\subset K$ open the set $|\bar{\Psi}(W)|$
is open in $|{\mathcal E}|$.
\item[{\em (3)}]\   With $\bar{\Psi}$ as in (ii) the induced $|\bar{\Psi}|:|G\ltimes K|\rightarrow |{\mathcal E}|$ is a homeomorphism onto an open set.
\item[{\em (4)}] \   For every point $z\in |\mathscr{S}|$ there exists an open neighborhood $V$ of $z$ in $|\mathscr{S}|$
so that $|P|^{-1}(V)$ with the induced topology from $\bar{\mathcal T}$ is metrizable.
\item[{\em (5)}]\  The map $|P|:|{\mathcal E}|\rightarrow |\mathscr{S}|$ is continuous.
\end{itemize}
\qed
\end{theorem}

The metrizability of $\bar{\mathcal T}$ only depends on the metrizability of the underlying ${\mathcal T}$ 
on $|\mathscr{S}|$.
\begin{proposition}\index{P- Metrizability for $\bar{\mathcal T}$}
Assume we are given a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $(\mathscr{S},\mu)$
with underlying basic construction $(F,{\mathcal F})$.  If the natural topology ${\mathcal T}$ for
$|\mathscr{S}|$ is metrizable the topology $\bar{\mathcal T}$ for $|{\mathcal E}|$ is metrizable as well.
\qed
\end{proposition}

\subsection*{Natural Strong Bundle  Structures for $\bm{M}(\bar{\Psi},\bar{\Psi}')$}
Under the same assumptions as before we can equip $\bm{M}(\bar{\Psi},\bar{\Psi}')$ with a metrizable topology.
\begin{definition}\index{D- Topology $\bar{\mathcal T}_{\bar{\Psi},\bar{\Psi}'}$}
For $\bar{\Psi}\in \bar{F}(\alpha)$ and $\bar{\Psi}'\in \bar{F}(\alpha')$ denote by $\bar{\mathcal T}_{\bar{\Psi},\bar{\Psi}'}$ the collection of subsets $\wh{W}$ of $\bm{M}(\bar{\Psi},\bar{\Psi}')$ having the following property.
Given $\bar{h}=(a,\wh{\Phi},a')$ there exists an open neighborhood $\wh{V}$ of $\bar{h}$ in $K$
such that $\bar{F}_h(\wh{V})\subset \wh{W}$.
\qed
\end{definition}\index{T- Topological properties of $\bm{M}(\bar{\Psi},\bar{\Psi}')$}
The basic topological  results are  stated in the following theorem.
\begin{theorem}
Assume we are given a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $(\mathscr{S},\mu)$
with underlying basic construction $(F,{\mathcal F})$. The set $\bar{\mathcal T}_{\bar{\Psi},\bar{\Psi}'}$
defines a topology on $\bm{M}(\bar{\Psi},\bar{\Psi}')$.  The topological spaces
$(\bm{M}(\bar{\Psi},\bar{\Psi}'), \bar{\mathcal T}_{\bar{\Psi},\bar{\Psi}'})$ are metrizable and have the following properties.
\begin{itemize}
\item[{\em (1)}]\   The source map $s:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow K$ is a local homeomorphism.
\item[{\em (2)}]\  The target  map $t:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow K'$ is a local homeomorphism.
\item[{\em (3)}]\  The unit map $u:K\rightarrow \bm{M}(\bar{\Psi},\bar{\Psi})$ is continuous.
\item[{\em (4)}]\   The inversion map 
$\iota:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\bar{\Psi}',\bar{\Psi})$ is a homeomorphism.
\item[{\em (5)}]\  The multiplication map
$$
m:\bm{M}(\bar{\Psi}',\bar{\Psi}''){_{s}\times_t} \bm{M}(\bar{\Psi},\bar{\Psi}') \rightarrow \bm{M}(\bar{\Psi},\bar{\Psi}'')
$$ 
is continuous.
\item[{\em (6)}]\   $\bm{m}: \bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')$ 
for the natural topologies is continuous.
\end{itemize}
In addition the projection map $\bm{m}:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')$ is continuous.
\qed
\end{theorem}



\subsection*{Strong Bundle Structure for $P:{\mathcal E}\rightarrow \mathscr{S}$}
Given $(\bar{F},\bar{\mathcal F})$ it follows that $\bm{m}:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')$ has in a natural way the structure of a strong bundle over a M-polyfold.

\begin{theorem}\index{T- Natural strong bundle structure for $\bm{m}$}
Assume we are given a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $(\mathscr{S},\mu)$
with underlying basic construction $(F,{\mathcal F})$. Then, with the spaces 
equipped with their natural topologies $\bm{m}:\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')$ admits a natural structure of a M-polyfold bundle, where the structure on the base
coincides with the previously defined natural M-polyfold structure. For this structure the 
structural maps $s$ and $t$ are locally diffeomorphic strong bundle maps. The unit map 
and multiplication are strong bundle maps, and the inversion map is a strong bundle isomorphism.
\qed
\end{theorem}
From this we deduce the following basic result.
\begin{theorem}
Assume we are given a basic bundle construction $(\bar{F},\bar{\mathcal F})$ for $(\mathscr{S},\mu)$
with underlying basic construction $(F,{\mathcal F})$.  Assume that the natural topology ${\mathcal T}$ for 
$|\mathscr{S}|$ is metrizable. Then the natural topology $\bar{\mathcal T}$ for $|{\mathcal E}|$ is metrizable.
Further for objects $\alpha,\alpha'$ in $\mathscr{S}$ and $\bar{\Psi}\in\bar{F}(\alpha)$, $\bar{\Psi}'\in \bar{F}(\alpha')$
$$
\bm{M}(\bar{\Psi},\bar{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')
$$
has in a natural way the structure of a strong bundle over a M-polyfold. Hence there is an associated
strong bundle construction $(\bar{F},\bm{M})$ for $P:{\mathcal E}\rightarrow \mathscr{S}$.
\qed
\end{theorem}
\begin{remark}
The results in Chapter \ref{CHAPTER19X} allow to construct polyfold structures on certain groupoidal categories $\mathscr{S}$ as well as certain bundles
over them $P:{\mathcal E}\rightarrow \mathscr{S}$. Once $P$ is equipped with the structure as a strong bundle over a polyfold we can study
section functors $S$ of $P$. Of particular interest are sc-Fredholm functors, which can be studied by the methods introduced in this book, see in particular Chapters \ref{CHAPX17} and \ref{CHAPX18}.
\qed
\end{remark}




\section{Covering Constructions}\label{SECX19.7}
The main point in this section is the description of a basic type of construction, which provides a given 
finite-to-one covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$, defined below, with an adapted uniformizer construction, where the uniformizers respect the structure functor $\mathsf{P}$, and in addition are sc-smoothly compatible.
 As such this is a generalization of the ideas in Section \ref{SECX19.1} and quite close to the corresponding strong bundle version 
given in Section \ref{SECX19.6}.
Recall Definition \ref{DEFNX19.1.1} for the notion of a groupoidal category.  We shall denote by $A$ the class
of objects associated to $\mathscr{A}$ and by $\bm{A}$ the class of morphisms. Similarly for $\mathscr{B}$ they are denoted by $B$ and
$\bm{B}$.


\begin{definition}\index{D- Finite to one covering functor}\label{DEFNX19.7.1}
A {\bf finite-to-one  covering functor} $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ 
 is a functor between  two groupoidal categories,
 which has the following properties:
 \begin{itemize}
 \item[(1)]\   $\mathsf{P}$ is surjective on objects and  the preimage of every object is finite.
 \item[(2)] \ The assignment $\bm{A}\rightarrow \bm{B}{_s\times_{\mathsf{P}}} A$ which maps $\phi$ to
 $(\mathsf{P}(\phi),s(\phi))$ is a bijection.
 \end{itemize}
 \qed
\end{definition}
\begin{remark}
Note that there is no topology in play and compare with Definition \ref{DEFNX17.7.1}.
Essentially the above definition reflects the properties (ii) and (iii) from \ref{DEFNX17.7.1}.
We shall discuss constructions which shall also define topologies on $|\mathscr{A}|$ and $|\mathscr{B}|$.
These additional structures will turn under suitable assumptions the groupoidal categories $\mathscr{A}$  and $\mathscr{B}$  into GCT's 
and $\mathsf{P}$ into a proper covering functor.
\qed
\end{remark}
 Next we shall introduce the notion 
of uniformizer but, for the lack of  having a topology on the orbit spaces, the definitions 
will not involve a topology for the moment.
\begin{definition}\label{DEFNX19.7.2}
Given a finite-to-one covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$, a {\bf proper covering uniformizer}
(or uniformizer for short)  for $\mathsf{P}$ at the object $\beta$ in $\mathscr{B}$ with isotropy $G$ consists of a pair of functors
$\wh{\Psi}:E\rightarrow \mathscr{A}$ and  $\Psi: G\ltimes O_\beta\rightarrow \mathscr{B}$, where $\wh{\tau}:E\rightarrow G\ltimes O_\beta$ is a proper ep-groupoid covering model, see Definition \ref{DEFQ1773},  so that the following holds
\begin{itemize}
\item[(1)] \ The distinguished point $o_\beta$ is mapped by $\Psi$ to $\beta$. 
\item[(2)] \ The functors $\Psi$ and $\wh{\Psi}$ are fully faithful and injective on objects and fit into the commutative  diagram
\begin{eqnarray}\label{EQNY19.1}
\begin{CD}
E @>\wh{\Psi} >>  \mathscr{A}\\
@V\wh{\tau} VV    @V \mathsf{P} VV\\
G\ltimes O_\beta @>\Psi>> \mathscr{B}
\end{CD}
\end{eqnarray}
\item[(3)]  \ The diagram (\ref{EQNY19.1}) is cartesian (see the next definition).
\end{itemize}
\qed
\end{definition}
\begin{definition}\index{D- Cartesian diagram}
The functor diagram (\ref{EQNY19.1}) is {\bf cartesian} provided on the object level the  image of the functor pair
$\langle\wh{\tau},\wh{\Psi}\rangle :E\rightarrow O_\beta\times A$ precisely consists of all pairs 
$(o,a)$ such that $\mathsf{P}(a) =\Psi(o)$.  
On the morphism level  the following is required.
 If $\wh{\Phi}$ belongs to $\bm{A}$
and $\mathsf{P}(\wh{\Phi})= \Psi(g,o)$ then there exists $\phi\in \bm{E}$
with $\wh{\tau}(\phi)=(g,o)$ and $\wh{\Psi}(e)=\wh{\Phi}$.
\qed
\end{definition}
Let us make the following observations concerning Definition \ref{DEFNX19.7.2}. Recalling 
Definition \ref{DEFQ1773}  we see that on the object level
$E$ is the disjoint union of finitely many open subsets $\wh{O}_a$, where $a$ varies in $\wh{\tau}^{-1}(o_\beta)$, so that
$\wh{\tau}:(O_a,a)\rightarrow (O_\beta,o_\beta)$ is an sc-diffeomorphism. This implies that on the object level $\Psi:O_b\rightarrow \mathscr{B}$ is determined by $\wh{\Psi}$ via
$$
\Psi(o) =\mathsf{P}\circ\wh{\Psi}\circ (\wh{\tau}|\wh{O}_a)^{-1}.
$$
Moreover, $\Psi$ is determined on morphisms as follows.   Since $\wh{\tau}$ is a proper ep-groupoid covering model the map
$$
\bm{E}\rightarrow \text{mor}(G\ltimes O_\beta){_{s}\times_{\wh{\tau}}}E: \phi\rightarrow (\wh{\tau}(\phi),s(\phi))
$$
is an sc-diffeomorphism.  Given a morphism $(g,o)\in G\times O_\beta$  we can fix a point $\wh{o}\in \wh{O}_a$ satisfying $\wh{\tau}(\wh{o})=o$.
We find a unique $\phi\in \bm{E}$ such that
$$
\wh{\tau}(\phi) =(g,o)\ \ \text{and}\ \ \ s(\phi)=\wh{o}.
$$
Then by commutativity  of the functor diagram
$$
\Psi(g,o) = \Psi\circ \wh{\tau}(\phi) = \mathsf{P}\circ \wh{\Psi}(\phi).
$$
Hence we have proved the following lemma.
\begin{lemma}\label{LEMMX19.7.3}
Let  $\wh{\tau}:E\rightarrow G
\ltimes O_\beta$ be a proper ep-groupoid covering model,  $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$
 a finite-to-one covering functor, and  $\wh{\Psi}:E\rightarrow \mathscr{A}$  having the property 
that  there exists a uniformizer $\Psi:G\ltimes O_\beta\rightarrow \mathscr{B}$
so that $(\wh{\Psi},\Psi)$ is a proper covering uniformizer. Then $\Psi$ is uniquely determined by $\wh{\Psi}$.
\qed
\end{lemma}
\begin{remark}
As a consequence, rather than  referring to Definition \ref{DEFNX19.7.2} we shall just refer to a uniformizer $\wh{\Psi}$
for $\mathsf{P}$. This then implicitly implies  that there exists a $\Psi$  fitting into the obvious commutative diagram. As shown such a $\Psi$ is unique, if it exists.
\qed
\end{remark}

As before we can introduce the notion of a uniformizer construction which fits the current context.
\begin{definition}
Given a finite-to-one  covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$, a {\bf proper covering uniformizer construction}
or simply just a uniformizer construction is given by a functor $\bar{F}:\mathscr{B}^-\rightarrow \text{SET}$
which associates to an object $\beta$ a set $\bar{F}(\beta)$ of unifomizers for $\mathsf{P}$ at $\beta$
in the sense of Definition \ref{DEFNX19.7.2} or the  remark after  Lemma \ref{LEMMX19.7.3}.
\qed
\end{definition}
\begin{remark}
The construction associates to $\beta$ a set of uniformizers $\wh{\Psi}$ for $\mathsf{P}$ and 
from this data we can construct the associated $\Psi$.
As already pointed out in previous discussions $\bar{F}$ usually has more structure and very often is a functor 
on $\mathscr{B}$.
\qed
\end{remark}
In a next step we note that given $\bar{F}$, there are transition sets associated $\wh{\Psi}$ and $\wh{\Psi}'$.
Since this data  also determines $\Psi$ and $\Psi'$ we obtain transition data for the latter. The sets 
$\bm{M}(\wh{\Psi},\wh{\Psi}')$ and $\bm{M}(\Psi,\Psi')$ are naturally related by the map $\mathsf{p}$
\begin{eqnarray}
\mathsf{p}:\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'):\mathsf{p}(e,\phi,e')=(\wh{\tau}(e),\mathsf{P}(\phi),\wh{\tau}'(e')).
\end{eqnarray}
We note that the map $\mathsf{p}$ is surjective and the preimage of each point is a finite set. 
Using the same arguments as in Lemma \ref{LEMM1776} we obtain the following result.
\begin{lemma}
The map $\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}}E$ 
defined by 
$$
(e,\phi,e')\rightarrow (\mathsf{p}(e,\phi,e'),s(e,\phi,e'))= ((\wh{\tau}(e),\mathsf{P}(\phi),\wh{\tau}'(e')),e)
$$
is a bijection.
\qed
\end{lemma}
We shall list the various transition sets which we can build. The source and target maps fit into the following diagram
$$
\begin{CD}
E@< s<<  \bm{M}(\wh{\Psi},\wh{\Psi}') @>t >>  E'\\
@V \wh{\tau} VV @V \mathsf{p} VV  @V \wh{\tau}' VV \\
O_\beta @< s <<   \bm{M}(\Psi,\Psi') @> t>> O_{\beta'}'.
\end{CD}
$$  
The inversion maps and unit maps give the following two diagrams.
$$
\begin{array}{cc}
\begin{CD}
\bm{M}(\wh{\Psi},\wh{\Psi}') @>\iota >>  \bm{M}(\wh{\Psi}',\wh{\Psi})\\
@V \mathsf{p} VV  @V \mathsf{p}VV\\
\bm{M}(\Psi,\Psi') @>\iota >> \bm{M}(\Psi',\Psi)
\end{CD}
\ \ \ &\ \ \
\begin{CD}
E @> u >> \bm{M}(\wh{\Psi},\wh{\Psi})\\
@V \wh{\tau} VV   @V \mathsf{p} VV\\
O_\beta @> u >>   \bm{M}(\Psi,\Psi).
\end{CD}
\end{array}
$$
Finally the multiplication is compatible with the structural $\mathsf{p}$-maps
$$
\begin{CD}
\bm{M}(\wh{\Psi}',\wh{\Psi}''){_{s}\times_t}\bm{M}(\wh{\Psi},\wh{\Psi}')@> m>> \bm{M}(\wh{\Psi},\wh{\Psi}'')\\
@V\mathsf{p}{_{s}\times_t}\mathsf{p} VV @V \mathsf{p}VV\\
\bm{M}({\Psi}',{\Psi}''){_{s}\times_t}\bm{M}({\Psi},{\Psi}')@> m>> \bm{M}({\Psi},{\Psi}'').
\end{CD}
$$
As in Section \ref{SECX19.1} we can consider transition constructions ${\mathcal F}$, see Definition
\ref{DEFNX19.1.5},  for the transition sets $\bm{M}(\wh{\Psi},\wh{\Psi}')$
and $\bm{M}(\Psi,\Psi')$. Of course, since we have the structural maps $\mathsf{p}$ these constructions
should be in some sense $\mathsf{p}$-compatible, and we shall introduce the needed compatibility requirements.
\begin{definition}\index{D- $\mathsf{P}$-Transtion construction}
Assume $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ is a finite-to-one covering functor
and   $\bar{F}$ is a uniformizer construction for $\mathsf{P}$.
Given  transition  constructions  $\bar{\mathcal F}$  for sets of the form  $\bm{M}(\wh{\Psi},\wh{\Psi}')$
and ${\mathcal F}$ for sets of the form $\bm{M}(\Psi,\Psi')$ we say that they are {\bf $\mathsf{P}$-compatible} if the following holds.
Given $\wh{h}\in \bm{M}(\wh{\Psi},\wh{\Psi}')$
we have a germ 
$$
\wh{F}_{\wh{h}}:{\mathcal O}(E,s(\wh{h}))\rightarrow (\bm{M}(\wh{\Psi},\wh{\Psi}'),\wh{h}):\wh{u}\rightarrow \wh{F}_{\wh{h}}(\wh{u}),
$$
and for $h\in \bm{M}(\Psi,\Psi')$
$$
F_h:{\mathcal O}(O_\beta,s(h))\rightarrow (\bm{M}(\Psi,\Psi'),h):u\rightarrow F_h(u).
$$
We require that given $\wh{h}\in \bm{M}(\wh{\Psi},\wh{\Psi}')$
the following holds
\begin{eqnarray}\label{EQNX19.2}
\mathsf{p}\circ \wh{F}_{\wh{h}}(\wh{u}) = F_{\mathsf{p}(\wh{h})}\circ \wh{\tau}(\wh{u})\ \text{for}\ \wh{u}\ \text{near to}\ s(\wh{h}).
\end{eqnarray}
\qed
\end{definition}
Each of these transition constructions $\bar{\mathcal F}$ and ${\mathcal F}$ satisfy a list of properties which are stated before Definition \ref{DEFNX19.1.5}.
The fact that $\mathscr{A}$ and $\mathscr{B}$ are related by the covering functor $\mathsf{P}$ requires us to demand
a compatibility between $\bar{\mathcal F}$ and ${\mathcal F}$, which we stated above.   
Recall that $\wh{\tau}:E\rightarrow G\ltimes O_\beta$ on the object level is a local sc-diffeomorphism and it maps sc-diffeomorphically the
neighborhood germs
$$
{\mathcal O}(E,s(\wh{h}))\rightarrow {\mathcal O}(O_\beta,s(\mathsf{p}(\wh{h}))).
$$
Hence it relates with $h=\mathsf{p}(\wh{h})$ the germ $\wh{F}_{\wh{h}}$ with the germ $F_h$. 
Recall that $\wh{F}_{\wh{h}}$ and $F_h$ can be written as follows.
\begin{eqnarray}
F_h(u)=(u,\Phi_{h,u},f_h(u))\ \ \text{and}\ \  \wh{F}_{\wh{h}}(\wh{u})=(\wh{u},\wh{\Phi}_{\wh{h},\wh{u}},\wh{f}_{\wh{h}}(\wh{u}).
\end{eqnarray}
 We explore the equality given in (\ref{EQNX19.2})
and infer that for $\wh{u}$ near $\wh{o}=s(\wh{h})$ with $f_h = t\circ F_h$ and $\wh{f}_{\wh{h}}=t\circ \wh{F}_{\wh{h}}$
\begin{eqnarray}
\mathsf{P}(\wh{\Phi}_{\wh{u}}) = \Phi_{\wh{\tau}(\wh{u})}\ \ \text{and}\ \  \wh{\tau}\circ  \wh{f}_{\wh{h}}(\wh{u})= f_h\circ \wh{\tau}(\wh{u}).
\end{eqnarray}
This also implies  that the (germs of) sc-diffeomorphisms  $f_h$ are uniquely determined by the $\wh{f}_{\wh{h}}$. 
Indeed, for $a\in\wh{\tau}^{-1}(o_\beta)$ the restriction $\tau_a:(O_a,a)\rightarrow (O_\beta,o_\beta)$
of $\wh{\tau}$ is a sc-diffeomorphism. Hence, picking an $a\in \wh{\tau}^{-1}(o_\beta)$ we can write
$$
f_h(u) = \wh{\tau}\circ \wh{f}_{\wh{h}}\circ \tau_a^{-1}(u)
$$
for $u$ near $s(h)$, where $h=\mathsf{p}(\wh{h})$.
Moreover,  we must have
\begin{eqnarray}
\Phi_{h,u} = \mathsf{P}(\wh{\Phi}_{\wh{h},\tau_a^{-1}(u)})\ \ \text{for}\ \ u\ \text{near}\ s(h)
\end{eqnarray}
and therefore the germ $F_h$ is given by
\begin{eqnarray}
F_h(u) =(u,\mathsf{P}(\wh{\Phi}_{\wh{h},\tau_a^{-1}(u)}), \wh{\tau}\circ \wh{f}_{\wh{h}}\circ \tau_{a}^{-1}(u)).
\end{eqnarray}
Having the transition construction for $\mathsf{P}$ we obtain a natural topology $\bar{\mathcal T}$ for $|\mathscr{A}|$
and a natural topology ${\mathcal T}$ for $|\mathscr{B}|$, see Section \ref{SECNX19.2}.
Further $\bm{M}(\Psi,\Psi')$ and 
$\bm{M}(\wh{\Psi},\wh{\Psi}')$ obtain natural metrizable topologies as discussed in Section \ref{SECXN19.3}, and natural M-polyfold structures as shown in Theorem \ref{THMX19.5.1} of Section  \ref{SECNX19.5}.
\begin{proposition}
Considering  $\bm{M}(\wh{\Psi},\wh{\Psi}')$ and $\bm{M}(\Psi,\Psi')$ with  their natural M-poly\-fold structures 
the map 
$$
\mathsf{p}:\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi')
$$
 is sc-smooth and
a surjective  local sc-diffeomorphism. Moreover the map
\begin{eqnarray}\label{EQNX19.3}
\Gamma:\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}} E:
(\wh{o},\wh{\Phi},\wh{o}')\rightarrow (\mathsf{p}(\wh{o},\wh{\Phi},\wh{o}'),\wh{o})
\end{eqnarray}
is a sc-diffeomorphism.
\end{proposition}
\begin{proof}
We already know that $\mathsf{p}$ is surjective. Pick any $\wh{h}\in \bm{M}(\wh{\Psi},\wh{\Psi}')$ and define
$h=\mathsf{p}(\wh{h})$. Defining  $\wh{o}=s(\wh{h})$ and $o=s(h)$ we find an open neighborhoods
$U(\wh{o})$ and $U(o)$ so that the following holds.
\begin{itemize}
\item[(1)]\ $\wh{\tau}:U(\wh{o})\rightarrow U(o)$ is a sc-diffeomorphism.
\item[(2)]\  $\bar{F}_{\wh{h}}:U(\wh{o})\rightarrow \bm{M}(\wh{\Psi},\wh{\Psi}')$ is a sc-diffeomorphism
onto an open neighborhood $U(\wh{h})$.
\item[(3)]\ $F_h:U(o)\rightarrow \bm{M}({\Psi},{\Psi}')$ is a sc-diffeomorphism onto an open neighborhood
$U(h)$.
\end{itemize}
From the property $\mathsf{p}\circ \bar{F}_{\wh{h}}(\wh{u})=F_h\circ \wh{\tau}(\wh{u})$ we see
that 
$$
\mathsf{p} (\wh{k}) = F_h\circ \wh{\tau}\circ \bar{F}^{-1}_{\wh{h}}(\wh{k})\ \ \wh{k}\in U(\wh{h}).
$$
This implies that the image of $\mathsf{p}$ equals $U(h)$ and that as a composition of sc-diffeomorphisms 
the map $\mathsf{p}:U(\wh{h})\rightarrow U(h)$ is a sc-diffeomorphism.   
Since $s:\bm{M}(\Psi,\Psi')\rightarrow O_\beta$ is a local sc-diffeomorphism  it follows that 
$\bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}} E$ has a natural M-polyfold structure which is obtained
from the fact that $\bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}} E$ is a sub-M-polyfold
of $\bm{M}(\Psi,\Psi')\times E$. The map in (\ref{EQNX19.3}) is a bijection and 
since $s: \bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow E$ is sc-smooth and $\mathsf{p}$ is sc-smooth 
we infer that the map in (\ref{EQNX19.3}) is sc-smooth.  To complete the proof it suffices to show that this map is a local sc-diffeomorphism.  Pick $\wh{h}\in \bm{M}(\wh{\Psi},\wh{\Psi}')$ and define $h=\mathsf{p}(\wh{h})$.
Introducing $o=s(h)$ and $\wh{o}=s(\wh{h})$ we  find sufficiently small open neighborhoods $U(\wh{o})$, $U(\wh{h})$, $U(o)$, and $U(h)$ such that $\wh{\tau}:U(\wh{o})\rightarrow U(o)$, $F_h:U(o)\rightarrow U(h)$, and
$\wh{F}_{\wh{h}}:U(\wh{o})\rightarrow U(\wh{h})$  are  sc-diffeomorphisms. We note that the following map
is a local sc-diffeomorphism
$$
\Theta: U(o)\rightarrow \bm{M}(\Psi,\Psi'){_{s}\times_{\wh{\tau}}} E: u\rightarrow \Theta(u):=(F_h(u),\wh{\tau}^{-1}(u)).
$$
Then 
$$
\Gamma^{-1}\circ \Theta(u) = \wh{F}_{\wh{h}}\circ \wh{\tau}^{-1}(u),
$$
 which shows that 
$\Gamma^{-1}$ near $(h,\wh{o})$ is sc-smooth. This completes the proof.
\qed \end{proof}

In order to obtain polyfold structures for $\mathscr{A}$ and $\mathscr{B}$, it is important that the natural topologies
satisfy the properness property,  and that the topologies are paracompact. Since the data for $\mathscr{A}$ and 
$\mathscr{B}$ is intertwined it follows that the properness property for ${\mathcal T}$ and $\bar{\mathcal T}$
are equivalent requirements, and the same holds for the paracompactness property.

\begin{lemma}\index{L- Continuity and openness of $\vert\mathsf{P}\vert$}
Let $|\mathscr{A}|$ and $|\mathscr{B}|$ be equipped with the natural topologies. 
Then the map $|\mathsf{P}|$ is continuous and open.
\end{lemma}
\begin{proof}
Let $|\beta|\in |\mathscr{B}|$ be given.  Take a representative $\beta$
and a proper covering uniformizer giving the diagram
\begin{eqnarray}\label{ERTP}
\begin{CD}
E @>\wh{\Psi} >> \mathscr{A}\\
@V\wh{\tau}VV   @V\mathsf{P} VV\\
G\ltimes O_\beta @>\Psi>>   \mathscr{B}
\end{CD}
\end{eqnarray}
Passing to orbit spaces we obtain the following  commutative diagram, where the horizontal
maps are topological embeddings
$$
\begin{CD}
|E|  @> |\wh{\Psi}| >> |\mathscr{A}|\\
@V |\wh{\tau}|  VV   @V |\mathsf{P}| VV\\
_G\backslash O_\beta @>|\Psi| >>  |\mathscr{B}|
\end{CD}
$$
Take an open neighborhood $U(|\beta|)$ contained in the image of $|\Psi|$
and let $U(|o_\beta|)$ be the preimage under $|\Psi|$. Since $|\wh{\tau}|$ is continuous 
we see that 
$$
|\mathsf{P}|^{-1}(U(|\beta|))= |\wh{\Psi}|(|\wh{\tau}|^{-1}(U(|o_\beta|)
$$
which is an open set.  This proves continuity.

In order to obtain the openness we just need to show that $|\wh{\tau}|$ is open.
Indeed, if $|\alpha|\in |\mathscr{A}|$ we can take a representative $\alpha$ and define $\beta=\mathsf{P}(\alpha)$.
We need to show that the image of an arbitrarily small open neighborhood of $|\alpha|$ is open.
We take a proper covering uniformizer, which as usual is $\wh{\Psi}$ with underlying $\Psi$.
We take $a\in E$ with $\wh{\Psi}(a)=\alpha$ and take a small open neighborhood 
$U(a)\subset E$ so that $\wh{\tau}:U(a)\rightarrow U(b)$ is an sc-diffeomorphism 
for a suitable open neighborhood $U(o_\beta)$. By a standard fact $|\wh{\Psi}(U(a))|$ and $|\Psi(U(o_\beta))|$ are open.
Now we notice that
$$
|\mathsf{P}|(|\wh{\Psi}(U(a))|)= |\Psi(U(o_\beta))|,
$$
which follows from the commutative diagram (\ref{ERTP}).
\qed \end{proof}
We shall need some more information about $|\mathsf{P}|$.
\begin{lemma}\label{LEMMX19.7.10}
For every  $z\in |\mathscr{B}|$ and given open neighborhoods $U(z)$ and $\wh{U}$ of $|\mathsf{P}|^{-1}(z)$
there exists  a proper covering model
$\wh{\tau}:E\rightarrow G\ltimes O_\beta$  with $|\Psi(o_\beta)|=z$ so that the following holds.
\begin{itemize}
\item[{\em (1)}]\  There exists an open $G$-invariant neighborhood $V(o_\beta)$ in $O_\beta$ having the properness property and satisfying  $|\Psi(V(o_\beta))|\subset U(z)$.
\item[{\em (2)}] \    There exist points $a_1,...a_k\in \wh{\tau}^{-1}(o_\beta)$ and open neighborhoods $V(a_i)$ invariant 
under the $G_{a_i}$-action and having the properness property so that the $|\wh{\Psi}(V(a_i))|$ are mutually 
disjoint and 
\begin{eqnarray}\label{KLOPs9}
|\mathsf{P}|^{-1}(V(z))=  \bigsqcup_{i=1}^k |\wh{\Psi}(V(a_i))| \subset \wh{U}.
\end{eqnarray}
\end{itemize}
\end{lemma}
\begin{proof}
Given $z$ we pick an object $\beta$ representing it and a proper covering model $\wh{\tau}$.
Pick a maximal collection of points $a_1,...,a_k\in E$ with $\wh{\tau}(a_i)=b$
so that any two of them are not connected by an isomorphism. Then denote by $a_{k+1},...a_{k+\ell}$
the other preimages. 
We can find for $i\in \{1,...,k\}$ arbitrarily small open neighborhoods
$V(a_i)$ invariant under the $G_{a_i}$-action so that the restrictions of $\wh{\tau}$ are sc-diffeomorphisms
onto suitable open neighborhoods of $o_\beta$. We can arrange, by taking possibly smaller sets, that their images
are all the same, and using the properness property for $E$ that there are no morphisms 
starting in $V(a_i)$ and ending in $V(a_j)$ for $i\neq j$, where $i,j\in \{1,...,k\}$. Denote the common image
of these sets by $U(o_\beta)$.  Then we have the sc-diffeomorphisms $\wh{\tau}:V(a_i)\rightarrow U(o_\beta)$
and the sets $|\wh{\Psi}(V(a_i))|$ are mutually disjoint.  Perhaps, passing to smaller sets we may assume
that
$$
|\wh{\Psi}(V(a_i))|\subset \wh{U}\ \text{for}\ i\in \{1,...,k\},\ \text{and}\ \ |\Psi(U(o_\beta))|\subset U(z).
$$
It holds for every $i\in \{1,...,k\}$ that
\begin{eqnarray}\label{EQNX19.5}
|\mathsf{P}| ( |\wh{\Psi}(V(a_i))|) = |\Psi|(|\wh{\tau}(V(a_i))|)=|\Psi|(U(o_\beta))=: V(z).
\end{eqnarray}
  With the definitions of $V(a_i)$  and $V(z)$ in (\ref{EQNX19.5})
it follows that
$$
|\mathsf{P}|^{-1}(V(z)) = \bigcup_{i=1}^k |\wh{\Psi}(V(a_i))|\subset \wh{U}.
$$
\qed \end{proof}
Next we are ready to give a result relating the paracompactness for the natural topologies 
on $|\mathscr{A}|$ and $|\mathscr{B}|$ as well as the properness properties.

\begin{proposition}%
Assume that $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ is a proper covering functor, and we are given a uniformizer
construction $\bar{F}$ as well as a transition construction $\bar{\mathcal F}$ with underlying $F$ and ${\mathcal F}$. Then for the natural topologies it holds that ${\mathcal T}$ has the properness property if and only $\bar{\mathcal T}$ has the properness property. 
\end{proposition}
\begin{proof}
  Assume first that $\bar{\mathcal T}$ has the properness property.
Take any uniformizer $\wh{\Psi}:E\rightarrow \mathscr{A}$ for $\mathsf{P}$. Recall that the object space $E$ is a disjoint union
of finitely many $O_{a_1},...,O_{a_k}$ each of which admits the natural $G_{a_i}$-action. Part of the structure
are morphisms which relate the different $O_{a_i}$.  In any case we can consider a $\wh{\Psi}|O_{a_i}$.
By assumption, given $\wh{o}\in O_{a_i}$ there exists an open neighborhood $U(\wh{o})$ such that  
a sequence $(\wh{q}_\ell)\subset U(\wh{o})$ with $|\wh{\Psi}(\wh{q}_\ell)|\rightarrow \wh{z}$ in $(|\mathscr{A}|,\bar{\mathcal T})$  must have a converging subsequence in $O_{a_i}$, say without loss of generality
$\wh{q}_\ell\rightarrow \wh{q}$ with $|\wh{\Psi}(\wh{q})|=\wh{z}$.

By taking $U(\wh{o})$ small enough and assuming that $\wh{o}\in O_{a_i}$ we find an open neighborhood
$U(o)$, $o=\wh{\tau}(\wh{o})$ such that $\wh{\tau}:U(\wh{o})\rightarrow U(o)$ is a sc-diffeomorphism.
It suffices to show that 
$$
\cl_{|\mathscr{B}|}(|\Psi(U(o))|)\subset |\Psi(O_\beta)|.
$$
 Take a sequence 
$(z_j)\subset |\Psi(U(o))|$ converging to some $z\in |\mathscr{B}|$. We can pick $b_j\in U(o)$ with $|\Psi(b_j)|=z_j$
and find $\wh{b}_j\in U(\wh{o}_i)$ with $\wh{\tau}(\wh{b}_j)=b_j$. It holds 
$$
|\mathsf{P}|(|\wh{\Psi}(\wh{b}_j)|) = |\Psi(b_j)|\rightarrow z.
$$
If we can show that $(|\wh{\Psi}(\wh{b}_j)|)$ has a convergent subsequence, say without loss 
converges to some $\wh{z}\in|\mathscr{A}|$, it follows from the assumption  that $\wh{z}\in |\wh{\Psi}(O_{a_i})|$.
This would imply that $z\in |\Psi(O_\beta)|$ and the proof would be completed.
We take a proper covering model around a $\beta'$ representing $z$ and for large $j$
we can express the given data with respect to this model. Employing 
Lemma \ref{LEMMX19.7.10} we infer that a subsequence of $(|\wh{\Psi}(b_j)|)$ converges and the proof
of the first part of the assertion is complete.

Assume next that ${\mathcal T}$ has the properness property.  Given a proper covering model
and uniformizers we find for given $o\in O_\beta$ an open neighborhood $U(o)$
such that $\cl_{|\mathscr{B}|}(|\Psi(U(o))| )\subset |\Psi(O_\beta)|$.  We can take $U(o)$ so small
that we have for every $a\in \wh{\tau}^{-1}(o)$ an open neighborhood $U(a)$ so that
$\wh{\tau}:U(a)\rightarrow U(o)$ is an sc-diffeomorphism. We show that given such a $U(a)$
it holds that $\cl_{|\mathscr{A}|}(|\wh{\Psi}(U(a))|)\subset |\wh{\Psi}(E)|$. Assuming that
$a_j\in U(a)$ and $|\wh{\Psi}(a_j)|\rightarrow \wh{z}$ in $|\mathscr{A}|$ we see that 
$$
|\Psi (\wh{\tau}(a_j))|=|\mathsf{P}|(|\wh{\Psi}(a_j)|)\rightarrow |\mathsf{P}|(\wh{z})=:z.
$$
By assumption $z\in |\Psi(O_\beta)|$ and it follows from Lemma \ref{LEMMX19.7.10} that 
for large $j$ the points $a_j$ belong to an arbitrary neighborhood
of $\mathsf{P}^{-1}(z)$. This implies our assertion since then a subsequence 
of the $a_j$ has to converge to an element $a'\in E$ with $|\wh{\Psi}(a')|=\wh{z}$.
This completes the proof of the properness assertion.
\qed \end{proof}

\begin{proposition}%
Assume that $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ is a proper covering functor, and we are given a uniformizer
construction $\bar{F}$ as well as a transition construction $\bar{\mathcal F}$ with underlying $F$ and ${\mathcal F}$. Then ${\mathcal T}$ is paracompact  if and only $\bar{\mathcal T}$ is paracompact.
\end{proposition}
\begin{proof}
The basic input we shall need is Lemma \ref{LEMMX19.7.10}. 
Assume first that ${\mathcal T}$ is paracompact.  We start with an open covering 
${(U_{\lambda})}_{\lambda\in\Lambda}$ of $|\mathscr{A}|$. In a first step we take a suitable refinement
which has the following property. For every $z\in |\mathscr{B}|$ the preimage $|\mathsf{P}|^{-1}(z)$ is given by finitely many points $\wh{z}_1,...,\wh{z}_k\in |\mathscr{A}|$. Applying the lemma
we find $V(z)$ and $V_z(\wh{z}_i):= |\wh{\Psi}(V(a_i))|$ such that
$$
|\mathsf{P}|^{-1}(V(z))=\sqcup _{i=1}^k V_z(\wh{z}_i)
$$
and every $V_z(\wh{z}_i)$ is contained in one of the sets $U_\lambda$. Then collection 
of all $V_z(\wh{z}_i)$ with $z$ varying in $|\mathscr{B}|$ and $i\in \{1,...,k_z\}$ is an open covering of $|\mathscr{B}|$ and  a refinement of $(U_\lambda)$. The collection ${(V(z))}_{z\in |\mathscr{B}|}$ is an open covering 
of $|\mathscr{B}|$ and since its topology ${\mathcal T}$ is paracompact we find a locally finite 
open covering with the same index set (many sets may be empty) denoted by ${(V_z)}$ such that
$V_z\subset V(z)$.  Taking the preimage by $|\mathsf{P}|$ we obtain $V_{z,\wh{z}_i}$ with $i\in \{1,...,k_z\}$.
This collection is clearly a refinement of $(U_\lambda)$. Let us first show that $(V_{z,\wh{z}_i})$
is an open covering. The openness is clear, and  moreover
\begin{eqnarray*}
|\mathscr{A}|&=&|\mathsf{P}|^{-1}(|\mathscr{B}|) \\
&=& \bigcup_{z} |\mathsf{P}|^{-1}(V_z)\\
&=& \bigcup_{z,\wh{z}_i} V_{z,\wh{z}_i}
\end{eqnarray*}
Next let us show that the covering is locally finite.  For this let $\wh{o}\in |\mathscr{A}|$
and define $o:=|\mathsf{P}|(\wh{o})$. We find an open and sufficiently small  neighborhood $W(o)$
such that there are only finitely many $z$ with $V_z\cap W(o)\neq \emptyset$.
Take  $W(\wh{o}):=|\mathsf{P}|^{-1}(W(o))$ as the open neighborhood of $\wh{o}$.
If $V_{z,\wh{z}_i}\cap W(\wh{o})\neq \emptyset$ then $W(o)\cap V_z\neq \emptyset$.
This implies that there are finitely many such sets. This shows that $\bar{\mathcal T}$ is paracompact.

Next assume that $\bar{\mathcal T}$ is paracompact.  Let $(U_\lambda)$ be an open covering of $|\mathscr{B}|$.
Again we apply Lemma \ref{LEMMX19.7.10} and find $(V(z))_{z\in |\mathscr{B}|}$ which is a refinement
of $(U_\lambda)$ and has the property 
$$
|\mathsf{P}|^{-1}(V(z))= \sqcup_{i=1}^{k_z}  V_z(\wh{z}_i).
$$
Then the collection of all $V_z(\wh{z}_i)$ is an open covering of $|\mathscr{A}|$. 
Using the same index set we find open $V_{z,\wh{z}_i}\subset V_z(\wh{z}_i)$ such that
the new collection $(V_{z,\wh{z}_i})$ is locally finite. Then for every $z$ and $i\in \{1,...,k_z\}$
the sets $|\mathsf{P}|(V_{z,\wh{z}_i})\subset V(z)$ are open. Define 
$$
W_{z,i}:= |\mathsf{P}|(V_{z,\wh{z}_i})\ \ z\in |\mathscr{B}|,\ i\in \{1,...,k_z\}.
$$
Then the whole collection $(W_{z,i})$ is an open covering and refines $(U(z))$.
We finish the proof by showing that the collection is locally finite. For any  point $o\in |\mathscr{B}|$
we find an open neighborhood $\wh{W}:=\wh{W}(|\mathsf{P}|^{-1}(o))$ which is only intersected
by finitely many $V_{z,\wh{z}_i}$ and denote by $W$ the image of $\wh{W}$ under $|\mathsf{P}|$.
  If for some $(z,i)$ it holds that $W_{z,i}\cap W\neq \emptyset$ it holds that $V_{z,\wh{z}_i}\cap \wh{W}\neq \emptyset$.
  However, there are only finitely many indices $(z,i)$ for which the latter holds. This completes the proof
  of the second part.
\qed \end{proof}





Finally we show among other things that $\mathsf{P}$ is a sc-smooth functor
\begin{theorem}
Assume that $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ is a proper covering functor 
and $\bar{F}$ and $\bar{\mathcal F}$ are a uniformizer construction  as well as a transition construction for $\mathsf{P}$.
Suppose further that the natural topology for $|\mathscr{A}|$ or for $|\mathscr{B}|$ has the properness property and is paracompact.  Then $\mathscr{A}$ and $\mathscr{B}$ have natural polyfold structures. 
The local representatives of $\mathsf{P}$ with respect to a proper covering model $\wh{\tau}:E\rightarrow G\ltimes O_\beta$
is $\wh{\tau}$. Hence $\mathsf{P}$ is an sc-smooth functor.  Moreover, for $\wh{\Psi}$ and $\wh{\Psi}'$
with $\wh{\Gamma}:\bm{M}(\wh{\Psi},\wh{\Psi}')\rightarrow \bm{A}:(e,\wh{\Phi},e')\rightarrow \wh{\Phi}$
and $\Gamma:\bm{M}(\Psi,\Psi')\rightarrow \bm{B}:(o,\Phi,o')\rightarrow \Phi$ the natural maps
we have the commutative diagram
$$
\begin{CD}
\bm{A} @> \mathsf{P}\times s  >>  \bm{B}{_{s}\times_\mathsf{P}} A\\
@A\wh{\Gamma} AA      @A\Gamma\times \Psi AA\\
\bm{M}(\wh{\Psi},\wh{\Psi}')@>\mathsf{p}\times s>>   \bm{M}(\Psi,\Psi') {_{s}\times_{\wh{\tau}}} E,
\end{CD}
$$
where the image of $\mathsf{P}\times s$ restricted to the image of $\wh{\Gamma}$ is the image of
$\Gamma\times\wh{\tau}$. Hence $\mathsf{P}\times s:\bm{A}\rightarrow \bm{B}{_{s}\times_{\mathsf{P}}}A$
is an sc-smooth functor.
\end{theorem}
\begin{proof}
We have shown that the paracompactness for ${\mathcal T}$ is equivalent to that of $\bar{\mathcal T}$. The same holds for the properness property.  Hence, the assumption implies that our data equips $\mathscr{A}$ as well as $\mathscr{B}$ with a polyfold structure. The proper covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ 
is with respect to any $\wh{\Psi}$ and the underlying $\Psi$ in the local proper covering model $\wh{\tau}:E\rightarrow G\ltimes O_\beta$ represented by $\wh{\tau}$, which follows immediately from the commutative diagram
$$
\begin{CD}
E @> \wh{\Psi} >> \mathscr{A}\\
@V \wh{\tau} VV    @V\mathsf{P} VV\\
G\ltimes O_\beta @> \Psi >>   \mathscr{B}.
\end{CD}
$$
Hence $\mathsf{P}$ is an sc-smooth functor locally (with respect $\wh{\Psi}$) representable by a proper covering functor between ep-groupoids. Given $\wh{\Psi},\wh{\Psi}'$
consider
$$
\begin{CD}
\bm{A} @> \mathsf{P}\times s  >> \bm{B}{_{s}\times_\mathsf{P}} A\\
@A\wh{\Gamma} AA      @A\Gamma\times\Psi AA\\
\bm{M}(\wh{\Psi},\wh{\Psi}')@>\mathsf{p}\times s>>   \bm{M}(\Psi,\Psi') {_{s}\times_{\wh{\tau}}} E,
\end{CD}
$$
where the first vertical arrow maps $(e,\wh{\Phi},e')$ to $\wh{\Phi}$, and the second vertical arrow maps
$((o,\Phi,o'),e)$ to $(\Phi,\wh{\Psi}(e))$. Here the bottom horizontal arrow is a sc-diffeomorphism which implies that the top arrow   is sc-smooth represented on the 
image of $\Gamma$. 
\qed
 \end{proof}

\section{Covering Constructions for Strong Bundles}
We shall finish this chapter by discussing strong bundle constructions associated to $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$.
The different ingredients have already been discussed in previous sections and the main point of our consideration is to point out
the compatibility requirement between these different constructions, when they have to fit together.


The  starting point is a finite-to-one covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ 
and $\text{Ban}$-valued functors 
$$
\mu_{\mathscr{A}}:\mathscr{A}\rightarrow \text{Ban}\ \ \text{and}\ \ 
\mu_{\mathscr{B}}:\mathscr{B}\rightarrow \text{Ban}.
$$
 Recall that $\text{Ban}$ is the category of Banach space
with the morphisms being topological isomorphisms.  
We assume these functors to be related via a natural transformation
\begin{eqnarray}
\Theta: \mu_{\mathscr{A}}\rightarrow \mu_{\mathscr{B}}\circ\mathsf{P}.
\end{eqnarray}
The natural transformation provides us for every object $\alpha$ in $\mathscr{A}$ with a topological linear isomorphism
\begin{eqnarray}
\Theta_\alpha :\mu_{\mathscr{A}}(\alpha)\rightarrow \mu_{\mathscr{B}}(\mathsf{P}(\alpha)).
\end{eqnarray}
In addition, for every morphism $\wh{\Phi}$ in $\mathscr{A}$, say $\wh{\Phi}:\alpha\rightarrow \alpha'$,
we obtain the commutative diagram
$$
\begin{CD}
\mu_{\mathscr{A}}(\alpha)@>\Theta_{\alpha}>>  \mu_{\mathscr{B}}(\mathsf{P}(\alpha))\\
@V \mu_{\mathscr{A}}(\wh{\Phi}) VV    @V \mu_{\mathscr{B}}(\mathsf{P}(\wh{\Phi})) VV \\
\mu_{\mathscr{A}}(\alpha') @>\Theta_{\alpha'} >>  \mu_{\mathscr{A}}(\mathsf{P}(\alpha')).
\end{CD}
$$
Denote by $\mathscr{E}_{\mathscr{A}}$ the obvious bundle category with objects $(\alpha,\wh{v})$,
where $\wh{v}\in \mu_{\mathscr{A}}(\alpha)$ and $\alpha$ is an object in $\mathscr{A}$.  The morphisms in $\mathscr{E}_{\mathscr{A}}$
are the pairs $(\wh{\Phi},\wh{v})$ with $\wh{v}\in \mu_{\mathscr{A}}(s(\wh{\Phi}))$ and $\wh{\Phi}$ is a morphism in $\mathscr{A}$ 
$$
 (s(\wh{\Phi}),\wh{v})\xrightarrow{(\wh{\Phi},\wh{v})} (t(\wh{\Phi}),\mu_{\mathscr{A}}(\wh{\Phi})(\wh{v})).
$$
Similarly we define   $\mathscr{E}_{\mathscr{B}}$ to consist of the objects $(\beta,v)$ with morphisms $(\Phi,v)$
$$
(s({\Phi}),{v})\xrightarrow{(\Phi,v)} (t({\Phi}),\mu_{\mathscr{B}}(\Phi)(v)).
$$
We define a functor $\wh{\mathsf{P}}:\mathscr{E}_{\mathscr{A}}\rightarrow \mathscr{E}_{\mathscr{B}}$ covering
$\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ by
\begin{eqnarray}
&\wh{\mathsf{P}}(\alpha,\wh{v}) =(\mathsf{P}(\alpha), \Theta_\alpha(\wh{v}))&\\
&\wh{\mathsf{P}}(\wh{\Phi},\wh{v})=({\mathsf{P}(\wh{\Phi})},\Theta_{s(\wh{\Phi})}(\wh{v}))&\nonumber\\
&P_{\mathscr{A}}(\alpha,\wh{v})=\alpha&\nonumber\\
&P_{\mathscr{B}}(\beta,v)=\beta&\nonumber
\end{eqnarray}
This fits into the following commutative diagram, abbreviated by ${\bf E}$
\begin{eqnarray}\label{EQNX19.12}
\begin{array}{ccc}
{\bf E}:\ \ \ \ \ \ &\ \ \ \ \ 
\begin{CD}
\mathscr{E}_{\mathscr{A}}@>\wh{\mathsf{P}}>> \mathscr{E}_{\mathscr{B}}\\
@V P_{\mathscr{A}} VV    @V P_{\mathscr{B}}VV\\
\mathscr{A} @>\mathsf{P} >>  \mathscr{B}
\end{CD}
\ \ \ \ \ & \ \ \ \ \
\begin{CD}
(\alpha,\wh{v}) @>\wh{\mathsf{P}}>>  (\mathsf{P}(\alpha),\Theta_{\alpha}(\wh{v}))\\
@V P_{\mathscr{A}}VV @V P_{\mathscr{B}}VV\\
\alpha @>\mathsf{P}>>   \mathsf{P}(\alpha),
\end{CD}
\end{array}
\end{eqnarray}
where we note that for fixed $\alpha$ the map $\mu_{\mathscr{A}}(\alpha)\ni\wh{v}\rightarrow \Theta_\alpha(\wh{v})\in \mu_{\mathscr{B}}(\mathsf{P}(\alpha))$ is a topological linear isomorphism. The morphisms are mapped as follows
\begin{eqnarray*}
\begin{CD}
(\wh{\Phi},\wh{v}) @>\wh{\mathsf{P}}>>  (\mathsf{P}(\wh{\Phi}),\Theta_{s(\wh{\Phi})}(\wh{v}))\\
@V P_{\mathscr{A}}VV @V P_{\mathscr{B}}VV\\
\wh{\Phi} @>\mathsf{P}>>   \mathsf{P}(\wh{\Phi}).
\end{CD}
\end{eqnarray*}
\begin{definition}\index{D- Bundle covering square}
A {\bf bundle covering square} is given by the diagram ${\bf E}$ in (\ref{EQNX19.12}) associated to the 
finite-to-one covering functor $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ between groupoidal categories,
and the natural transformation $\Theta:\mu_{\mathscr{A}}\rightarrow \mu_{\mathscr{B}}\circ\mathsf{P}$,
where $\mu_{\mathscr{A}}:\mathscr{A}\rightarrow \text{Ban}$ and $\mu_{\mathscr{B}}:\mathscr{B}\rightarrow \text{Ban}$ are functors.
\qed
\end{definition}





In Section \ref{SECX19.6} we discussed how a general construction will provide 
$P_{\mathscr{A}}:\mathscr{E}_{\mathscr{A}}\rightarrow \mathscr{A}$ and $P_{\mathscr{B}}:\mathscr{E}_{\mathscr{B}}\rightarrow \mathscr{B}$ with the structure of strong bundles over polyfolds.
Previously we also discussed a general construction to equip $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ with the structure 
of a proper covering functor. 
If these three constructions show a certain compatibility we
obtain a general construction of proper strong bundle covering functors.  

Our aim is to describe a procedure which would equip ${\bf E}$ with a uniformizer
as well as a transition construction. Since we have to consider a certain number of symbols
at the same time we use a notation which differs somewhat from the previous sections. It should not cause any confusion.


The local sc-smooth models for our situation, abbreviated by ${\bf K}$,  take the form 
\begin{eqnarray}\label{EQNX19.13}
\begin{array}{cc}
{\bf K}: \ \ \ \ \ \ &\ \ \ \ \
\begin{CD}
\wh{W} @>{\Xi}>>  W\\
@V \wh{Q}  VV   @V Q VV\\
\wh{E}@>{\tau}>>  E
\end{CD}
\end{array}
\end{eqnarray}
Here $\wh{Q}:\wh{W}\rightarrow \wh{E}$ and $Q:W\rightarrow E$  are  strong bundles over an ep-groupoids.
We assume that $E=G\ltimes O_\beta$, where $O_\beta$ contains the distinguished point $o_\beta$, which is mapped to the object $\beta$.
Moreover, ${\tau}:\wh{E}\rightarrow  E$ is a proper covering functor 
of ep-groupoids induced by the strong covering functor ${\Xi}:\wh{W}\rightarrow W$
between strong bundles. 
The functor  $\Xi:\wh{W}\rightarrow W$ in (\ref{EQNX19.13})  defines a topological linear isomorphism
$$
\wh{Q}^{-1}(\wh{e}) \rightarrow Q^{-1}(\tau(\wh{e})): \wh{w}\rightarrow\Xi_{\wh{e}}(\wh{w}).
$$
A morphism $(\wh{\phi},\wh{w}):\wh{w}\rightarrow \mu_{\wh{E}}(\wh{\phi})(\wh{w})$ 
is mapped by $\Xi$ to 
$$
(\tau(\wh{\phi}),\Xi(\wh{w})):\Xi(\wh{w})\rightarrow \Xi(\mu_{\wh{E}}(\wh{\phi})(\wh{w})).
$$
In diagram form this looks as follows
$$
\begin{CD}
\wh{w} @> (\wh{\phi},\wh{w})>> \mu_{\wh{E}}(\wh{\phi})(\wh{w})\\
@VVV @VVV\\
\Xi(\wh{w}) @>(\tau(\wh{\phi}),\Xi(\wh{w}))>>  \Xi(\mu_{\wh{E}}(\wh{\phi})(\wh{w})).
\end{CD}
$$
Since the following identity holds
\begin{eqnarray}
\Xi(\mu_{\wh{E}}(\wh{\phi})(\wh{w}))=\mu_E(\tau(\wh{\phi}))(\Xi(\wh{w}))
\end{eqnarray}
so that we can rewrite the diagram as
$$
\begin{CD}
\wh{w} @> (\wh{\phi},\wh{w})>> \mu_{\wh{E}}(\wh{\phi})(\wh{w})\\
@VVV @VVV\\
\Xi(\wh{w}) @>(\tau(\wh{\phi}),\Xi(\wh{w}))>>  \mu_E(\tau(\wh{\phi}))(\Xi(\wh{w})).
\end{CD}
$$
\begin{definition}\index{D- Strong bundle covering model}
We shall refer to the diagram ${\bf K}$ described in (\ref{EQNX19.13}) and with the properties 
just listed as a {\bf strong bundle covering model}.
\qed
\end{definition}

Next we can introduce the notion of a uniformizer for ${\bf E}$.


\begin{definition}\index{D- Uniformizer for a bundle covering square}
Given a bundle covering square ${\bf E}$ let $\beta$ be an object in $\mathscr{B}$.
A {\bf uniformizer} for ${\bf E}$ at the object $\beta$,
written as $\bm{\wh{\Gamma}}:{\bf K}\rightarrow {\bf E}$,  consists of a strong bundle covering model ${\bf K}$
and four uniformizers 
\begin{eqnarray}
&\Psi : E\rightarrow \mathscr{B}\ \ \ \text{and}\ \ \ \wh{\Psi}:\wh{E}\rightarrow \mathscr{A}&\\
&\Gamma:W\rightarrow \mathscr{E}_{\mathscr{B}}\ \ \text{and}\ \ \wh{\Gamma}:\wh{W}\rightarrow \mathscr{E}_{\mathscr{A}}&\nonumber
\end{eqnarray}
such that $\beta$ is in the image of $\Psi$ and the following holds:
\begin{itemize}
\item[(1)]\  $(\wh{\Psi},\Psi)$ is a uniformizer for the finite-to-one covering $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$.
\item[(2)] \ $(\Gamma,\Psi)$ is a bundle uniformizer for $P_{\mathscr{B}}:\mathscr{E}_{\mathscr{B}}\rightarrow \mathscr{B}$.
\item[(3)]\   $(\wh{\Gamma},\wh{\Psi})$ is a bundle uniformizer for $P_{\mathscr{A}}:\mathscr{E}_{\mathscr{A}}\rightarrow \mathscr{A}$.
\end{itemize}
Moreover,  the uniformizers described by $\bm{\wh{\Gamma}}$ fit into the commutative diagram
$$
\begin{tikzcd}[row sep=scriptsize, column sep=scriptsize]
& \wh{W} \arrow[dl] \arrow[rr] \arrow[dd] & & \mathscr{E}_{\mathscr{A}} \arrow[dl] \arrow[dd] \\
\wh{E} \arrow[rr, crossing over] \arrow[dd] & & \mathscr{A} \\
& W \arrow[dl] \arrow[rr] & & \mathscr{E}_{\mathscr{B}} \arrow[dl] \\
E \arrow[rr] & &\mathscr{B} \arrow[from=uu, crossing over]\\
\end{tikzcd}
$$
where the  horizontal arrows represent the uniformizers.  
\qed
\end{definition}
 We explain the form of the uniformizers next.
$\Psi$
 is defined on the special ep-groupoid $E=G\ltimes O$ and maps
an object $e\in O$ to an object $\Psi(e)$ in $\mathscr{B}$ and a morphism $\phi$ to $\Psi(\phi)$.
The functor $\Gamma:W\rightarrow \mathscr{E}_{\mathscr{B}}$ 
maps $w\in W$ to $\Gamma(w)$ which has the form
$$
\Gamma(w) = (\Psi(e), A_e(w)),
$$
where $e=Q(w)$ and $A_e:Q^{-1}(e)\rightarrow P_{\mathscr{B}}^{-1}(\Psi(e))$ is a topological linear 
isomorphism. A morphism in $W$ has the form $(\phi,w)$ with $Q(w)=s(\phi)$,
$$
(\phi,w):w\rightarrow \mu_E(\phi)(w),
$$
  and is mapped as
$$
\Gamma(\phi,w)=(\Psi(\phi), A_e(w)).
$$
The functor $\wh{\Psi}:\wh{E}\rightarrow \mathscr{A}$ maps an object $\wh{e}$ to $\wh{\Psi}(\wh{e})$
and a morphism $\wh{\phi}$ to $\wh{\Psi}(\wh{\phi})$. The functor $\wh{\Gamma}$ maps $\wh{w}\in \wh{W}$
to $\wh{\Gamma}(\wh{w})$. A morphism $(\wh{\phi},\wh{w}):\wh{w}\rightarrow \mu_{\wh{E}}(\wh{\phi})(\wh{w})$ 
is mapped to an element of the form
$$
\wh{\Gamma}(\wh{\phi},\wh{w}) =(\wh{\Psi}(\wh{\phi}), \wh{A}_{\wh{e}}(\wh{w})),
$$
where $\wh{A}_{\wh{e}}:\wh{Q}^{-1}(\wh{e})\rightarrow \mathsf{P}_{\mathscr{A}}^{-1}(\wh{\Psi}(\wh{\phi}))$ is a linear topological isomorphism, and
$\wh{Q}(\wh{w})=\wh{e}$.  The following commutative diagram lists the relevant maps on the object level
$$
\begin{tikzcd}[row sep=scriptsize, column sep=scriptsize]
& \wh{w} \arrow[dl] \arrow[rr] \arrow[dd] & & (\wh{\Psi}(\wh{e}),\wh{A}_{\wh{e}}(\wh{w})) \arrow[dl] \arrow[dd] \\
\wh{e}=\wh{Q}(\wh{w}) \arrow[rr, crossing over] \arrow[dd] & & \wh{\Psi}(\wh{e}) \\
& w=\Xi(\wh{w}) \arrow[dl] \arrow[rr] & & (\Psi(e), A_e(w)) =\wh{\mathsf{P}} (\wh{\Psi}(\wh{e}),\wh{A}_{\wh{e}}(\wh{w}))\arrow[dl] \\
e=\tau(\wh{e}) \arrow[rr] & &\Psi(e) \arrow[from=uu, crossing over].\\
\end{tikzcd}
$$
There are the following relationships 
\begin{eqnarray}
& \mathsf{P} \circ \wh{\Psi} (\wh{e}) = \Psi\circ \tau(\wh{e})\ \ \text{for}\ \ \wh{e}\in\wh{E}&\\
& \Theta_{\wh{\Psi}(\wh{e})}\circ \wh{A}_{\wh{e}}(\wh{w}) = A_e\circ \Xi(\wh{w})\ \  \text{for}\ \ \wh{w}\in \wh{W}.\nonumber&\\
& Q\circ \Xi (\wh{w}) = \tau\circ \wh{Q}(\wh{w})\ \ \text{and}\ \ \wh{w}\in \wh{W}.\nonumber
\end{eqnarray}
On the morphism level we obtain the diagram
$$
\begin{tikzcd}[row sep=scriptsize, column sep=scriptsize]
& (\wh{\phi},\wh{w}) \arrow[dl] \arrow[rr] \arrow[dd] & & (\wh{\Psi}(\wh{\phi}),\wh{A}_{\wh{e}}(\wh{w})) \arrow[dl] \arrow[dd] \\
\wh{\phi} \arrow[rr, crossing over] \arrow[dd] & & \wh{\Psi}(\wh{\phi}) \\
& (\phi,w) \arrow[dl] \arrow[rr] & & (\Psi(\phi), A_e(w)) \arrow[dl] \\
\phi=\tau(\wh{\phi}) \arrow[rr] & &\Psi(\phi) \arrow[from=uu, crossing over],\\
\end{tikzcd}
$$
and we have the following relationship
\begin{eqnarray}
&\mathsf{P}\circ \wh{\Psi}(\wh{\phi}) = \Psi\circ \tau(\wh{\phi})\ \ \text{for}\ \ \wh{\phi}\in \wh{E}.&
\end{eqnarray}
Next we consider the transition construction. We already assume that we have 
transition constructions, as described before, for the covering and strong bundle situations.
The main point here is to emphasize the necessary compatibility.
Associated to 
$$
{\bf K} \xrightarrow{\bm{\wh{\Gamma}}} {\bf E} \xleftarrow{\bm{\wh{\Gamma}'}} {\bf K'}
$$
we can take the weak fibered products which produces the diagram

$$
\begin{array}{cc}
\overline{\bm{M}}(\bm{\wh{\Gamma}},\bm{\wh{\Gamma}'})\colon \ \ \ &\ \ \ \ \ 
\begin{CD}
\bm{M}(\wh{\Gamma},\wh{\Gamma}')@>\bm{P} >> \bm{M}(\Gamma,\Gamma')\\
@V\bm{\wh{m}}VV @V\bm{m}VV\\
\bm{M}(\wh{\Psi},\wh{\Psi}')@>\bm{p}>> \bm{M}(\Psi,\Psi')
\end{CD}
\end{array}
$$
From the previous discussions we already understand (separately)
\begin{eqnarray*}
&\bm{M}(\wh{\Psi},\wh{\Psi}')\xrightarrow{\bm{p}}\bm{M}(\Psi,\Psi')\ \ \text{(covering, Section \ref{SECX19.7})}&\\
&\bm{M}(\wh{\Gamma},\wh{\Gamma}')\xrightarrow{\bm{\wh{m}}}\bm{M}(\wh{\Psi},\wh{\Psi}')\ \ \text{(strong bundle, Section \ref{SECX19.6})}&\\
&\bm{M}({\Gamma},{\Gamma}')\xrightarrow{\bm{m}}\bm{M}({\Psi},{\Psi}')\ \ \text{(strong bundle, Section \ref{SECX19.6})}.&
\end{eqnarray*}
The new ingredient is the top horizontal arrow. For each of the four ingredients we assume that we have transition constructions which are related
in a way we shall describe next.  We begin with the  bottom part of the diagram
$$
\bm{M}(\wh{\Psi},\wh{\Psi}')\xrightarrow{\bm{p}}\bm{M}(\Psi,\Psi')
$$
Recall that the morphisms in $\mathscr{A}$ are written as $\wh{\Phi}$ and in $\mathscr{B}$ as $\Phi$.
Given $\wh{h} =(\wh{o},\wh{\Phi},\wh{o}')\in 
\bm{M}(\wh{\Psi},\wh{\Psi}')$ let $h=(o,\Phi,o')=\bm{p}(\wh{h})=(\tau(\wh{o}),\tau(\wh{\Phi}),\tau'(\wh{o}'))$, 
and require that
$$
\wh{F}_{\wh{h}}:\mathscr{O}(\wh{E},s(\wh{h}))\rightarrow(\bm{M}(\wh{\Psi},\wh{\Psi}'),\wh{h}):\wh{u}\rightarrow \wh{F}_{\wh{h}}(\wh{u})
$$
is related to 
$$
F_h:\mathscr{O}(E,s(h))\rightarrow(\bm{M}(\Psi,\Psi'),h):u\rightarrow F_h(u)
$$
via
\begin{eqnarray}
\bm{p}\circ \wh{F}_{\wh{h}}(\wh{u}) = F_{h}\circ \tau(\wh{u})\ \ \text{for}\ \ \wh{u}\ \text{near}\ \ s(\wh{h}).
\end{eqnarray}
Since $\tau$ is a local sc-diffeomorphism $F_h$ is determined by $\wh{F}_{\wh{h}}$.  
We note that this requirement is precisely the one used in the proper covering construction discussed in a previous section.

Next we consider
the strong bundle
$$
\bm{M}(\Gamma,\Gamma')\xrightarrow {\bm{m}} \bm{M}(\Psi,\Psi').
$$
The transition map we shall denote by $\bm{F}_h$, which is a germ fitting into the commutative diagram
$$
\begin{CD}
W|\mathscr{O}(E,o)@> \bm{F}_h >> \bm{M}(\Gamma,\Gamma')\\
@V Q VV   @V\bm{m} VV\\
\mathscr{O}(E,o) @> F_h >>   (\bm{M}(\Psi,\Psi'),h),
\end{CD}
$$
and the following relationship holds
\begin{eqnarray}
\bm{m}\circ \bm{F}_h(w)=F_h\circ Q(w)\ \ \text{with}\ Q(w)\ \text{near}\ o.
\end{eqnarray}
Finally we consider 
$$
\bm{M}(\wh{\Gamma},\wh{\Gamma}')\xrightarrow {\bm{\wh{m}}} \bm{M}(\wh{\Psi},\wh{\Psi}').
$$
Then the relevant germ is $\bm{\wh{F}}_{\wh{h}}$ is
$$
\begin{CD}
\wh{W}|\mathscr{O}(\wh{E},\wh{o}) @> \bm{\wh{F}}_{\wh{h}} >>  \bm{M}(\wh{\Gamma},\wh{\Gamma}')\\
@V \wh{Q} VV    @V \bm{\wh{m}} VV\\
\mathscr{O}(\wh{E},\wh{o}) @> \wh{F}_{\wh{h}}>>  (\bm{M}(\wh{\Psi},\wh{\Psi}'),\wh{h}),
\end{CD}
$$
and the compatibility condition is given by
\begin{eqnarray}
\bm{\wh{m}}\circ \bm{\wh{F}}_{\wh{h}}(\wh{w})=\wh{F}_{\wh{h}}\circ \wh{Q}(\wh{w})\ \ \text{with}\ \wh{Q}(\wh{w})\ \text{near}\ \wh{o}.
\end{eqnarray}
So far the discussion is governed by the material from previous sections.

The additional requirement is a compatibility of $\bm{F}_h$ and $\bm{\wh{F}}_{\wh{h}}$.
Namely we have to require with $h=\bm{p}(\wh{h})$
\begin{eqnarray}
\bm{P}\circ \bm{\wh{F}}_{\wh{h}}(\wh{w}) = \bm{F}_h \circ \Xi (\wh{w})\ \ \text{for}\ \ \wh{Q}(\wh{w})\ \text{near}\ \wh{o}.
\end{eqnarray}
Since $\Xi$ is a local sc-diffeomorphism it follows that $\bm{F}_h$ is determined by $\bm{\wh{F}}_{\wh{h}}$.
From the previous discussion we already know that $\bm{F}_h$ determines $F_h$ and $\bm{\wh{F}}_{\wh{h}}$
determines $\wh{F}_{\wh{h}}$.

\begin{definition}
Let $\mathsf{P}:\mathscr{A}\rightarrow \mathscr{B}$ be a finite-to-one covering construction, and 
$$
\mu_{\mathscr{A}}:\mathscr{A}\rightarrow \text{Ban}\ \ \ \text{and}\ \ \ \mu_{\mathscr{B}}:\mathscr{B}\rightarrow \text{Ban}
$$
and $\Theta:\mu_{\mathscr{A}}\rightarrow \mu_{\mathscr{B}}\circ\mathsf{P}$ a natural transformation.  Denote the associated bundle covering square by ${\bf E}$.
A {\bf uniformizer construction} for ${\bf E}$ is given by a functor
$$
\overline{\bm{F}}: {\mathscr{B}}^-\rightarrow \text{SET},
$$
which associates to an object $\beta$ a set of uniformizers  
$$
\overline{\bm{F}}(\beta)=\left\{\bm{\wh{\Gamma}}\right\}
$$
at the object $\beta$, and 
 where $\bm{\wh{\Gamma}}:{\bf K}\rightarrow {\bf E}$ are defined on strong bundle covering models ${\bf K}$.
 \qed
\end{definition}


Finally, given a uniformizer construction $\bm{\bar{F}}$ for ${\bf E}$ we define a transition construction.
\begin{definition}
Let $\overline{\bm{F}}:\mathscr{B}\rightarrow \text{SET}$ be a uniformizer construction for the bundle covering square ${\bf E}$.
A transition construction $\overline{\bm{M}}$ for $\overline{\bm{F}}$ associates to the  four transition sets associated 
to $\overline{\bm{M}}(\bm{\wh{\Gamma}},\bm{\wh{\Gamma}'})$ the transition constructions $F_h$, $\wh{F}_{\wh{h}}$, $\bm{F}_h$, and
$\wh{\bm{F}}_{\wh{h}}$ with the compatibilities previously described.
\qed
\end{definition}
We obtain the following result.
\begin{theorem}
Assume that $\overline{\bm{F}}$ is a uniformizer construction and $\overline{\bm{M}}$ a transition construction for the bundle covering square ${\bf E}$.
Suppose further that the natural topology ${\mathcal T}$ for $\mathscr{B}$ satisfies the properness condition and it is paracompact.
Then he natural topologies for $|\mathscr{A}|$, $\vert\mathscr{B}\vert$, $\vert \mathscr{E}_{\mathscr{A}}\vert$, and $\vert\mathscr{E}_{\mathscr{B}}\vert$
are all metrizable. Further 
$$
\begin{CD}
\mathscr{E}_{\mathscr{A}}@> \wh{\mathsf{P}}>>\mathscr{E}_{\mathscr{B}}\\
@V P_{\mathscr{A}} VV   @V P_{\mathscr{B}} VV\\
\mathscr{A} @>\mathsf{P} >> \mathscr{B}
\end{CD}
$$
obtains the structure of proper strong bundle functor as described at the end of Section \ref{SECV17.7}.
\qed
\end{theorem}
In this paper we start with the construction of the symplectic field theory (SFT). As a general theory of symplectic invariants, SFT has been outlined in \cite{EGH}  by Y. Eliashberg, A. Givental and H. Hofer who have predicted its formal properties. The actual construction of SFT is a hard analytical problem which will be overcome be means of the polyfold theory due to the present authors. The current paper addresses  a significant amount of the  arising  issues and the general theory will be completed in part II of this paper. To illustrate the polyfold theory we shall use the results of the present paper to describe an alternative construction of the Gromov-Witten  invariants for general compact symplectic manifolds. 

\chapter{Introduction and Main Results}
In this paper  we start with the application of the polyfold theory to  the symplectic field theory (SFT)  outlined in \cite{EGH}. It turns out that the polyfold structures near noded stable curves lead also naturally to a polyfold description of the Gromov-Witten theory which is  a by-product of  the analytical foundation of SFT, presented here. The polyfold constructions for SFT will be completed in \cite{HWZ5}. 
The Gromov-Witten invariants (GW-invariants) are invariants of symplectic manifolds deduced from the structure of stable pseudoholomorphic maps from noded Riemann surfaces to the symplectic manifold. The construction of GW invariants of  general symplectic manifolds goes back to Fukaya-Ono in \cite{FO} and Li--Tian in \cite{LT}. Cieliebak--Mohnke  studied the genus zero case  in \cite{CM}. Earlier work for special symplectic manifolds are due to Ruan in  \cite{R1} and \cite{R2}. We suggest \cite{MW} for a discussion of some of the inherent difficulties in these approaches.

Our approach to the GW-invariants is quite different from the approaches in the literature. We shall apply the  general Fredholm theory developed in  \cite{HWZ2,HWZ3,HWZ3.5} and surveyed in \cite{Hofer} and \cite{H2}. {A comprehensive discussion of the abstract theory will be contained in the upcoming lecture note \cite{HWZ10}}. The theory is designed for the analytical foundations of the SFT in \cite{HWZ5}.

 We recall from \cite{HWZ3.5} that a polyfold $Z$ is a metrizable space equipped with  with an equivalence class of polyfold structures. A polyfold structure $[X,\beta]$ consists of an ep-groupoid $X$ which one could  consider as a generalization of an  \'etale proper Lie groupoid whose object and morphism sets have M-polyfold structures instead of manifold structures, and whose structure maps are sc-smooth maps. Moreover, $\beta:\abs{X}\to Z$ is a homeomorphism between the orbit space of $X$ and the topological space $Z$. The relevant concepts here are recalled in Section \ref{sc-smoothness} below.  

Our strategy to obtain the GW-invariants is as follows. We first construct the ambient space $Z$ 
of stable curves,  from noded  Riemann surfaces to the symplectic manifold,  which are not required to be pseudoholomorphic. The space $Z$ has a natural paracompact {Hausdorff} topology and we construct an equivalence class of natural polyfold structures $[X,\beta]$ on $Z$. The second step constructs a so called strong bundle $p:W\to Z$ which will be equipped with an sc-smooth strong polyfold bundle structure. In the third step we shall show that the Cauchy-Riemann operator $\ov{\partial}_J$ defines an sc-smooth section of the bundle $p$ which is a particular case of SFT. We shall prove that $\ov{\partial}_J$ is an sc-smooth proper Fredholm section of the bundle $p:W\to Z$. The solution sets of the section $\ov{\partial}_J$ are the Gromov compactified moduli spaces which, as usual, are badly behaving sets. However, the three ingredients already established at this point  immediately allows one to apply  the abstract Fredholm perturbation theory from  \cite{HWZ3,HWZ3.5}. {After a  generic perturbation,  the solution sets of the perturbed Fredholm problem become smooth objects, namely compact, weighted, smooth  branched sub-orbifolds. They also have a natural orientation,  so that the branched integration theory from \cite{HWZ7} allows one  to integrate the sc-differential forms over the perturbed solution sets to obtain the GW-invariants in the form of integrals.}


Our main concern in the following is the construction of the polyfold structures which allows one  to deal with noded objects in a smooth way. For this purpose we describe, in particular, the normal forms for families of  noded  Riemann surfaces in the Deligne-Mumford theory used in our constructions.  We also include some related technical results needed for the SFT in \cite{HWZ5}.






\section{The Space Z of Stable Curves}
We start with the construction of the ambient space $Z$ of stable curves. The stable curves are not required to be pseudoholomorphic. We consider maps defined on noded Riemann surfaces $S$ having their images in the closed symplectic manifold $(Q,\omega)$ and possessing various regularity properties.  


We shall denote by 
$$
u:{\mathcal O}(S,x)\rightarrow Q
$$
a germ of a map  defined on (a piece) of Riemann
surface $S$ around $x\in S$. 
\noindent {Throughout  the paper we identify $S^1$ with $\R/\Z$ unless otherwise noted.}
\noindent {Moreover, smooth (in the classical sense) means $C^\infty$-smooth.}

\begin{definition}
Let $m\geq 2$ be an integer and $\delta\geq 0$.  A germ of
a continuous map $u:{\mathcal O}(S,x)\rightarrow Q$ is called of class
$(m,\delta)$ near the point $x$,\index{map of class $(m,\delta)$}  if for a smooth chart
$\psi:U(u(x))\rightarrow {\mathbb R}^{2n}$ mapping $u(x)$ to $0$ and for 
holomorphic polar coordinates $ \sigma:[0,\infty)\times
S^1\rightarrow S\setminus\{x\}$ around $x$, the map
$$
v(s,t)=\psi\circ u\circ \sigma(s,t)
$$
which is defined for $s$ large,  has {weak} partial derivatives up to order
$m$, which weighted by $e^{\delta  s}$ belong to the space 
$L^2([s_0,\infty)\times S^1,{\mathbb R}^{2n})$  for $s_0$  sufficiently
large. We  call the germ  of class $m$ around the  point $z\in S$,  if 
$u$ is of class $H^m_{loc}$ near $z$.
\end{definition}
One easily verifies that if $\sigma$ is a germ of biholomorphic map
mapping $x\in S$ to $y\in S'$ then  $u$ is of class
$(m,\epsilon)$ near $x$ if and only if the same is true for
$u\circ\sigma^{-1}$ near $y$. Moreover, the above
definition does not depend on the choices involved, like charts and
holomorphic polar coordinates.

\begin{definition}
A {\bf noded Riemann surface}  with marked points is a tuple $(S,j,M,D)$\index{noded Riemann surface with marked points} in which 
{$(S,j)$ is  an oriented closed smooth surface $S$ equipped with a smooth almost complex structure $j$. }The subset $M$ of $S$  is  a finite collection of marked points which can be ordered or un-ordered, and $D$ is a finite collection of un-ordered pairs $\{x,y\}$ of points in $S$ so that $x\neq y$ and two pairs which intersect are identical. The union of all sets $\{x,y\}$ belonging to $D$, denoted by $|D|$,  is disjoint from $M$. We call $D$ the set of {\bf nodal pairs}  and $|D|$ the set of  {\bf nodal points.}
\end{definition}
{It is a classical result, proved for example in \cite{SD}, Theorem 3.2, that the pair $(S, j)$ determines a unique compatible Riemann surface  structure in the sense of complex manifolds.}


The Riemann surface $S$ can consist of different connected components $C$ called domain components.  
The noded Riemann surface  $(S,j,M,D)$ is called {\bf connected}  if  the topological space $\ov{S}$,  obtained by identifying  the points $x$ and $y$ in the nodal pairs $\{x,y\}\in D$,  is connected. 
 


So in our terminology  it is possible that the  noded  surface  $(S,j,M,D)$  is  connected, but  the Riemann surface $S$ has  several connected components, namely  its domain components.

The {\bf arithmetic genus}  $g_a$ of a connected noded Riemann surface $(S, j, M, D)$  is the integer $g_a$ defined by 
$$g_a=1+\sharp D+\sum_{C}[ g(C)-1]$$
where $\sharp D$ is the  number of nodal pairs in $D$ and where the sum  is taken over the finitely many domain components $C$ of the Riemann surface $S$, and where $g(C)$ denotes the genus of $C$. The  arithmetic genus $g_a$ agrees  with the genus of the connected {closed}  Riemann surface obtained by taking disks around the nodes in every nodal pair and replacing the two disks by a connecting tube. 
In the following we refer to the elements of $M\cup |D|$ as to  the special points. The set of special points lying on the domain component $C$ is abbreviated by $\Sigma_C:=C\cap (M\cup|D|)$.

Two  connected  noded  Riemann surfaces
$$(S,j,M,D)\quad \text{and}\quad (S',j',M',D')$$
are called isomorphic (or equivalent) if there exists a biholomorphic map 
$$\phi:(S,j)\rightarrow (S',j')$$
(i.e., the diffeomorphism satisfies $T\phi\circ j=j'\circ T\phi$) 
mapping the marked points onto the marked points  and the nodal pairs onto the nodal pairs, hence satisfying $\phi(M)=M'$  and $\phi_\ast(D)=D'$ where 
$$
\phi_\ast(D)=\bigl\{ \{\phi(x),\phi(y)\}\in D' \vert  \,  \{x,y\}\in D \bigr\}.
$$
If the marked points $M$ and $M'$ are ordered it is required that $\phi$ preserves the order. 
If the two noded Riemann surfaces are identical, the isomorphism above is called an automorphism of the noded surface $(S,j,M,D)$. In the following we denote by 
$$[(S, j, M, D)]$$
the equivalence class of all connected noded Riemann  surfaces isomorphic to the {\bf connected noded Riemann  surface}  $(S,j,M,D)$.
\begin{definition} The connected noded Riemann surface $(S,j,M,D)$  is called {\bf stable}  if its automorphism group $G$  is finite \index{stable! connected noded Riemann surface}
\end{definition}
One knows that a connected noded Riemann  surface  $(S,j,M,D)$ is  stable if and only if 
every domain component $C$  of $S$ satisfies 
$$
2\cdot g(C) +\sharp\Sigma_C\geq 3
$$
where $g(C)$ is the genus of $C$. 



Next we describe the tuples $\alpha=(S, j, M, D, u)$ in which $(S, j, M, D)$ is a, not necessarily stable,  noded Riemann surface with ordered marked points, and $u:S\to Q$ a continuous map,  in more detail. 


\begin{definition} [{\bf Stable maps and stable curves}] \index{stable! map} \index{stable! curve}The tuple 
$$\alpha=(S, j, M, D, u)$$ is called  a {\bf stable map} (of class $(m,\delta)$, where  $m\geq 3$ and {$\delta\geq 0$}),
if it has the following properties, 
\begin{itemize}
\item[$\bullet$] The underlying topological space,  obtained by identifying
the two points in every  nodal pair,  is connected. 
\item[$\bullet$] The map $u$ is  of class $(m,\delta)$ around the nodal points in $|D|$ and 
of class $m$ around all other points. (For certain
applications it is useful to require  the map $u$ around the marked points in $M$ to be of class $(m,\delta)$ as well; 
the   minor modifications  are left to the
reader.)
\item[$\bullet$] $u(x)=u(y)$  at  every nodal pair $\{x,y\}\in D$.
\item[$\bullet$]  {$\int_C u^\ast\omega\geq 0$ for every component $C$ of $S$.}
\item[$\bullet$] {\bf Stability condition:}\index{stability condition}\,   if a domain component $C$ of $S$ has genus $g (C)$ and 
$\sharp \Sigma_C$ special points, and satisfies $2\cdot g(C) +\sharp \Sigma_C\leq 2$,  {i.e., $C$ is not stable} , then  
$$\int_C u^\ast\omega >0.$$

\end{itemize}
Two {stable maps}  $\alpha=(S,j,M,D,u)$ and $\alpha'=(S',j',M',D',u')$ are called
equivalent if there exists an isomorphism 
$\phi:(S,j,M,D)\rightarrow (S',j',M',D') $  between  the noded Riemann surfaces  satisfying 
 $$u'\circ\phi=u.$$ 
 Here $\phi$ preserves the ordering of the marked points.
 An equivalence class is called a {\bf stable curve} of class
$(m,\delta)$. Hence a stable curve  is an equivalence class of stable maps and will be  denoted by $[\alpha]$ if $\alpha$ is a representative.
\end{definition}
Next we introduce the space $Z$ which will be equipped with
a polyfold structure.
\begin{definition}
Fix $\delta_0\in (0,2\pi)$. The collection of all equivalence
classes $[\alpha]$ of stable maps  $\alpha$ of class $(3,\delta_0)$ is called the
space of stable curves in $Q$ of class $(3,\delta_0)$ and is denoted
by $Z$ or by $Z^{3,\delta_0}(Q,\omega)$. \index{space of stable curves}
\end{definition}
{We shall equip the set $Z$ with  a natural topology. By  ``natural" we indicate  that the topology is independent
of the choices involved in its construction. The topology is related to the topology on the
Sobolev space of $H^3$-maps on a punctured Riemann surfaces with
exponential decay near the nodes. In Section \ref{natural_topology_Z_section} we shall prove the following theorem.}

\begin{theorem}\label{th-top}
For given $\delta_0\in (0,2\pi)$ the associated space $Z=Z^{3,\delta_0}(Q, \omega)$
of stable curves in $Q$ of class $(3,\delta_0)$ has a natural second countable paracompact Hausdorff topology.
\end{theorem}
We shall
prove that  the topological space $Z$ carries a  natural polyfold structure provided some
other pieces of data are fixed. A polyfold is  quite similar to a possibly
infinite-dimensional orbifold, where however, and this is crucial for applications,
the local models are sc-smooth retracts divided by  finite group actions.
The notion of sc-smoothness is a new notion of smoothness which in infinite dimensions
is much weaker than the notion of Fr\'echet differentiability. Whereas a smooth
retract for the latter is a split submanifold, an sc-smooth retract can be a very
wild set of locally varying dimensions. The polyfold theory,
among other things,  generalizes differential geometry
to spaces which locally look  like sc-smooth retracts or quotients thereof.
The more fancy local models are needed since the spaces have
to incorporate  analytical limiting behaviors,  like bubbling-off and
breaking of trajectories,  which cannot be satisfactorily described
in the classical set-up of manifolds. We refer to \cite{HWZ3.5}
for the definition of a polyfold structure. 
For the convenience of the reader,  the concepts are recalled in Section \ref{sc-smoothness} below.
 
 
In order to describe a preliminary version of our main result we observe that the gluing construction at the nodes requires the conversion of the absolute value $\abs{a}$ of a non-zero complex number $a$ into a real number $R>0$ which is essentially the modulus of the associated cylindrical neck. The conversion is defined by a so called gluing profile $\varphi$ which is a diffeomorphism $\varphi:(0, 1]\to [0, \infty)$.

The main result is the following theorem,  {proved in Section \ref{polyfoldstructure}.} 

\begin{theorem}\label{pfstructure}
Given a strictly increasing sequence $(\delta_m)$, starting at the
previously chosen $\delta_0$ and staying below $2\pi$, and the
gluing profile $\varphi(r)=e^{\frac{1}{r}}-e$,  the space $Z=Z^{3, \delta_0}(Q, \omega)$ of stable curves into $Q$ has {in a
natural way the structure of a polyfold}  for which  the $m$-th level consists of
equivalence classes of stable maps $(S,j,M,D,u)$ in which $u$ is of class
$(m+3,\delta_m)$.
\end{theorem}


We shall formulate  a more precise statement later on after  some more preparations. The constructions will show that there
are natural polyfold charts which depend on the choice of the gluing
profile $\varphi$, which we take as specified above (other choices
would be possible). These charts work for all strictly increasing sequences
$\delta_m$ starting at $\delta_0$ and staying below $2\pi$.
Staying below $2\pi$ is an important requirement in  the Fredholm theory.

Let us also remark that we can define similar spaces using maps of
Sobolev class $W^{m,p}$ provided $W^{m, p}$ is continuously embedded  into
$C^1$. This regularity will be needed for the transversal constraint
construction. We will not pursue this  here and leave the details to the
reader.  One has to keep in mind that dealing with the Banach spaces  $W^{m,p}$, $p\neq 2$, one has to check the  existence of sc-smooth partitions of unity, which are guaranteed in  case  the models are sc-Hilbert spaces.

We point out that $Z$ has many connected components
as well as many interesting open subsets.
If $g,m$ are  nonnegative integers we denote by $Z_{g,m}$ the subset of $Z$
consisting of all equivalence  classes $[S,j,M,D,u]$ in which  the underlying noded Riemann surface $(S,j,M,D)$ has arithmetic genus $g$ and
$m$ marked points. This subset is open in $Z$ and therefore has an
induced polyfold structure. If $A\in H_2(Q,{\mathbb Z})$ is a second homology class, we can also
consider the set $Z_{A,g,m}$ which is the open subset of $Z_{g,m}$  consisting of elements $[S, j, M, D, u]$ in which  the map $u$ represents $A$.



There are  natural maps which play an important role in the 
GW-theory and the SFT.  Consider for a  fixed pair $(g,m)$ of nonnegative integers  satisfying $2g+m\geq 3$ the space $Z_{g,m}$.
  The evaluation map at
the $i$-th marked point is defined by 
$$ 
ev_i:Z_{g,m}\rightarrow Q,\quad [S,j,M,D,u]\mapsto u(x_i)
$$
for $i=1,\ldots, m$. 
Further, if $2g+m\geq 3$, we have the forgetful map associating with the stable curve $[\alpha]$ the underlying stable part of the domain. It is
obtained as follows. We take a representative $(S,j,M,D,u)$ of our
class $[\alpha]$. First we forget the map $u$ and consider, if it exists, a component $C$
satisfying $2g(C)+\sharp (C\cap (M\cup |D|))<3$. Then we have the
following cases. Firstly $C$ is a sphere without marked points and with  one nodal point, say $x$. Then  we remove
the sphere, the nodal point $x$ and its partner $y$, where $\{x,y\}\in D$. Secondly $C$ is a sphere with two nodal points. In this case there are two  nodal pairs $\{x,y\}$ and $\{x',y'\}$, where $x$ and
$x'$ lie on the sphere.  We remove the sphere and the two nodal pairs  but add the nodal
pair $\{y,y'\}$. Thirdly $C$ is a sphere with one node and one
marked point. In that case we  remove the sphere but replace the
corresponding nodal point  on the other component by the marked point.
Continuing this way we end up with a stable noded marked Riemann
surface whose biholomorphic type does not depend on the order we
`weeded out'  the unstable components. This way we obtain the map
$$
\gamma:Z_{g,m}\rightarrow \overline{\mathcal
M}_{g,m},\quad  [S,j,M,D,u]\mapsto  [(S,j,M,D)_{stab}].
$$
 Here $\overline{\mathcal M}_{g,m}$ is the standard Deligne-Mumford
compactification  of the space of (ordered) marked stable Riemann surfaces
with its holomorphic orbifold structure. {The map $\gamma$ is illustrated in  Figure \ref{Fig1}}.



\begin{figure}[!htb]
\psfrag{s}{$\gamma$}
\centering
\includegraphics[width=3.8in]{Fig1.eps}
\caption{The forgetful map $\gamma:Z_{g,m}\to \ov{\calm }_{g,m}$}
\label{Fig1}
\end{figure}


\begin{theorem} \label{evaluation_thm}
 If $2g+m\geq 3$, then 
the maps $ev_i:Z_{g,m}\rightarrow Q$ for $1\leq i\leq m$ and $\gamma:Z_{g,m}\rightarrow
\overline{\mathcal M}_{g,m}$  are sc-smooth.
\end{theorem}

As a consequence we can pull-back differential forms on $Q$ and $
\overline{\mathcal M}_{g,m}$ to obtain sc-differential forms on the polyfold 
$Z_{g,m}$ which,  suitably wedged together,  can be  integrated over
the smooth moduli spaces obtained as solution sets of  transversal Fredholm (multi-)sections
of suitable strong bundles over $Z$. Here one makes use of  the branched integration
theory  developed in \cite{HWZ7}.

\section{The Bundle W}\label{sect1.2}
Next we introduce the  strong polyfold bundle $W$ over $Z$.
We consider the closed symplectic manifold $(Q,\omega)$ and  choose a 
compatible almost complex structure $J$ on $Q$ so that  $\omega\circ (\id \oplus J)$ is a Riemannian metric on $Q$.

The points
of $W$ are defined as follows. We consider tuples 
$$
\wh{\alpha}=(\alpha,\xi)=(S,j,M,D,u,\xi)
$$
in which the stable map 
$\alpha=(S,j,M,D,u)$ is a representative of an element in $Z$.
Moreover, $\xi$ is a continuous section along $u$ such that the map
 $$
 \xi(z):T_zS\rightarrow T_{u(z)}Q,\quad \text{for $z\in
S$},
$$
 is a complex anti-linear map. Its domain of definition  is  equipped with  the complex structure $j$ and
its target space is equipped with the almost complex structure $J$. Moreover, on $S\setminus |D|$, the map
 $z\rightarrow \xi(z)$ is of class $\htl$. At the nodal  points in
 $|D|$ we require that $\xi$ is of class $(2,\delta_0)$. This requires, 
 taking holomorphic polar coordinates $\sigma$ around the  point $x\in |D|$ and
 a chart $\psi$ around $u(x)$ in $Q$,  that  the map
 $$
 (s,t)\mapsto 
 T\psi(u(\sigma(s,t)))\xi(\sigma(s,t))(\partial_s\sigma (s,t)), 
 $$
and  its weak  partial derivatives up to order $2$,  weighted
 by $e^{\delta_0 |s|}$ belong to the space  $L^2([s_0,\infty)\times S^1,{\mathbb
 R}^{2n})$ for $s_0$ large enough. The definition does not depend on the
 choices involved. We call two such tuples
 equivalent if  there exists an isomorphism  
 $$
 \phi:(S,j,M,D)\rightarrow (S',j',M',D')
 $$
satisfying 
$$
\xi'\circ T\phi=\xi\ \ \hbox{and}\ \ u'\circ\phi=u.
$$
The 
equivalence class  of $\wh{\alpha}=(S,j,M,D,u,\xi)$  is denoted  by $[\wh{\alpha}]$. 

The collection of all such equivalence classes constitutes the space  $W$. 


We have defined what it means that an
element $\alpha$ represents an element on level $m$. Let us observe
that if the map $u$ has regularity $(m+3,\delta_m)$ it makes sense to talk
about elements $\xi$ along $u$ of regularity $(k+2,\delta_k)$ for
$0\leq k\leq m+1$. In the case $k=m+1$ the fiber
regularity is $(m+3,\delta_{m+1})$ and the underlying base
regularity is $(m+3,\delta_m)$. The requirement of a faster
exponential decay in the fiber towards a nodal point than the
exponential decay of the underlying base curve is well-defined and
independent of the charts chosen to define it. Our conventions for defining the levels are governed by the overall
convention that sections should be horizontal in the sense that they
preserve the level structure, i.e.,  an element on level $m$ is mapped
by the section $\xi$ to an element on bi-level $(m,m)$. Hence if the
section comes from a first order differential operator we need
precisely the  convention  we have just introduced.  {We  call   an element} 
$$
\wh{\alpha}=(S,j,M,D,u,\xi)
$$
of  (bi)-regularity $((m+3,\delta_m),(k+2,\delta_k))$ as long as $k$
satisfies the above restriction $0\leq k\leq m+1$. We say that $[\wh{\alpha}]\in
W$ is on level $(m,k)$ provided $(u,\xi)$ has the above regularity.
We keep in mind that  bi-levels $(m,k)$ are defined under the restriction $0\leq k\leq m+1$.
\begin{theorem}
The set $W$ has a natural second countable paracompact {Hausdorff} topology so
that the projection map
$$
p:W\rightarrow Z, \quad [\wh{\alpha}]\mapsto [\alpha], 
$$
(forgetting the $\xi$-part),  is continuous.
\end{theorem}

Our  main result concerning the polyfold set-up is the following theorem{, proved in Section \ref{polstrbundle}.}

\begin{theorem}\label{main1.10}
Let $Z=Z^{3,\delta_0}(Q, \omega)$ be the previously introduced space  of stable curves with its polyfold
structure associated with  the increasing sequence $(\delta_m)\subset
(0,2\pi)$ and the exponential gluing profile $\varphi$. Then the bundle $p:W\rightarrow Z$ has in a natural way the
structure of a strong polyfold bundle in which the $(m,k)$-bi-level
(for $0\leq k\leq m+1$) consists of elements of base regularity $(m+3,\delta_m)$ and of  fiber
regularity $(k+2,\delta_k)$.
\end{theorem}
We refer the reader to \cite{HWZ3.5}, \cite{H2}, and \cite{HWZ7} for the background material on
polyfold theory.  For the reader's convenience we shall also review  the main concepts during the proofs.

\section{Fredholm Theory}
For a compatible smooth almost complex
structure $J$ on $(Q,\omega)$ we define  the Cauchy-Riemann section $\ov{\partial}_J$
of the strong polyfold bundle $p:W\rightarrow Z$ by
$$
\ov{\partial}_J([S,j,M,D,u])=[S,j,M,D,u,\ov{\partial}_{J,j}(u)]
$$
where
$$
\ov{\partial}_{J,j}(u) =\frac{1}{2}\bigl[ Tu+J(u)\circ Tu\circ j\bigr].
$$
We  call a Fredholm section of a strong polyfold bundle
component-proper provided the restriction to every connected
component of the domain is proper.
\begin{theorem}\label{maincauchy-riemann}
The  Cauchy-Riemann section $\ov{\partial}_{J}$ of the strong polyfold bundle  $p:W\rightarrow
Z$ is an sc-smooth component-proper Fredholm section, which is naturally oriented. On the component 
$Z_{A, g, m}$ of the polyfold $Z$ the Fredholm index of  $\ov{\partial}_{J}$ is equal to 
$$\text{Ind}\ (\ov{\partial}_{J})=2c_1(A)+(2n-6)(1-g)+2m,$$
with $2n=\text{dim}\ Q$, where $g$ is the arithmetic genus of the noded Riemann surfaces, and $m$ the number of marked points and $A\in H_2(Q).$
\end{theorem}
{Theorem \ref{maincauchy-riemann} is restated and proved up to the orientability as 
Theorem \ref{FREDPROP} in Section \ref{c-r-results}. 
 The orientation problem is explained in the Appendices \ref{orientations-abstract} and \ref{orientations}}. It is a special  case of the more elaborate
orientation problems  in SFT, which will be studied in  \cite{HWZ5}. 



\section{The GW-invariants}
At this point, in view of Theorem \ref{pfstructure}, Theorem \ref{main1.10} and 
Theorem \ref{maincauchy-riemann},  we are in the position to apply the general   functional analytic Fredholm theory developed in
\cite{HWZ2,HWZ3,HWZ3.5}.   The theory provides, in particular, an abstract perturbation theory to achieve transversality of the Fredholm section. In general, however, transversality can only be  achieved by means of multivalued perturbations.



As a side remark we observe that on components of the polyfold  $Z$,  on which   the solutions are somewhere injective, the more classical theory is still applicable and the transversality of the Fredholm section can be achieved 
by choosing a suitable  almost complex structure  $J$ on the symplectic manifold $(Q,\omega)$. So,  the classical theory of the pseudoholomorphic curve equation is part of our  general
constructions, see \cite{MS2}.

 In general, following the recipe of the abstract perturbation theory in \cite{HWZ3.5}, one {chooses}  a generic 
 $\text{sc}^+$-multisection of the polyfold bundle $W\to Z$ such that the components of the solution spaces of the perturbed section are  oriented, compact, weighted, branched suborbifolds of the polyfold $Z$ of even 
dimension. Depending on the components $Z_{A,g,m}$, the solution spaces can also  be
smooth oriented manifolds or orbifolds. The  solution spaces of 
different perturbations are connected by oriented cobordisms in the same category.

To be precise we consider the  polyfold $Z$ of Theorem \ref{pfstructure}, the strong polyfold bundle $p:W\to Z$
of Theorem \ref{main1.10} and the sc-smooth component-proper Fredholm section $\ov{\partial}_J$ of Theorem 
\ref{maincauchy-riemann}. Given the homology class $A\in H_2(Q, Z)$  of the closed symplectic manifold $(Q,\omega)$ and two integers $g,m\geq 0$,
with $2g+m\geq 3$, we focus on the polyfold $Z_{A, g,m}\subset Z$ of equivalence classes 
$[(S, j, M, D, u)]$ in which the noded Riemann surface $S$ has arithmetic  genus $g$ and is equipped with $m$ marked points; the map $u$ represents the homology class $A$ of $Q$. The sc-smooth evaluation maps $ev_i:Z_{A, g,m}\to Q$ and $\gamma\colon Z_{A,g,m}\to \ov{\mathcal M}_{g,k}$ of Theorem \ref{evaluation_thm} allow to pull back the differential forms on $Q$ and $\ov{\mathcal M}_{g,m}$ to sc-differential forms on the polyfold  $Z_{A,g,m}$.
The solution set $S( \ov{\partial}_J)\subset Z_{A,g,m}$ of the Fredholm section $\ov{\partial}_J$ of the strong polyfold bundle $p:W\to Z$ is the set 
$$S(\ov{\partial}_J)=\{ z\in Z_{A, g,m}\vert \,  \ov{\partial}_J (z)=0 \}$$
where $0$ is the zero section of the bundle $p$. We point out that the fibers of a strong polyfold bundle do not {possess  a linear structure. However,  the bundle possesses a preferred section $0$. }


In view of the perturbation theory in \cite{HWZ3.5} there exists a small generic $\ssc^+$-multisection $\lambda$ of the  bundle $p$ in the sense of Definition 3.41 in \cite{HWZ3.5} so that the pair $(\ov{\partial}_J,\lambda)$  {possesses the properties listed in  Definition 4.7 in \cite{HWZ3.5}}.  We define the solution set of the pair 
$(\ov{\partial}_J,\lambda)$ as the subset
$$S(\ov {\partial}_J, \lambda )=\{z\in Z_{A, g,m}\vert \, \lambda (\ov{\partial}_J(z) )>0\}$$
and the weight function $\vartheta: Z_{A, g,m}\to \Q^+$ by 
$$\vartheta (z)=\lambda (\ov {\partial}_J(z))\in \Q^+.$$ 
{Here $\Q^+$ stands for the set of non-negative rational numbers}. 
By the Theorems 4.13 and 4.14 in \cite{HWZ3.5}, the pair $(S(\ov {\partial}_J, \lambda ),\vartheta)$ is a compact, branched and oriented suborbifold of the polyfold $Z_{A,g,m}$ in the sense of Definition 3.22 in \cite{HWZ3.5}. Its dimension is equal to $\text{Ind}\ (\ov{\partial}_J)$. Therefore, we can apply the branched integration theory of \cite{HWZ7} and conclude from Theorem 4.23 in \cite {HWZ3.5} immediately the following result. 

\begin{theorem}\label{GW-thm}
Let $(Q,\omega)$ be a closed symplectic manifold of dimension $2n$. For a
given  homology class $A\in H_2(Q)$ and for given  integers  $g,m\geq 0$ satisfying  $2g+m\geq 3$,  
there exists  a multi-linear map
$$
\Psi^Q_{A,g,m}: H^\ast(Q;{\mathbb R})^{\otimes m}\rightarrow
H^\ast(\overline{\mathcal M}_{g,m};{\mathbb R})
$$
which,  on $H^*(Q; \R)^{\otimes m}$,   is super-symmetric with respect to the grading by even and odd forms. This map
is uniquely characterized by the following formula. For a given compatible almost complex structure $J$ on $Q$  and a given
small generic perturbation by an $\ssc^+$-multisection $\lambda$,  we have the representation 
\begin{eqnarray*}
&\langle\Psi^Q_{A,g,m}([\alpha_1]\otimes\ldots \otimes[\alpha_m]),[\tau]\rangle&\\
&=\int_{(S(\ov{\partial}_J, \lambda) ,\vartheta)}\gamma^\ast (PD(\tau ))\wedge \text{ev}_1^\ast(\alpha_1)\wedge\ldots \wedge
\mbox{ev}_k^\ast(\alpha_m)&
\end{eqnarray*}
in which  $\alpha_1,\ldots, \alpha_m\in H^*(Q)$,  $\tau \in H_*(\ov{\calm}_{g,m})$, $PD$ denotes the Poincar\'{e} dual, and $\gamma:Z_{g,m}\to \ov{\mathcal M}_{g,m}$ is the map in 
Theorem \ref{evaluation_thm}
\end{theorem}
The integration theory used is the ``branched integration'' from  \cite{HWZ7}. The integral over the empty set  is defined to be zero.

The a priori real number $\langle\Psi^Q_{A,g,m}([\alpha_1]\otimes\ldots \otimes[\alpha_m]),[\tau]\rangle$ is called a  {\bf Gromov-Witten invariant}. \index{GW--invariant} It is zero if  the Fredholm index does not  agree with the degree of the differential form being integrated. It follows from the construction that the Gromov-Witten invariants are invariants of the symplectic deformation type of the manifold $Q$. Indeed, a deformation produces  an arc of Cauchy-Riemann sections. These  are component-proper since the almost complex structures
occurring are tamed. {With additional efforts one can show that the GW-invariants  are rational numbers  if the (co)homology classes  are integer and the above integral has an interpretation as a rational count of solutions of some intersection problems. 
}\\

\noindent{\bf Acknowledgement} We thank the referee for useful comments.
We thank Urs Fuchs for pointing out a bug in the topology part,
which required a stronger analytical argument comparing two uniformizers.
The first author also would like to thank Nate Bottman and Jiayong Li and the more than 
30 participants of the MIT RTG-sponsored polyfold workshop at Pajaro Dunes 
at which the ideas of polyfold theory as well as this paper was discussed in detail.
This event took place, while the authors  were preparing the final version implementing the suggestions
of the referee,  and the questions and discussion with participants helped to improve
several parts of the presentation. We thank Stefan Suhr and Kai Zehmisch for their comments.
Finally we would like to thank Joel Fish and Katrin Wehrheim
for their interest in this project and their valuable  feedbacks.


Kris Wysocki and Eduard Zehnder would like  thank the  Institute for Advanced Study (IAS) in Princeton and the ForschungsInstitut f\"ur Mathematik (FIM) in Zurich for their hospitality.

\endinput


\chapter{Recollections and Technical Results}\label{chapter_2_technical results}
A basic ingredient in the construction of the polyfold structure on the space of stable curves is the Deligne-Mumford theory. There is, however, a twist.  In the plumbing constructions of Riemann surfaces we have to apply  a recipe which is quite different from the one used in the DM-theory. The deeper reasons lie in  the analysis of function spaces. The DM-theory, as needed here, has been developed in detail in \cite{HWZ-DM}.  The other ingredients are  nonlinear analysis facts related to  our sc-version of nonlinear analysis. The results needed here have been proved in \cite{HWZ8.7}.
We start by recalling  the results used  in
the polyfold construction later on.

\section{Deligne--Mumford type Spaces}\label{dm-subsect}
In this section we present a Lie groupoid version of the
classical Deligne-Mumford theory.

The gluing construction at the nodes requires a conversion of the absolute value $|a|$ of a non-zero complex number $a$, the gluing parameter,  into a positive real number $R>0$,
which is essentially the modulus of the associated cylindrical neck. {For this purpose we introduce the notion of a gluing profile.
\begin{definition}\label{gluing_profile}
A {\bf gluing profile} is a smooth diffeomorphism 
$$\varphi:(0,1]\to [0, \infty ).
$$
\end{definition}
}

The conversion $|a|\mapsto R$ in the classical Deligne-Mumford case is defined  by the logarithmic gluing profile
\index{gluing profile!logarithmic }
$$
(0,1]\rightarrow [0,\infty), \quad r\mapsto  \varphi(r):=-\frac{1}{2\pi}\ln(r).
$$

In our study of stable curves we  need, in view of the  functional analytic requirements,  other gluing profiles. A very useful one is the exponential gluing profile
\index{gluing profile!exponential}
 $$
(0,1]\rightarrow [0,\infty),\quad  r\mapsto \varphi(r):=e^{\frac{1}{r}}-e.
$$
As it turns out, only in the case of the logarithmic
gluing profile, the Deligne-Mumford space of stable
noded and marked Riemann surfaces has a holomorphic
 orbifold structure. In the case of the exponential
 gluing profile we merely obtain a smooth naturally
 oriented orbifold structure.

We begin with the classical case.
We denote by ${\overline{\mathcal N}}$ the space of biholomorphic
equivalence classes of connected, stable, noded Riemann surfaces
with un-ordered marked points. More precisely
we consider equivalence classes $[\alpha]$ of
nodal Riemann surfaces 
$$\alpha=(S,j,M,D)$$
 in which $(S,j)$ is
a closed Riemann surface (which can  consist
of different connected components), $M$ is a finite subset of $S$ of  marked points
 which we assume to be ordered, un-ordered or partially ordered,
 depending on the situation.
 Isomorphisms between such Riemann
 surfaces have to preserve the marked points,
 and when they are ordered even their ordering.
 For the first part of the discussion we assume $M$ to be un-ordered. The set $D$ consists of  finitely many un-ordered pairs  $\{x,y\}$ of distinct points $x$ and $y$ in $S$ and we  
 require that  two such  pairs are either identical or disjoint, i.e.,  if $\{x,y\}\cap\{x',y'\}\neq \emptyset$,  then $\{x,y\}=\{x',y'\}$.  We call $D$  the set of nodal pairs and  write $|D|\subset S$ for the union of all sets $\{x,y\}$, 
 $$
 |D|=\bigcup_{\{x,y\}\in D} \{x,y\}. 
 $$
The sets $M$ and $|D|$ are  required to be disjoint.  
 We recall that  the nodal Riemann surface  $\alpha$ is said to be connected if the topological space,  obtained by identifying the two points of every  nodal pair is  a connected topological space. We call $\alpha$ stable if  every connected component $C$ of  the Riemann surface $S$  having genus $g(C)$ satisfies
$$
2\cdot g(C)+\sharp (C\cap(M\cup|D|))\geq 3,
$$
where $\sharp(\cdot)$ denotes the cardinality of a set. Two such tuples $\alpha$ and $\alpha'$  are called isomorphic  (or equivalent) provided there exists a biholomorphic map $\phi:(S,j)\rightarrow (S',j')$ satisfying $\phi(M)=M'$ and $\phi_{\ast}(D)=D'$, where $\phi_{\ast}(D)=\{\{\phi(x),\phi(y)\} | \ \{x,y\}\in D\}$. The group $G$ of the automorphisms of the  noded Riemann  surface $(S, j, M, D)$ is finite if and only if $\alpha$ is stable. 
The set $\overline{\mathcal N}$ consists of all equivalence classes of connected, stable, noded Riemann surfaces
with un-ordered marked points. This set has interesting subsets. If $g$ and $m$ are non-negative integers satisfying $2g+m\geq 3$,  we denote by $\overline{\mathcal N}_{g,m}$ the subset consisting of all equivalence classes $[\alpha]$ for which the representative  $\alpha$ has arithmetic genus $g$ and $m$ marked points.
\begin{theorem}
The space $\overline{\mathcal N}$ has a natural second countable
paracompact Hausdorff topology for which every connected component is compact.
Moreover,  if $2g+m\geq 3$, then  the subset $\overline{\mathcal N}_{g,m}$ is a compact subset which also is a connected component.
\end{theorem}
A proof of this classical result can be found in \cite{Hu}.
We shall call the underlying topology the DM-topology.  We shall next  describe a basis for this topology. 

We fix {one of the above}  gluing profiles  $\varphi$ and let  the noded Riemann surface $\alpha=(S,j,M,D)$ represent the equivalence  class $[\alpha]\in \overline{\mathcal N}$. 
{Then we take a small disk structure associated with $\alpha$ and defined as follows. 
\begin{definition}[{\bf Small disk structure}]\label{small_disk_structure}
A {\bf small disk structure}  associated with the stable noded Riemann surface $\alpha=(S, j, M, D)$, denoted by ${\bf D}$, assigns to every nodal point $x\in \abs{D}$ a disk like neighborhood $D_x\subset S$ centered at $x$ and having a smooth boundary. The disks are mutually disjoint and disjoint from the set $M$ of marked points (unless otherwise specified). Moreover, the disks are equipped with a choice of holomorphic polar coordinates as introduced below. 
In addition, the union 
$$
|{\bf D}|:= \bigcup_{x\in |D|} D_x.
$$
of the disks is invariant under the  group action of  the automorphism group $G$ of $\alpha$.\index{small disk structure}
\end{definition}
} 

 {There always exists  a small disk structure in any open neighborhood of the nodal points  as proved in   \cite{HWZ-DM}. } 

With every nodal pair $\{x, y\}\in D$ we associate a gluing parameter $a_{\{x, y\}}\in \C$\index{gluing! parameter}  which is a complex number varying in  the closed unit disk. By  $a=\{a_{\{x,y\}}\}_{\{x, y\}\in D}$ we denote the collection of all gluing parameters. Given a fixed  $a=\{a_{\{x,y\}}\}$, we denote by 
$D_a$ the  set of all pairs $\{x,y\}$ for which $a_{\{x,y\}}=0$.

We first consider a nodal pair $\{x, y\}\in D\setminus D_a$ for which, by definition, $a_{\{x, y\}}\neq 0$. In this case we shall connect the boundaries of the associated disks $D_x$ and $D_y$ by a finite cylinder 
$$Z^{\{x, y\}}_{a_{\{x, y\}}}$$
defined as follows. Near $x$ we choose the positive holomorphic polar coordinates\index{positive holomorphic polar coordinates}
$$h_x:[0,\infty)\times S^1\rightarrow D_x\setminus\{x\},\qquad 
h_x(s, t)=\ov{h}_x(e^{-2\pi (s+it)}),$$
and near $y$ we choose the 
negative holomorphic polar coordinates \index{negative  holomorphic polar coordinates}
$$h_y:(-\infty, 0]\times S^1\rightarrow D_y\setminus\{y\},\qquad 
h_y(s, t)=\ov{h}_y(e^{2\pi (s+it)})$$
where
\begin{align*}
&\ov{h}_x:\{w\in \C\vert \, \abs{w}\leq  1\}\to D_x\\
&\ov{h}_y:\{w\in \C\vert \, \abs{w}\leq  1\}\to D_y
\end{align*}
are biholomorphic mappings $(T\ov{h}_x\circ i=j\circ T\ov{h}_x$ and similarly for $\ov{h}_y$) satisfying 
$$\ov{h}_x(0)=x\quad \text{and}\quad \ov{h}_y(0)=y.$$
We remove the  points $z\in D_x$
which are  of the form $z=h_x(s,t)$ for $s>\varphi(|a_{\{x,y\}}|)$  and the points $z'\in D_y$ of the form  $z'=h_y(s',t')$ for  $s'<-\varphi(|a_{\{x,y\}}|)$. Now we identify the remaining annuli as follows. The points 
$$z=h_x(s,t)\quad \text{and}\quad z'=h_y(s',t')$$
are equivalent if 
$$s=s'+\varphi (\abs{a_{\{x,y\}}})\quad \text{and}\quad t=t'+\vartheta    \pmod 1$$
where the polar form of $a_{\{x,y\}}\in \C$ is given by 
$$a_{\{x,y\}}=|a_{\{x,y\}}|e^{-2\pi i\vartheta}.$$
We shall denote the equivalence classes by $[h_x(s, t)]$ or simply $[s,t]$. The equivalence classes define the glued finite cylinder $Z_{a_{\{x, y\}}}^{\{x, y\}}$ connecting $\partial D_x$ with $\partial D_y$. It possesses two  distinguished  global coordinate  systems, namely the positive coordinates
$$\{ (s, t)\vert\, 0\leq s\leq \varphi \bigl(\abs{a_{\{x, y\}}}\bigr) \}$$
and  the negative coordinates
$$\{ (s', t')\vert\,  -\varphi \bigl(\abs{a_{\{x, y\}}}\bigr) \leq s'\leq 0\}. $$
{The gluing construction near a nodal pair $\{x, y\}$ for which $a_{\{x, y\}}\neq 0$ is illustrated in Figure \ref{Fig2}.}

We next consider a nodal pair $\{x, y\}\in D_a$ which satisfies $a_{\{x, y\}}=0$. In this case we do not change the associated disks %
and define 
$$Z^{\{x, y\}}_0=D_x\cup D_y.$$

\begin{figure}[h!]
\psfrag {r}{\small{$R$}}
\psfrag {mr}{\small{$-R$}}
\psfrag {0}{\small{$0$}}
\psfrag {a0}{\small{$0$}}
\psfrag {rp}{\small{${\mathbb R}^+\times S^1$}}
\psfrag  {xy}{\small{$\{x,y\}$}}
\psfrag {hx}{\small{$h_x$}}
\psfrag {rp}{\small{${\mathbb R}^+\times S^1$}}
\psfrag  {rm}{\small{${\mathbb R}^-\times S^1$}}
\psfrag{Z}{\small{$Z_{a_{\{x,y\}}}^{\{x,y\}}$}}
\centering
\includegraphics[width=3.6in]{Fig2.eps}
\caption{Gluing}
\label{Fig2}
\end{figure}

We carry out the above gluing construction at every nodal pair $\{x, y\}\in D$ and obtain this way the new glued Riemann surface  $S_a$.  Because we did not change the complement of the disks $(D_x)$ we can identify the marked points $M$ on $S$ with points on $S_a$, denoted by $M_a$. {An almost}  complex structure $k$ on $S$ coinciding with $j$ on the set $\abs{{\bf D}}$ induces the { almost } complex structure $k_a$ on the glued surface $S_a$.

\begin{figure}[ht]
\psfrag {a}{$(S, k, M, D)$}
\psfrag {b}{$(S_a, k_a, M_a, D_a)$}
\psfrag {a1}{\small{$a_{\{x,y\}}=0$}}
\psfrag  {a2}{\small{$a_{\{x',y'\}}=0$}}
\psfrag {b1}{\small{$a_{\{x,y\}}\neq 0$}}
\psfrag  {b2}{\small{$a_{\{x',y'\}}=0$}}
\centering
\includegraphics[width=4.2in]{Fig3.eps}
\caption{Gluing}
\label{Fig3}
\end{figure}


Summarizing, given the stable noded Riemann surface $\alpha=(S, k, M, D)$,
 {any of the above two gluing profiles $\varphi$}, and  given the small disk structure $(D_x)_{x\in \abs{D}}$ and the gluing parameters $a$, the above gluing construction defines the new stable noded  Riemann  surface $\alpha_a$ defined by
$$\alpha_a=(S_a,k_a,M_a,D_a),$$
{and illustrated in Figure \ref{Fig3}.}
Starting from the noded Riemann surface $\alpha=(S,j,M,D)$, having fixed the disks $\{D_x\}_{x\in \abs{D}}$ of the small disk structure, we let $U$ be an open 
$C^\infty$-neighbor\-hood of $j$ consisting of complex structures on $S$ giving the same orientation. For every $\varepsilon\in (0,\frac{1}{2})$ we define the subset  $V(\alpha,U,{\bf D},\varepsilon)$ of $\ov{\mathcal N}$ by
$$
V(\alpha,U,{\bf D},\varepsilon)
=\{[S_a,k_a,M_a,D_a]\ |\ |a|<\varepsilon,\ k\in U,\ k=j\ \hbox{on}\ |{\bf D}|\}.
$$
\begin{proposition}
The collection of all sets $V(\alpha,U,{\bf D},\varepsilon)$\index{basis for DM-topology}
constitutes  a basis for the natural DM-topology on $\ov{\mathcal N}$. The topology does not depend on the choice of the gluing profile.
\end{proposition}
We refer to \cite{HWZ-DM} for a proof. In view of  the above construction we shall say that the noded Riemann surface $S_a$ is obtained from $S$  by plumbing or by gluing.

The classical Deligne-Mumford result in  \cite{DM} equips the topological space $\overline{\mathcal N}$ with a holomorphic orbifold structure. This is also proved from a more differential geometric perspective in \cite{RS}. Assume that $(S,j,M,D)$ represents
an element in $\overline{\mathcal N}$ and denote by $G$ its finite
automorphism group. By $\Gamma_0(\alpha)$ we denote  the vector space of
smooth sections of $TS\rightarrow S$ which vanish at the special points in
$|D|\cup M$. Moreover, we denote by $\Omega^{0,1}(\alpha)$ the space of
sections of $\hbox{Hom}_{\mathbb R}(TS,TS)\rightarrow S$ which are
complex antilinear. There is an associated linear Cauchy-Riemann\index{linear Cauchy-Riemann operator $\ov{\partial}$}
operator
$$
\bar{\partial}:\Gamma_0(\alpha)\rightarrow \Omega^{0,1}(\alpha)
$$
which, in holomorphic coordinates, is represented by
$$\ov{\partial }f(z)=\frac{\partial f}{\partial \ov{z}}(z)d\ov{z}=\frac{1}{2}\bigl(\partial_xf+i\partial_y f\bigr)(z)(dx-idy).$$
 {First order elliptic theory shows that $\ov{\partial}$  is a Fredholm operator. Its index can be computed with the help from the Riemann-Roch theorem and we refer to \cite{MS2}. The analysis can be based on  H\"{o}lder  or Sobolev spaces. Since the precise analytical set-ups are standard,  we will allow ourselves to be somewhat imprecise in our notation. We work, in particular, most of the time in the smooth category.  With smooth we mean $C^\infty$ smooth. However, everything can be made precise by taking the appropriate functional-analytic set-up.}
 
Due to the stability condition, the operator $\bar{\partial}$ is
injective. More precisely, as a consequence of the Riemann-Roch theorem the following holds. 
\begin{proposition}
Let $\alpha=(S, j, M, D)$ be a stable and connected nodal Riemann surface. Then the operator
$\bar{\partial}:\Gamma_0(\alpha)\rightarrow \Omega^{0,1}(\alpha)$ is
a complex linear injective Fredholm operator whose  index is equal to 
$$
\ind (\ov{\partial})=-(3g_a+\sharp M-\sharp D-3).\index{Fredholm index of $\ov{\partial}$}
$$
\end{proposition}
We define the linear quotient space  $H^1(\alpha)$ by
$$
H^1(\alpha)= \Omega^{0,1}(\alpha)/\text{im}(\ov{\partial}).
$$
As the notation already indicates it can be viewed as a cohomology
group. This space has complex dimension $3g_a+\sharp M-\sharp D-3$.
Here $\sharp D$ is the number of nodal pairs which is half the
number $\sharp |D|$ of nodal points.

The automorphism group $G$ {whose elements we also denote by $g\in G$}, acts on $H^1(\alpha)$ \index{$G$-action on $H^1(\alpha)$}in a natural way
via
$$
G\times H^1(\alpha)\rightarrow
H^1(\alpha),\quad (g, r)\mapsto  g\ast[r]:=[(Tg)r(Tg)^{-1}].
$$
We call it the natural representation of $G$. If $E$ is a complex vector space, then a representation of $G$ on $E$ is called natural
if  it is  equivalent to the natural representation of $G$. Given a smooth family
$v\mapsto  j(v)$ of complex structures on $S$ we can consider the
family
$$
v\mapsto  \alpha_v=(S,j(v),M,D)
$$
of nodal Riemann surfaces. 
If $j(0)=j$, the family is called a deformation of $\alpha$. \index{deformation of $\alpha$} Assume that $v$
belongs to an open neighborhood of $0$ of some finite-dimensional
complex vector space $E$. The differential $\delta
v\mapsto  Dj(v)\delta v$ induces a linear map
$$
E\rightarrow H^1(\alpha_v),\quad \delta v\mapsto [Dj(v)\delta v].
$$
This linear map,  denoted by $[Dj(v)]:E\rightarrow H^1(\alpha_v)$,  is
called the Kodaira differential. \index{Kodaira differential}The following definitions are very useful.

\begin{definition}\label{def_complex_effective_symmetric}
Let $\alpha=(S,j,M,D)$ be a stable nodal Riemann surface and let $E$ be a complex vector
space  carrying a natural representation of the automorphism group $G$ of $\alpha$.
Let $v\mapsto  j(v)$ be a smooth deformation of $j$ parameterized
by $v$ belonging to an open neighborhood $V$ of $0\in E$. Then the family
$v\mapsto  j(v)$ is called
\begin{itemize}
\item[$\bullet$] complex if $[Dj(v)]$ is complex linear for all $v\in V$.\index{deformation of $\alpha$! complex}\index{complex deformation}
\item[$\bullet$] effective if $[Dj(v)]$ is a real linear isomorphism at
every point $v\in V$. \index{deformation of $\alpha$! effective} \index{effective deformation}
\item[$\bullet$]  symmetric if $V$ is invariant under the $G$-action on $E$
and for every $g\in G$,  the diffeomorphism $g:S\rightarrow S$ is a
biholomorphic map
$$
g:\alpha_v\rightarrow \alpha_{g\ast v}.\index{deformation of $\alpha$! symmetric}\index{symmetric deformation}
$$
\end{itemize}
\end{definition}
{In the symmetric case we have
$$
[Dj(g\ast v)(g\ast\delta v)] =  [(Tg)(Dj(v)\delta v)(Tg)^{-1}].
$$
}
A {\bf good deformation} of $j$\index{good deformation} consists of a complex vector
space $E$ with a  natural representation of $G$, a $G$-invariant
open neighborhood $V$ of $0$ and a smooth family $v\mapsto  j(v)$
of complex structures on $S$ satisfying $j(0)=j$,  which  is
 effective and symmetric and such that,  in addition,  there exists an
open neighborhood $U$ of $|D|\cup M$ on which  $j(v)=j$ for all $v\in
V$. {A good deformation $v\mapsto j(v)$ is called a {\bf good complex deformation}  if the family is, in addition, a  complex family in the sense of the above Definition \ref{def_complex_effective_symmetric}.}



There always exists a good complex deformation according to the next proposition proved in 
 \cite{HWZ-DM}.
\begin{proposition}
{For every stable noded Riemann surface $\alpha=(S, j, M, D)$ there exists a good complex deformation $v\mapsto j(v)$ of $j$. 
In fact we can arrange with $j=j(0)$ that $Dj(v)(j\delta v)= j(v)\circ (Dj(v)\delta v)$ for all $v\in V$  and $\delta v\in E$.}
\end{proposition}

We have already introduced the notion of a
small disk structure. In our gluing construction later on it is convenient to deal with good families which are constant near the nodes. They are  guaranteed by the following result from  \cite{HWZ-DM}.
\begin{proposition}\label{prop2.6-n}
 Let  $\alpha=(S, j, M, D)$ be  a noded Riemann surface
and $v\mapsto  j(v)$ a good deformation of $j$ satisfying $j(v)=j$ on an open neighborhood
$U$ of $|D|$. Then there exists a small disk structure ${\bf D}$ so
that $|{\bf D}|$ is contained in $U$.
\end{proposition}

We now fix a stable noded Riemann surface $\alpha=(S, j, M, D)$ having the good deformation $v\mapsto j(v)$ parametrized by $v\in V\subset E$ and the small disk structure ${\bf D}$ satisfying Proposition \ref{prop2.6-n}.


For every nodal point $x$ we  fix
a biholomorphic map $\ov{h}_x:(D^1,0)\rightarrow (D_x,x)$ where 
$D^1=\{w\in \C\vert \, \abs{w}\leq 1\}$.  Such a
choice is unique up to rotation. For every nodal pair $\{x,y\}\in D$ there exists a uniquely determined complex anti-linear map
$\varphi_{x,y}:T_yS\rightarrow T_xS$ such that if $\varphi_{y,x}$
is its inverse,  the map  
$$
T\ov{h}_y(0)^{-1}\circ\varphi_{y,x}\circ T\ov{h}_x(0):{\mathbb
C}\rightarrow {\mathbb C}
$$
is the complex conjugation $z\rightarrow \overline{z}$. If  $\{x,y\}\in
D$ is a nodal pair, then for an automorphism $g\in G$ of $\alpha$,  the composition
$$
\varphi_{x,y}\circ Tg(y)^{-1}\circ\varphi_{g(y),g(x)}\circ
Tg(x):T_xS\rightarrow T_xS
$$
is  a multiplication by an element in the unit circle as proved in  \cite{HWZ-DM}.  {Geometrically, given a nodal pair $\{x, y\}$ and an automorphism $g\in G$, then $\sigma_{\{x,y\}}(g)$ is the relative twist of the gluing parameter induced from the action of $g$.}  One easily verifies that this  element in
$S^1$ is the same if we exchange in the previous expression the order
of $x$ and $y$. Let
us denote this element in $S^1$ by $\sigma_{\{x,y\}}(g)$. 
One also verifies immediately that
$$
\sigma_{\{x,y\}}(hg)=\sigma_{\{g(x),g(y)\}}(h)\cdot\sigma_{\{x,y\}}(g).
$$

Now we are
in the position to extend the natural $G$-action on $E$ as
follows. Let $N$ be the finite-dimensional complex vector space of maps
$D\rightarrow {\mathbb C}$ which associate to the nodal pair $\{x,y\}$
a complex number $a_{\{x,y\}}$. We  define the extended $G$-action
$$
\sigma:G\rightarrow GL(N)\times GL(E)
$$
by
$$
g\ast (a, e)=\sigma(g)(a,e)=(\sigma_N(g)a,g\ast e),
$$
where $\sigma_N(g)a=b$ is defined by
$$
b_{\{g(x),g(y)\}} = \sigma_{\{x,y\}}(g)\cdot a_{\{x,y\}}.\index{extended $G$-action}
$$
From the properties of $\sigma_{\{x,y\}}(g)$ one sees that the
latter defines indeed a representation of $G$ on $N\times E$. The element $a_{\{x,y\}}$ will
occur as a gluing parameter at the nodal pair $\{x,y\}$. With the data
 so far fixed,  we choose for every nodal pair $\{x,y\}$ an ordered pair,
say $(x,y)$, and take  for $x$ and $y$ the holomorphic polar coordinates
$$
h_x:[0,\infty)\times S^1\rightarrow D_x,\quad 
h_x(s,t)=\ov{h}_x(e^{-2\pi(s+it)})
$$
and
$$
h_y:(-\infty,0]\times S^1\rightarrow
D_y,\quad h_y(s',t')=\ov{h}_y(e^{2\pi(s'+it')})
$$
as introduced in Section \ref{dm-subsect}. We have chosen positive holomorphic polar coordinates around
$x$ and negative ones around $y$. In the following $(s,t)$ will
always denote positive polar coordinates and $(s',t')$ negative
ones. In order to carry out the gluing we need a gluing profile.
As already pointed out,  there will be two gluing profiles of interest for us. The
logarithmic gluing profile occurring in the classical holomorphic
Deligne-Mumford theory is defined by $\varphi(r)=-\frac{1}{2\pi}\ln(r)$
and the exponential gluing profile which will be used in  our
constructions is defined by $\varphi(r)=e^{\frac{1}{r}}-e$. Our approach in \cite{HWZ-DM} allows one to derive Deligne-Mumford type results for any gluing profile satisfying suitable derivative bounds. Alternatively,  assuming the DM-theory for the logarithmic gluing profile,  a calculus lemma allows one  to derive the necessary results for the exponential gluing profile as shown in \cite{HWZ-DM}.

For the moment, let us fix the logarithmic gluing profile,  which we denote by $\varphi$. Given $\alpha$, a small disk structure ${\bf D}$, and a good deformation $v\mapsto  j(v)$ of $j$, which coincides with $j$ on $|{\bf D}|$, we obtain as previously described the family of noded Riemann surfaces
$$
(a,v)\mapsto  \alpha_{(a,v)}:=(S_a,j(a,v),M_a,D_a)\, \text{where  $(a,v)\in (B_{\frac{1}{2}})^{\# D}\times V$}.
$$
Here $j(a,v)=j(v)_a$ is the complex structure induced from $j(v)$ on the glued surface $S_a$.
The automorphisms $g\in G$ of $(S, j, M, D)$  induce the canonical isomorphisms 
$$g_a:\alpha_{(a, v)}\to \alpha_{g\ast (a, v)}.$$
{At this point there should be no confusion with the arithmetic genus which is also denoted by $g_a$.}

If the nodal pair $\{x, y\}\in D$ satisfies $a_{\{x, y\}}\neq 0$, we have introduced in Section \ref{dm-subsect}  
the finite cylinder $Z^{\{x,y\}}_{a_{\{x,y\}}}$  consisting of points $z\in S_a$
satisfying  $z=[h_x(s,t)]$ where $(s,t)\in [0,R]\times S^1$ and $R=\varphi(|a_{\{x,y\}}|)$.

If the nodal pair $\{x, y\}$ satisfies $a_{\{x, y\}}=0$, we have introduced $Z^{\{x,y\}}_{a_{\{x,y\}}}=Z^{\{x,y\}}_0=D_x\cup D_y$. We recall that  our gluing construction at the nodal pair  does not change the 
pair $(D_x, x)\cup (D_y, y)$ of disks if $a_{\{x, y\}}=0$ and if  $a_{\{x, y\}}\neq 0$ replaces the pair of disks by the finite cylinder $Z^{\{x,y\}}_{a_{\{x,y\}}}$  connecting the  boundaries   of the disks. 
This cylinder has two sets of
distinguished coordinates namely $[s,t]$ by extending the positive
holomorphic coordinates coming from $x$ or $[s',t']'$ coming from the
negative holomorphic coordinates from $y$. 

If $a_{\{x, y\}}\neq 0$ and $h>0$,  we  define the 
sub-cylinder $Z^{\{x,y\}}_{a_{\{x,y\}}}(-h)\subset Z^{\{x,y\}}_{a_{\{x,y\}}}$ by 
$$
Z^{\{x,y\}}_{a_{\{x,y\}}}(-h)=\{[s,t]\in Z^{\{x,y\}}_{a_{\{x,y\}}}\
|\ s\in [h,R-h]\}
$$
and introduce the subsets $Z_a$  and  $Z_a(-h)$ of $S_a$  defined by 
$$
Z_a = \bigcup_{\{x,y\}\in D} Z^{\{x,y\}}_{a_{\{x,y\}}}\quad  \text{and}\quad 
Z_a(-h) = \bigcup_{\{x,y\}\in D} Z^{\{x,y\}}_{a_{\{x,y\}}}(-h).
$$


{If $a_{\{x, y\}}=0$ and $h>0$,  we  define  
\begin{equation*}
Z_0^{\{x, y\}}(-h)=D_x(-h)\cup D_y(-h),
\end{equation*}}
with the sub-disks 
$D_x(-h)=\{z\in D_x\vert \, \text{$z=x$  or  $z=h_x(s, t)$ for $s\geq h$}\}$ and 
$D_y(-h)=\{z'\in D_y\vert \, \text{$z'=y$  or  $z'=h_y(s', t')$ for $s'\leq -h$}\}.$


\begin{definition}[{\bf Core of $S_a$}]\label{def_core}
{Let $\alpha=(S, j, M, D)$ be a noded Riemann surface with a small disk  structure $\{D_x\}_{x\in \abs{D}}$ and let $\alpha_a=(S_a, j_a, M_a, D_a)$ be  the Riemann surface obtained from $\alpha$ by means of the aforementioned gluing construction using the logarithmic or exponential gluing profile associated to $a\in (B_{\frac{1}{2}})^{\# D}$. Then we define  the {\bf core}  of  $S_a$ \index{core of $S_a$} to be $S_a\setminus \text{int}\ Z_a$, where $Z_a\subset S_a$  is the collection of cylinders defined above.} 

{Hence, in the special case $a\equiv 0$,  the core of $S$ is the complement of the union of the disks of the small disk structure, namely, $S\setminus \bigcup_{x\in \abs{D}}\text{int}\ D_x$.}
\end{definition}
The cores of $S$ and $S_a$ are naturally identified.
The following observation will be useful in the study of
sc-smoothness.

\begin{figure}[ht]
\psfrag {z1}{\small{$Z_a(-h)$}}
\psfrag  {z2}{\small{$Z_a$}}
\psfrag {a1}{\small{$a_{\{x,y\}}=0$}}
\psfrag  {a2}{\small{$a_{\{x',y'\}}=0$}}
\psfrag {b1}{\small{$a_{\{x,y\}}\neq 0$}}
\psfrag  {b2}{\small{$a_{\{x',y'\}}=0$}}
\centering
\includegraphics[width=5in]{Fig4.eps}
\caption{The left-hand side  figure  shows a connected nodal Riemann surface of arithmetic genus $3$. The right-hand side  figure shows a glued version having genus $3$ with the distinguished cylinder $Z_a$ and the sub-cylinder $Z_a(-h)$.}
\label{Fig4}
\end{figure}



\begin{remark}\label{google}A  point $z\in S_a$ can be viewed as a point in $S$ as follows. If
$z$ belongs to the core it is obvious. If $z$ is outside of the core
we have two cases. Either it belongs to $D_x$ or to $D_y$, where
$\{x,y\}$ is an unglued nodal pair. In that case the identification
is  also clear. Otherwise it must belong to a ``neck''  $Z^{\{x,y\}}_{a_{\{x,y\}}}$ and hence can be
written in two ways as
$$
z=h_x(s,t)\quad \text{and} \quad z=h_y(s',t'),
$$
where $(s, t)\in [0, R]\times S^1$ and  $(s', t')\in [-R,0]\times S^1$ satisfying $s=s'+R$ and {$t=t'+\vartheta$} where $a_{\{x, y\}}=\abs{a_{\{x, y\}}}\cdot e^{-2\pi i\vartheta}$ and $R=\varphi (\abs{a_{\{x, y\}}})$ is the gluing length. In this case the point $z$ can be identified with two points in $S$, one in the disk $D_x$ and the other in the disk $D_y$. We denote by $\ov{z}$ the lift of a point $z\in S_a$ to $S$ if the lift is unique and by $\ov{z}_x$ and $\ov{z}_y$ if the lift is not unique and  the 
 subscript indicates
into which disk the point is  lifted, see Figure \ref{Fig5}.
\end{remark}

\begin{figure}[ht]
\psfrag {dx}{\small{$D_x$}}
\psfrag {dy}{\small{$D_y$}}
\psfrag  {x}{\small{$x$}}
\psfrag {y}{\small{$y$}}
\psfrag {hx}{\small{$h_x$}}
\psfrag {hy}{\small{$h_y$}}
\psfrag {zx}{\small{$Z_x$}}
\psfrag  {zy}{\small{$Z_y$}}
\psfrag {z}{\small{$Z$}}
\psfrag  {c}{\small{$z$}}
\psfrag  {a}{\small{$\ov{z}_x$}}
\psfrag {b}{\small{$\ov{z}_y$}}
\psfrag  {st}{\small{$(s, t)$}}
\psfrag  {stp}{\small{$(s',t')$}}
\psfrag {sa}{\small{$S_a$}}
\psfrag  {s}{\small{$S$}}
\centering
\includegraphics[width=4.3in]{Fig5.eps}
\caption{Lifts of  a point $z\in S_a$.}
\label{Fig5}
\end{figure}





\begin{definition}\label{def_finite_distance_core}
Let $a^l=(a^l_{\{x, y\}})_{\{x, y\}\in D}$ be a sequence of gluing parameters and let 
$(z_l)\subset  S_{a^l}$ be a sequence of points.  We say that  the sequence
$(z_l)$ stays in a {\bf finite distance to the core} \index{finite distance to the core}  if there exists a real number 
$h>0$ satisfying  $z_l\not \in Z_{a^l}(-h)$ for all large $l$.
\end{definition}

Assume that $(a^0,v^0)$ is given and consider the nodal pairs
$\{x,y\}\in D$ for which $a_{\{x,y\}}^0\neq 0$. If one  varies
only these non-zero gluing parameters, then  one quite easily
constructs a new smooth complex structure $j^\ast(b,v)$ on the noded  Riemann surface $S_{a^0}$ so that the noded surfaces  $(S_{a^0},j^\ast(b,v),M_{a^0},D_{a^0})$  and
$\alpha_{(a^0+b,v^0)}$ are isomorphic by a map which {restricted to the respective cores  agrees with the natural identification}.  Here $b$  is small and has a nonzero component  at the nodal pair $\{x, y\}\in D$ only  if
$a_{\{x,y\}}^0\neq 0$. In  \cite{HWZ-DM} this 
construction is called the ``freezing of gluing parameters''.  
We can  take the Kodaira differential at $(b,v)=(0,v^0)$ with respect
to $(b,v)$ and obtain a linear map
$$
PDj(a^0,v^0):N(a^0)\times E\rightarrow H^1(\alpha_{(a^0,v^0)})
$$
called a  partial Kodaira differential. \index{partial Kodaira differential} The space  $N(a^0)$ is the
subspace of $N$ consisting of all $\{a_{\{x,y\}}\}$ satisfying 
$a_{\{x,y\}}=0$ if  $a^0_{\{x,y\}}=0$.


\begin{definition}[{\bf Good uniformizing family}]\label{citiview}\index{good uniformizing family}
We consider the stable Riemann surface $\alpha=(S,j,M,D)$  whose finite automorphism group is denoted by $G$. Let $v\mapsto j(v)$ be a good complex deformation of $j$ and consider the family 
$(a,v)\mapsto  \alpha_{(a,v)}$ of glued noded Riemann surfaces, whose construction uses the  {\bf logarithmic  or the exponential gluing profile}. The parameters 
$(a,v)$ vary in the open neighborhood $O \subset N\times E$ of the origin which is invariant under the natural representation of $G$. The family $(a, v)\mapsto \alpha_{(a, v)}$ is called a uniformizing family with domain $O$, if the following conditions are satisfied. 
\begin{itemize}
\item[$\bullet$] The set ${\mathcal U}=\{[\alpha_{(a,v)}]\,  \vert \ (a,v)\in O\}$ of equivalence classes of stable Riemann surfaces 
is open in the space $\overline{\mathcal N}$.
\item[$\bullet$]  The map $p:O\rightarrow {\mathcal U}$ defined by
$$
p(a,v)=[\alpha_{(a,v)}]
$$
induces a homeomorphism from the orbit space $G\backslash O$  onto ${\mathcal U}$.
 \item[$\bullet$]  If 
$\phi:\alpha_{(a,v)}\rightarrow \alpha_{(a',v')}$ is an isomorphism of noded Riemann surfaces where $(a, v)\in O$ and $(a',v')\in O$, then there exists an automorphism    $g\in G$   satisfying  $(a',v')=g\ast(a,v)$. Moreover,  $\phi=g_a$ is the induced canonical isomorphism.
\item[$\bullet$]  The partial Kodaira differentials 
$$
PDj(a,v):N(a)\times E\rightarrow H^1(\alpha_{(a,v)})
$$
at the point  $(a,v)\in O$ are all  linear isomorphisms (resp. complex  linear if the logarithmic gluing profile is used).
\end{itemize}
\end{definition}

The following key result  is a reformulation of parts of the classical Deligne-Mumford theory in the case of the logarithmic gluing profile. It holds true also  in the case of the exponential gluing profile and we refer to  \cite{HWZ-DM} for the proof. We also discuss some of the issues later on.
\begin{theorem}\label{existence-x}
For each stable noded Riemann surface  $\alpha=(S,j,M,D)$ there exists a good uniformizing family
$$
(a,v)\mapsto  \alpha_{(a,v)}\quad \text{on the domain $ (a,v)\in O.$}
$$
\end{theorem}

 We now consider  the uniformizing family
$(a,v)\mapsto  \alpha_{(a,v)}$  on the  domain $ (a,v)\in O$ and,  abbreviating 
$o=(a,v)$,  simply write 
$$
o\rightarrow \alpha_o\quad \text{for $o\in O$}
$$
for the uniformizing family. In order to simplify the notation we shall abbreviate  by $\cg$ or
$\cg_\alpha$ the graph of the family $o\rightarrow \alpha_o$,
$$
\cg=\{(o,\alpha_{o})\ |\ o\in O\}
$$
which we equip with the structure of a complex manifold by requiring
that the map $\cg\rightarrow O$ defined by $(o,\alpha_o)\mapsto  o$ is a biholomorphic diffeomorphism.  We shall also refer to $\cg$ as to  a uniformizing
family. The natural map $p:\cg\rightarrow \overline{\mathcal
N}$ is defined by $p(o,\alpha_o)=[\alpha_o]$.

If  $\cg$ and $\cg'$ are given, we consider for the two uniformizing families $(o,\alpha_o)\in
\cg$ and $(o',\alpha_{o'}')\in \cg'$ the triple 
$$
((o,\alpha_{o}),\phi,(o',\alpha_{o'}') )\equiv (o,\alpha_o,\phi,o',\alpha_{o'}')
$$
in which  $\phi:\alpha_{o}\rightarrow \alpha_{o'}'$ is an
isomorphism between the nodal Riemann surfaces. We
denote the  set  of all such triples by ${\bf
M}(\cg,\cg')$.  There are  two natural maps $s,t$ defined on ${\bf
M}(\cg,\cg')$. Namely,  the source map
$$
s:{\bf
M}(\cg,\cg')\rightarrow\cg, \quad \text{defined by  $s(o,\alpha_o,\phi,o',\alpha_{o'}')=
(o,\alpha_{o})$,}
$$
and the target map 
$$
t:{\bf
M}(\cg,\cg')\rightarrow\cg',\quad \text{defined by $t(o,\alpha_o,\phi,o',\alpha_{o'}')=
(o',\alpha_{o'}')$}.
$$
\begin{figure}[htbp]
\psfrag {s}{\small{$\cg'$}}
\psfrag {s1}{\small{$\cg$}}
\psfrag {a}{\small{$(o,\alpha_o)$}}
\psfrag  {a}{\small{$(o,\alpha_o)$}}
\psfrag {b}{\small{$(o',\alpha_{o'})$}}
\psfrag {c}{\small{morphism} {$((o,\alpha_o), \psi, (o',\alpha_{o'}))$}}
\centering
\includegraphics[width=3.5in]{Fig6.eps}
\caption{One can view the points in $\cg$ and $\cg'$ as objects of a category and the points in ${\bf M}(\cg,\cg')$ as morphisms
between these objects.}
\label{Fig6}
\end{figure}

The following result, {proved in \cite{HWZ-DM},}  is a
reformulation  of parts of the DM-theory.
\begin{theorem}
{We have fixed the logarithmic gluing profile}.
 The set ${\bf
M}(\cg,\cg')$ has a natural structure as a complex manifold so that
the source and the target maps are locally biholomorphic
maps and the map
$${\bf
M}(\cg,\cg')\xrightarrow{s\times t}\cg\times\cg'
$$
is proper. For these complex manifold structures
the inversion map
$$
{\bf M}(\cg,\cg')\rightarrow {\bf M}(\cg',\cg),
$$
defined by 
$$
(o,\alpha_o,\phi,o',\alpha_{o'}')\mapsto
(o',\alpha_{o'}',\phi^{-1},o,\alpha_{o}),
$$
and the $1$-map
$
\cg\rightarrow {\bf M}(\cg,\cg)$, defined by 
$$(o,\alpha_{o})\mapsto
(o,\alpha_{o},\id,o,\alpha_{o}),
$$
are holomorphic maps. Moreover, given $\cg,\cg',\cg''$  the fibered product
$$
{\bf M}(\cg',\cg''){{_s}\times_t}{\bf M}(\cg,\cg')
$$
has, in view  of the first part of the theorem,the structure of
a complex manifold, and the multiplication map, 
$$
{\bf M}(\cg',\cg''){{_s}\times_t}{\bf M}(\cg,\cg')\rightarrow {\bf
M}(\cg,\cg''),
$$
 defined by 
\begin{equation*}
((o',\alpha_{o'}',\phi,o'',\alpha_{o''}''),
(o,\alpha_{o},\psi,o',\alpha_{o'}'))\mapsto 
(o,\alpha_{o},\phi\circ\psi,o'',\alpha_{o''}''), \end{equation*}
is a holomorphic  map.
\end{theorem}

 The above theorem is the building block for a
complex orbifold structure on  the space $\overline{\mathcal N}$ of equivalence classes of connected and stable noded Riemann surfaces as explained next.

We begin with the complex structure. If $g,m$ are nonnegative integers satisfying 
 $2g+m\geq 3$, we  denote by $\overline{\mathcal N}_{g,m}$ the
connected component of  $\overline{\mathcal N}$ consisting of elements of noded Riemann surfaces having arithmetic genus equal to $g$ and
$m$ marked points. This component is a compact topological space. 

\begin{figure}[h!]
\psfrag {ax}{$\abs{X}$}
\psfrag {x}{\small{$X=\Sigma_1\cup \Sigma_2\cup \Sigma_3\cup \Sigma_4$}}
\psfrag{s1}{\small{$\Sigma_1$}}
\psfrag {s2}{\small{$\Sigma_2$}}
\psfrag {s3}{\small{$\Sigma_3$}}
\psfrag   {s4}{\small{$\Sigma_4$}}
\centering
\includegraphics[width=4in]{Fig7.eps}
\caption{The object set is $X$. Only some of the arrows are given in the figure. This figure shows how the circle $S^1$ can be obtained as the orbit space of an \'etale proper Lie groupoid. These groupoids play the same  role an atlas plays in the manifold theory. Modeling the notion of an equivalence of smooth atlases in the present context gives equivalent orbifold structures.}
\label{Fig7}
\end{figure}

We thus
can find finitely many sets $\cg_1,\ldots ,\cg_l$ so that the union of their
images under the natural maps $p:\cg \to \ov{\mathcal N}$,  defined by $p(o,\alpha_o)=[\alpha_o]$,    is equal to $\overline{\mathcal N}_{g,m}$. We denote by $X_{g,m}$ the 
disjoint  union of the sets $\cg_i$, where $1\leq i\leq l$, and by  ${\bf X}_{g,m}$ the disjoint union of the sets  ${\bf M}(\cg_i,\cg_j)$, where $1\leq i,j\leq l$. We  view $X_{g,m}$  as the
object set  in a small category having the set  ${\bf X}_{g,m}$ as its morphism set.
The object and the morphism sets are equipped with the  structure of complex
manifolds, so that in view of the previous theorem all category
operations are holomorphic. The source and target maps $s,t$
are surjective locally biholomorphic maps and the map
$$
{\bf X}_{g,m}\xrightarrow{s\times t} X_{g,m}\times X_{g,m}
$$
is proper. Therefore the category  $X_{g,m}$ is
a proper \'etale Lie groupoid as described  in  \cite{Mj,MM}.
 Finally,  we have a natural homeomorphism
$$
\beta:|X_{g,m}|\rightarrow \overline{\mathcal N}_{g,m},\quad 
|x|\mapsto  p(x)
$$
between the orbit space $|X_{g,m}|$ of $X_{g,m}$,  obtained by identifying two objects if they are connected by a morphism, and the set $\ov{\mathcal N}_{g,m}$. 
Hence the pair $(X_{g,m},\beta)$ defines a holomorphic orbifold structure on the connected component
$\overline{\mathcal N}_{g,m}$. Different choices of finite collections $(\cg_i)$ as introduced  above
define equivalent orbifold structures.  For a proof we refer to \cite{Mj} or \cite{MM}.
 An orbifold is a paracompact Hausdorff space equipped with an equivalence class of orbifold structures.
\begin{remark}\label{LIFT}
Let us also note that by a slight modification one obtains a natural
orbifold structure on the space   $\overline{\mathcal M}$ of equivalence classes of 
stable noded Riemann surfaces with ordered marked points. It can be
obtained from the above construction by admitting  only biholomorphic
isomorphisms preserving the order of the marked points. The associated space   $\overline{\mathcal M}_{g,m}$ is the classical Deligne-Mumford space of equivalence classes of stable Riemann surfaces of arithmetic genus $g$ and $m$ ordered marked points.
\end{remark}

In the previous discussion we have described a version  of the classical
DM-theory {assuming that the gluing profile is the logarithmic gluing profile}. However,  if we study  maps on the Riemann surfaces we are forced 
to choose a different  gluing profile. This is a priori not obvious but follows from rather subtle analytical considerations. The
modification is  carried out  in  \cite{HWZ-DM} and is as follows. 
 For every
family $(a,v)\mapsto  \alpha_{(a,v)}$ we replace the logarithmic
gluing profile by the exponential gluing profile. Therefore, we
consider the family
$$
(a,v)\mapsto  (\wt{a},v)\mapsto  \alpha_{(\wt{a},v)},
$$
of stable noded Riemann surfaces parametrized by the gluing parameters  $\wt{a}=(\wt{a}_1,\ldots ,\wt{a}_k)$ for the exponential gluing profile which  are related to the gluing parameters 
$a=(a_1,\ldots, a_k)$ belonging to the logarithmic gluing profile by the following formula.  If $a_i=0$ then $\wt{a}_i=0$. If
$a_i\neq 0$, we set $a_i=|a_i|\cdot e^{-2\pi i\vartheta}$ and define
${\wt{a}}_i$ by ${\wt{a}}_i=|{\wt{a}}_i|\cdot e^{-2\pi
i\vartheta}$ where 
$$
\abs{a_i} = e^{-2\pi(e^{\frac{1}{\abs{\wt{a}_i}}}-e)}.
$$
If we define the set $X_{g,m}$ of objects 
as before we obtain a naturally oriented smooth orbifold structure
on $\overline{\mathcal N}_{g,m}$. This is the smooth orbifold structure
we shall need for the  further constructions. 


One could also start the whole construction with a good but not necessarily complex family $v\mapsto j(v)$.
Then in the corresponding construction of the manifolds ${\bf M}(\Xi,\Xi')$  the source and target maps are smooth, and so are the multiplication, inversion and $1$-maps. The main result here is the following theorem.
\begin{theorem}\label{theorem2.15}
Carrying out the previous gluing constructions  with the   {\bf exponential gluing profile} replacing the logarithmic gluing profile, one obtains  naturally oriented smooth orbifold structures  on the sets $\overline{\mathcal N}$ and $\ov{\mathcal M}_{g,m}$. We denote the spaces equipped with these orbifold  structures  by $\ov{\mathcal N}^{\textrm{exp}}$ and  
$\ov{\mathcal M}^{\textrm{exp}}_{g,m}$.
\end{theorem}
 In \cite{HWZ-DM} this result is proved directly by using an implicit function theorem.
However, it  follows alternatively from the classical (holomorphic)
  DM-theory as described above by means of a calculus lemma, also shown in \cite{HWZ-DM}. 


Let $\alpha=(S,j,M,D)$  be a connected  noded  Riemann surface with (ordered) marked points. We do not require $\alpha$ to
be stable, but assume that $2g+m\geq 3$, where $g$ is the arithmetic
genus of $\alpha$ and $m$ the number of marked points on $S$. 
{Let $G$ be a finite subgroup of the automorphism group of $\alpha$. In   case $\alpha$ is unstable this latter group will be infinite.  Now we take a collection of compact small disks around the nodal points and require that they have smooth boundaries and their
union is invariant under $G$. The construction is the same as the construction of  a small disk structure. Let $j(w)$ be a
deformation of $j$ satisfying  $j(w)=j$ on these disks. Here $w$ varies in a finite dimensional complex vector space $E$.  Let $N$ be the  finite dimensional complex vector space of the gluing parameters 
$a_{\{x,y\}}$, $\{x, y\}\in D$. Using the exponential gluing profile we obtain a  family
$$
(b,w)\mapsto \beta_{(b,w)}=(S_b,j(b,w),M_b,D_b), \qquad (b,w)\in O,
$$
where $O\subset N\times E$ is an open neighborhood of the origin. Now we apply the forgetful map $\gamma$ to obtain a map
$$
O\rightarrow \overline{\mathcal M}_{g,m}, \quad (b,w)\mapsto
[(\beta_{(b,w)})_{\textrm{stable}}]
$$
into the classical Deligne-Mumford space $\overline{\mathcal M}_{g,m}$ 
space  constructed by means of  the logarithmic gluing profile.  We already explained in the first section how the underlying stable 
Riemann surface is constructed.}

\begin{lemma}\label{thm2.15-n}
The above  map
$$
O\rightarrow \overline{{\mathcal M}}_{g,m}, \quad (b,w)\mapsto 
[{(\beta_{(b,w)})}_{\textrm{stable}}]
$$
into the classical Deligne-Mumford space equipped with the smooth structure related to the holomorphic structure, is a smooth map between orbifolds.
\end{lemma}


 Note that we suppress here  the obvious `overhead'
for $\overline{\mathcal M}_{g,m}$  described  by the sets $\Xi$.
The map in {Lemma} \ref{thm2.15-n} is,  of course, represented near a point in $O$ by a map into some  set $\Xi_i$.
\begin{proof}
We start with the above family 
$$
(b,w)\mapsto  \beta_{(b,w)}:=(S_b,j(b,w),M_b,D_b),\quad (b, w)\in O
$$ 
of noded Riemann surfaces constructed by means of   the exponential gluing profile and a smooth deformation $w\mapsto  j(w)$ which is independent of $w$ near the nodal points. Let us add to the unstable domain components of $(S,j,M,D)$ a few points outside of the small disk structure in order to make them stable. Call this additional set of marked points $M^\ast$.
We may assume that $M^\ast$ is ordered so that the set $M^{\ast\ast}=M\cup M^\ast$ of marked points is ordered.
{We now consider the family 
$$
(b,w)\mapsto \beta^{\ast\ast}_{(b,w)}:=(S_b,j(b,w),M_b^{\ast\ast},D_b)
$$
which is smooth 
into the space $\overline{\mathcal M}_{g,m^{\ast\ast}}^{\textrm{exp}}$ equipped with the smooth structure coming from the exponential gluing profile
as shown in \cite{HWZ-DM}}.  
Here $m^{\ast\ast}=\sharp M^{\ast\ast}$ is the number of marked points.
On the other hand, the identity map 
$$\overline{\mathcal M}_{g,m^{\ast\ast}}^{\textrm{exp}}\xrightarrow{\text{id}} \overline{\mathcal M}_{g,m^{\ast\ast}}$$
 is smooth which is again  proved  in \cite{HWZ-DM}.  The inverse, in fact, is not.
 
 Now we can apply  the following well-known result in the classical DM-theory.
\begin{proposition}\label{classical_prop}
The map which forgets the $l$-th marked point and throws away possibly arising unstable domain components
$$
\text{\em forget}_l:\overline{\mathcal M}_{g,m^{\ast\ast}}\rightarrow
\overline{\mathcal M}_{g,m^{\ast\ast}-1}
$$
is  holomorphic.
 \end{proposition}
Continuing with the proof of Lemma \ref{thm2.15-n},  we set $m=\sharp M$ and $m^\ast=\sharp M^\ast$,  so that  $m^{\ast\ast}=m+m^\ast$. Then the map 
$
O\rightarrow \overline{\mathcal M}_{g,m}$,  defined by $(b,w)\mapsto  [{(\beta_{(b,w)})}_{\textrm{stable}}]$,
is the following composition of maps, 
\begin{gather*}
O\to \ov{\mathcal M}_{g,m^{\ast\ast}}^{\textrm{exp}}\xrightarrow{\text{id}} \ov{\mathcal M}_{g,m^{\ast\ast}}\to \ov{\mathcal M}_{g,m^{\ast\ast}-1}\to \ldots \to \ov{\mathcal M}_{g,m}\\
 (b,w)\mapsto  \text{forget}_{m+1}\circ \text{forget}_{m+2}\circ \ldots \circ  \text{forget}_{m+m^{\ast}}([\beta^{\ast\ast}_{(b,w)}]).
\end{gather*}
{In view of Proposition \ref{classical_prop}, 
this map is  a composition of smooth maps and hence the map $O\rightarrow \overline{\mathcal M}_{g,m}$ is  smooth,  completing the proof of Lemma \ref{thm2.15-n}.}
\end{proof}

Finally we  recall  the so called ``universal property'' of a good uniformizing family $(a, v)\mapsto 
\alpha_{(a, v)}$ of stable noded Riemann surfaces. The property claims for every family $(b, w)\mapsto \beta_{(b, w)}$ of 
 stable noded Riemann surfaces, containing for some parameter value $(b_0, w_0)$ a 
 surface $\beta_{(b_0, w_0)}$ isomorphic to  a surface $\alpha_{(a_0, v_0)}$ belonging to a  uniformizing family, that there exists a well-defined map $(b, w)\mapsto \mu (b, w)=(a(b, w), v(b, w))$ defined near $(b_0, w_0)$ and satisfying $\mu (b_0, w_0)=(a_0, v_0)$ so that all the surfaces $\beta_{(b, w)}$ are isomorphic to the  surfaces $\alpha_{\mu (b, w)}$. In order to make this statement precise we choose a  stable noded and connected Riemann surface $\alpha=(S,j,M,D)$ 
with unordered marked points and let 
$$
(a,v)\mapsto  \alpha_{(a,v)}=(S_a, j(a, v), M_a, D_a)$$
be a good uniformizing family with domain $(a, v)\in O$ as defined in Definition \ref{citiview}.\index{universal property}

Let $(S', j', M', D')$  be  another stable connected noded  Riemann surface with  unordered marked points, and let  ${\bf D}'$  be a small disk structure ${\bf D}'$ on $S'$. This time we allow the marked points in $M'$ to belong to $\abs{{\bf D}'}$. Of course, $M'$ is still assumed to be disjoint from the nodal points $\abs{D'}$. 
In order to define a deformation $M'(\sigma)$ of $M'$ we choose around every point $z\in M'$ an open neighborhood $V(z)$ whose closure does not intersect $\abs{D'}$.  {Moreover, these sets $V(z)$ are chosen to be mutually disjoint. 
If $M'=\{z_1,\ldots, z_{m'}\}$, we introduce the product space 
$$V(M'):=V(z_1)\times \cdots V(z_{m'}).$$
A point $\sigma=(\sigma_1,\ldots ,\sigma_{m'})\in V(M')$ where $\sigma_j\in V(z_j)$, defines the set $M(\sigma')$ of marked points on $S'$, in the following called a 
{\bf deformation of the marked points $M'$}.} \index{deformation of marked points} 
If $\sigma$ changes smoothly,  the set of marked points $M'(\sigma)$ changes, by definition, smoothly. We now take a $C^{\infty}$ neighborhood $U$ of the complex structure $j'$ and denote by $U_{{\bf D}'}$ the collection of complex structures $k$ in $U$ which coincide with $j'$ on the discs $\abs{{\bf D}'}$ of the small disk structure.
With the triple $(b, k, \sigma)\in B_{1/2} \times U_{{\bf D}'}\times V(M')$ we associate  the noded Riemann surface 
$\beta_{(b, k, \sigma)}=(S'_b, k_b, M' (\sigma)_b, D'_b)$ and study  
the  surfaces for  $\abs{b}$  small, $\sigma$  close to $\sigma_0$ satisfying  $M(\sigma_0)=M'$ and $k$  close to $j'$. If we take a finite-dimensional family 
$$w\mapsto k(w)$$
of complex structures $k$ which depend  smoothly  on a parameter $w$ varying  in a finite dimensional Euclidean space, then we call  the map 
$$(b, w, \sigma)\mapsto  \beta_{(b, k(w), \sigma)}=(S'_b, k(w)_b, M'(\sigma)_b, D'_b)$$
a  smooth family.  The following result is proved in  \cite{HWZ-DM}.

\begin{theorem}[{\bf Universal property}] \label{smoothfamily}
We fix the good uniformizing family $(a, v)\mapsto \alpha_{(a, v)}$.\\
(1) Consider the family 
$(b, k, \sigma)\mapsto  \beta_{(b, k, \sigma)}$ of noded Riemann surfaces as introduced above
($(b,k,\sigma)\in B_{\frac{1}{2}}\times U_{{\bf D}'}\times V(M')$) and assume that there exists an 
isomorphism
$$
\psi:\beta_{(0, j', \sigma_0)}=(S',j',M'(\sigma_0),D')\rightarrow (S_{a_0},j(a_0, v_0),M_{a_0}, D_{a_0})=\alpha_{(a_0,v_0)}
$$
between the two noded Riemann surfaces for some parameter $(a_0, v_0)$. 
Then there exists a uniquely determined continuous germ 
$$
(b,k,\sigma)\mapsto  \mu (b, k, \sigma)=(a(b,k,\sigma),v(b,k,\sigma))
$$
near $(b, k, \sigma)=(0, j', \sigma_0)$ satisfying 
$\mu  (0,j',\sigma_0)=(a_0,v_0)$ and an associated core-continuous germ
$(b, k, \sigma)\to \phi (b, k, \sigma)$ of isomorphisms 
$$\phi(b, k, \sigma):\beta_{(b, k, \sigma)}\to \alpha_{\mu (b, k, \sigma)}$$
between the noded Riemann surfaces satisfying $\phi (0, j', \sigma_0)=\psi$.\\
(2) Moreover, if $w\mapsto k(w)$ is a smooth family of complex structures on $S'$ satisfying $k(0)=j'$, then the family $(b, w, \sigma)\mapsto \phi (b, k(w), \sigma)$ of isomorphisms
$$\phi(b, k(w), \sigma):\beta_{(b, k(w), \sigma)}\to \alpha_{\mu(b, k(w), \sigma)}$$
is core-smooth.

\end{theorem}

\begin{figure}[h!]
\psfrag {z}{${z}$}
\psfrag {zp}{ ${\phi_{(b_0, w_0, \sigma_0)}(z)}$ }
\psfrag {p}{${\phi_{(b, w, \sigma)}}$}
\centering
\includegraphics[width=3.9in]{Fig8.eps}
\caption{Since the domain and target are varying one needs the notion of a family of maps being core smooth.}
\label{Fig8}
\end{figure}


The notions  of core-continuous and core-smooth, illustrated in Figure \ref{Fig8}, are defined as follows. If $(b, w, \sigma)\to \phi (b, k(w), \sigma)$ is a family of isomorphisms 
$$
\phi (b, k(w),\sigma):\beta_{(b,k(w),\sigma)}\rightarrow \alpha_{\mu (b, k(w), \sigma)}
$$
between the noded Riemann surfaces, we fix $(b_0, w_0, \sigma_0)$ in the parameter space. If the point $z$ in $S'_{b_0}$ is not a nodal point, then its image $\zeta$ under 
$\phi (b_0, k(w_0),\sigma_0)$ in $S_{a(b_0, k(w_0),\sigma_0)}$ is also not a nodal point of the target surface $\alpha_{\mu (b_0, k(w_0),\sigma_0)}.$ If $z$ is in the core, a neighborhood of $z$ can canonically be identified with a neighborhood of $z$ viewed as a point in $S'$. If $z$ does not belong to a core, we find a nodal pair $\{x', y'\}\in D'$ and can identify $z$ with a point in $D_{x'}\setminus \{x'\}$ or with a point in $D_{y'}\setminus \{y'\}$ where $D_{x'}$ and $D_{y'}$ are discs belonging to the chosen small disk structure of the noded surface $(S', j', M', D')$. The same alternatives hold for the image $\zeta$ of $z$ under the isomorphism $\phi (b_0, k(w_0),\sigma_0)$. Via these identifications, the family $\phi (b, k(w),\sigma)$ of isomorphisms gives rise to a  family of diffeomorphisms defined on a neighborhood of $z$ in $S'$ into a neighborhood of $\zeta$ in $S$. Being   core-continuous respectively core-smooth requires that all these germs of families  of isomorphisms are continuous respectively  smooth families of  local diffeomorphisms in the familiar sense,  between the fixed Riemann surfaces $S'$ and $S$.\index{core-continuous }\index{core-smooth}
\section{Sc-smoothness, Sc-splicings, and Polyfolds}\label{sc-smoothness}
The theory of polyfolds developed in \cite{HWZ2}-\cite{HWZ7} generalizes the theory of Banach manifolds. The theory is based on a new concept  of differentiability which allows, in particular, to view analytically intricate limiting phenomena like bubbling off or stretching the neck, as smooth phenomena. In this subsection we recall for the convenience of the reader some of the fundamental concepts  of this new theory. We start recalling the underlying smooth structure of Banach spaces, called an sc-structure. 

An {\bf sc-structure} \index{sc-structure}  for the  Banach space $E$  consists of a nested   sequence of Banach spaces 
$$E=:E_0\supset E_1\supset \ldots \supset E_{\infty}:=\bigcap_{i\geq 0}E_i$$
having the properties that the inclusion operators  $E_{i+1}\to E_i$ are compact operators and  that the vector space $E_{\infty}$ is dense in every Banach space $E_i$. 

A point belonging to $E_{\infty}$ is called a  {\bf smooth point}.\index{smooth point}  In the following a Banach space equipped with an sc-structure is called an sc-Banach space. \index{sc-Banach space}
A subset $U\subset E$ inherits the induced  sc-structure defined by the sequence $U_i=U\cap E_i$  equipped with the topology of $E_i$ for all 
$i\geq 0$. Given such an  induced sc-structure on $U$, the set $U_i$ has the induced sc-structure defined by the 
nested sequence  $(U_{i})_{j}:=U_{i+j}$ for all $j\geq 0$, and we write $U^i$ for the set $U_i$ equipped with this sc-structure. If $E$ and $F$ are sc-Banach spaces and $U\subset E$ and $V\subset F$ are open subsets, then $U\oplus V$ carries the sc-structure $(U\oplus V)_i=U_i\oplus V_i$. 


 {A subspace $F$ of an sc-Banach space $E$ is  called an {\bf sc-subspace}  if $F$  is closed and the sequence $(F_i)_{i\geq 0}$, where  $F_i: = F \cap E_i $, defines an sc-structure on $F$. An sc-subspace $F$ of an sc-Banach
$E$  has an {\bf sc-complement}   if there exists an algebraic complement $G$  of $F$  equipped with an sc-structure $(G_i)_{i\geq 0}$ so that on every level $i$  we have a topological direct sum
$E_i = F_i \oplus G_i$.}

In the classical theory the tangent space at a point $x\in U\subset E$ has a natural identification with the  Banach space $E$. In the sc-theory, points in $U\setminus U_1$ do not have a tangent space for the given sc-structure and  the tangent space $TU$ of the open set $U\subset E$ is defined as 
$$TU=U^1\oplus E.$$

A linear operator $T:E\to E$ between two sc-Banach spaces is called an {\bf sc-operator}\index{sc-operator}  if  it maps $E_m$ into $F_m$ for every $m$ such that $T:E_m\to F_m$ is a bounded linear operator. An sc-isomorphism $T:E\to F$ is a bijective sc-operator whose inverse is also an sc-operator. In order to construct spaces with  boundary with corners, the concept of a partial quadrant $C$ in the sc-Banach space $E$ is useful.\index{partial quadrant} It is a closed convex subset having the property that there exists an sc-Banach space $W$ and an  linear sc-isomorphism $T:E\to \R^n\oplus W$ mapping $C$ onto  $[0, \infty )^n\oplus W$.

The tangent space of a relatively open subset $U\subset C\subset E$ of a partial quadrant $C$ in the sc-Banach space is defined as $TU=U^1\oplus E$. It carries the sc-structure $(TU)_i=U_{i+1}\oplus E_i$.

The notion of continuity of a map generalizes naturally to $\ssc^0$-maps as follows. 
A map $f:U\rightarrow U'$   between two  relatively open  subsets of the  partial quadrants in sc-Banach spaces is an $\ssc^0$-map, if   $f(U_i)\subset U'_i$  for all $i\geq 0$ and if the induced maps  $f:U_i\rightarrow U'_i$ are  continuous. \index{$\ssc^0$-map} Next we recall the generalization of a smooth map between sc-Banach spaces, called sc-smoothness.

\begin{definition}\label{sscc1} 
Let $U$ and $U'$ be  relatively 
open subsets  of partial quadrants $C$ and $C'$ in the sc-Banach spaces $E$ and $E'$, respectively. 
An  $\ssc^0$-map $f:U\rightarrow U'$ is called an 
$\ssc^1$-map,    or of class $\ssc^1$,   if the following conditions are satisfied.

\begin{itemize}\label{sc-1}
\item[(1)] For every $x\in U_1$ there exists a bounded 
linear  map $Df(x)\in  {\mathcal L}(E_0, E'_0)$ satisfying for $h\in
E_1$, with $x+h\in U_1$,
$$\frac{1}{\norm{h}_1}\norm{f(x+h)-f(x)-Df(x)h}_0\to 0\quad
\text{as\ $\norm{h}_1\to 0$.}\mbox{}\\[4pt]$$
\item[(2)]  The tangent map  $Tf:TU\to TU'$,
defined by
$$Tf(x, h)=(f(x), Df(x)h),
$$
is an $\ssc^0$-map between the tangent spaces. \index{$\ssc^1$-map}
\end{itemize}
\end{definition}


If $Tf:TU\to TU'$ is of class $\ssc^1$, then $f:U\to
E'$ is called of  class $\ssc^2$. Proceeding inductively, the map $f:U\to E'$ is called of class 
$\ssc^k$ if the
$\ssc^0$-map $T^{k-1}f:T^{k-1}U\to T^{k-1}E'$ is of class $\ssc^1$.
Its tangent map $T(T^{k-1}f)$ is then denoted by $T^kf$. It is an
$\ssc^0$-map $T^kU\to T^kE'$.
 A map  which is of class $\ssc^k$ for every $k$ is called  {\bf sc-smooth}  or of  class $\ssc^{\infty}$. \index{sc-smooth! map}
   
 The cornerstone  of the sc-calculus,  the chain rule, holds true and 
 one concludes by induction that the composition of $\ssc^{\infty}$-maps is again of class $\ssc^{\infty}$.

A fundamental  role in the definition  of a M-polyfold is  played by the sc-smooth retractions introduced next. 
\begin{definition}\label{retract}
Let $U\subset C\subset E$ be a relatively open subset of  the partial quadrant $C$ in the sc-Banach space $E$. An $\ssc^{\infty}$-map $r:U\to U$ is called an {\bf sc-smooth retraction} 
or 
an $\ssc^\infty$-retraction  if $r$ satisfies $r\circ r=r$. \index{sc-smooth!retraction}  The image $O=r(U)$ is called 
an  {\bf $\ssc^{\mathbf \infty}$-retract}. \index{sc-smooth!retract} 
\end{definition}

In view of  the chain rule, the tangent map $Tr:TU\to TU$  of an sc-smooth retraction $r:U\to U$ satisfies $Tr\circ Tr=Tr$, and hence  is again an sc-smooth retraction. 

Given a partial quadrant  $C$ in an sc-Banach space $E$,  we define   the degeneration index
$$
d_C:C\to  \N_0
$$
as follows. We choose a linear $\ssc$-isomorphism $T:E\to  \R^k\oplus W$ satisfying $T(C)=[0,\infty)^k\oplus W$. Hence for $x\in C$, we have  
$$T(x)=(r_1, \ldots, r_k, w)$$
where   $(r_1, \ldots, r_k)\in [0,\infty )^k$ and $w\in W$. Then we  define  the integer $d_C(x)$ by
$$
d_C(x)=\sharp\{i\in \{1,\ldots, k\}\vert \, r_i=0\}.$$
It is not difficult to see that this definition is independent of  the choice of an sc-linear isomorphism $T$.

The following concept will replace open subsets of Banach spaces in the classical definition of a local chart of a   
Banach manifold. {In \cite{HWZ10} we spend considerable efforts  to find (among other things) the best notions
for future developments. The local models for M-polyfolds with possible boundaries are sc-smooth retracts $(O,C,E)$, where $E$ is an sc-Banach space, $C\subset E$ a partial quadrant and $O\subset C$ an sc-smooth retract relative to $C$. As it turns out, using this definition,  a M-polyfold (with nonempty boundary) has a boundary with little structure.
In our applications, for example SFT, the boundary has a lot of structure and one can take local models which reflect these. This leads to the definition
of tame sc-smooth retracts. In the current paper, where the main illustration is Gromov-Witten theory, the full strength of the theory in \cite{HWZ10} is not needed
and we shall now introduce for the purpose of this paper the notion of a local M-polyfold model. The reader will immediately verify that this is a special case
of a tame sc-smooth retract.}

\begin{definition}\label{locmodel}
A local M-polyfold model is a triple $(O,C,E)$ in which  $E$ is an sc-Banach space, $C$ is  a partial quadrant of $E$, and $O$ is a  subset of $C$  having the following properties:
\begin{itemize}
\item[(1)] There is an sc-smooth retraction $r:U\to  U$ defined on a relative open subset $U$ of $C$ so that 
$O=r(U).$
\item[(2)] For every  smooth point $x\in O_\infty$,  the kernel of the map  $(\id-Dr(x))$ possesses  an sc-complement which is  contained in $C$.
\item[(3)] For every $x\in O$,  there exists a sequence of smooth points $(x_k)\subset O_\infty$ converging to $x$ in $O$ and satisfying $d_C(x_k)=d_C(x)$.\index{local M-polyfold model}
\end{itemize}
\end{definition}
The choice of $r$ in the above definition is irrelevant as long as it is an sc-smooth retraction onto $O$ defined on a relatively open subset $U$ of $C$. \\

{\bf Note that from now on the local models for our M-polyfolds will be the sc-smooth retractions of the kind just described. Local bundles $K\rightarrow O$
introduced later will have base spaces $O$ using the same type of retracts.}
\begin{remark} {Let us comment on the properties (2) and (3) in Definition \ref{locmodel}.
If $(O,C,E)$ and $(O',C',E')$ are local M-polyfold models and if $f$ is a germ of sc-diffeomorphism 
$f:{\mathcal O}(O,x)\rightarrow {\mathcal O}(O',x')$, at the smooth point  $x$, then Property (2) implies that
$d_C(x)=d_{C'}(x')$. In fact,  one can conclude this  for all elements $x$ on level at least $1$. However, it does not follow
if $x$ is only on  level $0$. Adding now Property (3)  we can show that the conclusion also holds for $x$ on level $0$. 
It follows that $d_C\vert O$ is a local diffeomorphism invariant, which,  describes
numerically the corner  structure of $O$ at the point $x$. Definition \ref{locmodel} is  a useful definition 
for the notion of a M-polyfold with boundary with corners. %
In the current paper we can restrict ourselves to the case without boundary. We point out that  for SFT
we shall need a set-up with boundaries with corners. The above definition is sufficient for SFT, though the more general notion
of a tame retract introduced in \cite{HWZ10}, which looks more natural, works equally well.}
\end{remark}


We would like to point out that in contrast to the smooth retracts in Banach manifolds, which are submanifolds, the sc-smooth retracts can be very wild sets having locally varying dimensions. {We refer  to the paper \cite{HWZ8.7} for illustrations. }


Note that an $\ssc^\infty$-retract $O\subset C\subset E$ has a tangent space $TO\subset TC\subset TE$, defined by
$TO=Tr(TU)$, where we can take any $\ssc^\infty$-retraction $r:U\rightarrow U$, $U\subset C\subset E$, which has $O$ as its image.
Consequently,  we can define the tangent $T(O,C,E)$ of a local M-polyfold model $(O,C,E)$ as 
$$
T(O,C,E):=(TO,TC,TE).\index{tangent of a local M-polyfold model}
$$

The constructions in this present paper, unlike the second part, only involves polyfolds without boundaries. Hence
the relevant local M-polyfold models are of the form $(O,E):=(O,E,E)$, where $O$  is an $\ssc^\infty$-retract, i.e. the image
of an $\ssc$-smooth map $r:U\rightarrow U$ defined on an open subset $U$ of $E$ and satisfying $r\circ r=r$.

In our applications of the polyfold theory later on,  the retractions are derived   from sc-smooth splicings, which are the distinguished sc-smooth retracts defined as follows.  

We consider a relatively open subset $V$ of a partial quadrant $C$ in the sc-Banach space $W$ and let $E$ be another sc-Banach space. Then we consider a family $\pi_v:E\to E$ of linear bounded projections parametrized by $v\in V$ such that the map 
$$\pi:V\oplus E\to E$$ 
defined by $\pi (v, e)=\pi_v (e)$ is sc-smooth. We point out that it is not required that the map $v\mapsto \pi_v$ is continuous in the operator topology. The triple  ${\mathcal S}=(\pi, E, V)$ is called an {\bf  sc-smooth splicing}. \index{sc-smooth! splicing} The  associated {\bf splicing core}  $K=K^{\mathcal S}$ is the set 
$$K=\{ (v, e)\in V\oplus E\vert \, \pi_v (e)=e\}. \index{splicing core} 
$$
Clearly, $V\oplus E$ is a relatively open subset of the partial quadrant $C\oplus E$ in the sc-Banach space $W\oplus E$ and the sc-smooth map 
$$r:V\oplus E\to V\oplus E$$ 
defined by $ r (v, e)=(v, \pi_v (e))$ 
satisfies $r\circ r=r$ and hence is an sc-smooth retraction onto  the retract $r(V\oplus E)=K.$


So far we have defined the sc-smoothness of maps between open subsets of sc-Banach spaces and use it now to define the sc-smoothness  of mappings between local models as follows.
\begin{definition}\label{map}
A map $f:(O, C, E)\to (O', C', E')$ between two  local M-polyfold models is of class $\ssc^1$ if the composition  $f\circ r:U\to E'$ is of class $\ssc^1$ where $U\subset C\subset E$ is a relatively open subset of the partial quadrant $C$ in the sc-Banach space $E$ and where $r:U\to U$ is an sc-smooth retraction onto $r(U)=O$. 
\end{definition}

{The tangent (or linearization)  of the map $f:O\to O'$ at the point $o\in O_1=r(U_1)$ on  level $1$ is defined as 
$$
Tf(o):T_oO\rightarrow T_{f(o)}O'
$$
by $T(f\circ r)|T_oO$.}

The chain rule  generalizes to $\ssc^1$-maps between sc-smooth local models.

Having the local models available we now generalize the concept of a manifold and introduce the notion of an 
{\bf M-polyfold}.

Let $X$ be a 
{paracompact} Hausdorff topological space.  
An  M-polyfold chart  for $X$ is a triple $(U,\varphi, (O, C, E))$, in which $U$ is an open subset of $X$, $(O, C, E)$ is a local  M-polyfold model and $\varphi:U\to O$ is a homeomorphism. Two such  charts $(U,\varphi, (O, C, E))$ and $(U',\varphi', (O', C', E'))$  are called  sc-smoothly compatible  if the transition maps  
\begin{align*}
\varphi'\circ \varphi^{-1}&:\varphi (U\cap U')\to  \varphi' (U\cap U')\\
\varphi \circ (\varphi')^{-1}&:\varphi' (U\cap U')\to \varphi (U\cap U')
\end{align*}
are sc-smooth. \index{M-polyfold! chart} Note that the sets $\varphi (U\cap U')$ and $\varphi'(U\cap U')$ are $\ssc^{\infty}$- retracts for sc-smooth retractions defined on relatively open subsets of partial quadrants $C$ and $C'$ in sc-Banach spaces $E$ and $E'$, respectively.  An sc-smooth atlas for $X$ consists of a family of sc-smoothly compatible charts  so that their domains cover $X$. 

\begin{definition}\label{DEF38}
Let $X$ be a  paracompact  Hausdorff topological space.   
A maximal atlas of sc-smoothly compatible M-polyfold charts is called an {\bf  M-polyfold structure} on $X$.\index{M-polyfold! structure}
\end{definition} 
{
\begin{remark} In a previous paper we have defined a M-polyfold by requiring the topology to be second countable Hausdorff.
The M-polyfold structure of the space then makes the space completely regular. By Urysohn's Theorem
a second countable, completely regular Hausdorff space is metrizable. We have realized later on that everything works under the assumption that  the topology is  paracompact and Hausdorff. As far as the Fredholm theory is concerned
the results we have proved in the previous papers are valid in this context. For certain future constructions it might be necessary to 
impose the condition of  second countability. This is the case, for example,  if the solution space of the unperturbed Fredholm section is not compact
and one constructs a Baire set of perturbations such  that every point has an open neighborhood on which the solution set is generic. In the case of a second countable topology 
one then will be able to obtain a Baire set of perturbations such  that globally the solution set is generic. This is already well-understood in the classical context of the Sard-Smale 
perturbation theory. The difficulties do not arise in the polyfold Fredholm theory,  if the solution set is compact and the perturbations are  sc$^+$-sections.
\end{remark} }
We note that $X$ can have a  boundary with corners or no boundary depending on whether in the charts 
$(U,\varphi, (O, C, E))$ we have $C=E$ or not. M-polyfold versions of  \'etale and proper Lie-groupoids are called ep-groupoids.
 In order to define them it is useful to first recall the concept of a groupoid.



\begin{definition}
A {\bf groupoid} $\mathfrak{G}$ is a small  category whose 
morphisms are all invertible.\index{groupoid}
\end{definition}
Recall that  the category $\mathfrak{G}$ consists of the set  of objects $G$, the set  
${\bf G}$ of morphisms  (or arrows) and the   five  structure maps $(s, t, i, u, m)$. \index{structure maps of a groupoid} Namely, the source and the target maps $s,t:{\bf G}\rightarrow G$ assign to every morphism, denoted by $g:x\to y$,  its source $s(g)=x$ and 
its target $t(y)=y$, respectively.  The associative multiplication (or composition) map 
$$m: {\bf G}{{_s}\times_t}{\bf G}\to {\bf G}, \quad m(h, g)=h\circ g$$
is defined on the fibered product 
$$ {\bf G}{{_s}\times_t}{\bf G}=\{(h, g)\in  {\bf G}\times {\bf G}\, \vert \, s(h)=t(g)\}.$$
For every object $x\in G$, there exists the unit morphism $1_x:x\mapsto  x$ in $\bf{G}$ which is a $2$-sided unit for the composition, that is, $g\circ 1_x=g$ and $1_x\circ h=h$ for all morphisms $g, h\in \bf{G}$ satisfying $s(g)=x=t(h)$. These unit morphisms together define the unit map $u:G\to \bf{G}$ by $u(x)=1_x$. Finally, for every morphism $g:x\mapsto  y$ in $\bf{G}$, there exists the inverse morphism $g^{-1}:y\mapsto  x$ which is a $2$-sided inverse for the composition, that is, $g\circ g^{-1}=1_y$ and $g^{-1}\circ g=1_x$. These inverses together define the inverse map $i:\bf{G}\to \bf{G}$ by $i (g)=g^{-1}.$
The {\bf orbit space} of a groupoid $\mathfrak{G}$,  
$$\abs{\mathfrak{G}}=G/\sim,$$ 
is  the quotient of the set of objects $G$ by the equivalence relation $\sim$ defined by 
$x\sim y$ if and only if  there exists a morphism $g:x\mapsto  y$. \index{orbit space of a groupoid} The equivalence class $\{y\in G\vert \, y\sim x\}$ will be denoted by 
$$\abs{x}:=\{y\in G\vert \, y\sim x\}.$$
If $x, y\in G$ are two objects, then ${\bf G}(x, y)$ denotes the set of all morphisms $g:x\mapsto y$. In particular, for $x\in G$ fixed, we denote by ${\bf G}(x)={\bf G}(x, x)$ the {\bf stabilizer} (or {\bf isotropy }) group of $x$,
$${\bf G}(x)=\{\text{morphisms}\ g:x\mapsto x\}.$$
For the sake of notational economy
we shall denote in the following a groupoid, as well as its object set by the same letter $G$ and its morphism set  by the bold letter ${\bf G}$.

\newenvironment{Myitemize}{%
\renewcommand{\labelitemi}{$\bullet$}%
\begin{itemize}}{\end{itemize}}

Ep-groupoids, as defined next, can be viewed as M-polyfold versions of  \'etale and proper Lie-groupoids discussed e.g. in \cite{Mj} and \cite{MM}.


\begin{definition}\index{ep-groupoid}
{\em An  {\bf ep-groupoid}  $X$ is a groupoid $X$ together with a M-polyfold
structures on the object set $X$ as well as on the morphism set ${\bf X}$
so that all the structure maps  $(s, t, m, u, i)$ are sc-smooth maps and the following
holds true.
\begin{Myitemize}
\item {\em ({\bf \'etale})} The source and target maps
$s$ and $t$ are surjective local sc-diffeomorphisms.
\item {\em ({\bf proper})} For every point $x\in X$,    there exists an
open neighborhood $V(x)$ so that the map
$t:s^{-1}(\overline{V(x)})\rightarrow X$ is a proper mapping.
\end{Myitemize}
}
\end{definition}

We  point out that if  $X$  is a groupoid  equipped  with
M-polyfold structures on the object set $X$ as well as on the
morphism set ${\bf X},$ and  $X$  is \'etale,  then  the
fibered product ${\bf X}{{_s}\times_t}{\bf X}$ has a natural
M-polyfold structure so that the multiplication map $m$ is defined
on an  M-polyfold.  Hence its
sc-smoothness is well-defined, see Lemma \ref{ert} below. 

In an ep-groupoid every morphism $g:x\to y$ can be extended to
a unique local sc-diffeomorphism $t\circ s^{-1}$ satisfying $s(g)=x$
and $t(g)=y$. The properness assumption implies that  the isotropy groups
${\bf G}(x)$ are finite groups.






The orbit space $\abs{X}$ of the ep-groupoid  $X$ is equipped with the quotient topology.

{A M-polyfold  $X$ is equipped with a filtration 
$$
X=X_0\supset X_1\supset X_2\supset \cdots \supset X_\infty:=\bigcap_{j\geq 0}X_j
$$
 into subsets such that the embeddings  $X_{k+1}\to X_k$ are  continuous and $X_\infty$ is dense in every subset $X_k$. Since in an ep-groupoid  the object set $X$ and the morphism set ${\bf X}$ are M-polyfolds, they are both equipped with filtrations. The source and the target maps are local sc-diffeomorphisms,  hence they preserve the levels of the filtrations. Consequently, the filtration of the object set $X$ induces the filtration on the orbit space $\abs{X}$, namely, 
$$
\abs{X}=\abs{X_0}\supset \abs{X_1}\supset \abs{X_2}\supset \cdots \supset \abs{X_\infty}=\bigcap_{j\geq 0}\abs{X_j}.
$$
}
An sc-smooth functor $F:X\to Y$ between two ep-groupoids is called an {\bf equivalence}   if it possesses the following properties.\index{equivalence}
\begin{itemize}
\item[(1)] $F$ is a local sc-diffeomorphism on objects as well as on
morphisms.
\item[(2)] The induced map $\abs{F}:\abs{X}\to \abs{Y}$ between the
orbit spaces {is  a homeomorphism.}
\item[(3)] For every $x\in X$,  the functor $F$ induces an isomorphism 
${\bf G}(x)\rightarrow {\bf G}(F(x)) $ between the isotropy groups.
\end{itemize}
{Let us note that (1)-(3) implies that $|F|(|X_m|)\subset |X_m|$ and that 
$|F|:|X_m|\rightarrow |X_m|$ is a homeomorphism for all $m\geq 0$.}

A {\bf polyfold structure}  on the {paracompact Hausdorff}  topological space  $Z$
is a pair $(X,\beta)$ in which $X$ is an ep-groupoid and
$$\beta:\abs{X}\rightarrow Z$$
a homeomorphism from the orbit space $\abs{X}$ of the ep-groupoid $X$ onto $Z$.\index{polyfold! structure}
Two such polyfold structures $(X,\beta)$ and
$(X',\beta')$ are called  equivalent,
$$(X, \beta )\sim (X', \beta'),$$
if there exists a  third polyfold structure $(X'', \beta'')$ on $Z$ and two equivalences
$$
X\xleftarrow{F} X''\xrightarrow{F'} X'
$$
between the ep-groupoids satisfying
$$\beta''=\beta\circ \abs{F} = \beta' \circ \abs{F'}.$$ 

\begin{definition}
A {\bf polyfold}  is a {paracompact Hausdorff}  topological space 
$Z$ equipped with an equivalence class of polyfold structures.\index{polyfold}
\end{definition}
\begin{remark}
{In our definition we require that a polyfold is a paracompact Hausdorf space.
It is presumably enough to require $Z$ to be a topological space. It is easy to show that
$|X|$ is Hausdorff if $X$ is an ep-groupoid and this implies if $Z$ is homeomorphic to $|X|$
that $Z$ is Hausdorff. At this point it does not seem to be clear whether  $|X|$ is also paracompact 
in general. However, this knowledge is not needed for the Fredholm theory if we know
that the sc-Fredholm section is component-wise proper. We shall investigate this in more detail in \cite{HWZ10}.
There seems to be nothing lost by just requiring in the definition $Z$ to be a topological space.
However, it is important that M-polyfolds are paracompact Hausdorff spaces. In the case of an ep-groupoid
we presently do not know whether  the orbit space $|X|$, which easily is seen to be Hausdorff
as consequence of the properness assumption, has better properties, e. g. is paracompact. }
\end{remark}
In order to recall the concept of a strong bundle over a M-polyfold, we consider two sc-Banach spaces $E$ and $F$ and let $U\subset C\subset E$ be  a relatively  open subset of a partial quadrant $C$ of $E$. By $U\tl F$ we denote the space $U\oplus F$ equipped, however, with the double filtration 
$$(U\tl F)_{m,k}=U_m \oplus F_k,\qquad \text{for $m\geq 0$ and $0\leq k\leq m+1.$}$$
Associated with $U\tl F$ we have the two sc-spaces
$$U\oplus F\qquad \text{and}\qquad U\oplus F^1.$$
An {\bf sc-smooth strong bundle map}  $\Phi:U\tl F\to V\tl G$ is a map of the form 
$$\Phi (u, h)=(f(u), \phi (u, h))$$
which is linear in $h$ and for which the two maps
$$\Phi:U\oplus F^i\to V\oplus G^i,\qquad \text{$i=0$ and  $i=1,$}$$
are sc-smooth.\index{sc-smooth! strong bundle map}
\begin{definition}
An {\bf  sc-smooth strong bundle retraction}  $R:U\tl F\to U\tl F$ is an sc-smooth strong bundle map satisfying $R\circ R=R$. \index{sc-smooth! strong bundle retraction}
\end{definition}
An sc-smooth strong bundle retraction is of the form $R(u, h)=(r(u), \rho (u, h))$  where $\rho$ is linear in $h$ and $r\circ r=r$ so that $r$ is a retraction of $U\subset C\subset E$. We shall abbreviate the associated retracts by 
\begin{align*}
O&=r(U)\subset C\subset  E\\
K&=R(U\triangleleft F)\subset C\triangleleft F \subset E\triangleleft F
\end{align*}
and denote by 
$$p:K\to O, \qquad p(u, h)=u$$
the projection map. 
\begin{definition}\label{local_model_strong_bundle}
{The  sc-smooth  map $p:K\to O$ above   is called a {\bf strong local bundle model}. }
\end{definition}
The retract $K$ is equipped with the double filtration $K_{m,k}$ for $0\leq k\leq m+1$ and $p$ induces the maps $K_{m,k}\to O_m$. By definition, the retraction $R:U\oplus F\to U\oplus F$ is an sc-smooth map and we denote by $K(0)$ the associated retract equipped with the filtration $K(0)_m=K_{m,m}$. Also the retraction $R:U\oplus F^1\to U\oplus F^1$ is, by definition, an sc-smooth map and we denote by $K(1)$ the corresponding retract equipped  with the  filtration $K(1)_m=K_{m, m+1}$. The projection $p:K\to   O$ defines the two sc-smooth maps 
$$p:K(0)\to O\qquad \text{and}\qquad p:K(1)\to O.$$
Hence the bundle map $K(1)\to K(0)$ over the identity map $O\to O$  is a fiberwise compact map. This fact is a very useful tool in the perturbation theory of Fredholm sections. 
\begin{definition}
An {\bf sc-smooth section}  $f$ of the local strong bundle model $p:K\to O$ is an sc-smooth map $f:O\to K(0)$  satisfying $p\circ f=\id$, where $K(0)$ is equipped with the filtration $K(0)_m=K_{m,m}$. \index{sc-smooth! section} An {\bf $\ssc^+$-section} of $p:K\to O$ is an sc-smooth section which is also an sc-smooth map $O\to K(1)$, where $K(1)$ is equipped with the filtration $K(1)_m=K_{m,m+1}$.\index{$\ssc^+$-section}
\end{definition}

We now consider the {paracompact Hausdorff} spaces $X$ and $Y$ and assume that there exists a continuous and surjective map 
$$P:Y\to X$$
having  the property that for every $x\in X$, the preimage $P^{-1}(x)$ posses  the structure of a Banach space.

Then a {\bf strong bundle chart}  $(\Psi, V, K)$ of the bundle $P:Y\to X$ consists of an open subset $V\subset X$, a strong local bundle model $p:K\to O$ and a homeomorphism 
$\Psi:P^{-1}(V)\to K$ which covers a homeomorphism $\psi:V\to O$ and which between every fiber is a bounded linear operator of Banach spaces. \index{strong bundle! chart}
\mbox{}\\
\begin{equation*}
\begin{CD}
P^{-1}(V)@>\Psi>>K\\
@VPVV   @VVpV \\
V@>\psi>>O.\\ 
\end{CD}
\end{equation*}
\mbox{}\\


If $K\to O$ and $K'\to O'$ are two strong local bundle models, then an {\bf sc-smooth strong local bundle map} $f:K\to K'$ is of the form 
$$f(u, h)=(f_0(u), f_1(u, h)),$$
linear in $h$, where $f_0:O\to O'$ is an sc-smooth map and where $f$ induces the two sc-smooth maps 
$$f:K(i)\to K'(i)\qquad \text{for $i=0$ and $i=1$.}$$
{If the above maps $f:K(i)\to K'(i)$ for $i=0$ and $i=1$ are sc-diffeomorphisms, we call $f:K\to K'$ an {\bf sc-smooth strong local bundle diffeomorphism.}}

Two strong bundle charts are sc-smoothly compatible if the transition map is an 
sc-smooth strong local bundle diffeomorphism. 


\begin{definition}[{\bf Strong bundle over a M-polyfold}] 
The continuous surjection  $P:Y\to X$ equipped with a maximal atlas of sc-smoothly compatible strong bundle charts is called a strong bundle over the  M-polyfold $X$.\index{strong bundle! over a M-polyfold}
\end{definition}

{Since transition maps of strong bundle charts of the bundle $P:Y\to X$ are sc-smooth and hence sc-continuous, the total space $Y$ inherits a double filtration 
$$Y_{m, k}, \quad \text{for $m\geq 0$ and $0\leq k\leq m+1$.}$$
In particular we obtain the M-polyfolds $Y(0)$ and $Y(1)$ with the filtrations
 $Y(0)_m=Y_{m, m}$ and $Y(1)_m=Y_{m, m+1}$.}


An sc-smooth section of $P$ is a map $f:X\to Y$ satisfying $P\circ f=\id$. Moreover, $f(x)\in Y_{m,m}=Y(0)_m$ if $x\in X_m$ and $f:X\to Y(0)$ is sc-smooth. An {\bf $\ssc^+$-section} of $P$ is a section which satisfies $f(x)\in Y_{m, m+1}=Y(1)_m$ if $x\in X_m$ and the induced map $f:X\to Y(1)$ is sc-smooth. We shall denote these two classes of sections by $\Gamma (P)$ and $\Gamma^+(P)$, respectively.
For a detailed discussion of these concepts we refer to \cite{H2}, \cite{HWZ3.5} and \cite{HWZ7}. 

Finally,  in order to recall from \cite{HWZ3.5} (section 2.4) the notion of a strong bundle over an ep-groupoid we  start with the  ep-groupoid $X=(X, {\bf X})$ and with a strong bundle $p:E\rightarrow X$ over the object set of the ep-groupoid, and we recall the following lemma from \cite{HWZ3.5} (Lemma 2.8).
\begin{lemma}\label{ert}
Let $X$, $Y$ and $Z$ be M-polyfolds. Assume that $f:X\rightarrow Y$ is
a local sc-diffeomorphism and $g:Z\rightarrow Y$ is an $\ssc$-smooth
map. Then the fibered product
$$X{{_f}\times_g}Z=\{(x, z)\in X\times  Z\vert f(x)=g(z)\}$$
 has a natural
M-polyfold structure and the projection map
 $\pi_2:X{{_f}\times_g}Z\rightarrow Z$ is a  local
$\ssc$-diffeomorphism.
\end{lemma}
Since  the source map $s:{\bf X}\to X$ is, by definition, a local sc-diffeomorphism, the fibered product 
$$
{\bf X}{{_s}\times_p}E=\{(g,e)\in {\bf X}\times E\vert \,  s(g)=p(e)\}
$$
is an $M$-polyfold in view of the lemma above. Moreover, the bundle 
$${\bf E}:={\bf X}{{_s}\times_p}E\xrightarrow{\pi_1} {\bf X},$$
defined by the projection $\pi_1(g, e)=g$ onto the first factor is, as the pull-back of the strong $M$-polyfold bundle $p:E\to X$ by the source map $s:{\bf X}\to X$, also a strong $M$-polyfold bundle, in view of Proposition 4.11 in \cite{HWZ2}. 
{\begin{remark}
The results in \cite{HWZ2} concerning M-polyfolds and strong bundles originally assume that these spaces were build on local models 
coming from so-called splicings and bundle splicings, respectively. Splicings and bundle splicings are special examples of  
retractions and strong bundle retractions. The proofs  of the results in \cite{HWZ2}  go through without modifications for these more general retractions.
\end{remark}}

Next  we assume that there is an   {sc-smooth}  strong bundle
map  
$$\mu:{\bf E}\to E$$  covering  the target map $t:{\bf X}\to X$, so that   the diagram

\begin{equation*}
\begin{CD}
{\bf E}@>\mu>>E\\
@V\pi_1VV     @VVp V \\
{\bf X}@>t>> X\\
\end{CD}
\end{equation*}
commutes. 

We require that this {sc-smooth}  strong bundle map  $\mu:{\bf E}\to E$  has the following additional properties.
\begin{itemize}
\item[(1)]  $\mu$ is a local sc-diffeomorphism from ${\bf E}(i)$ onto $E(i)$ for $i=0,1$ and is linear on the fibers $E_x$.
\item[(2)] $\mu(1_x,e_x)=e_x$ for all $x\in X$ and $e_x\in E_x$.
\item[(3)] $\mu(h\circ g,e)=\mu(h,\mu(g,e))$ for all $e\in E$ and $g,h\in {\bf X}$ for which $s(h)=t(g)$ and $s(t)=p(e)$.
 \end{itemize}
 Actually  property (1) is a consequence of the properties (2) and (3). Indeed, the bundle map $\mu:{\bf E}\to E$ is, by definition linear and, in view of (2) and (3),  fiberwise a bijection. In order to verify that $\mu$ induces local sc-diffeomorphisms for $i=0,1$, we choose a point $(g, e)\in {\bf E}(i)$ viewed as an element of ${\bf E}$, and choose an open  neighborhood ${\bf U}\subset {\bf X}$  around $g$, so that  the restriction of the target map
 $$\tau:=t\vert{\bf U}:{\bf U}\to U:=t({\bf U})$$
 is an sc-diffeomorphism. Then $\pi_1^{-1}({\bf U})$ is an open neighborhood of $(g,e)$ in ${\bf E}$ and the restricted map 
 \begin{equation}\label{mu1}
 \mu:\pi^{-1}_1({\bf U})\to p^{-1}(U)\tag{$\ast$}
 \end{equation}
 induces the sc-smooth and bijective maps ${\bf E}(i)\vert{\bf U}\to E(i)\vert U.$ From the properties (2) and (3) again, it follows that the map 
 $$
e\mapsto \bigl(  \tau^{-1}\circ p(e),\mu([ \tau^{-1}\circ p(e)]^{-1},e)\bigr) 
$$
defined for $e\in E\vert U$,  is the inverse of the map  ($\ast$). Since it is an sc-smooth map 
$E(i)\vert U\to {\bf E}(i)\vert {\bf U}$ for $i=0,1$, the map $\mu$ is indeed a local sc-diffeomorphism and property (1) is proved. 

As proved in \cite{HWZ3.5} (section 2.4), the above two strong bundles $p:E\to X$ and $\pi_1:{\bf E}\to {\bf X}$ define, in view of the properties of the map $\mu$, the ep-groupoid 
$$E=(E,{\bf E})$$
having $E$ is its objects and ${\bf E}$ as its morphisms. The map $\mu:{\bf E}\to E$ is the target map and the projection $\pi_2:{\bf E}\to E$ onto the second factor is the source map of this ep-groupoid. This  ep-groupoid could be called a strong bundle ep-groupoid over the ep-groupoid $(X, {\bf X})$ via the functor
$$P:=(p, \pi_1):  E=(E,{\bf E})\to X=(X, {\bf X})$$
between the two ep-groupoids. 
\begin{definition}[{\bf Strong bundle over the ep-groupoid}]\label{stbundleep}
A pair $(E,\mu)$ in which  $p:E\rightarrow X$ is a strong bundle  over  the object $M$-polyfod $X$  of the ep-groupoid $(X, {\bf X})$ and $\mu:{\bf E}\to E$   is an  {sc-smooth} strong bundle map possessing 
the above properties (1)--(3) and {the commutativity condition $p\circ \mu =t\circ \pi_1$},  is called a {\bf  strong bundle over the ep-groupoid } $X=(X,{\bf X})$.\index{strong bundle! over an ep-groupoid}
 \end{definition}
 
Later on we shall sometimes refer to the above functor $P:E\to X$, which is deduced from $(E,\mu)$, as  the strong bundle over the ep-groupoid.
 Next we recall from \cite{HWZ3.5}  the notion of  a strong polyfold bundle structure for the continuous surjection map $\wh{p}:W\to Z$ between two paracompact Hausdorff 
 spaces.
 
 \begin{definition}[{\bf Strong polyfold bundle structure}]\label{stbundleep1}
 A strong polyfold bundle structure on $\wh{p}:W\to Z$ consists of a triple 
 $$(P:E\to X, \Gamma, \gamma)$$ in which $P:E\to X$ is a strong bundle over the ep-groupoid $X$ inducing the map $\abs{P}:\abs{E}\to \abs{X}$ between the orbit spaces, $\Gamma:\abs{E}\to W$ is a homeomorphism between the orbit space $\abs{E}$ and $W$, and $\gamma:\abs{X}\to Z$ is a homeomorphism  between  the orbit space $\abs{X}$  and $Z$. Further, we require that  
 $$\wh{p}\circ \Gamma=\gamma\circ \abs{P}$$
 so that the diagram
\begin{equation*}
\begin{CD}
\abs{E}@>\abs{P}>>\abs{X}\\
@V\Gamma VV @VV\gamma V \\
W@>\wh{p}>>Z\\ \\
\end{CD}
\end{equation*}
commutes. \index{strong polyfold bundle structure}
\end{definition}
 
The reader should consult \cite{HWZ3.5} for the  equivalence of strong bundle
structures over ep-groupoids.
 
\section{Polyfold Fredholm Sections of Strong Polyfold Bundles}\label{sectionpolyfred}

We next recall the notion of a (polyfold) Fredholm section from  \cite{HWZ8.7}. The notion is much more general than the classical notion of a Fredholm section. The first  property of a Fredholm section we require is  the regularization property,  which models the outcome of the elliptic regularity theory.



\begin{definition}
Let $P:Y\rightarrow X$ be  a strong M-polyfold bundle over the M-polyfold $X$.  A section $f\in\Gamma(P)$ is said to be {\bf  regularizing}  if  the following holds. If $x\in X_m$ and $f(x)\in Y_{m,m+1}$, then $x\in X_{m+1}$.\index{regularizing property of a section}
\end{definition}
We observe that if $f\in \Gamma(P)$ is regularizing and $s\in\Gamma^+(P)$,  then $f+s$ is  also regularizing.



We now consider a strong local bundle $K\rightarrow O$.
Here $K=R(U\tl F)$ is  the sc-smooth strong bundle retract  of the {sc-smooth strong bundle retraction}
$$R (u, h)=(r(u),\rho (u)h)$$
where $\rho (u):F\to F$ is a bounded linear map. Moreover, $O$ stands for the retract $O=r(U)$. We assume that $0\in O$ and we are interested in germs of sections $(f, 0)$ of the strong local bundle $K\to O$ defined near $0$. Identifying the local section germ with its principal part we view $(f,0)$ as a germ $\co (O, 0)\to F$. { Here we denote by $\co (O, 0)$ an sc-germ of open neighborhoods of $0$ in $O$ consisting  of a decreasing sequence 
$$U_0\supset U_1\supset U_2\supset \cdots \supset U_m\supset \cdots\ .$$
} of relatively open neighborhoods of $0$ in  $C \subset E$.

In the next step we introduce the useful  notion of a  filling of a  sc-smooth section germ $(f,0)$  of  a  strong local bundle $K\rightarrow O$ near the given smooth point  $0$.  
We do knot require that $f(0)=0$!. The notion of  a filling is a new concept specific to the world of retracts. In all known applications it deals successfully with bubbling-off phenomena and similar singular phenomena.




\begin{definition}[{\bf Filling}]\label{filled-def}
We consider a strong local bundle $K\to O$, where $K=R(U\triangleleft F)$  and the set $U\subset C\subset E$ is a relatively open neighborhood  of $0$ in the partial quadrant $C$ of the  sc-Banach space $E$.  Here  $F$ is a sc-Banach space and $R$ is a strong bundle retraction of the form 
$$R(u, h)=(r(u), \rho(u)(h))$$
covering the  retraction $r\colon U\to U$ onto $O=r(U)$
and $\rho (u)\colon F\to F$ is a bounded linear operator.  We also assume that $r(0)=0$. 

A sc-smooth section germ 
$(f, 0)$ of the bundle $K\to O$ possesses a  {\bf filling}
if there exists a  sc-smooth section germ $(g, 0)$ of the bundle $U\triangleleft F\to U$ extending $f$ and having  the following properties.
\begin{itemize}
\item[(1)]  $f(x)=g(x)$  for $x\in O$ close to $0$.
\item[(2)] If $g(y)=\rho (r(y))g(y)$ for a point $y\in U$ near $0$, then $y\in O$.
\item[(3)] The linearization of the map
$
y\mapsto  [\id -\rho(r(y))]\cdot g(y)
$
(which vanishes at $0$) at the point $0$, restricted to $\ker(Dr(0))$, defines a topological linear  isomorphism
$$
\ker(Dr(0))\rightarrow \ker(\rho (0)).
$$
\end{itemize}
\end{definition}
The crucial property of a filler is the fact that the 
solution sets $\{y\in O\, \vert \, f(y)=0\}$ and $\{y\in U\, \vert \, g(y)=0\}$ coincide near $y=0$. 
Indeed, if $y\in U$ is a solution of the filled section $g$ so that $g(y)=0$, then it follows from (2) that $y\in O$ and from (1) that $f(y)=0$. The section $g$ is, however, much  easier to analyze than  the section $f$,  whose domain of definition has a rather complicated structure. It turns out that in the applications these extensions $g$ are surprisingly easy to  detect. In the Gromov-Witten theory and the SFT they  seem almost canonical.

The condition (3) plays an important  role in the comparison of the linearizations $f'(0)$ and $Dg(0)$ if  $f(0)=0=g(0)$ holds, as we are going to explain next.

It  follows from the definition of a retract that
$\rho (r(y))\circ \rho (r(y))=\rho (r(y)).$ Hence, since $y=0\in O$ we have $r(0)=0$ and $\rho(0)\circ \rho(0)=\rho (0)$ so that $\rho (0)$ is a linear sc-projection in $F$ and we obtain the sc-splitting
$$
F=\rho (0)F\oplus (\id -\rho (0))F.
$$
Similarly, it follows from $r(r(y))=r(y)$ for $y\in U$ that $Dr (0)\circ Dr (0)=Dr(0)$ so that $Dr (0)$ is a linear sc-projection in $E$ which gives rise to the sc-splitting
$$\alpha \oplus \beta \in  E=Dr (0)E\oplus (\id -Dr (0))E.$$
We recall that the linearization $f'(0):T_0O\rightarrow K_0$ of the section $f\colon O\to K$ at $y=0=r(0)$ (assuming $f(0)=0$)  is defined as the restriction of the derivative
$D(f\circ r)(0)$  of the map $f\circ r\colon U\to F$ to $T_0O$. We note that it takes its image in $K_0=\ker(Id-\rho(0))=\rho(0)F$,  and that we have
the identity
$T_0O=Dr(0)E$.
 From $\rho (r(y))f(r(y))=f(r(y))$ for $y\in U$  close to $0$,  we obtain, using $f(0)=0$,  by linearization 
at $y=0$ the relation $\rho (0)Df(0)=Df(0)$. From $g(r(y))=f(r(y))=f(r(r(y))$ for $y\in U$ near $0$ we deduce 
$$
Dg(0)\circ Dr(0)=f'(0)\circ Dr(0)
$$
and therefore $Dg(0)|T_0O=f'(0):Dr(0)E\rightarrow \rho(0)F$.
 From the identity
 \begin{gather*}
(\id -\rho (r(y))g(r(y))=0\quad \text{for all $y\in U,$}
\end{gather*}
we deduce, using $g(0)=0$, the relation
$(\id -\rho (0))Dg (0)\circ Dr(0)=0$. 
Hence  the matrix representation of $D g (0)\colon E\to F$ with respect to the above splittings of $E$ and $F$ looks as follows,$$
Dg(0)\begin{bmatrix}\alpha \\ \beta
\end{bmatrix}=
\begin{bmatrix}f'(0)&\rho (0)Dg(0)(\id-Dr(0))\\0&(\id -\rho (0)) Dg (0)(\id-Dr(0))\end{bmatrix}\cdot
\begin{bmatrix}\alpha\\ \beta
\end{bmatrix}.
$$
In view of property (3), the linear map $\beta \mapsto (\id -\rho (0))\circ Dg (0)(\id-Dr(0))\beta$ from $(\id -Dr (0))E$ to $(\id -D\rho(0))F$ is an isomorphism of Banach spaces. Therefore, 
$$
\ker (Dg (0))=\ker(Df (0))\oplus \{0\}.$$
Moreover the filler has the following additional properties assuming $f(0)=0$.

{\begin{proposition}[{\bf Filler}]\label{filler_new_1}\mbox{}
\begin{itemize}
\item[(1)] The operator $f'(0)\colon Dr(0)E\to \rho (0)F$ is surjective if and only if the operator $Dg(0)\colon E\to F$ is surjective.
Further $\ker(f'(0))=\ker(Dg(0))$.
\item[(2)] $f'(0)$  is a Fredholm operator (in the classical sense) if and only if $Dg(0)$ is a Fredholm operator and $\ind f'0)=\ind Dg(0)$.
\end{itemize}
\end{proposition}
\begin{proof}
(1)\, We assume that $f'(0)$ is surjective and let $\gamma \in F$. Since the operator $(\id-\rho (0))Dg(0)(\id-Dr(0))\colon (\id-Dr(0)E\to (\id-\rho (0))F$ is an isomorphism, we find $\beta\in (\id-Dr(0)E$ satisfying $(\id-\rho (0))Dg(0)\beta=(\id-\rho (0))\gamma$. As $f'(0)$ is surjective, there exists $\alpha\in Dr(0)E$ satisfying $f'(0)\alpha=\rho(0)\gamma-\rho (0)Dg(0)\beta$. Therefore,
\begin{equation*}
\begin{split}
Dg(0)(\alpha+\beta)&=f'(0)\alpha+\rho(0)Dg(0)\beta+(\id-\rho (0))Dg(0)\beta\\
&=\rho(0)\gamma+(\id-\rho (0))\gamma=\gamma,
\end{split}
\end{equation*}
showing that $Dg(0)$ is surjective.\\[0.5ex]
Conversely, assuming that  $Dg(0)\colon E\to F$ is surjective, we let $\gamma \in \rho (0)F$ and find $\alpha+\beta\in Dr(0)E\oplus (\id-Dr(0))E$ solving $Dg(0)(\alpha+\beta)=\gamma.$
Since $\gamma \in \rho (0)F$, we have 
$(\id-\rho(0))Dg(0)(\alpha+\beta)=0$. From $(\id-\rho(0))Dg(0)\beta=0$ we conclude $\beta=0$ and hence $(\id-\rho(0))Dg(0)\alpha =0$. Therefore, $Dg(0)(\alpha+0)=\rho (0)Dg(0)\alpha=f'(0)\alpha=\gamma$, proving that $f'(0)$ is surjective.\\

Assume that $(\alpha,\beta)\in \ker(Dg(0))$. Then $\beta=0$ since $\beta \mapsto (\id -\rho (0))\circ Dg (0)(\id-Dr(0))\beta$ is an isomorphism.
This  implies that $f'(0)\alpha=0$. If on the other hand $f'(0)\alpha=0$, then it is immediate that $(\alpha,0)\in\ker(Dg(0))$.\\[0.5ex]

(2)\, To simplify the notation we abbreviate the above matrix representing $Dg(0)$ by 
$$
Dg(0)=\begin{bmatrix}A&B\\0&C\end{bmatrix}
$$
and abbreviate the above splittings by $E=E_0\oplus E_1$ and $F=F_0\oplus F_1$.
The operators in the matrix are bounded between corresponding Banach spaces and $C\colon E_1\to F_1$ is an isomorphism of Banach spaces. Therefore, if $B=0$, the operator $A=f'(0)\colon E_0\to F_0$ is Fredholm if and only if the operator 
$$\begin{bmatrix}
A&0\\0&C\end{bmatrix}\colon E\to F
$$
is Fredholm in which case their indices agree. The statement now follows from the composition formula
$$
\begin{bmatrix}
\id&BC^{-1}\\
0&\id
\end{bmatrix}
\begin{bmatrix}
A&0\\
0&C
\end{bmatrix}=
\begin{bmatrix}
A&B\\
0&C
\end{bmatrix}
$$
since the first factor is an isomorphism from $E$ to $F$, and hence has index equal to $0$ and the Fredholm indices of a composition are additive. This completes the proof of Proposition \ref{filler_new_1}
\end{proof}





To sum up the role of a filler, instead of studying the solution set of the section $f\colon O\to K$ we can as well study the solution set of the filled section $g\colon U \to U\triangleleft F$, which is defined on the relatively open set $U$ of the partial quadrant $C$ in the sc-space $E$ and easier to analyze.






\begin{proposition}\label{prop2.28}
If  the section  germ  $(f,0)$ of the strong local bundle $K\to O$ has the  filled version $(g,0)$, then the section germ  
$(f+s, 0)$ has the filled version $(g+s\circ r, 0)$ for every $\ssc^+$-section  $s$ of the bundle $K\rightarrow O$.
\end{proposition}

\begin{proof}
We show  that if $t$ is the $\ssc^+$-section of $U\tl F\to F$ defined by $t(y)=s(r(y))$, then 
$(g+t, 0)$ is a filled version of $(f+s, 0)$. In order to verify property (1) for $g+t$ we take $x\in O$ and  obtain, using $r(x)=x$, that $(g+t)(x)=g(x)+s(r(x))=f(x)+s(x)$ which is property (1).

If  $(g+t)(y)=\rho(r(y))(g+t)(y)$ for some $y\in U$, we  conclude, using $\rho (r(y))t(y)=t(y)$, that 
$g(y)=\rho (r(y))g(y)$. Therefore, $y\in O$ by property (2) of $g$. 
Finally, using $[\id -\rho(r(y))]t(y)=0$,  we obtain
$$
[\id-\rho(r(y))](g(y)+t(y))=[\id-\rho(r(y))]g(y).
$$
Hence, in view of property (3) for $g$,  the linearisation of the left-hand side at $y=0$,  if restricted to  the kernel of $Dr(0)$,  satisfies the property (3) for  $g+t$.  
\end{proof}



Next  we introduce a class of so-called basic germs denoted by
$\mathfrak{C}_{basic}$.
\begin{definition}[{\bf Basic germ}]
An element in $\mathfrak{C}_{basic}$ is an sc-smooth germ
$$
f:{\mathcal O}({\mathbb R}^n\oplus W,0)\rightarrow ({\mathbb R}^N\oplus W,0),
$$
where $W$ is an sc-Banach space, so that  if $P:{\mathbb R}^N\oplus W\rightarrow W$  denotes  the projection, then the  germ $P\circ f:{\mathcal O}({\mathbb R}^n\oplus W,0)\rightarrow (W, 0)$ has the form
$$
P\circ f(a,w)=w-B(a,w)
$$
for $(a,w)$ close to $(0,0)\in {\mathbb R}^n\oplus W_0$. Moreover, for every $\varepsilon>0$ and $m\geq 0$,  we have the estimate
$$
\abs{B(a,w)-B(a,w')}_m\leq \varepsilon\cdot\abs{w-w'}_m
$$
for all $(a,w)$, $(a,w')$ close to $(0,0)$ on level $m$.\index{$\ssc^0$-contraction germ}
\end{definition}

We are in the position to define the notion of a Fredholm germ.
\begin{definition}
Let $P:Y\rightarrow X$ be a strong bundle, $x\in X_\infty$, and
$f$ a germ of an sc-smooth section of $P$ around $x$. We call $(f,x)$ a {\bf Fredholm germ}  provided there exists a germ of $\ssc^+$-section $s$ of $P$ near $x$ satisfying
$s(x)=f(x)$ and such that  in suitable strong bundle coordinates mapping $x$ to $0$, the  push-forward  germ $g=\Phi_\ast(f-s)$ around $0$ has a filled version
$\ov{g}$ so that the germ $(\ov{g},0)$ is equivalent  to a germ belonging to  $\mathfrak{C}_{basic}$.\index{Fredholm germ}
\end{definition}

Let us observe that tautologically if $(f,x)$ is a Fredholm germ
and $s_0$ a germ of $\ssc^+$-section around $x$, then $(f+s_0,x)$ is a Fredholm germ as well. Indeed,  if $(f-s,0)$ in suitable coordinates has a filled version with the desired properties, then $((f+s_0)-(s+s_0),0)$ has the same filled version.

Finally,  we can introduce the Fredholm sections of  strong M-polyfold bundles.
\begin{definition}
Let $P:Y\rightarrow X$ be a strong M-polyfold bundle and $f\in\Gamma(P)$ an sc-smooth section. The section $f$ is called a {\bf  polyfold Fredholm section}  provided  it has the following properties:
\begin{itemize}
\item[(1)] $f$ is regularizing.
\item[(2)] At every smooth point $x\in X$,  the germ $(f,x)$ is a Fredholm germ.\index{polyfold! Fredholm section}
\end{itemize}
\end{definition}
If $(f,x)$ is a Fredholm germ and $f(x)=0$,  then the  linearisation $f'(x):T_xX\rightarrow T_{f(x)}Y$ is a linear sc-Fredholm operator. The proof can be found in \cite{HWZ3}.
If,  in addition,  the linearization $f'(x):T_xX\rightarrow  T_{f(x)}Y$ is surjective, then our implicit function theorem gives a natural smooth structure on the solution set of $f(y)=0$ near $x$ as the following theorem from \cite{HWZ3} shows.
\begin{theorem}
Assume that $P:Y\rightarrow X$ is a strong M-polyfold bundle and  let $f$ be a  Fredholm section of the bundle $P$. If the point $x\in X$ solves $f(x)=0$ and if the linearization  at this point $f'(x):T_xX\rightarrow T_{f(x)}Y$ is surjective,  there exists an open neighborhood $U$ of $x$ so that the solution set
$$
S_U:=\{y\in U\vert \ f(y)=0\}
$$
has in a natural way a smooth manifold structure induced from $X$. In addition, $S_U\subset X_\infty$.
\end{theorem}





\section{Gluings and Anti-Gluings}\label{gluinganti-sect}


In this section we carry out the  gluing and anti-gluing constructions for maps from conformal cylinders into $\R^{2n}$.  We start with the formal aspects of these  constructions for continuous maps. For this part we can use any gluing profile, however, to prove sc-smoothness of the expressions for gluing and anti-gluing it will be  important to use 
the {\bf exponential  gluing profile}  given by 
$$\varphi (r)=e^{1/r}-e, \quad r\in (0, 1].$$




We first introduce the  domains on which the glued and anti-glued maps will be defined. 
Let $a\in \hb \subset \C$  be  the disk of radius $\frac{1}{2}$.  
If $a=0$,  we define the set $Z_0$ as the disjoint union of two  half-cylinders
$$
Z_0=({\mathbb R}^+\times S^1)\bigsqcup ({\mathbb R}^-\times S^1).
$$
If $a\neq 0$,  we represent $a$ as  $a=\abs{a}\cdot e^{-2\pi i \vartheta}$
and define the gluing length $R$ by means of the gluing profile as 
$$R =\varphi(\abs{a}).\index{gluing!length}$$
Now we introduce the  abstract  infinite cylinder $C_a$.  We  take the disjoint union of  the half-cylinders $\R^+\times S^1$ and $\R^-\times S^1$ and identify the  points $(s,t)\in [0,R]\times S^1$ with  the points $(s',t')\in [-R,0]\times S^1$  if they satisfy the  relation
$$
s=s'+R\quad \text{and}\quad t=t'+\vartheta.
$$



\begin{figure}[htbp]
\psfrag  {a1}{$(s', t')$}
\psfrag  {a2}{$(s,t)$}
\psfrag {a3}{$[s,t]$}
\psfrag  {a}{$\R^-\times S^1$}
\psfrag {b}{$\R^+\times S^1$}
\psfrag {c}{$C_a$}
\psfrag {01}{$0$}
\psfrag {02}{$0$}
\psfrag  {r1}{$R$}
\psfrag  {mr1}{$-R$}
\centering
\includegraphics[width=3.8in]{Fig9.eps}
\caption{Glued  infinite cylinders $C_a$.}
\label{Fig9}
\end{figure}

This identification  is compatible with the standard conformal structure on the cylinders. There are two global conformal coordinates
on $C_a$ defined by
\begin{align*}
&C_a\rightarrow {\mathbb R}\times S^1, \quad [s,t]\mapsto (s,t),\\
\intertext{and}
&C_a\rightarrow {\mathbb R}\times S^1,  \quad [s',t']'\mapsto (s',t').
\end{align*}
The first coordinates are  the extension of the  coordinates  $(s,t)$ for $s\geq 0$  and the second are  the extension of the coordinates  $(s', t')$ for $s'\leq 0$. 
Clearly, if  $[s,t]=[s',t']'$, then  $s=s'+R$ and $t=t'+\vartheta.$
The infinite cylinder $C_a$ contains the finite  sub-cylinder $Z_a$ defined by 
$$Z_a=\{[s, t]\vert\  (s, t)\in [0, R]\times S^1\}=\{[s', t']'\vert \ (s', t')\in [-R, 0]\times S^1\}.$$
 
 
 \begin{figure}[htbp]
\psfrag {01}{$0$}
\psfrag {02}{$0$}
\psfrag {a1}{$(s', t')$}
\psfrag {a2}{$(s,t)$}
\psfrag {a3}{$[s,t]$}
\psfrag  {mr1}{$-R$}
\psfrag {r1}{$R$}
\psfrag {a}{$\R^-\times S^1$}
\psfrag {b}{$\R^+\times S^1$}
\psfrag {c}{$Z_a$}
\centering
\includegraphics[width=3.8in]{Fig10.eps}
\caption{Glued  finite cylinders $Z_a$.}
\label{Fig10}
\end{figure}

One  should think of the coordinates $(s, t)\in \R^+\times S^1$ and $(s', t')\in \R^-\times S^1$
as holomorphic polar coordinates on the annuli $D_x\setminus \{x\}$ and $D_y\setminus \{y\}$ in 
the disks of the small disk structure belonging to the nodal pair  $\{x,y\}$. In this case  the gluing  parameter $a=a_{\{x, y\}}$  described in Section \ref{dm-subsect} defines  the neck region $Z_{a_{\{x, y\}}}^{\{x, y\}}$.
The infinite cylinder $C_a$ will be used to describe data which otherwise would be lost during the gluing process. This is not too important for the Deligne-Mumford theory but  it is crucial once we consider maps defined on  the Riemann surfaces. {For the gluing parameter  $a=0$ we define
$$C_0=\emptyset.$$
Observe that given any codomain $A$ there is precisely one map $\emptyset \rightarrow A$. }

In order to define the gluing and anti-gluing construction for maps we need to fix additional data. We choose 
a smooth cut-off function $\beta:{\mathbb R}\rightarrow [0,1] $ having the following properties:
\begin{equation}\label{properties_beta_1}
\begin{aligned}
\bullet &\:\:\beta (-s)+\beta (s)=1\quad \text{for all $s\in \R$}\\
\bullet &\:\:\beta (s)=1\quad \text{for all $s\leq -1$}\\
\bullet &\:\:\beta'(s)<0\quad \text{for all $s\in (-1, 1)$}.
\end{aligned}
\end{equation}


If $a\in \C$ is a gluing parameter and $R=\varphi (\abs{a})$ the associated gluing length,  we introduce the translated function  $\beta_a=\beta_R:\R\to \R$ defined by 
\begin{equation}\label{translation_function}
\beta_a (s):=\beta \biggl( s-\frac{R}{2}\biggr).
\end{equation}

In order to  define the basic ${\mathbb R}^{2n}$-gluing $\oplus_a$, we take  a pair  $(u^+,u^-)$ of continuous maps 
$$u^{\pm}:{\mathbb R}^\pm\times S^1\rightarrow {\mathbb R}^{2n}
$$
satisfying
$$
\lim_{s\to \infty} u^\pm(s,t)=:u^{+}(\infty )=u^{-}(-\infty ):=\lim_{s\to  -\infty} u^-(s, t)
$$
uniformly in $t$.   We call the constant $c:=u^+(\infty )=u^-(-\infty )$ the common asymptotic constant of the pair $(u^-, u^+)$ and we say that $u^\pm$ possess  asymptotic matching conditions. 
For such a pair of maps we define the glued map 
$$\oplus_a(u^+,u^-):Z_a\to \R^{2n}$$
for a gluing parameter $a$  as follows. 
If $a=0$, we define
$$\oplus_0(u^+, u^-):=(u^+, u^-):Z_0\to \R^{2n}.$$
If $0<\abs{a}\leq \frac{1}{2}$,  we define 
\begin{equation*}
\oplus_a(u^+,u^-)([s,t])=\beta_a (s)\cdot u^+(s, t)+(1-\beta_a(s))\cdot u^-(s-R, t-\vartheta).\index{nonlinear  ${\mathbb R}^{2n}$-gluing $\oplus_a$}
\end{equation*}
We will always  use  the coordinates $[s,t]$  on $Z_a$ for $a\neq 0$. The formula in the coordinates $[s',t']'$ looks similar. The above procedure  is a ``nonlinear gluing'' of maps into ${\mathbb R}^{2n}$. We shall  see  below how to replace ${\mathbb R}^{2n}$ by a manifold.




Fixing a pair $(u^+, u^-)$ of maps as above, we shall define the glued and anti-glued maps  for pairs of vector fields  $(h^+, h^-)$ along the pair  $(u^+, u^-)$ of curves  so that 
$h^\pm (s,t)\in T_{u^{\pm}(s,t)}{\mathbb R}^{2n}={\mathbb R}^{2n}$.\index{gluing of vector fields}
We denote by $E$  the vector space of pairs $(h^+, h^-)$ of continuous maps 
$$h^{\pm}:{\mathbb R}^\pm\times S^1\rightarrow {\mathbb R}^{2n}$$
satisfying 
$$\lim_{s\to  \infty}h^{+}(s, t)=:h^+(\infty)=h^-(-\infty ):=\lim_{s\to  -\infty}h^{-}(s, t)$$
uniformly in $t$,  where $h^{\pm}(\pm \infty)$ are the asymptotic  constants  in $ \R^{2n}$. 
For a pair $(h^+, h^-)\in E$, we define the glued vector field  $\oplus_a(h^+, h^-):Z_a\to \R^{2n}$  by the same formulae  as before. Namely, if 
$a=0$, we set 
$$\oplus_0(h^+, h^-)=(h^+, h^-), $$
and if $0<\abs{a}<\frac{1}{2}$,  we define
$$\oplus_a(h^+, h^-)([s, t])=\beta_a(s)\cdot h^+(s, t)+(1-\beta_a(s))\cdot h^-(s-R, t-\vartheta).$$
We may view $\oplus_a(h^+, h^-)$ as a  vector field along the glued map $\oplus_a(u^+,u^-)$. If  $\exp$ is  the exponential map on $\R^{2n}$ with respect to the Euclidean
metric, then, given the  pair of vector fields $(h^+, h^-)\in E$ along the pair $(u^+, u^-)$, so that  
$$
\exp_{(u^+,u^-)}(h^+,h^-)=(u^ ++h^+,u^- +h^-), 
$$
we obtain  the  formula,
\begin{equation}\label{exp-formula}
\oplus_a(\exp_{(u^+,u^-)}(h^+,h^-)) =
\exp_{\oplus_a(u^+,u^-)}(\oplus_a(h^+,h^-)).
\end{equation}

Next we introduce the operation of anti-gluing for vector
fields.\index{anti-gluing of vector fields}
The anti-glued vector field  
$$
\ominus_a(h^+,h^-):C_a \rightarrow \R^{2n}
$$
is defined as  follows.  {If $a=0$, we set 
$$\ominus_a(h^+,h^-)=0.$$ 
Here $0$ is the unique map $\emptyset\rightarrow {\mathbb R}^{2n}$.}
If $0<\abs{a}<\frac{1}{2}$,  we define
\begin{equation*}
\begin{split}
\ominus_a (h^+,h^-)([s,t])&=-(1-\beta_a(s))\cdot [ h^+(s,t)-\av_a(h^+, h^-)]\\
&\phantom{=\ }+\beta_a(s)\cdot[ h^-(s-R,t-\vartheta)-\av_a(h^+, h^-)].
\end{split}
\end{equation*}
The average is the number 
$$
\av_a(h^+, h^-):=\frac{1}{2}\left(  [h^+]_R+[h^-]_R\right) 
$$
where
$$
 [h^\pm ]_R:=\int_{S^1} h^{\pm} \left (\pm \frac{R}{2}, t\right)\  dt.
$$
The anti-glued map possesses  antipodal asymptotic constants, 
$$
\ominus_a(h^+,h^-)(-\infty)=-\ominus_a(h^+,h^-)(+\infty).
$$
\begin{remark}\label{verynewremark1}
Let us summarize the above discussion. The gluing and anti-gluing constructions will be later on implanted  into the manifold setting. The following view point about the  
$\R^{2n}$-case will be useful. 
One fixes a smooth pair $(u^+_0, u^-_0)$ with vanishing asymptotic constant. We refer to   $(u^+_0, u^-_0)$  as the base pair.  We consider nearby pairs $(u^+, u^-)$ with  matching asymptotic constants. For these pairs the nonlinear gluing  is defined. Moreover,  the nearby pairs $(u^+, u^-)$ can be expressed, using the exponential map $\exp$ on $\R^{2n}$,  as  
$$\exp_{(u^+_0, u^-_0)}(h^+, h^-)=(u_0^++h^+, u_0^-+h^-)$$
for some pair of vector fields $(h^+, h^-)$ along $ (u^+_0, u^-_0).$ For vector fields $(h^+, h^-)$ along the base pair $(u^+_0, u^-_0)$,  the linear gluing $\oplus_a (h^+, h^-)$ is defined and  produces a vector field along the glued base pair $\oplus_a (u^+_0, u^-_0)$. 
In addition, the following holds
\begin{equation*}
\oplus_a(\exp_{(u_0^+,u_0^-)}(h^+,h^-)) =
\exp_{\oplus_a(u_0^+,u_0^-)}(\oplus_a(h^+,h^-)).
\end{equation*}
The negative gluing $\ominus_a (h^+, h^-)$  of a pair of vector fields $(h^+, h^-)$  takes values in the tangent space $T_0\R^{2n}$ of $\R^{2n}$ at $0$,  where $0$ is the common asymptotic limit of the base pair  $(u^+_0, u^-_0)$. 
\end{remark}

The gluing constructions introduced above are intimately related  to  the concept of
splicing as we shall describe next. 

Recall that  we have denoted by  $E$  the  space of pairs  of continuous vector fields $(h^+, h^-)$ along $(u^+,u^-)$ satisfying  the asymptotic matching conditions 
$h^+(\infty )=h^-(-\infty)$.  We introduce the space  $E^a_+$ consisting of continuous maps $v:Z_a\to \R^{2n}$ and the space
$E^a_{-}$  consisting of continuous maps $w:C_a\to \R^{2n}$  satisfying $w(-\infty)=-w(\infty)$. 
We define,  for $0<\abs{a}<\frac{1}{2}$,  the {\bf  total glued map}  $\boxdot_a :E\to E^a_+\oplus E^a_{-}$ 
by 
$$\boxdot_a(h^+, h^-)=\left(\oplus_a (h^+, h^-), \ominus_a (h^+, h^-)\right).$$
If $a=0$,   the map $\boxdot_0:E\to  E=E\oplus\{0\}$ is defined  by 
$$\boxdot_0(h^+, h^-)=((h^+, h^-),0).\index{total glued map  $\boxdot_a$} $$
\begin{lemma}\label{direct-lem} 
The map  $\boxdot_a:E\to E^a_+\oplus E^a_{-}$ is an isomorphism. 
\end{lemma}
In order to  prove the lemma we take a pair $(v, w)\in E^a_+\oplus E^a_{-}$ and solve the system of two equations for $(h^+, h^-)$,
\begin{equation}\label{system1}
\oplus_a (h^+, h^-)=v\quad \text{and}\quad \ominus_a (h^+, h^-)=w.
\end{equation}
The first equation is defined for the  points $[s,t]\in Z_a$ and the second for all points $[s,t]\in C_a$.
Integrating  the first equation over the circle $\{\frac{R}{2}\}\times S^1$, we find that 
$$
\av_a(h^+,h^-)=   \frac{1}{2}\left( [h^+]_R+[h^-]_R\right)=[v]:=\int_{S^1} v\left(\frac{R}{2},t\right)\ dt .
$$
It will be convenient to introduce the so called {\bf hat version of the gluing and anti-gluing}. If  $(h^+, h^-)\in E$, 
we define 
$$\wh{\oplus}_a(h^+, h^-):=\oplus_a (h^+, h^-)$$
and
$$\wh{\ominus}_a (h^+, h^-)[s,t]=-(1-\beta_a)\cdot h^+ (s, t)+\beta_a \cdot h^- (s -R, t -\vartheta)$$
where we have abbreviated $\beta_a=\beta_a(s)$. 
The relation between $\ominus_a (h^+, h^-)$ and $\wh{\ominus}_a(h^+, h^-)$ is  the following,
$$\ominus_a(h^+, h^-)=\wh{\ominus}_a(h^+, h^-)-\wh{\ominus}_a ([v], [v])=\wh{\ominus}_a(h^+, h^-)-(2\beta_a-1)[v]$$
where we have used that  $[v]= \av_a(h^+,h^-)$.
In view of  the hat anti-gluing, the second equation in  \eqref{system1} can be rewritten as
\begin{equation*}
\wh{\ominus}_a(h^+, h^-)=w+(2\beta_a-1)[v]=:\wh{w}
\end{equation*}
so that  the two equations in  \eqref{system1} take the form,
\begin{equation*}
\wh{\oplus}_a(h^+, h^-)=v\quad \text{and}\quad \wh{\ominus}_a(h^+, h^-)=\wh{w},
\end{equation*}
or, in the matrix form,  
\begin{equation}\label{system2}
\begin{bmatrix}
\phantom{-}\beta_a&1-\beta_a\\
-(1-\beta_a)&\beta_a
\end{bmatrix}\cdot
\begin{bmatrix}
h^+ (s, t)\\   h^-(s-R, t-\vartheta)\end{bmatrix}=
\begin{bmatrix}
v(s, t)\\ \wh{w}(s, t)\end{bmatrix}.
\end{equation}
Observe that the second equation $\wh{ \ominus}_a(h^+, h^-)=\wh{w}$  determines $h^+$ for $s\geq \frac{R}{2}+1$ and $h^-$ for $s\leq \frac{R}{2}-1$. Indeed, in view of the properties of the cut off functions $\beta_a$, 
\begin{align*}
h^+(s, t)&=-\wh{w}[s,t]=-w([s,t])+[v], \quad s\geq \frac{R}{2}+1\\
h^-(s-R, t-\vartheta)&=\wh{w}([s, t])=w([s,t])+[v], \quad s\leq \frac{R}{2}-1.
\end{align*}
We conclude that  the asymptotic constant  $h^+(\infty)$ of $h^+$ is equal to $-w(\infty)+[v]$ and  the asymptotic constant $h^-(-\infty)$ of $h^-$ is equal to $w(-\infty)+[v]$. 
Since, by assumption $w(-\infty)=-w(\infty)$, we conclude  
$$h^+(\infty)=h^-(-\infty).$$

Abbreviating by $\gamma_a:=\beta_a^2+(1-\beta_a)^2$ the determinant of the square matrix on the left-hand side above,  we find for the unique solutions  $h^\pm$  the formulae 
\begin{equation}\label{system3p}
h^+(s, t)=\frac{1}{\gamma_a}\left( \beta_a \cdot v(s, t)-(1-\beta_a)\cdot \wh{w}(s, t)\right)
\end{equation}
 for  $s\geq 0$ and $t\in S^1$,   and 
\begin{equation}\label{system3m}
h^-(s-R, t -\vartheta)=\frac{1}{\gamma_a}\left( (1-\beta_a)\cdot  v(s, t)+\beta_a\cdot \wh{w}(s, t)\right)
\end{equation}
 for $s\leq R$ and $t\in S^1$. Since $h^\pm$ have identical asymptotic constants, the pair
$(h^+, h^-)$ belongs to the space $E$. This completes the proof that  the map $\boxdot_a:E\to E^a_+\oplus  E^a_{-}$ is an isomorphism. \hfill $\blacksquare$


The injectivity of $\boxdot_a$ implies $(\ker \oplus_a )\cap (\ker \ominus_a )=\{(0, 0)\}$ and the surjectivity shows that 
$E=\ker \oplus_a \oplus  \ker \ominus_a $. Consequently, the space $E$ has the decomposition
\begin{equation}\label{decomp}
E=(\ker \oplus_a )\oplus (\ker \ominus_a ).
\end{equation}
We now introduce the projection 
$$\pi_a:E\rightarrow E$$
 onto $\ker \ominus_a$ along $\ker \oplus_a$.  If $a=0$, we set $\pi_0=\id$. Using our calculations  above we shall  derive a formula for this projection in the case $a\neq 0$.  Given a pair 
 $(h^+, h^-)\in E$,   we  set 
$$\pi_a (h^+,h^-)=(\eta^+,\eta^-).$$
In view of the decomposition \eqref{decomp}, the pair $(\eta^+,\eta^-)$ is uniquely determined by the requirement
$$
\oplus_a(\eta^+,\eta^-)=\oplus_a(h^+,h^-)\quad \text{and}\quad \ominus_a(\eta^+,\eta^-)=0.
$$
Setting $v=\oplus_a(h^+, h^-)$ and $w=0$,   the system of equations  \eqref{system1} takes the form 
$$
\oplus_a(\eta^+,\eta^-)=v\quad \text{and}\quad \ominus_a(\eta^+,\eta^-)=0
$$
and we find,  in view of \eqref{system3p}, 
\begin{equation}\label{sol1}
\eta^+=\frac{1}{\gamma_a}\left[ \beta_a\cdot  v-(1-\beta_a)\cdot \wh{w}\right]
\end{equation}
where $\wh{w}=(2\beta_a-1)[v]$  and  $[v]$ is equal to 
$$[v]=\int_{S^1}v \left(\frac{R}{2}, t\right)\ dt= \frac{1}{2}\left(  [h^+]_R+ [h^-]_R\right) =\av_a (h^+, h^-).$$ 
Substituting $\oplus_a(h^+, h^-)$ for $v$  and $(2\beta_a-1)[v]$ for $\wh{w}$ into  the equation  \eqref{sol1}, we obtain the explicit formula
\begin{equation}\label{eta-plus}
\begin{split}
\eta^+(s, t)&=\frac{1}{\gamma_a}\left( \beta_a\cdot  \oplus_a(h^+, h^-)(s, t) -(2\beta_a-1)(1-\beta_a)[v]\right)\\
&=\left(1-\frac{\beta_a}{\gamma_a}\right)\cdot \av_a(h^+, h^-) +\frac{\beta_a^2}{\gamma_a}\cdot h^+(s, t)\\
&\phantom{=}+ \frac{\beta_a (1-\beta_a)}{\gamma_a}\cdot h^-(s-R, t -\vartheta)
\end{split}
\end{equation}
for $(s, t)\in \R^+\times S^1$.  We have abbreviated $\beta_a=\beta_a(s)$ and $\gamma_a=\gamma_a(s)$. 
A similar calculation uses \eqref{system3m} and leads to the  following formula for $\eta^-$,
\begin{equation*}
\begin{split}
\eta^-(s-R, t-\vartheta)&=\left( 1-\frac{1-\beta_a}{\gamma_a}\right)\cdot \av_a (h^+, h^-)  +\frac{\beta_a (1-\beta_a)}{\gamma_a}\cdot h^+(s, t)\\
&\phantom{==}+\frac{(1-\beta_a)^2}{\gamma_a}h^-(s -R,t-R)
\end{split}
\end{equation*}
for $(s, t)$ satisfying $s\leq R$. 
To express $\eta^-$ is terms of  the coordinates $(s', t')$ on $\R^-\times S^1$, we note that from  $\beta (s)=1-\beta (-s)$ and $\beta_a (s)=\beta (s-\frac{R}{2})$ and $\gamma_a=\beta_a^2+(1-\beta_a)^2$, it follows that 
$\beta_a (s'+R)=1-\beta_a (-s')\quad \text{and}\quad \gamma_a (s'+R)=\gamma_a (-s').$
Consequently,
\begin{equation}\label{eta-minus}
\begin{split}
\eta^-(s', t')&=\left( 1-\frac{\beta_a (- s')}{\gamma_a (-s')}\right)\cdot \av_a (h^+, h^-)\\
&\phantom{}  +\frac{\beta_a (-s' ) (1-\beta_a (-s' ))}{\gamma_a(-s' )}\cdot h^+(s'+R, t' +\vartheta) +\frac{\beta_a (-s' )^2}{\gamma_a(-s' )}h^-(s', t')
\end{split}
\end{equation}
for $(s', t')\in \R^-\times S^1$. 


We next  study  the above constructions  in the analytical framework of
weighted  Sobolev spaces.  For these studies  it is  crucial to  use  the exponential gluing profile
$$\varphi (r)=e^{\frac{1}{r}}-e, \quad r\in (0, 1].$$




We fix   a strictly increasing sequence $(\delta_m)_{m\geq 0}$  satisfying 
$0<\delta_m<2\pi$ for all $m\geq 1$. If $m\geq 0$,  the space $E_m^\pm=H^{3+m,\delta_m}(\R^\pm \times S^1)$ 
consists of $L^2$-maps 
$$u:\R^\pm \times S^1\to \R^{2n}$$
whose  weak partial derivatives $D^{\alpha}u$   up to order $3+m$ belong,   if weighted by $e^{\delta_m \abs{s}}$,   to the space $L^2(\R^\pm \times S^1)$ so that  $e^{\delta_m \abs{s}} D^{\alpha}u\in L^2(\R^\pm \times S^1)$ for all $\abs{\alpha}\leq 3+m$. 
The space $E_m$ consists  of pairs $(u^+, u^-)$ of maps defined on half-cylinders
$$u^\pm :\R^\pm \times  S^1\to \R^{2n}$$
for which there is a constant  $c\in \R^{2n}$ (depending on $(u^+, u^-)$)  so that 
$$u^\pm -c\in E^\pm_m.$$
If $(u^+, u^-)\in E_m$, then $u^\pm=c+r^\pm$ and its $E_m$-norm is defined by 
$$\abs{(u^+, u^-)}^2_{E_m}=\abs{c}^2+\norm{r^+}^2_{3+m,\delta_m}+\norm{r^-}_{3+m,\delta_m}^2$$
where
$$\norm{r^\pm}^2_{3+m,\delta_m}=\sum_{\abs{\alpha}\leq m+3}\int_{\R^\pm \times S^1}\abs{D^{\alpha}r^\pm (s, t)}^2e^{2\delta_m \abs{s}}\ ds dt.$$
Since the sequence $(\delta_m)$ is {strictly}  increasing, it follows from the Sobolev embedding theorem  that the inclusions $E_{m+1}\to E_m$ are compact maps and the vector space $E_{\infty}:=\bigcap_{m\geq 0}E_m$ is dense in every $E_m$.  In our terminology, the space $E:=E_0$ is an sc-Banach space  and the nested sequence $(E_m)$ defines an sc-structure on $E$.
  {We would like to point out that  we could assume, as in our previous papers,  that the sequence $(\delta_n)$ starts with $\delta_0=0$. However, since  the Cauchy-Riemann operator defined on the infinite  cylinder is not Fredholm if $\delta_0=0$,  we will always assume that $0<\delta_m<2\pi$.} 
 
Moreover, we define for every $a\in \hb\subset  \C $, the sc-Banach  space $G^a$  as follows.
If $a=0$, we set  
$$G^0=E\oplus \{0\},$$
and if $a\neq 0$,   we define
$$G^a=H^3(Z_a, \R^{2n})\oplus H^{3,\delta_0}_c(C_a, \R^{2n})$$
where the  space $ H^{3,\delta_0}_c(C_a, \R^{2n})$ consists of functions $u:C_a\to \R^{2n}$ for which there exists an asymptotic constant $c\in \R^{2n}$ such that  $u$ converges to $c$ as $s\to \infty$ and to $-c$ as $s\to -\infty$ and  
$$ u- (1-2\beta_a)\cdot c\in H^{3, \delta_0}(C_a, \R^{2n}).$$
We recall that $\beta_a(s)=0$ if $s\geq \frac{R}{2}+1$ and $\beta_a(s)=1$ for $s\leq \frac{R}{2}-1$. The Hilbert space space $H^3(Z_a, \R^{2n})$ is equipped with the 
sc-structure $H^{3+m}(Z_a, \R^{2n})$ for all $m\geq 0$ and the sc-structure for $H^{3,\delta_0}_c(C_a, \R^{2n})$  is given by 
$H^{3+m,\delta_m}_c(C_a, \R^{2n})$. Thus the sc-structure on $G^a$ is defined by  the sequence 
$$G^a_m=H^{3+m}(Z_a, \R^{2n})\oplus H^{3+m,\delta_m}_c(C_a, \R^{2n}), \quad m\geq 0.$$
The total glued map 
$$\boxdot_a(h^+,h^-)=( \oplus_a(h^+,h^-),\ominus_a(h^+,h^-))$$
maps the $m$-level $E_m$ onto the $m$-level $G^a_m$. Recalling the projection $\pi_a$  onto $\ker \ominus_a$ along $\ker \oplus_a$ and the formulae \eqref{eta-plus} and \eqref{eta-minus} 
for 
$$\pi_a(h^+, h^-)=(\eta^+, \eta^-), $$
one  sees  that $\pi_a:E\to E$. 
{Both parts of the following theorem  are proved in  \cite{HWZ8.7}; part (1) is proved as Theorem 2.23 and part (2) is proved in Section 2.4 of  \cite{HWZ8.7}.}

\begin{theorem}\label{sc-splicing-thm}
\mbox{}
\begin{itemize}
\item[{\em (1)}] For every $a\in \hb $, the total  gluing  map 
$$\boxdot_a=( \oplus_a,\ominus_a):E\to G^a$$
is an sc-linear isomorphism. 
\item[{\em (2)}] The map 
$$\pi: \hb \oplus E\to E,\quad  (a, (h^+, h^-))\mapsto \pi_a(h^+, h^-)$$
is sc-smooth. Consequently, the triple $\cs=(\pi,E,\hb )$  is an sc-smooth splicing.
\end{itemize}
\end{theorem}
The splicing  ${\mathcal S}=(\pi,E,\hb )$ defines the splicing core $K^{\mathcal S}$ which is  the set
$$
K^{\mathcal S}=\{(a,(h^+,h^-))\in \hb \times E\, \vert \quad
\pi_a (h^+,h^-)=(h^+,h^-)\}.
$$
In view of Theorem \ref{sc-splicing-thm}, the map 
$r:\hb \oplus E\to \hb \oplus E$,  defined by 
$$r(a, (h^+, h^-))=(a, \pi_a (h^+, h^-)),$$
is an sc-retraction  and the splicing core $K^{{\mathcal S}}=r (\hb \oplus E)$ is   the associated sc-smooth retract.


In our construction of strong bundles  below we shall make use of the following version of the hat gluing and hat anti-gluing. 


We introduce the space   $F$ of pairs $(\xi^+,\xi^-)$  in which   the maps 
$$\xi^+:\R^+\times S^1\to \R^{2n}\quad \text{and}\quad \xi^-:\R^-\times S^1\to \R^{2n}$$
are continuous and have the common asymptotic constant equal to $0$,
$$\lim_{s\to \infty}\xi^+(s, t)=\lim_{s\to -\infty}\xi^-(s, t)=0,$$
where the  convergence  is uniform in $t\in S^1$. Given $(\xi^+, \xi^-)\in F$, the hat-glued map $\wh{ \oplus}_a (\xi^+, \xi^-):Z_a\to \R^{2n}$ is  defined by
the same formula as  $\oplus_a (\xi^+, \xi^-)$. Namely,  
if $a=0$, then 
$$\wh{\oplus}_0(\eta^+, \eta^-):=(\eta^+,\eta^-)$$
and, if $0<\abs{a}<\frac{1}{2}$, then 
\begin{equation*}
\wh{\oplus}_a(\xi^+,\xi^-)([s,t])=\beta_a(s)\cdot \xi^+(s,t)+
(1-\beta_a(s))\cdot \xi^-(s-R,t-\vartheta).\index{hat--gluing map}
\end{equation*}

The hat-anti-glued map  $\wh{\ominus}_a(\xi^+,\xi^-):C_a\to \R^{2n}$ is defined as follows. 
If  $a=0$, we set 
$$\wh{\ominus}_a(\xi^+,\xi^-)=0.$$
However, if $a\neq 0$, the definition of  $\wh{\ominus}_a (\xi^+, \xi^-)$ differs from the anti-glued map $\ominus_a$. 
If $0<\abs{a}<\frac{1}{2}$,  the hat anti-glued map $\wh{\ominus}_a(\xi^+,\xi^-):C_a\to \R^{2n}$ is defined by  
\begin{equation*}
\wh{\ominus}_a(\xi^+,\xi^-)([s,t])\\
=-(1-\beta_a(s))\cdot \xi^+(s,t)+
\beta_a(s)\cdot \xi^-(s-R,t-\vartheta).\index{hat--anti- gluing map}
\end{equation*}
As  before we have  the  direct sum decomposition 
$$F=\ker \wh{\oplus}_a \oplus \ker \wh{\ominus}_a$$
for every $a\in \hb $,  and introduce  the projection map
$$\wh{\pi}_a:F\to F$$
onto $\ker \wh{\ominus}_a$  along  $\ker \wh{\oplus}_a$.  Representing the projection as 
\begin{equation*}
\wh{\pi}_a(\xi^+, \xi^-)=(\eta^+, \eta^-), 
\end{equation*}
a  calculation similar to the one we performed above  leads to the formulae 
\begin{equation}\label{smooth-splicing-10}
\begin{aligned}
\eta^+ (s, t)& = \frac{\beta_a^2}{\gamma_a}\cdot \xi^+(s, t) +\frac{\beta_a (1-\beta_a)}{\gamma_a}\cdot \xi^-(s -R, t -\vartheta)\\
\eta^- (s', t')&=\frac{\beta_a (-s' ) (1-\beta_a (-s' ))}{\gamma_a(-s' )}\cdot \xi^+(s' +R,t'+\vartheta) +\frac{\beta_a (-s')^2}{\gamma_a(-s' )}\xi^-(s', t')
\end{aligned}
\end{equation}
where $\eta^+$ is defined for $(s, t)\in \R^+\times S^1$ and $\eta^-$  for $(s', t')\in\R^-\times S^1$.  We have abbreviated $\beta_a=\beta_a(s)$ and $\gamma_a=\gamma_a(s)$.

The analytical framework of the hat gluing and anti-gluing is similar to the Sobolev framework above;  the  weighted Sobolev  spaces will however be different.
For  the  strictly increasing sequence $(\delta_m)_{m\geq 0}$  satisfying $0<\delta_m<2\pi$ we let $F$ be the space of pairs $(\xi^+,\xi^-)$ of maps 
$$\xi^\pm :\R^\pm \times S^1\to \R^{2n}$$
satisfying  $\xi^\pm\in H^{2, \delta_0}(\R^\pm \times S^1, \R^{2n})$. In particular, we note,  that the common asymptotic constant  of every pair $(\xi^+, \xi^-)\in F$ is equal to $0$. 
We equip  the space $F$ with 
an sc-smooth structure $(F_m)_{m\geq 0}$ where $F_m$ consists of those pairs $(\xi^+, \xi^-)\in F$ in which $\xi^\pm \in H^{2+m, \delta_m}(\R^\pm \times S^1, \R^{2n})$.  The sc-Banach  space $\wh{G}^a$  is defined as follows. 
If $a=0$,  we set $\wh{G}^0=F\oplus \{0\}$, and for  $a\neq 0$  we  define
$$\wh{G}^a=H^2(Z_a, \R^{2n})\oplus H^{2,\delta_0}(C_a, \R^{2n}).$$
Then $\wh{G}^a$ is an sc-Banach space with an sc-smooth structure for which the  level $m$ consists of pairs 
$(u, v)\in \wh{G}^a$  in which $u$ is of 
Sobolev regularity $2+m$ and $v$ of regularity $(2+m, \delta_m)$.
Recalling the projection $\wh{\pi}_a$ onto $\ker \wh{\ominus}_a$  along  $\ker \wh{\oplus}_a$ defined
by \eqref{smooth-splicing-10},   the following theorem is proved in   \cite{HWZ8.7}.
\begin{theorem}\label{sc-splicing-thm1}\mbox{}\\
\begin{itemize}
\item[{\em (1)}] For every $a\in \hb $, the total hat-gluing 
$$\wh{\boxdot}_a=( \wh{\oplus}_a,\wh{\ominus}_a):E\to \wh{G}^a \index{total hat-glued map $\wh{\boxdot}_a$}$$
is an sc-linear isomorphism. 
\item[{\em (2)}] The map 
$$\wh{\pi}: \hb \oplus F\to F,\quad  (a, (\xi^+, \xi^-))\mapsto \wh{\pi}_a(\xi^+, \xi^-)$$
is sc-smooth. Consequently, the triple $\wh{\cs}=(\wh{\pi},F,\hb )$  is an sc-smooth splicing.
\end{itemize}
\end{theorem}








\section{Implanting Gluings and Anti-gluings into a Manifold}\label{section-implant}
Working in a chart we shall implant our gluing constructions  into the symplectic manifold $(Q, \omega)$ of dimension $2n$. We consider  a piece of the Riemann surface $S$ consisting of two disjoint disks $D_x$ and $D_y$ having smooth boundaries and centered at the points $x$ and $y$ in $S$ belonging to the nodal pair $\{x, y\}$. As a reference map we take a continuous map  $u_0:S\rightarrow Q$ 
satisfying the matching condition 
$$u_0(x)=u_0(y)=q\in Q$$ and choose 
a diffeomorphic (in particular onto)  chart  
$\psi: {\bf R}(q) \rightarrow \R^{2n}$
around the point $q$ which satisfies $\psi (q)=0$. The open sets ${\bf R}_r (q)\subset {\bf R}(q)$   are defined as $\psi^{-1}(B_r(0))$ where $B_r(0)\subset \R^{2n}$ is the open ball of radius $r$ centered at the origin.  We assume that ${\bf R}(q)$ is equipped with a Riemannian metric  which over ${\bf R}_4(q)$ is  the pull-back of the Euclidean metric under the map $\psi$ and denote its exponential map by $\exp$.  Then  
$$\psi (\exp_p V(p))=\exp_{\psi (p)}(T\psi (p)\cdot V(p))=\psi (p)+T\psi (p)\cdot V(p)$$
for $p\in {\bf R}_2(q)$, where the tangent vectors $V(p)\in T_pQ$ satisfy $\abs{V(p)}_p\leq 2$.
We assume that $u_0(D_x\cup D_y)\subset {\bf R}_1(q)$. We denote by $O$ a $C^0$-neighborhood of the map $u_0$ consisting of  continuous maps $v:S\to Q$ satisfying $v(x)=v(y)$ and $v(D_x\cup D_y)\subset {\bf R}_2(q)$. We now take a smooth map $u:S\to Q$ in $O$ and choose positive and negative holomorphic polar coordinates centered at $x$ and $y$, and denoted by 
$$h_x:\R^+\times S^1\to D_x\quad \text{and} \quad  h_y:\R^-\times S^1\to D_y.$$ 
This leads to the smooth maps $u^\pm:\R^\pm \times S^1\to \R^{2n}$ defined  by 
$$u^+(s, t)=\psi\circ u\circ h_x(s, t)$$
and 
$$
u^-(s', t')=\psi\circ u\circ h_y(s', t').
$$
Such maps we have already met in the gluing constructions in the  previous section.
If $a=\abs{a}e^{-2\pi i \vartheta}$  is a  gluing parameter satisfying $0<\abs{a}<\frac{1}{2}$,  we identify  
$$
z=h_x(s, t)\in D_x, \quad 0\leq s\leq R
$$
and
$$
z'=h_y(s', t')\in D_y,\quad -R\leq s'\leq 0
$$
if $s'=s-R$ and $t'=t-\vartheta$ where $R=\varphi (\abs{a})$ is the  gluing length. 
If $a=0$, we set 
$$Z_0=D_x\cup D_y.$$
Denoting the gluing operations of the maps into $\R^{2n}$  of the previous section by $\oplus_a^0$, $\ominus^0_a$ and $\wh{\oplus}_a^0$, $\wh{\ominus}_a^0$, we define the glued map 
$$\oplus_a (u):Z_a\to Q$$
 by
$$
\psi (\oplus_a(u)[s,t] )= \oplus_a^0(u^+, u^-)[s,t]=\oplus_a^0(\psi\circ u\circ h_x, \psi\circ u\circ h_y)[s,t],
$$
for all $[s,t]\in Z_a$. The definition of the gluing operation $\oplus_a^0$ implies that 
$$\oplus_a(u)=u$$
near the boundary $\partial Z_a$ of the  glued cylinder $Z_a$.

If $\eta$ is a section of the pull-back bundle $u^*TQ$ with matching data at the nodal pair we denote its principal part by 
$$\eta (z)\in T_{u(z)}Q$$
and hence require that $\eta(x)=\eta (y)\in T_pQ$ where $p=u(x)=u(y)$. The glued 
section  $\oplus_a(\eta)$ is a section of the pull-back bundle $\oplus_a(u)^*TQ$. The vector $\oplus_a(\eta)[s,t]\in T_{\oplus_a(u)[s,t]}Q$ is defined by 
$$T\psi (\oplus_a(u)[s,t])\cdot 
\oplus_a (\eta)[s,t]=\oplus_a^0 (T\psi (u\circ h_x)\cdot \eta\circ h_x, T\psi (u\circ h_y)\cdot \eta\circ h_y)[s,t]$$
where on the right hand-side we have used the $\oplus_a^0$-gluing in $\R^{2n}$ for two vector fields.

Since the Riemannian metric  on ${\bf R}_4(q)$ is the  pull-back of the Euclidean metric in $\R^{2n}$ by the map 
$\psi$ we have the following formula.
\begin{proposition}\label{exp-formula1}
If  $\eta$ is a section of the pull-back bundle $u^*TQ$ satisfying $\eta (x)=\eta (y)$ and $\exp_u(\eta)\in O$, then 
$$
\exp_{\oplus_a(u)}(\oplus_a(\eta))=\oplus_a(\exp_u(\eta)).
$$
\end{proposition}
\begin{proof}
Denoting the principal part of the section $\eta$ by $\eta (z)\in T_{u(z)}Q$ we recall that 
$$\psi \bigl(\exp_{u(z)}(\eta (z))\bigr)=\psi (u(z))+T\psi (u(z))\cdot \eta (z).$$ Therefore,
\begin{align*}
\psi (\exp_{u\circ h_x}(\eta\circ h_x))&=\psi (u\circ h_x)+T\psi (u\circ h_x)\cdot \eta \circ h_x\\
\psi (\exp_{u\circ h_y}(\eta\circ h_y))&=\psi (u\circ h_y)+T\psi (u\circ h_y)\cdot \eta \circ h_y,
\end{align*}
and, since the  operation $\oplus_a^0$ is linear,
\begin{equation*}
\begin{split}
\psi \bigl(\oplus_a(\exp_u \eta)\bigr)&=\oplus_a^0\bigl(\psi (\exp_{u\circ h_x}(\eta\circ h_x)), \psi (\exp_{u\circ h_y}(\eta\circ h_y)) \bigr)\\
&=\oplus_a^0(\psi\circ u\circ h_x, \psi\circ u\circ h_y)\\
&\phantom{=}+
\oplus_a^0\bigl(T\psi (u\circ h_x)\cdot \eta \circ h_x, T\psi (u\circ h_y)\cdot \eta \circ h_y\bigr)\\
&=\psi (\oplus_a(u))+T\psi (\oplus_a(u))\cdot \oplus_a (\eta)\\
&=\psi (\exp_{\oplus_a(u)}\cdot \oplus_a (\eta))
\end{split}
\end{equation*}
and the proposition is proved.
\end{proof}

As above we denote by $C_a$ the infinite cylinder consisting of two half-cylinders $z=h_x(s, t)\in D_x$ and $z'=h_y(s', t')\in D_y$ in which the points with $0\leq s\leq R$ and $-R\leq s'\leq 0$ are identified if $s'=s-R$ and $t'=t-\vartheta$. Let $\eta$ be a section of the  pull-back bundle $u^*TQ$ satisfying 
$\eta(x)=\eta (y)\in T_pQ$ where $p=u(x)=u(y)$. Then the anti-glued map 
$$\ominus_a (\eta):C_a\to T_pQ$$
 is defined by 
$$T\psi (p)\cdot \ominus_a  (\eta)[s,t]=\ominus^0_a(T\psi (u\circ h_x)\cdot \eta\circ h_x, T\psi (u\circ h_y)\cdot \eta\circ h_y)[s,t].$$
Let   $J$ be  a  compatible almost complex structure on the symplectic manifold $(Q, \omega)$,  {that is,   $\omega (\cdot , J\cdot )$  is a Riemannian metric on $Q$. 
}
If $u:D_x\cup D_y\to {\bf R}_1(q)$ is a smooth map belonging to  our neighborhood $O$,  hence satisfying $u(x)=u(y)$,  and if we have at every point $z\in D_x\cup D_y$ a complex anti-linear map
$$\xi (z): (T_z(D_x\cup D_y), j(z))\to (T_{u(z)}Q, J(u(z)))$$
satisfying $\xi (x)=0=\xi (y)$,  we define the  two vector fields $\xi^\pm$ in $\R^{2n}$ by 
\begin{align*}
\xi^+(s, t)&=T\psi (u\circ h_x(s, t))\cdot \xi (h_x(s, t))\cdot \partial_sh_x (s, t)\\
\xi^-(s', t')&=T\psi (u\circ h_y(s', t'))\cdot \xi (h_y(s', t'))\cdot \partial_{s'}h_y (s', t')
\end{align*}
where $(s, t)\in\R^+\times S^1$ and $(s', t')\in \R^-\times S^1$.  {We point out  the fact that a complex anti-linear map defined on a 1-dimensional complex vector space  is determined by its action on a single  nonzero vector.}
{\begin{remark} The condition $\xi^+(x)=\xi^-(y)=0$ is natural in this context. Namely,  if we have a pair  $(u^+,u^-)$ of maps 
 which converge at the nodal points exponentially fast to the nodal image, then applying the Cauchy-Riemann operator
we obtain the pair  $(\xi^+,\xi^-)$ of vector fields which converges exponentially fast to $0$.
\end{remark}}

The hat glued map $\wh{\oplus}_a(\xi)$ then associates with the point $z=[s,t]\in Z_a$ of the glued cylinder, the   complex anti-linear map along the glued map $\oplus_a (u)$,
$$\wh{\oplus}_a(\xi)(z):(T_zZ_a, j(z))\to (T_{\oplus_a(u)(z)}Q, J(\oplus_a(u)(z)))$$
which  is, {using the previous remark about  complex anti-linearity},  defined by 
$$
T\psi (\oplus_a (u)[s, t])\cdot \wh{\oplus}_a(\xi)([s,t]){\cdot \frac{\partial}{\partial s}}:=\wh{\oplus}^0_a(\xi^+, \xi^-)[s, t].
$$
The hat anti-glued  map $\wh{\ominus}(\xi)$ associates with every point $z=[s,t]$ of the infinite cylinder $C_a$ the  complex anti-linear map 
$$\wh{\ominus}_a(\xi)([s, t]):(T_zC_a, j)\to (T_{p}Q, J(p))$$
which is,  defined by 
$$
T\psi (p)\cdot \wh{\ominus}_a(\xi)(z) {\cdot  \frac{\partial }{\partial s}}:=\wh{\ominus}^0_a (\xi^+, \xi^-)[s, t].
$$
We have considered  above the smooth map $u:D_x\cup D_y\to Q$ satisfying $u(x)=u(y)=p$ and the smooth section $\eta$ along the map $u$ of the  pull-back bundle $u^*TQ$ satisfying $\eta (x)=\eta (y)\in T_pQ$. Moreover, we have introduced the glued map $\oplus_a (u):Z_a\to Q$ and the glued section $\oplus_a (\eta):Z_a\to T_{\oplus_a (u)}Q$ of the pull-back bundle $\oplus_a(u)^*TQ$. We also recall that with every $z=[s,t]\in Z_a$ we have associated the hat-glued complex anti-linear map $\wh{\oplus}_a(\xi):(T_zZ_a, j(z))\to  (T_{\oplus_a (u)(z)}Q, J(\oplus_a (u)(z))).$ 

Finally,  the splicing projections  $\pi_a^0$ and $\wh{\pi}^0_a$ can also be implanted as follows. In the case of $\pi_a^0$ we take a section $\eta$ 
along $u$. This defines,  using holomorphic polar coordinates and  a chart $\psi$ for the manifold $Q$, the pair $(\eta^+,\eta^-)$ of sections along the pair $(u^+,u^-)$.
For the  gluing parameter $a$ the projection $\xi=\pi_a(\eta)$ is defined by its representative $(\xi^+,\xi^-)$ obtained as the unique solution of the equations 
$$
\oplus_a^0(\xi^+,\xi^-)=\oplus^0_a(\eta^+,\eta^-)\ \ \text{and}\ \ \ \ominus_a^0(\xi^+,\xi^-)=0.
$$
If $D_x\cup D_y\subset S$ for a Riemann surface $S$ and if $\eta$ is a section along the map  $u:S\rightarrow Q$,
then $\pi_a(\eta)$ is well-defined acting as the identity over the complement of $D_x\cup D_y$.
By implanting the splicing projection associated to a single nodal pair $\{x,y\}$ we will always assume that the splicing projection
will be extended by the identity in the complement of the relevant disks of the small disk structure.
If we deal with several nodal pairs $\{x,y\}\in D$ we obtain for each $\{x,y\}$ a splicing projection $\pi_{a_{\{x,y\}}}^{\{x,y\}}$ as just described.
Since the disks of the small disk structures are mutually disjoint any  two of these projections commute. By taking the composition
of all of them (whatever the order) we obtain a well-defined projection $\pi_a$, where $a={(a_{\{x,y\}})}_{\{x,y\}\in D}$. This is the splicing
projection associated to the tuple $a$ of gluing parameters. 

\section{More Sc-smoothness Results.}

We next apply the following criterion for the sc-smoothness of a map $f:E\to F$ between  sc-Banach spaces which is  formulated in terms of  classical derivatives.

\begin{proposition}\label{prop2.11}
Let $E$ and $F$ be two sc-Banach spaces and let $U\subset C\subset E$ be an open set in a partial quadrant $C$. We assume
that the map $f:U\rightarrow F$ is sc$^0$-continuous  and that the induced maps 
$f:U_{m+k}\rightarrow F_m$ are of class  $C^{k+1}(U_{m+k}, F_m)$ for every $m\geq 0$ and $k\geq 0$.
Then  the map $f:U\rightarrow E$ is sc-smooth.
\end{proposition}
{Recalling that  an $\ssc^0$-map $f:U\rightarrow F$ is of class $\ssc^\infty$ if it is of class $\ssc^{k+1}$ for all $k\geq 0$,  Proposition \ref{prop2.11} is a consequence of Proposition 2.4 in \cite{HWZ8.7}.}

We shall make use of Proposition \ref{prop2.11} in the special  situations, in which $F$ is equal to some Euclidean space equipped with the constant sc-structure.  First we shall   carry out a  transversal constraint construction used later on.

We consider the closed disk  $D$ in ${\mathbb C}$ and  a $C^1$-embedding $u:D\rightarrow {\mathbb R}^{2n}$  satisfying $u(0)=0$. Let $H\subset \R^{2n}$ be the
orthogonal complement of the image set  $Tu(0)({\mathbb C})$ so that $\R^{2n}=Tu(0)({\mathbb C})\oplus H$. Let us note that,
in fact, we only need $H$ to be a complement. By means of the implicit function theorem we find an open neighborhood $O$ of the map $u$ in $C^1(D, \R^{2n})$ having the following properties for $v\in O$. 
\begin{itemize}
\item[$\bullet$] The set $v^{-1}(H)$ consists of precisely one point $z_v$
and  $z_v$ belongs to  the open disk $B_{\frac{1}{2}}\subset \C$ of radius $\frac{1}{2}$ and centered at the origin.
\item[$\bullet$] The image point $v(z_v)$ lies in the unit-ball $B^{2n}(1)$ of ${\mathbb
R}^{2n}$.
\item[$\bullet$] The image set $Tv(z_v)({\mathbb C})$ is transversal to $H$ in $\R^{2n}$.
\item[$\bullet$]  The map $\beta:O\to \hb$, defined by $\beta (v)=z_v$, is of class $C^1(D, \R^{2n})$ and if we restrict the map $\beta$ to the space $ O\cap C^m(D, \R^{2n})$, then the map 
$\beta :O\cap C^m(D, \R^{2n})\to \hb$ is of class $C^m$.
\end{itemize}
We  now introduce the sequence of Sobolev spaces $E_m=H^{3+m}(D, \R^{2n})$ for $m\geq 0$ and set $E=E_0$, which is an sc-smooth Banach space equipped  with the filtration $(E_m)_{m\geq 0}$. 
The set $O\cap E$ is an open subset of $E$. In view of  the Sobolev embedding theorem,  there is a continuous {linear}  embedding $E_m\rightarrow C^{m+1}$ and consequently the map $\beta  (v)=z_v$ defines an $\ssc^0$-continuous map $\beta:E\cap O\to \R^{2}$ whose induced maps $E_m\cap O\to \R^{2}$ are of class $C^{m+1}$ for every $m\geq 0$. In view of  Proposition \ref{prop2.11} we obtain the following result.
\begin{proposition}\label{n-prop2.24}
The map $\beta:O\cap E\rightarrow B_{\frac{1}{2}}$ defined above by $\beta (v)=z_v$ is 
sc-smooth.
\end{proposition}

The previous transversal constraint construction can easily be  implanted into a manifold.
We consider the Riemann surface $(S,j)$  and the $C^{\infty}$-map 
$u:S\rightarrow Q$  into the  symplectic manifold
$(Q,\omega)$  having the property that at some point $z\in S$ the linearized map $Tu(z)$   is injective. We set $u(z)=q\in Q$. Then we find a disk like neighborhood $D_z$ of $z$ having a smooth boundary, a biholomorphic map 
$h:(D,0)\rightarrow (D_z,z)$  where, as above, $D\subset \C$ is the  closed unit disk, and we take  a diffeomorphic chart 
$\psi: ({\bf R}(q), q)\to ({\mathbb R}^{2n},0)$ around the point $q$. We can assume that 
$u(D_z)\subset {\bf R}_1(q)=\psi^{-1}(B^{2n}(1))$ and that $T\psi  (q)$ maps the image set $Tu(z)(\R^{2})$ onto $\R^{2}\times \{0\}$ in $\R^{2n}$.    We assume that ${\bf R}(q)$ is equipped with the Riemannian metric  which over ${\bf R}_4(q)=\psi^{-1}(B^{2n}(4))$ is  the pull-back of the  Euclidean metric of $\R^{2n}$ by means of the map $\psi$. 
We abbreviate $H=\{0\}\times \R^{2n-2}$. Then the composition 
$\wh{u}:D\to \R^{2n}$,  defined  by 
$$
\wh{u}= \psi\circ u\circ h
$$
is smooth, satisfies $\wh{u}(0)=0$, and $H$ is transversal to $T\wh{u}(0)(\R^2)$ in $\R^{2n}$. Hence by the above discussion there is 
a $C^1$-neighborhood $U(\wh{u})$ in $C^1(D, \R^{2n})$ of the  smooth map $\wh{u}$ so that every map $\wh{v}\in U(\wh{u})$ meets the properties listed above. 


Hence, by Proposition \ref{n-prop2.24}, the map $\beta:U(\wh {u})\cap E\to \hb$,  defined by 
$\beta (\wh{v})=z_v$, is sc-smooth.  Consequently, defining the submanifold $Q_0$ of $Q$ by 
$$Q_0=\psi^{-1}(H\cap B^{2n}(2)),$$
we find a $C^1$-neighborhood $U(u)$ in $C^1(D_z, Q)$ of the smooth map $u:D_z\to Q$ such that if $v\in U(u)$,  then $v(D_z)$ intersects $Q_0$ in precisely one point $q_v$,
$$q_v\in v(D_z)\cap Q_0$$
and the intersection is transversal. Moreover, the map $U(u)\to Q_0$, associating with $v\in U(u)$ the intersection point $q_v$, is sc-smooth if  restricted to the sc-structure defined by the nested sequence $H^{3+m}$, $m\geq 0$. 

Later on we shall refer to the map $v\mapsto q_v\in Q_0$ as {``the  transversal constraint $Q_0$''},  and we shall refer to above neighborhood $U(u)$ as to the {\bf  transversal constraint construction}  associated with the smooth map $u$ and the chart $\psi$.\index{transversal constraint construction}

The next result is concerned with the action of parameterized diffeomorphisms. Let $D$ be the closed unit disk in ${\mathbb C}$ and
assume $V$ is an open subset in some ${\mathbb R}^N$. We assume that we are given a smooth family $v\mapsto \phi_v$, $v\in V$ of diffeomorphisms of $D$ having  compact supports  contained in the interior of $D$.
We take  the sc-Banach space $E$ with $E_m=H^{3+m}(D,{\mathbb R}^m)$ and  consider the composition
$$
\Phi:V\oplus E\rightarrow E, \quad (v,u)\mapsto u\circ \phi_v.
$$
We would like to point out that the map $\Phi$ is far from being smooth in the classical sense. 
{In contrast,  we have demonstrated   in \cite{HWZ8.7} (Theorem 1.26)   the following  result.}
\begin{theorem}\label{action-diff}
The map $\Phi:V\oplus E\to E$, $\Phi (v, u)=u\circ \phi_v$,  is sc-smooth.
\end{theorem}
\begin{remark}
{We point out that in the statement of Theorem 1.26 in \cite{HWZ8.7} the crucial assumption is missing. The correct statement of the theorem requires, in addition to the assumption that the family of maps 
$v\rightarrow \phi_v$ is  smooth,  that the maps $\phi_v:D\rightarrow {\mathbb C}$ are smooth embeddings.}
\end{remark} 
{One can deduce  many  corollaries  from this  result. To describe such a corollary,  we assume  that   $S$ and $S'$ are pieces of Riemann surfaces containing the distinguished points $z$ and $z'$.  We denote by $O(z)$ and $O(z')$  open neighborhoods of $z$ and $z'$ in $S$ and $S'$, respectively, and   assume that there exists   a smooth map 
$$
V\times O(z')\rightarrow S, \quad (v,s)\mapsto \phi_v(s)
$$
into 
a neighborhood  of  $z$ satisfying
$$
\phi_v(O(z'))\subset O(z)
$$
for all $v\in V$. {Moreover,  we assume that $\phi_v:O(z')\rightarrow S$ is a smooth embedding
for every $v$.} We consider the Banach space $E$ of maps $u$ of Sobolev class $H^3$ defined on ${O(z)}$ and having their images  in some ${\mathbb R}^n$.  We equip $E$   with the usual sc-structure defined by the sequence $H^{3+m}$ for  $m\geq 0$. We  let  $F$  be the sc-Banach space of the same type of maps defined on some compact subdomain $K$ of $O(z')$  having a smooth boundary. Then the map 
$$\Psi:V\oplus E\to  F,$$
defined by 
$$
(v,u)\mapsto  (u\circ\phi_v)\vert K, 
$$
is an sc-smooth map.}

Later on we will need  the following  version of this result in the case of  noded surfaces.
We assume that $D_x$ and $D_y$ as well as $D_{x'}'$ and $D_{y'}'$ are disk-like Riemann surface 
with smooth boundaries and associated with the  nodal pairs $\{x,y\}$ and $\{x',y'\}$. Using the exponential gluing profile  and proceeding as in Section \ref{dm-subsect}, 
we construct  the glued surfaces $Z_a$ and $Z_{b}'$. For $h>0$ and $a$ (or $b$) small enough we
have  defined the sub-cylinders $Z_a(-h)$ and $Z_b'(-h)$ in Section \ref{dm-subsect} and recall that $Z_0(-h)=D_x(-h)\cup D_y(-h)$ if $a=0$, 
and similarly for $Z_0'$.

Let  $V$ be an open neighborhood of $0$ in some $R^N$ and let $D_{\varepsilon}$  be the closed  disk in $\C$ centered at the origin and of radius $\varepsilon$.  We assume that the  following data {are} 
 given:
\begin{itemize}
\item[(1)]  A smooth map $(a,v)\mapsto  b(a,v)\in {\mathbb C}$ defined for $v\in V$ and  $a\in D_{\varepsilon}$  with  $\varepsilon$  sufficiently small,  
and satisfying  $b(0,v)=0$ for all $v\in V$.
\item[(2)] For sufficiently large $h>0$, 
a core-smooth  family of  holomorphic embeddings
$$
\phi_{(a,v)}:Z_a(-h)\rightarrow Z_{b(a,v)}'
$$
parameterized by $(a,v)\in D_{\varepsilon}\oplus V$.
\item[(3)]  There exists  $H>0$  such  that 
$$
Z'_{b(a,v)}(-H)\subset \phi_{(a,v)}(Z_a(-h))
$$
for all $(a, v)\in  D_{\varepsilon}\oplus V$ where  $\varepsilon$  is sufficiently small.
\end{itemize}
We take two smooth cut-off functions $\beta$ and $\beta'$ as in Section \ref{gluinganti-sect} and use them,  together with  the exponential gluing profile,  to define glued maps on the two finite cylinders $Z_a$ and $Z_b'$. Then we  consider the sc-Banach space $E'$ of maps $\xi:D_{x'}'\cup D_{y'}'\rightarrow {\mathbb R}^{2n}$ of class $(3,\delta_0)$  {satisfying $\xi (x')=\xi (y')$}.

The sc-structure is such that the level m corresponds to the regularity $(m + 3, \delta_m)$, where  the strictly increasing sequence of weights $(\delta_m)_{m\geq 0}$ satisfies $0<\delta_m <2\pi$.
Similarly,  we introduce the sc-Banach space $E$ consisting of maps $\eta: D_x(-h)\cup D_y(-h)$ of regularity  $(3,\delta_0)$ whose level $m$ consists of maps of the same regularity $(m+3,\delta_m)$ 
{and satisfying $\eta (x)=\eta (y)$}. With these spaces we define the map 
$$\Phi:D_{\varepsilon}\oplus V\oplus E'\to E,\quad (a,v,\xi)\mapsto  \eta$$
where the map $\eta\in E$ is defined, using Theorem \ref{sc-splicing-thm},  as the unique solution of the  two equations 
$$
\oplus_a(\eta) = \oplus_{b(a,v)}'(\xi)\circ \phi_{(a,v)}\quad \text{and}\quad  \ominus_a(\eta)=0.
$$ 
Here the prime on $ \oplus'$ and $\ominus'$ indicates that we use  the cut-off functions $\beta'$ for the gluing.
The following theorem which will be employed later when dealing with sc-smoothness issues of transition maps.
\begin{theorem}\label{theorem_neck}%
The map $\Phi$ introduced above  is sc-smooth.
\end{theorem}
The result is proved  Appendix \ref{QWE}.

{\begin{remark} 
There is an analogous  result for the sc-Banach space set-up, in which  the regularity levels are given by $(k+2,\delta_k)$, 
the asymptotic constants vanish,  and the hat-gluings are used.  This will be relevant in  the construction of 
strong bundles later on.
\end{remark}
Finally we  shall need the following  result which can also be reduced to Theorem 1.31 in \cite{HWZ8.7}. %
In order to formulate it, we
assume that $((D_x,D_y),(x,y))$ as well as $((D_{x'}',D_{y'}'),(x',y'))$ are disk pairs so that we obtain via gluing the associated
cylinders $Z_a$ and $Z_{a'}'$.  We assume that $E$ is the sc-Banach space as described above associated to the first pair
and $E'$ to the second.  We assume that $(a_k)$ and $(a_k')$ are small gluing parameters converging to $0$ and $$\phi_k:Z_{a_k}\rightarrow Z_{a_k'}'$$
is a sequence of holomorphic embeddings having the following properties.  The restrictions of the maps to 
a fixed annulus-type neighborhood of the boundary of the disc $D_x$ converge, viewed as the maps into the discs $D_{x'}'$, in the $C^\infty$-sense. Similarly, the maps $\phi_k$ restricted to a fixed annulus-type neighborhood of the boundary of $D_y$ converge as maps into $D'_{y'}$ in the $C^\infty$-sense.
Then we consider a sequence $(\xi_k)$ in $E'$ converging on level $0$ to some $\xi_0=(\xi^+,\xi^-)\in E'$ and define the maps 
$\eta_k\in E$ as the unique solutions of the two equations
$$
\oplus_{a_k}(\eta_k) =(\oplus_{a_k'}'(\xi_k))\circ \phi_k\ \ \text{and}\ \ \ \ominus_{a_k}(\eta_k)=0.
$$
\begin{proposition}\label{gotham}
Under the assumptions stated above the sequence $(\phi_k)$ converges in $C^\infty_{loc}$ in finite distance to the left and the  right boundary
to holomorphic embeddings $\phi^+:D_x\rightarrow D_{x'}'$ and $\phi^-:D_y\rightarrow D_{y'}'$ satisfying  $\phi^+(x)=x'$ and $\phi^-(y)=y'$. 
The sequence $(\eta_k)\subset E$ converges on level $0$ to  the map  $\eta_0=(\eta^+,\eta^-)\in E$ given by 
$$
\eta^+ = \xi^+\circ \phi^+\ \ \text{and}\ \ \eta^-=\xi^-\circ\phi^-.
$$
\end{proposition}
\begin{remark}
The proof is lengthy, but  uses only arguments and constructions occurring already in  the proof of Theorem \ref{theorem_neck}.%
We sketch the proof and leave the details to the reader.
The first step is to show that,  without loss of generality,  the maps $\phi_k$ are biholomorphic maps $Z_{a_k}\rightarrow Z_{a_k'}'$,
where the domain is equipped with the standard {almost complex} structure,  and the target with a family of almost complex structures $(j_k)$, 
which on suitable sub-cylinders  $Z_{a_k}'(-h)$,  are all  standard structures and converge near the boundaries in the $C^\infty$-sense.
In the next step one shows that,  without loss of generality,  one may assume that the  maps $\phi_k$ map the   distinguished
boundary points on $Z_{a_k}$ to the distinguished boundary points on $Z_{a_k'}'$. Then the proof  is indeed reduced 
to Theorem 1.31 in \cite{HWZ8.7}. We point out that the sequence $(\phi_k)$ converges in a strong sense to $(\phi^+,\phi^-)$. This  is 
discussed in detail, in \cite{HWZ8.7}, Theorem 1.46. 
\end{remark}}
\endinput




\chapter{The Polyfold Structures }\label{four}
This chapter is devoted to the construction of the polyfold structures on the space 
$Z=Z^{3,\delta_0}(Q, \omega)$ of stable curves into the symplectic manifold $(Q, \omega)$,  and on the bundle $W\to Z$ introduced in Section \ref{sect1.2}.  
In particular, we shall give the proofs of the Theorems \ref{th-top}, \ref{pfstructure} and
 \ref{main1.10} announced in the introduction. The polyfold construction is based on the concept of  good uniformizing families of stable curves introduced next.
 \section{Good Uniformizing Families of Stable Curves}\label{xA}
Fixing  a number $\delta_0\in (0,2\pi) $  we consider the 
$(3,\delta_0)$-stable map
$$
\alpha=(S,j,M,D,u).
$$

We recall that $(S, j, M, D)$ is a connected nodal Riemann surface with ordered marked points, and $u:S\to Q$ is a map into the closed symplectic manifold $(Q,\omega)$ which is of class $(3,\delta_0)$ near the nodal points in $\abs{D}$ and of class $H^3_{\loc}$ around all the other points of $S$. Moreover, $u(x)=u(y)$ for every nodal pair $\{x, y\}\in D$. We shall denote the set of such mappings $u:S\to Q$ by 
$$H^{3,\delta_0}(S, Q).$$
If $C$ is an unstable domain component of $S$, the map $u:C\to Q$ satisfies the stability condition 
$\int_Cu^*\omega >0$.  Two stable maps $(S,j,M,D,u)$ and $(S',j',M',D',u')$ are isomorphic or equivalent, if there exists an isomorphism $\phi:(S,j,M,D)\to (S',j',M',D')$ between the underlying noded surfaces satisfying $u'\circ \phi =u$. An equivalence class is called a stable curve. We shall denote the space of equivalence classes of  stable maps of class $(3, \delta_0)$ by 
$$Z=Z^{3,\delta_0}(Q,\omega ).$$

A consequence of the stability condition $\int_Cu^*\omega >0$ is the finiteness of the automorphism group  $G$ of the stable map $(S, j, M, D, u)$.





The underlying  connected nodal  Riemann surface $(S, j, M, D)$ is not necessarily stable. In order to achieve stability, we shall add more marked points.
\begin{definition}\label{stab-f}
A finite set
$\si$ of points in $S$ is called a {\bf stabilization} of $\alpha=(S,j,M,D,u)$  if  the following holds true.\index{stabilization}
\begin{itemize}
\item[(1)] The set $\si$ lies in the complement of $M\cup |D|$.
\item[(2)]  {Every element $g$ of the automorphism group $G$ of $\alpha$  maps  the set $\si$ onto itself.}
\item[(3)] If we denote by $M^\ast$ the un-ordered set $M\cup\si$, then the nodal Riemann surface $(S,j,M^\ast,D)$ is stable.
\item[(4)] If $u(z)=u(z')$ for two points in $\si$, then there exists an automorphism  $g$ in $G$ satisfying $g(z)=z'$.
\item[(5)] The image $u(\si)$ does not intersect $u(|D|\cup M)$.
\item[(6)]  {At  the points $z\in \si$, the tangent map $Tu(z)$ is  injective, the $2$-form $u^\ast\omega (z)$ is non-degenerate and determines on $T_zS$ the same orientation  as the almost complex structure $j(z)$ does.}
\end{itemize}
\end{definition}
The automorphism group $G^\ast$ of  the nodal Riemann  surface $(S,j,M\cup\si,D)$  is finite and contains the automorphism $G$ of  the stable map  $\alpha$.
{The latter property about $u^\ast\omega$ will be used solely in the  discussion of the  orientability of the Cauchy-Riemann section later on.  Here we adopt the convention  that the orientation of the tangent space $T_zS$ determined by the non-degenerate $2$-form $u^\ast\omega (z)$ is defined by an {ordered} basis $\{e_1, e_2\}$ satisfying $u^\ast\omega(z)(e_1,e_2)>0$ and the orientation determined by the almost complex structure $j(z)$ is defined by an  {ordered}  basis $\{v, j(z)v\}$ in $T_zS$.}

\begin{lemma}\label{ax}
{ The stable map $\alpha=(S,j,M,D,u)$ possesses a stabilization $\si$. %
}
\end{lemma}

\begin{proof}
We choose a domain component $C$ of $S$ which together with its special points $C\cap (M\cup |D|)$ is unstable.
 Since $\alpha$ is stable, we know that $\int_C u^\ast\omega>0$. Hence we find 
 a point $z\in C\setminus (M\cup |D|)$ at which   $Tu(z)$ is injective,  {$u^\ast\omega (z) $ is non-degenerate and   determines on $T_zS$ the same orientation as $j(z)$ does.} By moving $z$ slightly we can keep this property, and  can achieve that, in addition,  
 $$
 u(z)\not\in u(M\cup |D|).
 $$
 Now we use the automorphism group $G$ to move $z$ around hitting  possibly  other domain components.
 If $\si_1$ is  the collection of points of the orbit $\{g(z)\ |\ g\in G\}$, then  $\si_1$ satisfies all properties of a stabilization with the exception that $(S,j,M\cup \si_1,D)$ might not be stable yet. If the latter still has unstable domain components we can pick a point $z'\in S$ in such a component in the complement of $M\cup\si_1\cup |D|$ so that $Tu(z')$ is injective, {%
 $u^\ast\omega (z')$ is non-degenerate and   determines on $T_{z'}S$ the same orientation as $j(z')$ does.} Moreover, 
$u(z')$ is not contained in $u(|D|\cup M\cup\si_1)$. Then the set $\si_2=\si_1\cup \{g(z')\ |\ g\in G\}$ satisfies all properties of a stabilization with the exception that $(S,j,M\cup \si_2,D)$ might not be stable yet.
 At every step of this procedure an unstable domain component
 obtains {at least one}  additional point. Since we only have a finite number of domain components  and since we have to add at most three points to an unstable domain component to obtain stability, it is clear that after a finite number of steps we arrive at  the desired stabilization $\si$  of $\alpha$.
\end{proof}

Let $\alpha=(S,j,M,D,u)$ be a stable map equipped with the stabilization $\si$. 
Recalling that $u$ maps $S$ into the symplectic manifold $Q$, we label the images of the nodal points in $\abs{D}$ and of the points in the stabilization $\si$  by
$u(\abs{D})=\{w_1,\ldots, w_k\}$ and $u(\si)=\{w_{k+1},\ldots ,w_{k+l}\}$,  {respectively}. By definition of the stabilization, $u(|D|)\cap u(\si)=\emptyset$.
For every $i\in \{1,\ldots, k+l\}$ we fix a smooth bijective chart
$$
\psi_i:({\bf R}(w_i),w_i)\rightarrow ({\mathbb R}^{2n},0)
$$
so that the closures of the domains are mutually disjoint. We denote
by ${\bf R}_r(w_i)$ the preimage of the $r$-ball $B_r(0)$ around $0$ under the chart map $\psi_i$.
Next we fix a small disk structure ${\bf D}$,  and, in addition, closed disks $D_z$ with
smooth boundaries  centered at the points $z$ in $\si$ so that all disks are
mutually disjoint and so that the following holds. \\[0.3ex]

\noindent $\boldsymbol{(\ast)}$ For every $z\in |D|\cup \si$ the image under $u$ of the
disk $D_z$ is contained in ${\bf R}_1(w_i)$, where $w_i=u(z)$. Moreover the union $\bigcup_{z\in \Sigma} D_z$ is invariant under $G^\ast$.\\
\\
We note that invariance under $G$ would actually be sufficient for the later constructions.
We choose  a Riemann metric $g$ on the manifold $Q$ which,  over  the open neighborhood ${\bf R}_4(w_i)$, is the
pull-back of the standard metric on ${\mathbb R}^{2n}$ under the map  $\psi_i.$
At this point we consider the stable noded Riemann surface $(S,j,M\cup\si,D)$ in which the marked points $M\cup \si$ are not ordered.  We denote its  finite automorphism  group by $G^\ast$. Using the exponential gluing
profile,  we use our small disk structure and take a good {complex} deformation
$v\mapsto  j(v)$ of $j$ so that for a suitable $G^\ast$-invariant
open neighborhood $O$ of $(0,0)\in N\oplus E$ we have the  good uniformizing
family
$$
(a,v)\mapsto  (S_a,j(a,v),(M\cup\si)_a,D_a)
$$
possessing  all the properties listed in Definition \ref{citiview}.


We denote by $U(u)$ a $C^0$-open neighborhood of the map $u$ in the space of continuous maps from $S$ into $Q$, which is so small that the images of the discs
$D_z$ under the maps belonging to $U(u)$ lie  in ${\bf R}_2(w_i)$ for $w_i=u(z)$.  Hence we can define
a family
$$
(a,v,u')\rightarrow (S_a,j(a,v),M_a,D_a,\oplus_a(u')),
$$
where $(a,v)$ belongs to the $G^\ast$-invariant open neighborhood
$O$ of $(0,0)\in N\times E$ and  where the continuous map $u':S\to Q$ belongs to $U(u)$. Let us fix for every $z\in
\si$ a subdisk $SD_z$ which is contained in the interior of $D_z$
and also has smooth boundary so that their union is invariant under
the $G$-action. There is no loss of generality to assume that the subdisks are concentric, i.e. of the form
$$
SD_z = D_z(-h)=\{\zeta \in D_z\vert \, \text{$ \zeta =z$ or $\zeta=h_x(s, t)$ for $s\geq h$}\},$$
where $h>0$ and where $h_x$ are positive holomorphic polar coordinates on $D_z$ centered at $z$.
We also fix subdisks having  the same invariance property for the  discs $D_x$ and $D_y$ associated with the nodal points $\{x, y\}$. Recall that given the  gluing parameter $a={(a_{\{x, y\}})}_{\{x, y\}\in D}$ we have introduced the union
$$
Z_a=\bigcup_{\{x,y\}\in D} Z_{a_{\{x,y\}}}^{\{x,y\}}
$$
of the cylinders $Z_{a_{\{x,y\}}}^{\{x,y\}}$ which connect the boundaries of the discs $D_x$ and $D_y$ if $a_{\{x, y\}}\neq 0$ and which are equal to $Z_0^{\{x, y\}}=D_x\cup D_y$ if 
$a_{\{x, y\}}=0$. Recalling the subcylinders  $SZ_{a_{\{x,y\}}}^{\{x,y\}}=Z_{a_{\{x,y\}}}^{\{x,y\}}(-h)$ from section \ref{dm-subsect}, we have abbreviated  
$$
SZ_a=Z_a(-h)=\bigcup_{\{x,y\}\in D} Z_{a_{\{x,y\}}}^{\{x,y\}}(-h).
$$
 {We recall that $G$ is the automorphism group of the stable map $\alpha=(S, j, M, D, u)$, not necessarily having a stable domain $(S, j, M, D)$, but equipped with a stabilization $\si$. Moreover,  $G^\ast$ is   the  group of automorphisms  of the  stable nodal  Riemann  surface $(S,j,M\cup\si,D)$, where
$M\cup\si$ is viewed as an unordered set. The group  $G^*$ is finite and, by the properties of a stabilization, contains $G$.} 

{The behavior of isomorphisms  near the nodes  is described in the following proposition}.
\begin{proposition}\label{ay}
We consider the stable map  $(S, j, M, D, u)$ and recall the above definitions. Then given $h>0$, there exists  a $G^\ast$-invariant
open neighborhood $O'\subset O$ of $(0,0)\in N\oplus E$ and a $G$-invariant $C^0$-neighbor\-hood $U'(u)\subset U(u)$ of the map  $u$ so that the following holds. If $u',u''\in U'(u)\cap H^{3,\delta_0}(S, Q)$ are  maps from $S$ to $Q$ and 
$(a,v),(b,w)\in O'$ and if 
$$
\phi:(S_a,j(a,v),M_a,D_a,\oplus_a(u'))\rightarrow
(S_b,j(b,w),M_b,D_b,\oplus_b(u''))
$$
is an isomorphism, then there exists an automorphism $g$ {in the automorphism group $G$ of the  original stable map $\alpha=(S, j, M, D, u)$} satisfying 
$$
\phi(Z_{a_{\{x,y\}}}^{\{x,y\}}(-h))\subset Z_{b_{\{g(x),g(y)\}})}^{\{g(x),g(y)\}}
$$
at  all nodal pairs $\{x,y\}\in D$. In addition,   if  $z\in \si$,  then
$$
\phi(D_z(-h))\subset D_{g(z)}.
$$
\end{proposition}
\begin{proof}
Arguing indirectly we may assume that we have two sequences
$u_k',u_k'' \rightarrow u$ of maps  in $U'(u)\cap H^{3,\delta_0}(S, Q)$ converging in $C^0$,  sequences $(a_k,v_k)\rightarrow (0,0)\in
O$ and $(b_k,w_k)\rightarrow (0,0)\in O$, and a sequence of isomorphisms
\begin{eqnarray*}
&\phi_k:(S_{a_k},j(a_k,v_k),M_{a_k},D_{a_k},\oplus_{a_k}(u'_k))\rightarrow\ \ \ \ &\\
&\ \ \ \ \ \ \ \ \ \ \ \ (S_{b_k},j(b_k,w_k),M_{b_k},D_{b_k},\oplus_{b_k}(u''_k))&
\end{eqnarray*}
which violates the conclusion of the proposition.
The stability assumption on the stable maps $(S, j, M, D, u)$ excludes bubbling off in  the sequence $(\phi_k)$ of mappings and one concludes by Gromov compactness that any subsequence of $(\phi_k)$ has a subsequence converging in $C^{\infty}_{\text{loc}}$ away from the nodes and the neck to some isomorphism 
$$\phi_0 :(S, j, M, D, u)\to (S, j, M, D, u).$$
This fact is a  consequence of the following lemma which is proved  in Appendix  \ref{section5.1}.
\begin{lemma}\label{GROMOVCONV}
We consider the stable map  $(S, j, M, D, u)$ and two sequences $u_k, u_k'\in H^{3,\delta_0}(S, Q)$  converging  to $u$ in $C^0$. We assume 
that $(a_k,v_k)\rightarrow (0,0)\in O$ and $(b_k,w_k)\rightarrow (0,0)\in O$ and  assume that  
\begin{eqnarray*}
&\phi_k:(S_{a_k},j(a_k,v_k),M_{a_k},D_{a_k},\oplus_{a_k}(u_k))\rightarrow\ \ \ \ \ \ \ &\\
&\ \ \ \ \ \ \ \ (S_{b_k},j(b_k,w_k),M_{b_k},D_{b_k},\oplus_{b_k}(u'_k))&
\end{eqnarray*}
is a sequence of isomorphisms. Then there is a subsequence of $(\phi_k)$ which converges in $C^{\infty}_{\text{loc}}$ away from the nodes to an automorphism $\phi_0$ of $(S, j, M, D, u)$. 
\end{lemma}
Consequently, $\phi_0=g\in G$ and hence $\phi_0(D_z(-h))=D_{g(z)}(-h)\subset D_{g(z)}$ for $z\in \Sigma$ and $\phi_0(D_x(-h) \cup D_y(-h))\subset D_{g(x)}\cup D_{g(y)}$ for the nodal pairs  $\{x, y\}$. After passing to a subsequence, we see that for $k$ large enough
$\phi_k (D_z(-h))\subset D_{g(z)}$, and 
$\phi_k (D_x(-h)\cup D_y(-h))\subset D_{g(x)}\cup D_{g(y)}$ contradicting the choice of the sequence and implying the result.
\end{proof}


The same arguments prove also the next proposition.

\begin{proposition}\label{az}
Given $h>0$ there exists $H>0$ and a $G^\ast$-invariant open
neighborhood $O''\subset O'$ of $0$ and a $C^0$-neighborhood $U''(u)\subset U(u)$  of the map 
$u$ so that the following holds. If $u', u''\in U''(u)$, $(a,v),(b,w)\in
O''$ and if 
$$
\phi:(S_a,j(a,v),M_a,D_a,\oplus_a(u'))\rightarrow
(S_b,j(b,w),M_b,D_b,\oplus_b(u''))
$$
is an isomorphism,  then there exists an automorphism $g\in G$ satisfying 
$$
\phi(D_z(-H))\subset D_{g(z)}(-h)
$$
for all $z\in \si$, and 
$$\phi(Z^{\{x,y\}}_{a_{\{x,y\}}}(-H))\subset
Z^{\{g(x),g(y)\}}_{b_{\{g(x),g(y)\}}}(-h))
$$
for every nodal pair $\{x,y\}\in D$.
\end{proposition}
In order  to define the notion of a good uniformizing family for $Z=Z^{3,\delta_0}$, we start with the notion of good data.

\begin{definition}[{\bf Good Data}]\label{GD}\index{good data (definition)}
Let $\alpha=(S,j,M,D,u)$ be a stable map  representing the class $[\alpha]\in Z$ {where $(S, j, M, D)$ is a noded, not necessarily stable, Riemann surface}, and let $G$ be the automorphism group of $\alpha$. 
{\bf Good data}  centered at $\alpha$  are the following data.
\begin{itemize}
\item[(1)] A stabilization $\si$ of $\alpha$ and a good uniformizing family
$$
(a,v)\mapsto  (S_a,j(a,v),(M\cup\si)_a,D_a),\ \ (a,v)\in O,
$$
where the gluing is associated with  a small disk structure ${\bf D}$ around the points in $|D|$. In addition,  disks with smooth boundaries have been fixed around the points in $\si$, so that all the disks are mutually disjoint. Further,  the union of the disks is invariant under the $G^\ast$-action, where $G^\ast$ is the automorphism group of the stable noded   Riemann  surface $(S,j,M\cup\si,D)$. Here $M\cup\si$ is viewed as an un-ordered set.
\item[(2)]  Abbreviating the set $W=u(|D|\cup\si)$, there is  a collection of bijective charts around every point $w\in W$, 
    $$
    \psi_w:({\bf R}(w),w)\rightarrow ({\mathbb R}^{2n},0),
     $$
     so that the closures of the domains are mutually disjoint. Moreover, 
     for every $z\in |D|\cup\si$ the image $u(D_z)$ of the disk $D_z$ is contained in 
     ${\bf R}_1(u(z))$.
\item[(3)] The exponential map $\exp$ on the manifold $Q$ is associated with  a Riemannian metric $g$, which on the open sets ${\bf R}_4(w)$ is the pull-back of the standard metric on ${\mathbb R}^{2n}$ by $\psi_w$. Let $\wt{\mathcal O}$ be an open neighborhood of the zero-section in $TQ$, which is fiber-wise convex and has the property 
  that $\exp:\wt{\mathcal O}_q:=\wt{\mathcal O}\cap T_qQ\rightarrow Q$ is an embedding for every $q\in Q$.
\item[(4)]  Every point  $w\in u(\si)$ lies in  a  $(2n-2)$-dimensional submanifold $M_w\subset Q$ such that  $\psi_w(M_w)\subset {\mathbb R}^{2n}$ is a linear subspace.  Moreover, if $w=u(z)$ for $z\in \si$, then the tangent space  $H_w:=T_{w}M_w$ is {a complement} in $T_wQ$ of the image of $Tu(z)$. We point out that near $w$ the manifold  $M_w$  is the image of vectors in $T_wM_w\subset T_wQ$ under the exponential map.
\item[(5)] An open $G$-invariant neighborhood $U$ of the zero-section $0\in H^{3,\delta_0}_c(S, u^\ast TQ)$ so that every section $\eta\in U$ has its image in
    {$u^*\wt{\mathcal O}$ where $\wt{\mathcal O}$ is the  above open neighborhood of the zero-section in $TQ$.}
\item[(6)] {Concentric} subdisks $SD_z$ of $D_z$ with smooth boundaries for all $z\in \si$ so that their union is invariant under $G$.
    \end{itemize}

\begin{itemize}
\item[(7)] If  $z\in \si$, then  the restriction $u|D_z$ is an embedding transversal to $M_{u(z)}$. Moreover, if $z'\in D_z$ satisfies $u(z')\in M_{u(z)}$, then   $z'=z$.
\item[(8)]  For every  section $\eta\in U$ and every $z\in \si$, the map $f:=\exp_u(\eta):S\to Q$
satisfies  $f(D_z)\subset {\bf R}_2(u(z))$ and the restriction $f\vert D_z$ is an embedding transversal to $M_{u(z)}$ and intersects  $M_{u(z)}$ at a single point
$f(z')$ for a unique $z'\in SD_z$.
\item[(9)] Take the small disk structure of (1)  and let $j(a, v)$ be as given in (1).  If for $(a,v,\eta)$ and $(a',v',\eta')$ in $O\oplus U$ the tuples
    $$
    \alpha_{(a,v,\eta)}:=(S_a,j(a,v),M_a,D_a,\oplus_a(\exp_u(\eta)))
    $$
     and
$\alpha_{(a',v',\eta')}$ are isomorphic by some isomorphism  $\phi$, then there exists an automorphism  $g\in G$ satisfying  $\phi(SD_z)\subset D_{g(z)}$ for all $z\in\si$.
\item[(10)] If the isomorphism $\phi$ in (9) is,  in addition,  an isomorphism
$$
\phi:(S_a,j(a,v),(M\cup\si)_a,D_a)\rightarrow (S_{a'},j(a',v'),(M\cup\si)_{a'},D_{a'})
$$
between  the stable nodal  Riemann surfaces,  then $\phi=g_a$ for some $g\in G$ and $(a', v')=g\ast (a, v).$
\end{itemize}
\end{definition}
{The above space $H^{3,\delta_0}_{\textrm{c}}(S, u^*TQ)$ is the   space of sections having matching asymptotic constants near the nodes}. {As a complete norm we can take the sum of finitely many semi-norms obtained
as follows. Around  a point which is not a nodal point,  we fix a small open disk-like neighborhood ${\mathcal U}$  having a smooth boundary and 
not containing  a nodal point. Then we take a biholomorphic map $\psi:{\mathbf D}\rightarrow \cl({\mathcal U})$
and a smooth trivialization $\Gamma: (u^{\ast}TQ)|{\mathcal U}\rightarrow {\mathbf D}\times {\mathbb R}^{2n}$. 
If $\eta$ is a section of $u^\ast(TQ)$,  then $v=pr_2\circ\Gamma\circ \eta\circ \psi$ defines a map on the open unit disk
with image in ${\mathbb R}^{2n}$. Take a smooth function  $\beta:{\bf D}\rightarrow [0,1]$ which has compact support in
the open unit disk and is identically to $1$ on some $\delta$-disk for  $\delta\in (0,1)$ close to $1$. Then the map
$$\eta\mapsto \norm{\beta v}_{H^3({\bf D},{\mathbb R}^{2n})}$$
defines one of the semi-norms we are going to use.  Such constructions already occur in \cite{El}.
Near a nodal pair $\{x,y\}$ we take two open disk-like neighborhoods $D_x$ and $D_y$ with smooth boundaries
so that the images of their closures under the map $u$ lie in the domain of a smooth diffeomorphic chart $\psi$ of the manifold $Q$, 
$$\psi:(O(u(x)),u(x))\rightarrow ({\mathbb R}^{2n},0).$$
Then we take holomorphic polar coordinates on $D_x\setminus\{x\}$ (positive) and $D_y\setminus\{y\}$ (negative), 
denoted by $\sigma_x$ and $\sigma_y$.  Given a section $\eta$ with common asymptotic limit over
$\{x,y\}$,  we consider the pair $(v^+,v^-)$ of maps,  defined by
$$v^+(s,t)=pr_2\circ T\psi(u\circ\sigma_x(s,t))\eta(\sigma_x(s,t))$$
and 
$$v^-(s,t)=pr_2\circ T\psi(u\circ\sigma_y(s',t'))\eta(\sigma_y(s',t')).$$
{The maps} $v^+$ and $v^-$ have the same asymptotic constant, say $c$. Taking a suitable smooth function
$\beta:{\mathbb R}\rightarrow [0,1]$ with support in $(0,\infty)$ and satisfying $\beta(s)=1$ for $s\geq 1$
we define $\beta^+(s)=\beta(s)$ and $\beta^-(s')=\beta(|s|)$.  Now  we define the square of the  semi-norm 
using the usual $(3,\delta_0)$-norms by
$$|c|^2 +\norm{\beta^+(v^+-c)}_{H^{3,\delta_0}}^2 +\norm{\beta^-(v^--c)}_{H^{3,\delta_0}}^2.$$
Using a suitable choice of finitely many  semi-norms of this  type, one can define complete norms
on $H^{3,\delta_0}_{\textrm{c}}(S, u^*TQ)$,   and any such construction will lead to an equivalent norm.}

\begin{proposition}
There exists  good data centered at a stable map  $\alpha$ representing $[\alpha]\in Z$.
\end{proposition}
\begin{proof}
Since the existence of a good uniformizing family is guaranteed by 
Theorem \ref{existence-x}, the proposition follows in view of  Lemma \ref{ax} and Propositions \ref{ay}, up to property (10) which requires the following additional argument. 
If the assumption (10) holds, then we conclude by the properties of a good uniformizing family that 
$\phi=g^\ast_a$ for an automorphism  $g^\ast\in G^\ast$.  However, if we assume,  in addition,  that the open neighborhood 
$U$ of the zero-section of $u^*TQ$ in (5) and the neighborhood $O$ of $(0, 0)$ in (1) are sufficiently small, then $\phi$ is necessarily $C^{\infty}$-close on the core to an automorphism $g$ in $G$. Since $G\subset G^\ast$ is a finite group, we conclude that $\phi=g\in G$. This completes the proof of the proposition.
\end{proof}


 If we have good data centered at  the stable map $\alpha=(S,j,M,D,u)$, with automorphism group $G$,  where the map $u$ is only of class { $(3,\delta_0)$} we can find arbitrarily $H^{3,\delta_0}$-close,  a  smooth map $u'$, which is of class $(m+3,\delta_m)$, for all $m\geq 0$, such  that we have good data centered at $(S,j,M,D,u')$ with the same choice of small disk structure, the same stabilization $\si$ etc. and such  that $u=\exp_{u'}(\eta)$ for an arbitrarily small $\eta\in U'$ and the same automorphism group.  This is  true, since our conditions in the above definition are $C^0$-smallness conditions and,  at the disks around points in $\si$ they are  $C^1$-smallness conditions. We shall refer to good data centered at $(S, j, M, D, u')$ as to {\bf smooth data}. Hence we  {have proved} the following {basic} result.



\begin{theorem}\label{blog}
For every stable map $\alpha=(S,j,M,D,u)$ representing an element in $Z$ there exist good data centered at some smooth stable map  $\alpha'$ of the form
$$
\alpha'=(S,j,M,D,u')
$$
such that  $u=\exp_{u'}(\eta)$ and $\eta$ is an arbitrarily small section in the open neighborhood $U$ of the zero-section of $H^{3,\delta_0}_c((u')^\ast TQ).$
Moreover $\alpha$ and $\alpha'$ have the same automorphism group.
\end{theorem}


\begin{figure}[ht]
\psfrag {u}{$u$}
\psfrag  {uz}{$u(z)$}
\psfrag  {ez}{$\eta (z)$}
\psfrag  {h}{$H_{u(z)}$}
\psfrag  {m}{$M_{u(z)}$}
\psfrag  {ex}{$\exp_u(\eta)$}
\centering
\includegraphics[width=4.1in]{Fig11.eps}
\caption{The linear constraint belonging to $z\in \Sigma$.}
\label{Fig11}
\end{figure}




Next we consider good data centered at a smooth stable map  $\alpha=(S,j,M,D,u)$. If  $z$ belongs to the stabilization set $ \si$, we  introduce the plane  $H_{u(z)}=T_{u(z)}M_{u(z)}\subset T_{u(z)}Q$ in  the tangent space, which we refer to as the linear constraint associated with the point $z\in\si$. 
We note that points $z,z'\in\si$ satisfying  $u(z)=u(z')$ have the same associated constraint. 

In Section \ref{section-implant}  we have described the gluing and anti-gluing into the manifold $Q$.  Starting with the sc-Banach space
$H^{3, \delta_0}_c(S, u^\ast TQ)$ of sections $\eta$ (with matching nodal values) along the smooth map $u:S\to Q$ we define an sc-subspace of finite co-dimension $E_u$ by
$$
E_u=\{\eta\in H_c^{3,\delta_0}(u^\ast TQ)\vert \, \text{$\eta(z)\in H_{u(z)}$ for $z\in \si$}\}
$$
consisting of sections (along the smooth map $u:S\to Q$) satisfying the linear constraint $H_{u(z)}$ at the  points  $z\in \si$.
For every nodal pair $\{x,y\}\in D$ we can implant the family of splicing projections, which initially where defined for sections with matching nodal values 
$(\eta_x,\eta_y)$, where $\eta_x$ is a section of $(u|D_x)^\ast TQ$ and similarly for $D_y$. Near the boundaries of $D_x$ and $D_y$ the projection acts as the identity
and one can extend it to $E_u$ canonically, so that outside of the disks associated to the nodal pair it acts as the identity.
We shall denote it by $\pi^{\{x,y\}}_{a_{\{x,y\}}}$. The projections obtained for the various nodal pairs $\{x,y\}\in D$ commute and we denote by
$\pi_a$ with $a= {(a_{\{x,y\}})}_{\{x,y\}\in D}$ their product. It is defined for all $a$ with $|a_{\{x,y\}}|<\frac{1}{2}$, and therefore  for  $a\in {(B_\frac{1}{2})}^{\# D}$ where ${(B_\frac{1}{2})}^{\# D}$ is the cartesian product of $\# D$-copies of $B_{\frac{1}{2}}$.

We view the parameters $(a, v)$ as splicing parameters,  though $v$ is actually ineffective,  and  define the splicing core $K$ on $E_u$ as the set 
$$
K=\{(a, v,\eta)\vert\, \text{$ (a, v)\in O,\, \eta\in E_u$ and $\pi_a(\eta)=\eta$}\}
$$
{where $O$ is an open subset of the complex linear parameter space $(a, v)$ and $a\in (B_{\frac{1}{2}})^{\# D}$.}
In the following we shall abbreviate by  ${\mathcal O}$ the subset 
\begin{equation}\label{paraset}
{\mathcal O}=\{(a,v,\eta)\in K\vert \, \text{$(a,v)\in O$ and $\eta\in U\cap E_u $ }\},
\end{equation}
{where $U$ is the open neighborhood of the zero section $0\in H^{3,\delta_0}(S, u^*TQ)$ postulated in property (5) of the good data in Definition \ref{GD}.} The set  ${\mathcal O}$ is an open subset of the splicing core $K$.



\begin{definition}[{\bf Good uniformizing family of stable maps}]\label{def_g_uni_f_stable_maps}
{We assume we have good data (according to Definition \ref{GD}) centered at the smooth stable map $\alpha=(S, j, M, D, u)$ with automorphism group $G$, and consider the good uniformizing family 
$$
(a,v)\mapsto  \alpha_{(a,v)}:=(S_a,j(a,v),(M\cup \Sigma)_a,D_a), \quad  (a,v)\in O,
$$
of stable noded Riemann surfaces according to condition (1) in the Definition \ref{GD}.
Then the associated family of stable maps 
$$
(a,v,\eta)\mapsto  \alpha_{(a,v,\eta)}:=(S_a,j(a,v),M_a,D_a,\oplus_a\exp_u(\eta)), \quad  (a,v,\eta)\in {\mathcal O}, 
$$
is called a {\bf good uniformizing family of stable maps  centered at the smooth stable map} $\alpha=(S, j, M, D, u)$. } \index{good uniformizing family}
\end{definition}

From  
Theorem \ref{blog} one concludes immediately the following proposition. 
\begin{proposition}\label{imremark}
Given an element $[\alpha']\in Z$ in the space of stable maps,  there exists a good uniformizing family
$
(a,v,\eta)\mapsto  \alpha_{(a,v,\eta)}$, 
$(a,v,\eta)\in {\mathcal O}$, 
centered at a smooth $[\alpha]\in Z$,  and there exists a parameter $(a_0, v_0, \eta_0)\in {\mathcal O}$ for which  
$$[\alpha']=[\alpha_{(a_0,v_0,\eta_0)}].$$
\end{proposition}

\begin{definition}
If $G$ is the automorphism group of the stable map $(S, j, M, D, u)$,  the action of $G$ on ${\mathcal O}$ is defined by 
$$g\ast (a, v, \eta)=(a', v', \eta'),\qquad g\in G,$$
where 
$(a', v')=g\ast (a, v)$ and $\eta'\circ g=\eta$.
\end{definition}
\begin{proposition}\label{reremark1}
If  $(a, v, \eta)\mapsto \alpha_{(a, v, \eta)}$, $(a, v,\eta)\in {\mathcal O}$,  is a  good uniformizing family {of stable maps}, and 
$$[\alpha_{(a, v, \eta)}]=[\alpha_{(a', v' , \eta')}]$$
for two parameters $(a, v, \eta)$ and $(a', v', \eta')$ in ${\mathcal O}, $ 
then there exists an automorphism $g\in G$ satisfying
$$(a', v', \eta')=g\ast (a, v, \eta)$$
and  every isomorphism  between the two stable maps is of the form
$$g_a:\alpha_{(a, v,\eta)}\to \alpha_{(a', v', \eta')}.$$
\end{proposition}
\begin{proof}
By assumption there exists an isomorphism 
\begin{equation*}
\begin{split}
&\phi:\alpha_{(a, v, \eta)}=(S_a, j(a, v), M_a, D_a, \oplus_a (\exp_u (\eta)))\\
&\phantom{=======}\to 
\alpha_{(a', v', \eta')}=(S_{a'}, j(a', v'), M_{a'}, D_{a'}, \oplus_{a'} (\exp_u (\eta')))
\end{split}
\end{equation*}
satisfying 
$$\oplus_a (\exp_u (\eta))= \oplus_{a'} (\exp_u (\eta'))\circ \phi.$$
Take a point $z\in \si$ in the stabilization. Such a point lies, by construction, at a  finite distance  to the core 
part of $S$ which can be identified with the core part of $S_a$. Since the gluing takes place in the discs of the small disk structure, we have 
$\oplus_a (\exp_u (\eta)) (z)=\exp_{u (z)} (\eta (z))$ at $z\in\si$, and $\eta (z)\in H_{u(z)}\subset T_{u(z)}M_{u(z)}\subset T_{u(z)}Q.$

In view of the data (2), (6),  and (8), the restricted map $\exp_u (\eta)\vert D_z$ is an embedding of the disk $D_z$ which is transversal to the manifold $M_{u(z)}$ and intersecting $M_{u(z)}$ in the single point $z$. Here we have used that  the manifold $M_{u(z)}$ is totally geodesic. By the data (9), there exists an automorphism $g\in G$ satisfying
$$\phi (SD_z)\subset D_{g(z)}.$$
By definition of $G$, $u(g(z))=u(z)$ and hence,
$$\exp_u (\eta')\circ \phi(z)=\exp_u (\eta) (z)\in M_{u(z)}=M_{u(g(z))}.$$
Similarly, the map $\exp_u (\eta')\vert D_{g(z)}$ is an embedding of $D_{g(z)}$ and intersects the manifold $M_{u(g(z))}$ in precisely one point, namely in $g(z)$. Since $\phi (z)\in D_{g(z)}$, we therefore conclude that 
$$\phi (z)=g(z).$$
Hence, if $z\in \si$, then also $\phi (z)\in \si$ and consequently $\phi$ is an isomorphism
$$(S_a, j(a, v), (M\cup \si)_a, D_a)\to (S_{a'}, j(a', v'), (M\cup \si)_{a'}, D_{a'})$$
of nodal Riemann surfaces. In view of the data (10), there exists an automorphism $g\in G$ satisfying  $(a', v')=g\ast (a, v)$ and $\phi=g_a$. On the core part of $S$ we therefore have $g_a=g$ and hence, using $ u\circ g=u$,
$$
\exp_u (\eta')\circ g=\exp_u (\eta'\circ g)=\exp_u (\eta).
$$
Therefore, $\eta'\circ g=\eta$ on the core of $S$. The isomorphism $g_a$ maps 
$Z_{a_{\{x, y\}}}^{\{x, y\}}$ onto $Z_{a_{\{g(x), g(y)\}}}^{\{g(x), g( y)\}}$ for all nodal pairs $\{x, y\}\in D$.  
Using the definition of $g_a$, the fact that $u\circ g=u$ and the assumptions $\pi_a(\eta)=\eta$ and $\pi_a(\eta')=\eta'$, it follows that $\eta'\circ g=\eta$ on all of $S$.
This finishes the proof of Proposition \ref{reremark1}.
\end{proof}

{The next theorem  is the key result for proving the sc-smooth compatibility of good uniformizers. It is also important 
for the topological considerations later on.}


\begin{theorem}\label{key-z}
We consider two good uniformizing families of stable maps $q\mapsto  \alpha_{q}$ parametrized by  $q\in {\mathcal O}$ and $q'\mapsto  \alpha_{q'}'$ parametrized $q'\in {\mathcal O}'$. We assume that for two points  $q_0\in O$ and $q_0'\in O'$ there exists an isomorphism 
$$
\phi_0:\alpha_{q_0}\rightarrow \alpha_{q_0'}'
$$
between the associated stable maps. 
Then there exist a unique local germ of an sc-diffeomorphism 
$$f:({\mathcal O}, q_0)\to ({\mathcal O}', q_0'),\quad q\mapsto q'=f(q)$$
between the parameter spaces  satisfying $f(q_0)=q_0'$ and there exists a core-smooth germ of a family $q\mapsto  \phi_q$ of isomorphisms
$$\phi_q:\alpha_q\to \alpha_{f(q)}'$$
satisfying  $\phi_{q_0}=\phi_0$.
\end{theorem}

\begin{proof}

The proof proceeds in several steps. We first choose the set $\si'\subset S'$ of stabilizing points. 
The set satisfies, by definition, $\si'\cap (M'\cup \abs{D'})=\emptyset$ and $u'(\si')\cap u'(M'\cup \abs{D'})=\emptyset$.  The preimage of $\si'$ under the postulated diffeomorphism 
$\phi_0:S_{a_0}\to S_{a_0'}'$ is denoted by 
$$\Theta_0=\phi^{-1}_0(\si')\subset S_{a_0}.$$
The subset $\Theta_0$ is different from the nodal points $D_{a_0}$ and different from the marked points $M_{a_0}$, and the nodal Riemann surface 
$$(S_{a_0}, j(a, v), M_{a_0}\cup \Theta_0, D_{a_0})$$
is stable. Moreover, it is possible that $\Theta_0$ contains points lying in the neck regions of $S_{a_0}$. Considering $(a, v)$ close to $(a_0, v_0)$, we denote by $\Theta\subset S_a$ a deformation of $\Theta_0$ as defined in Section \ref{dm-subsect}. Therefore, we deduce from the universal family property of the stabilized target family (Theorem \ref{smoothfamily}) the following result. 
\begin{lemma}\label{lem4.19}
There exists a germ of a smooth map
$$(a, v, \Theta)\to (a' (a, v,\Theta), v'(a, v, \Theta))$$
satisfying 
$$(a' (a_0, v_0,\Theta_0), v'(a_0, v_0, \Theta_0))=(a_0', v_0'),$$
and there exists an associated core-smooth germ of isomorphisms 
$$\phi_{(a, v, \Theta)}:(S_a, j(a, v), M_a\cup \Theta, D_a)\to 
(S_{a'}, j'(a', v'), (M'\cup \si')_{a'}, D_{a'}), $$
where 
$a'=a'(a, v, \Theta)$ and $v'=v'(a, v, \Theta)$, satisfying 
$$\phi_{(a_0, v_0, \Theta_0)}=\phi_0.$$
\end{lemma}
By definition of an isomorphism between stable maps,  the diffeomorphism $\phi_0:S_{a_0}\to S'_{a_0'}$ satisfies
$$\oplus_{a_0}\exp_u (\eta_0)=\oplus_{a_0'}'\exp_{u'}'(\eta'_0)\circ \phi_0.$$
If $z\in \Theta_0$, then $\phi_0(z)=z'\in \si'$ and therefore
$$\oplus_{a_0}\exp_u (\eta_0)(z)=\oplus_{a_0'}'\exp_{u'}'(\eta'_0)(z')\in M'_{u'(z')}.$$
Hence the map $\oplus_{a_0}\exp_u (\eta_0):S_{a_0}\to Q$  intersects the embedded  submanifold $M'_{u(z')}$ at the point $z$ transversally, and we call the transversal intersection point $z=z(a_0, v_0,\eta_0)\in S_{a_0}$. 
If $(a, v,\eta)$ is close to $(a_0, v_0,\eta_0)$ on level $0$  and hence in the $C^1$-topology, it follows from Proposition \ref{n-prop2.24} that also the nearby maps 
$\oplus_a\exp_u(\eta):S_a\to Q$ intersect the manifold $ M'_{u'(z')}\subset Q$  transversally at the unique points $z(a, v, \eta)\in S_a$ so that 
$$\oplus_a\exp_u (\eta)(z(a, v, \eta))\in  M'_{u'(z')}.$$
Moreover, the map
$$(a, v,\eta)\mapsto z(a, v,\eta)\in S_a$$
is sc-smooth in the following sense,  considering the  fact that the target surface depends on $a$. Abbreviating $q=(a, v,\eta)$ and assuming that $z(q_0)$ lies in the core region of $S$, we can  consider the map $q \to z(q)$ as a map into the fixed surface $S$. If the point $z(q)$ lies in  a nontrivially glued neck, we describe the map with respect to the two distinguished polar coordinate systems 
$[s,t]$ or $[s',t']$ and the maps obtained this way are sc-smooth. Hence we obtain the sc-smooth germ 
$$q\to \Theta_q=\{z(q)\}$$
for $q=(a, v,\eta)$ near $q_0$ and we  can summarize the discussion as follows.
\begin{lemma}\label{lem4.20}
Let $\Theta_q$ consist of the unique points $z(q)=z(a, v,\eta)\in S_a$ at which 
$$
\oplus_a\exp_u(\eta)(z(q))\in M'_{u'(z')},\ \text{some}\ \ z'\in\Sigma'.
$$
Then the germ $q\to \Theta_q$ at $q_0$ is sc-smooth in the sense defined above.
\end{lemma} 
Recalling from Lemma \ref{lem4.19} the germ of a  smooth map 
$$(a, v,\Theta)\mapsto (a'(a, v, \Theta), v'(a, v, \Theta))$$  and the associated germ $(a, v, \Theta)\to \phi_{(a, v, \Theta)}$ of isomorphism, we define 
the germ of a smooth map as the following composition of maps 
\begin{align*}
a'(a,v,\eta):&=a'(a, v, \Theta_{(a, v,\eta)})\\
v'(a,v,\eta):&=v'(a, v, \Theta_{(a, v,\eta)})
\end{align*}
and introduce the associated core-smooth germ $q\to \phi_q$ of isomorphisms 
\begin{equation*}
\begin{split}
\phi_{(a, v,\eta)}&:=\phi_{(a, v, \Theta_{(a, v, \eta)})}:\\
&(S_a, j(a, v), M_a\cup \Theta_{(a, v, \eta)}, D_a)\to 
(S_{a'}, j'(a', v'), (M'\cup \si')_{a'}, D'_{a'})
\end{split}
\end{equation*}
where 
$a'=a'(a,v,\eta)$ and $v'=v'(a,v,\eta)$ and where $(a, v, \eta)$ is close  to $(a_{0},v_{0}, \eta_{0})$. Then 
\begin{gather*}
\phi_{(a_0, v_0, \eta_0)}=\phi_0\\
(a'(a_0,v_0,\eta_0), v'(a_0,v_0,\eta_0)=(a'_0, v'_0).
\end{gather*}
In view of Lemma \ref{lem4.19} and Lemma \ref{lem4.20}, and using the chain rule, we obtain the following lemma.
\begin{lemma}\label{lem4.21}
The germ 
$$(a, v,\eta)\to (a'(a, v, \eta), v'(a, v, \eta))$$
is sc-smooth near $(a_0, v_0, \eta_0)$.
\end{lemma}
At this point we have constructed near $q_0=(a_0, v_0, \eta_0)$ the sc-smooth germ 
$$q\to (a'(q), v'(q))$$
of functions and the associated core-smooth germ $q\to \phi_q$ of isomorphisms 
\begin{eqnarray*}
&\phi_q:
(S_a, j(a, v), M_a\cup \Theta_q, D_a)\to\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ &\\ 
&\ \ \ \ \ \ \ \ \ \ \ \ (S_{a'(q)}, j'(a'(q), v'(q)), (M'\cup \si')_{a'(q)}, D'_{a'(q)})&
\end{eqnarray*}
where $q=(a, v,\eta)$. It satisfies, in particular, 
$$
\phi_q(z(q))=z'\in \si'\ \ \text{for some}\ \ z'\in\Sigma'.
$$
By construction of $z(q)$, the maps 
$$(\oplus_a\exp_u(\eta))\circ \phi_{(a, v,\eta)}^{-1}:S'_{a'(a, v,\eta)}\to Q$$
are at the points $z'\in \si'$ transversal to the submanifolds $M_{u'(z')}'$. 

We recall that at $q_0=(a_0, v_0, \eta_0)\in {\mathcal O}$, the map $\phi_{q_0}=\phi_0$ satisfies
$$\oplus_{a'(q_0)} \exp'_{u'}(\eta'_0)=\oplus_{a'_0} \exp_{u}(\eta_0)\circ \phi_{q_0}^{-1}.$$
With the following lemma the proof of Theorem \ref{key-z} is complete.
\begin{lemma}\label{lem4.23}
For $q=(a, v,\eta)$ near $q_0=(a_0, v_0, \eta_0)$ there exists a uniquely defined section $\eta'(q)$ of the bundle $(u')^\ast TQ$ near the section $\eta_0'$, satisfying 
$$
\oplus_{a'(q)} \exp'_{u'}(\eta'(q))=\oplus_{u} \exp_{u}(\eta)\circ \phi_{q}^{-1},
$$
and  the linear constraint conditions,  and $(a'(q), v'(q),\eta'(q))\in {\mathcal O}'$. In addition, 
$$q\to \eta'(q)$$
is an sc-smooth map.
\end{lemma}
\begin{proof}
The  formula 
$$
\oplus_{a'(q)} \exp'_{u'}(\eta')=\oplus_{a} \exp_{u}(\eta)\circ \phi^{-1}_q\ \ \text{and}\ \  \ominus_{a'(q)} \eta'(q)=0
$$
determines the section $\eta'$ as a function of $q$ in a local way and the following observations simplify our task.\\

{\bf Observation 1:}  Using a partition of unity argument in the target $S'$ it suffices to show that $\eta'$ restricted to suitable subsets, as a function of $(a,v,\eta)$ is sc-smooth. The suitable subsets are either small open subsets whose closures do not contain nodal points or small open neighborhoods of nodal points.\\

 We can consider $\eta$ as a variable or alternatively $\exp_u(\eta)$, since the map $\eta\rightarrow \exp_u(\eta)$ is level-wise smooth,  a classical nonlinear analysis fact, which is used in  the construction of manifolds of maps in \cite{El}.\\

{\bf Observation 2:} If $z_0'$ is a point which is not a nodal point
in $|D_{a_0'}'|\subset S'$,  the section $\eta'$ near $z_0'$ is determined by
$\eta$ near $z_0:=\phi_{(a_0,v_0,\eta_0)}^{-1}(z_0')$ and $z_0$ is not a nodal point in $|D_{a_0}|$.\\

If $z'_0\in S'_{a'}$ lies outside of the discs of the small disk structure of $S'$ we have, in a neighborhood of $z'_0$ for $q$ near $q_0$,
$$\oplus_{a'(q)}\exp'_{u'}(\eta')=\exp_{u'}'(\eta').$$
In this case the section $\eta'$ near $z_0'$ is determined by the formula 
$$\eta'=(\exp'_{u'})^{-1}\circ \oplus_a\exp_u(\eta)\circ \phi_q^{-1}.$$
Since the isomorphism $\phi_q=\phi_{(a, v, \Theta_q)}$ is core-smooth and $q\to \Theta_q$ is smooth, it follows from Theorem \ref{action-diff} and Lemma \ref{lem4.20} using the chain rule, that the right hand side depends sc-smoothly on $q$. 

If $z_0'$ is in a neck we can study the two equations
\begin{align*}
\oplus_{a'(q)}\exp'_{u'}(\eta')&= \oplus_a\exp_u(\eta)\circ \phi_q^{-1}\\
\ominus_{a'(q)}(\eta')&=0
\end{align*}
in an open neighborhood of $z_0'$. Again the right hand side depends sc-smoothly on $q$. In the polar coordinates on the discs one sees that  the unique solution $\eta'=\eta'(q)$ on a neighborhood of $z_0'$ is, 
{in view of Proposition \ref{ay} and Proposition \ref{az}}, guaranteed by Theorem \ref{theorem_neck}.
Moreover, $(a'(q), v'(q),\eta'(q))\in {\mathcal O}$ and $q\to \eta'(q)$ is sc-smooth. 


Finally, we look at a nodal point $z_0'=x$ on $S'$. This implies that also $\phi_0^{-1}(z_0')=z_0$ is a nodal point on $S$. In this case $a_{\{x, y\}}=0$ and $a'_{\{x', y'\}}=0.$  A direct application of Theorem \ref{theorem_neck} implies our assertion. This completes the proof of Lemma \ref{lem4.23}.
\end{proof}
With Lemma  \ref{lem4.23} the proof of Theorem \ref{key-z} is complete.
\end{proof}



\section{Compatibility of Good Uniformizers}\label{sect4.3-pol.str}
In the construction of the polyfold structure on the space $Z$ of stable curves  we shall imitate the Lie groupoid approach to the Deligne-Mumford theory.

We take a good uniformizing family 
$$(a, v, \eta)\mapsto  \alpha_{(a, v, \eta)},\quad \text{where $(a, v,\eta)\in {\mathcal O}$}$$
of stable maps  centered at the smooth stable map  $\alpha=(S, j, M, D, u)$, continue to abbreviate 
$$q:=(a, v, \eta)\in {\mathcal O},$$
and define the graph $\cg$ of the family as the set
$$\cg=\{(q, \alpha_q)\vert \, q\in {\mathcal O}\}.$$
We recall that ${\mathcal O}$ is the open subset of a splicing core introduced in the formula \eqref{paraset} in Section \ref{xA}.  We equip the set $\cg$ with the  topology which turns  the bijective projection map 
$$\pi:\cg\to {\mathcal O},\qquad \pi (q, \alpha_q)=q$$
into a homeomorphism. Then the sc-smooth chart $(\pi, {\mathcal O})$ defines the natural sc-structure on $\cg$ so that $\cg$  is an M-polyfold and the map $\pi:\cg\to {\mathcal O}$ is an sc-diffeomorphism. We shall use the M-polyfolds  $\cg$  the same way we have used the graphs of uniformizing families in the Deligne-Mumford theory. 


{We consider the two M-polyfolds  
$$
\cg=\{(q, \alpha_q)\vert \, q\in {\mathcal O}\}\ \ \text{and}\ \  
\cg'=\{(q', \alpha'_{q'})\vert \, q'\in {\mathcal O}'\},
$$
 where $q=(a,v,\eta)\in{\mathcal O}$ and $q'=(a', v', \eta')\in {\mathcal O}'$. For two points $(q, \alpha_q)\in \cg$ and $(q', \alpha'_{q'})\in \cg'$ for which there exists an isomorphism 
$$\phi:\alpha_q\to \alpha'_{q'}$$
between the stable maps, we form the triple 
$$\Phi:=((q, \alpha_q), \phi, (q', \alpha'_{q'})).
$$
We view $\Phi$ as a morphism $(q,\alpha_q)\rightarrow (q',\alpha_{q'}')$ and write
$$\Phi:(q,\alpha_q)\rightarrow (q',\alpha_{q'}').$$ }
The set of all {morphisms} $\Phi$ will be denoted by 
$$ M(\cg, \cg').$$
The source  map 
$$
s: M(\cg, \cg')\rightarrow \cg$$
is defined by 
$$s((q, \alpha_q), \phi, (q', \alpha'_{q'}))=(q, \alpha_q)$$
and the target map 
$$t: M(\cg, \cg')\rightarrow \cg'$$
is defined by 
$$
t((q, \alpha_q), \phi, (q', \alpha'_{q'}))=(q', \alpha'_{q'}).
$$

Next we equip the set  $M(\cg, \cg')$ with a topology,  defined by means of a neighborhood basis. Let  
$$\wh{\Phi}= ((\wh{q}, \alpha_{\wh{q}}), \wh{\phi}, (\wh{q}',\alpha'_{\wh{q}'}))$$
 be a morphism in  $M(\cg, \cg')$. We are going to define sets ${\mathcal V}$ of  open neighborhoods of $\wh{\Phi}$.  In view of Theorem \ref{key-z},  there exists  a germ of a  local sc-diffeomorphism 
 $$f: {\mathcal O}\to {\mathcal O}',\qquad q\mapsto q'(q)$$ 
 satisfying $f(\wh{q})=\wh{q}'$ and a germ of a core-smooth family 
$$\phi_q:\alpha_q\to \alpha'_{f(q)}$$ of isomorphisms satisfying $\phi_{\wh{q}}=\wh{\phi}.$  We consider  the sets  ${\mathcal V}$ consisting of the morphisms 
$((q, \alpha_q), \phi_q, (f(q), \alpha'_{f(q)}))$ where   $q\in V\subset {\mathcal O}$ and where $V$ is a {sufficiently small} open neighborhood  of $\wh{q}$. We shall show that the sets ${\mathcal V}$ form  a basis  for a Hausdorff  topology on $M(\cg, \cg')$. 
To see this,  we take two such sets ${\mathcal V}_1$ and ${\mathcal V}_2$  containing a morphism 
$\Phi_{q_0}=((q_0, \alpha_{q_0}), \phi_0, (q_0', \alpha'_{q_0'}))$.
The set ${\mathcal V}_1$  consist of triples 
$$
((q, \alpha_q), \phi^1_q, (f_1(q), \alpha'_{f_1(q)}))
$$
 in which  $q\in V_1\subset {\mathcal O}$  where $V_1$ is an open neighborhood of $q_1$, in which  $f_1:V_1\to f_1(V_1)\subset {\mathcal O}'$ is an sc-diffeomorphism satisfying $f_1(q_1)=q_1'$,  and in which $q\mapsto \phi_q^1$,  for $q\in V_1$,  is a core-smooth family  $\phi^1_q:\alpha_q\to \alpha'_{f_1(q)}$ 
of isomorphisms satisfying $\phi^1_{q_1}=\phi_1.$ The set ${\mathcal V}_2$ is defined similarly. It is  centered at  the point $q_2$,  has  the sc-diffeomorphism $f_2:V_2\to f_2(V_2)\subset {\mathcal O}'$, and the core-smooth family $q\mapsto \phi_q^2$ replacing $q_1$, $f_1$, and $q\mapsto \phi_q^1$, respectively. Since $((q_0, \alpha_{q_0}), \phi_0, (q_0', \alpha'_{q_0'}))\in {\mathcal V}_1\cap {\mathcal V}_2$, it follows that $q_0\in V_1\cap V_2$. We next show  that on a  small open neighborhood of $q_0$ contained in $V_1\cap V_2$, the maps $f_1$ and $f_2$ coincide and the two  maps $q\mapsto \phi_q^1$ and $q\mapsto \phi_q^2$ also coincide. We consider  for $q\in V_1\cap V_2$, the following  isomorphisms between the noded surfaces
$$\phi_q^2\circ (\phi_q^1)^{-1}:\alpha'_{f_1(q)}\to \alpha'_{f_2(q)}.$$
At the point $q_0$ we have $f_1(q_0)=f_2(q_0)=q_0'$ and 
$$\phi_{q_0}^2\circ (\phi_{q_0}^1)^{-1}=\phi_0\circ (\phi_0)^{-1}=\text{id}:\alpha'_{q_0'}\to \alpha'_{q_0'}.$$
We claim that $f_1(q)=f_2(q)$ for $q$ close to $q_0$. Indeed,  arguing by contradiction we 
assume that there exists a sequence $(q_k)\subset V_1\cap V_2$ converging to $q_0$ such that  $f_1(q_k)\neq f_2(q_k)$.  In view of Proposition \ref{reremark1} and the fact that the group of automorphisms is finite,  there exists an automorphism $g$  such that $f_2(q_k)=g\ast f_1(q_k)$ for all $k$ and $\phi_{q_k}^2\circ (\phi_{q_k}^1)^{-1}=g_{a_k}$ where the gluing parameter $a_k$ is the first component of $f_1(q_k)$. Since 
$\phi_{q_0}^2\circ (\phi_{q_0}^1)^{-1}=\text{id}$, it follows that $g=\text{id}$ so that $f_2(q_k)=\text{id}\ast  f_1(q_k)=f_1(q_k)$ which is a contradiction. We conclude that indeed  there exists an open  neighborhood  $V_3$ of $q_0$ contained in $V_1\cap V_2$ such that $f_1(q)=f_2(q)$ for all $q\in V_3$.  Using similar arguments and Proposition \ref{reremark1} one shows that also 
$\phi_q^1=\phi_q^2$ for all $q\in V_3$. Consequently, setting $f(q)=f_1(q)=f_2(q)$ and $\phi_q=\phi_q^1=\phi_q^2$ for all $q\in V_3$ and ${\mathcal V}_3=\{((q, \alpha_q), \phi_q, (f(q), \alpha'_{f(q)}))\vert q\in V_3\}$, we conclude that  ${\mathcal V}_3\subset {\mathcal V}_1\cap {\mathcal V}_2$. Hence the  collection of sets ${\mathcal V}$ defines  a basis of the topology on $M(\cg, \cg')$.

\begin{lemma}\label{huasdorff-lemma}
The  topology on $M(\cg, \cg')$ is Hausdorff.
\end{lemma}
\begin{proof}  We take two distinct points  $\Phi_{1}=((q_1, \alpha_{q_1}), \phi_1, (q_1', \alpha_{q_1'}'))$ and $\Phi_{2}=((q_2, \alpha_{q_2}), \phi_2, (q_2', \alpha_{q_2'}'))$
and show that there are two disjoints sets ${\mathcal V}_1$ and ${\mathcal V}_2$ containing $\Phi_{1}$ and $\Phi_{2}$, respectively.
{We consider the following three cases.\\[0.5ex]
{\bf Case 1}.\, $q_1\neq q_2.$\\
{\bf Case 2}.\,  $q_1=q_2$ and $q_1'\neq q_2'$.\\
{\bf Case 3}.\,  $q_1=q_2$, $q_1'=q_2'$, and $\phi_1\neq \phi_2$.}\\[0.5ex]

{In case 1 we take} two disjoint small open  neighborhoods $V_1$ and $V_2$ of $q_1$ and $q_2$, and define  the sets ${\mathcal V}_1=\{((q, \alpha_q), \phi^1_q, (f_1(q), \alpha'_{f_1(q)}))\vert q\in V_1\}$ and ${\mathcal V}_2=\{((q, \alpha_q), \phi^2_q, (f_1(q), \alpha'_{f_2(q)}))\vert q\in V_2\}$. Clearly, ${\mathcal V}_1\cap {\mathcal V}_2=\emptyset$. 


{In case 2 we
find} an open neighborhood $V$ of $q_1=q_2$ such that $f_1(V)\cap f_2(V)=\emptyset$. Then the sets 
 ${\mathcal V}_1=\{((q, \alpha_q), \phi^1_q, (f_1(q), \alpha'_{f_1(q)}))\vert q\in V\}$ and ${\mathcal V}_2=\{((q, \alpha_q), \phi^1_q, (f_2(q), \alpha'_{f_2(q)}))\vert q\in V\}$ are disjoint.
 
 { Finally, in  case 3, we take  a small open neighborhood $V$ of $q_1=q_2$ and apply Proposition \ref{reremark1} to find two  sc-diffeomorphisms $f_1: V\to {\mathcal O}'$ and $f_2:V\to {\mathcal O}'$ satisfying  $f_1(q_1)=q_1'$ and $f_2(q_2)=q_2'$ and the core-smooth families 
 $\phi_q^1:\alpha_{q}\to \alpha'_{f_1(q)}$ and  $\phi_q^2:\alpha_{q}\to \alpha'_{f_2(q)}$ of isomorphisms satisfying $\phi_{q_1}^1=\phi_1$ and $\phi_{q_2}^2=\phi_2$.  } The composition 
 $$\phi_q^{2}\circ (\phi_q^1)^{-1}:\alpha'_{f_1(q)}\to \alpha'_{f_2(q)}$$ 
 is an isomorphism for every $q\in V$ and at $q=q_1=q_2$ we have $\phi_{q_2}^{2}\circ (\phi_{q_1}^1)^{-1}=\phi_2\circ (\phi_1)^{-1}:\alpha'_{q_1'}\to \alpha'_{q_2'}$ which,  by assumption,  is different from the identity map.
Again applying Proposition \ref{reremark1} we find a possibly smaller open neighborhood of $q_1=q_2$, still denoted by $V$, and  an automorphism $g\in G$ different from the identity map satisfying 
$$f_2(q)=g\ast f_1(q)\quad \text{and}\quad  \phi_{q}^{2}\circ (\phi_{q}^1)^{-1}=g_{a(q)}$$
 where the gluing parameter $a$ is the first  component of $f_1(q)$. 
Hence $\phi_q^2=g_{a(q)}\circ \phi_q^1$. Now since the families $q\mapsto \phi^1_q$ and $q\mapsto \phi^2_q$ are core smooth we find an open neighborhood $V$ of $q_1=q_2$ such that $\phi^1_q\neq \phi^2_q$ for all $q\in V$.  Consequently, the sets ${\mathcal V}_1=\{((q, \alpha_q), \phi^1_q, (f_1(q), \alpha'_{f_1(q)}))\vert q\in V\}$ and ${\mathcal V}_2=\{((q, \alpha_q), \phi^2_q, (f_1(q), \alpha'_{f_2(q)}))\vert q\in V\}$ are disjoint. We have verified that our  topology of  $M(\cg, \cg')$ is Hausdorff.
\end{proof}






Recalling  that the topology on $\cg$ is defined by requiring that the projection map $\pi:\cg\to {\mathcal O}$, $\pi (q, \alpha_q)=q$, is a homeomorphism, we see that the source  map $s:M(\cg,\cg')\to \cg$ and the target map $t:M(\cg, \cg')\to \cg'$ are continuous. 
Next we consider, in a small neighborhood of $(q_0, \alpha_{q_0})$,  the  injective map 
$$
\Gamma:\cg\to M(\cg, \cg'),$$
defined by 
$\Gamma (q,\alpha_q)=((q, \alpha_q), \phi_q, (q'(q), \alpha'_{q'(q)}))$, where $q'(q)=f(q)$ with the local sc-diffeomorphism $f:{\mathcal O}\to {\mathcal O}'$ 
guaranteed by Theorem \ref{key-z}.  The compositions $s\circ \Gamma:\cg\to \cg$ and $t\circ \Gamma:\cg\to \cg'$ satisfy 
$$s\circ \Gamma (q, \alpha_q)=(q, \alpha_q)\qquad \text{and}\qquad t\circ \Gamma (q, \alpha_q)=(q'(q), \alpha_{q'(q)}).$$

Therefore, the map $t\circ \Gamma:\cg \to \cg'$ is, in view of Theorem \ref{key-z}, a local sc-diffeomorphism.  We also conclude that the map $\Gamma:\cg\to M(\cg,  \cg')$ is continuous. Since $\Gamma \circ s =\id$, i.e., 
$$\Gamma \circ s ((q, \alpha_q), \phi_q, (q'(q), \alpha'_{q'(q)}))=((q, \alpha_q), \phi_q, (q'(q), \alpha'_{q'(q)})),$$
we see that  $\Gamma$ and $s$ are local homeomorphisms. Therefore, 
the local homeomorphism
$$s:M(\cg, \cg')\to \cg$$
allows us to equip  the space $M(\cg, \cg')$ with an sc-structure which turns the source map $s$ into a local sc-diffeomorphism. Hence also $\Gamma=s^{-1}:\cg\to M(\cg, \cg')$ is a local sc-diffeomorphism and since $t\circ \Gamma (q, \alpha_q)=(q'(q), \alpha'_{q'(q)}):\cg\to \cg'$ is, by Theorem \ref{key-z}, a local sc-diffeomorphism, the target map $t=(t\circ \Gamma )\circ \Gamma^{-1}:M(\cg, \cg')\to \cg'$ is also a local sc-diffeomorphism. We have proved the following proposition.

\begin{proposition}\label{a-key-z}
If $\cg$ and $\cg'$ are equipped with their natural
M-polyfold structures, then the set $M(\cg,\cg' )$ of morphisms has also a natural M-polyfold structure for which the source map $s$ and the target map $t$ 
are local sc-diffeomor\-phisms.
\end{proposition}
Using the same arguments, we obtain the following additional consequence of Theorem \ref{key-z}. 
\begin{proposition}\label{b-key-z}
Consider $\cg$, $\cg',$ and  $M(\cg,\cg')$ equipped with their natural M-polyfold structures. Then,  
\begin{itemize}
\item[{\em (1)}] The unit map
$
u:\cg \rightarrow M(\cg,\cg)$, 
defined by 
$$u(q, \alpha_q)=((q,\alpha_q), \id, (q,\alpha_q)),$$
is an sc-smooth map.
\item[{\em (2)}] The inversion map
$
i: M(\cg,\cg')\rightarrow  M(\cg',\cg)$, defined by 
$$i((q,\alpha_q),\phi,(q',\alpha_{q'}'))= ((q',\alpha_{q'}'),\phi^{-1},(q,\alpha_{q})),$$
is sc-smooth.
\end{itemize}
\end{proposition}
\begin{proof}
By the previous proposition the source map $s:M(\cg, \cg')\to \cg$ is a local sc-diffeomorphism and consequently defines a local sc-smooth chart. The map $u$ is in these local charts represented by $s\circ u=\id$ and hence is an sc-smooth map. The inversion map $i$,  composed with $t$ and the locally inverted $s$,  satisfies
$$t\circ i \circ s^{-1}=\id.$$
Consequently, locally $i=t^{-1}\circ s$ is, by the chain rule, an sc-smooth map, as claimed.
\end{proof}


In order to define the multiplication map, it is useful to first recall the definition of the fibered product and its properties
given in Lemma \ref{ert}.
Now consider the M-polyfolds $\cg$, $\cg'$ and  $\cg''$   of graphs as 
introduced above. Then the multiplication map 
$$
m:M(\cg',\cg''){{_s}\times_t}M(\cg,\cg')\rightarrow M(\cg,\cg'')
$$
on the fibered product  is defined by 
$$m((q', \alpha'_{q'}), \psi, (q'', \alpha''_{q''})), ((q, \alpha_{q}), \phi, (q', \alpha'_{q'})))=
((q', \alpha'_{q'}), \psi\circ \phi, (q'', \alpha''_{q''})).$$
\begin{proposition}\label{c-key-z}
The multiplication map is an sc-smooth map.
\end{proposition}
\begin{proof}
We take two morphisms 
\begin{equation*}
\Phi_1=((q_0, \alpha_{q_0}), \phi_0,(q_0',\alpha'_{q'_0}))\in M(\cg, \cg')
\end{equation*}
and
\begin{equation*}
\Phi_2=((q'_0, \alpha'_{q_0}), \phi'_0,(q_0'',\alpha''_{q''_0}))\in M(\cg', \cg'')
\end{equation*}
satisfying $t(\Phi_1)=s(\Phi_2)$ so that $m(\Phi_2, \Phi_1)\in M(\cg, \cg'')$ is well defined. The source map $s:M(\cg, \cg')\to \cg$ is a local sc-diffeomorphism and the local inverse $s^{-1}$ maps $(q_0, \alpha_{q_0})\in \cg$ into 
$((q_0, \alpha_{q_0}), \phi_0, (q'_{0}, \alpha'_{q_0}))\in M(\cg, \cg')$.  This local diffeomorphism, in view of Theorem \ref{key-z},  is of the  form
$$s^{-1}(q, \alpha_{q})=((q,\alpha_q), \phi_q, (q'(q), \alpha'_{q'(q)}))$$
in  a neighborhood of $(q_0, \alpha_{q_0})$ where $q\mapsto q'(q)$ is a local sc-diffeomorphism of ${\mathcal O}$ mapping $q_0$ into $q'(q_0)=q'_0$. The same holds true for the source map $s_1:M(\cg', \cg'')\to \cg'$. Its local inverse $s_1^{-1}$ mapping 
$(q_0', \alpha_{q'_0}')\in \cg'$ into $((q_0', \alpha'_{q_0}), \phi_0', (q_0'', \alpha_{q_0''}))\in M(\cg', \cg'')$  is of the form 
$$s_1^{-1}(q', \alpha'_{q'})=((q',\alpha'_{q'}), \phi'_{q'}, (q''(q'), \alpha''_{q''(q')}))$$
where 
$q'\mapsto q''(q')$ is a local sc-diffeomorphism mapping $q'_0$ into $q''(q'_0)=q''_0$.  Consequently, 
the inverse $\psi^{-1}$ of an sc-smooth chart 
$$\psi:M(\cg',\cg''){{_s}\times_t}M(\cg,\cg')\to \cg$$ has  the form 
\begin{equation*}
\begin{split}
&\psi^{-1}(q, \alpha_q)\\
&\qquad =\Bigl( 
\bigl((q'(q), \alpha'_{q'(q)}), \phi'_{q'(q)}, (q''(q), \alpha''_{q''(q)})\bigr), 
\bigl( (q, \alpha_{q}), \phi_{q}, (q'(q), \alpha'_{q'(q)})\bigr)
\Bigr).
\end{split}
\end{equation*}
Also the source map $s_2:M(\cg,\cg'')\to\cg$ is a local sc-diffeomorphism and  defines a local sc-smooth chart. 
The representation of the multiplication map $m$ in these local sc-smooth charts becomes $s_2\circ m\circ \psi^{-1}$ which is equal to the identity map. Therefore, the multiplication map $m$ is an sc-smooth map and the proof of Proposition \ref{c-key-z} is complete.
\end{proof}


One often represents a morphism $\Phi\in M(\cg, \cg')$ by the arrow 
$$\Phi:s(\Phi)\to t(\Phi),$$
and if the morphisms  $\Phi\in M(\cg, \cg')$  and $\Psi  \in M(\cg', \cg'')$  satisfy $t(\Phi)=s(\Psi)$ one often writes the multiplication map 
as a composition 
$$m(\Psi, \Phi)=\Psi\circ \Phi:s(\Phi)\to t(\Psi).$$
Moreover, if $i:M(\cg, \cg')\to M(\cg', \cg)$ is the inversion map, one uses for the inverse arrow the notation 
$$\Phi^{-1}:=i(\Phi):t(\Phi)\to s(\Phi).$$


{\section{Compactness %
Properties of $M(\cg,\cg')$}
\label{section_compactness}}
{We next establish compactness properties for a pair of good uniformizers which will be  crucial in the study of the topology of $Z$ later on. We start with the following basic compactness result.}
\mbox{}\\
\begin{theorem}\label{rees}
{Let $\cg=\{(q, \alpha_q)\vert \, q\in \co \} $ be a M-polyfold as defined above, where 
$q\mapsto \alpha_q$, $q=(a, v, \eta)\in \co$, is a good uniformizing family of stable maps, and let  
$\pi:\cg\rightarrow \co $ be the associated sc-diffeomorphism.  Then, for every point $q\in \co$, 
there exists an open neighborhood 
$U^{\cg}(q)\subset \co$ which has the following property.
}

{If $\cg$ and $\cg'$ are two such M-polyfolds and $q\in \co$ and $q'\in \co'$ two points, then every sequence  $\Phi_k \in M(\cg,\cg')$ of morphisms  
 satisfying 
$$\pi\circ s(\Phi_k)\in U^\cg(q)\quad 
 \text{ and} \quad \pi'\circ t(\Phi_k)\rightarrow q'$$
 possesses a subsequence converging  in  $M(\cg,\cg')$.}
\end{theorem}

\begin{remark} 
{The above result will imply that the natural topology ${\mathcal T}$ on the space $Z$ of equivalence classes of stable maps, defined later on,  is Hausdorff and completely regular. These two topological properties of $Z$ will be deduced from the  representation of $Z$ as the orbit space of a M-polyfold  groupoid $(X, {\bf X})$ whose object set $X$ is a disjoint union of M-polyfolds $\cg$ and whose morphism set ${\bf X}$ 
is a disjoint union of morphism sets $M(\cg, \cg')$.}

{It will become apparent later on, that in case we only wish to establish the Hausdorff property of $Z$, it suffices to show for any two given points $q\in \co$ and $q'\in \co'$ that every sequence 
$(\Phi_k)$ of morphisms satisfying $\pi\circ s(\Phi_k)\to q$ and $\pi'\circ t(\Phi_k)\to q'$  possesses a convergent subsequence.} 

{Finally, let us note that we can always replace 
the open neighborhood $U^{\cg}(q)$ quaranteed by Theorem \ref{rees} by a smaller open neighborhood for which  the conclusions of the theorem will still hold.}

\end{remark}


{As a preliminary step in the proof of Theorem \ref{rees} we fix an M-polyfold 
$\cg=\{(q, \alpha_q)\vert \, q\in \co\}$ and a point 
$q_0\in \co$, and start with the construction of the desired open neighborhood $U^\cg(q_0)$.}

{
Our good uniformizer centered around the stable map $(S, j, M, D, u)$   is denoted by 
$$
q\mapsto \alpha_q, 
\quad q=(a, v, \eta)\in \co.
$$
It has the properties listed in the good 
data according to Definition \ref{GD} which will be used heavily in the following constructions.}

{We denote the stabilization set on $(S, j, M, D)$ by $\si$ and view the set $M^\ast:=M\cup \si$ as an unordered set. The noded Riemann surface 
$(S, j, M^\ast, D)$ is stable and has the automorphism group $G^\ast$. The 
automorphism group $G$ of the stable map $(S, j, M, D, u)$ is a subgroup of $G^\ast$.  There exists an open $G^\ast$-invariant neighborhood $O$ of the origin $(0, 0)$  in the parameter space  
$ {\mathbb C}^{\# D}\times E$, where $E$ is the finite dimensional complex vector space which parametrizes the deformations $j(v)$ of the almost complex structure $j$. The map 
$$(a, v)\mapsto (S_a, j(a, v), M^\ast_a, D_a),\quad (a, v)\in O,$$ 
is a good uniformizing family centered at the stable noded surface $(S, j, M^\ast, D)$ according to Definition \ref{citiview}.
}


{
\begin{definition}\label{gf}
 A {\bf family of Riemannian metrics} $g_a$  for the family  $S_a$ of surfaces, where  $a\in B_{(1/2)}^{\# D}$,  consists
 of a choice of a 
Riemannian metric $g_a$ on 
$S_a\setminus |D_a|$ for every parameter value $a$, having the following properties.  The cylinders $Z_{a_{\{x,y\}}}^{\{x,y\}}$  are isometric
to the standard cylinder $[0,R]\times S^1$ equipped with the product metric (if $a_{\{x,y\}}\neq 0$). On  the core regions of $S_a$ (which can can be canonically identified) the metrics are all  the same.  If 
$a_{\{x,y\}}=0$,  the metrics on  the punctured disks $D_x\setminus\{x\}$ and $D_y\setminus\{y\}$ are  isometric to the corresponding half-cylinders $\R^+\times S^1$ and $\R^-\times S^1$, respectively.
\end{definition}
}
{
Every connected component of $S_a$ having its nodal points removed, is now equipped with a metric, which is complete and denoted by $d_a$.
Continuing  with the construction of the open neighborhood $U^\cg(q_0)$ we denote our good uniformizer  by
$$
q\mapsto  \alpha_q=(S_a,j(a,v),M_a,D_a,\oplus_a(\exp_{u}(\eta))),\quad  q\in\co,
$$
where $q=(a, v, \eta)\in \co$ and where $\co$ is an open neighborhood of the origin $(0, 0, 0)$ in the splicing core $K\subset {\mathbb C}^{\# D}\oplus  E\oplus H^{3,\delta_0}_c(u^\ast TQ)$.
We recall that if $(a,v,\eta)\in {\mathcal O}$, then $(a,v)\in O$ and $\eta$ is a section of $u^\ast\tilde{\mathcal O}$ for the specific open neighborhood $\tilde{\mathcal O}$  of the zero-section in $TQ$ introduced in (3) of 
Definition \ref{GD}. }

{Our distinguished point $q_0\in \co$ is given by 
$$q_0=(a_0, v_0,\eta_0).$$
We now take a small open neighborhood $V$ of 
$(a_0, v_0)\in O$ satisfying $\cl (V)\subset O$. 
For the symplectic manifold $(Q,\omega)$ we choose a Riemaniann metric $d_Q$. Then with the metric $g_{a_0}$ already fixed on 
$S_{a_0}\setminus \abs{D_{a_0}}$, the tangent map 
$Tu_0$ of the map $u_0:=\oplus_{a_0}\exp_u(\eta_0):S_{a_0}\setminus \abs{D_{a_0}}\to Q$ is uniformly bounded, in view of the exponential convergence of $\eta_0$ at the ends of the infinite cylinders. }

{For a  given map $w:S_a\rightarrow Q$ we introduce the notation 
$$\norm{Tw}=\sup  \abs{Tw(z)h}_Q,$$
where the supremum is taken over all $z\in S_a\setminus \abs{D_a}$ and $h\in T_zS_a$ having  
norm at most equal to $1$. So, $\norm{Tu_0}<\infty$ as just explained. If $z\in S_a\setminus \abs{D_a}$, we set 
$$\norm{Tw(z)}=\sup \abs{Tw(z)h}_Q,$$
 where the supremum is take over 
all $h\in T_zS_a$ of  norm at most  $1$.
Finally, we choose 
a small open neighborhood $U_0$ of $\eta_0$ in $H^{3,\delta_0}_c(u^\ast TQ)$ having the following properties.
\begin{equation}\label{eq_properties_2}
\begin{aligned}
&\quad (1)\quad  \bigl(\cl (V)\oplus \cl (U_0)\bigr)\cap K \subset \co\\
&\quad (2)\quad 
\text{There exists  a constant $C>0$ such that}
\norm{T(\oplus_a(\exp_u(\eta)))}\leq C\\
&\quad \phantom{(2)}\quad  \text{\ for every $(a,v,\eta)\in V\oplus U_0$.}
\end{aligned}
\end{equation}
The desired neighborhood $U^\cg(q_0)$ is now defined as  
\begin{equation}\label{neighborhood}
U^\cg (q_0) = (V\oplus U_0)\cap K.
\end{equation}
We  note that the closure of $U^\cg(q_0)$ in $\C^{\# D}\oplus  E\oplus H^{3,\delta_0}_c(u^\ast TQ)$ is a subset
of $\co$.
}



\begin{proof}[Proof of Theorem \ref{rees}]
{
We fix $q_0\in \co$ and $U^\cg(q_0)$ as just constructed and consider  a second M-polyfold 
$$\cg'=\{(q', \alpha'_{q'})\vert \, q'=(a', v', \eta')\in \co'\}$$
where $q'\to \alpha_{q'}'$ is a also a good uniformizer around the stable map $(S', j', M', D', u')$ whose automorphism group we denote by $G'$. The stabilization of the noded surface $(S', j', M', D')$ is denoted by $\si'$. We let 
$$q_0'=(a_0', v_0', \eta_0')\in \co'$$
 be the  second distinguished  point. We consider a sequence $(\Phi_k)\in M(\cg, \cg')$ of morphisms 
satisfying
$$
\pi'\circ t(\Phi_k)\rightarrow q_0'\quad \text{and}\quad \pi\circ s(\Phi_k)\in U^\cg(q_0).
$$
and shall show that the sequence $(\Phi_k)$ has a subsequence which converges in $M(\cg, \cg')$. }

{Without loss of generality we may assume, going over to a subsequence, that the sequence  
$$q_k:=\pi \circ s(\Phi_k)=:(a_k,v_k,\eta_k)$$
has the property that 
$$(a_k,v_k)\rightarrow (a,v)\in \cl (V).$$
By assumption, we have the convergence 
$$q_k'=\pi' \circ t(\Phi_k)=(a_k',v_k',\eta_{k}')\to q_0'=(a_0', v_0', \eta_0').$$
 }

{Associated with the sequence $(\Phi_k)\in M(\cg,\cg')$ is the sequence
$$
\phi_k:(S_{a_k},j(a_k,v_k),M_{a_k},D_{a_k})\rightarrow (S_{a_k'}',j'(a_k',v_k'),M_{a_k'}',D_{a_k'}')
$$
of isomorphisms  satisfying 
\begin{equation}\label{condition_5}
(\oplus'_{a_k'}(\exp'_{u'}(\eta_k')))\circ \phi_k = \oplus_{a_k}(\exp_{u}(\eta_k))
\end{equation}
for all $k$. Abbreviating the maps 
$$
u_k'=(\oplus'_{a_k'}(\exp'_{u'}(\eta_k')))\quad \text{and}\quad u_k= \oplus_{a_k}(\exp_{u}(\eta_k)),
$$
\eqref{condition_5} says that %
\begin{equation}\label{condition_6}
u_k'\circ \phi_k=u_k.
\end{equation}
By the assumptions of the theorem,
\begin{equation}\label{condition_7}
u_k'\to u_0'.
\end{equation}
}
{We claim that the gradients of the maps $\phi_k:S_{a_k}\setminus \abs{ D_{a_k} }\to S'_{a_k'}$ are uniformly bounded in $k$. 
\begin{lemma}\label{lemma_3.23}
$$\sup_{ z\in S_{a_k}\setminus \abs{D_{a_k} }, k\geq 1 } \norm{T\phi_k (z)}<\infty.$$
\end{lemma}
}

\begin{proof}[Proof of Lemma 
\ref{lemma_3.23}]
{
Arguing indirectly we
assume that there  is  subsequence (in k) of points $c_k\in S_{a_k}\setminus \abs{D_{a_k}}$ for which 
$$\norm{T\phi_k(c_k)}\to \infty.$$
For this, so called bubbling off sequence $(c_k)$,  we perform a bubbling off analysis. Such an analysis is carried out in detail in Appendix \ref{section5.1}. 
}
{
We start with the first case in which (possibly going over to a subsequence) the points $c_k$ as well as their image points $\phi_k(c_k)$ all lie in a finite distance to the respective core
according to the 
Definition \ref{def_finite_distance_core}. In this case, the result of the bubbling off analysis is a non-constant and injective holomorphic map $\psi:\C\to S_{a_0'}'$ which 
contains at most one marked point from $M_{a_0'}'$ and no nodal points from $\abs{D_{a_0'}'}$. After applying the removable singularity theorem for holomorphic mappings we obtain a non-constant holomorphic map $\wt{\psi}:S^2\to S_{a_0'}'$ whose image, in view of the Hurwitz theorem, has to be a spherical component of $S'_{a_0}$. If this spherical component is stable, it carries at least $3$ special points from 
$M_{a_0'}'\cup \abs{D_{a_0'}'}$, but only $2$ of them can lie in the image of $\wt{\psi}$.
Hence $\wt{\psi}$ cannot be surjective and this case is not possible. If the image of 
$\wt{\psi}$ is an unstable spherical  component of $S_{a_0'}'$, it carries at least one stabilization point 
$z_0'$ from $\si'$. Now we recall that the part of the surfaces $S_{a_k'}'$ at finite distance 
to the core,  can be canonically identified. By definition of a stabilization point, there exists a disk-like neighborhood $D'_{a_0'}(\equiv D'_{a_k'})$  centered at $z_0'$ and  having a smooth boundary $\partial D'_{a_0'}$,  on which the maps $u_k':D'_{a_0'}\to Q$ are all embeddings. We know that 
$u'_k\to u_0'$. In view of $\norm{T\phi_k(c_k)}\to \infty$ we find two sequences $(z^1_k)$ and $(z_k^2)$ on the same component of $S_{a_k}$ which, denoting their images in $S_{a_k'}'$ by  $z_k^{1'}=\phi_k(z_k^1)$ and $z_k^{2'}=\phi_k(z_k^2)$,  have the following properties.
\begin{itemize}
\item[$\bullet$] 
$d_{a_k}(z_k^1,z_k^2)\rightarrow 0$ as $k\to \infty$.
\item[$\bullet$] $z_k^{1'}=z_0'$ and $z^{2'}_k\in \partial D'_{a_0'}.$
\end{itemize}
Hence the distance between  $z_k^{1'}$ and $z_k^{2'}$  is bounded away from $0$
uniformly in $k$.  Since the restrictions of $u_k'$ onto the disk $D'_{a_0'}$ are embeddings and $u_k'\to u_0'$, also the distance
$d_Q(u_k'(z_0'),u_k'(z_k^{2'}))$ is bounded away from $0$ as $k\rightarrow \infty$. }

{
On the other hand, 
$$
d_Q(u_k(z_k^1),u_k(z_k^2))\rightarrow 0
$$
as $k\rightarrow 0$ because, by the assumption \eqref{eq_properties_2} on $U^\cg(q_0)$ the gradients of the maps $u_k$ are  uniformly  bounded in $k$  and
$d_{a_k}(z_k^1,z_k^2)\rightarrow 0$.  However, from $u_k'\circ \phi_k=u_k$ we conclude that 
$$
d_Q(u_k'(z_0'),u_k'(z_k^{2'}))=d_Q(u_k(z_k^1),u_k(z_k^2)).
$$
We again have arrived at a contradiction and see that the first case cannot occur. }

{In the second case we assume that the sequence $(c_k)$ stay in finite distance to the core,   but the images $\phi_k(c_k)$ lie in  cylinders with increasing distance to the core as $k\rightarrow\infty$.
In this case the bubbling off analysis produces an injective non-constant holomorphic map $\psi:\C\to \R\times S^1$, which is impossible.
}

{Now we assume that the  points $c_k$  lie in cylinders,  with increasing distance to the core as $k\rightarrow\infty$. If the images $\phi_k(c_k)$ 
are also in cylinders and  have  increasing distance to the core, we obtain a contradiction as in the previous case.
}


{In the final case the  points $c_k$ lie in cylinders with increasing distance to the core and $\phi (c_k)$ in finite distance
to the core. In this  case the bubbling-off analysis produces an injective and non-constant holomorphic  map $\psi:\C\rightarrow S_{a_0'}'$
which can have at most one nodal point in its  image and no marked points.  Now the arguments of  the first case lead to a contradiction.}

Having exhausted all cases of possible bubbling-off, we conclude that the gradients  $\phi_k$ are indeed uniformly bounded.
\end{proof}

{
Continuing with the proof of  Theorem \ref{rees}, %
the uniform gradient bounds for the sequence $(\phi_k)$ of isomorphisms imply,  by Ascoli-Arzela's theorem,  a $C^\infty_{\textrm{loc}}$ convergence of a subsequence of $(\phi_k)$ in finite distance to the core. 
Using Proposition \ref{gotham} we can pass to the limit $\phi_0=\lim_{k\to \infty}\phi_k$ in $C^\infty_{\textrm{loc}}$. Using 
the postulated convergence $\eta'_k\to \eta'_0$ we conclude from formula 
\eqref{condition_5},  in view of Theorem \ref{theorem_neck},  that $\eta_k$ converges in finite distance 
to the core in the Sobolev norm $H^3$ and then, by Proposition \ref{gotham}, in the neck regions in the $H^{3,\delta_0}_{c}$-norm if the corresponding gluing parameter goes to $0$. We call the limit section $\wh{\eta}_0=\lim_{k\to \infty}\eta_k$. } 



{Recalling  that 
$$\pi' \circ t(\Phi_k)=q_k'=(a_k',v_k',\eta_{k}')\to q_0'=(a_0', v_0', \eta_0')\quad \text{in $\co'$,}$$
we have proved so far also 
the convergence 
$$\pi\circ s(\Phi_k)=q_k=(a_k, v_k, \eta_k)\to  \wh{q}=(a, v, \wh{\eta}_0)\quad \text{in $\co$. }$$
Moreover, we have found the element 
$$\Phi_0=\bigl((\wh{q}_0,\alpha_{\wh{q}_0}),  \phi_0, (q_0', \alpha'_{q'_0})\bigr)\in M(\cg, \cg'),$$
in which $\phi_0:\alpha_{\wh{q}_0} \to \alpha'_{q'_0}$ is an isomorphism between the stable maps.}
 
 { 
 To show that $\lim_{k\to \infty}\Phi_k=\Phi_0$ in $M(\cg, \cg')$, we take a set 
 $\wh{\mathcal V}$ in the basis of the topology of $M(\cg,\cg')$ containing 
 $\Phi_0$,  and show that 
 $\Phi_k\in \wh{\mathcal V}$ for $k$ large.  By definition (based on Theorem \ref{key-z}), 
$$\wh{\mathcal V}=\{\bigl((q, \alpha_q), \psi_q, (f(q), \alpha'_{f(q)})\bigr)\vert \, q\in \wh{\co}\subset \co\},$$
where $\wh{\co}\subset \co$ is a small open neighborhood of $\wh{q}_0\in \co$. 
The local germ of sc-diffeomorphism 
$f:(\wh{\co}, \wh{q}_0)\to (\wh{\co}', q_0')$ between the parameter spaces  satisfies 
$f(\wh{q}_0)=q_0'$. The core-smooth germ of a family $q\mapsto \psi_q$ of isomorphisms 
$\psi_q:\alpha_q\to \alpha'_{f(q)}$ satisfies $\psi_{q_0}=\phi_0$.
}

{
Since  
$$
\psi_{q_k}\circ \phi_k^{-1} :\alpha_{q_k'}'\rightarrow \alpha_{f(q_k)}'
$$
is an isomorphism, there exists, by 
Proposition \ref{reremark1}, an isomorphism $g'\in G'$ of the stable map 
$(S', j', M', D', u')$ satisfying 
$$f(q_k)=g'\ast q'_k\quad \text{and}\quad 
\psi_{q_k}\circ \phi_k^{-1}=(g')_{a_k'}.$$
}
{
In finite distance to core, the sequence 
$\psi_{q_k}\circ \phi_k^{-1}$ converges 
in $C^\infty$ to the indentity map on $S'_{a_0'}$. Therefore, $g'=\text{id}\in G'$. Hence $(g')_{a_k'}=\text{id}$ on $S'_{a_k'}$ and so, $\psi_{q_k}=\phi_k$. Consequently, 
$\Phi_k=\bigl((q_k, \alpha_{q_k}), \phi_k, (q_k', \alpha'_{q_k'})\bigr)\in \wh{\mathcal V}$ for $k$ large and the proof of Theorem \ref{rees} is complete.}
\end{proof}




{\section{The Topology on  $Z$}\label{natural_topology_Z_section}}

We consider a good uniformizer $q\rightarrow \alpha_q$ of {stable maps}  defined on the second countable paracompact Hausdorff M-polyfold $\co$. The associated graph 
$\cg=\{(q, \alpha_q)\vert \, q\in \co\}$ is equipped with the M-polyfold structure making the projection
$\pi:\cg\rightarrow {\mathcal O}$ an sc-diffeomorphism. 
The space ${\mathcal O}$ comes with a finite group action by sc-diffeomorphisms
$$
G\times{\mathcal O}\rightarrow {\mathcal O},\quad (g,q)\mapsto  g\ast q.
$$
The quotient space $G\backslash {\mathcal O}$ is again a second countable paracompact Hausdorff space and the projection map
$$
\pi:{\mathcal O}\rightarrow G\backslash{\mathcal O}
$$
is trivially open since $\pi^{-1}(\pi(U))$ is a finite union
of the diffeomorphic images of $U$ under the  action of $g\in G$. 
In view of Proposition \ref{reremark1}, 
the map
$$
G\backslash{\mathcal O}\rightarrow Z,\quad [a,v,\eta]\mapsto  [S_a,j(a,v),M_a,D_a,\oplus_a(\exp_u(\eta))]
$$
into the space of stable curves is injective.
This implies that there is at most  one choice of sets  defining the topology on $Z$ such  that all such maps are homeomorphisms onto  open sets. 

This leads us to the following definition of a collection ${\mathcal T}$ of subsets of $Z$ as follows.
\begin{definition}
A subset $U$ of $Z$ belongs to ${\mathcal T}$ provided for every $z\in U$ there exists a good uniformizer
${\mathcal O}\ni q\mapsto \alpha_q$ satisfying  $z=[\alpha_{q_0}]$ for some $q_0\in {\mathcal O}$,  and an open neighborhood
$V(q_0)\subset {\mathcal O}$ such that $\{[\alpha_q]\ |\ q\in V(q_0)\}\subset U$.
\end{definition}

The main  result in this section is the following theorem which shows that ${\mathcal T}$ is a metrizable topology.




\begin{theorem}\label{nattop}
The collection ${\mathcal T}$ of subsets of the space $Z$ of stable curves  is a second countable, paracompact, Hausdorff topology which also is completely regular. In view of Urysohn's theorem the topology ${\mathcal T}$ is in particular metrizable.
Moreover the un-noded elements in $Z$ constitute an open and dense subset. There exists a sequence of smooth elements in $Z$ representing
un-noded elements which is dense in $Z$. In particular,  $Z$ is separable.
\end{theorem}

The proof of Theorem \ref{nattop} will be split into several parts.

\begin{lemma}\label{topology}
The collection ${\mathcal T}$ of subsets of $Z$ is a topology on $Z$.
\end{lemma}
\begin{proof}
It is clear that $\emptyset\in {\mathcal T}$. Also $Z\in {\mathcal T}$ since for every element $z\in Z$ there exists
a good uniformizer $q\mapsto \alpha_q$ with $z=[\alpha_{q_0}]$ as was already shown. It follows immediately from the definition
of ${\mathcal T}$ that the  union of elements in ${\mathcal T}$ also belongs to ${\mathcal T}$. If   $U_1,U_2\in {\mathcal T}$, 
we shall show that $U=U_1\cap U_2$ belongs to ${\mathcal T}$. Pick $z\in U$. We find two good uniformizers
${\mathcal O}\ni q\mapsto\alpha_q$ and ${\mathcal O}'\ni q'\mapsto \alpha_{q'}'$ such  that for some $q_0\in \co$ and 
$q'_0\in \co'$, 
$$
z=[\alpha_{q_0}]=[\alpha_{q_0'}'].
$$
Moreover,  there exist open sets  $V(q_0)\subset {\mathcal O}$ and $V'(q_0')\subset {\mathcal O}'$ for which 
$$
\{[\alpha_q]\ |\ q\in V(q_0)\}\subset U_1\ \ \text{and}\ \ \{[\alpha_{q'}']\ |\ q'\in V'(q_0')\}\subset U_2.
$$
Let  $\phi_0:\alpha_{q_0}\rightarrow \alpha_{q_0'}'$ be an isomorphism.  In view of the fundamental Theorem \ref{key-z}
there exists a germ of sc-diffeomorphism $f:({\mathcal O},q_0)\rightarrow ({\mathcal O}',q_0')$ satisfying  $f(q_0)=q_0'$ 
and a core smooth family of isomorphisms $\phi_q$, 
$${\phi_q}:
\alpha_q\rightarrow\alpha_{f(q)}, 
$$
defined for $q$ near $q_0$  and satisfying $\phi_{q_0}=\phi_0$. This implies, for a suitable small open neighborhood $V_1(q_0)$, that the following properties hold.
\begin{itemize}
\item[(1)] $q_0\in V_1(q_0)\subset V(q_0)\subset {\mathcal O}$.
\item[(2)] $V'_1(q_0'):=f(V_1(q_0))$ is open and $q_0'\in V_1'(q_0')\subset V'(q_0')\subset {\mathcal O}'$.
\item[(3)] $[\alpha_q]=[\alpha_{f(q)}']$ for all $q\in V_1(q_0)$.
\end{itemize}
Hence 
$$
\{[\alpha_q]\ |\ q\in V_1(q_0)\}=\{[\alpha_{q'}']\ |\ q'\in V_1'(q_0')\}\subset U_1\cap U_2 =U.
$$
This completes the proof that ${\mathcal T}$ is a topology on $Z$.  
\end{proof}

\begin{lemma}\label{cb}
Every point in the topological space $(Z,{\mathcal T})$ has a countable basis of open neighborhoods.
\end{lemma}
\begin{proof}
Fix $z\in Z$ and take a good unitormizer ${\mathcal O}\ni q\rightarrow \alpha_q$ so that $[\alpha_{q_0}]=z$ for a suitable $q_0\in {\mathcal O}$.  Since ${\mathcal O}$ is a subset of a metric space,  we may assume that $\co$  is equipped with a metric $d$. We 
take a sequence of positive numbers $(\varepsilon_k)$ converging to $0$ and consider the associated open balls $B_{\varepsilon_k}(q_0)$.
Then the associated open sets $V_k\subset Z$,  defined by
$$
V_k=\{[\alpha_q]\ |\ q\in B_{\varepsilon_k}(q_0)\},
$$
constitute  a countable neighborhood basis at  the point $z$. Note that given any other family $q'\rightarrow \alpha_{q'}'$ with
$[\alpha_{q_0'}']=z$,  the associated construction $V'_{k'}$ for a suitable sequence $(\varepsilon_{k'}')$ will lead to  an equivalent basis which can 
easily proved by utilizing  Theorem \ref{key-z} as above.
Indeed, via this theorem one proves that for given $k$ there exist $k'$ and $k''$ such that
$$
z\in V_{k''}\subset V_{k'}'\subset V_k.
$$
\end{proof}
\begin{lemma}\label{hausdorff}
The topology ${\mathcal T}$ is Hausdorff.
\end{lemma}
\begin{proof}
Let $z, z'\in Z$ be two different points. Using the fact that ${\mathcal T}$ has for every point a countable basis of neighborhoods
(Lemma \ref{cb}) we can take a basis of open neighborhoods $(V_k)$ of $z$
and $(V_{k'}')$ of $z'$ so that
$$
V_{k+1}\subset V_k\quad  \text{and}\quad  V_{k+1}'\subset V_k'.
$$
Arguing indirectly we may assume that $V_k\cap V_{k}'\neq \emptyset$ for all $k$,  
so that we find  an element $z_k\in V_k\cap V_k'$ for every $k$.

{We choose  a good uniformizer 
$q\mapsto \alpha_q$ on $\co$
such that $[\alpha_{q_0}]=z$ for some $q_0\in \co$ and abbreviate 
$\cg=\{(q,\alpha_q)\vert \, q\in \co\}$. 
Theorem \ref{rees} guarantees the distinguished open neighborhood 
$U^\cg(q_0)\subset {\mathcal O}$  of $q_0$.  If $k$ is  large, we may assume that  $z_k=[\alpha_{q_k}]$ and $q_k\to q_0$. 
Similarly, we choose for $z'$  the second good uniformizer $q'\rightarrow \alpha_{q'}'$ on ${\mathcal O}'$ such that 
$[\alpha_{q_0'}']=z'$ and represent the sequence $z_k$ by $q_k'\in {\mathcal O}'$ satisfying $q_k'\rightarrow q_0'$. We 
abbreviate $\cg'=\{(q',\alpha'_{q'})\vert \, q'\in \co'\}$. 
Since $[\alpha_{q_k}]=[\alpha_{q_k'}']=z_k$,  we find a sequence 
$\phi_k:\alpha_{q_k}\to \alpha'_{q_k'}$ of isomorphisms which defines the sequence 
$$
\Phi_k=\bigl((q_k,\alpha_k), \phi_k, (q_{k}',\alpha_{q_k'}')\bigr)
$$
of morphisms in $M(\cg,\cg')$. By Theorem \ref{rees}  there exists a convergent subsequence $\Phi_{k_j}\rightarrow \Phi$ in $M(\cg,\cg')$. In view of $q_k\rightarrow q_0$ and  $q_k'\rightarrow q_0'$, the limit  has the form 
$$\Phi=((q_0,\alpha_{q_0}),\phi_0,q_0',(\alpha_{q_0'}'))$$ for the isomorphism $\phi_0:\alpha_{q_0}\to \alpha'_{q_0'}$. 
Therefore, $[\alpha_{q_0}]=[\alpha'_{q_0'}]$ in contradiction to the assumption 
$z\neq z'$. Hence the topology ${\mathcal T}$ must be Hausdorff.}
\end{proof}
\begin{lemma}\label{cr}
The topology ${\mathcal T}$ is completely regular.
\end{lemma}
\begin{proof}
We consider a point $z\in Z$ and a closed subset $A\subset Z$ not containing $z$. We have to construct a continuous map
$\gamma:Z\rightarrow [0,1]$ satisfying $\gamma(z)=0$ and $\gamma(a)=1$ for $a\in A$.

We choose a good uniformizer ${\mathcal O}\ni q\rightarrow \alpha_q$  such  that 
$[\alpha_{q_0}]=z$ for a suitable $q_0\in {\mathcal O}$. We find an open neighborhood $V(q_0)\subset {\mathcal O}$ so that
$A$ and the open neighborhood $V=\{[\alpha_q]\ |\ q\in V(q_0)\}$ of $z\in Z$,  are disjoint.  We choose  an open neighborhood $U^\cg(q_0)\subset {\mathcal O}$ of $q_0$
whose closure (in ${\mathcal O})$ is contained in $V(q_0)$, 
$$
\cl_{\mathcal O}(U^\cg(q_0))\subset V(q_0), 
$$
and such that  for $U^\cg(q_0)$ the assertion of Theorem \ref{rees} holds (see the the remark after this theorem).  If $G_{q_0}=\{g\in G\vert g\ast q_0=q_0\}$ is the stabilizer of $q_0$
we may assume by  replacing $U^\cg(q_0)$ and $V(q_0)$  by  possibly smaller neighborhoods,  that,  in addition to the already stated
properties,  the open sets $U^\cg(q_0)$ and $V(q_0)$ are  invariant under $G_{q_0}$. We choose a continuous map
$\tilde{\gamma}:V(q_0)\rightarrow [0,1]$ which vanishes at $q_0$ and is $G_{q_0}$-invariant and takes
the value $1$ on $V (q_0)\setminus U^\cg(q_0)$. Passing to $Z$ we obtain a continuous map $\gamma_1:V\rightarrow [0,1]$ on the 
 open neighborhood $V$ of $z$ which is  disjoint from  $A$. 
 
 The open neighborhood 
$U=\{[\alpha_q]\vert \, q\in U^\cg(q_0)\}$ of $z$ is contained in $V$, and 
$$\text{$\gamma_1(z)=0$ \quad and \quad $\gamma_1(\zeta)=1$ for $\zeta \in V\setminus U$.}$$
Note that we cannot conclude without further work that the closure of $U$ in $Z$ is contained in $V$ despite the fact that
$\cl_{\mathcal O}(U^\cg(q_0))\subset V(q_0)$.
Let us define the map $\gamma:Z\rightarrow [0,1]$ by extending the map $\gamma_1$ outside
of $V$ by $1$. The main work consists in proving the continuity of the map $\gamma$. Since, By Lemma \ref{cb},  every point has
a countable neighborhood basis of open sets,  we can argue with sequences. 

{
Let $b\in Z$ and let $b_k\rightarrow b$.
We distinguish the two cases $b\in V$ and $b\not \in V$,  and start with the case that $b\in V$. Then $b=[\alpha_{q_b}]$ for some $q_b\in {\mathcal O}$ and  $b_k=[\alpha_{q_k}]$ for $k$ large,  where 
$q_k\rightarrow q_b$ in ${\mathcal O}$.
Now,  $\gamma(b_k)=\tilde{\gamma}(q_k)\rightarrow \tilde{\gamma}(q_b)=\gamma(b)$ and $\gamma$ is continuous at such
a point $b$. }


{
Next we consider the second case, assuming that $b\in Z\setminus V$.
Then $\gamma(b)=1$, by definition of 
$\gamma$,  and we  have to show that $\gamma (b_k)\to 1$. If $b_k\not \in V$, then  $\gamma(b_k)=1$ and  so we may assume without loss of generality that $b_k\in V$ for all $k$. We take a 
good uniformizer $q''\rightarrow \alpha_{q''}''$ on $\co''$ satisfying  $b=[\alpha_{q''_0}'']$ for some $q_0''\in \co''$. 
For large
$k$ we can represent the points $b_k$ in the form $b_k=[\alpha''_{q_k''}]$ where $q_k''\rightarrow q_0''$ in ${\mathcal O}''$. 
We can also represent  them  using the good uniformizer $q\mapsto \alpha_q$ on $\co$ in the form $b_k=[\alpha_{q_k}]$ and  $q_k\in {\mathcal O}$. If $q_k\not\in V(q_0)$,  then
$\gamma(b_k)=1$ and if $q_k\in V(q_0)\setminus U^\cg(q_0)$ then also $\gamma (b_k)=1$.  Hence we may assume that $q_k \in U^\cg(q_0)$.}

{ We shall see that this case is impossible,
which then completes the proof that $\gamma$ is continuous at $b$.}

{ Since $[\alpha_{q_k}]=[\alpha''_{q_k''}]$, there exists a sequence 
$
\phi_k:\alpha_{q_k}\rightarrow \alpha_{q_k''}''
$
of isomorphisms. Abbreviating $\cg''=\{(q'', \alpha''_{q''})\vert \, q''\in \co''\},$ we obtain the sequence 
$$\Phi_k=\bigl((q_k, \alpha_{q_k}), \phi_k, (q''_k, \alpha''_{q_k''})\bigr)$$ 
of morphisms 
in $M(\cg, \cg'').$ 
Since $q_k\in U^\cg(q_0)$, we know from Theorem \ref{rees} that every subsequence  $(\Phi_{k_j})$ of the sequence $(\Phi_k)$ possesses a 
a convergent subsequence $(\Phi_{k_{j_l}})$ so that 
$$
\Phi=
\lim_{l\rightarrow\infty} \Phi_{k_{j_l}}\quad \text{in $M(\cg, \cg'')$}.
$$
Consequently, there exists an isomorphism $\phi_0:\alpha_{q}\rightarrow \alpha_{q_0''}''$ for some  $q\in \cl(U^\cg(q_0))\subset V(q_0)\subset \co$.
Therefore, 
$b=[\alpha_{q_0''}'']=[\alpha_{q}]\in V$ contradicting our assumption that $b\in Z\setminus  V$ and completing the proof of Lemma \ref{cr}. 
}
\end{proof}


Continuing with the proof of Theorem \ref{nattop}, we consider triples $(S,M,D)$ consisting of a closed oriented surface $S$ having perhaps several connected components,  equipped with a finite ordered
set $M$ of marked points, and a finite set of nodal pairs $D$, such  that $|D|\cap M=\emptyset$. Two such triples
$(S,M,D)$ and $(S',M',D')$ are called diffeomorphic if  there exists a smooth orientation-preserving diffeomorphism
$\phi:S\rightarrow S'$ mapping $M$ bijectively to $M'$, preserving the ordering of the points, and mapping $D$ to $D'$.
The diffeomorphism class of $(S,M,D)$, denoted by $[[S,M,D]]$,  is the class of triples diffeomorphic to $(S,M,D)$.
We denote by $\Delta$ the set of all diffeomorphism types. It is countable set. 


On our space $Z$ of stable curves, we  introduce the  map
$$ 
\text{type}:Z\rightarrow \Delta:[(S,j,M,D,u)]\rightarrow[[S,M,D]].
$$
Given a type $d\in\Delta$,  we denote by $Z_d$ the subset of $Z$ consisting of the elements having the prescribed type $d$.
For example,  if  
$d_{g,k}=[[S,M,\emptyset]]$, where $S$ is a  connected surface of genus $g$,  and  $M$ is an ordered set of $k$ marked points, then 
the set $Z_{d_{g,k}}$ consists of the un-noded elements of genus $g$ with $k$ {ordered} marked points.
Note that for certain types $d$,  the set $Z_d$ can be  empty. For example,  if $Q=T^{2n}$, then $Z_{d_{0,0}}=\emptyset$.
Indeed, a map $u:S^2\rightarrow T^{2n}$ is contractible and hence  the  tuple  $(S^2,j,\emptyset,\emptyset,u)$ cannot be a stable map.

{
For every type $d\in\Delta$,  the subset $Z_d\subset Z$,  equipped with the topology induced  from $(Z,{\mathcal T})$,  is, in view of Lemma \ref{hausdorff}, a Hausdorff
topological space,  denoted by 
$(Z_d,{\mathcal T}_d)$.}

{
We now fix a type $d\in\Delta$ represented  by the triple $(S,M,D)$.  Then every element 
$z\in Z_d$ has a representative of the form 
$(S,j,M,D,u)$, where $j$ is a smooth almost complex structure on $S$ which determines  the orientation of $S$,  and the map $u$ belongs to the space $H^{3,\delta_0}_c(S,Q)$. 
We recall that the map $u$ is 
 of class $H^3_{loc}$ away from the nodes  and at the nodes of class $(3,\delta_0)$ with matching nodal values over the nodal pairs. }
 
{ We note that  $H^{3,\delta_0}_c(S,Q)$  is a smooth Hilbert manifold. If  $f:Q\rightarrow {\mathbb R}^N$ is a smooth embedding of $Q$ into a high dimensional Euclidean space, we obtain the  smooth embedding  
$$F: H^{3,\delta_0}_c(S,Q)\rightarrow H^{3,\delta_0}_c(S,{\mathbb R}^N)$$  given by  the composition 
$
F(u)=f\circ u.
$
The topology on $H^{3,\delta_0}_c(S,Q)$  corresponds to the topology of the embedded 
space $F(H^{3,\delta_0}_c(S,Q))\subset 
H^{3,\delta_0}_c(S,{\mathbb R}^N)$. The embedding induces a complete metric on $H^{3,\delta_0}_c(S,Q)$,  denoted by $\tau$.}

{Also the space 
of smooth almost complex structures on $S$ determining the given orientation of $S$
is a complete metric space,  denoted  by $(J_d,\rho_d)$.  By $H_d\subset H^{3,\delta_0}_c(S,Q)$ we denote  the open subset
consisting}  {of all stable maps 
$(S, j, M, D, u)$.
We equip $H_d$  with the induced metric, denoted by $\tau_d.$
The canonical map
$$
\Phi_d:J_d\times H_d\rightarrow Z_d
$$
is defined by 
$\Phi_d(j,u)=[(S,j,M,D,u)].$}
\begin{lemma}\label{ium}
For every  type $d\in\Delta$ the canonical map $\Phi_d:J_d\times H_d\rightarrow Z_d$ is continuous and open.
Moreover,  the map $\Phi_d$ is surjective.
\end{lemma}
\begin{proof}
We fix a point $(j_0,u_0)\in J_d\times H_d$ and let 
{
$$\alpha_0=
\Phi_d(j_0,u_0)=(S,j_0,M,D,u_0).$$ be the associated stable map which we equip with the stabilization $\si$.}
{  In view of Theorem \ref{blog}, there is a good uniformizing family 
$$q\mapsto \alpha_q=(S_a, j(a, v), M_a, D_a, \oplus_a\exp_{u_0'}\eta)$$
 of stable maps, where 
$q=(a, v,\eta)\in \co$. It is  centered at the stable map
$
\alpha:=(S,j_0,M,D,u_0')
$
for a smooth map $u_0'$ near $u_0$. The family $\alpha_q$ satisfies the properties of good data in 
Definition \ref{def_g_uni_f_stable_maps}. Moreover, 
at $a=0$, 
$$\alpha_{q_0}=\alpha_0\quad \text{and}\quad 
 q_0=(0,0,\eta_0)$$
 where $u_0=\exp_{u_0'}(\eta_0)$.
We recall that if the gluing parameter vanishes, there is no gluing and $\oplus_a$  is the identity operator if $a=0$. We introduce the abbreviated notation, for $a=0$,
$$j(0, v)=j_0(v),\quad S_0=S, $$
so that $j(0, 0)=j_0(0)=j_0$ on $S$.
Given an almost complex structure $j$ on $S$ close to $j_0$ and a deformation $\si'$ of the stabilization $\si$ close to $\si$ (as defined in Section \ref{dm-subsect}) we find by 
Theorem \ref{smoothfamily} a unique pair  $(\phi_{j, \si'}, v(j, \si'))$ such that 
$$\phi_{j, \si'}:(S, j, M\cup \si', D)\to 
(S, j_0(v(j, \si')), M\cup \si,  D)$$ is an isomorphism of marked  Riemann surfaces close to the identity map of $S$. Moreover, 
$\phi_{j, \si'}$ and $v(j, \si')$ depend continuously on $j$ and $\si'$ and satisfy 
$\phi_{j, \si'}=\text{id}$ and $v(j_0, \si')=0$.
Every stable map $u$ on $(S, j_0, M, D)$ close to $u_0$ intersects the constraints at $u_0(\si)$ in $Q$ transversally and, since $u_0$ near $\si$ is an embedding,  defines 
the deformation $\si_u\subset S$ of $\si$.  This way we obtain the continuous map 
$$(j, u)\mapsto (v(j, \si_u), u\circ \phi_{j, \si_u}^{-1}).$$
Defining the section $\eta(j, u)$ close to $\eta_0$ by the equation
$$\exp_{u_0'}(\eta (j, u))=u\circ \phi^{-1}_{j, \si_u}, $$
we have $\eta (j_0, u_0)=\eta_0$, and 
$$[(S, j_0(v(j, \si_u)), M, D, \exp_{u_0'}(\eta (j, u))=[(S, j, M, D, u)].$$
The continuity of the map 
$(j, u)\mapsto (0, v(j, \si_u), \eta(j, \si_u))\in \co$ implies, in view of the definition of the topology of $H_d$, that the map $\Phi_d$ is continuous in a small neighborhood of 
$(j_0, u_0)$. }

{In order to prove that the map $\Phi_d$ is open we take an open subset $U$ of $J_d\times H_d$ and consider its  image $\wh{U}=\Phi_d (U)$. If $[(S, j_0, M, D, u_0)\in \wh{U}$, then $(j_0, u_0)\in U$. Proceeding as above
we choose a small stable map $u_0'$ near $u_0$ and take a good uniformizer 
$q\mapsto \alpha_q$ centered at $(S, j_0, M, D, u_0')$ such that 
$[\alpha_{q_0}]=[(S, j_0, M, D, u_0)]$ at 
the point $q_0=(0, 0, \eta_0)\in \co$, where 
 $\exp_{u_0'}(\eta_0)=u_0$.  For $\abs{v}$ 
 small and $\eta$ near $\eta_0$,  the map 
 $$(v, \eta)\mapsto (j_0(v), \exp_{u_0'}(\eta))$$
 into $U$ is continuous and 
 $$\Phi_d(j_0(v), \exp_{u_0'}(\eta))=
 [(S, j_0(v), M, D, \exp_{u_0'}(\eta))].$$
 In view of the definition of the topology of $Z_d$ we have found an open neighborhood around 
 $ [(S, j_0, M, D, u_0)]$ which belongs to $\wh{U}$. Hence the map $\Phi_d$ is an open map. The surjectivity of $\Phi_d$ is obvious and the proof of Lemma \ref{ium} is complete.}
 
 
 
 
\end{proof}



\begin{lemma}\label{type-d}
For every type $d\in \Delta$,  the Hausdorff topological space $(Z_d,{\mathcal T}_d)$ admits a countable basis for the topology.
\end{lemma}
\begin{proof}
We fix the type $d\in \Delta$  and recall that,  by Lemma \ref{ium},  the map
$$
\Phi_d:J_d\times H_d\rightarrow Z_d, \quad (j,u)\mapsto [(S,j,M,D,u)]
$$
is open and continuous. Since $J_d \times H_d$ is a separable metric space it posses a countable basis for its topology,
say $\tilde{\mathcal B}_d= {(\tilde{U}_i)}_{i\in {\mathbb N}}$. Define the open sets $U_i=\Phi(\tilde{U}_i)$ and denote its collection by
${\mathcal B}_d$. Let us show that it is a basis for the topology ${\mathcal T}_d$. Pick an open subset $V\subset  Z_d$.
Then let $z\in V$ and pick
$(j_0,u_0)\in J_d\times H_d$ such that $z=\Phi_d(j_0,u_0)$. 
By the continuity of $\Phi_d$ we find an open neighborhood $U$ of $(j_0,u_0)$
such  that $\Phi_d(U)\subset V$. Then we find $\wt{U}_{i_0}\in \wt{\mathcal B}_d$ 
such that  $(j_0,u_0)\in \wt{U}_{i_0}\subset \wt{U}$. This then implies that 
$$
z\in U_{i_0}\subset V.
$$
Since $z$ was arbitrary in $V$ we conclude that
$$
V =\bigcup_{\{i\ |\ U_i\subset V\}} U_i,
$$
which shows  that ${\mathcal B}$ is a basis for the topology ${\mathcal T}_d$ on $Z_d$.
\end{proof} 

\begin{lemma}\label{2nd-count}
The topology ${\mathcal T}$ is second countable.
\end{lemma}
\begin{proof}
Recall that the set $\Delta$ of types $d$ is countable and that every space $(Z_d,{\mathcal T}_d)$ has a countable
basis ${\mathcal B}_d$ for its topology. Hence we have a countable collection $(U_{d,k})$, where $d\in \Delta$ and $k\in {\mathbb N}$. Further the collection ${(U_{d,k})}_{k\in {\mathbb N}}$ is a basis for ${\mathcal T}_d$.
Fix a type $d\in\Delta$. For every $z\in Z_d$ we have a good uniformizing family
$$
{\mathcal O}_z\ni q^z\rightarrow \alpha_{q^z}^z
$$
such that $ [\alpha^z_{q^z_0}]=z$
for a suitable $q^z_0$.  In addition,  the uniformizer is constructed 
with an element of the same type.
In addition, the subset  
$$
V_z=\{[\alpha^z_{q^z}]\ |\ q^z\in {\mathcal O}_z\}\subset Z
$$
is an open neighborhood of $z\in Z$ and $V_z^d=Z_d\cap V_z$ is an open neighborhood of $z$ in $Z_d$.
Also the collections ${(V_z^d)}_{z\in Z_d}$ is an open covering of $Z_d$. Consider the set $\Sigma_d\subset {\mathbb N}$ of integers 
consisting of all $i\in {\mathbb N}$ such  that $U_{d,i}$ belongs to at least one of the  sets $V^d_z$. Since $(V_z^d)$ is an open covering of $Z_d$ and 
${(U_{d,i})}_{i\in {\mathbb N}}$ is a basis for ${\mathcal T}_d$ we conclude that
$$
Z_d =\bigcup_{i\in\Sigma_d} U_{d,i}.
$$
Now we choose for every $i\in\Sigma_d$ a point $z_{d,i}\in Z_d$ such  that $U_{d,i}\subset V_{z_{d,i}}^d$. Then 
the collection of all ${(V_{z_{d,i}}^d)}_{i\in\Sigma_d}$ is an open covering of $Z_d$. We do this for every type $d$ and obtain
the index set
$$
\Sigma : = \bigcup_{d\in\mathfrak{d}} \{d\}\times \Sigma_d
$$
and a map
$$
\Sigma\rightarrow Z:(d,i)\rightarrow z_{d,i}.
$$
Then   we  take the countable collection of all good uniformizers 
$$
{\mathcal O}_{z_{d,i}}\ni q^{z_{d,i}}\rightarrow \alpha^{z_{d,i}}_{q^{z_{d,i}}}.
$$
By construction,  the associated collection of open sets ${(V_{z_{d,i}})}_{(d,i)\in\Sigma}$ covers $Z$.
Every $V_{z_{d,i}}$ carries a metrizable topology and is separable. Hence its admits a countable
basis for its topology. Taking the countable union of all these bases for the $V_{z_{d,i}}$, where $(d,i)$ varies over the countable set
$\Sigma$,  we obtain a countable basis for
$(Z,{\mathcal T})$. 
\end{proof}

\begin{proof}[Proof of Theorem \ref{nattop}]
At this point we know by the previous discussion that ${\mathcal T}$ is a Hausdorff topology (Lemma \ref{topology}, Lemma \ref{hausdorff}), which is second countable (Lemma \ref{2nd-count})
and completely regular (Lemma \ref{cr}). As a consequence of Urysohn's metrization  theorem it is therefore metrizable and consequently also 
paracompact. 

Next we consider the space of un-noded elements in $Z$, denoted  by $\dot{Z}$. From the construction of the uniformizers
it follows that $\dot{Z}$ is open. Indeed, if we start without nodes the good uniformizer does not involve nodes. Hence the original
element has an open neighborhood not containing nodal elements. If $z$ is noded then any neighborhood contains
un-noded elements. This follows immediately from the definition of the topology via good uniformizers. Let $d\in \Delta$ be a type, {of un-noded elements in  $Z$},  and consider the map $\Phi_d:J_d\times H_d\rightarrow Z_d$. The metric space $J_d\times H_d$ is separable and therefore
admits a dense sequence $(j_l,u_l)$. We may assume that the maps $u_l$ have regularity $(3+m,\delta_m)$ for all $m$.
Then the sequence $(\Phi(j_l,u_l))$ consists of smooth elements and is dense in  $Z_d$ because  $\Phi$ is open and surjective.
Since we only have a countable number of such types $d\in \Delta$, 
we conclude that $\dot{Z}$ is separable. Because $\dot{Z}$ is open and dense in $Z$,  we see that  the space $Z$ of stable curves is separable. 
This completes the proof of the Theorem \ref{nattop}.
\end{proof}


\section{The Polyfold Structure on the Space $Z$}\label{polyfoldstructure}
After all these preliminaries we finally construct the polyfold structure of the topological space $Z$ of stable curves. For every $z\in Z$ we find by Proposition \ref{imremark} a good uniformizing family $(a, v, \eta)\to \alpha_{(a, v, \eta)}$,  where $(a, v, \eta)\in {\mathcal O}$. It is  centered at a smooth stable curve $\alpha$ such  that the map 
$$p:{\mathcal O}\to Z,\qquad p(a, v,\eta)=[\alpha_{(a, v,\eta)}]$$
has $z$ in its image $U=p({\mathcal O})$. Let $\cg_{\lambda}$, $\lambda\in \Lambda$, be a family of such good uniformizers having the property that the open sets $U_\lambda=p_\lambda ({\mathcal O}_\lambda)$ cover the space $Z$.

In view of Theorem \ref{nattop}, the space $Z$ is a second countable paracompact Hausdorff topological space. Therefore, there exists a refinement $V_\lambda\subset U_\lambda$ of the covering having the same index set $\Lambda$, which is locally finite. (Of course, some of the sets 
$V_\lambda$ might be empty and we remove all those indices $\lambda$ for which 
$V_\lambda=\emptyset.$) Without loss of generality we may assume that $V_\lambda\neq \emptyset$ for all $\lambda\in \Lambda$. Then we replace the open sets ${\mathcal O}_\lambda$ by the preimages 
$p_\lambda^{-1}(V_\lambda)$, for which we use the same letter ${\mathcal O}_\lambda$.  We therefore may assume that we are given a countable collection of good uniformizing families 
$$q_\lambda \to \alpha_{q_\lambda}^\lambda,\qquad q_\lambda\in {\mathcal O}_\lambda,\, \lambda \in \Lambda, $$
having the property that the images $U_\lambda=p_\lambda ({\mathcal O}_\lambda)$,
$$U_\lambda=\{[\alpha^\lambda_{q_\lambda}]\vert\, q_\lambda\in {\mathcal O}_\lambda\}$$
constitute a locally finite open covering of the space $Z$.

By $X$ we denote the disjoint union of all the graphs 
$$
\cg_\lambda=\{(q_\lambda,\alpha^\lambda_{q_\lambda})\vert \, q_\lambda\in {\mathcal O}_\lambda \},
$$
that is
$$X=\coprod_{\lambda \in \Lambda} \cg_\lambda.$$
This disjoint union  is an M-polyfold  in a natural way and we view $X$ as the object set of a small category. {The morphism set  ${\bf X}$ of the small category is} the disjoint union 
$${\bf X}=\coprod_{\lambda,\lambda'\in \Lambda}M(\cg_\lambda, \cg'_{\lambda'}),$$
which, by Proposition \ref{a-key-z}, is also an M-polyfold.


\begin{theorem}\label{theoremA}
The M-polyfold $X$ is the object set and the M-polyfold set  ${\bf X}$ is the morphism set of a small category. The source and target maps $s, t:{\bf X}\to X$ are surjective local sc-diffeomorphisms. The structure maps $i:{\bf X}\to {\bf X}$, $u:X\to {\bf X}$, and $m:{\bf X}{{_s}\times_t}{\bf X}\to {\bf X}$ are sc-smooth.
In addition, $X$ satisfies the properness assumption, so that $X$ is an ep-groupoid. 
\end{theorem}
\begin{proof}
The theorem follows immediately  from Proposition \ref{a-key-z}, Proposition \ref{b-key-z}, and Proposition \ref{c-key-z} except the  statement about the properness which we shall prove next. 

We choose a point $x\in X=\coprod_{\lambda\in\Lambda} \cg_\lambda$. 
Then $x=(q_{\lambda_0},\alpha_{q_{\lambda_0}}^{\lambda_0})$ belongs to the graph $\cg_{\lambda_0}$. Pick the open neighborhood $U^{\cg_{\lambda_0}}=U^{\cg_{\lambda_0}}(q_{\lambda_0})$ guaranteed
by Theorem \ref{rees}.  If the subset  $\gamma_{\lambda_0}\subset X$ is  the graph of the good uniformizer restricted to  $U^{\cg_{\lambda_0}}$,  we show that
$$
t: s^{-1}(\cl (\gamma_{\lambda_0}))\rightarrow X
$$
is proper.  To this aim we let $K\subset X$ be a compact subset. Then there are only a finite number of  indices $\lambda$  in $\Lambda$ such that 
$K\cap \cg_{\lambda}\neq \emptyset$. Denote them by $\lambda_1,\ldots, \lambda_k$. Next we consider any sequence of morphisms 
$(\Phi_l)$ in ${\bf X}$ satisfying $t(\Phi_l)\in K$ and $s(\Phi_{l})\in \cl (\gamma_{\lambda_0})$. Then,  after taking a subsequence,  we may assume, 
without loss  of generality,  that $t(\Phi_l)\in \cg_{\lambda_{i_0}}$ for a suitable $i_0$ and,  moreover, 
$\pi_{\lambda_{i_0}}(t(\Phi_{l}))\rightarrow q_0$ in ${\mathcal O}_{\lambda_{i_0}}$. In addition, 
$\pi_{\lambda_0}(s(\Phi_{l}))\in \cl({U}^{\cg_{\lambda_0}})$. From Theorem \ref{rees}, we conclude that a 
subsequence of $(\Phi_{l})$ is convergent,  finishing the proof of Theorem \ref{theoremA}.
  \end{proof}


If $\abs{X}$ is the orbit space of the ep-groupoid $X$, then the canonical map $p:X\to Z$ induces the homeomorphism $\abs{p}:\abs{X}\to Z$. Hence the pair $(X, \abs{p})$ defines a polyfold structure on $Z$ and we have proved the following theorem. 
 
 \begin{theorem}\label{theoremB}
 The M-polyfold groupoid $X$ is an ep-groupoid and the pair $(X, \abs{p})$ defines a polyfold structure   on $Z$.
 \end{theorem}
 
 We now assume that we have constructed,   following the same  recipe,  the second  ep-groupoid $X'$ with its  canonical map $p':X'\rightarrow Z$ and the associated polyfold structure $(X', \abs{p'})$ of $Z$. In order to show that these  different choices define equivalent polyfold structures on $Z$  we proceed as follows.  We first define  $X''=X\coprod X'$  as the disjoint union of the corresponding $\cg_\lambda$ and $\cg'_{\lambda'}$ and note that the associated open  covering is still locally finite. Then we take the disjoint union of all morphisms as before. This  way we obtain a third ep-groupoid $X''$. The inclusion maps $F:X\rightarrow X''=X\coprod X'$ and
 $F':X'\rightarrow X''$ are equivalences.  The weak fibered product
 $X'''=X\times_{X''}X'$  is again an ep-groupoid and the projections  
 $\pi_1:X'''\rightarrow X$ and $\pi_2:X'''\rightarrow X'$ are equivalences. {For the notions of weak fibered products and common refinement we refer the reader to Section 2.2 and Section 2.3 in \cite{HWZ3.5}.}
 
 
 
 
 Therefore, the ep-groupoid   $X'''$ is a common refinement of $X'$ and $X''$.  The relation 
 $$
 p(\pi_1(X'''))=p'(\pi_2(X'''))
 $$
  implies that the pair  $(X''',\abs{p\circ\pi_1})$ defines another   polyfold structure on $Z$. Since 
 $\abs{p\circ \pi_1}=\abs{p}\abs{\pi_1}=\abs{p'}\abs{\pi_2}$, the polyfold structures $(X, \abs{p})$ and  $(X', \abs{p'})$ of $Z$ are indeed equivalent and we have proved the following theorem announced in the introduction as Theorem \ref{pfstructure}.

 \begin{theorem}\label{theoremC}
 Having fixed the exponential gluing profile and a strictly increasing sequence $(\delta_i)_{i\geq 0}\subset (0,2\pi)$,  the second countable paracompact topological space $Z$ of stable curves possesses  a  natural equivalence class of polyfold structures.
 \end{theorem}
{ \begin{remark}``Natural''  here means the following. The set $Z$ is determined by specifying $\delta_0\in (0,2\pi)$,  and by requiring the maps
 to be stable and of class $(3,\delta_0)$. {As already proved},  one can construct a topology on $Z$ which is second countable, paracompact and Hausdorff and  does not depend on the choices involved in its construction. Then picking a strictly increasing sequence $\delta=(\delta_i)$ starting at $\delta_0$ and staying below $2\pi$, and prescribing the exponential gluing profile
 there is a procedure which results in the construction of a polyfold structure $(X,|p|)$ on $Z$. This procedure
 in general involves choices. However, different choices lead to a polyfold structure $(X',|p'|)$, which
 is equivalent to $(X,|p|)$ in the sense defined in \cite{HWZ2}.  In  other words $Z=Z^{3,\delta_0}$ is in a natural way a polyfold
 once we fix a sequence of strictly increasing weights and the exponential gluing profile. Specifically we want to point out 
 that the choice of the cut-off function $\beta$ in the gluing constructions is irrelevant. Different choices lead to equivalent 
 polyfold structures. This is a consequence of Theorem \ref{theorem_neck} which  implies the compatibility of gluing procedures
 for different choices of cut-off functions.
  \end{remark}}
 

 
Summarizing we have constructed an equivalence class of polyfold structures on the topological space $Z$.
 In the following we shall refer to $Z$ as the polyfold $Z$ and keep the particular choices of the weights and the exponential gluing profile in mind when needed.

\section{The Polyfold Structure of  the Bundle $W\to Z$}\label{polstrbundle}
 
In this section we shall construct the strong polyfold structure  on the bundle $W\to Z$ introduced in Section \ref{sect1.2},  and prove Theorem \ref{main1.10}.
The construction of the strong polyfold structure for our bundle $W\to Z$  starts from the polyfold structure $(X, \abs{p})$ of the space $Z$ of stable curves into $Q$, constructed in the previous section. The structure consists of the M-polyfold $X$ and the homeomorphism $\abs{p}:\abs{X}\to Z$ between the orbit space  of $X$ and $Z$. In the previous section we have constructed the object set $X$ as the disjoint union
 $$X=\coprod_{\lambda\in \Lambda}\cg_\lambda$$
 of a countable family $\cg_\lambda$ of graphs $\cg$ of good uniformizing families of stable maps  (we omit the index $\lambda$)
 $$(a, v, \eta)\to \alpha_{(a, v,\eta)}=(S_a, j(a,v), M_a, D_a, \oplus_a\exp_u (\eta))$$
 centered at smooth stable curves $\alpha=(S, j, M, D, u)$. Here $(a, v, \eta)\in \co$, where $\co$ is an open subset of a splicing core $K^\cs$.  We can view the sets $\co$ or equivalently, the graphs $\cg$ of good uniformizing  families, as the local models of the M-polyfold $X$.
 
 Abbreviating, as we did before, the good uniformizing family  by $q\mapsto  \alpha_q$ where $q=(a, v, \eta)$,  we shall construct the associated  lifted family $\wh{q}\mapsto  \wh{\alpha}_{\wh{q}}$ such  that its graph $\wh{\cg}$ is a strong M-poyfold bundle $\wh{\cg}\to \cg$. The disjoint countable union of the corresponding graphs $\wh{\cg}_\lambda$,
 $$E:=\coprod_{\lambda\in \Lambda}\wh{\cg}_\lambda$$ is then  a strong bundle $E\to X$ over the M-polyfold $X$.
 
 
 To this aim we fix a good uniformizing family $q\to \alpha_q$, $q=(a, v, \eta)\in \co$, centered at the smooth stable map $\alpha=(S, j, M, D, u)$, and denote by $F$ the sc-Hilbert space consisting of maps  $z\mapsto \xi (z)$, $z\in S\setminus \abs{D}$, where $\xi (z):(T_zS, j)\to (T_{u(z)}Q, J(u(z)))$ is a complex anti-linear map. Moreover, the map 
 $z\mapsto  \xi (z)$ is of Sobolev class $(2, \delta_0)$ as introduced in Section \ref{sect1.2}. The level $k$ of the sc-structure on $F$ corresponds to the regularity $(2+k, \delta_k)$. The strong bundle splicing $\mcr$ on $\co\triangleleft F$ is defined by the strong bundle projection
 $$
 \rho:\co \triangleleft F\to F,\quad (a, v,\eta, \xi)\mapsto  \rho_{(a, v, \eta)}(\xi),
 $$
which is parametrized by $(a, v,\eta)\in \co$, but actually only depends on  $a$ so that 
$\rho_{(a, v,\eta)}=\rho_a$. The  projection operator $\rho_a$ is obtained by implanting the splicing projections using the previously introduced local charts $\psi$ on the symplectic manifold $Q$, however, using this time the hat gluing $\wh{\oplus}_a$ and the 
 hat anti-gluing $\wh{\ominus}_a$ operations. This way we obtain the splicing core
 $$
 K^\mcr=\{(a, v,\eta, \xi)\in \co\triangleleft F\, \vert\, \rho_a(\xi)=\xi\}.
 $$
 The splicing core $K^\mcr$ defines the strong local bundle 
 $$K^\mcr\to \co$$
 by 
 $(a, v,\eta, \xi)\to (a, v, \eta).$ We observe that the automorphism group $G$ of the original stable map $\alpha=(S, j, M, D, u)$ acts on $K^\mcr$ compatibly with the action already defined on $\co$,  namely by
 $$g\ast (a, v,\eta, \xi)=(g\ast a, g\ast v, \eta\circ g^{-1}, \xi\circ Tg^{-1})$$
 for every $g\in G$. 
 
 In order to ``lift'' the good family $q\to \alpha_q$ to a good family $\wh{q}\to \wh{\alpha}_{\wh{q}}$ on the bundle level, we introduce for $v\in V$ the complex linear bundle isomorphism 
 \begin{equation}\label{delta_eq_1}
 \delta (v):(TS, j(v))\to (TS, j),
\end{equation}
 defined by,
 $$ \delta (v)h=\frac{1}{2}\bigl(\id -j\circ j(v)\bigr)h.$$
 It satisfies $\delta  (v)\circ j(v)=j\circ \delta (v)$ and depends smoothly on $v\in V$. Moreover, since $j(v)=j$ on the discs of the small disc structure,
 $$ \delta (v)h=h$$
 above the discs. Similarly, the complex  linear map 
 \begin{equation}\label{delta_eq_2}
 \delta(a, v):(TS_a, j(a, v))\to (TS_a, j(a, 0))
 \end{equation}
 is defined by 
 $$\delta (a, v)h=\frac{1}{2}\bigl(\id -j(a, 0)\circ j(a, v))h.$$
 Next we consider  the complex anti-linear map
 $$
 \xi (z):(T_zS, j)\to (T_{u(z)}Q, J(u(z)).
 $$
  By implanting the hat gluing $\wh{\oplus}_a$,  we have defined the glued section 
 $$\wh{\oplus}_a(\xi )(z):(T_zS_a, j(a, 0))\to (T_{\oplus_a u (z)}Q, J(\oplus_a u (z)))$$
 along the glued map $\oplus_au$ into $Q$. The composition $\xi \circ \delta (v)$ is a complex anti-linear map 
 $$(T_zS, j(v))\to (T_{u(z)}Q, J(u(z)))$$
 which satisfies the identity 
 $$\wh{\oplus}_a(\xi \circ \delta (v))=\wh{\oplus}_a(\xi )\circ \delta (a, v).$$
 
Earlier we have introduced in {Definition \ref{GD} about good data}   the exponential map 
 $\exp:\wt{\co}\to Q$, where $\wt{\co}_p=T_pQ\cap \wt{\co}$ is a convex neighborhood of the origin $0_p$ in the tangent space $T_pQ$,  having the property that the restriction of $\exp$ to $\wt{\co}_p$ is an embedding into $Q$. Let us fix a complex connection on the almost complex vector bundle $(TQ, J)\to Q$. For example, if $\nabla_X$ is the covariant derivative on $Q$ belonging to the Riemaniann metric $\omega\circ (\id \oplus J)$, the connection $\wt{\nabla}_X$, defined by $\wt{\nabla}_XY=\nabla_XY-\frac{1}{2}J(\nabla_XJ)Y$, is complex in the sense that it satisfies $\wt{\nabla}_X(JY)=J(\wt{\nabla}_XY)$. If $\eta\in \wt{\co}_p$ is a tangent vector, the parallel transport  (of a complex connection) along the path $t\mapsto \exp_p (t\eta)$ for $t\in [0,1]$, defines the   linear map
 $$\Gamma  (\exp_p(\eta), p):(T_pQ, J(p))\to (T_{\exp_p(\eta)}Q, J( \exp_p(\eta)))$$
 which is complex linear so that 
 $$\Gamma (\exp_p(\eta), p)\circ J(p)= J( \exp_p(\eta))\circ  \Gamma (\exp_p(\eta), p).$$
 Given the point $(a, v,\eta, \xi)\in K^\mcr$ we define the complex anti-linear map 
$$
\Xi (a, v, \eta, \xi)(z):(T_zS_a, j(a, v))\to (T_{\oplus_a\exp_u (\eta)(z)}Q, J( \oplus_a\exp_u (\eta)(z)))
$$
at the points $z\in S_a\setminus \{\text{not-glued nodal points}\}$ by 
 \begin{equation}\label{sigma_complex_linear_1}
\Xi (a, v, \eta, \xi)(z)=\Gamma  [ \oplus_a\exp_u (\eta) (z), \oplus_au(z)]\circ \wh{\oplus}_a(\xi )(z)\circ \delta (a, v)(z).
\end{equation}
Observe that for $g\in G$
$$
\Xi(a,v,\eta,\xi)\circ Tg^{-1}_a = \Xi(g\ast a,g\ast v,\eta\circ g^{-1},\xi\circ Tg^{-1}).
$$
Now, with the given good uniformizing family $q\to \alpha_q$, explicitly given by 
$$(a, v, \eta)\to (S_a, j(a, v), M_a, D_a, \oplus_a\exp_u (\eta)), \quad (a, v, \eta)=q\in \co,$$
we associate the lifted family $\wh{q}\to \wh{\alpha}_{\wh{q}}$, defined by
$$(a, v, \eta, \xi)\to (S_a, j(a, v), M_a, D_a, \oplus_{a}\exp_u (\eta), \Xi (a, v,\eta, \xi))$$
where  $(a, v, \eta, \xi)=\wh{q}\in K^\mcr$. If $g\in G$ then $g$ induces an isomorphism
$$
\wh{\alpha}_{\wh{q}}\rightarrow \wh{\alpha}_{g\ast \wh{q}}
$$
which on the underlying $\alpha_q$ gives the usual isomorphism to $\alpha_{g\ast q}$. Moreover,  
$$
\Xi(g\ast (a,v,\eta,\xi))\circ Tg_a = \Xi(a,v,\eta,\xi).
$$
Let $\wh{\cg}$ be the graph of the lifted family $\wh{q}\to \wh{\alpha}_{\wh{q}} $ and note that the bundle $(a, v, \eta, \xi)\to (a, v,\eta)$ has the structure of a strong M-polyfold bundle. Therefore, the graph $\wh{\cg}$ carries trivially the natural structure of a strong polyfold bundle if we require that the graph map establishes a strong bundle isomorphism. Hence we have an sc-smooth projection
$$\wh{\cg}\to \cg.$$
Carrying out the above construction for all the graphs $\cg_\lambda$ of good families for all $\lambda\in \Lambda$ used to define the M-polyfold $X$, we define the strong polyfold bundle $E\to X$ over the object space $X$ as the disjoint union of the associated graphs $\wh{\cg}_{\lambda}$ of the lifted families 
$$E=\coprod_{\lambda\in \Lambda}\wh{\cg}_\lambda\to X.$$
We recall that the tuples $\wh{\alpha}=(S, j, M, D, u, \xi)$ and $\wh{\alpha}'=(S', j', M', D', u', \xi')$ are called equivalent, if there exists an isomorphism 
$\varphi:(S, j, M, D, u)\to (S', j', M', D', u')$ between the underlying stable maps satisfying, in addition, 
$$\xi'\circ T\varphi=\xi.$$
The set $W$ is defined as the collection of all such equivalence classes. 
The canonical map 
$$\Gamma:E\to W, $$
associating  with a point in $E$ its  isomorphism class, is defined by 
\begin{equation*}
\begin{split}
&\Gamma ((a, v, \eta, \xi), (S_a, j(a, v), M_a, D_a, \oplus_a \exp_u (\eta), \Xi (a, v, \eta, \xi))\\&\qquad =
[S_a, j(a, v), M_a, D_a, \oplus_a \exp_u (\eta), \Xi (a, v, \eta, \xi)].
\end{split}
\end{equation*}
This map $\Gamma$ covers the canonical map $X\to Z$, {so that  the diagram}
\mbox{}\\
\begin{equation*}
\begin{CD}
E@>\Gamma>>W\\
@VpVV  @VVV \\
X@ >>>Z\\ \\
\end{CD}
\end{equation*}
{commutes}. So far we have constructed a strong M-polyfold bundle
$$p:E\to X$$
over the object set $X$ of the ep-groupoid $(X, {\bf X})$. Next we have to construct the strong bundle map
$$
\mu: {\bf E}:= {\bf X}{{_s}\times_p}E\rightarrow E
$$
covering the target map $t:{\bf X}\rightarrow X$ as specified in 
Definition \ref{stbundleep} of a strong bundle over an ep-groupoid.

\begin{proposition}\label{propA}
There exists a strong bundle map $\mu:\be:=\bx{{_s}\times_{p}}E\to E$ which covers the target map $t:\bx\to X$ of the ep-groupoid $X$ satisfying
$$t\circ \pi_1(\Phi, e)=p\circ \mu (\Phi ,e)$$
for all $(\Phi, e)\in \bx{{_s}\times_{p}}E,$ 
so that the diagram
\mbox{}\\
\begin{equation*}
\begin{CD}
\bx{{_s}\times_{p}}E@>\mu>>E\\
@V\pi_1VV @VVp V \\
\bx@>t>>X.\\ \\
\end{CD}
\end{equation*}
commutes. 
Moreover, $\mu$  has the following additional properties.
\begin{itemize}
\item[{\em (1)}] $\mu$ is a surjective local sc-diffeomorphism and linear in the fibers $E_x$
\item[{\em (2)}] $\mu(1_x,e_x)=e_x$ for all $x\in X$ and $e_x\in E_x$.
\item[{\em (3)}] $\mu(\Phi\circ \Psi,e)=\mu(\Phi,\mu(\Psi,e))$ 
for all morphisms $\Phi, \Psi\in \bx$ and $e\in E$ satisfying $s(\Psi)=p(e)$ and $t(\Psi)=s(\Phi)=p(\mu (\Psi, e)).$
\end{itemize}

\end{proposition}
\begin{proof}
In order to define the map $\mu:\bx{{_s}\times_{p}}E\to E$ we abbreviate $q=(a, v, \eta)$, $\wh{q}=(a,v,\eta,\xi)$ and 
\begin{align*}
\alpha_q&=(S_a, j(a, v), M_a, D_a, \oplus_a\exp_u (\eta))\\
\wh{\alpha}_{\wh{q}}&=(S_a, j(a, v), M_a, D_a, \oplus_a\exp_u (\eta), \Xi (a, v, \eta, \xi)).
\end{align*}
If $\Phi\in \bx$ is the morphism
$$\Phi\equiv ((q,\alpha_q), \varphi, (q', \alpha_{q'}')):(q, \alpha_q)\to (q',\alpha_{q'}'),$$
then the isomorphism 
$$\varphi:(S_a, j(a, v), M_a, D_a)\to (S_{a'}', j'(a', v'), M_{a'}', D_{a'}')$$
satisfies 
$$\oplus'_{a'}\exp_{u'}'(\eta')\circ \varphi=\oplus_a\exp_u (\eta).$$
If $e=(\wh{q},\wh{\alpha}_{\wh{q}})\in E$, then $p(e)=(q,\alpha_q)=s(\Phi)$. Hence 
$(\Phi, e)\in \bx{{_s}\times_{p}}E$ and we define 
$$\mu (\Phi, (\wh{q}, \wh{\alpha}_{\wh{q}}))=(\wh{q}', \wh{\alpha}'_{\wh{q}'})$$
where $q'=(a', v', \eta')$ and $\wh{q}'=(a', v', \eta',\xi')=(q',\xi')$. Moreover, $\xi'$ is the unique solution of the two equations
\begin{align*}
\Xi(a, v,\eta, \xi)&=\Xi'(a', v', \eta', \xi')\circ T\varphi\\
\wh{\ominus}_{a'}'(\xi')&=0.
\end{align*}
Explicitly,
\begin{equation*}
\begin{split}
&\wh{\oplus}_{a'}'(\xi')(\varphi (z))\\
&\phantom{===}=\Gamma'[\oplus_{a'}'\exp_{u'}'(\eta')(\varphi (z)), \oplus_{a'}'u'(\varphi (z))]^{-1}\circ \Gamma [\oplus_a\exp_u (\eta)(z), \oplus_au (z)]\\
&\phantom{====\ }\circ \wh{\oplus}_a(\xi)(z)\circ  \delta (a, v)(z)\circ T\varphi (z)^{-1}\circ [ \delta'(a', v')(\varphi (z))]^{-1}
\end{split}
\end{equation*}
and
\begin{equation*}
\wh{\ominus}_{a'}'(\xi')(\varphi (z))=0.
\end{equation*}
We recall that $ \delta (a, v)$ is the complex linear map defined by the formula \eqref{delta_eq_2}.  The second equation  implies that $\rho_{a'}'(\xi')=\xi'$ and thus requires that $\xi'$ is contained in the splicing core.

If $t:\bx\to X$ is the target map and $e=(\wh{q}, \wh{\alpha}_{\wh{q}})$, then $t\circ \pi_1(\Phi, e)=t(\Phi)=(q', \alpha'_{q'})=p\circ \mu (\Phi, e)$ so that $\mu$ covers indeed the target map.

Clearly, the map $\mu$ is surjective and linear on the fibers $E_{(q, \alpha_q)}$. It also preserves the double-filtration $(m, k)$, where $0\leq k\leq m +1$. Moreover, if $\Phi =1_{(q, \alpha_q)}=((q, \alpha_q),\id, (q,\alpha_q))\in \bx$ is the unit morphism, then 
$\mu (1_{(q, \alpha_q)}, (\wh{q}, \wh{\alpha}_{\wh{q}}))=(\wh{q}, \wh{\alpha}_{\wh{q}}).$


To verify the property (3) we take two morphism $\Psi, \Phi\in \bx $ and $e\in E$ satisfying 
$s(\Psi)=p(e)$ and $t(\Psi)=s(\Phi)=p(\mu (\Psi, e)).$  Then with  $e=(\wh{q}, \wh{\alpha}_{\wh{q}})\in E$ we have $p(e)=(q,\alpha_q)=s(\Psi)$ and,  using $t(\Psi)=s(\Phi)$, 
\begin{align*}
\Psi& \equiv ((q, \alpha_q), \phi, (q',\alpha'_{q'})): (q, \alpha_q)\to (q', \alpha'_{q'})\\
\Phi& \equiv ((q', \alpha_{q'}'), \psi, (q'',\alpha''_{q''})): (q', \alpha_{q'}')\to (q'',\alpha''_{q''}). 
\end{align*}
The isomorphisms 
$\psi: (S_a, j(a, v), M_a, D_a)\to (S_{a'}', j'(a', v'), M_{a'}', D_{a'}')$ and $
\phi: (S_{a'}', j'(a', v'), M_{a'}', D_{a'}')\to (S_{a''}'', j''(a'', v''), M_{a''}'', D_{a''}'')$
satisfy 
\begin{equation}\label{twoeq}
\begin{aligned}
\oplus_{a'}'\exp_{u'}'(\eta')\circ \psi&=\oplus_{a}\exp_{u}(\eta)\\
\oplus_{a''}''\exp_{u''}(\eta'')\circ \phi&=\oplus_{a'}'\exp_{u'}'(\eta').
\end{aligned}
\end{equation}
In view of the definition of the map $\mu$, 
$$\mu (\Psi, e)=\mu (\Psi, (\wh{q}, \wh{\alpha}_{\wh{q}}))=(\wh{q'},\wh{\alpha'}_{\wh{q'}})$$
where  $\wh{q'}=(a', v', \eta', \xi')=(q', \xi')$   and where $\xi'$  is the unique solution of  the  two equations
\begin{equation}\label{twoeq1}
\begin{aligned}
\Xi (a, v, \eta, \xi)&=\Xi'(a', v', \eta', \xi')\circ T\psi\\
\wh{\ominus}_{a'}'(\xi')&=0.
\end{aligned}
\end{equation}
Consequently, 
\begin{equation*}
\mu (\Phi, \mu (\Psi, e))=\mu (\Phi, (\wh{q'},\wh{\alpha'}_{\wh{q'}}))=(\wh{q''},\wh{\alpha''}_{\wh{q''}}), 
\end{equation*}
where 
$\wh{q''}=(a'', v'', \eta'', \xi'')$ and where $\xi''$ is the unique solution of the  equations
\begin{equation}\label{twoeq2}
\begin{aligned}
\Xi' (a', v', \eta', \xi')&=\Xi''(a'', v'', \eta'', \xi'')\circ T\phi\\
\wh{\ominus}_{a''}''(\xi'')&=0.
\end{aligned}
\end{equation}
On the other hand, since the composition $\Phi\circ \Psi\in \bx$ is the morphism 
$$\Phi\circ \Psi\equiv ((q, \alpha_q), \phi\circ \psi, (q'', \alpha_{q''}''),$$
where $\phi\circ \psi$ is an isomorphism 
$$\phi\circ \psi:(S_a, j(a, v), M_a, D_a)\to (S_{a''}'', j''(a'', v''), M_{a''}'', D_{a''}'')$$
satisfying, in view of \eqref{twoeq}, 
$$\oplus_{a''}''\exp_{u''}''(\eta'')\circ (\phi\circ \psi)=\oplus_{a'}'\exp_{u'}'(\eta')\circ \psi=
\oplus_{a}\exp_{u}(\eta), $$
we have 
$$\mu (\Phi\circ \Psi, e)=\mu (\Phi\circ \Psi, (\wh{q},\wh{\alpha}_{\wh{q}}))=(\wh{r}, \wh{\alpha}_{\wh{r}}))$$
where 
$r=(a'', v'', \eta'')$ and $\wh{r}=(a'', v'', \eta'', \bar{\xi})$,  and 
$$\wh{\alpha}_{\wh{r}}=(S_{a''}'', j''(a'', v''), M_{a''}'', D_{a''}'' , \oplus_{a''}''\exp_{u''}\exp (\eta''), \Xi''(a'', v'', \eta'', \bar{\xi})).$$
Here $\bar{\xi}$ is the unique solution of the following two equations, 
\begin{align*}
\Xi (a, v, \eta, \xi)&=\Xi''(a'', v'', \eta'', \bar{\xi})\circ T(\phi \circ \psi)\\
\wh{\ominus}_{a''}''(\bar{\xi})&=0.
\end{align*}
In view of \eqref{twoeq1} and \eqref{twoeq2},  
\begin{equation*}
\begin{split}
\Xi (a, v, \eta, \xi)&=\Xi'(a', v', \eta', \xi')\circ T\psi =\Xi''(a'', v'', \eta'', \xi'')\circ T\phi \circ T\psi\\
&=\Xi''(a'', v'', \eta'', \xi'')\circ T(\phi \circ \psi).
\end{split}
\end{equation*}
In view of $\wh{\ominus}_{a''}''(\xi'')=0$,  we conclude by  the uniqueness  that 
$\ov{\xi}=\xi''$ so that $\wh{r}=\wh{q''}$ and $\wh{\alpha}_{\wh{r}}=\wh{\alpha}_{\wh{q''}}''.$
Consequently, $\mu (\Phi\circ \Psi, e)=(\wh{r}, \wh{\alpha}_{\wh{r}} )=(\wh{q''},\wh{\alpha''}_{\wh{q''}})=\mu (\Phi , \mu (\Psi, e))$ as claimed in property (3).



It remains to prove that $\xi'$ is an $\ssc_\triangleleft$--smooth map of $(a, v,\eta, \xi)\in  K^\mcr$.  If $(\Phi_0, (\wh{q}_0,\wh{\alpha}_{\wh{q}_0}))\in \be$ is given, where 
$\Phi_0=(q_0, \alpha_{q_0}), \varphi_0, (q_0',\alpha'_{q_0'}))$ is the morphism in $\bx$ and 
$\varphi_0:\alpha_{q_0}\to \alpha_{q_0'}'$ is an isomorphism, then there exists, in view of Theorem \ref{key-z}, a core smooth germ $q\to \varphi_q$ of isomorphisms 
$$\varphi_q:(S_a, j(a, v), M_a, D_a, \oplus_a\exp_u (\eta))\to (S_b', j'(b, w), M_b', D_b', \oplus'_b \exp'_{u'}(\eta')),$$
where $q=(a, v, \eta)$ and where $b=b(a, v,\eta)$, $w=w(a, v, \eta)$ and $\eta'=\eta'(a,v, \eta)$ are sc-smooth maps, and where $\varphi_{q_0}=\varphi_0$. Then the relationship between $\xi$ and $\xi'$ is defined by 
\begin{equation*}
\begin{split}
&\Gamma [ \oplus_a \exp_u (\eta), \oplus_a u] \circ \wh{\oplus}_a(\xi)\circ \sigma (a, v)\circ T\varphi^{-1}_{(a, v, \eta)}\circ \sigma'(b, w)^{-1}\\
&\qquad =
\Gamma' [\oplus_b'(\exp_{u'}'\eta'), \oplus_b'(u')] \circ \wh{\oplus}_b'(\xi')
\end{split}
\end{equation*}
and 
$$\wh{\ominus}_b'(\xi')=0.$$
Here $(b, w, \eta')$ are the above sc-smooth maps of $(a, v, \eta)$.  As in the previous chapter, a local case by case study shows that $\xi'$ is an $\ssc_\triangleleft$--smooth map of $(a, v,\eta, \xi)\in K^{\mathcal R}$ which is linear in $\xi$. The ingredients and arguments in this study are similar to those in the proof of the sc-smoothness  in the polyfold construction in {Chapter \ref{chapter_2_technical results}}  and the details are left to the reader.  The map $\xi'$  is clearly fiber-wise an isomorphism. A similar discussion shows  that its fiber-wise inverse is also
a strong bundle map, which implies that $\mu$ is a local sc-diffeomorphism since it covers the local sc-diffeomorphism $t$.
This completes the proof that $\mu$ is a strong bundle map.

\end{proof}

At this point we have constructed a strong bundle $(E,\mu)$ over the ep-groupoid $X$ as defined in Definition \ref{stbundleep}. Recalling Definition \ref{stbundleep1}  we are now  in the position to define
the structure of a strong polyfold bundle on the bundle $\wh{p}:  W\rightarrow Z$.
We consider the canonical map $\Gamma:E\to W$ introduced above. Denoting by $\abs{E}$ the space of orbits under the morphisms in $\be$, we see that $\Gamma$ induces the map 
$$\abs{\Gamma}:\abs{E}\to W$$
defined by 
$$\abs{\Gamma} (\abs{(a,v,\eta, \xi, \wh{\alpha}_{(a,v, \eta, \xi)})})=[\wh{\alpha}_{(a,v,\eta,\xi)}].$$
We note that the existence of an isomorphism 
$$\wh{\varphi}:\wh{\alpha}_{(a,v,\eta, \xi)}\to \wh{\alpha'}_{(a',v',\eta',\xi')}$$
implies the existence of an isomorphism $\varphi:\alpha_{(a, v, \eta)}\to \alpha'_{(a',v',\eta')}$ and since $(a, v,\eta)\to \alpha_{(a,v,\eta)}$ is a good uniformizing family, this implies, as we have seen in the previous chapter, that $(a', v', \eta')=g\ast (a, v, \eta)$ and 
$\varphi=g_a$ for a suitable element $g\in G$. It therefore follows from the definition of $\mu$ that the map $\abs{\Gamma}:\abs{E}\to W$ is a homeomorphism. Recalling the natural homeomorphism $\abs{p}:\abs{X}\to Z$ between the orbit space $\abs{X}$ and $Z$, defined as
$$\abs{p}(\abs{(a, v, \eta, \alpha_{(a, v,\eta)})})=[\alpha_{(a, v,\eta)}],$$
and  the projection functor $P:E\to X$ introduced in Section \ref{sc-smoothness},   which induces  the map 
$\abs{P}:\abs{E}\to \abs{X}$ between the  orbit spaces, we conclude that $\abs{p}\circ \abs{P}=\wh{p}\circ \abs{\Gamma},$ so that the diagram
\mbox{}\\
\begin{equation*}
\begin{CD}
\abs{E}@>\abs{P}>>\abs{X}\\
@V\abs{\Gamma} VV @VV\abs{p}V \\
W@>\wh{p}>>Z\\ \\
\end{CD}
\end{equation*}
commutes.
Therefore, the triple $(P:E\to X, \abs{\Gamma}, \abs{p})$ defines the structure of a strong polyfold bundle on the bundle $\wh{p}:W\to Z$ as claimed in Theorem \ref{main1.10} in the introduction.

Herewith the proof of Theorem \ref{main1.10} is complete. \hfill $\blacksquare$

\endinput


\chapter{The Nonlinear Cauchy-Riemann Operator}\label{fredholm-section-z}
The chapter is devoted to the Cauchy--Riemann section of the strong polyfold bundle $W\to Z$ constructed in the previous section. Its solution sets are the Gromov compactified moduli spaces. We shall prove, in  particular,  
Theorem \ref{maincauchy-riemann} of the introduction.

\section{Fredholm Sections of Strong Polyfold Bundles}
We begin with the definition of a section of a strong bundle.
\begin{definition}
Let $P:E=(E, {\bf E})\to X=(X, {\bf X})$ be a strong bundle over the ep-groupoid $X$. A {\bf section of the strong bundle} $P$ is an sc-smooth functor 
$$F: X\rightarrow E
$$
satisfying $P\circ F=\id$.\index{section of a strong bundle over ep-groupoid}


An $\ssc^+$-section of the strong bundle $P$ is a section $F$ which  induces  an sc-smooth functor $(X, {\bf X})\to (E^{0,1}, {\bf E}^{0,1})$ where $E^{0,1}$ resp. ${\bf E}^{0,1}$ are equipped with the grading $(E^{0,1})_{m}=E_{m,m+1}$  resp. $({\bf E}^{0,1})_{m}={\bf E}_{m,m+1}$ for $m\geq 0$.\index{$\ssc^+$-section of a strong bundle over ep-groupoid}

\end{definition}
The functoriality of the section $F:X\to E$ implies for the section $F:X\to E$ on the objects sets that 
$$\mu (\varphi, F(x))=F(y),$$
and for the section ${\bf F}:{\bf X}\to {\bf E}$ on the morphisms sets that 
$${\bf F}(\varphi)=(\varphi, F(x))\in {\bf X}{_s}\times_p E$$ for every morphism $\varphi \in {\bf X}$ satisfying $s(\varphi)=x$ and $t(\varphi )=y$ where $s, t:{\bf X}\to X$ are the source and the target maps.

\begin{definition}
A {\bf Fredholm section $F$ of the strong bundle}  $P:(E, {\bf E})\to (X, {\bf X})$ over the ep-groupoid $(X, {\bf X})$ is an sc-smooth section $F$ of $P$ which, as a section $F:X\to E$ on the object sets, is an M-polyfold  Fredholm section as defined in Definition 3.6 in \cite{HWZ3.5} and recalled in Section \ref{sectionpolyfred} above.
\index{Fredholm section!of a strong bundle  over an ep-groupoid}
\end{definition}

An example of a Fredholm section is the Cauchy-Riemann operator $\ov{\partial}_J$ dealt with in the next section. The {\bf Cauchy-Riemann section}  $\ov{\partial}_J$ of the bundle $W\to Z$ is defined as 
$$\ov{\partial}_J([S,j, M, D, u])=[S,j, M, D, u, \frac{1}{2}(Tu+J(u)\circ Tu\circ j)].$$
In the strong bundle structure $(P:E\to X, \Gamma, \gamma)$ of the bundle $W\to Z$,  the section $\ov{\partial}_J$ is  represented by the section $F:X\to E$ on the object sets,  defined by 
$$F(q, \alpha_q)=((q,\xi),\wh{\alpha}_{(q,\xi)}).$$
Here, $q=(a,v,\eta)\in {\mathcal O}$ and $(q, \xi)\in K^{\mathcal R}$ where $\xi$ is the unique solution of the two equations 
\begin{equation}\label{cauchy_riemann_eq_0}
\begin{aligned}
\Xi (a, v, \eta, \xi)&=\frac{1}{2}\bigl[T(\oplus_a \exp_{u}(\eta))+J(\oplus_a \exp_{u}(\eta))\circ  T(\oplus_a \exp_{u}(\eta))\circ j(a, v)\bigr] \\
\wh{\ominus}_{a}(\xi)&=0,
\end{aligned}
\end{equation}
{where $\Xi$ is defined in \eqref{sigma_complex_linear_1} as 
$$
\Xi (a, v, \eta, \xi)=\Gamma  [ \oplus_a\exp_u (\eta), \oplus_au]\circ \wh{\oplus}_a(\xi )\circ \delta (a, v).
$$
}

The next section will show that $F$ is a Fredholm section in the sense of Section  \ref{sectionpolyfred}.

If $p:W\to Z$ is a strong polyfold bundle and $(P:E\to X, \Gamma, \gamma)$ a strong polyfold structure of $p$, then the smooth section $F$ of $P:E\to X$ defines a continuous section $f$ of the bundle $p:W\to Z$ by 
$$f\circ \gamma =\Gamma \circ \abs{F}.$$
In diagrams,
\mbox{}\\
\begin{equation*}
\begin{CD}
\abs{X}@>\gamma>>Z\\
@V\abs{F}VV   @VVfV \\
\abs{E}@>\Gamma>> W.\\ 
\end{CD}
\end{equation*}
\mbox{}\\

Let $(P':E'\to X', \Gamma', \gamma')$ be an equivalent strong bundle structure for $p:W\to Z$ in the sense of Definition 3.29 in \cite{HWZ3.5}, and let $(f', F')$ the associated pair of sections where $f'\circ \gamma'=\Gamma'\circ \abs{F'}$. Then the two pairs $(f, F)$ and $(f', F')$ are called equivalent, if $f'=f$ and if there exists an s-{bundle}  isomorphism $\mathfrak{A}:E\to E'$ (as defined in  Section 3.4  of  \cite{HWZ3.5}) whose push-forward satisfies $\mathfrak{A}_\ast (F)=F'$. 
\begin{definition}
An equivalence class $[f, F]$ of sections is called an {\bf sc-smooth section of the polyfold bundle $p:W\to Z$}  and the pair $(f, F)$ is called a representation of the map $f:Z\to W$ in  the model $P:E\to X$.\index{sc-smooth section of the polyfold bundle}
\end{definition}

In view of Proposition 2.25 in \cite{HWZ3.5} these concepts are all well defined. We recall from \cite{HWZ3.5} the following definition.
\begin{definition}
The section $f=[f,F]$ of the  polyfold  bundle $p:W\to Z$ is called a {\bf Fredholm section}  provided  there exists a representation $F$ of $f$ which is a Fredholm section of the strong bundle $P:E\to X$ belonging to the polyfold structure $(P:E\to X, \Gamma, \gamma)$ of the strong bundle. \index{Fredholm section of a polyfold bundle}

The Fredholm section $f$ is called {\bf proper}  if the solution set 
$$S(f)=\{z\in Z\, \vert \, f(z)=0\}$$
is compact in $Z$.\index{proper Fredholm section}
\end{definition}

We end with a useful remark.
\begin{remark}
{
We consider the strong bundle $P:E\to X$ over the object set of the  ep-groupoid $X$.
If $\Phi:e\rightarrow e'$ is a morphism in ${\bf E}$, then 
the associated map $t\circ s^{-1}$ on $E$ defines an isomorphism
between two strong bundles $\Gamma:E\vert U\rightarrow E\vert V$, where $U,V\subset X$
are open subsets of the object space $X$ which are  sc-diffeomorphic by the local diffeomorphism $\gamma$ underlying  the map $t\circ s^{-1}$. 
The points in $E$ have the form
$$
(a,v,\eta,\xi,S_a,j(a,v),M_a,D_a,\oplus_a\exp_u(\eta),\Xi(a,v,\eta,\xi)), 
$$
and are mapped to similar (primed) data, in which 
$(a',v',\eta',\xi')$ are sc-smooth functions of $(a,v,\eta,\xi)$.
Moreover the transformation is linear in $\xi$. The crucial observation
which will allow for a more specialized perturbation theory is the following. If $\xi$ vanishes near the nodal  points in $|D_a|$ then the same
is true for $\xi'$ near $|D_{a'}'|$. This holds in a uniform way with
respect to some open neighborhood around the underlying point $(a,v,\eta)$.
A similar assertion is true with respect to the vanishing near marked  points in $M$. As a consequence we can distinguish the  subclass of $\ssc^+$-multisections which vanish near nodal points or near marked points. If we take the sum of two such multi-sections, as defined in  {Section 3.5}  of  \cite{HWZ3.5}, the same remains true for their  sum}. \end{remark}


\section{The Cauchy-Riemann Section:  Results}\label{c-r-results}
In this section we merely describe the main results of the chapter. Their  proofs are postponed to the  later sections.


As before we denote by 
$(Q,\omega)$ a closed symplectic manifold  of dimension $2n$ and by $J$ a compatible almost complex structure on $Q$. 
The bundle $p:W\to Z$ over the space $Z$ of stable curves from the noded Riemann surfaces into the manifold $Q$ is equipped with the structure of a strong polyfold bundle. The nonlinear Cauchy-Riemann operator defines the continuous section $\ov{\partial}_J$ of the bundle $p$ via 
$$
\ov{\partial}_J([S,j,M,D,u])=[S,j,M,D,u,\ov{\partial}_{J,j}(u)]
$$
where 
$$\ov{\partial}_{J, j}(u)=\frac{1}{2}\bigl(Tu+J(u)\circ Tu\circ j)$$ and 
$u:S\to Q$. The section $\ov{\partial }_{J}$ will be abbreviated by $f=\ov{\partial }_{J}$. The section $f$ is induced from the section $F$ of the model bundle  $P:E\to X$ which is a strong bundle over the ep-groupoid $X$. The pair $(f, F)$ will be called the nonlinear Cauchy-Riemann section of $p$. The key result is the following theorem. 

\begin{theorem}\label{FREDPROP}
The Cauchy-Riemann section $(f, F)$ of $p$ defines an sc-smooth component-proper Fredholm section.  On the component $Z_{g,k,A}$
the  real Fredholm index is  equal to 
$$
2n(1-g)+2c_1(A)+6g-6+2k,
$$
with $2n=\text{dim}\ Q$, where $g$ is the arithmetic genus of the noded Riemann surfaces, $k$ the number of marked points and $A\in H_2(Q)$. Moreover,  $f$ has a natural orientation.
\end{theorem}

The orientation is discussed in the appendices \ref{orientations-abstract} and \ref{orientations}.  From an abstract point of view the orientability is discussed in \cite{HWZ10}.  It is discussed  in the generality relevant for  Symplectic Field Theory in \cite{HWZ5}.  The component-proper assertion involves arguments of Gromov compactness as explained in Remark \ref{GROMOV} below. The index calculation is well-known. The Fredholm index can be deduced from the corresponding  results  in  \cite{Lock} and  \cite{MS}. The technology can be found in  \cite{Floer1,Floer2,MSCH}.  We should mention that in these computations the nodes are treated as singularities so that the punctured Riemann surfaces are manifolds with cylindrical ends. Theorem \ref{FREDPROP} will follow from the three Propositions \ref{SC-SMOOTHREG}, \ref{C0-CONT}, and \ref{comprop} which we present next.

As described in Section \ref{polstrbundle} the Cauchy-Riemann section in the ep-groupoid description has, in the local  sc-coordinates, the form 
$$
(a,v,\eta)\mapsto  (a,v,\eta,\xi)
$$
where $(a,v,\eta)\in {\mathcal O}$ and $(a,v,\eta,\xi)\in K^{\mathcal R}$. The map  $\xi$ is  the unique solution of the two equations\begin{align*}
\Xi(a,v,\eta,\xi)&= \bar{\partial}_{J,j(a,v)} (\oplus_a\exp_{u}(\eta))\\
\wh{\ominus}_{a}(\xi)&=0.
\end{align*}
In view of the definition of $\Xi$ in the construction of the strong bundle structure,  the above equations  become
\begin{equation}\label{con}
\begin{aligned}
\Gamma(\oplus_a\exp_{u}(\eta),\oplus_a(u))\circ\wh{\oplus}_a(\xi)\circ\delta(a,v)&=\ov{\partial}_{J,j(a,v)} (\oplus_a\exp_{u}(\eta))\\
\wh{\ominus}_{a}(\xi)&=0.
 \end{aligned}
\end{equation}

\begin{proposition}\label{SC-SMOOTHREG}
The Cauchy-Riemann section $\ov{\partial}_J$ of the bundle $p:W\to Z$ is  sc-smooth and regularizing. In particular, all the local expressions 
$$
\co\rightarrow K^{\mathcal R},\quad  (a,v,\eta)\mapsto (a,v,\eta,\xi)
$$
are sc-smooth. If $(a,v,\eta,\xi)\in K^{\mathcal R}_{m,m+1}$, then it follows that  $(a,v,\eta)\in \co_{m+1}$.
\end{proposition}

The proof of Proposition \ref{SC-SMOOTHREG} is postponed to Section \ref{sec5.2}.

As recalled in Section \ref{sectionpolyfred}, in order to verify the (polyfold-)Fredholm property of the section $\ov{\partial}_J$ it remains to show that for every smooth point,  the germ of $\ov{\partial}_J$ around this point admits a filled version,  which after correction by a suitable sc$^+$-section is conjugated to a basic germ. 


In order to construct the filled section we denote for every nodal pair $\{x, y\}\in D$,  the image of the nodal points  under the map $u$ by 
$$q_{\{x, y\}}=u(x)=u(y)\in Q.$$

If the gluing parameter $a=a_{\{x,y\}}$ does not vanish,  we denote by 
$$\cae^{\{x,y\}}_a=H^{3,\delta_0}_c(C^{\{x,y\}}_{a_{\{x,y\}}},T_{q_{\{x,y\}}}Q)$$
the usual sc-Hilbert space (introduced in Section \ref{gluinganti-sect}) of mappings defined on the 
infinite cylinder $C_a$ having antipodal asymptotic constants. The level $m$ refers to the regularity $(m+3, \delta_m)$. As always, the strictly increasing sequence $(\delta_m)$ belongs to $(0, 2\pi)$. If $a_{\{x, y\}}=0$, we set 
$$\cae^{\{x,y\}}_0=\{0\}.$$
Similarly we abbreviate 
$$\cf ^{\{x,y\}}_a=H^{2,\delta_0}(C^{\{x,y\}}_{a_{\{x,y\}}},T_{q_{\{x,y\}}}Q)$$ 
if $a=a_{\{x,y\}}\neq 0$ and  otherwise set $\cf_0^{\{x,y\}}=\{0\}$. 

At every nodal pair $\{x,y\}\in D$, the linear  Cauchy-Riemann operator 

$$
\ov{\partial}^{\{x,y\}}_0(k) = \partial_s k+J(q_{\{x,y\}})\partial_t k,
$$
is an sc-isomorphism
$$
\ov{\partial}^{\{x,y\}}_0:\cae^{\{x,y\}}_a\rightarrow \cf^{\{x,y\}}_a.
$$
Here $(s, t)$ are the distinguished coordinates on the infinite cylinder $C_{a_{\{x, y\}}}^{\{x,y\}}$ as explained in Section \ref{preliminaries} below. 
If $a_{\{x, y\}}=0$, this linear Cauchy-Riemann operator is the zero operator between two trivial spaces. The filled section is defined as the map 
\begin{equation}\label{filled-d}
(a,v,\eta)\mapsto\xi
\end{equation}
where  it is no {longer required  that  $(a,v,\eta)$ belongs to the subset $\co$ of the splicing core}.  Instead the section $\eta$ of $u^*TQ$, having matching asymptotic constants across the nodes, is merely required to satisfy the constraints 
$$
\eta(z)\in H_{u(z)}
$$
at  the points $z\in \Sigma$ of the chosen stabilization set $\Sigma$ on $S$. Moreover, the map $\xi$, which associates with every point $z\in S\setminus  \abs{D}$ a complex anti-linear map 
$$\xi (z): (T_zS, j(z))\to (T_{u(z)}Q, J(u(z))),$$
is now determined by the equations
\begin{equation}\label{DEFR}
\begin{aligned}
\Gamma(\oplus_a(\exp_{u}(\eta)),\oplus_a(u))\circ\wh{\oplus}_a(\xi)\circ\delta (a,v)&= \ov{\partial}_{J,j(a,v)} (\oplus_a\exp_{u}(\eta))\\
 \wh{\ominus}_{a_{\{x,y\}}}^{\{x,y\}}(\xi) \cdot \frac{\partial }{\partial s}&= \ov{\partial}^{\{x,y\}}_0(\ominus_{a_{\{x,y\}}}^{\{x,y\}}(\eta))\end{aligned}
\end{equation}
for all nodal points $ \{x,y\}\in D.$

Let us denote by $\cae$ the sc-Banach space consisting  of the sections $\eta$ of the bundle $u^{\ast}TQ$ of  class $(3,\delta_0)$, having matching asymptotic conditions at the nodes and satisfying the  constraints  $\eta(z)\in H_{u(z)}$ at all the points $z\in \Sigma$ of the fixed stabilization set $\Sigma$.  We recall from Definition \ref{GD} of good data that $H_{u(z)}=T_{u(z)}M_{u(z)}$ is a complement in $T_{u(z)}Q$ of the image of $Tu(z)$. By $N$  we denote the vector space of gluing parameters 
$(a_{\{x,y\}})_{\{x,y\}\in D}$ and by $E$ the vector space containing $0\in V\subset E$ where $v\in V$ parametrizes  the complex structures $j(v)$ on $S$. Given $a=\{a_{\{x,y\}}\vert\, \{x,y\}\in D\}\in N$  satisfying $\abs{a_{\{x,y\}}}<\frac{1}{2}$ and given $\eta \in \cae$, we denote by  
$\ominus_a(\eta)$ the tuple $$
\ominus_a(\eta)=\left\{ \ominus^{\{x,y\}}_{a_{\{x,y\}}}(\eta)\right\}_{\{x,y\}\in D}.
$$
The total gluing takes the form
$$
\eta\mapsto  \boxdot_a(\eta)= (\oplus_a(\eta),\ominus_a(\eta)).
$$
Similarly, the total hat-gluing has the form 
$$
\xi\mapsto  \wh{\boxdot}_a(\xi)=(\wh{\oplus}_a(\xi),\wh{\ominus}_a(\xi)).
$$
By $\ov{\partial}_0$  we shall denote the tuple of operators
$$
\ov{\partial}_0 =\left\{ \ov{\partial}^{\{x,y\}}_0\right\}_{\{x,y\}\in D}.
$$
For the following considerations we  shall rewrite the  equations \eqref{DEFR} as follows,
\begin{equation}\label{defined}
\begin{aligned}
\Gamma(\oplus_a\exp_{u}(\eta),\oplus_a(u))\circ\wh{\oplus}_a(\xi)\circ\delta (a,v)&= \ov{\partial}_{J,j(a,v)} (\oplus_a\exp_{u}(\eta))\\
 \wh{\ominus}_a(\xi)\cdot \frac{\partial }{\partial s} &=\ov{\partial}_0 (\ominus_a(\eta)).
\end{aligned}
\end{equation}

Let us denote by $O$ a small open neighborhood
of the origin $(0,0,0)\in N\oplus E\oplus \cae $.  By $\cf$ we denote the collection of all maps $z\rightarrow\xi(z)$ of class $(2,\delta_0)$,
which associate to a point $z\in S\setminus|D|$ a map $\xi(z):(T_zS,j(z))\rightarrow (T_{u(z)}Q,J(u(z)))$ which is complex anti-linear.
The sc-structure is given by requiring that the level $m$ consists of maps of regularity $(m+2,\delta_m)$. {The norms on $\cf$
can be defined as in the case of $H^{3+m,\delta_m}(u^\ast TQ)$ as a sum of semi-norms. For example,  near nodal points from a nodal pair $\{x,y\}$ we take positive (negative) holomorphic polar coordinates centered around $x$ and $y$, respectively and 
associate to $\xi$ the pair $(\xi^+,\xi^-)$ defined by
$$
\xi^+(s,t) =\pr_2\circ T\psi(u(\sigma_x(s,t)))\frac{\partial\sigma_x}{\partial s}(s,t)
$$
and
$$
\xi^-(s,t) =\pr_2\circ T\psi(u(\sigma_y(s',t')))\frac{\partial\sigma_y}{\partial s}(s',t')
$$}


If $(a,v,\eta)\in O$,  we compute the map $\xi\in \cf$ as the solution of the equation \eqref{defined}. This defines the   map
\begin{equation}\label{FILLED}
{\bf f}:O\rightarrow \cf,\quad  {\bf f}(a,v,\eta)=\xi.
\end{equation}


\begin{proposition}[{\bf Filled version}]\label{C0-CONT}
The map ${\bf f}:O\rightarrow \cf$ defined by \eqref{FILLED} is sc-smooth. It is a filled version of  the section $F$ in the ep-groupoid representation. If ${\bf s}$ is an $\ssc^+$-section satisfying  ${\bf s}(0,0,0)={\bf f}(0,0,0)$, then
${\bf f}-{\bf s}$ is conjugated near $(0,0,0)$ to an $\ssc^0$-contraction germ. 
\end{proposition}
The proof of Proposition \ref{C0-CONT} is carried out in Section \ref{section4.4}.

Proposition \ref{SC-SMOOTHREG}  together with Proposition \ref{C0-CONT}  demonstrate the Fredholm property of 
$\ov{\partial}_J$. In order to prove these two propositions we shall establish useful local coordinates expressions for the equations \eqref{DEFR},  making use of the fact that all the occurring expressions are local,  in the sense that  
the properties of the solutions $\xi$ near a point $z\in S$ depend only on $\eta$ and $u$ near $z$ (besides on the parameters $(a, v)$ of course). In the study of nonlinear elliptic pde's there are standard ways to obtain global estimates from local estimates. We shall use these ideas as well. However, the crucial  difficulty going beyond the classical estimates, is to obtain estimates in the neighborhoods of the nodal points, which are independent of the gluing parameter $a$. 

\begin{proposition}\label{comprop}
The Cauchy-Riemann section $\ov{\partial}_J$ of the bundle $p:W\rightarrow Z$ is component-proper.
\end{proposition}
\begin{remark}\label{GROMOV} This is essentially the Gromov compactness theorem and as such a special case of the results in \cite{BEHWZ}. There is, however, one issue which has to be pointed out. In principle we need to show that the induced topology from $X$ on the solution set is a compact topology. Now,  as it turns out, this induced topology is the same topology as the topology familiar from  the Gromov compactness proofs.  As long as one stays away from the nodes, one uses the fact that gradient bounds imply $C^\infty$-bounds. At the nodes, the usual discussion has to be sharpened by using  the results (or easy variations of) from 
\cite{HWZ7.1}. We leave the details to the reader.
\end{remark}

\section{Some Technical Results}\label{preliminaries}
In this section we collect some technical tools which will be used in  the proofs of Proposition \ref{SC-SMOOTHREG} and Proposition \ref{C0-CONT}.

As usual the strictly increasing sequence $(\delta_m)_{m\geq 0}$ is fixed and satisfies $0<\delta_m<2\pi$ for all $m\geq 0$. We recall that the Hilbert spaces $F_m^\pm=H^{2+m,\delta_m}(\R^\pm \times S^1)$, $m\geq 0$,  
consist of $L^2$-maps 
$$u:\R^\pm \times S^1\to \R^{2n}$$
whose  weak partial derivatives $D^{\alpha}u$   up to order $2+m$ belong,   if weighted by $e^{\delta_m \abs{s}}$,   to  the space $L^2(\R^\pm \times S^1)$ so that  $e^{\delta_m \abs{s}} D^{\alpha}u\in L^2(\R^\pm \times S^1)$ for all $\abs{\alpha}\leq 2+m$. 
We equip the Hilbert spaces 
$$F_m=F_m^+\oplus F^-_m$$ 
with the  norms 
$
\abs{(\xi^+,\xi^-)}^2_{F_m}:= \norm{\xi^+}^2_{2+m,\delta_m} +\norm{\xi^-}^2_{2+m,\delta_m},
$
where 
$$
{\norm{\xi^\pm}}_{m,\delta_m}^2:=\sum_{|\alpha|\leq m} \int_{{\mathbb R}^\pm \times S^1} |D^{\alpha}\xi^\pm (s,t)|^2 e^{2\delta_m \abs{s}}dsdt.
$$
The  space  $F:=F_0$ is an sc-Hilbert  space  and the nested sequence $(F_m)$ defines an sc-structure on $F$.

{We will also need  the sc-Hilbert space $E$  consisting of pairs $(\eta^+,\eta^-)$ where $\eta^\pm=c+r^\pm$ for some constant $c$ and the pair $(r^+, r^-)$  belongs to 
$$H^{3,\delta_0}({\mathbb R}^+\times S^1,{\mathbb R}^{2n})\oplus
H^{3,\delta_0}({\mathbb R}^-\times S^1,{\mathbb R}^{2n}).$$ The maps $\eta^+$ and $\eta^-$ have matching asymptotic limits in the sense that 
$\lim_{s\to \infty}\eta^+(s, t)=\lim_{s\to -\infty}\eta^-(s, t).$
The sc-structure  on $E$ is given by  the spaces $E_m$ of regularity $(m+3,\delta_m)$. The $E_m$-norm of $(\eta^+,\eta^-)\in E_m$ is defined by 
$$
|(\eta^+,\eta^-)|_{E_m}^2 := |c|^2 +\norm{r^+}^2_{3+m,\delta_m} + \norm{r^-}^2_{3+m,\delta_m}
$$
where $\eta^\pm=c+r^\pm$ for some constant $c$.
}

We  recall from Section \ref{gluinganti-sect} that the total hat-gluing map
$$\wh{\boxdot}_a=(\wh{\oplus}_a, \wh{\ominus}_a):F\to \wh{G}^a=H^2(Z_a, \R^{2n})\oplus H^{2,\delta_0}(C_a, \R^{2n})$$
is an sc-linear isomorphism,  for every gluing parameter $a\in \hb$ satisfying $a\neq 0$. If $a=0$, then 
$$\wh{\boxdot}_0=(\wh{\oplus}_0, 0):F\to \wh{G}_0=F\oplus \{0\}$$
is the identity map. Now we define for $a\neq 0$ the maps 
\begin{equation*}
D^a_t, D^a_s:E\rightarrow F
\end{equation*}
by
\begin{align*}
D^a_t(\eta^+,\eta^-)& =\wh{\boxdot}_a^{-1}\bigl( \partial_t (\oplus_a( \eta^+,\eta^-)), 0\bigr)\\
D^a_s(\eta^+,\eta^-)& =\wh{\boxdot}_a^{-1}\bigl( \partial_s (\oplus_a( \eta^+,\eta^-)), 0\bigr).
\end{align*}
Correspondingly we set, for $a=0$, 
\begin{align*}
D^0_t(\eta^+,\eta^-)& = \partial_t (\eta^+,\eta^-)\\
D^0_s(\eta^+,\eta^-)& = \partial_s (\eta^+,\eta^-).
\end{align*}
Similarly,    the maps 
$$
C^a_t, C^a_s : E\rightarrow F
$$
are defined,  for $a\neq 0$  belonging to $\hb$,  by 
\begin{align*}
C^a_t(\eta^+,\eta^-)& =\wh{\boxdot}_a^{-1}\bigl(0,  \partial_t (\ominus_a( \eta^+,\eta^-))\bigr)\\
C^a_s(\eta^+,\eta^-)& =\wh{\boxdot}_a^{-1}\bigl(0,  \partial_s (\ominus_a( \eta^+,\eta^-))\bigr)
\end{align*}
and, if $a=0$, by 
$$C_s^0(\eta^+, \eta^-)=0=C_t^0(\eta^+, \eta^-).$$

\begin{proposition}\label{XCX1}
The maps $B_\frac{1}{2}\oplus E\rightarrow F$,  defined by 
$$
(a,(\eta^+,\eta^-))\mapsto D^a_{t}(\eta^+,\eta^-)\qquad \text{and}\qquad 
(a,(\eta^+,\eta^-))\mapsto D^a_{s}(\eta^+,\eta^-), $$
are sc-smooth. The same holds  true if we replace the maps $D^a_s, D^a_t$  by the maps $C^a_s, C^a_t$. Moreover,  for  every $m$ there exists a constant $C_m>0$ independent of $a$ such that 
$$
\abs{D^a_s(\eta^+,\eta^-)}_{F_m}\leq C_m\cdot \abs{(\eta^+,\eta^-)}_{E_m},\  \abs{D^a_t(\eta^+,\eta^-)}_{F_m}\leq C_m\cdot \abs{(\eta^+,\eta^-)}_{E_m},
$$
and 
$$
\abs{C^a_s(\eta^+,\eta^-)}_{F_m}\leq C_m\cdot \abs{(\eta^+,\eta^-)}_{E_m},\
\abs{C^a_t(\eta^+,\eta^-)}_{F_m}\leq C_m\cdot \abs{(\eta^+,\eta^-)}_{E_m}.
$$
\end{proposition}
The proof of the proposition is carried out  in Appendix \ref{XCX10}.



Now,  let  $E^{(N)}$, $F^{(K)}$, resp. $F^{(M)}$ be the sc-Hilbert spaces of functions, whose domains of definitions are half-cylinders as above, but whose image spaces are the Euclidean spaces $\R^N,  \R^K$ resp. $\R^M$ instead of $\R^{2n}$. 

The natural evaluation  map
$$
\call (\R^K,\R^M)\oplus \R^K\rightarrow \R^M
$$
will be denoted by 
$$(G, v)\mapsto G\cdot v.$$
With  a smooth map 
$$A:\R^N\rightarrow \call (\R^K,\R^M)$$
we associate the mapping 

$$
\wt{A}:B_\frac{1}{2}\oplus E^{(N)}\oplus F^{(K)}\rightarrow F^{(M)}, 
$$
defined for $a\neq 0$ as 
$$ 
\wt{A}(a,(u^+,u^-),(\eta^+,\eta^-))=(\xi^+, \xi^-), 
$$
where the pair $(\xi^+, \xi^-)\in F^{(M)}$ is the unique solution of the two equations
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi^+,\xi^-) (z)&= A\bigl(\oplus_a (u^+,u^-)(z)\bigr) \cdot \wh{\oplus}_a  (\eta^+,\eta^-) (z)\\
\wh{\ominus}_a(\xi^+,\xi^-)(z)&=0,
\end{aligned}
\end{equation*}
for $z$ on the cylinder $Z_a$. If $a=0$, we define 
$\wt{A}(0,(u^+,u^-),(\eta^+,\eta^-))=(A(u^+)\eta^+, A(u^-)\eta^-).$

Abbreviating the  notation we shall write $\xi$ instead of $(\xi^+,\xi^-)$ and $u$ instead of $(u^+, u^-)$ etc. so  that the above two equations  
defining $\wt{A}(a, u,\eta)=\xi$ become
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi) &= A(\oplus_a(u))\cdot \wh{\oplus}_a (\eta)\\
\wh{\ominus}_a(\xi)&=0.
\end{aligned}
\end{equation*}

For $a\in \hb$ fixed,  we denote by 
$$\wt{A}_a:E^{(N)}\oplus F^{(K)}\to F^{(M)}$$
the induced map $\wt{A}_a(u, \eta)=\wt{A}(a, u, \eta)$ and introduce,  for fixed $a\in \hb$ and fixed level $m$,  the map
$$L_a:E_m^{(N)}\to \call (F^{(K)}_m, F_m^{(M)}),$$ 
defined by $L_a(u)=\wt{A}(a, u,\cdot ).$

\begin{proposition}\label{XCX2}
\mbox{}
\begin{itemize}
\item[{\em (1)}] The bundle  map  
$$\bigl(B_\frac{1}{2}\oplus E^{(N)}\bigr)\triangleleft  F^{(K)}\rightarrow \bigl(B_\frac{1}{2}\oplus E^{(N)}\bigr)\triangleleft F^{(M)},
$$
$$
\bigl((a,u),\eta\bigr)\mapsto  \bigl((a,u),\wt{A}(a, u,\eta)\bigr)
$$
is  an $\ssc_\triangleleft$-smooth map.
If $u_0\in  E^{(N)}_m$ and $\varepsilon>0$ are given, then the following estimate  holds, 
$$
\abs{\wt{A}\bigl(a, u, \eta\bigr)-\wt{A}\bigl(a,u_0,\eta\bigr)}_{F_{m+i}^{(M)}}
\leq \varepsilon \cdot |\eta|_{F^{(K)}_{m+i}}
$$  
for all $u\in E_m^{(N)}$ sufficiently close  to
$u_0$ on the level $m$,  for all $\eta \in F^{(K)}_{m+i}$,  for all  $a\in \hb$,  and  for $i=0,1$.
\item[{\em (2)}] For a fixed  gluing  parameter $a\in \hb$ and the fixed  level $m$,  the map
$
L_a:E^{(N)}_m\rightarrow \call (F^{(K)}_m,F^{(M)}_m)$ 
is of class  $C^1$ and, denoting by $DL_a(u) (\wh{u})$ the linearization of $L_a$ at the point $u$ in the direction of $\wh{u}$, the map 
$$\hb \oplus E^{(N)}\oplus E^{(N)} \oplus F^{(K)}\rightarrow F^{(M)},$$
 defined by 
$$\bigl(a,u,\wh{u},\eta\bigr)\mapsto  \bigl[ DL_a(u)(\wh{u})\bigr]\cdot \eta, $$
is of class $\ssc^\infty$. 
\item[{\em (3)}]  Given a level $m$, a point $u_0\in E_m^{(N)}$, and a positive number $\varepsilon>0$, the following estimate holds,
\begin{equation*}
\begin{split}
\abs{\bigl[ DL_a(u)\cdot (\wh{u}) - DL_{a}(u_0)\cdot (\wh{u})\bigr] \cdot \eta}_{F^{(M)}_m}\leq\varepsilon\cdot \abs{\wh{u}}_{E_m^{(N)}}\cdot \abs{\eta}_{E_m^{(K)}}
\end{split}
\end{equation*}
for all $a\in \hb$,  $u$ sufficiently close to $u_0$ on level $m$, and  for all $\wh{u}\in E^{(N)}_m$, and all $\eta\in F_m^{(K)}$.
\end{itemize}
\end{proposition}

The proof of Proposition \ref{XCX2} is postponed to  the Appendix \ref{XCX20}.


Next we recall from \cite{HWZ8.7} the  estimates for the total hat-gluing map $\wh{\boxdot}_a$ and the total gluing map $\boxdot_a$.  If the gluing parameter $a$ satisfies $0<\abs{a}<\frac{1}{2}$,  the space 
$$
\wh{G}^a=H^{2}(Z_a,{\mathbb R}^{2n})\oplus H^{2,\delta_0}(C_a,{\mathbb R}^{2n}),
$$
has the sc-structure given by the sequence $H^{m+2}(Z_a,{\mathbb R}^{2n})\oplus H^{m+2,\delta_m}(C_a,{\mathbb R}^{2n}).$ If 
$a=0$,  we put  $\wh{G}^a=F\oplus\{0\}$.


For a map $q:Z_a\to \R^{2n}$  on the finite cylinder in $H^{k}(Z_a, \R^{2n})$ we define the norms
\begin{equation}\label{preliminaries9}
\nr q\nr^2_{k,\delta} =\sum_{|\alpha|\leq k} \int_{[0,R]\times S^1}   \abs{D^{\alpha}q(s,t)}^2\cdot e^{2\delta \abs{s-\frac{R}{2}}} dsdt
\end{equation}
where $\delta\in \R$. 

{We would like to point out that  here we allow the weight  $\delta$ to be negative;  in fact, this will be used crucially later on.}

If the map $p:C_a\to \R^{2n}$ on the infinite cylinder $C_a$ has  vanishing asymptotic constants we set $p(s, t)=p([s,t])$ and define the norms
\begin{equation}\label{preliminaries9_a}
\nr p\nr^2_{m,\delta} =\sum_{|\alpha|\leq m}\int_{\R\times S^1}   \abs{D^{\alpha}p(s,t)}^2\cdot e^{2\delta \abs{s-\frac{R}{2} }  } dsdt.
\end{equation}
We introduce the $\wh{G}^a_m$-norm of the pair $(q, p)\in \wh{G}^a$
by setting
$$
| (q,p)|_{\wh{G}^a_m}^2:=e^{\delta_m R}\cdot \left[\nr q\nr_{m+2,-\delta_m}^2+\nr p\nr_{m+2,\delta_m}^2\right].
$$



With the total hat gluing $\wh{\boxdot}_a(\xi^+,\xi^-)=\bigl(\wh{\oplus}_a(\xi^+,\xi^-), (\wh{\ominus}_a(\xi^+,\xi^-)\bigr)\in \wh{G}^a$ defined on $(\xi^+,\xi^-)\in F$, the following estimate is proved in \cite{HWZ8.7}, Theorem 2.26.
\begin{proposition}[{\bf Total Hat-Gluing Estimate}]\label{HAT_HAT}
For every $m\geq 0$ there exists a constant $C_m>0$ which does not depend  on $a$, such that
$$
\frac{1}{C_m}\cdot |(\xi^+,\xi^-)|_{F_m}\leq | \wh{\boxdot}_a(\xi^+,\xi^-)|_{\wh{G}^a_m}\leq C_m\cdot |(\xi^+,\xi^-)|_{F_m}
$$
for  $|a|<\frac{1}{2}$ and  $(\xi^+,\xi^-)\in F_m$.
\end{proposition}


A  similar estimate holds true also for  the total gluing map $\boxdot_a$. Recall the previously introduced space  $H^{3,\delta_0}_c$ consisting of all pairs $(\eta^+,\eta^-)$ of maps  $\eta^\pm:{\mathbb R}^\pm\times S^1\rightarrow {\mathbb R}^{2n}$ 
which have the same asymptotic constant $c$ such that  $\eta^\pm-c$ belongs to $H^{3,\delta_0}({\mathbb R}^\pm\times S^1,{\mathbb R}^{2n})$. The sc-structure of this space has the regularity $(3+m,\delta_m)$. 
In this case we introduce for $0<\abs{a}<\frac{1}{2}$ the sc-space 
$G^a$ by $G^a=H^{3}(Z_a,{\mathbb R}^{2n})\oplus H^{3,\delta_0}_c(C_a,{\mathbb R}^{2n})$ with the  sc-structure
$$
G^a_m= H^{3+m}(Z_a,{\mathbb R}^{2n})\oplus H^{m+3,\delta_m}_c(C_a,{\mathbb R}^{2n})
$$
where $p\in H^{m+3,\delta_m}_c(C_a,{\mathbb R}^{2n})$ possesses antipodal contants 
$p_{\infty}=\lim_{s\to \infty}p(s, t)=-\lim_{s\to -\infty}p(s, t)$ and we associate with $p$ the map 
$\wh{p}:C_a\to \R^{2n}$ defined by 
$$
\wh{p}([s,t])=p([s, t])-[1-2\beta_a(s)]\cdot p_{\infty}.
$$

\noindent {We recall that  the function $\beta_a$ is defined as $\beta_a(s)=\beta (s-R/2)$ with the function $\beta$ as  in Section \ref{gluinganti-sect}}. Then $\wh{p}$ has vanishing asymptotic limits and we define the norm on level $m$ of $(q, p)\in G^a_m$ by 
$$
\abs{(q,p)}^2_{G^a_m}:=\abs{[q]_a-p_\infty }^2+e^{\delta_mR}\bigl( \nr q-[q]_a+p_{\infty}\nr^2_{m+2,-\delta_m} +\nr \wh{p}\nr^2_{m+2,\delta_m}\bigr)
$$
where the mean value $[q]_a$ is the number 
$$
[q]_a=\int_{S^1} q\bigl(\bigl[\frac{R}{2},t\bigr]\bigr)\ dt, 
$$
and where $\wh{p} =p-(1-2\beta_a)\cdot p_\infty$.
For the total gluing map   $\boxdot_a(\eta^+,\eta^-):=\bigl(\oplus_a (\eta^+,\eta^-),\ominus_a (\eta^+,\eta^-)\bigr)\in E$, the following estimate is proved in  \cite{HWZ8.7},  Theorem 2.23.
\begin{proposition}[{\bf Total Gluing Estimate}]\label{total-gluing}
For every $m\geq 0$ there exists a constant $C_m>0$ independent of  the gluing parameter $a$ such that
$$
\frac{1}{C_m}\cdot |(\eta^+,\eta^-)|_{E_m}\leq |\boxdot_a(\eta^+,\eta^-)|_{G^a_m}\leq C_m\cdot |(\eta^+,\eta^-)|_{E_m}
$$
for $|a|<\frac{1}{2}$ and all $(\eta^+, \eta^-)\in E_m$.\index{total gluing estimates}
\end{proposition}

Finally  we recall some results about linear Cauchy-Riemann type operators, which   follow easily from
the usual methods for linear elliptic operators on domains with cylindrical ends as presented in  \cite{Lock},  combined with the well-known index calculation
for the Cauchy-Riemann operator on the sphere.
We present  an abbreviated version of the  Appendix 4.4 in  \cite{HWZ8.7}.
Given two copies of a bi-infinite cylinder $\R\times S^1$, say $\Sigma^+$ and $\Sigma^-$, we can construct, given a nonzero gluing parameter $a$, 
the finite cylinder $Z_a$ and two infinite cylinders $C_a$ and $Z_a^\ast$ as illustrated   in Figure \ref{Fig12}. The two cylinders $\Sigma^\pm$ have parts which are 
shaded in different ways in order  to identify the differences between $C_a$ and $Z_a^\ast$.

We denote by $H_c^{3,\delta_0}(C_a,{\mathbb R}^{2n})$ the usual sc-Hilbert space with antipodal asymptotic constants, where
the level $m$ is given by regularity $(m+3,\delta_m)$. As usual the sequence $(\delta_m)$ belongs to $(0,2\pi)$. {In the next proposition $J(0)$ is  a constant almost complex structure on $\R^{2n}$.}

\begin{proposition}\label{c-iso}
 The Cauchy-Riemann operator
$$
\ov{\partial}_0:=\partial_s+J(0)\partial_t: H^{3,\delta_0}_c(C_a,{\mathbb R}^{2n})\rightarrow H^{2,\delta_0}(C_a,{\mathbb R}^{2n})
$$
is an sc-isomorphism,  and for every $m\geq 0$ there exists a constant $C_m>0$ which is independent of $a$,  such that
$$
\frac{1}{C_m}\cdot |\xi|_{H^{3+m,\delta_m}_c}\leq |\bar{\partial}_0\xi|_{H^{2+m,\delta_m}}\leq C_m\cdot |\xi|_{H^{3+m,\delta_m}_c}
$$
for all $\xi\in H^{3+m,\delta_m}_c(C_a, \R^{2n})$.
\end{proposition}


\begin{figure}[!htb]
\psfrag {a}{\small{$\Sigma^+$}}
\psfrag {b}{$\Sigma^-$}
\psfrag {c}{$Z^\ast_a$}
\psfrag {d}{$C_a$}
\psfrag  {e}{$Z_a$}
\psfrag  {f}{$Z_a$}
\centering
\includegraphics[width=3.8in]{Fig12.eps}
\caption{The extended cylinder $Z_a^\ast$.}
\label{Fig12}
\end{figure}

Recall that the Hilbert spaces  $H^{3+m,-\delta_m}(Z_a^\ast,\R^{2n} )$ for $m\geq 0$ consist of maps $u:Z_a^\ast\rightarrow\R^{2n}$ for which the associated maps $u:{\mathbb R}\times S^1\rightarrow \R^{2n} $, defined by $ (s,t)\rightarrow u([s,t])$ have partial derivatives up to order $3+m$ which, if  weighted by $e^{-\delta_m|s-\frac{R}{2}|}$ belong to the space $L^2(\R\times S^1)$. 
 The norm of $u\in H^{3+m,-\delta_m}(Z_a^\ast, \R^{2n} )$ is defined  as 
 $$\nr u\nr_{3+m,-\delta_m}^{\ast}=\bigl( \sum_{\abs{\alpha}\leq 3+m }\int_{\R\times S^1}\abs{D^\alpha u}^2e^{-2\delta_m\abs{s-\frac{R}{2}}}\ dsdt\bigr)^{1/2} .$$
 The spaces $H^{2+m,-\delta_m}(Z_a^\ast,\R^{2n})$  and the norms $\nr u\nr_{2+m,-\delta_m}^{\ast}$ are defined analogously.
We denote  by $[u]_a$ the average of a map $u:{\mathbb  R}\times S^1\rightarrow {\mathbb R}^2$ over the  circle at $[\frac{R}{2},t]$,   defined by
$$
[u]_a:=\int_{S^1} u\Bigl(\Bigl[\frac{R}{2},t\Bigr]\Bigr) dt, 
$$
where the number  $R$ is equal to $R =\varphi (\abs{a})$  and $\varphi$ is the exponential   gluing profile.

\begin{proposition}\label{POLTER}
The Cauchy-Riemann operator
$$
\ov{\partial}_0:H^{3+m,-\delta_m}(Z_a^\ast,{\mathbb R}^{2n})\rightarrow H^{2+m,-\delta_m}(Z_a^\ast,{\mathbb R}^{2n})
$$
is a surjective Fredholm operator whose kernel  is of real dimension $2n$. (The kernel consists of the constant functions.) For every $m\geq 0$ there exists a constant $C_m>0$ independent of $a$, such that
\begin{equation}\label{poltereq1}
\frac{1}{C_m}\cdot \nr u-[u]_a\nr^\ast_{m+3,-\delta_m}\leq \nr\bar{\partial}_0(u-[u]_a)\nr^\ast_{m+2,-\delta_m}\leq C_m\cdot \nr u-[u]_a\nr^{\ast}_{m+3,-\delta_m}
\end{equation}
for all $u\in H^{3+m,-\delta_m}(Z_a^\ast,{\mathbb R}^{2n})$.
\end{proposition}

A proof is presented  in Appendix \ref{POLTERGG}.


\section{Regularization and Sc-Smoothness of  $\ov{\partial}_J$}\label{sec5.2}
We start with the regularity for the Cauchy-Riemann section $\ov{\partial}_J$ of the polyfold bundle $p:W\to Z$.
 { In Section \ref{natural_topology_Z_section} we have introduced the pair $(X, \abs{p})$ which defines a polyfold structure on the space  $Z$ of stable curves. Here $X$ is an ep-groupoid and $\abs{p}:\abs{X}\to Z$ is the
 homeomorphism induced from the canonical map $p:X\to Z$.  The orbit space $\abs{X}$ is equipped with the filtration $\abs{X_0}=\abs{X}\supset \abs{X_1}\supset \abs{X_2}\supset \cdots \supset \abs{X_\infty}=\bigcap_{i\geq 0}\abs{X_i}$ where $\abs{X_\infty}$ is dense in every $\abs{X_i}$. This filtration induces via the homeomorphism $\abs{p}:\abs{X}\to Z$ the filtration 
 $Z=:Z_0\supset Z_1\supset  Z_2\supset \cdots \supset  Z_\infty=\bigcap_{i\geq 0}Z_i.$ Similarly, in Section \ref{polstrbundle}  we have defined the polyfold structure $(P:E\to X, \abs{\Gamma}, \abs{p})$ of the bundle $p:W\to Z$ where $P:E\to X$ is an strong bundle over the ep-groupoid $X$ and $\abs{\Gamma}:\abs{E}\to W$ is a homeomorphism between the orbit space of $E$  and $W$. 
 The double filtration $\abs{E_{i, k} }$ for $i\geq 0$ and $0\leq k\leq i+1$, of the orbit space $\abs{E}$ induces via the homeomorphism $\abs{P}:\abs{E}\to W$ the double filtration $W_{i, k}$ for $i\geq 0$ and $0\leq k\leq i+1$.
 }

Now,  in view of the polyfold constructions, it suffices to prove the following theorem.
\begin{theorem}\label{thm-regularity1}
The section $\ov{\partial}_J:Z\to W$ has the following regularity property. If $\zeta=[(S, j, M, D, u)]\in Z_m$ satisfies $\ov{\partial}_J(\zeta)\in W_{m,m+1}$, then $\zeta\in Z_{m+1}.$
\end{theorem}
\begin{proof}
We choose the representative $(S, j, M, D, u)$ of  the equivalence class 
$$\zeta=[(S, j, M, D, u)]\in Z_m.$$
 By assumption,  the map $u:S\to Q$  has regularity  $(m+3,\delta_m)$. By definition of $\ov{\partial}_J$, 
$$\ov{\partial}_{J}[(S, j, M, D, u)]=[(S, j, M, D, u,\ov{\partial}_{J, j}(u))]\in W_{m, m+1}.$$
Hence $\ov{\partial}_{J, j}(u)=w$ has fiber-regularity $(m+3, \delta_{m+1})$. 
The standard elliptic regularity theory implies that  away from the nodal points $u$ is of Sobolev class 
$H^{m+4}_{\loc}$. 


In order to analyze the map $u$ near the nodes we choose a nodal point $x\in S$ and take  the holomorphic polar coordinates 
$ 
\sigma:[0,\infty)\times S^1\rightarrow S\setminus\{x\}
$ 
{belonging to the small disk structure (before denoted by $h_x$) and } satisfying $\sigma (s, t)\to x$ as $s\to \infty$. Moreover,  we choose on the manifold $Q$ a smooth chart 
$
\psi:U(u(x))\rightarrow {\mathbb R}^{2n}
$
mapping $u(x)\in Q$ to $0\in \R^{2n}$, and  obtain for the map $u$ in local coordinates the map $v:[0,\infty)\times S^1\to \R^{2n}$,  defined by 
$$
v(s,t)=\psi\circ u\circ \sigma(s,t).
$$
Then $v(s,t)\rightarrow 0$ as $s\rightarrow\infty$ and $v\in H^{m+3,\delta_m}(\R^+\times S^1, \R^{2n})$. In order to show that $v$ solves an elliptic equation we insert $z=\sigma (s, t)$ into the equation 
{
\begin{equation}\label{cr_0}
\ov{\partial }_{J,j}(u)(z)=\frac{1}{2}\bigl[ Tu(z)+J(u(z))\circ Tu(z)\circ j(z)\bigr]=:w(z)
\end{equation}
so that in local coordinates  the equation \eqref{cr_0} becomes
\begin{equation}\label{cr-2}
\begin{split}
\frac{1}{2}&T\psi (u(\sigma ))\bigl[Tu(\sigma)+J(u\circ \sigma)\circ Tu(\sigma)\circ j(\sigma)\bigr]\cdot T\sigma\\
&=T\psi (u(\sigma))\cdot w(\sigma )\cdot T\sigma =:\wh{w}.
\end{split}
\end{equation}
Using $T\psi (u(\sigma))\circ Tu(\sigma) \circ T\sigma=Tv$ and   $j(\sigma)\circ T\sigma=T\sigma \circ i$, the equation \eqref{cr-2} turns into 
\begin{equation}\label{cr-3}
\frac{1}{2}\bigl[Tv+\wh{J}(v)\circ Tv\circ i\bigr]=\wh{w}.
\end{equation}
Here  $\wh{J}$ is the  smooth almost complex structure on $\R^{2n}$ defined by 
$\wh{J}(y)=T\psi (\psi^{-1}(y))\circ J(\psi^{-1}(y))\circ T\psi (\psi^{-1}(y))^{-1}$ at $y\in \R^{2n}$ and $\wh{w}=T\psi (u(\sigma))\circ w (\sigma)\circ T\sigma$. 
Clearly,  $\wh{w}\circ i=-\wh{J}(v)\circ \wh{w}$,  so that 
$\wh{w}$  is complex anti-linear. }

Applying the  complex anti-linear maps in  \eqref{cr-3}  to the vector  $\frac{\partial}{\partial s}$, we obtain the following equation for  the map $v:[0,\infty)\times S^1\to \R^{2n}$,
$$\frac{1}{2}\bigl[v_s+\wh{J}(v)v_t\bigr]=g$$
where $g(s, t)=\wh{w}(s, t)\frac{\partial}{\partial s}.$ By assumption, $v\in H^{m+3,\delta_m}(\R^+\times S^1,\R^{2n})$ and
 $g\in H^{m+3,\delta_{m+1}}(\R^+\times S^1,\R^{2n})$ and we have to prove that $v$ belongs to the space $H^{m+4,\delta_{m+1}}(\R^+\times S^1,\R^{2n})$. This follows immediately from the following proposition which then concludes the proof of  Theorem \ref{thm-regularity1}.

\begin{proposition}\label{lem-reg1}
Assume that $v$ belongs to $H^{m+3,\delta_m}(\R^+\times S^1, \R^{2n})$ and
 $g$  belongs to  $H^{m+3,\delta_{m+1}}(\R^+\times S^1,\R^{2n})$.   Let $J$ be a smooth almost complex structure on $\R^{2n}$. If $v$ is a solution of the equation $v_s +J(v)v_t= g $
on $\R^+\times S^1$, then for every $\varepsilon>0$  the map $v$ belongs to the space $H^{m+4,\delta_{m+1}}((\varepsilon,\infty)\times S^1, \R^{2n})$.
\end{proposition}

\begin{proof}
The standard elliptic regularity theory and the fact that $g\in H^{m+3}_{\loc}$ around points in $(0,\infty)\times S^1$  imply that $v$ is of class $H^{m+4}_{\loc}$ around such points as well.  The main task is to verify the asymptotic properties of $v$ as $s\to \infty$.  We choose a  smooth cut off function
$
\gamma:\R\rightarrow [0,1]
$
satisfying $\gamma(s)=0$ for $s\leq 1$, $\gamma(s)=1$ for $s\geq 2$, and $\gamma '\geq 0$, and introduce the shifted functions $\gamma_R:\R\to [0,1]$ defined by  
$
\gamma_R(s):=\gamma(s-R)
$
for $R\geq 0$. 
The operator
$$
h\mapsto  \gamma_R\cdot (J(v)-J(0))h_t,
$$
induces two $R$-dependent  linear operators between the following  spaces
$$
H^{m+3,\delta_m}_c(\R\times S^1,\R^{2n})\rightarrow H^{m+2,\delta_m}(\R\times S^1,\R^{2n})
$$
and
$$
H^{m+4,\delta_{m+1}}_c(\R\times S^1,\R^{2n})\rightarrow H^{m+3,\delta_{m+1}}(\R\times S^1,\R^{2n}), 
$$
where the functions in $H^{m+4,\delta_{m+1}}_c$ have antipodal asymptotic limits as $s\to \pm\infty$. 
We estimate these operators as $R\rightarrow \infty$ as follows. 
\begin{lemma}\label{TORTE}
If $\varepsilon>0$,  there exists $R_\varepsilon>0$ such that for all $R\geq R_\varepsilon$ and for $i=0,1$ the estimate
$$
\norm{ \gamma_R\cdot (J(v)-J(0))h_t}_{H^{m+2+i,\delta_{m+i}}(\R\times S^1,\R^{2n})}\leq \varepsilon \cdot\norm{h}_{H^{m+3+i,\delta_{m+i}}_c(\R\times S^1,\R^{2n})}
$$
holds for  all $h\in  H^{m+3+i,\delta_{m+i}}_c(\R\times S^1,\R^{2n})$.
\end{lemma}
The proof  is elementary,  but somewhat lengthy, and is given in the Appendix \ref{Lemma-4.18}

In view of  Lemma \ref{TORTE}  and Proposition \ref{c-iso}, 
the linear operators
\begin{equation*}
\begin{gathered}
H^{m+3+i,\delta_{m+i}}_c(\R\times S^1, \R^{2n})\rightarrow H^{m+2+i,\delta_{m+i}}(\R\times S^1, \R^{2n})\\
h\mapsto h_s+J(0)h_t +\gamma_R\cdot (J(v)-J(0))h_t
\end{gathered}
\end{equation*}
are topological linear isomorphisms  for $i=0$ and  for $i=1$ if $R$ is  sufficiently large. 

From  $g\in H^{m+3,\delta_{m+1}}(\R^+\times S^1, \R^{2n})$ and $\gamma_{R+1}(s)=0$ for $s\leq R+2$,   we conclude  that $\gamma_{R+1}g \in H^{m+3,\delta_{m+1}}(\R\times S^1, \R^{2n})$. Hence there exists a unique solution $w\in H^{m+4,\delta_{m+1}}_c(\R\times S^1, \R^{2n})$ of the equation
\begin{equation}\label{klap1}
w_s+J(0)w_t +\gamma_R \cdot (J(v)-J(0)) w_t =\gamma_{R+1}g.
\end{equation}
Because $\delta_m<\delta_{m+1}$, the maps $\gamma_{R+1}g$ and $w$ belong to the spaces $H^{m+2,\delta_{m}}(\R\times S^1, \R^{2n})$ and  $H^{m+3,\delta_m}_c(\R\times S^1,\R^{2n})$, respectively.  Consequently, the map  $w$ is also the unique solution  of \eqref{klap1} belonging to $H^{m+3,\delta_m}_c(\R\times S^1, \R^{2n})$.   

We multiply the equation
$$
v_s+J(v)v_t=g
$$
by $\gamma_{R+1}$ and obtain  for the product $\gamma_{R+1}v$ the equation
\begin{equation}\label{klap2}
\begin{split}
(\gamma_{R+1} v)_s& +J(0)(\gamma_{R+1}v)_t +\gamma_{R}\cdot(J(v)-J(0))(\gamma_{R+1}v)_t \\
&=\gamma_{R+1}'v +\gamma_{R+1}g.
\end{split}
\end{equation}
In view  of \eqref{klap1} and \eqref{klap2}, the map $u:=w-\gamma_{R+1}v$,  solves  the equation
\begin{equation}\label{reg1}
u_s+J(0)u_t +\gamma_{R}\cdot (J(v)-J(0))u_t = -\gamma_{R+1}'v.
\end{equation}
By the assumption of Proposition \ref{lem-reg1}, $v\in H^{m+3,\delta_m}(\R^+\times S^1, \R^{2n})$. Since $\gamma_{R+1}'(s)=0$ for $s\leq R+2$ and $s\geq R+3$, the right-hand side of the  equation  \eqref{reg1} belongs  therefore to $H^{m+3,\delta_{m+1}}(\R\times S^1,\R^{2n})$.   Consequently, in view of Lemma \ref{TORTE} and Proposition  \ref{c-iso}, 
there exists a unique map $\ov{u}\in H^{m+4,\delta_{m+1}}_c (\R\times S^1,\R^{2n})$ solving \eqref{reg1}.  Moreover, the map $u$ belongs, by construction, to the space 
$H_c^{m+3,\delta_{m}}(\R\times S^1,\R^{2n})$. 
The difference $u-\ov{u}$ is an element of the space $H^{m+3,\delta_m}_c (\R\times S^1, \R^{2n})$ and belongs to the kernel of
our linear isomorphism 
$H^{m+3,\delta_m}_c(\R\times S^1, \R^{2n})\rightarrow H^{m+2,\delta_m}(\R\times S^1, \R^{2n})$. Hence, 
$$
0=u-\ov{u} = (w-\gamma_{R+1}v) -\ov{u}
$$
from which we conclude that 
$$
\gamma_{R+1}v= w-\ov{u}\in H^{m+4,\delta_{m+1}}_c (\R\times S^1,\R^{2n}).
$$
In view of definition of the function $\gamma_R$ and the fact that $v$ is in $H^{m+4}_{\loc}$, we conclude that $v\in H^{m+4,\delta_{m+1}}(\R^+\times S^1,\R^{2n}).$  The proof of Proposition  \ref{lem-reg1} is complete.
\end{proof}
With Proposition \ref{lem-reg1} the proof of  Theorem \ref{thm-regularity1}  is complete.
\end{proof}

Next   we shall  prove the {\bf  sc-smoothness}  of the Cauchy-Riemann  section $f=\ov{\partial}_J$ of the strong polyfold bundle $p:Z\to W$. For this purpose we have to analyze the section in the local coordinates of the model $P:E\rightarrow X$  which is a strong bundle over the ep-groupoid $X$. We have constructed the object set $X$ as the disjoint union of graphs $\cg$ of good uniformizing families 
$$
(a,v,\eta)\rightarrow \alpha_{(a, v,\eta)}\equiv  (S_a,j(a,v),M_a,D_a,\oplus_a(\exp_u(\eta))
$$
where  $(a,v,\eta)\in {\mathcal O}$ defines the sc-structure on $\cg$.  The bundle $E$  over the $M$-polyfold $\cg$ is the associated graph 
$\wh{\cg}$ of the family 
$$
(a,v,\eta,\xi)\rightarrow \wh{\alpha}_{(a, v, \eta, \xi)}\equiv (S_a,j(a,v),M_a,D_a,\oplus_a(\exp_u(\eta)),
\Xi(a,v,\eta,\xi)).
$$
The section $F$  over the bundle $\wh{\cg}\to \cg$ is defined by 
$$
F((a,v,\eta),\alpha_{(a,v,\eta)})=
((a,v,\eta,\xi),\wh{\alpha}_{(a,v,\eta,\xi)}).
$$
where  $\xi$ is the unique solution of the equations
\begin{equation}\label{cauchy_riemann_eq_1}
\begin{aligned}
\Gamma  [ \oplus_a\exp_u (\eta),  \oplus_au]\circ \wh{\oplus}_a(\xi )\circ \delta (a, v)
&=\ov{\partial}_{J,j(a,v)}(\oplus_a(\exp_u(\eta)))\\
\wh{\ominus}_a(\xi)&=0
\end{aligned}
\end{equation}
so that $(a,v,\eta,\xi)\in K^{\mathcal R}$. In view of its functoriality properties, the section $F$ represents the Cauchy-Riemann section
$\ov{\partial}_J$ of the strong polyfold bundle $p$. In view of the sc-smooth structures on $\cg$ and $\wh{\cg}$, we have to establish 
 the sc-smoothness of the map
$$
(a,v,\eta)\mapsto \xi.
$$
In the following we may assume that the gluing parameter $a$ is sufficiently small. Since our constructions are local in the sense that the values of $\xi$ near a point $z_0\in S$ only depend on the other data evaluated near $z_0$ we can take a smooth partition of unity on $S$ and split the sc-smoothness into an analysis of $\xi$ in the nodal area and the analysis of $\xi$ in the core area. 

Fixing at first a point $z_0\in S$ which is not a nodal point, then for $\abs{a}$ small, the map $\xi$ near $z_0$ depends only on the properties of $\eta$ near $z_0$. In this case the map $(a, v,\eta)\to \xi$ near $z_0$ is level wise a smooth map in the classical sense. This implies that away from the nodal points, $\xi$ depends sc-smoothly on $(a, v, \eta)$. 


 We next analyze  the complex anti-linear section  $\xi$ near the  nodal pair $\{x, y\}\in D$ in local coordinates. The data depend on $(a,v)$ and the properties of $\eta$ along the map $u:S\to Q$ near the nodal pair. 
 {In order to write the equation \eqref{cauchy_riemann_eq_1} for the complex anti-linear section $\xi$ in local coordinates we take  on $S$ the holomorphic coordinates $\sigma^+:\R^+\times S^1\to D_x$ and $\sigma^-:\R^-\times S^1\to D_y$  belonging to the small disk structure  and satisfying  $\sigma^+(s, t)\to x$ as $s\to \infty$ and $\sigma^-(s', t')\to y$ as $s'\to -\infty$. Moreover, we take the smooth chart $\psi:U\subset Q\to \R^{2n}$ around the point $u(x)=u(y)\in Q$ satisfying $\psi (u(x))=\psi (u(y))=0$. 
Then the map $u:S\to Q$ near  the nodal pair  $\{x, y\}$ is represented, in the local coordinates,  by the pair $(v^+,v^-)$ of  smooth maps defined as 
$$v^\pm (s, t)= \psi\circ u \circ \sigma^\pm(s,t):\R^\pm \times S^1\to \R^{2n}.$$
The vector field $\eta$ along $u$ is represented by the pair $(h^+, h^-)$ of vector fields along $v^\pm$ defined by 
$$h^\pm(s,t) = T\psi(u \circ\sigma^\pm(s,t))\circ \eta\circ\sigma^\pm(s,t).$$
We shall abbreviate the glued maps, respectively vector fields,  by 
 $$
 v_a=\oplus_a (v^+,v^-)\quad \text{and}\qquad h_a=\wh{\oplus }_a (h^+,h^-).
 $$ 
According to Section \ref{section-implant} the glued complex anti-linear map $\wh{\oplus}_a(\xi )$ is, in our local coordinates defined by 
$$T\psi (\oplus_a(u))\biggl(\wh{\oplus}_a(\xi) \cdot \frac{\partial}{\partial s}\biggr)=\wh{\oplus}_a(\xi^+, \xi^-)$$
where the pair $(\xi^+,\xi^-):(\R^+\times S^1)\times ( \R^-\times S^1)\to \R^{2n}$ is defined by 
\begin{align*}
\xi^+:=T\psi (u\circ \sigma^+)\cdot \xi (\sigma^+)\cdot \frac{\partial \sigma^+}{\partial s^{\phantom{+}}}\\
\xi^-:=T\psi (u\circ \sigma^-)\cdot \xi (\sigma^-)\cdot \frac{\partial \sigma^-}{\partial s^{\phantom{-}}}
\end{align*}
on the cylinders $\R^\pm\times S^1$.  For the following we abbreviate the vector field 
$$
\wh{\xi}=(\xi^+, \xi^-):(\R^+\times S^1)\coprod ( \R^-\times S^1)\to \R^{2n}.$$}

{We recall that the complex structure $j$ on $D_x\cup D_y$ does, by construction,  not  depend on the parameters $v$ and  $\delta (a, v)=1$. The polar coordinates are holomorphic and hence satisfy  
$$T\sigma^\pm\circ i=j\circ T\sigma^\pm.$$
For the exponential map with respect to the  Euclidean metric in $\R^{2n}$ we know from Proposition \ref{exp-formula1} that 
$$\oplus_a\exp_v(h)=\exp_{v_a}(h_a)=v_a+h_a.$$
Now recalling that the section $\ov{\partial }_{J, j}$ is defined by 
$$
\ov{\partial }_{J, j}(u)=\frac{1}{2}\bigl[ Tu+J(u)\circ Tu\circ j\bigr]
$$
we apply  the  two complex anti-linear maps in the equation \eqref{cauchy_riemann_eq_1} to the vector $\frac{\partial}{\partial s}$ and finally obtain the desired local equations 
\begin{equation}\label{gamma1}
\begin{aligned}
\wh{\Gamma}(v_a+h_a, v_a)\circ \wh{\oplus}_a(\wh{\xi})&=\frac{1}{2}\bigl[ \partial_s (v_a+h_a)+\wh{J}(v_a+h_a)\partial_t (v_a+h_a)\bigr]\\
\wh{\ominus}_a(\wh{\xi})&=0
\end{aligned}
\end{equation}
for the complex anti-linear section $\xi$, now represented by the pair of vector  fields $\wh{\xi}: (\R^+\times S^1)\coprod (\R^-\times S^1)\to \R^{2n}$. 
Here $\wh{J}$ is the smooth almost complex structure on $\R^{2n}$ defined by $\wh{J}(y)=T\psi (\psi^{-1}(y))\circ J(\psi^{-1}(y))\circ (T\psi (\psi^{-1}(y)))^{-1}$ at $y\in \R^{2n}$. 
In addition,  $\wh{\Gamma}:\R^{2n}\times \R^{2n}\to {\mathcal L}(\R^{2n},\R^{2n})$ is the local representation of the map $\Gamma$ arising from the parallel transport associated with  a connection which preserves the almost complex structure,  and hence,  for every $(p, q)$, the linear map $\Gamma (p, q)$ is invertible. Therefore, the map $\wh{\Gamma}$ is smooth and the matrices  $\wh{\Gamma}(y, y')$ are  invertible for every $(y, y')$.
 }

{By assumption, the map $u:S\to Q$ is smooth and satisfies $u(x)=u(y)$. Hence the pair $(v^+, v^-)$ of maps are smooth and have  vanishing asymptotic constants as $s\to \pm \infty$ and belong to the sc-Hilbert space 
$$H^{3,\delta_0}({\mathbb R}^+\times S^1,{\mathbb R}^{2n})\oplus H^{3,\delta_0}({\mathbb R}^-\times S^1,{\mathbb R}^{2n}). $$ 
The pair of vector fields $(h^+, h^-)$ along the curve $(v^+, v^-)$ has matching asymptotic constants and belongs to the sc-Hilbert space $E$ of pairs $(h^+, h^-)$ of the form 
$h^\pm=c+r^\pm$ for some constant $c\in \R^{2n}$, and the pair $(r^+,r^-)$ belongs to the above sc-Hilbert space. }

{In the following we let  $F$  be the sc-Hilbert space 
$$F= H^{2,\delta_0}({\mathbb R}^+\times S^1,{\mathbb R}^{2n})\oplus H^{2,\delta_0}({\mathbb R}^-\times S^1,{\mathbb R}^{2n}).$$
}


We introduce the smooth maps $A, B:\R^{2n}\oplus \R^{2n}\to \call (\R^{2n}, \R^{2n})$ by 
$$A(p, q)=\frac{1}{2}\wh{\Gamma}(p, q)^{-1}\qquad \text{and}\qquad B(p, q)=\frac{1}{2}\wh{\Gamma}(p, q)^{-1}\wh{J}(p).$$
Applying the inverse of the  map $\wh{\Gamma}$ to  both sides of the first equation in \eqref{gamma1}, we obtain 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a\bigl(\wh{\xi}\bigr) &= A(v_a+h_a, v_a)\circ\ \partial_s (v_a+h_a)+ B(v_a+h_a, v_a)\partial_t (v_a+h_a)\bigr]\\
\wh{\ominus}_a\bigl(\wh{\xi}\bigr)&=0.
\end{aligned}
\end{equation*}
Abbreviating 
\begin{equation*}
\wh{A}(p, q)=\begin{bmatrix}A(p, q)&0\\
0&\id
\end{bmatrix}
\quad \text{and}\quad 
\wh{B}(p, q)=\begin{bmatrix}B(p, q)&0\\
0&\id
\end{bmatrix},
\end{equation*}
the above equations for $\wh{\xi}$ can be written in matrix form as 
\begin{eqnarray*}
&&\wh{\boxdot}_a\bigl(\wh{\xi}\bigr)\\
&=&\wh{A}(v_a+h_a, v_a)\cdot \begin{bmatrix}
\partial_s (v_a+h_a)\\
0
\end{bmatrix}
+
\wh{B}(v_a+h_a, v_a)\cdot 
\begin{bmatrix}
\partial_t (v_a+h_a)\\
0
\end{bmatrix}\\
&=&\wh{A}(v_a+h_a, v_a)\circ \wh{\boxdot}_a\circ D_s^a(v+h)+\wh{B}(v_a+h_a, v_a)\circ \wh{\boxdot}_a\circ D_t^a(v+h)
\end{eqnarray*}
where  the maps $D_s^a$ and $D_t^a$ are the maps  introduced in Section \ref{preliminaries} .
Consequently, the map $\hb\oplus E\to F$, $(a, h)\mapsto  \wh{\xi}$ where $\wh{\xi}=(\xi^+, \xi^-)\in F$  is given by 
\begin{equation*}
\wh{\xi}=\wh{\boxdot}_a^{-1}\circ \wh{A}(v_a+h_a, v_a)\circ \wh{\boxdot}_a\circ D_s^a(v+h)+
\wh{\boxdot}_a^{-1}\circ \wh{B}(v_a+h_a, v_a)\circ \wh{\boxdot}_a\circ D_t^a(v+h).
\end{equation*}
 \begin{proposition}\label{nfilled}
 The map $B_\frac{1}{2}\oplus E\mapsto F$, $(a,h)\mapsto   \wh{\xi},$ introduced above,  is sc-smooth. 
 \end{proposition}
 \begin{proof}
 The translation map $E\to E$, $h\mapsto v+h$ is  sc-smooth. Hence, by Proposition \ref{XCX1}  and the chain rule,  the maps
 $\hb\oplus E\rightarrow F$, defined by 
$$
(a,h)\rightarrow D^a_s(v+h)\quad \text{and}\quad (a,h)\rightarrow D^a_t(v+h),
$$
are sc-smooth.  In view of the chain rule, it suffices  to show that  the maps
$\hb\oplus E\oplus F\to F$, defined by 
$$(a, h, g)\mapsto \wh{\boxdot}_a^{-1}\circ \wh{A}(v_a+h_a, v_a)\circ \wh{\boxdot}_a (g)$$
and 
$$(a, h, g)\mapsto \wh{\boxdot}_a^{-1}\circ \wh{B}(v_a+h_a, v_a)\circ \wh{\boxdot}_a (g), $$
are sc-smooth. 
We only consider the first map and derive the formula for $k=\wh{\boxdot}_a^{-1}\circ \wh{A}(v_a+h_a, v_a)\circ \wh{\boxdot}_a(g)$. In view of the definition of the total hat-gluing 
$ \wh{\boxdot}_a$ and of  the matrix $ \wh{A}(v_a+h_a, v_a)$, 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(k)&=A(v_a+h_a)\wh{\oplus}_a (g)\\
\wh{\ominus}_a(k)&=\wh{\ominus}_a(g)
\end{aligned}
\end{equation*}
if $a\neq 0$. If $a=0$, then 
$$k=(k^+, k^-)=(A(v^++h^+, v^+)g^+, A(v^-+h^-, v^-)g^-).$$
Solving  the above  equations for $k=(k^+, k^-)\in F$ we obtain 
\begin{equation*}
k^+(s, t)=\frac{\beta_a}{\gamma_a}\cdot A(v_a+h_a)\cdot \wh{\oplus}_a(g)+\frac{\beta_a-1}{\gamma_a}\cdot \wh{ \ominus}_a(g)
\end{equation*}
for $s\geq 0$ 
and
\begin{equation*}
k^-(s-R, t-\vartheta)=\frac{1-\beta_a}{\gamma_a}\cdot A(v_a+h_a)\cdot \wh{\oplus}_a(g)+\frac{\beta_a}{\gamma_a}\cdot \wh{\ominus}_a(g).
\end{equation*}
for $s\leq R$. 

 {We recall that $\gamma_a=\beta_a^2+(1-\beta_a)^2$ and $\beta_a(s)=\beta (s-R/2)$  with  the  function $\beta$ introduced  
 in Section \ref{gluinganti-sect}.} 
 
  In view of the first statement in  Proposition \ref{XCX2}, the map $\hb\oplus E\oplus F\to H^{2,\delta_0}(\R^+\times S^1, \R^{2n})$, defined by $(a, h, g)\mapsto \frac{\beta_a}{\gamma_a}\cdot A(v_a+h_a)\cdot \wh{\oplus}_a(g)$,  is sc-smooth.  The map $\hb \oplus F\to H^{2,\delta_0}(\R^+\times S^1, \R^{2n})$, defined by 
$$(a,g)\mapsto \frac{\beta_a-1}{\gamma_a}\cdot \wh{\ominus}_a(g)(s, t)=\frac{(\beta_a-1)^2}{\gamma_a}g^+(s, t)+\frac{\beta_a(\beta_a-1)}{\gamma_a}g^-(s-R, t-\vartheta),$$
is sc-smooth in view of {Proposition 2.8}  in \cite{HWZ8.7}. The same arguments  show that  also the map $(a, h, g)\to k^{-}$ is sc-smooth. Consequently, the map 
$\hb\oplus E\oplus F\to F$, $(a, h, g)\mapsto \wh{\boxdot}_a^{-1}\circ \wh{A}(v_a+h_a, v_a)\circ \wh{\boxdot}_a (g)$
is sc-smooth.  This finishes the proof of Proposition \ref{nfilled}.
\end{proof}
 
Summing up,  we have verified that the map ${\bf f}:{\mathcal O} \to \cf$,  $(a, v, \eta)\mapsto {\bf f}(a, v, \eta)$,  is sc-smooth. This finishes the proof of the sc-smoothness and the regularization property of the Cauchy-Riemann section  section  $\ov{\partial}_J$  of the strong polyfold bundle $p:W\to Z$. 
The proof of Proposition \ref{SC-SMOOTHREG} is complete.\hfill $\blacksquare$

   
  
\section{The Filled Section, Proof of Proposition \ref{C0-CONT}}\label{section4.4}
Using the arguments  of Section \ref{sec5.2}, we first verify that (locally) the filled version ${\bf f}:O \to \cf$, $(a, v,\eta)\mapsto \xi={\bf f}(a, v, \eta)$ is sc-smooth. 
We recall  from \eqref{DEFR} that the complex anti-linear filled section $\xi$  is defined as the unique solution of the two equations
\begin{equation}\label{eq35}
\begin{aligned}
\Gamma (\oplus_a\exp_u (\eta), \oplus_a( u))\circ \wh{\oplus}_a(\xi)\circ \delta (a, v)&=\ov{\partial}_{J, j(a, v)}(\oplus_a \exp_u (\eta))\\
\wh{\ominus}_a \bigl(\xi)\cdot \frac{\partial}{\partial s} &=\ov{\partial}_{0}(\ominus_a (\eta )).\\
\end{aligned}
\end{equation}
 \begin{proposition}\label{locfilled}
 The map ${\bf f}:O \to \cf$, $(a, v, \eta)\mapsto \xi={\bf f}(a, v, \eta)$,  defined by  the two equations \eqref{eq35},  is sc-smooth.
 \end{proposition}
  \begin{proof}
  {Away from the nodal points,  the proof of the sc-smoothness of the map ${\bf f}$ is identical with  the proof of the sc-smoothness in Proposition \ref{SC-SMOOTHREG}.}
   {Near the nodes we go into the local coordinates as in Section \ref{sec5.2} in which the equation \eqref{eq35} becomes 
    \begin{equation}\label{pom}
  \begin{aligned}
  \wh{\Gamma}(v_a+h_a,v_a)\wh{\oplus}_a(\wh{\xi})& =\frac{1}{2}\bigl[\partial_s (v_a+h_a) +\wh{J}(v_a+h_a)\partial_t (v_a+h_a)\bigr]\\
  \wh{\ominus}_a\bigl(\wh{\xi})&=\ov{\partial}_{0}(\ominus_a(h)).
  \end{aligned}
  \end{equation}
  Here the vector field $\wh{\xi}$ represents locally the filled complex anti-linear section $\xi$. Moreover, $v_a=\oplus_a(v^+, v^-)$ and $h_a=\wh{\oplus}_a(h^+, h^-)$.  The operator 
 $ \ov{\partial}_{0}$ is defined by 
 $$\ov{\partial}_0=\partial_s+\wh{J}(0)\partial_t.$$
Using the decomposition $F=(\ker  \wh{\oplus}_a)\oplus  (\ker  \wh{\ominus}_a)$, we split $\wh{\xi}=\xi_1+\xi_2$ where   $\xi_1\in \ker  \wh{\ominus}_a$ and $\xi_2\in \ker  \wh{\oplus}_a$. Then  the  vector field  $\xi_1$ solves the equations
\begin{equation}\label{pom1}
  \begin{aligned}
 \wh{\Gamma}(v_a+h_a,v_a)\wh{\oplus}_a(\xi_1)& =\frac{1}{2}\bigl[\partial_s (v_a+h_a) +\wh{J}(v_a+h_a)\partial_t (v_a+h_a)\bigr]\\
  \wh{\ominus}_a(\xi_1)&=0.
  \end{aligned}
  \end{equation}
 These are the same equations as studied before, hence the map 
 $\hb\oplus E\to F$, defined by $(a, h)\mapsto \xi_1$ is sc-smooth in view of Proposition \ref{nfilled}.  The  vector field  $\xi_2$ solves the following equations
 \begin{equation}
 \begin{aligned}
\wh{\oplus}_a(\xi_2)& =0\\
\wh{\ominus}_a(\xi_2)&=\ov{\partial}_{0}(\ominus_a(h)).
\end{aligned}
\end{equation}
}
Solving for $\xi_2=(\xi^+, \xi^-)$ %
{one finds
\begin{align*}
(\xi_2)^+(s, t)&=\frac{\beta_a-1}{\gamma_a}\ov{\partial}_0(h_a)\\
(\xi_2)^-(s-R,t-\vartheta)&=\frac{\beta_a}{\gamma_a}\ov{\partial}_0(h_a).
\end{align*}
Using the computations  in Appendix \ref{XCX10}, one obtains the formula 
\begin{equation*}
\xi_2=C_s^a(h)+\wh{J}(0)C_t^a(h).
\end{equation*}
By Proposition \ref{XCX1} the maps $C_s^a$ and $C_t^a$ are sc-smooth, so that  the map $(a, h)\mapsto \xi_2$ is sc-smooth and the proof of Proposition \ref{locfilled} is complete. }
 \end{proof}
 
 \begin{proposition}\label{prop4.16}
 The map ${\bf f}:O\to \cf$  defined by \eqref{eq35} is a filled version of the Cauchy-Riemann section $F=\ov{\partial}_{J}$ in the ep-groupoid representation.
 \end{proposition} 
 \begin{proof}
 We already know that ${\bf f}$ is sc-smooth and it remains to verify the three properties of a filling in Definition \ref{filled-def}. If $(a, v, \eta)\in \co$, then $\ominus_a(\eta)=0$ and hence $\wh{\ominus}_a(\xi)=0$ so that ${\bf f}(a, v, \eta)=F(a, v,\eta)$. In order to verify the second property of a  filler we assume that $\wh{\ominus}_a{\bf }(\xi)=0$. It follows from \eqref{eq35} that $\ov{\partial}_0(\ominus_a (\eta))=0$ and hence $\ominus_a(\eta)=0$ in view of Proposition \ref{c-iso}, so that indeed $(a, v,\eta)\in \co$.
 
 In order to verify the third property of a filler we abbreviate the points in $O$ by $y=(a, v, \eta)$ and let $y_0=(0,0, 0)$. At the point $y_0$, the derivative of the retraction $r$ is the identity map and consequently,  $\ker Dr(y_0)=\{0\}$. Since $\rho(y_0)=\wh{\pi}_0=\id$, we have $\ker \rho (y_0)=\{0\}$. Therefore, the linearization of the map $y\mapsto \bigl[ \id -\rho (r(y))\bigr]{\bf f}(y)$ at the point $y_0$, restricted to $\ker Dr(y_0)$, defines trivially the  isomorphims $\{0\}=\ker Dr(y_0)\to \ker \rho (y_0)=\{0\}$. The proof of Proposition \ref{prop4.16} is complete.
 \end{proof}
 
 In order to complete the proof of Proposition \ref{C0-CONT}, we define the $\ssc^+$-section ${\bf s}$ by its principal part ${\bf s}(a, v, \eta)={\bf f}(0,0, 0)$ so that the section ${\bf h}={\bf f}-{\bf s}$ satisfies ${\bf h}(0,0,0)=0$. We shall now construct a strong bundle isomorphism $\Phi$ having the property that  the push-forward section $\Phi_* ({\bf h})$ is an $\ssc^0$-contraction germ. The difficulty encountered comes from the fact that  although the map $(a, v, \eta)\mapsto {\bf f}(a, v, \eta)$ is sc-smooth and its linearizations $D{\bf f}(a, v, \eta)$ are bounded linear maps, the dependence of these linear operators on the arguments $(a, v,\eta)$ is not continuous in the operator norm. The following proposition will be very helpful.
\begin{proposition}\label{PROPX} 
The filled version $O\to \cf$, $(a, v, \eta)\mapsto {\bf f}(a, v, \eta)$ has the  following properties.
\begin{itemize}
\item[$\bullet$] At every smooth point $(a,v,\eta)$ close to $(0,0,0)$ the linearization 
$$
D{\bf f}(a,v,\eta)\in \call \bigl( (N\oplus E\oplus \ce ), \cf\bigr)
$$
is an sc-Fredholm operator. Their Fredholm indices are all the same, say equal to $d$.  
\item[$\bullet$]  For every level $m$  fixed and small  $(a,v)$, the map 
$$\eta\mapsto {\bf f}(a,v,\eta),\qquad \ce_m\to \cf_m$$ 
is of class $C^1$ in the  Fr\'echet sense.
\item[$\bullet$]  If ${\mathcal K}$ is a finite-dimensional sc-complemented linear subspace of $\ce$,  the following holds  true. 
We consider a sequence $(a_j,v_j,k_j)\in O$ in which $k_j\in {\mathcal K}$  converges  in $\ce_m$ to some point $(a_0,v_0,k_0)\in O$. If  the sequence  $(h_j)\subset \ce_m$ is bounded on level $m$  and satisfies 
$$D_3{\bf f}(a_j,v_j,k_j)\cdot h_j=y_j+z_j$$
where $y_j\in \cf_m$ satisfies 
$y_j\rightarrow 0$ in $\cf_m$ and where  $(z_j)\subset \cf_{m+1}$ is a bounded sequence  in $\cf_{m+1},$ then  the sequence $(h_j)$ has a subsequence which converges in $\ce_m$. 
\end{itemize}
\end{proposition}
 We should note that the points in the finite dimensional sc-complemented subspace ${\mathcal K}$ above, are all smooth.
 We postpone the proof of Proposition \ref{PROPX} to the next section and use it next in the proof of Proposition \ref{C0-CONT}.
  
   
We denote by $K\subset \ce$ the kernel of the  sc-Fredholm operator
$$
D_3{\bf f}(0,0,0):\ce\rightarrow \cf. 
$$
{In view of the definition of an sc-Fredholm operator, the finite dimensional kernel $K$ possesses an sc-complement $X$ so that  $\ce=K\oplus X$.}
By $Y=D_3{\bf f}(0,0,0)X$ we denote the range of the  operator and, again by definition of an sc-Fredholm  operator, there is an   
sc-complement $C$ so that $\cf=Y\oplus C$. The projection 
$P:\cf\to \cf$  onto $Y$ along $C$  is an  sc-Fredholm operator whose index is equal to  {$0$}. %
We now consider the family 
$$
(a,v,k)\mapsto P\circ D_3{\bf f}(a,v,k)\vert X
$$
of sc-Fredholm operators from $X$ into $Y$, where $k\in K$.
We emphasize that these linear  bounded operators do not depend as operators 
continuously on the finite dimensional parameter  $(a,v,k)$, which we abbreviate 
by 
$$b\equiv (a, v, k)\in  N\oplus E\oplus K.$$
However, in view of Proposition \ref{locfilled},  the map  
$$
(O\cap (N\oplus E\oplus K))\oplus  \ce \rightarrow  \cf,
$$
defined by 
\begin{equation}\label{map1}
(b, h)\mapsto D_3{\bf f}(b)\cdot h,
\end{equation}
is sc-smooth and raising the regularity index by $1$,  the map \eqref{map1} induces,  {in view of Proposition 2.2 in \cite{HWZ8.7}},  the sc-smooth map 
$$\bigl[ (O\cap (N\oplus E\oplus K))\oplus \ce\bigr]^1 \to \cf^1.$$
Since $K$ is finite dimensional, the left-hand side is equal to 
$$
\bigl(O\cap (N\oplus E\oplus K)\bigr)^1\oplus \ce^1 =\bigl(O\cap (N\oplus E\oplus K)\bigr)\oplus \ce^1 
$$ 
and we conclude that the two maps 
$$
\bigl(O\cap (N\oplus E\oplus K)\bigr)\oplus \ce^i\to \cf^i
$$ 
defined by \eqref{map1} are sc-smooth for $i=0$ and $i=1$. 

We next claim  that the operator $P\circ D_3{\bf f}(b)\vert X_{0}:X_0\rightarrow Y_0$ has a trivial kernel if $b$ is close to $0$. 
Indeed, otherwise  there exist sequences $b_j\to 0$ and $(h_j)\subset X_0\subset \ce_0$  satisfying $\abs{h_j}_{\ce_0}=1$ and 
$P\circ D_3{\bf f}(b_j)h_j=0$. In particular,  $D_3{\bf f}(b_j)h_j = z_j$  is a bounded sequence on every level, and we find by Proposition \ref{PROPX} a converging subsequence $h_j\to h$ in $\ce_0$.
Passing to the limit, $h$ satisfies   $P\circ D_3{\bf f}(0)h=0$. Consequently, $h=0$ in contradiction to  $\abs{h}_{\ce_0}=1$  and hence proving the claim. 

We have found an open neighborhood $\wh{O}$
of $0\in N\oplus E\oplus K$ having the property that for $b\in  \wh{O}$ the sc-Fredholm operator $P\circ D_3{\bf f}(b)\vert X :X\to Y$ is injective.   It is, in addition, an sc-Fredholm operator of index $0$.  To see this, we observe that $D{\bf f}(b)\vert X:X\to \cf$ is the composition of the sc-injection $X\to X\oplus K$ whose Fredholm index is equal to $-\dim K$ and $D{\bf f}(b):\ce \to \cf$ having, in view of Proposition \ref{PROPX}, index $d$. Therefore, the index of the composition is equal to $-\dim K +d$. Using Proposition \ref{PROPX} once more, we obtain for the composition $P\circ D_3{\bf f}(b)\vert X :X\to Y$ the index $\dim C-\dim K+d=-d+d=0$ as claimed. 
We conclude that the Fredholm operators 
$$P\circ D_3{\bf f}(b)\vert X:X\to Y$$
are all sc-isomorphisms if $b$ is close to $0$. 
Moreover,  perhaps replacing $\wh{O}$ by a smaller open  neighborhood of $0$,  we claim that there exists,  for every level $m\geq 0$,  a constant $c_m>0$ such  that
\begin{equation}\label{maps2}
\abs{P\circ D_3{\bf f}(b)h}_{\cf_m}\geq c_m\cdot \abs{h}_{\ce_m}
\end{equation}
for all $h\in X_m$ and for all $b\in \wh{O}$.

In order to prove the estimate \eqref{maps2}, we take an open neighborhood $\wh{O}^\ast$ of $b=0$ having a  compact closure in $\wh{O}$.  Arguing indirectly, we find  a   level $m$ and sequences 
$(h_j)\subset X$  and $(b_j)\subset \wh{O}^\ast$ satisfying $\abs{h_j}_{\ce_m}=1$ and 
 $\abs{P\circ D_3{\bf f}(b_j)h_j}_{\cf_m}\rightarrow 0$.  We may assume, going over to a subsequence that $b_j\to b_0\in \wh{O}^\ast$. We conclude from Proposition \ref{PROPX} the convergence $h_j\to h_0$ in $\ce_m$ of a subsequence, so that 
$
P\circ D_3{\bf f}(b)h_0=0.
$
In view of the injectivity, $h_0=0$, in contradiction to $\abs{h_0}_{\ce_m}=1$ and hence proving the estimates \eqref{maps2}.

In view of our discussion so far, we can now apply the following result from \cite{HWZ8.7},  Proposition 4.8. 
\begin{proposition}\label{WM40}
Assume that  $V$ is an open subset of a finite-dimensional vector space $H$, and $E$ and $F$ are sc-Banach spaces and  consider a family  $v\mapsto L(v)$ of linear operators parametrized by $v\in V$ 
such that  $L(v):E\rightarrow F$ are  sc-isomorphisms having the following properties.
\begin{itemize}\label{property-99}
\item[{\em (1)}] The map $\wh{L}:V\oplus E\rightarrow F$,  defined by 
$$
\wh{L}(v, h):=L(v)h,
$$
is sc-smooth.
\item[{\em (2)}] There exists for every $m$ a constant $C_m$ such that
$$
\abs{L(v)h}_m\geq C_m\cdot \abs{h}_m
$$
for all $v\in V$  and all $h\in E_m$.
\end{itemize}
Let us note that $ L(v)$ is not assumed to be continuously depending on $v$ as an operator.
Since the map $L(v):E\to F$ is an sc-isomorphism, the  equation
$$
L(v)h=k
$$
has  for every pair $(v,k)\in V\oplus F$  a unique solution $h$ denoted by 
$$h=L(v)^{-1}k=:f(v, k),$$
 so that $\wh{L}(v, f(v, k))=k$. Then the 
 map $f:V\oplus F\rightarrow E$ defined above is sc-smooth.
\end{proposition}

From Proposition \ref{WM40} we deduce that the solution operator 
$$
(N\oplus E\oplus K)\oplus Y\to X,\quad (a, v, k, y)\mapsto x, 
$$
defined by $x=\bigl[P\circ D_3{\bf f}(a, v, k)\bigr]^{-1}\cdot y$,  is an sc-smooth map. We shall use this fact in order to define a local strong bundle isomorphism which transforms the section  section ${\bf f}-{\bf s}=:{\bf h}$ into an $\ssc^0$-contraction form. {Here ${\bf s}$ is an $\ssc^+$-section. It is defined as the constant section ${\bf s}(a, v, k)=f(0,0,0)$ for all $(a, v, k)\in N\oplus E\oplus K$ and is an $\ssc^+$-section because ${\bf f}(0, 0, 0)\in {\mathcal F}_\infty$. It then follows that ${\bf h}(0,0, 0)=0$.} 

We first note that 
$B=N\oplus E\oplus K$ is a finite-dimensional sc-subspace and so  isomorphic to $\R^n$ for a suitable $n$ and we may assume that  $B=\R^n$ so that our  sc-space becomes 
$$
N\oplus E\oplus \ce=(N\oplus E\oplus K)\oplus X=B\oplus X=\R^n\oplus X.
$$
Similarly, $\cf =C\oplus Y$ with $Y=P\cf$ where $C$ is a finite dimensional sc- complement  and we may assume $C=\R^N$, so that 
$$\cf=\R^N\oplus Y.$$
We now choose an open neighborhood $O$ of  the origin $(0,0)\in {\mathbb R}^n\oplus X$ having the property that $(b, x)\in O$ implies $b\in \wh{O}^*$, and define the bundle map 
\begin{equation*}
\begin{gathered}
\Phi: O\triangleleft (\R^N\oplus Y)\rightarrow O\triangleleft (\R^N\oplus X)\\
\Phi((b,x),(c,y)) = \bigl( (b,x)\bigl(c, \bigl[ P\circ D_3{\bf f}(b)\bigr]^{-1}y\bigr)\bigr).
\end{gathered}
\end{equation*}
It  is a strong bundle isomorphism in view of Proposition \ref{WM40} and the previous discussions.  Recalling that ${\bf f}={\bf s}+{\bf h}$ for the constant section ${\bf s}(a, v, k)={\bf f}(0,0, 0)$, the principal part of the  push-forward section ${\bf k}=\Phi_\ast {\bf h}$ is given by the following formula, \begin{equation}\label{push1}
{\bf k}(b, x)=\bigl( (\id -P){\bf h}(b, x), \bigl[ P\circ D_2{\bf h}(b, 0)\bigr]^{-1}P{\bf h}(b, x)\bigr).
\end{equation}

The map \eqref{push1} is a germ of a map (near $(0,0)$)
$$\R^n\oplus X\to \R^N\oplus X.$$
If $Q:\R^N\oplus X\to X$ is the sc-projection onto $X$, we consider the map $Q{\bf k}:\R^n\oplus X\to X$, defined by 
$$Q{\bf k}(b, x)= \bigl[ P\circ D_2{\bf h}(b, 0)\bigr]^{-1}P{\bf h}(b, x),$$
and introduce the germ of a map $H:\R^n\oplus X\to X$ as 
$$
H(b, x):=x-Q{\bf k}(b, x).
$$
Then $H(0, 0)=0$,  and we have to prove the following estimate. Given a level $m$ in $X$ and $\varepsilon>0$, then 
\begin{equation}\label{h1}
\abs{H(b, x)-H(b, x')}_{X_m}\leq \varepsilon\cdot \abs{x-x'}_{X_m}
\end{equation}
for all $\abs{b}$, $\abs{x}_{X_m}$ and $\abs{x'}_{X_m}$ small enough. In order to prove this crucial estimate, we make use of the following result, which will be verified in the next section.

\begin{proposition}\label{PROP4.19}
For  the filled version ${\bf f}:O\rightarrow \cf$  defined on the open neighborhood $O$ of  $(0,0,0)\in N\oplus E\oplus {\mathcal E}$ the following estimate  holds.
If the  level $m\geq 0$  and the positive number $\lambda$ are given,  then
$$
\abs{\bigl[ D_3{\bf f}(a,v,0)-D_3{\bf f}(a,v,\eta)\bigr] h}_{\cf_m}\leq \lambda\cdot \abs{h}_{\ce_m}
$$
for all $h\in \ce_m$ and for $(a,v,\eta)\in O$ small enough on level $m$.
\end{proposition}

Abbreviating $b=(a, v, k)$ we deduce from Proposition \ref{PROP4.19} for $x\in X$ small on level $m$ and for $b$ small and for all $h\in X_m$ the estimate 
\begin{equation*}
\begin{split}
&\abs{\bigl[ D_2{\bf f}(b,x)-D_2{\bf f}(b,0)\bigr] h}_{\cf_m}=\abs{D_3{\bf f}(a,v,\eta)h- D_3{\bf f}(a,v,k)h}_{\cf_m}\\
&\leq  \abs{D_3{\bf f}(a,v,\eta)h-D_3{\bf f}(a,v,0)h}_{\cf_m} + \abs{D_3{\bf f}(a,v,0)h-D_3{\bf f}(a,v,k)h}_{\cf_m}\\
&\leq 2\cdot \lambda\cdot \abs{h}_{X_m}.
\end{split}
\end{equation*}
Since ${\bf s}$ is constant, the same estimate holds for the section ${\bf h}$.  Having this estimate we compute,  assuming that all data are small enough, 
\begin{equation*}
\begin{split}
&\abs{ H(b,x)-H(b,x') }_{X_m}\\
&=\abs{ x-x' + Q{\bf k}(b,x')-Q{\bf k}(b,x) }_{X_m}\\
&=\abs{ \bigl[ PD_2{\bf h}(b,0)\bigr] ^{-1} \lbrace PD_2{\bf h}(b,0)(x-x') - \bigl[ P{\bf h}(b,x)-P{\bf h}(b,x')\bigr]\rbrace }_{X_m}\\
&\leq c_m^{-1}\cdot \abs{ PD_2{\bf h}(b,0)(x-x') - \bigl[ P{\bf h}(b,x)-P{\bf h}(b,x')\bigr]  }_{\cf_m}\\
&=c_m^{-1}\cdot \abs{ \int_0^1 \bigl[ PD_2{\bf h}(b,0)- PD_2{\bf h}(b,tx+(1-t)x')\bigr] (x-x')\ dt }_{\cf_m}\\
&\leq  c_m^{-1}\cdot d_m\cdot \int_0^1\abs{\bigl[ D_2{\bf h}(b,0)- D_2{\bf h}(b,tx+(1-t)x')\bigr] (x-x') }_{\cf_m} \ dt\\
&\leq  c_m^{-1}\cdot d_m\cdot \int_0^1 2\lambda \abs{x-x'}_{X_m}\ dt\\ 
&= 2c_m^{-1}\cdot d_m\cdot \lambda\cdot \abs{x-x'}_{X_m}.
\end{split}
\end{equation*}
We have verified the desired estimate \eqref{h1} and so have confirmed the 
$\ssc^0$-contraction germ property of the filled section ${\bf f}$.

To sum up, we have studied the Cauchy-Riemann section $\ov{\partial }_J$ in local coordinates near a smooth point $0$ and have constructed a filled version ${\bf f}$ and an $\ssc^+$-section ${\bf s}$ satisfying ${\bf f}(0)={\bf s}(0)$, and have found a strong bundle isomorphism $\Phi$ such that the push-forward $\Phi_\ast ({\bf f}-{\bf s})$ is a germ belonging to the distinguished  germs $\mathfrak{C}_{basic}$.
This proves that $\ov{\partial }_J$ is a Fredholm  germ at the point $0$.

Apart from the proof of Proposition \ref{PROPX} and Proposition \ref{PROP4.19}, which will be carried out in the next section, the proof of Proposition \ref{C0-CONT} is complete.\\
\mbox{} \hfill $\blacksquare$


We would like to summarize the previous discussion for further references in the following proposition. 

\begin{proposition}
Let $U\subset E$ be an open neighborhood of $0$ in the  sc-Banach space $E$ and  let ${\bf f}:U\rightarrow F$ be an sc-smooth map into the sc-Banach space $F$, which satisfies the following  three conditions. 
\begin{itemize}
\item[{\em (1)}] At every  smooth  point $x\in U$,   the linearisation $D{\bf f}(x):E\rightarrow F$ is an sc-Fredholm operator.  Its Fredholm index
does not depend on $x$.
 \item[{\em (2)}] There is an sc-splitting $E=B\oplus X$ in which $B$ is a finite-dimensional subspace of $E$ containing the kernel  of $D{\bf f}(0)$,  for which the following holds for $b\in B$ small enough. 
 If $(b_j)\subset B$ is a sequence converging to $b\in B$ and if $(\eta_j)\subset X$ a sequence  bounded on level $m$ and satisfying  
 $$D{\bf f}(b_j)\cdot \eta_j=y_j+z_j$$
 where $y_j\to 0$ in $F_m$ and where the sequence $(z_j)$ is bounded in $F_{m+1}$, then the sequence
 of  $(\eta_j)$
possesses a convergent subsequence  in $X_m$.
\item[{\em (3)}]  If  $m\geq 0$ and $\varepsilon>0$ are given,  then 
$$
\abs{\bigl[ D_2{\bf f}(b,0)-D_2{\bf f}(b,x)\bigr] h}_{F_m}\leq \varepsilon\cdot \norm{h}_{E_m}
$$
for all  $|b|$ and $x$ small enough on level $m$.
\end{itemize}
{Define the $\ssc^+$-map ${\bf s}$ as the constant section ${\bf s}(b, x)={\bf f}(0, 0)\in F_\infty$. Then  
under the conditions (1)--(3),  the map ${\bf h}={\bf f}-{\bf s}$ is conjugated near $0$ to an $\ssc^0$-contraction germ.}
\end{proposition}
The proof follows  along the same lines as  above.  The properties (1) and (2) can be used
to define the coordinate change $\Phi$.  The property (3) then allows
to carry out the desired estimate. Let us remark that the conclusion is in fact true for every ${\bf s}$ which satisfies
${\bf s}(0,0)={\bf f}(0,0)$. This follows from one of the results in \cite{HWZ3.5} which is concerned with the perturbation theory.
\begin{remark} We would like to mention that there is a variation of the whole scheme which will be important  for  compactness questions in the context of operations in the SFT.
Namely rather than assuming that $u_0$ is on the infinity level we just assume that it is on the  level zero. In that case we can still define a map ${\bf f}$
$$
{\bf f}:O\rightarrow {\mathcal F},
$$
on  an open neighborhood $O$  of $(0,0,0)$ in $N\oplus E\oplus{\mathcal E}$. But in this case
${\mathcal E}$ is simply  a Banach space. However it still makes sense to distinguish two levels  on ${\mathcal F}$, namely the $0-$ and the $1$-level.
The map ${\bf f}$ is continuous and for fixed $(a,v)$ the map $\eta\rightarrow {\bf f}(a,v,\eta)$ is $C^1$ (even $C^\infty$). We can consider
a bundle $O{\triangleleft}\  {\mathcal F}\rightarrow O$, where the base always has level $0$, but the fiber has two levels. So the bi-levels
$(0,0)$ and $(0,1)$ are well-defined. It makes sense to define continuous $\ssc^+$-sections, namely sections which
map points in $O$ continuously to ${\mathcal F}^1$. We can consider bundle maps quite similarly to the strong bundle maps, but where we only require them
to be continuous and preserving this simple bi-level structure. If we start with an arbitrary strong local bundle we have an underlying structure consisting of  the two bi-levels $(0,0)$ and $(0,1)$. Then it makes sense to  look for  a continuous bundle isomorphism which conjugates ${\bf f}-{\bf s}$, where ${\bf s}$ is 
a continuous $\ssc^+$-section  satisfying  ${\bf f}(0,0,0)={\bf s}(0,0,0)$,  to a map which has the contraction germ property on level $0$ (which is the only level which makes sense).  This  can be used to study compactness questions near elements which are not on the infinity-level,
because the particular contraction type form allows to  control  the  compactness nearby.
\end{remark}

 
\section{Proofs of  Proposition \ref{PROPX} and Proposition \ref{PROP4.19}}
This section is devoted to the proofs of Proposition \ref{PROPX} and Proposition \ref{PROP4.19} concerning the filled version 
$${\bf f}:O\to {\mathcal F},\quad (a, v, \eta)\mapsto {\bf f}(a, v,\eta),$$
where $(a, v, \eta)\in O$ and $O$ is an open neighborhood of $(0,0, 0)$ in $N\oplus E\oplus {\mathcal E}$. The spaces ${\mathcal E}$ and ${\mathcal F}$ are  introduced in Section \ref{c-r-results}. From the formula for the derivative $D_3{\bf f}(a, v, \eta)$ below in \eqref{identity_25}, it is evident that the proofs can be localized and we shall prove the local versions of the propositions and distinguish between the ``classical case'' and the ``nodal case''. The classical case deals with maps defined on parts of $S$ away from the nodal pairs, while the nodal case deals with maps near the nodal points. Then the propositions follow from the local versions by means of a finite partition of unity argument.

We should  recall that, in general, the Fredholm section ${\bf f}$ is merely sc-smooth and not smooth in the classical sense. This is due to the occurrence of a finite dimensional space of  ``bad'' coordinates, which in our case are the coordinates $(a, v)$. If one keeps $(a, v)$ fixed, the map $\eta\mapsto {\bf f}(a, v, \eta)$ is classically smooth on every level. But in general, the  linear operator $D_3{\bf f}(a, v, \eta)$ does not even depend continuously on $(a, v)$ in the operator norm,  and the polyfold Fredholm property is a consequence of a certain uniformity in the parameters $(a, v)$.

We recall that the filled section map $ (a, v, \eta)\mapsto {\bf f}(a, v,\eta)=\xi$ is defined as the unique solution of the equations 
\begin{equation}\label{defined10}
\begin{gathered}
\Gamma(\exp_{u_a}(\oplus_a(\eta)),u_a)\circ\wh{\oplus}_a(\xi)\circ\delta(a,v)= \bar{\partial}_{J,j(a,v)} (\exp_{u_a}(\oplus_a(\eta)))\\
\wh{\ominus}_a(\xi){\cdot \frac{\partial}{\partial s}}=\bar{\partial}_0 (\ominus_a(\eta)).
\end{gathered}
\end{equation}
Abbreviating  $\Theta(q,p):=\Gamma^{-1}(p,q)$ and $\tau(a,v):=\delta(a,v)^{-1}$, the  equations \eqref{defined10} take  the form 
\begin{equation}\label{defined1000}
\begin{gathered}
\wh{\oplus}_a(\xi)=\Theta(u_a,\exp_{u_a}(\oplus_a(\eta)))\circ \bar{\partial}_{J,j(a,v)} (\exp_{u_a}(\oplus_a(\eta)))\circ\tau(a,v)\\
\wh{\ominus}_a(\xi){\cdot \frac{\partial}{\partial s}}=\bar{\partial}_0 (\ominus_a(\eta)).
\end{gathered}
\end{equation}

In order to deal first  with the classical case we consider only variations of $\eta$ belonging to the space 
 ${\mathcal E}^{\#}$ consisting of all vector fields $\eta$ along $u$ satisfying $\eta (z)=0$ for  all $z$ contained in the union 
 $${\bf D}(-1)= \bigcup_{x\in \abs{D}}D_x(-1)$$
 of the concentric subdisks of the small disk structure as introduced in Section \ref{xA}.  The restriction of ${\bf f}$ to the complement $S\setminus {\bf D}(-1)$ does not depend on the gluing 
 parameter $a$. Therefore, the filled section ${\bf f}$ satisfies for $\eta\in {\mathcal E}^{\#}$ the identity
\begin{equation}\label{MMM}
{\bf f}(a,v,\eta)=\Theta(u,\exp_{u}(\eta))\circ \bar{\partial}_{J,j(v)}(\exp_{u}(\eta))\circ \tau(v),
\end{equation}
where $\tau (v)=\delta (v)^{-1}$. Denoting by ${\mathcal E}^{\#\#}$ the space  of vector fields  $\eta\in {\mathcal E}$
satisfying $\eta (z)=0$ for all $z\in \bigcup_{x\in \abs{D}} D_x(-\frac{1}{2})$, we deduce  the following result by means of the mean value theorem.
\begin{P4.19}[{\bf Classical Case}]
We fix a level $m\geq 0$ and $\lambda>0$. Then 
\begin{equation*}
\abs{D_3{\bf f}(a,v,\eta)h-D_3{\bf f}(a,v,0)h}_{{\mathcal F}_m}\leq \lambda\cdot \abs{h}_{{\mathcal E}_m}.
\end{equation*}
for all $h\in  {\mathcal E}^{\#\#}_m$  and for  $(a,v,\eta)\in O_m$  sufficiently close to $(0,0,0)$ and $\eta\in  {\mathcal E}^{\#\#}_m$.
\end{P4.19}


In  order to deal with the classical case of Proposition \ref{PROPX}   we again consider the section  ${\bf f}$ on the complement $S\setminus  {\bf D}(-1)$ where it is defined by the formula  \eqref{MMM}.  We fix a Hermitian connection $\nabla$ for $TQ\rightarrow Q$, where the fibers are equipped with the complex multiplication $J$, see Appendix \ref{connection} for  more details.
Viewing ${\bf f}$ as a section of the trivial bundle $O\triangleleft{\mathcal F}\rightarrow O$ we fix the trivial connection for the latter so that
$\nabla_{(0,0,h)} {\bf f}(a,v,\eta) =D_3{\bf f}(a,v,\eta)h$. Having fixed these connections we obtain various other connections in standard ways, e.g.
for the function spaces of sections associated to $TQ\rightarrow Q$ and certain Hom-bundles, see \cite{El}.  We compute  the covariant derivative with respect to the third variable  at the section $\eta$ in the direction of the section $h$ of the bundle $u^*TQ\to S$ and obtain  from \eqref{MMM} the formula
\begin{equation}\label{identity_25}
\begin{split}
D_3{\bf f}(a,v,\eta)h&=(\nabla_{(T\exp_{u}(\eta)h, 0)}\Theta)[\exp_{u}(\eta), u] \circ \ov{\partial}_{J,j(v)}(\exp_{u}(\eta))\circ \tau(v)\\
&\phantom{=}+\Theta(\exp_{u}(\eta), u) \circ (\nabla_h\ov{\partial}_{J,j(v)})(\exp_{u}(\eta))\circ \tau(v)\\
&=(\nabla_{(T\exp_{u}(\eta)h, 0)}\Theta)[\exp_{u}(\eta), u] \circ \Gamma(\exp_{u}(\eta),u)\circ {\bf f}(a,v,\eta)\\
&\phantom{=}+\Theta(\exp_{u}(\eta), u) \circ (\nabla_h\ov{\partial}_{J,j(v)})(\exp_{u}(\eta))\circ \tau(v).
\end{split}
\end{equation}
{Note that $\Theta$ depends on two variables and we only differentiate with respect to the first one.
This explains the $0$ in $(T\exp_{u}(\eta)h, 0)$ occurring in $(\nabla_{(T\exp_{u}(\eta)h, 0)}\Theta)[\exp_{u}(\eta), u]$}.
We now  assume, as in the statement of  Proposition \ref{PROPX},  that  the sequence $(a_j,v_j,\eta_j)\subset O$ converges  to $(a_0,v_0,\eta_0)\in O$, where $\eta_j$ and $\eta_0$  belong to the  finite-dimensional sc-complemented subspace $K$ of ${\mathcal E}$ so  that $\eta_j\to \eta_0$ in ${\mathcal E}_k$ for every level  $k\geq 0$. In addition, we assume  that  the sequence $(h_j)\subset {\mathcal E}_m$ is bounded  and has the form 
\begin{equation}\label{convergence_0}
D_3{\bf f}(a_j,v_j,\eta_j)h_j=y_j+z_j,
\end{equation}
where 
$y_j\in {\mathcal F}_m$ satisfies $y_j\to  0$ in ${\mathcal F}_m$ and where the sequence $(z_j)\in {\mathcal F}_{m+1}$ is bounded in ${\mathcal F}_{m+1}$.  In view of the formula \eqref{identity_25}  for the derivative $D_3{\bf f}(a,v,\eta)h$, 
\begin{equation}\label{convergence_1}
\begin{split}
D_3&{\bf f}(a_j,v_j,\eta_j)h_j\\
&=(\nabla_{(T\exp_{u}(\eta_j)h_j,0)}\Theta)[ \exp_{u}(\eta_j), u] \circ\Gamma(\exp_{u}(\eta_j),u)\circ {\bf f}(a_j,v_j,\eta_j)\\
&\phantom{=}+\Theta(\exp_{u}(\eta_j),u) \circ (\nabla_{h_j}\ov{\partial}_{J,j(v_j)})(\exp_{u}(\eta_j))\circ \tau(v_j).
\end{split}
\end{equation}
Since $(a_j, v_j)\to (a_0, v_0)$ and $\eta_j\to \eta_0$ on every level of ${\mathcal E}$ and since the map ${\bf f}(a, v, \eta)$ is sc-continuous, we conclude that ${\bf f}(a_j, v_j, \eta_j)\to {\bf f}(a_0, v_0, \eta_0)$ on every level of ${\mathcal F}$.
We recall  that the  space  ${\mathcal E}^{\#}$  is a  closed subspace of ${\mathcal E}$ consisting of all $\eta$ vanishing on  ${\bf D}(-1)$. Similarly, we define 
the space ${\mathcal F}^{\#}$ consisting of all elements $h\in {\mathcal F}$ which vanish on the set ${\bf D}(-1)$.
The sequence of  linear  operators
\begin{gather*}
L_j:{\mathcal E}^{\#}\rightarrow {\mathcal F}^{\#},
\intertext{defined by}
h\mapsto  (\nabla_{(T\exp_{u}(\eta_j)h, u)}\Theta)[\exp_{u}(\eta_j),u] \circ\Gamma(\exp_{u}(\eta_j),u)\circ {\bf f}(a_j,v_j,\eta_j),
\end{gather*}
consists of $\ssc^+$-operators. The sequence  converges on every level,  as operators from 
${\mathcal E}^{\#}$ to  $\bigl( {\mathcal F}^{\#} \bigr)^1$,  to the $\ssc^+$-operator
$$
h\mapsto   (\nabla_{(T\exp_{u}(\eta_0)h,0)}\Theta)[\exp_{u}(\eta_0),u] \circ\Gamma(\exp_{u}(\eta_0),u)\circ {\bf f}(a_0,v_0,\eta_0).
$$
The boundedness of  the sequence $(h_j)$  in ${\mathcal E}_m$ implies  that the sequence $(L_j(h_j))$ is bounded on  the level $m+1$ in ${\mathcal F}^{\#}$. Hence,  introducing  $z^\ast_j=z_j-L_j(h_j)$ and using  \eqref{convergence_0} and \eqref{convergence_1},  we see  that 
\begin{equation*}
\Theta(\exp_{u}(\eta_j), u) \circ (\nabla_{h_j}\ov{\partial}_{J,j(v_j)})(\exp_{u}(\eta_j))\circ \tau(v_j) = y_j + z_j^\ast
\end{equation*}
where $y_j\rightarrow 0$ in $H^{m+3}$ on $S\setminus {\bf D}(-1)$ and  where $z_j^\ast$ is a bounded sequence
in $H^{m+4}$  on  $S\setminus {\bf D}(-1)$.
We write the above identity as
\begin{equation}\label{convergence_2}
(\nabla_{h_j}\ov{\partial}_{J,j(v_j)})(\exp_{u}(\eta_j)) = \Gamma(\exp_{u}(\eta_j),u)(y_j + z_j^\ast)\circ\delta (v_j)
\end{equation}
where $\Gamma(\exp_{u}(\eta_j),u)=\Theta(\exp_{u}(\eta_j),u)^{-1}$ and $\delta (v)=\tau (v)^{-1}$.

Now we focus  on  a neighborhood of the point $z_0$ in $S\setminus {\bf D}(-1)$.
We  fix  an open disk-like  neighborhood ${\mathcal D}$ around $z_0$ whose  boundary is smooth and whose closure does not intersect ${\bf D}(-1)$.   
We may assume that the disk ${\mathcal D}$ is so small that  the images $\exp_{u}(\eta_j)({\mathcal D})$ for $j$ large  are contained in the image of a chart $\psi:U(u(z_0))\subset Q\rightarrow {\mathbb R}^{2n}$ around $u(z_0)$ mapping $u(z_0)$ to $0$.  In abuse of the notation, we denote by $h_j(z)$ the map $T\psi (\exp_{u}(\eta_j)(z))h_j(z)$. Similarly,  by $y_j(z):T_zS\to \R^{2n}$ and $z^*_j:T_zS\to \R^{2n}$  we denote  the maps $T\psi \circ \exp_{u}(\eta_j)(z)\Gamma(\exp_{u}(\eta_j),u)y_j \circ \delta (v_j) (z)$ and $T\psi (\exp_{u}(\eta_j)(z)\Gamma(\exp_{u}(\eta_j),u)z^*_j \circ \delta (v_j) (z)$. 
Then,  in view of the formula \eqref{covariant2_b} in the Appendix \ref{connection} , the equation \eqref{convergence_2}  can be written   in our local coordinates on $Q$   as  
\begin{equation}\label{convergence_2b}
Dh_j (z)+J_j(z)\circ Dh_j(z)\circ j(v_j)+A_j(z)(h_j(z), \cdot )=y_j +z_j^*.
\end{equation}
We choose  a smooth family
$v\mapsto \varphi_v$ of biholomorphic maps $\varphi_v:(D,i)\rightarrow (\ov{\mathcal D},j(v))$ defined on the standard closed disk $D$ and  mapping $0$ to $z_0$. The family $\varphi_v$ is defined for  $v\in V$ close to $0$. 
Taking the composition $e_j=h_j\circ \varphi_{v_j}:D\to \R^{2n}$ and evaluating  both sides of \eqref{convergence_2b}  at the vectors $T\varphi_{v_j}(\partial_s)$,  we obtain
the identity
$$
\partial_s e_j +J_{j}(\varphi_{v_j}) \partial_t e_j +A_j(\varphi_{v_j})(e_j, T\varphi_{v_j}(\partial_s)) = y^{\ast\ast}_j + z^{\ast\ast}_j
$$
in which the sequences $(y_j^{\ast\ast})$ and $(z_j^{\ast\ast})$ have the following properties. The sequence $(y^{\ast\ast}_j)$ converges to $0$ in $H^{m+2}(D)$ and the sequence 
$(z^{\ast\ast}_j)$ is bounded in $H^{m+3}(D)$. 
Abbreviating 
$$\wt{J}_j=J_{j}(\varphi_{v_j}) \quad \text{and}\quad \wt{A}_j=A_j(\varphi_{v_j})(\cdot,  T\varphi_{v_j}(\partial_s)),$$
the above identity takes the form 
$$
\partial_s e_j +\wt{J}_{j} \partial_t e_j +\wt{A}_je_j= y^{\ast\ast}_j + z^{\ast\ast}_j.
$$
The sequence  $(\wt{J}_j)$  is a sequence of smooth maps $D\rightarrow L({\mathbb R}^{2n})$ associating to a point $z\in D$ the  complex multiplication  $\wt{J}_j(z)$ on ${\mathbb R}^{2n}$. The  sequence  converges  in $C^\infty$ to the  smooth map $z\rightarrow \tilde{J}(z)$ where $\wt{J}(z)$ is  a complex multiplication  on ${\mathbb R}^{2n}$. The sequence $(\wt{A}_j)$  is a sequence of smooth maps $A_j:D\rightarrow L({\mathbb R}^{2n})$ which converges to the map $A:D\rightarrow L({\mathbb R}^{2n})$.  Moreover, since the sequence $(h_j)$ is bounded on level $m$,  the sequence $(e_j)$ is bounded in $H^{m+3}(D, \R^{2n})$.
The sequences $(e_j)$, $(y_j^{\ast\ast})$,  and $(z_j^{\ast\ast})$ meet  the  assumptions of the following lemma  proved as Proposition \ref{appx20} in the Appendix.
\begin{lemma}
We assume that  $(e_j)$ is a bounded sequence in $H^{m+3}(D,\R^{2n})$ satisfying 
$$
\partial_s e_j +\wt{J}_{j} \partial_t e_j +\wt{A}_je_j= y^{\ast\ast}_j + z^{\ast\ast}_j
$$
where 
$(y_j^{\ast\ast})$ is a sequence in $H^{m+2}(D,\R^{2n})$ converging to $0$, and  where $(z_j^{\ast\ast})$  is a bounded sequence in $H^{m+3}(D,\R^{2n})$. Then every $e_j$ decomposes as $e_j=e^1_j+e^2_j$ such  that $e^1_j\to 0$ in $H^{m+3}(D)$ and  such  that the sequence $(e^2_j)$ is bounded in $H^{4+m}(D_{\varepsilon})$, for every $\varepsilon\in (0, 1)$.
\end{lemma}
Here $D_{\varepsilon}\subset D$ denotes the  subdisk $D_{\varepsilon}=\{z\in D\vert \, \abs{z}\leq 1-\varepsilon\}$ for $0<\varepsilon<1$.
In view of  the above  considerations and applying  a finite covering argument  we obtain the following result. 
\begin{P4.17}[{\bf Classical Case}]
Let ${\mathcal K}$ be a finite-dimensional sc-complemented linear subspace of ${\mathcal E}$ and let $(a_0,v_0,k_0)\in O$  with $k_0\in {\mathcal K}$. We consider  a sequence ($a_j,v_j,k_j)\in  O$ in which $k_j\in {\mathcal K}$,  converging to $(a_0,v_0,k_0)$,   and a  bounded sequence  $(h_j)\in {\mathcal E}_m$  satisfying 
$$D_3{\bf f}(a_j,v_j,k_j)h_j =y_j +z_j$$
where  $(y_j)\subset {\mathcal F}_m$ converges to $0$ and where the sequence $(z_j)$  is bounded in ${\mathcal F}_{m+1}$. 

Then  there exists a subsequence of  $(h_j)$ having the property that the sequence  $(h_j \vert (S \setminus  {\bf D}({-1/2} ))$ of restrictions converges in ${\mathcal E}_m$. 
\end{P4.17}


Next we shall consider the nodal part of Proposition \ref{PROP4.19}.
\begin{P4.19}[{\bf Nodal Case}]\label{Nodal_case4.19} 
Let  $\{x,y\}\in D$  be a nodal pair and let $m\geq 0$  and $\varepsilon>0$. Then  
$$
\abs{D_3{\bf f}(a,v,\eta)h-D_3{\bf f}(a,v,0)h}_{{\mathcal F}_m}\leq \varepsilon \cdot\abs{h}_{{\mathcal E}_m}
$$
for all $h\in {\mathcal E}_m$ having their support in $D_x\cup D_y$ and for  $(a,v,\eta)\in O_m$  sufficiently close to $(0,0,0)$ on the level $m$.
\end{P4.19}
\begin{proof}
We work in local coordinates near  the nodal pair $\{x, y\}$.  We start with the defining equation \eqref{defined10}
and focus on the subset  $D_x\cup D_y$ of $S$. On this set the complex structure $j$ does not depend on $v$. Hence
\begin{equation}\label{defined100}
\begin{gathered}
\Gamma(\exp_{u_a}(\oplus_a(\eta)),u_a)\circ\wh{\oplus}_a(\xi)= \ov{\partial}_{J,j} (\exp_{u_a}(\oplus_a(\eta)))\\
\wh{\ominus}_a(\xi) \cdot {\frac{\partial}{\partial s}}=\ov{\partial}_0 (\ominus_a(\eta)).
\end{gathered}
\end{equation}


Here $j$ denotes the standard structure on $Z_a$ for the various $a$, i.e. $j=j(a)$. We are going to use the definitions of the gluing
constructions and  pass to local coordinates near the nodal pair $\{x, y\}$.  We take  the holomorphic polar coordinates $\sigma^+:\R^+\times S^1\to D_x$ and $\sigma^-:\R^+\times S^1\to D_y$   {belonging to the small disk structure  and satisfying}  $\sigma^+(s, t)\to x$ and $\sigma^-(s',t')\to y$ as $s\to \infty$ and $s'\to -\infty$. Moreover, we take a chart $\psi:U\subset Q\to \R^{2n}$ around the image of the nodes $u(x)=u(y)\in Q$ satisfying $\psi (u(x))=\psi (u(y))=0$. The map $u:S\to Q$ is represented  on the set $D_x\cup D_y$ by the pair $(u^+, u^-)$  of  smooth maps $u^\pm(s, t)=\psi \circ u\circ \sigma^\pm (s, t):\R^\pm\times S^1\to \R^{2n}$. The vector field $\eta$ along the map $u$ is represented by the pair $h=(h^+, h^-)$ of  vector fields $h^\pm(s, t)=T\psi (u\circ \sigma^\pm (s, t))\circ \eta \circ \sigma^\pm (s, t)$ along the curves $u^\pm$ in $\R^{2n}$. 
The section 
$$(a, v,\eta)\mapsto {\bf f}(a, v, \eta)$$
on $D_x\cup D_y$ is represented in local coordinates  by the pair of vectors  
$$\wh{\xi}=(\xi^+, \xi^-)=({\bf f}^+(a, v, h), {\bf f}^-(a, v,h))$$  defined by 
\begin{equation*}
\begin{aligned}
{\bf f}^+(a, v,h)(s,t)&=T\psi (u\circ \sigma^+(s, t))\circ {\bf f}(a, v,\eta)(\sigma^+ (s, t))\cdot [\partial_s\sigma^+(s, t)]\\
{\bf f}^-(a, v, h)(s',t')&=T\psi (u\circ \sigma^-(s', t'))\circ {\bf f}(a, v,\eta)(\sigma^- (s', t'))\cdot [\partial_s\sigma^-(s', t')]
\end{aligned}
\end{equation*}
for $(s, t)\in \R^+\times S^1$ and $(s',t')\in \R^-\times S^1$.  Abusing the notation we shall write $u=(u^+, u^-)$ and we shall  use the following abbreviations for   the glued curves and  the glued vector fields
$$u_a=\oplus_a(u)=\oplus_a(u^+, u^-)\quad \text{and}\quad h_a=\wh{\oplus}_a(h)=\wh{\oplus}_a(h^+,h^-).$$
{We recall from Proposition \ref{exp-formula1}  the formula  
$$\oplus_a\exp_u(h)=\exp_{u_a}(h_a)=u_a+h_a$$
for  the  exponential map with respect to the Euclidean metric in $\R^{2n}$.}  Hence  the equation 
\eqref{defined100} on $D_x\cup D_y$ becomes 
\begin{equation}\label{nodalB}
\begin{aligned}
\wh{\Gamma}(u_a+h_a,u_a)\circ \wh{\oplus}_a(\wh{\xi})&=\frac{1}{2}\bigl[  \partial_s (u_a+h_a)+ \wh{J}(u_a+h_a)
\partial_t (u_a+h_a)\bigr]\\
 \wh{\ominus}_a(\wh{\xi})& = \bar{\partial}_0 \bigl( \ominus_a(h)\bigr).
 \end{aligned}
 \end{equation}
 We introduce two maps $A, B:\R^{2n}\oplus \R^{2n}\to {\mathcal L}(\R^{2n},\R^{2n})$ by 
 $$A(p, q)=\frac{1}{2}\wh{\Gamma}(p, q)^{-1}\quad \text{and}\quad B(p, q)=\frac{1}{2}\wh{\Gamma}(p, q)^{-1}\wh{J}(p).$$
Applying the inverse of $\wh{\Gamma}$ to both sides of \eqref{nodalB} we obtain 
\begin{equation}\label{nodalBeq2}
\begin{aligned}
\wh{\oplus}_a(\wh{\xi})&=A(u_a+h_a,u_a) \partial_s (u_a+h_a)+B(u_a+h_a,u_a)\partial_t (u_a+h_a)\\
 \wh{\ominus}_a^0(\wh{\xi})& = \bar{\partial}_0 \ominus^0_a(h).
 \end{aligned}
 \end{equation}
We decompose the vector field $\wh{\xi}$  into the sum of two vector fields  
$$\wh{\xi}=(\xi^+,\xi^-)=\xi_1+\xi_2$$
 where  the pair $\xi_1=(\xi^+_1, \xi^-_1)$ satisfies $\wh{\ominus}_a (\xi_1)=0$ and the pair 
$\xi_2=(\xi^+_2,\xi^-_2)$ satisfies $\wh{\oplus}_a(\xi_2)=0$.  In view of\,  $\wh{\oplus}_a(\wh{\xi})=\wh{\oplus}_a(\xi_1)$ and $\wh{\ominus}_a(\xi_1)=0$ and \eqref{nodalBeq2},  the pair $\xi_1$ solves the equations 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi_1)&=A(u_a+h_a,u_a) \partial_s (u_a+h_a)+B(u_a+h_a,u_a)\partial_t (u_a+h_a)\\
\wh{\ominus}_a(\xi_1)& = 0.
 \end{aligned}
 \end{equation*}
Introducing the matrices 
 \begin{equation*}
\wh{A}(p, q)=\begin{bmatrix}A(p, q)&0\\
0&\id
\end{bmatrix}
\quad \text{and}\quad 
\wh{B}(p, q)=\begin{bmatrix}B(p, q)&0\\
0&\id
\end{bmatrix},
\end{equation*}
and recalling the total hat gluing map $\wh{\boxdot}_a=(\wh{\oplus}_a,\wh{\ominus}_a)$ and the maps $D_s^a$, $D^a_s$ from Section \ref{preliminaries}, the above equations can be written as 
\begin{equation*}
\begin{split}
\wh{\boxdot}_a(\xi_1)&=\bigl(A(u_a+h_a,u_a) \partial_s (u_a+h_a), 0\bigr)+\bigl(B(u_a+h_a,u_a) \partial_t (u_a+h_a), 0\bigr)\\
&=\wh{A}(u_a+h_a,u_a)\begin{bmatrix} \partial_s (u_a+h_a)\\0\end{bmatrix}+
\wh{B}(u_a+h_a,u_a)\begin{bmatrix} \partial_t (u_a+h_a)\\0\end{bmatrix}\\
&=\wh{A}(u_a+h_a,u_a)\cdot \wh{\boxdot}_a\circ D^a_s(u+h)+\wh{B}(u_a+h_a,u_a)\cdot \wh{\boxdot}_a\circ D^a_t(u+h).
\end{split}
\end{equation*}
Abbreviating 
$$L(a, v, h):=(\wh{\boxdot}_a)^{-1}\wh{A}(u_a+h_a,u_a)\cdot \wh{\boxdot}_a\quad \text{and}\quad  M(a, v, h):=(\wh{\boxdot}_a)^{-1}\wh{B}(u_a+h_a)\cdot \wh{\boxdot}_a,$$
the solution $\xi_1$ is equal to 
$$\xi_1=L(a, v, h)\circ D^a_s(u+h)+M(a, v, h)\circ D^a_t(u+h).$$
We already know that,  for fixed $(a,v)$,  the map
$$
h\mapsto \xi_1 (a, v, h)
$$
is of class $C^1$. Its derivative with respect to $h$ in the direction $k$ is given by
\begin{equation*}
\begin{split}
D_3\xi_1(a, v,h)k&=\bigl[ \bigl( D_3L(a, v, h)k\bigr)\circ D^a_s(u+h) +L(a, v, h)\circ D^a_s(k)\bigr] \\
&\phantom{=}+ \bigl[ \bigl( D_3M(a, v, h)k\bigr)\circ D^a_t(u+h) +M(a, v, h)\circ D^a_t(k)\bigr]\\
&=I (a, v, h, k)+II (a, v, h, k).
\end{split}
\end{equation*}
We claim that given $\varepsilon>0$,
$$\abs{D_3\xi_1(a, v, h)k-D_3\xi_1(a, v, 0)k}_{F_m}\leq \varepsilon\abs{k}_{E_m}$$
for all $k\in E_m$ and for $h\in E_m$ sufficiently close to $0$.
In order to prove this estimate  we shall show that 
\begin{equation*}
\begin{aligned}
\abs{I (a, v, h, k)-I(a, v, 0, k)}_{F_m}&\leq  \varepsilon\abs{k}_{E_m}\\
\abs{II (a, v, h, k)-II(a, v, 0, k)}_{F_m}&\leq  \varepsilon\abs{k}_{E_m}
\end{aligned}
\end{equation*}
for all $k\in E_m$ if $h\in E_m$ is sufficiently close to $0$.
We only prove the first estimate involving $I(a, v, h, k)$ since the same arguments apply to the term $II (a, v, h, k)$. 
The difference $I (a, v, h, k)-I(a, v, 0, k)$ consists of two summands,
\begin{equation*}
\begin{split}
&I (a, v, h, k)-I(a, v, 0, k)\\
&=\bigl[ \bigl(D_3L(a, v, h)k\bigr)\circ D^a_s(u+h) -\bigl(D_3L(a, v, 0)k\bigr)\circ D^a_s(u)\bigr]\\
&\phantom{=}+\bigl[ L(a, v, h)\circ D^a_s(k)-  L(a, v, 0)\circ D^a_s(k)\bigr]
\end{split}
\end{equation*}
and we estimate each of the terms.

{We take $\delta>0$. It plays the role of $\varepsilon$ in the statement (3) of Proposition \ref{XCX2}. } Then, using Proposition \ref{XCX1} and  statements (2) and (3) of Proposition \ref{XCX2},  the first summand of the difference  $I (a, v, h, k)-I(a, v, 0, k)$ can be estimated as 
\begin{equation}\label{identity_26}
\begin{split}
&\abs{\bigl( D_3L(a, v, h)k\bigr)\circ D^a_s(u+h) -\bigl( D_3L(a, v, 0)k\bigr)\circ D^a_s(u)}_{F_m}\\
&\phantom{==}\leq \abs{\bigl[  \bigl( D_3L(a, v, h) -D_3L(a, v, 0)\bigr) k\bigr] \circ D^a_s(u+h)  }_{F_m}\\
&\phantom{===} +\abs{\bigl( D_3L(a, v, 0)k \bigr )\circ D^a_s(h) }_{F_m}\\
&\phantom{==}\leq C_m \abs{k}_{E_m}\cdot \bigl[ \delta\abs{u}_{E_m}+\delta \abs{h}_{E_m}+\abs{h}_{E_m}\bigr]
\end{split}
\end{equation}
for all $k\in {\mathcal E}_m$ and  $h$ sufficiently small  {with a constant $C_m$ independent of $(a, v)$.   That the estimate of the second term is independent of $a$ follows from the sc-smoothness of the map $(a, v, h, k,\eta)\to [D_3L(a,v,h)k]\cdot \eta$ in  statement (2) of Proposition \ref{XCX2}. }

 The second term  of $I (a, v, h, k)-I(a, v, 0, k)$ is estimated by the Propositions \ref{XCX1} and \ref{XCX2} as
\begin{equation*}
\begin{split}
\abs{\bigl[ L(a, v,h)-L(a, v,0)\bigr]\circ D^a_s(k)}_{F_m}
&\leq \delta \cdot C_m\cdot \abs{k}_{E_m}
\end{split}
\end{equation*}
if $h$ is sufficiently close to $0$ in $E_m$.
Consequently, if $\varepsilon>0$ is given, we can choose $\delta$ sufficiently small  and $h$ sufficiently  close to $0$ in $E_m$ such that 
\begin{equation*}
\abs{I (a, v, h, k)-I(a, v, 0, k)}_{E_m}\leq \varepsilon \abs{k}_{E_m}
\end{equation*}
for all $k\in E_m$. 
The estimate for the term $II$ is  the same.   Together the estimates imply that, given $\varepsilon>0$, then 
\begin{equation}\label{identity_28}
\abs{D_3\xi_1(a, v, h)k-D_3\xi_1(a, v, 0)k}_{F_m}\leq \varepsilon \abs{k}_{E_m}
\end{equation}
for all $k\in E_m$ and for  $(a, v, h)\in O_m$ sufficiently close to $(0, 0, 0)$ on the level $m$.

We next consider the map $h\mapsto \xi_2(a, v, h)$. Recall that $\xi_2$ is a solution of the equations 
\begin{equation}\label{mynodal3}
\begin{aligned}
\wh{\oplus}_a(\xi_2)&=0\\
\wh{\ominus}_a(\xi_2)&= \frac{1}{2}\bigl( \partial_s \ominus_a(h) +J_0\partial_t\ominus_a(h)\bigr).
\end{aligned}
\end{equation}
Linearizing the map $h\mapsto \xi_2(a, v, h)$ at $h$ in the direction of $k$ we find 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(D_3\xi_2(a, v, h)k)&=0\\
\wh{\ominus}_a(D_3\xi_2(a, v, h)k)&= \frac{1}{2}\bigl( \partial_s \ominus_a(k) +J_0\partial_t\ominus_a(k)\bigr).
\end{aligned}
\end{equation*}
{Observing that $D_3\xi_2(a, v, 0)k$ is also a solution of the two equations, we conclude from Theorem \ref{sc-splicing-thm1} that} 
$$
D_3\xi_2(a, v, h)=D_3\xi_2(a, v, 0).$$
In view of \eqref{identity_28} and $D_3{\bf f}(a, v, h)=D_3\xi_1(a, v, h)+D_3\xi_2(a, v, h)$, we finally obtain,  for given $\varepsilon>0$, the estimate
$$
\abs{ D_3{\bf f}(a, v, h)k-D{\bf f}(a, v,0)k}_{F_m}\leq \varepsilon \abs{k}_{E_m}
$$
for all $k\in E_m$ and for $(a, v, h)$ close to $(a, v, 0)$. This proves the desired estimate in 
Proposition \ref{PROP4.19} (Nodal Case).
\end{proof}
Finally, we shall prove the nodal case of Proposition \ref{PROPX}.

\begin{P4.17}[{\bf Nodal Case}]\label{propa_nodal}
Let ${\mathcal K}$ be a finite-dimensional sc-comple\-mented linear subspace in ${\mathcal E}$ and let  $(a_0,v_0,\eta_0)\in O$ in which $\eta_0\in {\mathcal K}$.
Fix the level $m\geq 0$ and consider a sequence $(a_j,v_j,\eta_j)$ in $O$ such that  $\eta_j\in {\mathcal K}$ and $(a_j,v_j,\eta_j)\to (a_0, v_0, \eta_0)$. 
Then the following holds.  If  $(\wh{\eta}_j)$  is a bounded sequence in  ${\mathcal E}_m$ satisfying  
$$D_3{\bf f}(a_j,v_j,\eta_j)\wh{\eta}_j=y_j+z_j,$$
where  $y_j\to 0$ in ${\mathcal F}_m$ and $(z_j)$ is bounded in ${\mathcal F}_{m+1}$,  then  there exists a subsequence of $(\wh{\eta}_j)$
such that   the sequence $\bigl(\wh{\eta}_j\vert {{\bf D}(-\frac{1}{2})   }\bigr)$ of restrictions converges in ${\mathcal E}_m$.
\end{P4.17}
\begin{proof}  It suffices to study the problem near the nodal pairs. We fix the  nodal pair $\{x, y\}\in D$ and work in local coordinates on  $D_x\cup D_y$  where $D_x$ and $D_y$ are disks of the small disk structure.
As in the previous proposition we choose the holomorphic polar coordinates $\sigma^+:\R^+\times S^1\to D_x$ and $\sigma^-:\R^+\times S^1\to D_y$  satisfying $\sigma^+(s, t)\to x$ and $\sigma^-(s',t')\to y$ as $s\to \infty$ and $s'\to -\infty$, and  we take a chart $\psi:U\subset Q\to \R^{2n}$ around the image of the nodes $u(x)=u(y)$ satisfying $\psi (u(x))=\psi (u(y))=0$. The smooth map $u:S\to Q$ is represented  on the set $D_x\cup D_y$ by the pair $(u^+, u^-)$  of  smooth maps $u^\pm(s, t)=\psi \circ u\circ \sigma^\pm (s, t):\R^\pm\times S^1\to \R^{2n}$ and the vector field $\eta$ along the map $u$ is represented by the pair $h=(h^+, h^-)$ of  vector fields $h^\pm(s, t)=T\psi (u\circ \sigma^\pm (s, t))\circ \eta \circ \sigma^\pm (s, t)$  along the maps $u^\pm$. The section 
$$(a, v,\eta)\mapsto {\bf f}(a, v, \eta)$$
on $D_x\cup D_y$ is represented in local coordinates  by the pair of vectors  
$$\wh{{\bf f}}(a, v, h)=({\bf f}^+(a, v, h), {\bf f}^-(a, v,h))$$
 defined by 
\begin{equation*}
\begin{aligned}
{\bf f}^+(a, v,h)(s,t)&=T\psi (u\circ \sigma^+(s, t))\circ {\bf f}(a, v,\eta)(\sigma^+ (s, t))\cdot [\partial_s\sigma^+(s, t)]\\
{\bf f}^-(a, v, h)(s',t')&=T\psi (u\circ \sigma^-(s', t'))\circ {\bf f}(a, v,\eta)(\sigma^- (s', t'))\cdot [\partial_s\sigma^-(s', t')]
\end{aligned}
\end{equation*}
for $(s, t)\in \R^+\times S^1$ and $(s',t')\in \R^-\times S^1$. Since $j$ does not depend on the parameter $v$  on $D_x\cup D_y$, the section ${\bf f}(a, v,\eta)$ and hence the maps ${\bf f}^\pm(a,v,\eta)$ are independent of 
the parameter $v$ on $D_x\cup D_y$. 
Abusing the notation we write $u=(u^+, u^-)$ and 
abbreviating the  glued map and  the glued vector fields by 
$$u_a=\oplus_a(u)=\oplus_a(u^+, u^-)\quad \text{and}\quad h_a=\wh{\oplus}_a(h)=\wh{\oplus}_a(h^+,h^-), $$
and introducing $\xi^\pm= {\bf f}^\pm (a,v, h)$,   the vector  field  $\wh{\xi}=(\xi^+,\xi^-)$   is a solution of the  equations 
\begin{equation}\label{nodalBeq1}
\begin{aligned}
\wh{\oplus}_a(\wh{\xi})&=\Theta(u_a+h_a,u_a)\bigl[  \partial_s (u_a+h_a)+ \wh{J}(u_a+h_a)
\partial_t (u_a+h_a)\bigr]\\
 \wh{\ominus}_a(\wh{\xi})& = \bar{\partial}_0 \bigl( \ominus_a(h)).
 \end{aligned}
 \end{equation}
\noindent By  our assumptions, we  are given a  sequence $(a_j,v_j,\eta_j)$ in $O$ converging to  $(a_0,v_0,\eta_0)$ and such that $\eta_j$ belongs to a finite-dimensional sc-complemented  vector space ${\mathcal K}$ of ${\mathcal E}$. 
In addition, there is a bounded sequence  $(\wh{\eta}_j)$ in ${\mathcal E}_m$  satisfying 
$$
D_3{\bf f}(a_j,v_j,\eta_j)\wh{\eta}_j=y_j+z_j,
$$ 
where 
$y_j\rightarrow 0$ in ${\mathcal F}_m$ and  the sequence $(z_j)$ is bounded in ${\mathcal F}_{m+1}$. 
In  our  local coordinates on $D_x\cup D_y$, the vector fields  $\eta_j$ and $\eta_0$ are represented by pairs of smooth maps  $h_j=(h^+_j, h^-_j)$ and $h_0=(h^+_0,h^-_0)$ belonging to a finite-dimensional sc-complemented space ${\mathcal K}$ of the sc-Hilbert space $F$. We observe that $h_j\to h_0$ in $E_k$ for every level $k\geq 0$. 
The elements  $y_j$ and $z_j$ are in our local coordinates and in abuse of the notation  represented by the pairs ${y}_j=(y^+_j, y^-_j)\in F_{m}$ and 
${z}_j=(z^+_j, z^-_j)\in F_{m+1}.$
Then,  denoting by $k_j\in E_m$ the  local representatives of $\wh{\eta}_j$  on $D_x\cup D_y$,  we have 
\begin{equation}\label{bubble}
D_3\wh{{\bf f} }(a_j,v_j,h_j)k_j=y_j+z_j.
\end{equation}
By assumption,  the sequence $(k_j)$ is  bounded in $E_m$, the sequence $(y_j)$ converges to  $0$ in $F_m$  and $(z_j)$ is bounded in $F_{m+1}$.

\noindent We linearize  the equations \eqref{nodalBeq1}  with respect to the variable  $h$ and obtain
\begin{equation}\label{identity1}
\begin{split}
&\wh{\oplus}_{a_j} (D_3\wh{{\bf f}}(a_j, v_j, h_j)k_j)\\
&=  \bigl[ D_1\Theta(u_{a_j}+h_{a_j},u_{a_j}) k_{a_j}\bigr]\cdot
\bigl[  \partial_s  (u_{a_j}+h_{a_j}) +\wh{J}(u_{a_j}+h_{a_j}) \partial_t  (u_{a_j}+h_{a_j} )\bigr]\\
&\phantom{=} + \Theta(u_{a_j}+h_{a_j},u_{a_j})\cdot\bigl[ D\wh{J}(u_{a_j}+h_{a_j})\cdot k_{a_j}\bigr]\cdot  \partial_t (u_{a_j}+h_{a_j})\bigr]\\
&\phantom{=} + \Theta(u_{a_j}+h_{a_j},u_{a_j})\cdot
\bigl[  \partial_s  k_{a_j}+\wh{J}(u_{a_j}+h_{a_j}) \partial_t  k_{a_j}\bigr]\\
\end{split}
\end{equation}
and
\begin{equation}\label{identity1_2}
\wh{\ominus}_{a_j}\bigl( D_3\wh{{\bf f}}(a_j, v_j, h_{a_j}) k_{j}\bigr)=\ov{\partial}_0\bigl(\ominus_{a_j}({k}_{j})\bigr).
\end{equation}
In the equation \eqref{identity1}
we have used the abbreviation $k_{a_j}=\oplus_{a_j}(k_j)$. Abbreviating by $A_j, B_j$ and $C_j$ the three terms on the right-hand side of \eqref{identity1},  we have
\begin{equation}\label{identity1_3}
\wh{\oplus}_{a_j} (D_3\wh{{\bf f}}(a_j, v_j, h_{j}) k_j)=A_j+B_j+C_j.
\end{equation}
Recalling the identity  \eqref{nodalBeq1},
\begin{equation*}
\wh{\Gamma} (u_{a_j}+h_{a_j}, u_{a_j})\cdot\bigl[\wh{ \oplus}_{a_j}\wh{{\bf f}}(a_j, v_{j}, h_j)\bigr] =\frac{1}{2}\bigl[   \partial_s  (u_{a_j}+h_{a_j}) +\wh{J}(u_{a_j}+h_{a_j}) \partial_t  (u_{a_j}+h_{a_j})\bigr],
\end{equation*}
the term $A_j$ can be written as 
\begin{equation}\label{identity1_4}
A_j= \bigl[ D_1\Theta(u_{a_j}+h_{a_j},u_{a_j}) k_{a_j}\bigr] \cdot \wh{\Gamma}(u_{a_j}+h_{a_j}, u_{a_j})\cdot \bigl[ \wh{ \oplus}_{a_j}{\bf f}(a_j, v_{j}, h_j)\bigr].
 \end{equation}
By our assumption, 
\begin{equation}\label{identity_7}
D_3\wh{{\bf f}}(a_j,v_j,  h_j) k_j=y_j+z_j, 
\end{equation}
where $(y_j)$ is a sequence converging to $0$ in $F_m$ and $(z_j)$ is a bounded sequence in $F_{m+1}$.
We decompose $y_j$ and $z_{j}$ as  
$$y_j=y_{1,j}+ y_{2,j}\quad \text{and}\quad z_j=z_{1,j}+z_{2,j}$$ according to the splitting $ \ker \wh{\ominus}_{a_j}\oplus  \ker\wh{ \oplus}_{a_j}$.
Since $\wh{\oplus}_{a_j}(y_j)=\wh{\oplus}_{a_j}(y_{1,j})$ and 
$\wh{\ominus}_{a_j}(y_{1,j})=0$, we observe, using  Proposition \ref{HAT_HAT} and  the definition of the $\wh{G}^a_m$-norm,  that 
\begin{equation*}
\begin{split}
C_m\abs{y_j }_{F_m}&
\geq \abs{\bigl(  \wh{\oplus}_{a_j}(y_j), \wh{\ominus}_{a_j }( y_j)   \bigr)}_{\wh{G}_m^{a_j} }
\geq \abs{\bigl( \wh{\oplus}_{a_j}(y_j), 0\bigr) }_{\wh{G}_m^{a_j} } \geq \frac{1}{C_m}\abs{y_{1,j}}_{F_m}.
\end{split}
\end{equation*}
We conclude, in particular, that the sequence $(y_{1,j})$ converges to $0$ in $F_{m}$. Since 
$y_{2,j}=y_{j}-y_{1,j}$, also the sequence $(y_{2,j})$ converges to $0$ in $F_m$.
Similar arguments applied to the sequence $(z_{1,j})$ show that the sequences $(z_{1,j})$ and $({z}_{2,j})$ are bounded in $F_{m+1}.$

\noindent Since $\wh{\oplus}_{a_j}(y_{j}+z_j)=\wh{\oplus}_{a_j}(y_{1,j}+z_{1,j} )$ and  $\wh{\ominus}_{a_j}(y_{1,j}+z_{1,j})=0$,  the maps $y_{1,j}+z_{1,j}$ are, in view of  \eqref{identity1}, the  solutions of the equations  
\begin{equation}
\begin{aligned}
\wh{\oplus}_{a_j}(y_{1,j}+z_{1,j})&=A_j+B_j+C_j\\
\wh{\ominus}_{a_j}(y_{1,j}+z_{1,j})&=0.
\end{aligned}
\end{equation}
Using the total hat-gluing map $\wh{\boxdot}_{a_j}=(\wh{\oplus}_{a_j},\wh{ \ominus}_{a_j})$, the above two equation can be written as 
\begin{equation}\label{identity1_5}
\wh{\boxdot}_{a_j}(y_{1,j}+z_{1,j})=\bigl(A_j+B_j+C_j, 0\bigr)
\end{equation}
Similarly, since $\wh{\oplus}_{a_j}(y_{2,j}+z_{2,j} )=0$ and  $\wh{\ominus}_{a_j}(y_{j}+z_j)=\wh{\oplus}_{a_j}(y_{2,j}+z_{2,j} )$, the maps $ y_{2,j}+z_{2,j}$ solve, in view of  \eqref{identity1_2}, the following two equations 
\begin{equation}\label{identity_8}
\begin{aligned}
\wh{\oplus}_{a_j}(y_{2,j}+z_{2,j})&=0\\
\wh{\ominus}_{a_j}(y_{2,j}+z_{2,j})&=\ov{\partial}_0(\ominus_{a_j}(k_j))
\end{aligned}
\end{equation}
which can be written,   using the total hat-gluing map $\wh{\boxdot}_{a_j}$,  as 
\begin{equation}\label{identity1_9}
\wh{\boxdot}_{a_j}(y_{2,j}+z_{2,j})=\bigl(0, \ov{\partial}_0(\ominus_{a_j}(k_j)) \bigr).
\end{equation}

\noindent By Proposition \ref{sc-splicing-thm1} the total hat gluing map $\wh{\boxdot}_{a_j}$ is an sc-isomorphism,  so that 
\eqref{identity1_5} implies 
\begin{equation}\label{identity1_6}
y_{1,j}+z_{1,j} =\bigl(\wh{\boxdot}_{a_j}\bigr)^{-1}(A_j,0)+\bigl(\wh{\boxdot}_{a_j}\bigr)^{-1}(B_j,0)+
\bigl(\wh{\boxdot}_{a_j}\bigr)^{-1}(C_j,0).
\end{equation}
We consider  each of the sequences on the right-hand side separately and start with 
$(\wh{\boxdot}_{a_j}\bigr)^{-1}(A_j,0)$.
Abbreviating 
$$A(u_{a_j}, h_{a_j}, k_{a_j})= \bigl[ D_1\Theta(u_{a_j}+h_{a_j},u_{a_j}) k_{a_j}\bigr] \cdot \wh{\Gamma}(u_{a_j}+h_{a_j}, u_{a_j}),$$
the maps $A_j$ can be written, in view of \eqref{identity1_4}, as 
$$
A_j= A(u_{a_j}, h_{a_j}, k_{a_j})\cdot \bigl[ \wh{ \oplus}_{a_j}{\wh{\bf f}}(a_j, v_{j}, h_j)\bigr].
$$
In view of our assumption, the sequence $(h_j)$ belongs to the finite dimensional sc-complemeted subspace ${\mathcal K}$ of $E$ and converges to $h_0\in {\mathcal K}$. Hence $(h_j)$ converges to $h_0$ in every space $E_k$, $k\geq 0$,  and  in particular, in the space $E_{m+1}$. Consequently, the sequence $\bigl(\wh{{\bf f}}(a_j,v_j, h_j) \bigr)$ converges to $\wh{{\bf f}}(a_0,v_0, h_0)$ in $F_{m+1}$.  We conclude, applying Proposition \ref{XCX2} , that  the sequence $\bigr( (\wh{\boxdot}_{a_j})^{-1}(A_j,0)\bigr) $ is bounded in $F_{m+1}$.

\noindent Next we consider the sequence $\bigr( (\wh{\boxdot}_{a_j})^{-1}(B_j,0)\bigr).$ 
We recall that  $B_j$ is defined by 
$$B_j= \Theta(u_{a_j}+h_{a_j},u_{a_j})\cdot\bigl[ D\wh{J}(u_{a_j}+h_{a_j})\cdot k_{a_j}\bigr]\cdot  \partial_t (u_{a_j}+h_{a_j})\bigr].$$
We rewrite the sequence  $(B_j,0)$ using the map  $B_{\frac{1}{2}}\oplus E\to F$,   introduced in Section \ref{preliminaries},  and defined by $(a, h)\mapsto D^a_t (h)$.  Introducing the matrix 
$$\wh{A}(u_{a_j}+h_{a_j}, k_{a_j})=\begin{bmatrix}\Theta (u_{a_j}+h_{a_j}, u_{a_j})\cdot\bigl[ D\wh{J}(u_{a_j}+h_{a_j})\cdot k_{a_j}\bigr]&0\\0&\id\end{bmatrix},$$
the sequence $(B_j, 0)$ can be written as 
\begin{equation*}
(B_j,0)=\wh{A}(u_{a_j}+h_{a_j}, k_{a_j})\circ \wh{\boxdot}_{a_j}\circ  D_t^{a_j}(u+h_j)
\end{equation*}
so that 
$$(\wh{\boxdot}_{a_j})^{-1}(B_j,0)=(\wh{\boxdot}_{a_j})^{-1}\circ \wh{A}(u_{a_j}+h_{a_j}, k_{a_j})\circ \wh{\boxdot}_{a_j}\circ D_t^{a_j}(u+h_{j}).
$$
By Proposition  \ref{XCX1},  the map $(a, h)\mapsto D^a_t (h)$ from $B_{\frac{1}{2}}\oplus E$ to $F$ is  sc-smooth. 
In view of the convergence $u+h_j\to u+h_0$ in $E_k$ for every level  $k$,  the sequence  $\bigl( D^{a_j}_t(u+h_j)\bigl)$ converges to $D^{a_0}_t(u+h_0)$ in $F_{m+1}$.  Applying Proposition \ref{HAT_HAT}, we conclude that the 
sequence $ (\wh{\boxdot}_{a_j})^{-1}(B_j,0)$ is bounded in $F_{m+1}$.
Summing up, we have shown that the sequences $(\wh{\boxdot}_{a_j})^{-1}(A_j,0)$  and $ (\wh{\boxdot}_{a_j})^{-1}(B_j,0)$  are bounded in $F_{m+1}.$ Thus,  abbreviating 
$$\wh{z}_{1,j}:=z_{1,j}-(\wh{\boxdot}_{a_j})^{-1}(A_j,0)-(\wh{\boxdot}_{a_j})^{-1}(B_j,0)$$
the sequence $\wh{z}_{1,j}$ is bounded in $F_{m+1}$ and,  in view of \eqref{identity1_6},
$$
y_{1,j}+\wh{z}_{1,j} =\bigl(\wh{\boxdot}_{a_j}\bigr)^{-1}(C_j,0).
$$
The above equation can be written as 
\begin{equation}\label{identity_11}
\begin{aligned}
\wh{\oplus}_{a_j}y_{1,j}+\wh{\oplus}_{a_j}\wh{z}_{1,j}&=C_j\\
\wh{\ominus}_{a_j}y_{1,j}+\wh{\ominus}_{a_j}\wh{z}_{1,j}&=0.
\end{aligned}
\end{equation}
We recall the equations \eqref{identity_8},
\begin{equation}\label{identity_12}
\begin{aligned}
\wh{\oplus}_{a_j}y_{2,j}+\wh{\oplus}_{a_j}z_{2,j}&=0\\
\wh{\ominus}_{a_j}y_{2,j}+\wh{\ominus}_{a_j}z_{2,j}&=\ov{\partial}_0(\ominus_{a_j}(k_j)).
\end{aligned}
\end{equation}
Abbreviating $z'_j=\wh{z}_{1,j}+z_{2,j}$ and recalling that $y_j=y_{1,j}+y_{2,j}$, we obtain after adding the corresponding rows  of \eqref{identity_11} and \eqref{identity_12},
\begin{equation}\label{identity_20}
\begin{aligned}
C_j&=\wh{\oplus}_{a_j}y_{j}+\wh{\oplus}_{a_j}z_{j}'\\
\ov{\partial}_0(\ominus_{a_j}(k_j))&=\wh{\ominus}_{a_j}y_{j}+\wh{\ominus}_{a_j}z_{j}'.
\end{aligned}
\end{equation}
Since 
$$C_j=\Theta(u_{a_j}+h_{a_j},u_{a_j})
\cdot
\bigl[  \partial_s  k_{a_j}+\wh{J}(u_{a_j}+h_{a_j}) \partial_t k_{a_j}\bigr]$$
and
$$\Theta(u_{a_j}+h_{a_j},u_{a_j})=\frac{1}{2}\wh{\Gamma} (u_{a_j}+h_{a_j},u_{a_j} )^{-1},$$
the first equation  in \eqref{identity_20} can be written as 
$$\wh{\Gamma} (u_{a_j}+h_{a_j},u_{a_j})\cdot \bigl( \wh{\oplus}_{a_j}y_{j}+\wh{\oplus}_{a_j}z'_{j}\bigr)=\frac{1}{2}\bigl[  \partial_s  k_{a_j}+\wh{J}(u_{a_j}+h_{a_j}) \partial_t  k_{a_j}\bigr].$$
The left-hand side can be written as 
$$\wh{\Gamma} (u_{a_j}+h_{a_j},u_{a_j})\cdot \bigl( \wh{\oplus}_{a_j}y_{j}+\wh{\oplus}_{a_j}z'_{j}\bigr)=\wh{\oplus}_{a_j}\zeta_j+\wh{\oplus}_{a_j}\zeta_j', $$
where the sequence $(\zeta_j)$  converges to $0$ in $F_m$,  and the sequence $(\zeta_j')$ is bounded in $F_{m+1}$. 
Consequently,  the equations \eqref{identity_20} become
\begin{equation*}
\begin{aligned}
\frac{1}{2}\bigl[  \partial_s \oplus_{a_j}( k_j)+\wh{J}(u_{a_j}+h_{a_j}) \partial_t  \oplus_{a_j} (k_j)\bigr]&=
\wh{\oplus}_{a_j}\zeta_j+\wh{\oplus}_{a_j}\zeta'_j\\
\ov{\partial}_0(\ominus_{a_j}(k_j))&=\wh{\ominus}_{a_j}y_{j}+\wh{\ominus}_{a_j}z_{j}.
\end{aligned}
\end{equation*}
Now we can apply Proposition \ref{ELLIPTIC-X} from  Appendix \ref{appx19} to  deduce that if $\chi^+$ and $\chi^-$ are cut-off functions  near the boundary, 
the sequence $((\chi^+ k_j^+,\chi^-k_j^-))$ has a convergent subsequence in 
$E_{m}$. The proof of Proposition \ref{PROPX}(nodal case) is complete.  
\end{proof}

Adding up the classical cases and the nodal cases of the present  section by means of a finite partition of unity on $S$,  {the proof of Proposition \ref{PROP4.19} and  the proof of the last statement in Proposition \ref{PROPX} follow.  }


  {It remains to prove the first two statements  of Proposition \ref{PROPX}.
 If we keep $(a,v)$ fixed,  the classical linearisation with respect to $\eta$ defines, as is well known,  a linear Cauchy-Riemann type
 operator on a domain with cylindrical ends. These operators have been used and studied by A. Floer in his seminal papers, see
 e.g. \cite{Floer1}. The weights are in the spectral gaps and the associated operator is Fredholm on every level
 in the classical sense and the Fredholm indices are independent of the smooth $(a,v,\eta)$.
 These operators are in particular sc-Fredholm. If we take the full sc-linearisation,  the real Fredholm index increases
 by the real dimension of the parameter space containing $(a,v)$.  This proves that the Fredholm index of $D{\bf f}(a,v,\eta)$
 is independent of the choice of $(a,v,\eta)$, where $\eta$ is assumed to be smooth.
  The second statement about the $C^1$-character of the map $\eta \to {\bf f}(a, v,\eta)$ for fixed parameter $(a, v)$ follows from the classical results in \cite{El}. In fact, with $(a,v)$ fixed, we are dealing with a nonlinear differential operator on a fixed domain. The proof of  Proposition \ref{PROP4.19} and Proposition \ref{PROPX}  are complete.}\hfill $\blacksquare$



\endinput



\chapter{Appendices}
In the following we shall provide  the proofs  of the results used
earlier. The Appendices \ref{orientations-abstract} and \ref{orientations}  are devoted to the orientation of sc-Fredholm sections. 

\section{Proof of Theorem 2.56}\label{QWE}
The crucial point of the theorem is the sc-smoothness at the points where $a=0$. Hence 
we assume that the parameters $(a,v)$ are close
to $(0,v_0)$.  Since $\pav$ is a core smooth family of holomorphic embeddings, the implicit function theorem  implies that he preimages of the two boundary circles
of the finite cylinders $Z'_{b(a,v)}(-H)$ under the maps $\pav$ are smoothly varying curves in $Z_a(-h)$ with respect to the natural coordinates on $Z_a$.
Here the left curves vary smoothly for the $(s,t)$-coordinates and the right curves for the $(s',t')$-coordinates.

We find, assuming that $(a,v)$ is close to $(0,v_0)$,  a constant $h_0$ such  that these circles do not intersect $Z_a(-h-h_0)$.  Then we construct  a new family of diffeomorphisms $\psav:Z_a\to Z_{b(a, v)}'(-H)$  which is core-smooth and satisfying 
$$
\psav =\pav\quad \text{on\quad  $Z_a(-h-h_0-1)$}.
$$
In addition, there exists a germ of complex structure $j_{a,v}$, namely the pull-back $\psav^*i$ of the standard complex structure,  agreeing with  the standard complex structure $i$ on $Z_a(-h-h_0-1)$
such that 
$$
\psi_{a,v} : (Z_a,j_{(a,v)})\rightarrow (Z_{b(a,v)}(-H),i)
$$
are biholomorohic maps. 

Finally,  we note that instead of $Z_{b(a,v)}(-H)$ we can take $Z_{b'(a,v)}$
so that both are equipped with the standard complex structure and 
are biholomorphic by the identity map. 
The complex numbers $b(a, v)$ and $b'(a,v)$ has the same angular part and the moduli of $b(a, v)$ and $b'(a, v)$ are related by the formula
$$
\varphi(\abs{b(a,v)})-2H =\varphi(\abs{b'(a,v)}),
$$
where $\varphi$  is  the exponential  gluing profile. In view of Lemma 4.4 and Lemma 4.5 in \cite{HWZ8.7}, smoothness of $b(a, v)$ implies  smoothness of  $b'(a, v)$. Since the modification from $\pav$ to $\psav$ does not change the sc-smoothness properties in view of Theorem \ref{action-diff}, %
 it suffices to study  the map 
$$\Phi\colon \bd\oplus V\oplus E\to E,\quad (a, v, \xi)\mapsto \eta,$$
where $\xi$ is the unique solution %
of the  two equations 
\begin{equation}\label{sy_1a}
\oplus_{a}(\eta)= \oplus'_{b'(a,v)}(\xi)\circ \psav\quad \text{and}\quad \ominus_{a}(\eta)=0.
\end{equation}
By abuse of the notation we use the old notation $\pav$ for $\psav$ and $b(a, v)$ for $b'(a, v)$ so that the above system of equations is as follows 
\begin{equation}\label{sys_1a}
\oplus_{a}(\eta)= \oplus'_{b(a,v)}(\xi)\circ \pav\quad \text{and}\quad \ominus_{a}(\eta)=0.
\end{equation}
If $a=0$, we set  
$
\Phi (0, v, \xi)=(\xi^+\circ \phi^+_{0, v}, \xi^-\circ \phi^-_{0, v}).
$


Decomposing  $\xi^\pm$ as $\xi^\pm=u^\pm +c$,  where $c$ is a common asymptotic constant and 
$u^\pm \in H^{3+m, \delta_m}(\R^\pm \times S^1)$, and   proceeding as in Section 2.4, the component  $\eta^+$  of the solution $\eta$ of the  equation \eqref{sy_1a} is given by
\begin{equation}\label{sol_eq_1}
\begin{split}
\eta^+&= c+\biggl( 1-\dfrac{\bba}{\ga}\biggr)
\cdot \int_{S^1}\oplus'_{b(a, v)}(u) \bigl(\pav (R(a)/2, t)\bigr)\ dt\\
&\phantom{=\,\,  c}+\dfrac{\bba}{\ga} \cdot \bb (\pav) \cdot u^+(\pav)\\
&\phantom{=\,\, c}+ \dfrac{\bba}{\ga} \cdot \bigl(1-\bb (\pav)\bigr) \cdot u^-\bigl(\pav -(R(b,v), \vartheta (b,v)\bigr).\\
\end{split}
\end{equation}
  
There is an analogous  formula for the second components $\eta^-$ of $\eta$ in terms of variables $(s', t')$.  We omit the proof of sc-smoothness of the map $\eta^-$ since it  uses the same arguments as the proof of sc-smoothness   $\eta^+$. The formula \eqref{sol_eq_1} defines the following  four maps: \\[1ex]
\noindent {{\bf M1.}} The map 
$$\bd\oplus V\oplus H^{3,\delta_0}_c(\R \times  S^1)\to \R^n,\quad \xi\mapsto c$$
associating  with the  pair $\xi=(\xi^+, \xi^-)$ its asymptotic constant $c$.\\[0.5ex]
\noindent  {{\bf M2.}}  The map 
\begin{gather*}
\bd\oplus V\oplus H^{3,\delta_0}(\R^+\times  S^1)\oplus H^{3,\delta_0}(\R^-\times S^1) \to H^{3,\delta_0}(\R^+\times S^1),\\
(a, v, u)\mapsto\biggl( 1-\dfrac{\bba}{\ga}\biggr)
\cdot \int_{S^1}\oplus'_{b(a,v)}(u)(\pav (R(a)/2, t)) dt.
\end{gather*}
\noindent {{\bf M3.}} The map 
\begin{gather*}
\bd\oplus V\oplus H^{3,\delta_0}(\R^+\times  S^1)\to H^{3,\delta_0}(\R^+\times S^1),\\
(a, v, u^+)\mapsto \dfrac{\bba}{\ga} \cdot \bb (\pav) \cdot u^+(\pav).\\
\end{gather*}
\noindent  {{\bf M4.}}  The map 
\begin{gather*}
\bd\oplus V\oplus H^{3,\delta_0}(\R^-\times  S^1)\to H^{3,\delta_0}(\R^+\times S^1),\\
(a, v, u^-)\mapsto \dfrac{\bba}{\ga} \cdot \bigl(1-\bb (\pav)\bigr) \cdot u^-\bigl(\pav -(R(b,v), \vartheta (b,v)\bigr).
 \end{gather*}
 
  The map  defined in (M1),   associating  with $\xi$  its asymptotic constant,  does not depend on $(a, v)$ and,  since this map  is an sc-projection,  it is sc-smooth. 
The maps (M2)-(M4) are smooth in the classical sense at every point in which $a\neq 0$.  Hence we study sc-smoothness of these  maps in a neighborhood of the  point  with $(0, v_0)$.

In order to simplify our considerations further,  we recall the conclusions  of Theorem 1.46 from  \cite{HWZ8.7} adapted to our notation.  Given $\Delta>1$, there exists a map
$$
\wt{\phi}\colon \bd\oplus V\to \bigcap_{m\geq 3, 0<\varepsilon<2\pi} {\mathcal D}^{m, \varepsilon},
$$
defined in a neighborhood of $(0, v_0)\in \bd\oplus V$,  with the following properties. For every $m\geq 3$ and every $0<\varepsilon <2\pi$, the map 
$(a, v)\mapsto  \wt{\phi}_{a, v}\in {\mathcal D}^{m, \varepsilon}$  is  smooth and satisfies
\begin{equation}\label{wt_eq_1}
\wt{\phi}_{a,v}(s, t) =\pav (s, t)\quad \text{for $(s, t)\in [0, R(a)/2+\Delta ]\times S^1$.}
\end{equation}
The space $ {\mathcal D}^{m, \varepsilon}$ is   the space of diffeomorphisms $u:\R^+\times S^1\to \R^+\times S^1$ having the form
$u(s, t) = (s, t) +  d + r(s, t) $, where $d=(d', d'')\in \R^+\times S^1$ is a constant and the map $r$ has weak derivatives up to order $m$ which weighted by $e^{\varepsilon s}$ belong to
$L^2(\R^+\times S^1,\R^2).$
In particular,  the  map $\wt{\phi}(a,v)$ has the form  
\begin{equation}\label{wt_eq_2}
\wt{\phi}_{a, v}(s, t)=(s, t)+d(a, v)+r(a, v)(s, t)
\end{equation}
in which the map of constants $\bd\oplus V\to \R^2$, $(a, v)\mapsto d(a, v)$ and,  for every $m\geq 3$ and $0<\varepsilon<2\pi$,  the map $r\colon\bd \oplus V\to H^{m, \varepsilon}(\R^+\times S^1)$, $(a, v)\mapsto r(a, v)$, are smooth.

Fixing $\Delta>1$, we observe that, in view of 
\eqref{wt_eq_1},  we can replace the map $\pav$ by the map $\wt{\phi}_{a, v}$ in the definition of the map in (M2). We can do the same with the maps  in (M3) and (M4)  since $\beta_a(s)=0$ for $s\geq R(a)/2+1$. In the following, instead of writing $\wt{\phi}(a, v)$ we use the old notation $\pav$ and assume that $\pav$ has the form \eqref{wt_eq_2} with the maps $d(a, v)$ and $r(a, v)$ having properties as described above.
 
The crucial result used in the study of smoothness of the maps (M2)-(M4) is the following theorem.

\begin{theorem}\label{thm_m3_1}
Assume that $\phi_{a, v}$ is the family of diffeomorphisms 
$\pav\colon \R^+\times S^1\to \R^+\times S^1$, parametrized by $(a, v)\in \bd\oplus V$, having  the form 
$$\pav(s, t)=(s, t)+d(a, v)+r(a, v)(s, t),$$
where $(a, v)\mapsto d(a, v)\in \R^2$ is smooth  and, for every $m\geq 3$ and $0<\varepsilon<2\pi$, the map 
$r\colon \bd\oplus V\to H^{m,\varepsilon}(\R^+\times S^1)$ 
is smooth. Then the the composition
$\wt{\Phi}\colon \bd\oplus V\oplus H^{3,\delta_0}(\R^+\times S^1)\to  H^{3,\delta_0}(\R^+\times S^1)$,  defined by 
\begin{equation}\label{def_comp}
\wt{\Phi} (a, v,u)=u\circ \pav,
\end{equation}  
is well-defined and $\ssc$-smooth. 
\end{theorem}

Postponing the proof,  we first show that  each of the maps defining $\eta^+$ is sc-smooth. We begin with the map defined in (M3).


\noindent {\bf M3.}\,  Abbreviating  by $L$  the sc-Banach space $H^{3,\delta_0}(\R^+\times S^1)$, %
we   consider the map 
$\Phi_1\colon \bd \oplus V\oplus L\to L$, defined by
\begin{equation}\label{eq_m3_0}
\Phi_1 (a, v, u)=\dfrac{\bba}{\ga}\cdot \bb(\pav) \cdot u(\pav)
\end{equation} if $a\neq 0 $, and $\Phi_1 (0, v, u)=u(\phi_{0, v})$ if $a=0$. 

The map $\Phi_1$ is the   composition of the following maps,
\begin{equation*}
\bd\oplus V\oplus L\xrightarrow{\,\,  A_1\,\,  } \bd\oplus V\oplus L 
 \xrightarrow{\,\, A_2\,\,}\bd\oplus L \xrightarrow{\,\, A_3\,\,}\bd\oplus L \xrightarrow{\,\,  A_4\,\,  }L.
\end{equation*}
The map $A_1\colon \bd\oplus V\oplus L\to \bd\oplus V\oplus \bd\oplus L
$ is given  by 
$$A_1(a, v, h)=(a, v, b(a, v), h)$$
and is clearly smooth. The map 
$A_2\colon \bd\oplus V\oplus \bd\oplus L\to \bd\oplus V\oplus L$, defined by 
$$A_2(a, v,b,  h)\mapsto (a, v,\beta'_b\cdot  h),$$
is sc-smooth by Proposition 2.8 (a) in \cite{HWZ8.7}. The same proposition implies  sc-smoothness of the last map 
$A_4\colon  \bd\oplus L\to L$ given by 
$$A_4(a, h)= \dfrac{\bba}{\ga}\cdot h. $$
The map  $A_3\colon \bd\oplus V\oplus L\to \bd\oplus L$ is defined by 
$$A_3(a, v, h)=(a, \wt{\Phi} (a, v, h)), $$
where $\wt{\Phi}$ has been introduced in Theorem \ref{thm_m3_1}.  
Assuming that Theorem \ref{thm_m3_1} holds true, the map  $A_2$ is sc-smooth and hence, by the chain rule,  the map $\Phi_1$ is also sc smooth. \\[1ex]

\noindent {{\bf M4.}}\, Here we  abbreviate by $L'$  the sc-Banach space $H^{3,\delta_0}(\R\times S^1)$ and by $L^\pm$ the sc-Banach spaces $H^{3,\delta_0}(\R^\pm\times S^1)$.  
We consider  the map $\Phi_2:\bd \oplus V\oplus L^-\to L^+$, defined by
\begin{equation}\label{eq_M3_1}
\Phi_2 (a, v, u)=\dfrac{\bba}{\ga}\cdot \bigr(1-\bb(\pav) \bigr)\cdot u\bigl(\pav -(R(b,v), \vartheta (b,v))\bigr)
\end{equation} if $a\neq 0 $, and $\Phi_2 (0, v, u)=0$ if $a=0$. 
We choose a smooth map $\chi:\R\to [0,1]$ satisfying $\chi (s)=1$ for $s\leq 0$ and $\chi (s)=0$ for $s\geq -1/2$. By multiplying $u\in L^-$ by $\chi$ we may assume that $u$ belongs to $L'$.  Moreover, recalling  that  $\abs{R(a)-R(b(a, v))}\leq \Delta'$ for $(a, v)$ close to $(0, v_0)$ and choosing  a constant  $\Delta''$ satisfying $\Delta'+2<\Delta''$, we have 
$$\dfrac{\bba}{\ga}\cdot \bigl(1-\bb (\pav)\bigr)=\dfrac{\bba}{\ga}\cdot \bigl(1-\bb (\pav )\bigr)\cdot  \bb(\pav -\Delta'')$$
for all $(s, t)\in \R^+\times S^1$. Hence  we may assume that $\Phi_2$ is defined as 
\begin{equation}\label{eq_psi2_1}
\Phi_2(a, v, u)=\dfrac{\bba}{\ga}\cdot \bigl(1-\bb (\pav )\bigr)\cdot  \bb(\pav -\Delta'')\cdot 
 u\bigl(\pav -(R', \vartheta')\bigr)
 \end{equation}
 for all $a\neq 0$, where we have abbreviated $(R', \vartheta')=(R(b(a, v), \vartheta(b(a, v))$.


The map $\Phi_2$, as in the case of the map  $\Phi_1$,  can  be represented as a composition of sc-smooth maps,  
\begin{equation*}
\bd\oplus V\oplus L'\xrightarrow{\,\,  B_1\,\,  } \bd\oplus V\oplus\bd  \oplus L'\xrightarrow{\,\,  B_2\,\,  } \bd\oplus V\oplus L^+ \xrightarrow{\,\, B_3\,\,}\bd\oplus L^+ \xrightarrow{\,\,  B_4\,\,  }\bd\oplus L^+.
\end{equation*}
The map  $B_1$ is the same as the map $A_1$ above except that $L$ is replaced by $L'$, and hence it is sc-smooth. The next map 
$B_2\colon \bd\oplus V\oplus\bd  \oplus L'\to \bd\oplus V\oplus L^+$ is given by 
$$B_2(a, v, h)=(a, v, (1-\beta'_b)\cdot \beta_b'(\cdot -\Delta'')\cdot h(\cdot -(R(b), \vartheta (b)).$$
Its sc-smoothness, observing that the  function  $(1-\beta' )\cdot \beta' (\cdot -\Delta'')$ has a compact support, follows from Proposition 2.8 (b) in \cite{HWZ8.7}.  The map 
$B_3\colon \bd\oplus V\oplus L^+\to \bd\oplus V\oplus L^+$,   given 
by 
$$B_3(a, v, h)=(a, v, \wt{\Phi} (a, v, h)), $$
where $\wt{\Phi}(a, v, h)=h\circ \pav$,  is the same as the map $A_3$ above and  is sc-smooth by Theorem \ref{thm_m3_1}.  The last  map $B_4\colon 
\bd\oplus  L^+\to \oplus  L^+$, defined by 
$$B_4(b, h)=\dfrac{\bba}{\ga}\cdot h, $$ 
is sc-smooth by Proposition 2.8 (a) from \cite{HWZ8.7}. In conclusion,  we have proved that the map $\Phi_2$  is sc-smooth.






\noindent {{\bf M2.}}\,  In this part  $L^\pm$ stands for  the sc-Banach space $H^{3,\delta_0}(\R^\pm \times S^1)$.
We consider the map $\Phi_3\colon \bd \oplus V\oplus L^+\oplus L^-\to \R^n$, defined by
\begin{equation}\label{eq_M3_0}
\Phi_3 (a, v, u)= \biggl(1-\dfrac{\bba}{\ga}\biggr )\int_{S^1}\oplus'_{b(a, v)}(u)(\pav (R(a)/2, t )\ dt
\end{equation} if $a\neq 0 $, and $\Phi_3 (0, v, u)=0$ if $a=0$. .
Recalling that $u=(u^+, u^-)\in L^+\oplus L^-$, the map $\Phi_3$ is, in view of the definition of  the gluing map $\oplus'_b$,  the sum of  two maps,
\begin{equation*}
\begin{gathered}
\Phi_3'\colon \bd \oplus V\oplus L^+\to \R^n,\\
\Phi_3' (a, v, u^+)=\biggl(1-\dfrac{\bba}{\ga}\biggr )\int_{S^1}\bb \bigl(\pav (R/2, t)\bigr)u^+(\pav (R/2, t)\ dt,
\end{gathered}
\end{equation*}
and 
$$
\Phi_3''\colon \bd \oplus V\oplus L^-\to \R^n,
$$
\begin{equation*}
\begin{split}
&\Phi_3'' (a, v, u^-)\\
&\quad =\biggl(1-\dfrac{\bba}{\ga}\biggr ) \int_{S^1}\bigl(1-\beta'_b(\pav (R/2, t)\bigr)u^-\bigl(\pav (R/2, t)-(R', \vartheta')\bigr)\ dt
\end{split}
\end{equation*}
if $a\neq 0$ and $\Phi_3'(0, v, u)=\Phi_3''(0, v, u)=0$ if $a=0$. Here we abbreviated $b=b(a, v)$, $R=R(a)$,  and $(R', \vartheta')=\bigl(R(b(a, v), \vartheta (b(a, v))\bigr)$.

The first map $\Phi_3'$ is a composition of the following two sc-smooth maps,
\begin{equation*}
\bd\oplus V\oplus L^+\xrightarrow{\,\,  C_1\,\,  } \bd\oplus L^+ \xrightarrow{\,\, C_2\,\,}\R^n.
\end{equation*}
The map $C_1\colon \bd\oplus V\oplus L^+\to \bd\oplus L^+$, defined 
by 
$$C_1(a, v, h)=(a, \bb(\pav) h(\pav ) \bigr),$$
is a composition of the sc-smooth maps $A_1$, $A_2$, and $A_3$ defined in (M3), and hence  is sc-smooth.


The second  map  $C_2\colon \bd\oplus L^+\to  \R^n$,   defined by 
$$C_2(a, h)=\biggl(1-\dfrac{\bba}{\ga}\biggr)\cdot [h]_a,$$
is  sc-smooth by Lemma 2.19 and Lemma 2.20 in \cite{HWZ8.7}.  Consequently, the map $\Phi_3'$ is sc-smooth. 

Next we consider the map $\Phi_3''$. This map can be represented as a composition of the following sc-smooth maps,
\begin{equation*}
\bd\oplus V\oplus L^-\xrightarrow{\,\,  D_1\,\,  } \bd\oplus L^+ \xrightarrow{\,\, D_2\,\,}\R^n.
\end{equation*}
The map $D_1\colon \bd\oplus V\oplus L^-\to \bd\oplus L^+$ is defined by 
$$D_1 (a, v, h)=\bigl(a,  \bigl(1-\bb(\pav)\bigr)\cdot \bb (\pav -\Delta'') \cdot h(\pav -(R', \vartheta') \bigr)\bigr)$$
where $(R', \vartheta')=\bigl(R(b(a, v), \vartheta (b(a, v))\bigr)$ and a constant $\Delta''$ is defined in (M4). This map is sc-smooth since it is a composition of the sc-smooth map 
$B_1, B_2$, and $B_3$ introduced  in M4.
The map $D_2$  is the same as the map  $C_2$ above,  and hence it is sc-smooth. 

We have proved that the map $\Phi_3''$ is sc-smooth.   This  together with the sc-smoothness of $\Phi_3'$ shows that map $\Phi_3$ is of class $\ssc^\infty$.  

At this point we have proved, assuming Theorem  \ref{thm_m3_1}, that all the maps defining $\eta^+$ are sc-smooth.
Hence it  remains to prove Theorem  \ref{thm_m3_1}.\\[0.3ex]

\begin{proof}[{\bf Proof of Theorem  \ref{thm_m3_1}}]
Let $L$ be the sc-Banach space $H^{3,\delta_0}(\R^+\times S^1)$ and let $\abs{\cdot}_m=\norm{\cdot}_{H^{3+m, \delta_m}(\R^+\times S^1)}$ for $m\geq 0$. We recall that $\wt{\Phi}\colon  \bd\oplus V\oplus L\to L$ 
is the composition 
$$\wt{\Phi} (a, v, u)=u\circ \pav.$$
In the proof we denote by $C$ a generic constant which depends only on 
the order $m$ of differentiation of the maps involved. 

We begin by showing that the map $\wt{\Phi}$ is well-defined.  We fix  $m\geq 0$ and a point $(a, v, u)\in \bd\oplus V\oplus L_m$. It suffices to show that 
\begin{equation}\label{int_eq_1}
\int_{\R^+\times S^1}\abs{D^\alpha (u(\pav))}^2e^{2\delta_m s}\ dsdt
\end{equation}
are finite for all multi-indices $\abs{\alpha}\leq 3+m$. Denoting by 
$\pav^1$ and $\pav^2$ the components of the diffeomorphisms $\pav$, 
we will be useful to introduce the following notation, 
$${\bf D}^{\mu, \nu}(\pav)={\bf D}^\mu(\pav^1)\cdot {\bf D}^\nu (\pav^2),$$
where 
\begin{align*}
{\bf D}^\mu(\pav^1)&=D^{\mu_1}(\pav^1)\cdot \ldots \cdot D^{\mu_k}(\pav^1),\\
{\bf D}^\nu (\pav^2)&=[D^{\nu_1}(\pav^2)\cdot \ldots \cdot D^{\nu_l}(\pav^2),
\end{align*} 
and $\mu=(\mu_1,\ldots,\mu_k)$ and $\nu=(\nu_1,\ldots,\nu_l)$.
With this notation,  the derivative 
$D^\alpha  (u(\pav))$ is a linear combination of the following expressions,
\begin{equation}\label{int_eq_2}
(D^\gamma u)(\pav)\cdot{\bf D}^{\mu, \nu}(\pav)=
(D^\gamma u)(\pav)\cdot{\bf D}^\mu(\pav^1)\cdot {\bf D}^\nu (\pav^2), 
\end{equation}
where  the multi-indices satisfy  $\abs{\gamma}\leq \abs{\alpha}$, 
$\alpha=\mu_1+\ldots +\mu_k+\nu_1+\ldots +\nu_l$,  and $k+l\leq \abs{\gamma}.$  Moreover, $1\leq \abs{\mu_i}, \abs{\nu_j}$, for $1\leq i\leq k$, $1\leq j\leq l$. 
Accordingly the integral \eqref{int_eq_1} is a linear combination of the terms
\begin{equation}\label{int_eq_1a}
\int_{\R^+\times S^1}
\abs{(D^\gamma u)\cdot {\bf D}^{\mu, \nu}(\pav)}^2e^{2\delta_ms}\ dsdt
\end{equation}
with multi-indices satisfying the conditions listed above.
Since, in view of the properties of the map $r(a, v)$, there exists a constant $C$ such that 
\begin{equation}\label{int_eq_2a}
\abs{D^\beta r(a, v)}\leq C \quad \text{on $\R^+\times S^1$,}
\end{equation} for all $\abs{\beta}\leq 3+m$, the terms \eqref{int_eq_1a} can be estimated,  using the change of variable formula,  as
\begin{equation}\label{change_1}
\begin{split}
&\int_{\R^+\times S^1}
\abs{(D^\gamma u)\cdot {\bf D}^{\mu, \nu}(\pav)}^2e^{2\delta_ms}\ dsdt\\
&\quad \leq 
C\int_{\R^+\times S^1}\abs{(D^\gamma u)(\pav))}^2e^{2\delta_m s}\ dsdt\\
&\quad =C\int_{\R^+\times S^1}\abs{(D^\gamma u)(s, t)}^2\cdot \abs{\det (D\psav)(s, t)}e^{2\delta_m \psav^1s}\ dsdt.
\end{split}
\end{equation}
Here we abbreviated by $\psav$ the inverse of $\pav$ and by $\psav^1$ its first component.  Hence we need  to estimate $\psav^1$ and $\abs{\det D\psav}$ on $\R^+\times S^1$.  We claim that there are constants $c_0$ and $c_1$ such that 
\begin{subequations}\label{properties}
\begin{gather}
\abs{\psav^{1}(s, t)-s}\leq c_0,\label{first}\\
\abs{\text{det}\ (D \psav)(s, t)}\leq c_1\label{second}
\end{gather}
\end{subequations}
for all $(s, t)\in \R^+\times S^1$.
Since $\pav(\psav (s, t))=(s, t)$ and 
\begin{equation}\label{int_eq_3}
\pav(s, t)=(s, t)+d(a, v)+r(a, v)(s, t),
\end{equation}
we obtain
\begin{equation}\label{int_eq_4}
\psav(s, t)=(s, t)-d(a, v)-r(a, v)\bigl(\psav (s, t)).
\end{equation}
So, the first assertion  follows from \eqref{int_eq_4} and $\abs{r(a, v)}\leq C$ on $\R^+\times S^1$. For the second claim we use  the identity $\text{det} (D\psav)=\bigl( \text{det}(D \pav)(\psav)\bigr)^{-1}$.  It is enough to  show that  
$\abs{\text{det}(D \pav)(\psav)}\geq 1/c_1$ on $\R^+\times S^1$. From \eqref{int_eq_3} we get,  
$$(D\pav)(\psav)=\text{id}+Dr(a, v)(\psav),$$
and since 
$\abs{Dr(a, v)(s, t)}\leq ce^{-\delta_ms}$, by  \eqref{first}, 
there exists $s_0>0$ such that $\abs{(D\pav)(\psav)}\geq 1/2$  on  $[s_1,\infty)\times S^1$. Since $\pav$ is a diffeomorphism, $\abs{(D\pav)(\psav)}>0$ on 
$[0,s_0]\times S^1$, finishing the prove of the claim \eqref{second}.

With \eqref{first} and \eqref{second}, the right-hand side of 
\eqref{change_1} is dominated  by 
\begin{equation}\label{int_eq_3a}
C\int_{\R^+\times S^1}\abs{D^\gamma u(s, t)}^2e^{2\delta_m s}\ dsdt.
\end{equation}
Since this holds true for every multi-index $\gamma$ satisfying $
\abs{\gamma}\leq 3+m$, we have proved that 
the integral \eqref{int_eq_1} is finite and that the map $\wt{\Phi}$ is well-defined. Also, the above discussion shows   that  
\begin{equation}\label{int_eq_3ab}
\abs{u\circ \pav}_m\leq C\abs{u}_m
\end{equation}
where the constant $C$ depends on $m$ and the parameter $(a, v)$.


We make the following observation which will be  used in the proof of the next lemma. Given a point $(a_0, v_0)\in \bd\oplus V$, the estimates 
\eqref{int_eq_2a}, \eqref{first}, \eqref{second} as well as  \eqref{int_eq_3ab} still hold true, perhaps with bigger constants,  for all $(a, v)$ close to $(a_0, v_0)$. This follows from the fact that the map $(a, v)\mapsto r(a, v)$ is smooth as a map from $\bd\oplus V\to H^{m',\varepsilon}(\R^+\times S^1)$ for every $m'\geq 3$ and $0<\varepsilon<2\pi$. 

Now we are ready to prove sc-continuity of the map $\wt{\Phi}$.

\begin{lemma}\label{lem_M_3}
The map $\wt{\Phi} $ is sc-continuous.
\end{lemma}

\begin{proof}
We fix level $m\geq 0$,  a point $(a_0, v_0,u_0)\in \bd\oplus V\oplus L_m$,   
and take $\rho>0$. We choose a compactly supported smooth function $h_0\colon \R^+\times S^1\to \R^n$ satisfying $\abs{u_0-h_0}_m<\rho$ and $\supp h_0\subset [0, s_1]\times S^1$. 
Then we  estimate,
\begin{equation}\label{eq_lem_M_3}
\begin{split}
\abs{\wt{\Phi} (a, v, u)-\wt{\Phi}  (a_0, v_0, u_0)}_m&\leq \abs{\wt{\Phi}  (a, v, u)-\wt{\Phi} (a, v, h_0)}_m\\
&\phantom{\leq }+\abs{\wt{\Phi}   (a, v, h_0)-\wt{\Phi}  (a_0, v_0, h_0)}_m\\
&\phantom{\leq }+\abs{\wt{\Phi} (a_0, v_0, h_0)-\wt{\Phi}  (a_0, v_0, u_0)}_m\\
&=I+II+III.
\end{split}
\end{equation}

We consider the term $I$. By \eqref{int_eq_3ab} and recalling that  
$\abs{u_0-h_0}_m<\rho$, we obatin

\begin{equation}\label{eq_I_a}
\begin{split}
I&=\abs{\wt{\Phi} (a, v, u-h_0)}_m\leq C\abs{u-h_0}_{m}\\
&\leq C\abs{u-u_0}_{m}+
C\abs{u_0-h_0}_{m}\\
&\leq C\abs{u-u_0}_{m}+C\rho.
\end{split}
\end{equation}
for $(a, v)$ sufficiently close to $(a_0,  v_0)$ with the constant $C$ depending only on $m$.

Using \eqref{int_eq_3ab} again, we obtain the estimate for the term $III$, 
\begin{equation}\label{int_est_M3_6}
III=\abs{ \wt{\Phi} (a_0, v_0, u-h_0)}_m  \leq C\abs{u_0-h_0}_{m}\leq C\rho.
\end{equation}

It remains to estimate the term $II=\abs{\wt{\Phi}   (a, v, h_0)-\wt{\Phi} (a_0, v_0, h_0)}_m=\abs{h_0(\pav)-h_0(\phi_{a_0, v_0})}_m$. The square of the norm 
$\abs{h_0(\pav)-h_0(\phi_{a_0, v_0}}_m$ is a linear combination of 
the terms 
\begin{equation}\label{int_est_M3_15}
\int_{\R^+\times S^1}\abs{D^\alpha \bigl[h_0(\pav)-h_0(\phi_{a_0, v_0})\bigr]}^2e^{2\delta_m s}\ ds dt
\end{equation}
where the sum is taken over all multi-indices $\alpha$ satisfying $\abs{\alpha}\leq 3+m$.  Recalling the notation introduced in the proof that $\wt{\Phi}$ is well-defined, 
the derivatives  $D^\alpha \bigl[h_0(\pav)-h_0(\phi_{a_0, v_0})\bigr]$ can be written as a  linear combinations of the expressions of the form
\begin{equation}\label{int_est_M3_8}
\begin{split}
(D^\gamma h_0)(\pav)\cdot &\bigl[ {\bf D}^{\mu, \nu}(\pav)-{\bf D}^{\mu, \nu}(\phi_{a_0,v_0})\bigr]\\
&\phantom{=}+\bigl[(D^\gamma h_0)(\pav)-(D^\gamma h_0)(\phi_{a_0, v_0})\bigr]\cdot {\bf D}^{\mu, \nu}(\phi_{a_0,v_0})\\
&=II_1+II_2
\end{split}
\end{equation}
where $\abs{\gamma}\leq \abs{\alpha}\leq 3+m$, $\alpha=(\mu_1+\ldots +\mu_k)+(\nu_1+\ldots +\nu_l)$, and $k+l\leq \abs{\gamma}.$
We consider  the term $II_1$. The factors ${\bf D}^{\mu, \nu}(\pav)-{\bf D}^{\mu, \nu}(\phi_{a_0,v_0})$ can be estimated as follows,
\begin{equation*}
\begin{split}
&\abs{{\bf D}^{\mu, \nu}(\pav)-{\bf D}^{\mu, \nu}(\phi_{a_0,v_0})}\\
&\quad \leq \abs{{\bf D}^\mu(\pav^1)\cdot {\bf D}^\nu (\pav^2)-{\bf D}^\mu(\phi_{a_0,v_0}^1)\cdot {\bf D}^\nu (\phi_{a_0,v_0}^2)}\\
&\quad  \leq \abs{{\bf D}^\mu(\pav^1)-{\bf D}^\mu(\phi_{a_0,v_0}^1)}\cdot\abs{ {\bf D}^\nu (\pav^2)}\\
&\quad \quad +\abs{{\bf D}^\mu(\phi_{a_0,v_0}^1)}\cdot \abs{{\bf D}^\nu (\pav^2)-{\bf D}^\nu (\phi_{a_0,v_0}^2)}\\
&\quad  \leq C\cdot \bigl[  \abs{{\bf D}^\mu(\pav^1)-{\bf D}^\mu(\phi_{a_0,v_0}^1)}+
\abs{{\bf D}^\nu (\pav^2)-{\bf D}^\nu (\phi_{a_0,v_0}^2)}\bigr]
\end{split}
\end{equation*}
since  $\abs{D^\beta (\pav)}\leq C$ on $\R^+\times S^1$ for all $\abs{\beta}\leq 3+m$.\\
\noindent From 
\begin{equation*}
\begin{split}
&{\bf D}^\mu(\pav^1)-{\bf D}^\mu(\phi_{a_0,v_0}^1)=
{\bf D}^\mu(r^1(a, v))-{\bf D}^\mu(r^1(a_0,v_0))=\\
&\sum_{1\leq i\leq k}D^{\mu_1}(r^1(a, v))\cdots\bigl[ D^{\mu_i}\bigl(r^1(a, v))-r^1(a_0, v_0)\bigr)\bigr]\cdots D^{\mu_k}(r^1(a, v)),
\end{split}
\end{equation*}
we conclude that 
\begin{equation*}
\begin{split}
\abs{{\bf D}^\mu(\pav^1)-{\bf D}^\mu(\phi_{a_0,v_0}^1)}&\leq C
\sum_{1\leq i\leq k}\bigl[ D^{\mu_i}\bigl(r^1(a, v))-r^1(a_0, v_0)\bigr)\bigr]\\
&\leq C
\sum_{\abs{\beta}\leq 3+m}\bigl[ D^{\beta}\bigl(r(a, v))-r(a_0, v_0)\bigr)\bigr].
\end{split}
\end{equation*}
The estimate for the factor ${\bf D}^\nu(\pav^1)-{\bf D}^\nu(\phi_{a_0,v_0}^2)$ is the same, so that 
$$
\abs{{\bf D}^{\mu, \nu}(\pav)-{\bf D}^{\mu, \nu}(\phi_{a_0,v_0})}\leq C\sum_{\abs{\beta}\leq 3+m} \bigl[ D^\beta (r(a, v))-
D^\beta(r(a_0, v_0))\bigr].
$$
Now we recalling that $h_0$ is a smooth function having support contained in $[0,s_1]\times S^1$, we let $C_0=\abs{h_0}_{C^{3+m}([0,s_1]\times S^1)}$. Then the  contribution of the term $II_1$ to the integral \eqref{int_est_M3_15} is bounded above by 
\begin{equation*}
\begin{split}
&C_0\cdot C\int_{\R^+\times S^1}\abs{ \sum_{\abs{\beta}\leq 3+m}  D^\beta \bigl[ r(a, v))-
r(a_0, v_0)\bigr] }^2e^{2\delta_ms}\ dsdt\\
&\quad \leq C_0\cdot C\sum_{\abs{\beta}\leq 3+m}
\int_{\R^+\times S^1}\abs{D^\beta \bigl[ r(a, v))-
r(a_0, v_0)\bigr]}^2e^{2\delta_ms}\ dsdt\\
&\quad \leq  C_0\cdot C\abs{r(a, v)-r(a_0, v_0)}^2_m.
\end{split}
\end{equation*}
For the term  $II_2$, we have 
\begin{equation*}
\begin{split}
&\abs{\bigl[ (D^\gamma h_0)(\pav)-(D^\gamma h_0)(\phi_{a_0, v_0})\bigr]\cdot {\bf D}^{\mu, \nu}(\phi_{a_0, v_0})}\\
&\quad \leq C\cdot 
\abs{(D^\gamma h_0)(\pav)-(D^\gamma h_0)(\phi_{a_0, v_0})} \leq C_0\cdot C \cdot 
\abs{\pav-\phi_{a_0, v_0}}\\
&\quad=C_0\cdot C\cdot \bigl[ \abs{d(a, v)-d(a_0, v_0)}+\abs{r(a, v)-r(a_0, v_0)}\bigr].
\end{split}
\end{equation*}
Hence  the contribution of this term  to 
the integral \eqref{int_est_M3_15} is bounded  by 
\begin{equation*}
\begin{split}
C_0^2\cdot \dfrac{(e^{2\delta_m s_1}-1)}{2\delta_m}\cdot  \abs{d(a, v)-d(a_0, v_0)}^2+C_0^2\cdot \abs{r(a, v)-r(a_0, v_0)}_m^2.
\end{split}
\end{equation*}
Combining both estimates,  the term $II$ is bounded by 
$$
II\leq C_0\cdot C\cdot (e^{\delta_m s_1}-1)\cdot \abs{d(a, v)-d(a_0, v_0)} +C_0\cdot C\cdot \abs{r(a, v)-r(a_0, v_0)}_m
$$
and hence, by \eqref{eq_I_a} and \eqref{int_est_M3_6},  we get 
\begin{equation}\label{int_est_M3_11}
\begin{split}
&\abs{\wt{\Phi} (a, v,u)-\wt{\Phi} (a_0, v_0,u_0)}_m\leq C\abs{u-u_0}_m+2C\rho\\
&\phantom{\leq }  +
C_0(1-e^{\delta_m s_1})\abs{d(a, v)-d(a_0, v_0)} +C_0C\cdot \abs{r(a, v)-r(a_0, v_0)}_m.
\end{split}
\end{equation}
The number $\rho$ can be chosen to be as small as we wish. Also, the terms $\abs{d(a, v)-d(a_0,v_0)}$ and $\abs{r(a, v)-r(a_0, v_0)}$ are small for $(a, v)$ sufficiently close to $(a_0, v_0)$.  Therefore,  \eqref{int_est_M3_11} shows  that 
$\wt{\Phi} $ is continuous on every level $m$. This means that $\wt{\Phi} $ is of class $\ssc^0$ and the  proof of the lemma is complete. 
\end{proof} 

Next we show that $\wt{\Phi} $  is of class $\ssc^1$. To shorten out notation we write $b=(a, v)$. The candidate for the linearization $D\wt{\Phi} ( b,  u)\colon \bd\oplus V\oplus L\to L$ at the point $(b, u)$ is given by 
\begin{equation}\label{eq_lin_1}
\begin{split}
D\wt{\Phi}  (b, u)(c,   w)=\wt{\Phi} (b, w)+
\wt{\Phi} (b,  u_s)\cdot D\phi_b^1 \cdot c+\wt{\Phi} (b, u_t)\cdot D\phi_b^2 \cdot c,
\end{split}
\end{equation}
where $(c, w)\in \R^2\oplus \R^N\oplus L$ and $D\phi_b^1$ (resp. $D\phi_b^2$) denotes the derivative of $\phi_b^1$ (resp. $\phi_b^2$)  with respect to the variable $b$. 

We have already proved  that the map $\wt{\Phi} \colon \bd \oplus V\oplus L\to L$ is of class $\ssc^0$. The maps 
$L^1\to L$, defined by $u\mapsto u_s, u_t$,  are sc-operators. Hence, by  the chain rule,  
 the maps $\bd \oplus V\oplus L^1\to L$, defined $(b, u)\mapsto\wt{\Phi}  (b, u_s)$ (resp. $\wt{\Phi} (b,u_t)$) are of class $\ssc^0$. 
The map  $D\phi_b^1(s, t)\cdot c$ is  linear in $c$ and since 
$D\phi_b^1(s, t)=Dc(b) +Dr(b)(s, t)$,  where $D$ denotes  derivative with respect to $b$,   we deduce from the properties of $b\mapsto c(b)$ and $b\mapsto r(b)$, that the map $(b, c, s, t)\mapsto D\phi_b^1(s, t)\cdot  c$ is continuous. This implies that 
the map $(b,  u, c, s, t)\mapsto \Psi  (b, u_s)D\phi_b^1(s, t)\cdot c$ is continuous on every level $m$. The same holds for the map $\wt{\Phi} (b, u_t)D\pav^2\cdot c$. 

We have proved that the map $T(\bd\oplus V\oplus L)\to  TL$, defined by 
\begin{equation}\label{guess1}
T(b,u,b, w)\mapsto  \bigl(\wt{\Phi} (b, u),D\wt{\Phi} (b,u)(b, w)\bigr),
\end{equation}
 is $\ssc^0$.
Next we show that the right-hand side of \eqref{eq_lin_1} defines the linearization of $\wt{\Phi}$.
With $(b,u,c,w)\in T(V\oplus E)$ and using
 $$\wt{\Phi} (b+c, u)-\wt{\Phi} (b, u)=\int_0^1\frac{d}{d\tau }\wt{\Phi} (b+\tau c, u)\ d\tau,$$ 
 we have 
\begin{equation*}
\begin{split}
& \wt{\Phi} (b+c, u+w)-\wt{\Phi} (b,u)-D\wt{\Phi} (b, u)(c,w)\\
&\phantom{===}=\wt{\Phi} (b+c,w)-\wt{\Phi} (b, w) \\
&\phantom{====}+\int_0^1 \bigl[ \wt{\Phi} (b+\tau c, u_s)D\phi_{b+\tau c}\cdot c-\wt{\Phi} (b,u_s)D\phi^1_{b}\cdot c\bigr]\ d\tau\\
&\phantom{====}+\int_0^1 \bigl[\wt{\Phi} (b+\tau c,u_t)D\phi^2_{b+\tau c}\cdot c-\wt{\Phi} (b,u_t)D\phi_b^2\cdot c]\ d\tau\\
&\phantom{===}=I+II+III.
\end{split}
\end{equation*}
We consider the term $I$. Since $\wt{\Phi}$ is linear with respect to the second variable, we have
\begin{equation*}
\begin{split}
&\dfrac{1}{\abs{b}+\abs{w}_1}\cdot \abs{\wt{\Phi} (b+c,w)-\wt{\Phi} (b,w) }_0\\
&\quad =\dfrac{\abs{w}_1}{\abs{b}+\abs{w}_1}\cdot \left| \wt{\Phi} i\left( b+c,\frac{w}{\abs{w}}_1\right)-\wt{\Phi} \left(b, \frac{w}{\abs{w}}_1\right) \right|_0
\end{split}
\end{equation*}
for $w\neq 0$. The inclusion  $L_1\to  L_0$  is compact and hence we may assume that
$\frac{w}{\abs{w}_1}\to w_0$ in $L_0$. Since $\wt{\Phi}$ is $\ssc^0$,  we conclude that
$$\frac{1}{\abs{b}+\abs{w}_1}\cdot \abs{\wt{\Phi} (b+c,w)-\wt{\Phi} (b,w) }_0\to 0$$
as $\abs{b}+\abs{w}_1\to 0$.  Next we consider the second term $II$. We have,   for $c\neq 0$,
\begin{equation*}
\begin{split}
&\frac{1}{\abs{c}+\abs{w}_1}\left| \int_0^1 [\wt{\Phi} (b+\tau c,u_s)\cdot D\phi^1_{b+\tau c}\cdot c-\wt{\Phi} (v,u_s)\cdot D\phi^1_{b}\cdot c]\ d\tau\right|_0\\
&\leq \frac{\abs{c}}{\abs{c}+\abs{w}_1}\int_0^1 \left| \wt{\Phi} (b+\tau c,u_s)\cdot D\phi^1_{b+\tau c}\cdot \frac{c}{\abs{c}}-\wt{\Phi} (b,u_s)\cdot D\phi^1_{b}\cdot  \frac{c}{\abs{c}}\right|_0 \ d\tau
\end{split}
\end{equation*}
Since $\wt{\Phi} $ is $\ssc^0$ and  $(b, c, (s, t))\mapsto D\phi^1_{b} (s, t)(c/\abs{c})$ is smooth,  we conclude that
the above expression converges to $0$ as $\abs{c}+\abs{h}_1\to 0$. The same holds for the term $III$.
We have proved that
$$\frac{1}{\abs{c}+\abs{w}_1}\cdot \abs{ \wt{\Phi} (b+c,u+w)-\wt{\Phi} (b, u)-D\wt{\Phi} (b,u)(c, w)  }_0\to 0  $$
as $\abs{c}+\abs{w}_1\to 0$ so that the right-hand side of \eqref{eq_lin_1} is indeed  the linearization of $\wt{\Phi} $ in the sense of Definition \ref{sscc1}.

Therefore, the sc-continuous map given by equation \eqref{guess1} defines the tangent map $T\Phi :T(\bd\oplus V\oplus L)\to TL$. This finishes the  proof  that the map $\wt{\Phi} $ is of class $\ssc^1$.

Sc-smoothness of the map $\wt{\Phi} $ is a consequence of the following lemma which gives the form of the iterated tangent map $T^k\wt{\Phi} $. 
\begin{lemma}\label{structure}  For every $k$, the map 
$$\wt{\Phi} \colon \bd\oplus V\oplus L\to  L,\quad (b,u)\mapsto  u\circ \psi_b,$$ 
is $\ssc^k$. Moreover, assuming that $\pi\colon T^kL\to L^j$ is the  projection onto a factor of  $T^kL$,  the composition $\pi\circ T^k\wt{\Phi} $ is a linear combination of maps  of the form
\begin{equation*}
\begin{gathered}
\bd \oplus V\oplus L^m\oplus(\R^{2+N})^p\to  L^j,\\
(b,w,c_1, \ldots ,c_p)\mapsto
\wt{\Phi} (b,D^{\alpha}w)\cdot f(b, c_1, \ldots ,c_p), 
\end{gathered}
\end{equation*}
where $f\colon \bd \oplus V\oplus  (\R^{2+N})^p\times \R^+\times S^1\to  \R$ is a smooth function which is  linear in every variable $c_i$.  Moreover,  $\abs{\alpha}\leq m-j$ and $p\leq k$.
\end{lemma}
\begin{proof} We prove the lemma by induction with respect to $k$ starting with $k = 0.$
In this case, the statement is trivially satisfied,  since by Lemma \ref{lem_M_3} the map 
$\wt{\Phi} $ is of class $\ssc^0$. Moreover,  there is exactly one projection $\pi:T^0L=L\to L$, namely the identity map, so that $\pi\circ \wt{\Phi} =\wt{\Phi} $ has the required form
with  $m=j=0$, $\alpha=(0,0)$, $p=0$, and $f\equiv 1$.
The statement of the lemma also holds for $k=1$. It  follows from  \eqref{eq_lin_1} and \eqref{guess1},  that the compositions of the tangent map $T\Phi$ with projections $\pi$ onto factors of $TL=L^1\oplus L$  are linear combinations of  maps  of the required form.

We assume that the statement has been proved for $k$ and verify that it holds for $k+1$. It suffices to show that the compositions of the  iterated tangent map $T^{k}\wt{\Phi} \colon T^k(\bd\oplus V\oplus L)\to T^kL$ with the projections $\pi\colon T^kL\to L^j$ onto the  factors of $T^kL$
are of class $\ssc^1$ and their linearizations have the required form.
By inductive assumption, $\pi\circ T^{k}\wt{\Phi} $ is the linear combination of maps  having the particular forms, 
\begin{equation*}
\Gamma\colon \bd\oplus V\oplus L^m\oplus (\R^{2+N})^{p}\to  L^j,
\quad (b,w,c)\mapsto
\wt{\Phi}(b,D^{\alpha}w)\cdot f(b,c),
\end{equation*}
where we abbreviated $c=(c_1,\ldots ,c_p)\in  (\R^{2+N})^{p}$  and $\abs{\alpha}\leq m-j$ and $p\leq k$.
It  is enough  to show that our claim holds for each of these  maps. By assumption, 
the function $f\colon \bd\oplus V\times (\R^{2+N})^p\times \R^+\times S^1 \to \R$ is  smooth and linear in each variable $c_i$. 

The map $\Gamma$ is the composition of the following maps. The sc-operator $L^m\to L^{m-\abs{\alpha}}$,  defined by $h\mapsto D^{\alpha}h$, is composed with  the map
$$\wt{\Phi} \colon V\oplus L^m \to  L^j, \quad (v,u)\mapsto \wt{\Phi} (v,u)$$
which we already know is of class $\ssc^1$. By the chain rule, this composition is at least of class $\ssc^1$. Multiplication of this composition  by a smooth function $\bd \oplus V\oplus (\R^{2+N})^p\to \R$ defined by $(b, c)\mapsto f(b, c)$ gives  an $\ssc^1$-map.   Hence the map $\Gamma$ is of class $\ssc^1$ and it  remains to show that
the compositions $\pi\circ T\Gamma$  of the tangent map $T\Gamma\colon T(\bd\oplus V\oplus L^m\oplus (\R^{2+N})^{p})\to T(L^j)$  with the projections onto factors of $T(L^j)$ are linear combinations of maps of the required form.
The tangent map of $\Gamma$ is given by
$$T\Gamma(b, w, c, \delta b, \delta w, \delta c)=\bigl( \Gamma (b, w, c), D\Gamma (b, w, c)( \delta b, \delta w, \delta c)\bigr)$$
where $(b, w, c)\in \bd\oplus V\oplus L^{m+1}\oplus (\R^{2+N})^{p}$ and $( \delta b, \delta w, \delta c)\in \R^{2+N}\oplus L^m\oplus (\R^{2+N})^{p}.$ Denoting by $\pi\colon T(L^j)=L^{j+1}\oplus L^j\to L^{j+1}$  the projection onto  the first factor of $T(L^j)$, then, by our inductive assumption, 
$\pi\circ T\Gamma =\Gamma$  is a linear combination of terms having required form but with the indices $m$ and $j$ raised by $1$.

So, we consider the projection $\pi\colon T(L^j)\to L^j$  onto the second factor of $T(L^j)$ and the map $\pi\circ T\Gamma=D\Gamma$. Using the chain rule and the linearization of $\Gamma$ given by 
\eqref{eq_lin_1},
the linearization $D\wt{\Phi} $ is a linear combination of the following four types of maps:
\begin{align*}
(1)&\quad \bd\oplus V\oplus L^{m}\oplus (\R^{2+N})^p \to L,\\
&\qquad \qquad(b, \delta w, c)\mapsto  \Gamma (b,D^{\alpha} (\delta w) )\cdot f(b,c).&\\
(2)&\quad\bd\oplus V\oplus  L^{m+1}\oplus (\R^{2+N})^{p+1}\to L,\\
&\qquad \qquad(b, w,  (\delta b, c))\mapsto    \Gamma (b,D^{\alpha +(1,0)} w)\cdot (D\phi^1_{b}\cdot \delta b) f(b,c),\;\; \text{and}\\
&\qquad \qquad(b, w,  (\delta b, c))\mapsto  \Gamma(b,D^{\alpha +(0,1)} w)\cdot (D\phi^2_{b}\cdot \delta b) f(b,c).&\\
(3)&\quad\bd\oplus V\oplus  L^{m+1}\oplus (\R^{2+N})^{p+1}\to L,\\
&\qquad \qquad(b, w, (\delta b, c))\mapsto   \Gamma(b,D^{\alpha} w )\cdot D_bf(b,c)\cdot \delta b.&\\
(4)&\quad\bd\oplus V\oplus  L^{m+1}\oplus (\R^n)^{p+1}\to L,\\
&\qquad \qquad(b, w, (c, \delta c_i))\mapsto   \Gamma(b,D^{\alpha} w )\cdot  f(b,(c_1,\ldots ,\delta c_i, \ldots , c_p))\\
\phantom{(4)}&\qquad \text{for every $1\leq i\leq p$}.
\end{align*}


All of these four types of maps have the desired form. Having verified the statement for $k+1$, the proof of Lemma  \ref{structure} is complete.
\end{proof}


With the proof of Lemma \ref{structure}, the proof of Theorem  \ref{thm_m3_1} is finished.\\[0.5ex]

This completes the proof of Theorem \ref{theorem_neck}.
\end{proof} 




\section{Proof of Lemma \ref{GROMOVCONV} }\label{section5.1}
\begin{L3.4}
We consider the stable map  $(S, j, M, D, u)$ and two sequences $u_k, u_k'\in H^{3,\delta_0}(S, Q)$ of maps from the noded Riemann surface $S$ into the symplectic manifold $Q$   converging  to $u$ in $C^0$. We assume 
that $(a_k,v_k)\rightarrow (0,0)\in O$ and $(b_k,w_k)\rightarrow (0,0)\in O$ and  assume that  
$$
\phi_k:(S_{a_k},j(a_k,v_k),M_{a_k},D_{a_k},\oplus_{a_k}(u_k))\rightarrow
(S_{b_k},j(b_k,w_k),M_{b_k},D_{b_k},\oplus_{b_k}(u'_k))
$$
is a sequence of isomorphisms. Then there is a subsequence of $(\phi_k)$ which converges in $C^{\infty}_{\text{loc}}$ away from the nodes to an automorphism $\phi_0$ of $(S, j, M, D, u)$. 
\end{L3.4}
\begin{proof}
We abbreviate $S_k=S_{a_k}$ and $S'_k=S_{b_k}$ and choose two sequences $g_k$ and $g_k'$ of Riemann metrics on $S_k$ and $S_k'$, which are independent of $k$ on the core regions of $S_k$ and $S_k'$, respectively, and which are translation and rotation invariant standard metrics on the neck regions of $S_k$ and $S_k'$
(identifying the necks with cylinders). We abbreviate  the norms  by  $\abs{ \cdot  }_k=\sqrt{g_k'(\cdot , \cdot )}$.

In a first step we  show that the sequence $\abs{\nabla \phi_k}_k$ is uniformly bounded.  Arguing by contradiction we assume that there is a sequence of  points $z_k\in S_k$ satisfying 
$$
R_k=\abs{\nabla \phi_k (z_k)}_k\to \infty. 
$$ 


We next show that the sequence $(z_k)$ stays at a finite distance to  the core regions of $S_k$. Arguing by contradiction, we assume, after taking a subsequence, that $z_k$ lies in the neck region 
$N_k$ associated with the nodal pair $\{x, y\}\in D$ and that $\text{dist}\ (z_k, \partial N_k)\to \infty$. 
We distinguish the following two cases. 
\begin{itemize}
\item[(1)] The image  sequence  $(\phi_k(z_k))$ lies in the neck $N_k'$ of $S_k'$  associated with the nodal pair $\{x',y'\}\in D$ and $\text{dist}\ (\phi_k(z_k), \partial N_k')\to \infty$.
\item[(2)] The image  sequence  $(\phi_k(z_k))$ lies at a  finite distance to the core region of $S_k'$.
\end{itemize}

To deal with the case (1) we recall that  the necks  $N_k$ of $S_k$ are   the finite cylinders $Z^{\{x,y\}}_{a_k}:=Z^{\{x,y\}}_{a_k^{\{x,y\}}}$  connecting the boundaries of the associated disks $D_x$ and $D_y$ of the small disk structure. These  cylinders are defined as follows. 
We choose the positive and negative  holomorphic polar coordinates
\begin{equation*}
\begin{aligned}
&h_x:[0,\infty)\times S^1\rightarrow D_x\setminus\{x\},&\qquad 
&\bar{h}_x(s, t)=\ov{h}_x(e^{-2\pi (s+it)}),\\
&h_y:(-\infty, 0]\times S^1\rightarrow D_y\setminus\{y\},&\qquad 
&\bar{h}_y(s, t)=\ov{h}_y(e^{2\pi (s+it)}),
\end{aligned}
\end{equation*}
where
\begin{align*}
\ov{h}_x:\{w\in \C\vert \, \abs{w}\leq  1\}\to D_x\quad \text{and}\quad 
\ov{h}_y:\{w\in \C\vert \, \abs{w}\leq  1\}\to D_y
\end{align*}
are biholomorphic mappings. 
We remove from the disk $D_x$ the  points  $z=h_x(s,t)\in D_x$  for $s>\varphi(|a_k|)$ and from $D_y$ the points $z'=h_y(s',t')\in D_y$  for  $s'<-\varphi(|a_k|)$. Here $\varphi $ is the exponential gluing profile.  The remaining  points of the disks $D_x$ and $D_y$ are identified as follows. The points 
$z=h_x(s,t)$ and $z'=h_y(s',t')$
are equivalent if 
$s=s'+R_k$ and $t=t'+\vartheta    \pmod 1$, where $R_k=\varphi (\abs{a_k})$  and
 $a_k=\abs{a_k}e^{-2\pi i\vartheta}.$ 
 
 Assuming that  the sequence $(\phi_k(z_k))$ lies in the neck $N'_k=Z^{\{x', y'\}}_{b_k}$  
 associated with the nodal pair $\{x',y'\}\in D$ and $\text{dist}\ (\phi_k(z_k), \partial N_k')\to \infty$, we identify 
 $Z^{\{x,y\}}_{a_k}$ and $Z^{\{x',y'\}}_{b_k}$ with the cylinders  $[0,R_k]\times S^1$ and $[0, R'_k]\times S^1$. 
 Then  $z_k=(s_k, t_k)\in [0,R_k]\times S^1$ satisfies $s_k\to \infty$ and $R_k-s_k\to \infty$. Similarly, if $\phi_k (z_k)=(r_k, \theta_k)\in [0, R_k']\times S^1$, then $r_k$  satisfies $r_k\to \infty$ and $R_k'-r_k\to \infty$. In view of the periodicity in the $t$-variable, we view the maps $\phi_k$ as maps on (subsets of)  $\C$. 
 
Applying   the bubbling off arguments  from  \cite{H0}, we choose a sequence $(\varepsilon_k)$ of positive numbers such that $\varepsilon_k\to 0$ and $\varepsilon_kR_k\to \infty$.  In view of 
Lemma  26 in  \cite{H0} we can modify the sequences $(\varepsilon_k)$ and $(z_k)$ so that the new sequences  satisfy 
 \begin{gather}\label{gr-eq1}
\varepsilon_k\to 0,   \quad  R_k\varepsilon_k\to \infty\\
 \abs{\nabla \phi_k (z)}\leq 2R_k\quad \text{if \ $\abs{z-z_k}\leq \varepsilon_k$}.
 \end{gather}
Introducing the representation  $\phi_k (z)=(a_k(z), \theta_k (z))\in \R\times S^1$ and  $m_k=a_k(z_k)$, we define the sequence $(\wt{\phi}_k)$ of rescaled holomorphic maps  on the disks $\abs{z}\leq \varepsilon_k R_k$ by 
$$\wt{\phi}_k(z)=
\bigl(\wt{a}_k(z), \wt{\theta}_k(z)\bigr)=\bigl( a_k\big( z_k+\frac{z}{R_k}\bigr)-m_k, \theta_k 
\bigl(z_k+\frac{z}{R_k}\bigr)\bigr).
$$
The maps $\wt{\phi}_k$ satisfy
$$
\abs{\nabla \wt{\phi}_k(0)}_k=1 \ \  \text{and}\quad  \abs{\nabla \wt{\phi}_k(z)}_k\leq 2\quad \text{if}\ \ \abs{z}\leq \varepsilon_kR_k.
$$
We also note that the maps are injective. 
From the gradient bounds, one derives $C^\infty_{\text{loc}}$-bounds for the sequence $(\wt{\phi}_k)$. \
Since  the maps $\wt{\phi}_k$ are, by construction,  locally bounded in k, we find by  Ascoli-Arzela's theorem a converging subsequence $\wt{\phi}_k\to \phi $ in $C_{\textrm{loc}}^\infty (\C)$. The limit map $\phi (z)=(a, \theta):\C\to \R\times S^1$ is  a non-constant injective  holomorphic map satisfying 
$$
\text{$ \abs{ \nabla \phi (0) }=1$}.
$$
We may view ${\mathbb R}\times S^1$    as $S^2\setminus\{0,\infty\}$ conformally. Using the removable singularity theorem
we obtain the non-constant holomorphic map
$$
\phi:S^2\rightarrow S^2
$$
which misses  at least one point. This contradicts the fact that there is no non-constant holomorphic map $S^2\rightarrow {\mathbb C}$.
 
In case (2), the bubbling off analysis as above,   but replacing the maps $\wt{\phi}_k$ by the maps
$$\wt{\phi}_k(z)=\phi_k \biggl( z_k+\frac{z}{R_k}\biggr)
\quad \text{for $\abs{z}\leq \varepsilon_k R_k$},$$
produces a non-constant  holomorphic map $\phi:\C\to C$  into a connected and compact component $C$ of the noded  Riemann surface  $S$. In view of the removable singularity theorem, we can extend the holomorphic map $\phi$ from $\C$  to a holomorphic map $\wt{\phi}:S^2=\C\cup \{\infty\}\to C$.
Since non-constant  holomorphic maps are open and since $S^2$ is compact, the map $\wt{\phi}$ is surjective onto $C$, and we conclude from the Riemann-Hurwitz formula that the genus  $g(C)$ is equal to $0$ so that $C=S^2$. 
Since the maps $\phi_k$, by definition,  map special  points onto special  points, and since the neck regions do not  contain any  special  points, we conclude  from   the surjectivity of $\wt{\phi}$ and the connectedness of the noded Riemann  surface $(S, j, M, D)$ that  the component $C=S^2$ possesses precisely one special point, namely a nodal point, which is hit by the extension $\wt{\phi}:S^2\to C\equiv S^2$.  Since the number of special points is equal to $1$, we conclude from the stability assumption  of the stable map $(S, j, M, D, u)$ that $\int_Cu^*\omega>0$. Consequently,  we  find two  points $p$ and $q$ in $\C$ such that  their image points  $p'=\phi (p)$ and $q'=\phi (q)$ are different  and  such that $\text{dist}\ (u(p'), u(q'))>0$.
Since $\phi_k$ is an isomorphism, we know that $\oplus_{b_k}(u_k')\circ \phi_k=\oplus_{a_k}(u_k)$. 
Hence at a finite distance to the core regions we have $u'_k\circ \phi_k=u_k$ for $k$ large.  Abbreviating by $\tau_k(z)=z_k+\frac{z}{R_k}$ the maps introduced for the rescaled map $\wt{\phi}_k$, we  compute,  
\begin{equation*}
\begin{split}
0<\text{dist}\ (u(p'), u(q'))&=\text{dist}\ (u\circ \phi (p), u\circ  \phi (q))\\
&=\lim_k \text{dist}\ (u'_k\circ  \phi_k\circ \tau_k (p), u'_k\circ  \phi_k\circ \tau_k (q))\\
&=\lim_k  \text{dist}\ (u_k\circ \tau_k (p), u_k\circ \tau_k (q))\\
& =\text{dist} (u(x), u(x))=0,
\end{split}
\end{equation*}
which again is a contradiction. 
 
Consequently, we  have proved that  the sequence $(z_k)$ necessarily stays  at a  finite distance to  the core region of $S_k$. Since there are only finitely many connected components of $S_k$, we may assume that the sequence $(z_k)$ stays at a finite distance to the core region of the connected and compact component $C$ of the noded Riemann surface $S$.  Again we distinguish the two cases (1) and (2). 
Arguing as before, both cases lead to contradictions and we have proved the claim  that bubbling off in the sequence $(\phi_k)$ of isomorphisms does not occur. 


Therefore,  one concludes  by Gromov--compactness that any subsequence of $(\phi_k)$ possesses a subsequence which converges in $C^\infty_{\text{loc}}$ away from the nodes to some automorphism 
$\phi_0:(S,j, M, D, u)\to (S,j, M, D, u)$ of the stable map as claimed in Lemma \ref{GROMOVCONV}.
\end{proof}




\section{Linearization of the CR-Operator}\label{connection}
In order to linearize the Cauchy-Riemann operator we first introduce some notation. If 
$\nabla$ is a connection of the vector bundle $E\to Q$ over the smooth manifold $Q$, then the covariant derivative $\nabla_Xs$  of the  section $s$ in the direction of the vector field $X$ on $Q$ is the section, which in local coordinates is given by 
$$
\nabla_Xs(x)=Ds (x)\cdot X(x) + \Gamma(x)(X(x),s(x)).
$$
Here, $Ds$ is the derivative of $s$ and $\Gamma$ is the local connector associated with $\nabla$. In the case of the tangent bundle $E=TQ\to Q$, the torsion $N$  of the connection $\nabla$ is, in local coordinates given by 
$$
N(x)(X,Y)=\Gamma(x)(X,Y)-\Gamma(x)(Y,X).
$$
If $u:S\to Q$ is a smooth map, the pull-back connection  $u^*\nabla$ on the pull-back bundle $u^*TQ\to S$ is defined as follows. The covariant derivative $(u^*\nabla)_X\eta$  of a section $\eta$ of the pull-back bundle (hence satisfying $\eta (z)\in T_{u(z)}Q$) in the direction of the vector field $X$ on $S$, is the section, which in local coordinates is given by 
$$
(u^*\nabla )_X\eta (z)=D\eta (z)\cdot X(z)+\Gamma (u(z))(Du(z)\cdot X(z), \eta (z)).
$$
Here $D\eta$ and $Du$ are the derivatives of $\eta$, respectively $u$, in local coordinates. 

Connections on the tangent bundle $TQ\to Q$ induce natural connections on function spaces associated with the manifold $Q$, as is explained in 
\cite{El}. We consider the function space of functions $u:S\to Q$ having sufficient regularity and denote by 
$$\partial : u\mapsto Tu$$
the map associating with the map $u$ its tangent map $Tu$, which is a section of the vector bundle $T^*S\otimes u^*(TQ)\to S$ so that $Tu(z)\in \call (T_zS, T_{u(z)}Q)$ for all $z\in S$. Let $\eta$ be a section of the pull-back bundle $u^*TQ\to S$. The covariant derivative $(\nabla_\eta \partial )(u)$ of the map $\partial$ at the point $u$ in the direction of $\eta$  is the section of $T^*S\otimes u^*(TQ)\to S$, in local coordinates given by 
$$(\nabla_\eta \partial )(u)(z)=D\eta (z)+\Gamma (u(z))\bigl(\eta (z), Du(z)\cdot \bigr).$$
Since, for the fixed map $u:S\to Q$ the covariant derivative $(u^*\nabla)_{(\cdot)}\eta$ of the section $\eta$ of $u^*TQ\to S$ is the  section of 
$T^*S\otimes u^*(TQ)\to S$ which in local coordinates is given by 
$$(u^*\nabla)_{(\cdot)}\eta (z)=D\eta(z)\cdot   +\Gamma (u(z))\bigl(Du(z)\cdot , \eta (z)\bigr),$$
we obtain the formula 
\begin{equation}\label{covariant1}
(\nabla_\eta\partial)(u)=(u^*\nabla )_{(\cdot)}\eta+N(\eta, Tu\cdot ).
\end{equation}
Let us simplify the notation by setting for a vector field $\eta$ along $u$, since $u$ is usually fixed,
$$
\nabla\eta := (u^\ast\nabla)_{(\cdot)}\eta.
$$
Note that $(\nabla\eta)(z)$ for $z\in S$ is a linear map $T_zS\rightarrow T_{u(z)}Q$.
We now assume that $(Q,\omega)$ is our  symplectic manifold  equipped with the compatible almost complex structure $J$. We choose a connection $\nabla$ on $TQ\to Q$ which satisfies  $\nabla J=0$. 
For fixed $(a, v)$ we consider the space of maps $u:S_a\to Q$ and compute the  covariant derivative $(\nabla_\eta \ov{\partial}_{J, j(a, v)})(u)$ of the Cauchy-Riemann map 
$$u\mapsto  \ov{\partial}_{J, j(a, v)}(u)=\frac{1}{2}\bigl[ Tu+J(u)\circ Tu \circ j(a, v)\bigr]$$
at the point $u$ in the  direction of the  section $\eta$ along $u$. In view of $\nabla J=0$ and the formula \eqref{covariant1} we obtain the following formula  for the section 
$(\nabla_\eta \ov{\partial}_{J, j(a, v)})(u)$  of the  vector bundle $T^*S\otimes u^*(TQ)\to S$,
\begin{equation}\label{covariant2}
\begin{split}
(\nabla_\eta \ov{\partial}_{J,j(a,v)})(u)&=\frac{1}{2} \bigl[ \nabla\eta  + J(u)\circ  (\nabla\eta) \circ j(a, v)\cdot \bigr]  \\
&\phantom{=}+\frac{1}{2}\bigl[ N(\eta ,Tu \cdot )  +J(u)\circ N(\eta,Tu\circ  j(a,v)\cdot )\bigr].
\end{split}
\end{equation}
The Cauchy-Riemann type operator in \eqref{covariant2} is in local coordinates of the form 
\begin{equation}\label{covariant2_b}
D\eta (z)+J(u(z))\circ D\eta (z)\circ  j(a, v)+A(z)(\eta (z), Tu(z)).
\end{equation}
Here $A(z)$ is a bilinear map.  Fixing the point $z_0\in S_a$, we choose a smooth family $\varphi_v:(D, i)\to ({\mathcal D}, j(a, v))$ of biholomorphic mappings which map $0\in \C$ onto $z_0$. 
Taking the composition $\xi=\eta\circ \varphi_v:D\to \R^{2n}$ and evaluating the above operator at the vectors $T\varphi_v \cdot \frac{\partial}{\partial s}$ we obtain the following local expression for 
$\nabla_\eta \ov{\partial }_{J,j (a, v)}(u)$, 
$$\frac{\partial }{\partial s}\xi+J(u\circ \varphi_v)\cdot \frac{\partial}{\partial t}\xi+A(\varphi_v)(\xi, \frac{\partial}{\partial s}\bigl( u\circ \varphi_v )\bigr) .$$
Let us apply the above considerations to our filled section ${\bf f}:O\to \cf$ of Section \ref{section4.4} which is defined by 
\begin{equation*}
\begin{aligned}
\Gamma [\exp_{u_a}(\oplus_a(\eta)), u_a]\circ \wh{\oplus}_a{\bf f}(a, v,\eta)\circ \sigma (a, v)&=\ov{\partial}_{J, j(a, v)}(\exp_{u_a}\bigl(\oplus_a(\eta))\bigr)\\
\wh{\ominus}_a{\bf f}(a, v, \eta)&=\ov{\partial}_0\bigl(\ominus_a(\eta)\bigr).
\end{aligned}
\end{equation*}
For fixed $(a, v)$ we take the covariant derivative with respect to the section $\eta$ at the section $k$ in the direction of the section $h$ of the bundle $u^*TQ\to S$ and obtain 
\begin{equation*}
\begin{split}
&\bigl(\nabla_{(T\exp_{u_a}(\oplus_a (k))\cdot \oplus_a(h),0)}\Gamma\bigr)[ \exp_{u_a}(\oplus_a(k)), u_a]\circ (\wh{\oplus}_a{\bf f}(a, v, k))\circ \sigma (a, v)\\
&\phantom{===}+\Gamma[\exp_{u_a}(\oplus_ak), u_a]\circ (\wh{\oplus}_aD_3{\bf f}(a, v, k)\cdot h)\circ \sigma (a, v)\\
&\phantom{==}=(\nabla_{(T\exp_{u_a}(\oplus_ak )\cdot \oplus_ah)}\ov{\partial}_{J, j(a, v)})(\exp_{u_a}(\oplus_a k))
\end{split}
\end{equation*}
and 
\begin{equation*}
\wh{\ominus}_a(D_3{\bf f}(a, v, k)\cdot h)=\ov{\partial}_0(\ominus_a (h)).
\end{equation*}
We note that 
$T\exp_{u_a}(\oplus_a(k))\cdot \oplus_a (h)$  is a section of $[\exp_{u_a}(\oplus_a (k))]^*TQ$.


\section{Consequences of  Elliptic Regularity}\label{appx19}
In the following we first  apply the  elliptic regularity theory to a family of Cauchy-Riemann operators on a fixed domain. In sharp contrast to this ``classical case'' we then apply the  elliptic regularity theory 
in the ``noded version'' to a family of Cauchy-Riemann operators  {\bf on  varying  domains}. \\[0.5ex]

\noindent{\bf Classical Case}\\
 We denote by  $D$ the closed unit disk in $\C$ and by $D_{\delta}\subset D$ the concentric subdisks $D_\delta =\{ z\in D\vert, \, \abs{z}\leq 1- \delta\}$ for $0<\delta<1$.  By $(J_k)$ we denote  
a sequence of complex multiplications on $\R^{2n}$ smoothly parametrized by $D$, i.e.,  $J_k(z)$ for $z\in D$ is a complex structure smoothly depending on $z$. We assume that $J_k\rightarrow J$
in $C^{\infty}(D)$  so that  $J$ is a again a smooth family of complex structures on $\R^{2n}$.  We also assume that $J(z)$ is close to $i$
so that in particular  for $z\in\partial D$ the space $({\mathbb R}\oplus \{0\})\oplus\ldots \oplus ({\mathbb R}\oplus \{0\})$ is totally real for $J(z)$.
 Moreover,  we consider a sequence $(A_k)$ of smooth maps 
$A_k:D\to \call (\R^{2n}, \R^{2n})$ which converge to the map $A:D\to \call (\R^{2n}, \R^{2n})$ in the $C^\infty$-topology. We assume that 
$(y_k)$ is a sequence in $H^{2+m}(D,\R^{2n})$ converging to $0$, 
$$y_k\to 0\quad \text{in $H^{2+m}(D,\R^{2n})$},$$
 and we assume that the sequence 
$(z_k)\subset H^{3+m}(D,{\mathbb R}^{2n})$ is  bounded. Finally,  we assume that the sequence $(u_k)$ is bounded  in  $H^{3+m}(D,\R^{2n})$ and satisfies the equations 
\begin{equation}\label{bond}
\partial_su_k +J_k\partial_t u_k + A_k u_k =y_k+z_k.
\end{equation}
\begin{proposition}\label{appx20}
Under the above assumptions,  every $u_k$ splits as $u_k=v_k+w_k$ where the sequence  $(w_k)\subset H^{m+3}(D,\R^{2n})$
converges to $0$ in $H^{m+3}(D,{\mathbb R}^{2n})$ and  the sequence  $(v_k)$,  if restricted to $D_\delta$,  is bounded in 
$H^{m+4}(D_\delta,\R^{2n})$ for every $0<\delta<1$. In particular, the sequence $(u_k)$ possesses  a subsequence which,  restricted to $D_\delta$,  converges  in
$H^{m+3}(D_\delta,\R^{2n})$.
\end{proposition}
\begin{proof}
We introduce the subspace  $W\subset H^{m+3}(D,{\mathbb R}^{2n})$ of maps satisfying the  boundary conditions 
 $u(1)=0$ and $u(z)\in ({\mathbb R}\oplus \{0\})\oplus\ldots \oplus ({\mathbb R}\oplus \{0\})$ for all $z\in \partial D$. Then the linear operator
$$
L:W\rightarrow H^{m+2}(D,{\mathbb R}^{2n}),\quad u\mapsto u_s +J u_t +Au
$$
is a Fredholm operator of index $0$ whose spectrum is a countable discrete set of points with no finite limit point.  The same holds true for the linear operator 
$$L_k:W\to H^{2+m}(D, \R^{2n}),\quad u\mapsto u_s+J_ku_t+A_ku$$
and there exists an $\varepsilon>0$ such that  for $k$ sufficiently large the operators $L_k+\varepsilon $ are linear isomorphisms. Moreover, 
$\norm{(L_k+\varepsilon )^{-1}}\leq C$ for all $k\geq k_0$, with  a constant $C$ independent of $k$.
For $k\geq k_0$, we  let $w_k\in W$ be the unique  solution of 
$$
(L_k +\varepsilon )w_k = y_k.
$$
Since $y_k\rightarrow 0$ in $H^{m+2}(D,\R^{2n})$, we conclude from 
$$\norm{w_k}_{H^{m+3}(D,{\mathbb R}^{2n})}=\norm{(L_k+\varepsilon )^{-1}(y_k)}_{H^{m+3}(D,{\mathbb R}^{2n})}\leq C\norm{y_k}_{H^{m+2}(D,{\mathbb R}^{2n})}$$
that $w_k\rightarrow 0$ in $H^{m+3}(D,{\mathbb R}^{2n})$.
Now we set $v_k=u_k-w_k$ and note that  the sequence $(v_k)$ is bounded in $H^{m+3}(D,{\mathbb R}^{2n})$ in view of the assumption  on the sequence $(u_k)$. We compute,  using \eqref{bond}, 
$$
L_k(v_k) = L_k(u_k)-L_k(w_k) = (y_k+z_k)-(y_k -\varepsilon w_k)= z_k+\varepsilon w_k =:z_k^{\ast}.
$$
Since $w_k\rightarrow 0$ in $H^{m+3}(D,{\mathbb R}^{2n})$ and since,  by assumption,   the sequence $(z_k)$ is bounded in $H^{m+3}(D,{\mathbb R}^{2n})$, the sequence $(z_k^*)$  is also  bounded in $H^{m+3}(D,{\mathbb R}^{2n})$. Now using that $(v_k)$ is bounded in $H^{m+3}(D,{\mathbb R}^{2n})$, 
we conclude by the interior elliptic regularity theory  that  the sequence $(v_k)$ is bounded in the space  $H^{m+4}_{loc}(\textrm{int} (D),{\mathbb R}^{2n})$. This implies the desired conclusion of Proposition \ref{appx20}.
\end{proof}

\noindent{\bf Noded Version}\\
 We assume that we  are given two smooth maps 
$$
[0,\infty)\times S^1\rightarrow \call ({\mathbb R}^{2n},\R^{2n}),\quad  (s,t)\mapsto  J^+(s,t)
$$
and 
$$
(-\infty,0]\times S^1\rightarrow \call ({\mathbb R}^{2n},\R^{2n}),\quad  (s',t')\mapsto  J^-(s',t')
$$
where  $J^+(s,t)$ and $J^-(s',t')$ are complex structures on ${\mathbb R}^{2n}$ for every $(s,t)$ and $(s',t')$. Moreover, we assume that there is a complex structure $J_0$  on $\R^{2n}$ such that 
$$J^+(s,t)\to J_0\qquad  \text{and}\qquad J^-(s',t)\to J_0$$
uniformly in $t$ as $s\to \infty$ and $s'\to -\infty$.  In addition,  we assume
that for every multi-index $\alpha$ and  every  positive number $\varepsilon$,  there exists a number $s_0>0$ such that 
\begin{equation*}
\begin{aligned}
&\abs{D^{\alpha} (J^+(s,t)-J_0)}\leq \varepsilon&\quad &\text{for $s\geq s_0$}\\
&\abs{D^{\alpha} (J^-(s',t')-J_0)}\leq \varepsilon&\quad &\text{for $s'\leq -s_0.$}
\end{aligned}
\end{equation*}

Further, we assume that  the sequence $(a_k)$ of gluing parameters in $\hb \setminus \{0\}$ converges to $0$,
$$a_k\to 0\qquad \text{as $k\to \infty$}.$$
By $Z_{a_k}$ we denote the associated glued finite cylinders introduced in Section \ref{dm-subsect}
and by $Z_{a_k}(-r)$ the sub-cylinder 
$$Z_{a_k}(-r)=\{[ s,t]\in Z_{a_k}\vert \, r\leq s\leq R_k-r\},$$
where, as usual, $R_k=e^{\frac{1}{\abs{a_k}}}-e$.

In addition, we let $z\mapsto  J_k(z)$ be a smooth family of complex structures on ${\mathbb R}^{2n}$ parametrized by $z\in Z_{a_k}$.  We assume that the sequence $(J_k)$ converges to   $J=(J^+, J^-)$ on $Z_0=({\mathbb R}^+\times S^1)\cup ({\mathbb R}^-\times S^1)$ in the following sense. Recall that on every cylinder $Z_{a_k}$ we have  the two  distinguished   canonical holomorphic coordinates
$(s,t)\in [0,R_k]\times S^1$ and $(s',t')\in [-R_k,0]\times S^1$. 
Then,  
\begin{itemize}
\item[$\bullet$] given $m\geq 0$ and $\varepsilon>0$ and $r>0$, there  exists  $k_0$ such that
\begin{equation}\label{dalpha1}
\abs{D^{\alpha}(J_k([s,t])-J_0)}<\varepsilon
\end{equation}
for all $[s,t]\in Z_{a_k}(-r)$, all multi-indices  $\alpha$ satisfying $\abs{\alpha}\leq m$, and all $k\geq k_0$.    
\item[$\bullet$]
Moreover, for every $r>0$ and $m\geq 0$,  
\begin{align*}
&\text{ $J_k([s,t])\rightarrow J^+(s,t) \quad $  in $C^m([0,2r]\times S^1)$}\\
&\text {$J_k([s',t'])\rightarrow J^-(s',t') \quad $  in $C^m([-2r,0]\times S^1)$ }
\end{align*}
as $k\to \infty$.
\end{itemize}



With the sc-Hilbert  spaces  $E$ and $F$ of pairs $h=(h^+, h^-)$ of maps 
$h^\pm:\R^\pm \times S^1\to \R^{2n}$ defined in Section 2.4 
the following result holds true.
\begin{proposition}\label{ELLIPTIC-X}
Fix  a level $m\geq 0$.  We assume  that $(y_k)$ and  $(y_k')$  are sequences  in $F_m$  which converge   to $0$ and $(z_k)$, $(z_k')$ are  two  bounded sequences  in $F_{m+1}$.  Moreover, we assume that $(h_k)$, where $h_k=(h_k^+, h_k^- )$,  is   a bounded sequence in $E_m$ satisfying the equations
\begin{equation}\label{contbound1}
\begin{aligned}
\partial_s (\oplus_{a_k}(h_k))+ J_k\partial_t (\oplus_{a_k}(h_k))&=\wh{\oplus}_{a_k}(y_k)+\wh{\oplus}_{a_k}(z_k)\\
\ov{\partial}_0(\ominus_{a_k}(h_k)) &= \wh{\ominus}_{a_k}(y_k')+\wh{\ominus}_{a_k}(z_k').
\end{aligned}
\end{equation}
Then the following statement holds true. If $\alpha:{\mathbb R}^+\rightarrow \R$  is a   smooth function  which vanishes near $0$ and   is equal to $1$ outside of a compact set,  and if   the functions $\alpha^\pm:\R^\pm\to \R$ are  defined by  $\alpha^+(s)=\alpha(s)$  for $s\geq 0$ and $\alpha^-(s')=\alpha(-s')$ for $s'\leq 0$,  then the sequence 
$$(\alpha^+h^+_k, \alpha^-h^-_k)\in E_m$$
possesses a subsequence  which converges in $E_m$. 
\end{proposition}
\begin{proof}
We take  a  function $\alpha:\R^+\to \R$ having the properties as in the statement of the lemma. Since $\alpha$ is equal to $0$ near $0$, we extend $\alpha$  by $0$ on the negative half-line. By assumptions, there are two numbers $0<r_0<r_1$ such that 
$\alpha (s)=0$ for all $s\leq r_0$ and $\alpha (s)=1$ for all $s\geq r_1$.
We shall show that the sequence $(\alpha^+ h_k^+, \alpha^- h^-_k)$ possesses  a convergent subsequence in $E_m$. This will be done in  two steps. In the first step we shall show that   the sequences   $(\alpha^+h_k^+)$  and $(\alpha^-h_k^-)$ possess converging subsequences in  the spaces $H^{m+3}([0,r]\times S^1,{\mathbb R}^{2n})$ and $H^{m+3}([-r,0]\times S^1,{\mathbb R}^{2n})$ respectively for every $r>0$.  In the second step we then  show that  for  large $r>0$  the sequences $(\alpha^+h_k^+)$  and $(\alpha^-h_k^-)$ possess converging subsequences in  $H^{3+m,\delta_m}([r,\infty)\times S^1,{\mathbb R}^{2n})$ and $H^{3+m,\delta_m}((-\infty, -r]\times S^1,{\mathbb R}^{2n})$, respectively. 

In order to carry out the first step of the proof we choose  $r>r_1$ and introduce the function $\gamma:\R\to \R$ by 
$$
\gamma (s)=\alpha^+(s)\cdot \alpha^-(s-2r)
$$
for $s\in \R$.   


\begin{figure}[htbp]
\psfrag {1}{$1$}
\psfrag {0}{$0$}
\psfrag {r0}{$r_0$}
\psfrag {r1}{$r_1$}
\psfrag  {r}{$r$}
\psfrag  {r2}{$2r-r_1$}
\psfrag  {r3}{$2r-r_0$}
\psfrag {s}{$s$}
\psfrag {g}{$\gamma (s)$}
\centering
\includegraphics[width=4in]{Fig13.eps}
\caption{The graph of the function $\gamma$.}
\label{Fig13}
\end{figure}


We shall prove  that  $(\gamma h^+_k)$ has a converging subsequence in the space $H^{m+3}([0,2r]\times S^1,{\mathbb R}^{2n})$. Since $\gamma h^+_k=\alpha^+h^+_k$ on $[0,r]\times S^1$, this then  implies that 
the  sequence $(\alpha^+h^+_k)$ has a converging subsequence in $H^{m+3}([0,r]\times S^1,{\mathbb R}^{2n})$.  
{Clearly,  the product rule gives 
\begin{equation*}
\begin{split}
\gamma \cdot \partial_s (\oplus_{a_k}h_k)&=\partial_s (\gamma \oplus_{a_k}h_k)- (\partial_s\gamma)\cdot \oplus_{a_k}h_k\\
&=\partial_s (\gamma \oplus_{a_k}h_k)-\dot{\gamma}\cdot \oplus_{a_k}h_k.
\end{split}
\end{equation*}
}
{Now recalling that  $R_k=e^{\frac{1}{\abs{a_k}}}-e$,  so that $R_k\to \infty$ as $a_k\to 0$, we take $k$  so large that $2r<\frac{R_k}{2}-1$. Observing that for large values of $k$,  
$\oplus_{a_k} (h_k)=h^+_k$ on $[0,2r]\times S^1$, we compute, using   \eqref{contbound1}, 
\begin{equation*}
\begin{split}
&\partial_s ( \gamma h^+_k)+J_k \partial_t ( \gamma h^+_k)\\
&\phantom{====}=\gamma \bigl[ \partial_s h^+_k +J_k\partial_t h^+_k\bigr]+\dot{\gamma}h^+_k\\
&\phantom{====}=\gamma \bigl[ \partial_s (\oplus_{a_k}h_k)  +J_k\partial_t  (\oplus_{a_k}h_k)  \bigr]+\dot{\gamma}h^+_k\\
&\phantom{====}=\gamma \bigl[ \wh{\oplus}_{a_k}(y_k)+ \wh{\oplus}_{a_k}(z_k)  \bigr]+\dot{\gamma}h^+_k\\
&\phantom{====}=\gamma y_k^+  +\gamma  z_k^+ +\dot{\gamma}h^+_k.
\end{split}
\end{equation*}
}
Because  $\gamma (s)=0$ for $s\geq -r_0+2r$ we may  consider the maps $\gamma h^+_k$, $\gamma y^+_k$, $\gamma z^+_k$  and  $\dot{\gamma}h^+_k$ as  equal to $0$ for  $s\geq -r_0+2r$.  
The maps $h^+_k$ are of class $H^{3+m,\delta_m}$ and form a bounded  sequence  in the space $H^{3+m, \delta_m}(\R^+\times S^1, \R^{2n})$. Since they are supported in 
the finite cylinder $[0,2r]\times S^1$, the sequences $ \dot{\gamma}h^+_k$ and  $\gamma z^+_k$ are bounded in $H^{3+m, \delta_{m+1}}(\R^+\times S^1, \R^{2n})$. Hence 
the above equation becomes 
$$\partial_s ( \gamma h^+_k)+J_k \partial_t ( \gamma h^+_k)=\gamma y_k^++\rho_k$$
where the sequence $(\rho_k)$ is bounded in $H^{3+m, \delta_{m+1}}(\R^+\times S^1, \R^{2n})$ and the sequence $(\gamma y_k^+)$ converges in 
 $H^{2+m, \delta_m}(\R^+\times S^1, \R^{2n})$.

Moreover, the  maps $\gamma y^+_k$ and $\rho_k$ are supported in the finite cylinder 
$[0,2r]\times S^1$. 
If $h:\R^+\times S^1\to D\setminus \{0\}$ is the  holomorphic map defined by $h (s, t)=e^{-2\pi (s+it)}$, we denote its inverse  map by $\phi:
D\setminus \{0\}\to \R^+\times S^1$ and define $v_k(z)=\gamma\cdot  h^+_k\circ \phi (z)$. The maps  $v_k$  have their supports  contained in a  fixed closed annulus $A$ and satisfy the equations 
$$\partial_xv_k+\wt{J}_k\partial_y v_k=\ov{y}_k+\ov{\rho}_k$$
on $D\setminus \{0\}$, where the maps $\ov{y}_k$ and $\ov{\rho}_k$ have their supports  in $A$. 
Here the parameterized complex structures $\wt{J}_k$ are equal to $\wt{J}_k(x, y)=J_k(\phi (x, y))$. 
Extending all the maps involved by $0$, we rewrite the  equation as 
$$\partial_xv_k+J_0\partial_y v_k =\ov{y}_k+(J_0-\wt{J}_k)\partial_y v_k+\ov{\rho}_k.$$
In view of our assumption \eqref{dalpha1} on the  sequence  $(J_k)$  and in view of  the fact that the maps $(v_k)$ are supported  in a  fixed closed annulus $A\subset D\setminus \{0\}$, we conclude that 
$$(J_0-\wt{J}_k)\partial_y v_k\to 0$$
in $H^{2+m}(D)$ as $k\to \infty$.
Consequently, the sequence  of maps $\ov{y}_k+(J_0-\wt{J}_k)\partial_y v_k$ converges to $0$ in $H^{2+m}(D)$,  the  sequence $(\ov{\rho}_k)$ is bounded in $H^{3+m}(D)$, and the equation is satisfied on the whole disk $D$. By Proposition \ref{appx20}, the  sequence $(v_k)$ has a converging subsequence in $H^{3+m}(D)$ which in turn implies that $( \gamma h^+_k)$ has a converging subsequence in $H^{3+m, \delta_m}(\R^+\times S^1).$   Hence $(\alpha^+h^+_k)$ has a converging subsequence in $H^{m+3}([0,r]\times S^1,{\mathbb R}^{2n})$.  By  similar arguments,   the sequence $(\alpha^-h^-_k)$ possesses  a converging subsequence in $H^{m+3}([-r,0]\times S^1,{\mathbb R}^{2n})$. This finishes the first step of the proof.

In order to carry out the second step of the proof we introduce  for $\tau>0$ 
the shifted functions $\alpha_\tau^\pm:\R \to \R$ by
$$\alpha_\tau^+(s):=\alpha^+(s-\tau)\quad \text{and}\quad \alpha_\tau^-(s):=\alpha^-(s+\tau)$$
and  define   
for $k$ large the  sequence $(\alpha_k^\tau)$ of  functions $\alpha_k^\tau:[0, R_k]\to \R$  by 
\begin{equation*}
\alpha_k^\tau (s)=
\begin{cases}\alpha^+_\tau (s) \quad &\text{$0\leq s\leq \frac{R_k}{2}$}\\
\alpha^-_\tau (s-R_k)\quad &\text{$\frac{R_k}{2}\leq s\leq R_k$.}
\end{cases}
\end{equation*}



\begin{figure}[htbp]
\psfrag  {1}{\small{$1$}}
\psfrag  {0}{\small{$0$}}
\psfrag {r0}{\small{$r_0+\tau$}}
\psfrag  {r1}{\small{$r_1+\tau$}}
\psfrag  {r}{\small{$\frac{R_k}{2}$}}
\psfrag  {r2}{\small{$R_k-(r_1+\tau)$}}
\psfrag {r3}{\small{$R_k-(r_0+\tau)$}}
\psfrag {s}{\small{$s$}}
\psfrag {g}{\small{$\alpha_k^\tau (s)$}}
\centering
\includegraphics[width=4.1in]{Fig14.eps}
\caption{The graph of the function $\alpha_k^\tau $.}
\label{Fig14}
\end{figure}

We abbreviate 
$$\wt{h}_k=(\alpha^+_\tau h^+_k, \alpha^-_\tau h^-_k).$$
{Since $\alpha^+_\tau(s)=1$ for $R_k/2\leq s\leq R_k$ and 
$\alpha^-_\tau (s-R_k)=1$ for $0\leq s\leq R_k/2$ for $k$ large, we observe that 
$$\alpha_k^\tau (s)=\alpha^+_\tau (s) \alpha^-_\tau (s-R_k).$$ Moreover, 
$\alpha_\tau^-(s-R_k)\beta_{a_k}(s)=1$ for $s\leq \R_k/2+1$. Hence
$$\alpha_k^\tau(s)\beta_{a_k}(s)=\alpha^+_\tau (s)\alpha^-_\tau (s-R_k)\beta_{a_k}(s)=\alpha^+_\tau (s)\beta_{a_k}(s),$$
and similarly
$$\alpha_k^\tau(s)(1-\beta_{a_k}(s))=\alpha^-_\tau (s-R_k)(1-\beta_{a_k}(s)).$$
Then, using these identities and the formula for the gluing $\oplus_{a_k}$, we find that 
\begin{equation}\label{sigmaeq1}
\alpha_k^\tau \oplus_{a_k}(h_k) = \oplus_{a_k}(\wt{h}_k)
\quad \text{and}\quad \ominus_{a_k}(\wt{h}_k) =\ominus_{a_k}(h_k).
\end{equation}
}
From   the first equations in \eqref{contbound1} and in \eqref{sigmaeq1},  we  deduce 
\begin{equation}\label{contbound2}
\begin{split}
&\partial_s (\oplus_{a_k}(\wt{h}_k))+ {J}_k\partial_t (\oplus_{a_k}(\wt{h}_k))\\
&\phantom{====}=
\partial_s (\alpha_k^\tau \oplus_{a_k}(h_k) )+ {J}_k\partial_t (\alpha_k^\tau \oplus_{a_k}(h_k) )\\
&\phantom{====}=\alpha_k^\tau \bigl[\partial_s(\oplus_{a_k}(h_k))+J_k\partial_ t(\oplus_{a_k}(h_k))\bigr] +\dot{ \alpha}_k^\tau\oplus_{a_k}(h_k)\\
&\phantom{====}=\alpha_k^\tau \bigl[\wh{\oplus}_{a_k}(y_k)+\wh{\oplus}_{a_k}(z_k)\bigr]+\dot{ \alpha}_k^\tau\oplus_{a_k}(h_k)\\
&\phantom{====}=\wh{\oplus}_{a_k}(\alpha_\tau^+y_k^+,\alpha_\tau^-y_k^-)+
\wh{\oplus}_{a_k}(\alpha_\tau^+z_k^+, \alpha_\tau^-z_k^-)+\dot{ \alpha}_k^\tau\oplus_{a_k}(h_k).
\end{split}
\end{equation}
The support of $\dot{\alpha}^\tau_k$ lies in the intervals $[r_0+\tau, r_1+\tau]$ and $[R_k-(r_1+\tau), R_k-(r_0+\tau)]$.
We set  
$$r=r_1+\tau$$
and   introduce for large $k$ the maps 
$g_k^\pm:\R^\pm \times S^1\to \R^{2n}$, defined by $g_k^\pm =\dot{\alpha}^\pm_{\tau}\cdot h^\pm_k$ on $[0,2r]\times S^1$ and $[-2r,0]\times S^1$, respectively, and   $g_k^\pm=0$ for $s\geq 2r$  and $s'\leq -2r$, respectively. 
Since $h_k\in E_m$,  the maps $h_k^\pm$ are of class $H^{3+m}$ so that the functions $g_k=(g_k^+, g^-_k)$ belong to $F_{m+1}$.  Since all  the functions $g_k^\pm$ are supported in the fixed finite  cylinders $[0,2r]\times S^1$ and $[-2r,0]\times S^1$, the sequence  $(g_k)$ is also bounded in $F_{m+1}$. 
Moreover,  it satisfies the equations
\begin{equation*}
\begin{split}
\oplus_{a_k}(g_k)&=\beta_a\dot{\alpha}^+_{\tau}\cdot h^+_k+(1-\beta_a)\dot{\alpha}^-_{\tau}(\cdot -R_k)\cdot h^-_k(\cdot -R_k, t-\vartheta_k)\\
&=\dot{\alpha}_k^\tau\cdot \bigl[\beta_a( h^+_k+(1-\beta_a)\cdot h^-_k(\cdot -R_k, t-\vartheta_k)\bigr]\\
&=\dot{\alpha}_k^\tau\cdot \oplus_{a_k}(h_k).
\end{split}
\end{equation*}
Consequently,  abbreviating  
$$\wt{y}_k=(\alpha_\tau^+ \cdot y_k^+, \alpha_\tau^- \cdot y_k^-)\qquad \text{and}\qquad \wt{z}_k=
(\alpha_\tau^+ \cdot z_k^+, \alpha_\tau^- \cdot z_k^-)+g_k, $$
the equation \eqref{contbound2} becomes
\begin{equation}\label{roppp}
\begin{split}
\partial_s (\oplus_{a_k}(\wt{h}_k))+ {J}_k\partial_t (\oplus_{a_k}(\wt{h}_k))=\wh{\oplus}_{a_k}(\wt{y}_k)+\wh{\oplus}_{a_k}(\wt{z}_k).
\end{split}
\end{equation}
We note that the  sequences  $\wh{\oplus}_{a_k}(\wt{y}_k)$ and  $\wh{\oplus}_{a_k}(\wt{z}_k)$,   as well as the sequence $(\oplus_{a_k}(\wt{h}_k))$,  are supported in the sub-cylinder $Z_{a_k}(-r)$.  Therefore, we may extend them by $0$ outside of the  finite cylinders $Z_{a_k}$ and 
since the $J_k$ are  defined on $Z_{a_k}$ we may consider  the equations in \eqref{roppp} as equations on the whole infinite cylinder. Also, in view of  the properties of $(y_k)$, $(z_k)$, and $(g_k)$, the sequence $(\wt{y}_k)$ converges to $0$ in $F_m$ and $(\wt{z}_k)$ is bounded in $F_{m+1}$.


We choose $\tau$ so large that $r_0+\tau -(r_1-r_0)>0$ and observe that $\alpha_k^{\tau-(r_1-r_0)}=1$ for all $r\leq s\leq R_k-r$.  Moreover, the  support of $\alpha_k^{\tau-(r_1-r_0)}$ is contained in $(0, R_k)$. Since the support of $\oplus_{a_k}(\wt{h}_k)$ is contained in $Z_{a_k}(-r)$, we conclude that 
\begin{equation}\label{split1}
\begin{split}
&\partial_s (\oplus_{a_k}(\wt{h}_k))+ {J}_k\partial_t (\oplus_{a_k}(\wt{h}_k))\\
&\phantom{===}=
\partial_s(\oplus_{a_k}(\wt{h}_k))+  J_0\partial_t (\oplus_{a_k}(\wt{h}_k))+ \bigl(J_k-J_0\bigr)\partial_t(\oplus_{a_k}(\wt{h}_k))\\
&\phantom{===}=\partial_s(\oplus_{a_k}(\wt{h}_k))+  J_0\partial_t (\oplus_{a_k}(\wt{h}_k))+ \alpha_k^{\tau-(r_1-r_0)}\cdot \bigl(J_k-J_0\bigr)\partial_t(\oplus_{a_k}(\wt{h}_k)).
\end{split}
\end{equation}
We extend the maps $\alpha_k^{\tau-(r_1-r_0)}\cdot \bigl(J_k-J_0\bigr)$ by $0$ onto  the rest of the infinite cylinder $Z_{a_k}^*$, which by construction contains the finite cylinder $Z_{a_k}$. 
Therefore, introducing the operators 
$$
B_k:H^{3+m+i,-\delta_{m+i}}(Z_{a_k}^\ast,{\mathbb R}^{2n})\rightarrow H^{2+m+i,-\delta_{m+i}}(Z_{a_k}^\ast,{\mathbb R}^{2n})
$$
by 
\begin{equation}\label{opk1}
B_k := \ov{\partial}_0 +\alpha_k^{\tau-(r_1-r_0)}(J_k-J_0)\partial_t,
\end{equation}
the equation  \eqref{roppp}  becomes  
\begin{equation}\label{contbound0}
 B_k(\oplus_{a_k}(\wt{h}_k)) =\wh{\oplus}_{a_k}(\wt{y}_k)+\wh{\oplus}_{a_k}(\wt{z}_k).
\end{equation}
By Proposition \ref{POLTER},   
 the standard Cauchy-Riemann operator
$$
\ov{\partial}_0:H^{3+m+i,-\delta_{m+i}}(Z_{a_k}^\ast,{\mathbb R}^{2n})\rightarrow H^{2+m+i,-\delta_{m+i}}(Z_{a_k}^\ast,{\mathbb R}^{2n}),
$$
is a surjective Fredholm operator and 
there exists a constant $C>0$ such that 
\begin{equation}\label{es1}
\begin{split}
\frac{1}{C}\nr u-[u]_{a_k}\nr_{3+m+i,-\delta_{m+i}}^\ast&\leq \nr \ov{\partial}_0(u-[u]_{a_k})\nr_{2+m+i,-\delta_{m+i}}^\ast\\
&\leq C\nr u-[u]_{a_k}\nr^\ast_{3+m+i,-\delta_{m+i}}
\end{split}
\end{equation}
for $i=0, 1$ and for all $u\in H^{3+m+i,-\delta_{m+i}}(Z_{a_k}^\ast,{\mathbb R}^{2n})$. 
We will need an estimate for $\nr \alpha_k^{\tau-(r_1-r_0)}(J_k-J_0)\partial_t (u-[u]_{a_k})\nr_{2+m+i,-\delta_{m+i}}^\ast$ for $k$ sufficiently  large. 


\begin{lemma}\label{twoadd1}
\mbox{}
\begin{itemize}\label{addition1}
\item[{\em (1)}] Given $\varepsilon>0$, there is an integer $k_0$ such that  
$$\nr \alpha^{\tau-(r_1-r_0)}_k(J_k-J_0)(\partial_t u)\nr_{2+m+i,-\delta_{m+i}}^\ast\leq \varepsilon\nr u\nr_{3+m+i,-\delta_{m+i}}^*$$
for all $u\in H^{3+m+i,-\delta_{m+i}}(Z_{a_k}^*)$ and all $k\geq k_0$.
\item[{\em (2)}] 
There  exists $k_0$ such that for all $k\geq k_0$ the operators 
$$B_k:H^{3+m,-\delta_m}(Z_{a_k}^*, \R^{2n})\to H^{2+m,-\delta_m}(Z_{a_k}^*, \R^{2n})$$
are surjective Fredholm operators whose kernels consist of constant functions.  
\end{itemize}
\end{lemma}
\begin{proof}
(1)\, 
In view of our assumption on the sequence of almost complex structures, given $\varepsilon>0$, there exists $k_0$ such that 
\begin{equation}\label{add01}
\abs{D^\beta (J_k(s, t)-J_0)}\leq \varepsilon
\end{equation}
for all $s$ satisfying $r'_0:=r_0+\tau-(r_1-r_0)\leq s\leq R_k-r_0'$, for all $k\geq k_0$, and for all multi-indices $\beta$ satisfying  $\abs{\beta}\leq 3+m$.
We abbreviate by  $\Sigma_k$ the finite cylinders 
$$\Sigma_k=[ r_0', R_k-r_0']\times S^1.$$
Since 
$\alpha^\tau_k (s)=0$  for $s\leq r_0'$ and for $s\geq R_k-r_0'$ and the derivatives of $\alpha^\tau_k$ are bounded by a  constant independent of $k$ and $\tau$,  the square of the norm $\nr\alpha_k^{\tau-(r_1-r_0)} (J_k-J_0)(\partial_t u)\nr_{2+m+i,-\delta_{m+i}}^\ast$ is  bounded above by a constant $C$  (independent of $k$ and $\tau$) times 
the sum of  integrals of the form
\begin{equation*}
\int_{\Sigma_k}\abs{D^\beta (J_k(s, t)-J_0)}^2\abs{D^\gamma (\partial_tu)}^2e^{-2\delta_{m+i}\abs{s-\frac{R_k}{2}}}\ ds dt
\end{equation*}
where the multi-indices $\beta$ and $\gamma$ satisfy   $\abs{\beta}+\abs{\gamma}\leq 2+m+i$.
Using  \eqref{add01} we conclude that 
\begin{equation*}
\begin{split}
&\int_{\Sigma_k}\abs{D^\beta (J_k(s, t)-J_0)}^2\abs{D^\gamma (\partial_tu)}^2e^{-2\delta_{m+i}\abs{s-\frac{R_k}{2}}}\ ds dt\\
&\leq \varepsilon^2 \int_{\Sigma_k}\abs{D^\gamma (\partial_tu)}^2e^{-2\delta_{m+i}\abs{s-\frac{R_k}{2}}}\ ds dt
\leq  \varepsilon^2 ( \nr u\nr_{3+m+i,-\delta_{m+i}}^\ast )^2.
\end{split}
\end{equation*}
Consequently, 
$$\nr \alpha_k^{\tau-(r_1-r_0)} (J_k-J_0)(\partial_t u)\nr_{2+m+i,-\delta_{m+i}}^\ast\leq C\varepsilon'  \nr u\nr_{3+m+i,-\delta_{m+i}}^\ast.$$
This finishes the prove of the part (a) of the lemma.\\
(2)\,  By Proposition \ref{POLTER}, the operator  
$$
\ov{\partial}_0:H^{3+m+i,-\delta_{m+i}}(Z^*_{a_k})\to H^{2+m+i, -\delta_{m+i}}(Z^*_{a_k})
$$
 is a Fredholm operator whose index is equal to 
 $\text{ind} (\ov{\partial}_0)=2n$. Hence there exists $\varepsilon>0$ such that  if  $M:H^{3+m+i,-\delta_{m+i}}(Z^*_{a_k})\to H^{2+m,-\delta_m}(Z^*_{a_k})$ is a bounded linear operator whose operator norm is less than $\varepsilon$, then the  operator $\ov{\partial}_0+M$ is a  Fredholm operator having index  equal to $\text{ind}( \ov{\partial}_0+M)
 =\text{ind}( \ov{\partial}_0)=2n$.  In particular, introducing the operators   $M_k:H^{3+m+i,-\delta_{m+i}}(Z^*_{a_k})\to H^{2+m+i,-\delta_{m+i}}(Z^*_{a_k})$ by 
 $$M_k u:= \alpha_k^{\tau-(r_1-r_0)} (J_k-J_0)\partial_t (u),$$
 part (1) implies that for $k$ large  the operators $B_k=\ov{\partial}_0+M_k$ are Fredholm and $\text{ind} ( B_k)=2n$. If, in addition $\varepsilon <\frac{1}{2C}$ where $C$ is the constant in the estimate  \eqref{es1}, we conclude from  \eqref{es1} and  \eqref{opk1} that 
 \begin{equation}\label{es2}
\begin{split}
\frac{1}{2C}\cdot \nr u-[u]_{a_k}\nr_{3+m+i,-\delta_{m+i}}^\ast&\leq \nr B_k(u-[u]_{a_k})\nr_{2+m+i,-\delta_{m+i}}^\ast\\
&\leq 2C\cdot \nr u-[u]_{a_k}\nr^\ast_{3+m+i,-\delta_{m+i}}
\end{split}
\end{equation}
for $k$ sufficiently large. 
If $u$ belongs to the kernel of $B_k$, then the the above estimate implies that $u=[u]_{a_k}$ and since the constants belong to the  kernel $\ker (B_k)$ we conclude that the kernel consists of the constant functions. Since the Fredholm  index of $B_k$ is equal to the dimension of the constant functions, namely to  $\R^{2n}$, the operator $B_k$ is surjective. 
 This finishes the proof of the part (2) and hence  the proof of Lemma \ref{twoadd1}
\end{proof}
We continue with the  proof of  Proposition \ref{ELLIPTIC-X}.  
Using the second equation in \eqref{contbound1} and the second identity in \eqref{sigmaeq1}, we obtain 
\begin{equation}\label{contbound4}
\ov{\partial}_0(\ominus_{a_k}(\wt{h}_k) ) = \wh{\ominus}_{a_k}(y_k')+\wh{\ominus}_{a_k}(z_k').
\end{equation}

In view of Lemma \ref{twoadd1}  and Proposition  \ref{c-iso},  
we find   a unique map $\wh{f}_k$ belonging to $H^{3+m,-\delta_m}(Z^{\ast}_{a_k}, \R^{2n})$ having vanishing mean value,  $[\wh{f}_k]_{a_k}=0$,   and  a unique map $f_k\in H_c^{3+m,\delta_m}(C_{a_k}, \R^{2n})$ such that 
\begin{equation}\label{contbound10}
B_k (\wh{f}_k)=\wh{\oplus}_{a_k}(\wt{y}_k)\quad \text{and}\quad \ov{\partial}_0(f_k)=\wh{\ominus}_{a_k}(y_k').
\end{equation}
The map $\wh{f}_k$, if restricted to the finite cylinder  $Z_{a_k}$,  belongs to the space $H^{3+m}(Z_{a_k}, \R^{2n})$ so that the pair $(\wh{f}_k, f_k)$ belongs to the sc-space $G^{a_k}$ introduced in Section \ref{preliminaries}. 
By Theorem \ref{sc-splicing-thm},  the total gluing map $\boxdot_a:E\to G_a$ is an sc-isomorphism. Therefore, 
there exists a pair $h_{0,k}=(h_{0,k}^+, h_{0,k}^-)\in E_m$  satisfying 
$$\oplus_{a_k}(h_{0,k})=\wh{f}_k\quad \text{and}\quad \ominus_{a_k}(h_{0,k})=f_k.$$
Consequently, 
\begin{equation}\label{h0jeq}
B_k(\oplus_{a_k}(h_{0,k}) )=\wh{\oplus}_{a_k}(\wt{y}_k)\quad \text{and}\quad  \ov{\partial}_0( \ominus_{a_k}(h_{0,k}) )=\wh{\ominus}_{a_k}(y_k').
\end{equation}
In addition,  the averages $[h_{0,k}]_{a_k}$ are equal to 
\begin{equation*}
\begin{split}
[h_{0,k}]_{a_k}&=\frac{1}{2}\int_{S^1}\bigl[ h^+_{0,k}(R_k/2, t)+h^-_{0,k}(-R_k/2, t)\bigr]\ dt\\
&=\int_{S^1}\oplus_{a_k}(h_{0,k})(R_k/2, t)\ dt=
\int_{S^1}\wh{f}_k(R_k/2, t)\ dt=[\wh{f}_k]_{a_k}=0.
\end{split}
\end{equation*}
By similar arguments, we find  a sequence  $(h_{1,k})\subset  E_{m+1}$ satisfying 
\begin{equation}\label{h1jeq}
B_k(\oplus_{a_k}(h_{1,k}) )=\wh{\oplus}_{a_k}(\wt{z}_k)\quad \text{and}\quad  \ov{\partial}_0( \ominus_{a_k}(h_{1,k}) )=\wh{\ominus}_{a_k}(z_k')
\end{equation}
having vanishing averages, $[h_{1,k}]_{a_k}=0$.  We claim that 
$$\wt{h}_k=([\wt{h}_k]_{a_k}, [\wt{h}_k]_{a_k})+h_{0,k}+h_{1,k}.$$
Indeed, abbreviating  
$\rho_k=\wt{h}_k-([\wt{h}_k]_{a_k}, [\wt{h}_k]_{a_k})-h_{0,k}-h_{1,k}, $
we have  $[\rho_k]_{a_k}=0$ and, in view of equations  \eqref{roppp}, \eqref{h0jeq}, and \eqref{h1jeq}, we obtain 
\begin{equation}\label{h3jeq}
B_k(\oplus_{a_k}(\rho_k))=0\quad \text{and}\quad  \ov{\partial}_0( \ominus_{a_k}(\rho_k ))=0.
\end{equation}
From the second equation and Proposition \ref{c-iso} 
we conclude that  $\ominus_{a_k}(\rho_k )=0$. In view of the definition of  the anti-gluing $\ominus_{a_k}$, we conclude that $\rho_k^+(s, t)=0$ for $s\geq \frac{R_k}{2}+1$ and $\rho_k^-(s', t')=0$ for $s'\leq -\frac{R_k}{2}-1.$ Consequently, it follows from the definition of the gluing that $\oplus_{a_k}(\rho_k )(s, t)=0$ on  the finite cylinders $[0, R_k/2-1]\times  S^1]$ and $[R_k/2+1, R_k]\times S^1$ so that we can extend  the map $\oplus_{a_k}(\rho_k )$  by $0$ beyond the finite cylinders $Z_{a_k}$.  Hence $\oplus_{a_k}(\rho_k )\in H^{3+m,-\delta_m}(Z_{a_k}^\ast,{\mathbb R}^{2n})$ and 
$B_k(\oplus_{a_k}(\rho_k )=0$.  Now  Proposition \ref{POLTER} 
implies that $\oplus_{a_k}(\rho_k )=0$.  Since by Theorem \ref{sc-splicing-thm} the total gluing map $\boxdot_a:E\to G_a$ is an sc-isomorphism,  we conclude that indeed $\rho_k=0$  and our claim is proved.


 From now on we view  the maps $\oplus_{a_k}h_{i,k}$, $i=0,1$,   as defined on  the finite cylinders  $Z_{a_k}$. We shall use extensively the estimates for the global gluing constructions in  Proposition \ref{HAT_HAT} 
 and  Proposition  \ref{total-gluing}.
{First, recalling the $\wh{G}^{a_k}$-norm introduced in 
Section \ref{preliminaries}, we have the following estimates
\begin{align*}
e^{\delta_m \frac{R_k}{2} }\nr \wh{\oplus}_{a_k}(\wt{y}_k)\nr_{m+2,-\delta_m}
\leq |\wh{\boxdot}_a(\wt{y}_k) |_{\wh{G}^a_m}
\intertext{and}
e^{\delta_m\frac{R_k}{2} }\nr \wh{\ominus}_{a_k}(y_k) \nr_{m+2,\delta_m}
\leq |\wh{\boxdot}_a(y_k) |_{\wh{G}^a_m}.
\end{align*}
Hence, in view of Proposition \ref{HAT_HAT}, it  follows that 
 \begin{equation}\label{hatestimates1}
 e^{\delta_m\frac{R_k}{2}}\nr \wh{\oplus}_{a_k}(\wt{y}_k)\nr_{m+2,-\delta_m}\to 0\quad \text{and}\quad e^{\delta_m\frac{R_k}{2}}\nr \wh{ \ominus}_{a_k}(y_k)\nr_{m+2,\delta_m}\rightarrow 0.
\end{equation}
since the sequences  $(\wt{y}_k)$ and $(y_k)$ converge to $0$ in $F_m$.}
{
Now,  $[h_{0,k}]_{a_k}=0$ implies that $[\wh{\oplus}_{a_k}(h_{0,k}]_{a_k}=0$ and we conclude from \eqref{h0jeq}, using \eqref{es2}, \eqref{hatestimates1},   and 
Proposition \ref{c-iso}, that }
\begin{equation}\label{hatestimates2}
e^{\delta_m\frac{R_k}{2}}\nr \oplus_{a_k}(h_{0,k})\nr_{m+3,-\delta_m}\to 0\quad \text{and}\quad 
e^{\delta_mt\frac{R_k}{2}} \norm{ \ominus_{a_k} (h_{0,k} ) }_{H^{m+3,\delta_m}_c(C_{a_k},{\mathbb R}^{2n})}\to 0.
\end{equation}

Abbreviating by $c_k$ the asymptotic constants of the  maps $h_{0,k}$, it follows from the definition of the norm $\norm{\cdot}_{H^{m+3,\delta_m}_c(C_{a_k},{\mathbb R}^{2n})}$ and  from the second limit in \eqref{hatestimates2} that also $e^{\delta_m\cdot\frac{R_k}{2}}\cdot  c_k\to 0$.  Treating $c_k$ as constant functions  defined on the finite cylinders $Z_{a_k}$, we estimate 
$$\nr c_k\nr^2_{m+3,-\delta_m}=\abs{c_k}^2\int_{[0, R_k]}e^{-2\delta_m \abs{s-\frac{R_k}{2}}}\leq C^2\abs{c_k}^2.$$
We next compute the $G^{\alpha_k}$-norm of the pair $(\oplus_{a_k}(h_{0,k}), \ominus_{a_k}(h_{0,k}))$. 
 Using $[\oplus_{a_k}(h_{0,k})]_{a_k}=0$,  we have 
 \begin{equation*}\label{nh0j}
 \begin{split}
 &\abs{ (\oplus_{a_k}(h_{0,k}), \ominus_{a_k}(h_{0,k})}^2_{G^{a_k}_m}\\
 &=
 \abs{c_k}^2+e^{\delta_mR_k}\bigl[ \nr \oplus_{a_k}(h_{0,k})+c_k\nr^2_{m+3,-\delta_m}+
 \nr \ominus_{a_k}(h_{0,k})-[1-2\beta_{a_k}]\cdot c_k\nr^2_{m+3,\delta_m}\bigr].
 \end{split}
 \end{equation*}
 We already know that $\abs{c_k}\to 0$ and 
 \begin{equation*}
 \begin{split}
\nr \oplus_{a_k}(h_{0,k})+c_k\nr_{m+3,-\delta_m}&\leq \nr \oplus_{a_k}(h_{0,k})\nr_{m+3,-\delta_m}+ \nr c_k\nr_{m+3,-\delta_m}\\
&\leq   \nr \oplus_{a_k}(h_{0,k})\nr_{m+3,-\delta_m}+C\abs{c_k}
\end{split}
\end{equation*}
so that, in view of $e^{\delta_m\cdot\frac{R_k}{2}}\cdot  c_k\to 0$ and in view of the first limit in \eqref{hatestimates2}, we conclude 
$$ e^{\delta_mR_k}\nr \oplus_{a_k}(h_{0,k})+c_k\nr^2_{m+3,-\delta_m}\to 0.$$
The second limit in  \eqref{hatestimates2} implies the convergence
$$e^{\delta_m\cdot\frac{R_k}{2} }\cdot \nr \ominus_{a_k}(h_{0,k})-[1-2\beta_{a_k}]\cdot c_k\nr_{m+3,\delta_m}\to 0.$$
Summing up, we have proved that  $\abs{ (\oplus_{a_k}(h_{0,k}), \ominus_{a_k}(h_{0,k})}^2_{G^{a_k}_m}\to 0$.  Now  Proposition \ref{total-gluing}
 implies that $h_{0,k}$ converges to $0$ in $E_m$.  In a similar way, using the equations \eqref{h1jeq} and the fact that the  sequences 
$(\wt{z}_k)$ and $(z_k)$ are bounded, one shows that the sequence $(h_{1,k})$ is bounded in $E_{m+1}$. Since the sequence $(\wt{h}_k)$ is bounded, we conclude,  using the Sobolev embedding theorem, that 
the sequence of averages $([h_k]_{a_k})$ is bounded.  Hence,  the sequence 
 $\wt{h}_k$ admits the following decomposition
 $$
 \wt{h}_k = h_{0,k}+ \bigl( h_{1,k } +([\wt{h}_k]_{a_k},[\wt{h}_k]_{a_k}\bigr) =:h_{0,k} + h_{2,k}.
 $$
The sequence  $(h_{0,k})$ converges to $0$  in  $E_m$ and  the  sequence $(h_{2,k})$ is bounded in $E_{m+1}$. 
Since,   by the definition of the sc-structure,  the embedding $E_{m+1}\to E_m$ is compact,  we conclude that $( \wt{h}_k )$ possesses a convergent subsequence in $E_m$. This completes the proof of Proposition \ref{ELLIPTIC-X}.

\end{proof}
\section{Proof of Proposition \ref{XCX1}}\label{XCX10}
\noindent In this section we give a proof of Proposition \ref{XCX1}. 
We employ the notation $\eta=(\eta^+,\eta^-)$ and $\xi=(\xi^+, \xi^-)$. We start with  the map $B_\frac{1}{2}\oplus E\rightarrow F$, defined by  
$(a,\eta)\mapsto  D^a_{t}(\eta)$. The  pair $\xi:=D^a_{t}(\eta)$ is uniquely determined by the two equations
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi) &= \pt (\oplus_a\eta )\\
\wh{\ominus}_a(\xi)&=0.
\end{aligned}
\end{equation*}
Since $\pt (\oplus_a(\eta))= \wh{\oplus}_a(\pt\eta)$, the pair $\xi$  solves the  equations
\begin{equation}\label{xi1}
\begin{aligned}
\wh{\oplus}_a(\xi)&= \wh{\oplus}_a(\pt\eta)\\
\wh{\ominus}_a(\xi)&=0.
\end{aligned}
\end{equation}
Recalling the projection $\wh{\pi}_a:F\to F$  onto $\ker \wh{\ominus}_a$  along  $\ker \wh{\oplus}_a$ introduced in Section \ref{gluinganti-sect}, 
 we find that 
$$
\xi  =\wh{\pi}_a(\partial_t \eta ).
$$
The map 
$\pt:E\rightarrow F,$   defined by $\eta \mapsto \pt\eta $,  is an sc-operator,  so that for every $m$ there is 
a positive constant $C'_m$ such that 
\begin{equation}\label{pi1}
\abs{\pt\eta}_{F_m}\leq C_m' \cdot \abs{\eta}_{E_m}.
\end{equation}
for all  $\eta \in E_m$.   Moreover,  in view of Theorem 1.29 in \cite{HWZ8.7}, 
 the map 
$\wh{\pi}: \bt \oplus F\to F$, defined by $(a, h)\mapsto \wh{\pi}_a(h)$,  is 
sc-smooth. Consequently,  applying the chain rule for sc-smooth maps,  
the map  $\xi$ depends sc-smoothly  on $(a,\eta)$. 
With  the total hat-gluing $\wh{\boxdot}_a(h):=(\wh{\oplus}_a(h),\wh{\ominus}_a(h))$, the equations \eqref{xi1} can be written as 
$$\wh{\boxdot}_a(\xi)=(\wh{\oplus}_a(\pt \eta), 0).$$
Now applying the estimates of  Proposition \ref{HAT_HAT}  
and \eqref{pi1},   there is a constant $C_m$ independent of $a$ such  that the following estimate  holds, 
\begin{equation*}
\begin{split}
\abs{D^a_t(\eta)}_{F_m}&=\abs{\xi}_{F_m}
\leq C''_m \abs{\wh{\boxdot}_a (\xi)}_{\wh{G}_m^a}= 
C''_m \abs{(\wh{\oplus}_a(\pt \eta), 0)}_{\wh{G}_m^a}\\
&\leq C''_m \abs{(\wh{\oplus}_a(\pt \eta), \wh{\ominus}_a(\pt \eta))}_{\wh{G}_m^a}=
C_m''\abs{\wh{\boxdot}_a(\pt \eta)}_{\wh{G}_m^a}\\
&\leq C_m''' \abs{(\pt \eta)}_{F_m}\leq C_m\abs{(\eta^+,\eta^-)}_{E_m}.
\end{split}
\end{equation*}
We now turn to  the operator $D^a_s:E\to F$.  With $\xi=D_s^a(\eta)$, the pair $\xi$  solves the  equations 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi)& = \ps(\oplus_a(\eta))\\
 \wh{\ominus}_a(\xi)&=0.
\end{aligned}
\end{equation*}
The first equation  can be written as
\begin{equation*}
\wh{\oplus}_a(\xi)
=\wh{\oplus}_a(\ps \eta)+ \beta_a'(s)
\cdot [ \eta^+(s,t)-\eta^-(s-R,t-\vartheta)], 
\end{equation*}
where $\beta_a(s)=\beta \bigl(s-\frac{R}{2}\bigr).$
To prove that the  map $(a,\eta)\mapsto  D^a_{t}(\eta)$ is sc-smooth, we introduce  the solution  $\xi_1:=(\xi^+_1, \xi^+_1)$  of the equations 
\begin{equation}\label{sy1}
\begin{aligned}
\wh{\oplus}_a(\xi_1)(s, t)&=\beta'_a(s)(\eta^+(s,t)-\eta^-(s-R,t-\vartheta))\\
 \wh{\ominus}_a(\xi_1)(s,t)&=0
\end{aligned}
\end{equation}
so that 
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi-\xi_1)&=\wh{\oplus}_a(\ps \eta) \\
\wh{\ominus}_a(\xi-\xi_1)&=0.
\end{aligned}
\end{equation*}
Using  again the fact that $\wh{\pi}_a$ is a projection 
onto $\ker \wh{\ominus}_a$  along  $\ker \wh{\oplus}_a$, we find 
\begin{equation}\label{de1}
\xi-\xi_1=\wh{\pi}_a(\ps \eta).
\end{equation}
Hence the map $B_{\frac{1}{2}}\oplus E\to F$, defined by 
$$\bigl(a, \eta)\mapsto \xi-\xi_1,$$ 
is sc-smooth as a compositions of sc-smooth maps $\ps:E\to F$, $\eta\mapsto  \ps \eta$,  and  $B_{\frac{1}{2}}\oplus E\to E$, $\bigl(a, h\bigr)\mapsto \wh{\pi}_a (h)$. 
To show that the map $(a, \eta)\mapsto \xi_1$ is sc-smooth, we  write  the system \eqref{sy1} in matrix form 
\begin{equation*}
\begin{bmatrix}\beta_a&1-\beta_a\\
\beta_a-1&\beta_a\end{bmatrix}\cdot \begin{bmatrix}\xi_1^+(s, t)\\ \xi_1^-(s-R,t-\vartheta)
\end{bmatrix}=\begin{bmatrix}f(s, t)\\0\end{bmatrix},
\end{equation*}
where we have abbreviated $\beta_a=\beta_a(s)$ and $f(s,t)=\beta'_a(s)(\eta^+(s,t)-\eta^-(s-R,t-\vartheta))$. 
Introducing the  determinant $\gamma_a(s)=\beta_a^2(s)+(1-\beta_a)^2(s)$  of the matrix on the left hand side and multiplying both sides by the inverse of this matrix we arrive at the formula
\begin{equation*}
\begin{bmatrix}\xi_1^+(s, t)\\ \xi_1^-(s-R,t-\vartheta)\end{bmatrix}=\frac{1}{\gamma_a}
\begin{bmatrix}\beta_a&\beta_a-1\\
1-\beta_a&\beta_a\end{bmatrix}\cdot \begin{bmatrix}f(s,t)\\ 0\end{bmatrix}.
\end{equation*}
From this formula we read off the formulae for $\xi_1^+$ and $\xi_1^-$,
\begin{equation*}
\begin{split}
\xi_1^+(s, t)&=
 \frac{\beta_a\beta'_a}{\gamma_a}(s)\cdot [ \eta^+(s,t) -\eta^-(s-R,t-\vartheta)] \\
&= \frac{\beta_a\beta'_a}{\gamma_a}(s)\cdot [r^+(s,t) -r^-(s-R,t-\vartheta)]
\end{split}
\end{equation*}
and 
\begin{equation*}
\begin{split}
\xi_1^-(s-R, t-\vartheta)&=\frac{(1-\beta_a)\beta_a}{\gamma_a}(s)\cdot 
 [ \eta^+(s,t) -\eta^-(s-R,t-\vartheta)] \\
&=\frac{(1-\beta_a)\beta_a}{\gamma_a}(s)\cdot [r^+(s,t) - r^-(s-R,t-\vartheta)],
\end{split}
\end{equation*}
where we have decomposed  the maps  $\xi_1^\pm$ as $\xi_1^\pm =c+r^\pm$. Here $c$ is  the common asymptotic  constant of $\xi_1^\pm$. 
In view of Proposition 2.17  in \cite{HWZ8.7}, 
 the map
$\Phi:B_\frac{1}{2}\oplus E\rightarrow F$,  defined by 
$$
(a,\eta)\mapsto \begin{cases}\xi_1&\quad \text{$a\neq 0$}\\
0&\quad \text{$a=0$,}
\end{cases}
$$
is sc-smooth.   Summing up,  we have proved that the map 
$\bigl(a, \eta)\mapsto \xi$ is sc-smooth. 

To obtain the desired estimate, we first note that for every level $m$ there is a positive constant $C'_m$ such that 
\begin{equation}\label{pi2}
\abs{\ps \eta}_{F_m}\leq C'_m\cdot \abs{\eta}_{E_m}
\end{equation}
for all pairs $\eta\in E_m$. 
Writing the equation \eqref{sy1}  as 
$$\wh{\boxdot}_a(\xi-\xi_1)=(\wh{\oplus}_a(\ps \eta), 0)$$
and applying the estimates of  Proposition \ref{HAT_HAT}  
and \eqref{pi2}, we find  a constant $C_m$ independent of $a$ so that the following estimate  holds, 
\begin{equation}\label{ps2}
\begin{split}
\abs{\xi-\xi_1}_{F_m}&\leq C''_m \abs{\wh{\boxdot}_a (\xi-\xi_1)}_{\wh{G}_m^a}= C''_m \abs{\bigl(\wh{\oplus}_a(\ps \eta), 0\bigr)}_{\wh{G}_m^a}\\
&\leq C''_m \abs{(\wh{\oplus}_a(\ps \eta), \wh{\ominus}_a(\ps \eta)}_{\wh{G}_m^a}\\
&=
C_m''\abs{\wh{\boxdot}_a(\ps \eta)}_{\wh{G}_m^a}
\leq C_m'''\abs{\ps \eta}_{F_m}\\
&\leq C_m\abs{\eta}_{E_m}.
\end{split}
\end{equation}
In order to obtain similar estimates for $\xi_1$, we use  the fact that  the map $\Phi$ is, in particular, of class $\ssc^0$.
Hence, given  the level $m$, there exists  $\delta>0$ such  that
$|\eta|_{E_m}\leq \delta$ and $|a|\leq \delta$ implies  $|\Phi(a,\eta)|_{F_m}\leq 1$.
Since $\Phi (a, \cdot )$ is linear, we conclude that 
$$
|\Phi (a,\eta )|_{F_m}\leq \delta^{-1}\cdot |\eta |_{E_m}
$$
for $|a|\leq \delta$ and $\eta \in E_m$.   Moreover,   it follows from the formulae for $\xi_1^\pm$  that there exists a positive constant $C_m''>\delta^{-1}$ for which  
$$
|\Phi(a,\eta)|_{F_m}=|\xi_1|_{F_m}\leq C_m''\cdot | r |_{F_m}\leq C_m'' \cdot |\eta |_{E_m}
$$
for every $a$ satisfying  $\delta \leq |a|<\frac{1}{2}$ and for all $\eta \in E_m$. 
Combining   the estimate \eqref{ps2} with the above estimates,  we find a constant $C_m$ independent of $a$ such that 
$$
|D^a_s(\eta)|_{F_m}=\abs{\xi}_{F_m}\leq C_m\cdot |\eta|_{E_m}
$$
for all $\eta\in E_m$. 


We next discuss the operators $C^a_s, C^a_t:E\to F$. Setting $C_t^a(\eta)=\xi$, the map $\xi$  satisfies  the equations
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi)&=0\\
\wh{\ominus}_a(\xi)&=\partial_t (\ominus_a(\eta)).
\end{aligned}
\end{equation*}
Solving for $\xi=(\xi^+, \xi^-)$, we find 
\begin{equation}\label{cat}
\begin{split}
\xi^+(s, t)&=\frac{\beta_a-1}{\gamma_a}(s)\cdot \partial_t(\ominus_a (\eta))(s, t)\\
&=\frac{(\beta_a-1)^2}{\gamma_a}(s)\cdot \partial_t \eta^+(s, t)+\frac{\beta_a(\beta_a-1)}{\gamma_a}(s)\cdot \partial_t\eta^-(s-R, t-\vartheta)
\end{split}
\end{equation}
and
\begin{equation*}
\begin{split}
\xi^-(s-R, t-\vartheta)=\frac{\beta_a(\beta_a-1)}{\gamma_a}(s)\cdot\partial_t \eta^+(s, t)+\frac{\beta_a^2}{\gamma_a}(s)\cdot \partial_t \eta^-(s-R, t-\vartheta).
\end{split}
\end{equation*}
The map $E\to F$, defined by $\eta\mapsto \partial_t\eta$, is sc-smooth.  Also, in view of Proposition 2.8  in  \cite{HWZ8.7}, the maps 
$\hb \oplus F\to F$, defined by 
$$(a, \eta)\mapsto \frac{(\beta_a-1)^2}{\gamma_a}(s)\cdot \eta^+(s, t)\qquad \text{and}\qquad 
(a, \eta)\mapsto \frac{\beta_a^2}{\gamma_a}(s)\cdot \eta^-(s-R, t-\vartheta),$$
are sc-smooth.  Hence, by the chain rule, the map $\hb\times E\to H^{2,\delta_0}(\R^+\times S^1)$, $(a, \eta)\mapsto \xi^+$ is sc-smooth. The same conclusion holds for the map $\hb\times E\to H^{2,\delta_0}(\R^-\times S^1)$ given by  $(a, \eta)\mapsto \xi^-$. Summing up, 
the map $\hb\times E\to F$, $(a, \eta)\mapsto \xi$ is sc-smooth.  

We finally consider the map 
$\hb\oplus E\to F$, defined by $(a, \eta)\mapsto C_s^a(\eta)$. Setting $\xi=C_s^a(\eta)$, the map $\xi$ solves the following two equations,
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi)&=0\\
\wh{\ominus}_a(\xi)&=\partial_s (\ominus_a(\eta)).
\end{aligned}
\end{equation*}
We obtain for the pair $\xi=(\xi^+, \xi^-)$ the  formulae
\begin{equation*}
\begin{split}
\xi^+(s, t)&=\frac{\beta_a-1}{\gamma_a}(s)\cdot \wh{ \ominus}_a (\partial_s\eta )(s, t)\\
&\phantom{==}+\frac{(\beta_a-1)\beta_a'}{\gamma_a}\cdot \bigl(\eta^+(s, t)-\av_a (\eta)\bigr)\\
&\phantom{==}+\frac{(\beta_a-1)\beta_a'}{\gamma_a}\cdot \bigl(\eta^-(s-R, t-\vartheta)-\av_a (\eta)\bigr)
\end{split}
\end{equation*}
and an analogous expression for $\xi^-(s-R, t-\vartheta)$. 
The average $\av_a (\eta)$ is the  number 
$$\av_a (\eta):=\frac{1}{2}\biggl( \int_{S^1}\eta^+\Bigl(\frac{R}{2}, t\Bigr)\ dt+ \int_{S^1}\eta^-\Bigl(-\frac{R}{2}, t\Bigr)\ dt\biggr).$$
The  map $\hb \times E\to F$, 
$$(a, \eta)\mapsto \frac{\beta_a-1}{\gamma_a}\cdot \wh{ \ominus}_a (\partial_s\eta))$$
is sc-smooth by the same argument as above. 
In view of the results in  Section 2.4 of  \cite{HWZ8.7},  the maps 
\begin{equation*}
\begin{aligned}
(a, \eta^+)&\mapsto \frac{(\beta_a-1)\beta_a'}{\gamma_a}\cdot \bigl(\eta^+ -\av_a (\eta)\bigr)\\
(a, \eta^-)&\mapsto \frac{(\beta_a-1)\beta_a'}{\gamma_a}\cdot \bigl(\eta^-(s-R, t-\vartheta)-\av_a (\eta)\bigr)
\end{aligned}
\end{equation*}
from $\hb\oplus H^{3,\delta_0}(\R^+\times S^1)$ to $H^{3,\delta_0}(\R^+\times S^1)$ and from  $\hb\oplus H^{3,\delta_0}(\R^-\times S^1)$ to $H^{3,\delta_0}(\R^-\times S^1)$, respectively, are sc-smooth.  The same arguments apply to the component $\xi^-$.  Therefore,   the map  $\hb\times E\to F$, $(a, \eta)\mapsto \xi$ is sc-smooth. The desired estimates follow from the formulae for the components of the maps 
$(a, \eta)\mapsto C^a_t(\eta)$ and $(a, \eta)\mapsto C^a_s(\eta)$.  This completes the proof of 
Proposition  \ref{XCX1}. \hfill $\blacksquare$

\section{Banach Algebra Properties}\label{XCX19} 
Our aim is to prove the following Banach algebra properties  for the Banach spaces  $H^{m,\delta} (\R^+\times S^1)$ and $H_{\textrm{c}}^{m,\delta} (\R^+\times S^1)$  equipped with the norms
$$\norm{f}_{m, \delta}^2= \sum_{ \abs{\alpha}\leq m}\int_{\R^+\times S^1}\abs{ D^{\alpha}f(s, t) }^2e^{2\delta s}\  dsdt$$
for $f\in H^{m,\delta} (\R^+\times S^1)$ and 
$$\norm{g}_{m, \delta}^2=\abs{c}^2+\sum_{ \abs{\alpha}\leq m}\int_{\R^+\times S^1}\abs{ D^{\alpha}( g(s, t) -c)}^2e^{2\delta s}\  dsdt$$
for $g\in H_{\textrm{c}}^{m,\delta} (\R^+\times S^1)$, where $c$ is the asymptotic constant. 

\begin{theorem}\label{balgebra}
For $m\geq 3$ and $2\leq k\leq m$ and $0\leq  \sigma\leq \delta$, there exists a constant $C$ such that  
$$\norm{f\cdot g}_{k,\delta}\leq C\norm{f}_{m,\delta}\cdot \norm{g}_{k,\sigma}$$
for all $f\in H^{m,\delta}(\R^+\times S^1)$ and $g\in H^{k,\sigma}(\R^+\times S^1)$. Moreover,  
\begin{itemize}
\item[{\em (1)}] If $m\geq 3$ and $2\leq k\leq m$ and $0\leq \delta$,  
$$\norm{f\cdot g}_{k,\delta}\leq C\norm{f}_{H_c^{m,\delta}(\R^+\times S^1)}\cdot  \norm{g}_{k,\delta}$$
for all $f\in H_c^{m,\delta}(\R^+\times S^1)$ and all $g\in H^{k,\delta}(\R^+\times S^1)$.
\item[{\em (2)}] If $k\geq 3$ and $\delta>\sigma\geq 0$, then 
$$\norm{f\cdot g}_{k,\delta}\leq C\norm{f}_{H_c^{k,\sigma}(\R^+\times S^1)}\cdot  \norm{g}_{k,\delta}$$
for all $f\in H_c^{k,\sigma}(\R^+\times S^1)$ and all $g\in H^{k,\delta}(\R^+\times S^1)$.
\end{itemize}
\end{theorem}
\begin{proof}
We first assume that $k\geq 3$.  Then the square of the norm $\norm{f\cdot g}_{k,\sigma}$ is bounded by some constant  times the sum of integrals of the form 
\begin{equation}\label{intba1}
\int_{\R^+\times S^1}\abs{D^\alpha f}^2\abs{D^\beta g}^2\cdot e^{2\sigma s}
\end{equation}
where the multi-indices $\alpha$ and $\beta$ satisfy $\abs{\alpha}+\abs{\beta}\leq k$.  Then, since $k\geq 3$, either $\abs{\alpha}\leq k-2$ or $\abs{\beta}\leq k-2$. We assume that $\abs{\alpha}\leq k-2$.  Since $e^{\delta \cdot }f$ belongs to $H^{k}$, it follows from the Sobolev embedding theorem that 
$\max_{0\leq \abs{\alpha}\leq k-2} \abs{D^{\alpha} (e^{\delta \cdot} f )}_{L^\infty(\R^+\times S^1)}\leq C'\norm{e^{\delta \cdot }f}_{H^k}\leq C\norm{f}_{k,\delta}$ for some constant $C$. In particular, we conclude that $\abs{e^{\delta \cdot}D^{\alpha}f}_{L^\infty(\R^+\times S^1)}\leq C\norm{f}_{k,\delta}$ for all multi-indices $\alpha$ satisfying 
$\abs{\alpha}\leq k-2$. 
Hence, if $\abs{\alpha}\leq k-2$, we obtain the estimate
\begin{equation*}
\begin{split}
\int_{\R^+\times S^1}\abs{D^\alpha f}^2\abs{D^\beta g}^2\cdot e^{2\delta s}
&\leq C^2\norm{f}^2_{k,\delta}\cdot \int_{\R^+\times S^1}\abs{D^\beta g}^2\leq C^2\norm{f}_{k,\delta}^2\cdot \norm{g}^2_{k,\sigma}\\
&\leq 
C^2\norm{f}_{m,\delta}^2\cdot \norm{g}^2_{k,\sigma}
\end{split}
\end{equation*}
since $m\geq k$.  If  the multi-index $\beta$ satisfies $\abs{\beta}\leq k-2$,  then the derivative $D^\beta g$ belongs to $H^{k-\abs{\alpha}}\subset H^2$  so that, in view of the Sobolev embedding  theorem,  $\abs{D^\beta g}_{L^\infty (\R^+\times S^1)}\leq  C\norm{g}_{k,\sigma}$, and hence 
$$
\int_{\R^+\times S^1}\abs{D^\alpha f}^2\abs{D^\beta g}^2\cdot e^{2\delta s}
\leq C^2\norm{g}^2_{k,\sigma}\cdot \int_{\R^+\times S^1}\abs{D^\alpha f}e^{2\delta s}\leq C^2\norm{f}_{m,\delta}^2\cdot \norm{g}^2_{k,\sigma}. 
$$
Next we consider the  remaining case  $k=2$ and $m\geq 3$. 
Then the multi-indices $\alpha$ and $\beta$ in \eqref{intba1} satisfy  $|\alpha|+|\beta|\leq 2$.
Since $m\geq 3$, it follows as before that 
$\max_{\abs{\alpha}\leq 1}\abs {e^{\delta \cdot }D^{\alpha}f}_{L^\infty (\R^+\times S^1)}\leq C\norm{f}_{m,\delta}$ and we conclude for the multi-indices $\abs{\alpha}\leq 1$ that 
\begin{equation*}
\begin{split}
&\int_{\R^+\times S^1}\abs{f}^2\cdot |D^\beta g|^2\cdot e^{2\delta s}\leq  C^2\norm{f}^2_{m,\delta}\int_{\R^+\times S^1} |D^\beta g|^2\leq C^2\norm{f}^2_{m, \delta}\cdot \norm{g}^2_{k,\sigma}.
\end{split}
\end{equation*}
If $\abs{\alpha}=2$ so that $\beta=0$,  then, in view of the Sobolev embedding theorem applied to $g\in H^{2}$, we can   estimate 
 $\abs{g}_{L^\infty (\R^+\times S^1)}\leq C\norm{g}_{k,\sigma}$,  and obtain
\begin{equation*}
\begin{split}
\int_{\R^+\times S^1}\abs{D^\alpha f }^2\cdot \abs{g}^2\cdot e^{2\delta s}\leq  C^2\norm{g}^2_{k,\sigma}\int_{\R^+\times S^1} \abs{D^\alpha f}^2e^{2\delta s}\leq C^2\norm{f}^2_{m, \delta}\cdot \norm{g}^2_{k,\sigma}.
\end{split}
\end{equation*}
In order to  prove the statements (1) and (2), we split $f=c+r$ where $c$ is the asymptotic constant and $r$ belongs to $H^{m,\delta}(\R^+\times S^1)$ in case (1) and to $H^{k,\sigma}(\R^+\times S^1)$ in case (2). Since  in both cases $g\in H^{k,\delta}(\R^+\times S^1)$, we have $cg\in  H^{k,\delta}(\R^+\times S^1)$ and, in  view of the previous part,  also $rg\in H^{k,\delta}(\R^+\times S^1)$.  Recalling that $\norm{g}^2_{H_c^{k,\delta} (\R^+\times S^1)}=\abs{c}^2+\norm{r}^2_{k,\delta}$, we estimate in case (1),
\begin{equation*}
\begin{split}
\norm{fg}_{k,\delta}&=\norm{cg+rg}_{k,\delta}\leq \abs{c}\cdot \norm{g}_{k,\delta}+\norm{rg}_{k,\delta}\\
&\leq  \abs{c}\cdot \norm{g}_{k,\delta}+C\norm{r}_{m,\delta}\cdot \norm{g}_{k,\delta}\leq 2C\norm{f}_{H_c^{k,\delta}(\R^+\times S^1)}\cdot \norm{g}_{k,\delta}, 
\end{split}
\end{equation*}
and in case (2),
\begin{equation*}
\begin{split}
\norm{fg}_{k,\delta}&=\norm{cg+rg}_{k,\delta}\leq \abs{c}\cdot \norm{g}_{k,\delta}+\norm{rg}_{k,\delta}\\
&\leq  \abs{c}\cdot \norm{g}_{k,\delta}+C\norm{r}_{k,\sigma}\cdot \norm{g}_{k,\delta}\leq 2C\norm{f}_{H_c^{k,\sigma}(\R^+\times S^1)}\cdot \norm{g}_{k,\delta}, 
\end{split}
\end{equation*}
The proof of Theorem \ref{balgebra} is complete.
\end{proof}
\section{Proof of Proposition \ref{XCX2}}\label{XCX20}
We recall that,  given a smooth map $A:\R^{N}\to \call (\R^K, \R^M)$, the map 
$\wt{A}:\hb\oplus E^{(N)}\oplus F^{(K)}\to F^{(M)}$, $(a, u, \eta)\mapsto \xi=\wt{A}(a, u,\eta)$,  is defined as the unique solution of the  equations
\begin{equation}\label{ainduced}
\begin{aligned}
\wh{\oplus}_a(\xi) (s,t)&= A\bigl(\oplus_a (u)(s,t)\bigr) \cdot \wh{\oplus}_a  (\eta) (s,t)\\
\wh{\ominus}_a(\xi)(s,t)&=0,
\end{aligned}
\end{equation}
for $[(s, t)]\in Z_a$ where we have abbreviated $u=(u^+, u^-)\in E^{(N)}$, $\eta=(\eta^+, \eta^-)\in F^{(K)}$, and $\xi=(\xi^+, \xi^-)\in F^{(M)}$.  Here the spaces are defined as follows. 
The sc-Hilbert  space $E^{(N)}$ consists of pairs $(u^+, u^-)$ belonging to $H_c^{3,\delta_0}(\R^+\times S^1, \R^N)\oplus 
H_c^{3,\delta_0}(\R^-\times S^1, \R^N)$ having common asymptotic constants as $s\to \pm\infty$ and  the sc-Hilbert space $F^{(K)}$ is the space $H^{2,\delta_0}(\R^+\times S^1, \R^K)\oplus H^{2,\delta_0}(\R^+\times S^1, \R^K)$.  We also point out that in view of  the  second equation and the properties of  the  function $\beta_a$, we conclude $\xi^+(s, t)=0$ for  $s\geq \frac{R}{2}+1$ and $\xi^-(s', t')=0$ for $s'\leq -\frac{R}{2}-1$.  

Without loss of generality we may assume that $N=K=M=1$ so that $A:\R\to \R$ is a smooth function. We also drop the  superscript from $E^{(1)}$ and $F^{(1)}$ and   write  instead simply $E$ and $F$, respectively.  \\[1ex]
{\bf (1).} \   In order to prove the first  statement in Proposition \ref{XCX2}, we derive a  formula for  $\wt{A}\bigl(a, u, \eta\bigr)=\xi\in F$. Abbreviating  $\beta_a=\beta_a(s)$  and 
$$u_a=\oplus_a(u)\quad \text{and}\quad \eta_a=\wh{\oplus}_a(\eta),$$
 we write  the equations \eqref{ainduced}  in matrix form as 
\begin{equation*}
\begin{bmatrix}\beta_a&1-\beta_a\\
\beta_a-1&\beta_a\end{bmatrix}\cdot \begin{bmatrix}\xi^+(s, t)\\ \xi^-(s-R,t-\vartheta)
\end{bmatrix}=\begin{bmatrix}A(u_a(s,t)) \cdot   \eta_a(s,t)\\ 0\end{bmatrix}. 
\end{equation*}
With $\gamma_a(s)=\beta_a^2(s)+(1-\beta_a)^2(s)$ denoting the  determinant  of the matrix on the left hand side and multiplying both sides by the inverse of this matrix,  we arrive at the formula %
\begin{equation*}
\begin{bmatrix}\xi^+(s, t)\\ \xi^-(s-R,t-\vartheta)\end{bmatrix}=\frac{1}{\gamma_a}
\begin{bmatrix}\beta_a&\beta_a-1\\
1-\beta_a&\beta_a\end{bmatrix}\cdot \begin{bmatrix}  A(u_a(s,t)) \cdot   \eta_a(s,t)  \\ 0\end{bmatrix}.
\end{equation*}
The formulae for $\xi^+$ and $\xi^-$ are 
\begin{equation*}
\begin{split}
\xi^+(s, t)=
 \frac{\beta_a}{\gamma_a}(s)\cdot f(s,t)= \frac{\beta_a}{\gamma_a}(s)\cdot A\bigl(u_a(s,t)\bigr) \cdot \eta_a(s,t)
\end{split}
\end{equation*}
and $\xi^+(s, t)=0$ for $s\geq \frac{R}{2}+1$, and 
\begin{equation*}
\begin{split}
\xi^-(s-R, t-\vartheta)=\frac{1-\beta_a}{\gamma_a}(s)
\cdot A\bigl(u_a(s,t)\bigr) \cdot \eta_a(s,t)
\end{split}
\end{equation*}
and $\xi^-(s-R, t-\vartheta)=0$ for $s\leq \frac{R}{2}-1$.  
Our aim is to prove  that for $i=0, 1$ the map $\hb\oplus E\oplus F^i\to F^i$, 
$$(a, u, \eta)\mapsto  \xi,$$
is sc-smooth. To do this we  consider the formula for $\xi^+$. 
We  introduce the map $f:\hb\oplus F^i\to H^{2+i,\delta_i}(\R^+\times S^1)$, defined for $a\neq 0$  by 
\begin{equation}\label{phieta1}
\begin{split}
f(a, \eta)(s, t)=\frac{\beta_a}{\gamma_a}(s)\cdot \wh{\oplus}_a(\eta)(s, t)
\end{split}
\end{equation}
where $(s, t)\in \R^+\times S^1$. If $a=0$,  we define 
$f(0, \eta)(s, t)=\eta^+(s, t)$ for $(s, t)\in \R^+\times S^1$.
 We  point out   that if $a\neq 0$, then 
  $$f (a, \eta)(s, t)=0\quad \text{for $s\geq \frac{R}{2}+1.$}$$
 Decomposing $u^\pm=c+r^\pm$ where $c$ is the common asymptotic constant of the maps $u^\pm$,  the glued map $\oplus_a (u)$ is, in view of Section 2.4 of \cite{HWZ8.7},  given  by 
 \begin{equation*}
 \oplus_a(u)(s, t)=c+\oplus_a(r)(s, t)
 \end{equation*}
where $0\leq s\leq R$ and where $r=(r^+, r^-)$. 
Next we introduce  the map $g:  \hb\times H_c^{3,\delta_0}(\R^+\times S^1)\to H^{3,\delta_0}(\R^+\times S^1)$,  defined by 
\begin{equation}\label{g1}
g(a, u)(s, t)=c+\beta_a(s-2)\cdot \oplus_a(r)(s, t), 
\end{equation}
if $a\neq 0$. If $a=0$, we set $g(0, u)=c+r^+=u^+$.
We note that $g(a,u)(s, t)=0$ for $s\geq \frac{R}{2}+3$ and $\oplus_a(u)(s, t)=g(a, u)(s, t)$ for $s\leq \frac{R}{2}+1$ since $\beta_a(s-2)=1$ for $s\leq \frac{R}{2}+1$.
Since $f (a, \eta)(s, t)=0$ for $s\geq  \frac{R}{2}+1$, we therefore find that 
$$\xi^+(s, t)=A(g(a,u)(s, t))\cdot f(a, \eta)(s, t)$$
if $a\neq 0$, and if $a=0$, then 
$$\xi^+(s, t)=A(u^+(s, t))\cdot \eta^+(s, t)=A(g(0, u)(s, t))\cdot f(0, \eta)(s, t)$$
for $(s, t)\in \R^+\times S^1$.
Consequently, $\xi^+$ is the  product of two maps defined on all of $\R^+\times S^1$ and we shall show that  each map is sc-smooth.


  
We start with the map $\hb \oplus E\to H^{3,\delta_0}_c(\R^+\times S^1)$, defined by $(a, u)\mapsto A(g(a, u))$.  First, using the arguments in Section 2.4  of  \cite{HWZ8.7} 
one shows that the map $\hb \oplus E\to H^{3,\delta_0}_c(\R^+\times S^1)$, defined by $(a, u)\mapsto  g(a,u)$ is sc-smooth.
The smooth  function  $A:\R\to \R$ induces   
a smooth substitution operator 
$$\wh{A}:H^{m,\delta}_c(\R^+\times S^1)\to H^{m,\delta}_c(\R^+\times S^1), \qquad \wh{A}(u)=A\circ u$$
 for every $m\geq 2$ and $\delta\geq 0$. In particular, the map 
 $$\wh{A}: H^{3,\delta_0}_c(\R^+\times S^1)\to H^{3,\delta_0}_c(\R^+\times S^1)$$ 
 is sc-smooth. 
Applying the chain-rule for sc-smooth maps, we conclude that the map 
$$
\hb\oplus E\to H^{3,\delta_0}_c({\mathbb R}^+\times S^1),\qquad (a, u)\mapsto \wh{A}(g(a,u))=A\circ  g(a, u)
$$
is sc-smooth.   Also  the map $\hb\oplus F^i\to H^{2+i,\delta_i}(\R^+\times S^1)$, defined by \eqref{phieta1} is sc-smooth for $i=0$ and $i=1$,  again by the arguments  in Section 2.4 of  \cite{HWZ8.7}. 

The product map  
$\Phi:H^{3+m,\delta_m}_c(\R^+\times S^1)\oplus H^{2+m+i,\delta_{m+i}} (\R^+\times S^1)\to  H^{2+m+i,\delta_{m+i}}(\R^+\times S^1)$, defined by $\Phi(f, g)=f\cdot g$,   is smooth for every level $m\geq 0$ and $i=0,1$.  This follows from the statement (1) of   Theorem \ref{balgebra} if $i=0$ and from the statement (2) if $i=1$. 
Consequently, applying the chain-rule, the map $\hb\oplus E\oplus F^i\to H^{2+i,\delta_i}(\R^+\times S^1)$, defined by 
$(a, u,\eta)\mapsto \Phi\bigl(\wh{A}(g(a,u)),f (a, \eta)\bigr)$,  is sc-smooth and hence the map $(a, u,\eta)\mapsto \xi^+$ is sc-smooth. 
The same  arguments  applied to  the second map $\hb\oplus E\oplus F^i\to H^{2+i,\delta_i}(\R^-\times S^1)$,\ $(a, u, \eta)\mapsto \xi^-$ show that it  is also sc-smooth. 

Consequently, the map $\hb\times E\oplus F^i\to F^i$, $(a, u,\eta)\mapsto  \xi=\wt{A}(a, u,\eta)$, is sc-smooth as claimed. \\[1ex]
  
  
  To obtain the desired estimate we first  consider the map $(a, \eta)\mapsto f(a, \eta)$.  The map is sc-smooth and, in particular, of class $\ssc^0$. Hence, given the  level $m\geq 0$, there exists a constant $\rho>0$ such that 
 \begin{equation*}
 \norm{ f (a, \eta)}_{H^{2+m+i,\delta_{m+i}}(\R^+\times S^1)}\leq 1
 \end{equation*}
 for all $\abs{a}\leq \rho$, $i=0,1$,  and  all $\abs{\eta}_{F_{m+i}} \leq \rho$.  Since the map is linear in the variable $\eta$, we conclude that 
 \begin{equation*}\label{linvar1}
 \norm{ f (a, \eta)}_{H^{2+m+i,\delta_{m+i}}(\R^+\times S^1)}\leq \rho^{-1}\abs{\eta}_{F_{m+i}}
 \end{equation*} 
for all $\abs{a}\leq \rho$, $i=0,1$,  and all $\eta \in F_{m+i}$.  Also, it follows from \eqref{phieta1} that there is a constant $C_m>\rho^{-1}$ such that 
 \begin{equation*}
 \norm{ f (a, \eta)}_{H^{2+m+i,\delta_{m+i}}(\R^+\times S^1)}\leq  C_m\abs{\eta}_{F_{m+i}}
 \end{equation*} 
 for all $\rho\leq \abs{a}\leq \frac{1}{2}$, $i=0,1$,  and all $\eta \in F_{m+i}$.  Consequently, 
\begin{equation}\label{feta}
 \norm{f(a, \eta)}_{H^{2+m+i,\delta_{m+i}}(\R^+\times S^1)}\leq  C_m\abs{\eta}_{F_{m+i}}
 \end{equation} 
 for all $\abs{a}\leq \frac{1}{2}$, $i=0,1$, and all  $\eta\in F_{m+i}$.  Now,  given a pair $u_0=(u_0^+,u_0^-)\in E_m$ where $u^\pm_0=c_0+r^\pm_0$, we  define 
 $$g(a, u_0)(s, t)=c_0+\beta_a(s-2)\cdot  \wh{\oplus}_a(r_0)(s,t)$$
 if $a\neq 0$ and $g(0, u_0)=u_0^+$ if $a=0$. 
We already know that the map $(a, u)\mapsto A \circ g(a, u))$ is sc-smooth,  hence, in particular,  of class $\ssc^0$.  Therefore, fixing a level $m\geq 0 $,  we find  for every $a_0\in \hb$ and $\varepsilon>0$   a positive number $\rho_{a_0}$ such that 
$$\norm{A(g(a, u))-A(g(a_0, u_0))}_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\leq \varepsilon/2$$
 for all $\abs{a-a_0}<\rho_{a_0}$ and $\abs{u-u_0}_{E_m}<\rho_{a_0}.$
 In particular, 
 $$\norm{A(g(a, u_0))-A(g(a_0, u_0))}_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\leq \varepsilon/2$$
implying
\begin{equation*}
\begin{split}
&\norm{A(g(a, u))-A(g(a, u_0)) }_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\\
&\phantom{====}\leq  \norm{A(g(a, u))-A(g(a_0, u_0))}_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\\
&\phantom{====\leq}+ \norm{A(g(a_0, u_0))-A(g(a, u_0))}_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\leq  \varepsilon.
\end{split}
\end{equation*}
Covering the closed disk $\hb$ by open disks  $B(a_0,\rho_{a_0})$ and using compactness we find a constant $\rho>0$ such that 
$$\norm{A(g(a, u))-A(g(a, u_0))}_{H_c^{m+3,\delta_m}(\R^+\times S^1)}\leq \varepsilon$$
for all $a$ and for $u\in E_m$ satisfying $\abs{u-u_0}_{E_m}<\rho.$
 
Now, using  Theorem \ref{balgebra} on  level $m+i$ for $i=0,1$ and the estimate \eqref{feta},  we conclude for given 
$u_0\in E_m$ and $\varepsilon>0$ that there exist $\rho>0$  and a constant  $C_m$ depending on $m$ but not on $a$ such that  
 \begin{equation*}
\begin{split}
\norm{\bigl(A(g(a, u))-A(g(a, u_0))\bigr)\cdot f(a, \eta)}_{H^{m+2+i,\delta_{m+i}}(\R^+\times S^1)}\leq  C_m\cdot \varepsilon\cdot \abs{\eta}_{F_{m+i}}
\end{split}
\end{equation*}
for all $a\in B_{\frac{1}{2}}$, all  $\eta\in F_{m+i}$ and for $u\in E_m$ satisfying  $\abs{u-u_0}_{E_m}<\rho$. This completes the proof of the part (1) of Proposition 4.6 and we next  turn to part (2).  \\[1ex]
{\bf (2).} \  We recall  that,  for a fixed $a\in \hb$,  the map $L_a:E\to \call (F, F)$ is defined by 
$$L_a(u)=\wt{A}(a, u, \cdot )\in \call (F, F).$$
That for fixed $a$ and level $m$  the map $L_a$ is of class $C^1$ follows from standard classical argument
and the fact that gluing is linear. Then one computes the form of $DL_a$ by a formal calculation.
For this we consider  the  smooth  function  $B:\R\oplus \R\to \R$, defined by 
$$B(p, q)=DA(p)\cdot q$$
where $DA$ stands for the derivative of $A$, and introduce the map $\wt{B}:\hb\oplus E\oplus E\oplus F\to F$, $(a, u,\wh{u},\eta)\mapsto \wt{B}(a, u, \wh{u}, \eta)=\xi$,  defined as the unique solution of the two equations
\begin{equation*}
\begin{aligned}
\wh{\oplus}_a(\xi)&=B(u_a, \wh{u}_a)\cdot \eta_a\\
\wh{\ominus}_a(\xi)&=0
\end{aligned}
\end{equation*}
if $a\neq 0$. Here we have  used the notation 
$u_a=\oplus_a (u)$, $\wh{u}_a=\oplus_a (\wh{u})$,  and $\eta_a=\wh{\oplus}_a(\eta).$ If 
$a=0$, then 
$\wt{B}(a, u, \wh{u}, \eta)=\bigl([DA(u^+)\cdot \wh{u}^+]\cdot \eta^+, [DA(u^-)\cdot \wh{u}^-]\cdot \eta^-\bigr).$
 We claim that the derivative $DL_a(u)\wh{u}$ of the  map $L_a$  at the  point $u$ in the direction of $\wh{u}$ is equal to 
\begin{equation}\label{btilde_eq1}
DL_a(u)\wh{u}=\wt{B}(a, u, \wh{u}, \cdot ).
\end{equation}

The continuity of the map $DL_a:E_m\to \call (E_m, \call (F_m, F_m))$  is a consequence of the estimate in the part (3) below. 

 The sc-smoothness  of the map 
$\hb\oplus E\oplus E \oplus F\to F$,  defined by 
$$(a, u, \wh{u}, \eta)\mapsto [DL_a(u)\wh{u}]\eta=\wt{B}(a, u, \wh{u}, \eta), $$
can be reduced to the previous discussion in part (1) by replacing the function $A$ by  the function $B$. This completes the proof of part (2) in Proposition \ref{XCX2}, and we shall prove part (3).\\
 {\bf (3).} \  Fixing a level $m\geq 0$ and $u_0\in E_m$, we have  to estimate
\begin{equation*}
\begin{split}
&\abs{\bigl[DL_a(u)\wh{u}\bigr]\eta -\bigl[DL_{a}(u_0)\wh{u}\bigr]\eta}_{F_m}=
\abs{\wt{B}(a, u, \wh{u}, \eta)-\wt{B}(a, u_0, \wh{u}, \eta)}_{F_m}. 
\end{split}
\end{equation*}
For $a\neq 0$,  we abbreviate  $\xi=\wt{B}(a, u, \wh{u}, \eta)$ and $\xi_0=\wt{B}(a, u_0, \wh{u}, \eta)$. Then, 
 \begin{equation*}
 \begin{split}
 \xi^+-\xi^+_0&=\bigl[ DA(u_a)-DA((u_0)_{a})\bigr] \cdot \wh{u}_{a}\cdot\biggl[\frac{\beta_a}{\gamma_a} \eta_{a}\biggr]
 \end{split}
 \end{equation*}
With the maps $f:\hb\oplus F\to H^{2,\delta_0}(\R^+\times S^1)$, $(a, \eta)\mapsto f(a, v)$,  and $\wh{f}:\hb\oplus E\to H^{3,\delta_0}(\R^+\times S^1)$, $(a,\wh{u} )\mapsto \wh{f}(a, \wh{u})$,  both defined by \eqref{phieta1},  and the map $g: \hb\times H_c^{3,\delta_0}(\R^+\times S^1)\to H^{3,\delta_0}(\R^+\times S^1)$, $(a, u)\mapsto g(a, u)$ defined by \eqref{g1},  the map $\xi^+-\xi^+_0$ is equal to 
 \begin{equation*}
 \xi^+-\xi^+_0=\bigl[ DA(g(a, u))-DA(g(a, u_0))\bigr]\cdot \wh{f}(a, \wh{u})\cdot f(a,\eta)
 \end{equation*}
 For the map $f$ we have the estimate \eqref{feta} and for the map $\wh{f}$ we similarly obtain  the estimate 
 \begin{equation}\label{whfeta}
 \norm{\wh{f}(a, \wh{u})}_{H^{3+m,\delta_m}(\R^+\times S^1)}\leq  C_m\abs{\wh{u}}_{E_m}
 \end{equation} 
 for all $\abs{a}\leq \frac{1}{2}$ and all  $\wh{u}\in E_m$. 
 Hence,  using  the Banach algebra property in Theorem \ref{balgebra} twice, and the estimates \eqref{feta} and \eqref{whfeta},  we obtain 
\begin{equation*}
\begin{split}
&\norm{ \xi^+-\xi^+_0}_{H^{2+m,\delta_m}(\R^+\times S^1)}\\
&\leq C_m\norm{DA(g(a, u))-DA(g(a, u_0))}_{H_c^{3+m,\delta_m}(\R^+\times S^1)}\cdot \abs{\wh{u}}_{E_m}\cdot  \abs{\eta}_{F_m}
\end{split}
\end{equation*}
with a constant $C_m$ depending on $m$ but not on $a$. 
Finally,  repeating the same argument as in the part (1) but with the derivative  $DA:\R\to \R$ instead of $A:\R\to \R$,  we see that for a given $\varepsilon>0$,  there is  a constant $\rho>0$ such  that 
$$\norm{DA (g(a, u)-DA (g(a, u_0))}_{H_c^{3+m,\delta_m}(\R^+\times S^1)}<\varepsilon$$
for all $\abs{a}\leq \frac{1}{2}$  and for $u\in E_m$ satisfying $\abs{u-u_0}_{E_m}<\rho.$
Therefore,
$$\norm{\xi^+-\xi^+_0}_{H^{2+m,\delta_m}(\R^+\times S^1)}<C_m\cdot \varepsilon \cdot \abs{\wh{u}}_{E_m}\cdot \abs{\eta}_{F_m}$$
for $u\in E_m$ satisfying $\abs{u-u_0}_{E_m}<\rho$,  for all  $\wh{u}\in E_m$ and all $\eta\in F_m$.  Since the same estimate also holds for the map $\xi^--\xi^-_0$ ,  we conclude that 
$$\abs{\wt{B}(a, u, \wh{u}, \eta)-\wt{B}(a, u_0, \wh{u}, \eta)}_{F_m}\leq C_m\cdot \varepsilon \cdot \abs{\wh{u}}_{E_m}\cdot \abs{\eta}_{F_m}$$
for $u\in E_m$ satisfying $\abs{u-u_0}_{E_m}<\rho$, for  all $\wh{u}\in E_m$ and all $\eta\in F_m$. The estimate for $a=0$ is obtained  the same way.

The proof of Proposition 4.6 is complete. \hfill $\blacksquare$
\section{Proof of Proposition \ref{POLTER}}\label{POLTERGG}

We recall that 
the Hilbert spaces  $H^{3+m,-\delta_m}(Z_a^\ast,\R^{2n} )$ for $m\geq 0$ consist of maps $u:Z_a^\ast\rightarrow\R^{2n}$ for which the associated maps $v:{\mathbb R}\times S^1\rightarrow \R^{2n} $, defined by $ (s,t)\rightarrow u([s,t])$ have partial derivatives up to order $3+m$ which, if  weighted by $e^{-\delta_m|s-\frac{R}{2}|}$ belong to the space $L^2(\R\times S^1)$. The spaces $H^{2+m,-\delta_m}(Z_a^\ast,\R^{2n})$  are defined analogously.
 The norm of $u\in H^{3+m,-\delta_m}(Z_a^\ast, \R^{2n} )$ is defined  as 
 $$\nr u\nr_{3+m,-\delta_m}^{\ast}=\bigl( \sum_{\abs{\alpha}\leq 3+m }\int_{\R\times S^1}\abs{D^\alpha u}^2e^{-2\delta_m\abs{s-\frac{R}{2}}}\ dsdt\bigr)^{1/2} .$$
The number  $R$ is equal to $R =\varphi (\abs{a})$  where  $\varphi$ is the exponential   gluing profile.
Moreover, the mean value $[u]_a$ of a map $u:Z^\ast_{a}\rightarrow  \R^{2n}$ over the  circle at $\{\frac{R}{2}\} \times S^1$
is   defined as 
$$
[u]_a:=\int_{S^1} u\left(\left[\frac{R}{2},t\right]\right) dt.
$$

If $u\in H^{3+m,-\delta_m}(Z_a^\ast, \R^{2n} )$, then the norm $\nr u\nr^{\ast}_{3+m,-\delta_m}$ is equal to 
\begin{equation*}
\begin{split}
\nr u\nr^{\ast}_{3+m,-\delta_m}&=\bigl(\sum_{\abs{\alpha}\leq 3+m}\int_{\R\times S^1}\abs{D^\alpha u(s,t)}^2e^{-2\delta_m \abs{s-\frac{R}{2}}}\ dsdt\bigr)^{1/2}\\
&=\bigl(\sum_{\abs{\alpha}\leq 3+m}\int_{\R\times S^1}\abs{D^\alpha u(s+R/2,t)}^2e^{-2\delta_m \abs{s}}\ dsdt\bigr)^{1/2}\\
&=\norm{u(\cdot +R/2, \cdot)}_{H^{3+m,-\delta_m}(\R\times S^1, \R^{2n})},
\end{split}
\end{equation*}
where  the  $H^{3+m,-\delta_m}(\R\times S^1, \R^{2n})$-norm of the map $u:\R\times S^1\to \R^{2n}$ is defined by 
$$\norm{u}^2_{H^{3+m,-\delta_m}(\R\times S^1, \R^{2n})}=
\sum_{\abs{\alpha}\leq 3+m}\int_{\R\times S^1}\abs{D^\alpha u(s,t)}^2e^{-2\delta_m \abs{s}}\ dsdt.$$
Thus, the map $I_a:H^{3+m,-\delta_m}(Z_a^\ast,\R^{2n} )\to H^{3+m,-\delta_m}(\R\times S^1,\R^{2n} )$, defined by $u(\cdot +R/2, \cdot )$, is a linear isometry.  The same holds for the spaces $H^{2+m,-\delta_m}(Z_a^\ast,\R^{2n} )$ and $H^{2+m,-\delta_m}(\R\times S^1),\R^{2n} )$. Moreover, if $v(s, t)=u(s+R/2, t)$, then $v-[v]_0=u-[u]_a$ where $R=\varphi (\abs{a})$.  Consequently, it suffices to study 
 the standard Cauchy-Riemann operator
$$
\ov{\partial}_0:H^{3+m,-\delta_m}({\mathbb R}\times S^1,{\mathbb R}^{2n})\rightarrow H^{m+2,-\delta_m}({\mathbb R}\times S^1,{\mathbb R}^{2n}).
$$
It is known that this operator is a surjective Fredholm operator whose kernel $N$ consists of constant functions.
The subspace $X\subset H^{3+m,-\delta_m}({\mathbb R}\times S^1,{\mathbb R}^{2n})$ of maps $u$ satisfying 
$$[u]_0:=\int_{S^1}u(0, t)\ dt=0$$ 
is closed and an  algebraic complement of the kernel $N$. Since $N$ is of  finite dimension, the subspace $X$ is a topological complement of $N$.  Applying  the open mapping theorem, 
there exists a constant $C_m$ such that 
$$
\frac{1}{C_m} \cdot \norm{u}_{m+3,-\delta_m}\leq \norm{\ov{\partial}_0u}_{m+2,-\delta_m}\leq C_m\cdot \norm{u}_{m+3,-\delta_m}
$$
for every $u\in X$.   Now the desired estimate is a consequence of the fact that if $u\in H^{3+m,-\delta_m}({\mathbb R}\times S^1,{\mathbb R}^{2n})$, then the map 
$u-[u]_0$ belongs to $X$. This completes the proof of Proposition \ref{POLTER}.



\section{Proof of Lemma \ref{TORTE} }\label{Lemma-4.18}
We recall the statement for convenience.
\begin{LXX}
If $\varepsilon>0$,  there exists $R_\varepsilon>0$ such that for all $R\geq R_\varepsilon$ and for $i=0,1$ the estimate
$$
\norm{ \gamma_R\cdot (J(v)-J(0))h_t}_{H^{m+2+i,\delta_{m+i}}(\R\times S^1,\R^{2n})}\leq \varepsilon \cdot\norm{h}_{H^{m+3+i,\delta_{m+i}}_c(\R\times S^1,\R^{2n})}
$$
holds for  all $h\in  H^{m+3+i,\delta_{m+i}}_c(\R\times S^1,\R^{2n})$.
\end{LXX}

\begin{proof}  
We only consider the case $i=0$; the arguments for the case $i=1$  are the  same. We may assume without loss of generality that  $J$ and $h$ are real-valued. Since we have uniform  bounds on the derivatives of $\gamma_R$ up to any order and $\gamma_R$ vanishes for $s\leq R+1$,  the norm 
$$\norm{ \gamma_R\cdot (J(v)-J(0))h_t}_{H^{m+2,\delta_{m}}}^2$$
is estimated from above  by a constant independent of $R$ times a linear combination of  integrals  of the form 
\begin{equation}\label{int1}
\int_{[R,\infty)\times S^1}\abs{D^{\alpha} \bigl[ \bigl( J(v)-J(0)\bigr)h_t\bigr] }^2e^{2\delta_m\abs{s}}\ dsdt
\end{equation}
where 
the multi-indices $\alpha =(\alpha_1,\alpha_2)$  are of  order $\abs{\alpha}\leq m+2.$ 
Since 
\begin{equation*}
D^{\alpha} \bigl[ \bigl( J(v)-J(0)\bigr)h_t\bigr] =\sum_{\beta\leq \alpha} \binom{\alpha}{\beta} D^{\beta}\bigl( J(v)-J(0)\bigr)\cdot D^{\alpha-\beta}h_t ,
\end{equation*}
the integrals \eqref{int1} are estimated by a  constant independent of $R$,  times a  linear combination of integrals of the form 
\begin{equation}\label{int2}
\int_{[R,\infty)\times S^1}\abs{D^{\beta}\bigl( J(v)-J(0)\bigr)}^2\cdot \abs{D^{\alpha-\beta}h_t}^2e^{2\delta_ms}\ ds dt
\end{equation}
with multi-indices $\alpha$ and $\beta$ satisfying $\beta\leq \alpha$ and $\abs{\alpha}\leq m+2.$ If $\abs{\beta}=0$, then using that $J$ is smooth and $v(s, t)$ approaches $0$ as $s\rightarrow \infty$  uniformly in $t$, the above integral can be estimated by 
$$C_R\int_{[R, \infty)\times S^1}\abs{D^{\alpha}h_t}^2e^{\delta_m s}\ ds dt\leq C'_R\norm{h}^2_{H_c^{m+3,\delta_m}(\R\times S^1,\R^{2n})}$$
where the constants $C_R$ and $C'_R$ converge to $0$ as $R\to \infty.$  We next assume that $1\leq \abs{\beta}\leq m+2$.  Then 
$D^{\beta}\bigl( J(v)-J(0)\bigr)=D^{\beta}\bigl( J(v)\bigr).$  The derivative $D^\beta (J(v))$ is a linear combination of expressions of the form 
\begin{equation}\label{exp1}
(D^k_{I}J)(v)\cdot D^{\gamma_{i_1}}v_{i_1}\cdot \cdots  \cdot D^{\gamma_{i_k}}v_{i_k},
\end{equation}
where $D^k_{I}J$ stands for the $k$-order derivative with respect to the variables $\{i_1,\ldots ,i_k\}$ and $v_i$'s are the components of the vector $v$. Moreover, $k\leq \abs{\beta}$ and the multi-indices $\gamma_{i_1},\ldots, \gamma_{i_k}$ satisfy $\abs{\gamma_{i_1}}+\ldots +\abs{\gamma_{i_k}}=\abs{\beta}$.  Hence 
using that  $v(s, t)$ approaches $0$ as $s\rightarrow \infty$  uniformly in $t$ and that $J$ is smooth, we see 
that for multi-indices $\beta$ satisfying $1\leq \abs{\beta}\leq m+2$ the integrals in \eqref{int2} are  bounded above by integrals of the form 
\begin{equation}\label{int3}
C_R\int_{[R,\infty)\times S^1} \abs{D^{\gamma_1}v_1}^{2} \cdots   \abs{D^{\gamma_{2n}}v_{2n}}^2\cdot \abs{D^{\alpha-\beta}h_t}^2e^{2\delta_ms}\ ds dt
\end{equation}
with a constant $C_R$ tending to $0$ as $R\to \infty$.
To estimate the integrals in \eqref{int3} we first assume that $\abs{\gamma_{i_1}}, \ldots, \abs{\gamma_{i_k}}$ are less or equal to $m+1$. We recall that $v$ is a fixed map belonging to $H^{m+3,\delta_m}(\R^+\times S^1, \R^{2n})$. This is equivalent to saying that $e^{\delta_ms}v$ belongs to $H^{m+3}(\R^+\times S^1, \R^{2n})$. In view of the Sobolev embedding theorem, we conclude that  $e^{\delta_ms}v$ is of class $C^{m+1}((1, \infty)\times S^1)$ and there exists a constant $C$ such that 
$\max_{0\leq \abs{\gamma}\leq m+1}\sup_{(1, \infty)\times S^1}\abs{D^\gamma (e^{\delta_m s}v)}\leq C\norm{v}_{H^{m+3,\delta_m}((1,\infty)\times S^1,\R^{2n})}$. From this we conclude that  the partial derivatives $D^{\gamma_i}v_i$ are uniformly  bounded by a constant independent of $R>1$. If $\abs{\gamma_{i_1}}, \ldots, \abs{\gamma_{i_k}}\leq m+1$,  then
 the integrals in \eqref{int3} are estimated from above by 
$$
K_R\int_{[R,\infty )\times S^1}\abs{D^{\alpha-\beta}h_t}^2e^{2\delta_ms}\ ds dt\leq C'_R\norm{h}_{H^{m+3,\delta_m}(\R\times S^1, \R^{2n})}.
$$
It remains to consider the  case in which there is exactly one multi-index, say $\gamma_{i}$,  for which $\abs{\gamma_{i}}=m+2$. In this case $\alpha=\beta=\gamma_{i}$ and the integral \eqref{int3} takes the form 
\begin{equation}\label{int4}
C_R\int_{[R,\infty)\times S^1}\abs{D^{\alpha}v_i}^2\cdot \abs{h_t}^2e^{2\delta_m s}\ dsdt.
\end{equation}
Since the derivative $h_t$ belongs to $H^{m+2,\delta_m}(\R^+\times S^1, \R^{2n})$, the map 
$e^{\delta_m s}h_t$ belongs to $H^{m+2}(\R^+\times S^1, \R^{2n})$. In particular,  in view of the Sobolev embedding theorem, $e^{\delta_m s}h_t$ belongs to 
the space $C^0(\R^+\times S^1, \R^{2n})$ and 
$$
\norm{e^{\delta_m s}h_t}_{C^0(\R^+\times S^1)}\leq C\norm{e^{\delta_ms}h_t}_{H^{m+2}(\R^+\times S^1,\R)}\leq C\norm{h}_{H_c^{m+3,\delta_m}(\R\times S^1)}.
$$
Consequently, 
\begin{equation}\label{int5}
\begin{split}
C_R\int_{[R,\infty)\times S^1} &\abs{D^{\alpha} v_i}^{2} \cdot \abs{h_t}^2e^{2\delta_ms}\ ds dt\\
&\leq C'_R\norm{h_t}_{C^0(\R^+\times S^1)} \norm{v}_{H^{m+3}(\R^+\times S^1, \R^{2n})}\\
&\leq  C'_R\norm{v}_{H^{m+3}(\R^+\times S^1, \R^{2n})}\cdot \norm{h}_{H^{m+3,\delta_m}_c(\R\times S^1,\R^{2n})}.
\end{split}
\end{equation}
Summing up, each of the integrals \eqref{int1} can be estimated from above by $C_R\norm{h}_{H^{m+3,\delta_m}_c(\R\times S^1,\R^{2n})}$ in which  $C_R\to 0$ as $R\to \infty$. This completes the proof of Lemma \ref{TORTE}.
\end{proof}

\section{Orientations for Sc-Fredholm Sections}\label{orientations-abstract}
The Appendices \ref{orientations-abstract} and \ref{orientations} are devoted to the orientation in Gromov-Witten theory.

\subsection{Basic Ideas}
We start with some general considerations well known from index theory, and refer to \cite{FH} and \cite{HWZ10,HWZ11}  for more details. 
Here we shall restrict ourselves to the case of Fredholm operators in Hilbert spaces. The Banach space case is technically a little bit more complicated and the basic constructions can be found in \cite{HWZ10}.


If $E$ is a finite-dimensional vector space, we denote its dual space by $E^\ast$.  The maximal wedge of $E$ is the $1$-dimensional vector space 
$$
\Lambda^{\textrm{max}} E =\Lambda^{\dim(E)} E.
$$
In case $E=\{0\}$, we put  $\Lambda^{\textrm{max}} E={\mathbb R}$.  
The dual ${\mathbb R}^\ast$ of ${\mathbb R}$ is  canonically identified with ${\mathbb R}$ by the isomorphism ${\mathbb R}^\ast\rightarrow {\mathbb R}$, $\lambda\rightarrow \lambda(1)$. 
Henceforth ${\mathbb R}^\ast={\mathbb R}$. Moreover, there is a canonical  isomorphism
$$
\gamma:\Lambda^{\textrm{max}} ( E^\ast) \rightarrow (\Lambda^{\textrm{max}} E)^\ast
$$
defined by 
$$\gamma( e_1^\ast\wedge..\wedge e_n^\ast)(a_1\wedge \ldots \wedge a_n)=\det (e_i^\ast(a_j)),
$$
where $n=\dim(E)$. If $n=0$, then 
$\Lambda^{\textrm{max}} ( E^\ast) =\Lambda^{\textrm{max}} (0)=\R=\R^\ast$ and $\gamma(r)t=r\cdot t$.


\begin{definition}\label{def_determinant_1}
The determinant $\text{det}(T)$ of a bounded linear Fredholm operator $T:E\to F$ between Hilbert spaces is the $1$-dimensional real vector space defined by
$$
\text{det}(T)= (\Lambda^{\textrm{max}} \ker(T))\otimes (\Lambda^{\textrm{max}} \text{coker(T)}^\ast).
$$
\end{definition}


Our aim is to study orientation questions for sc-Fredholm sections. The situation is more complicated than  in the classical case.
In fact there are many possibilities for natural constructions
and different conventions can  lead to different signs in the  orientations of the  moduli spaces. 
In the SFT the orientation analysis requires many 
conventions due to a wealth of additional  structures. This analysis will be carried out in the  forthcoming paper \cite{HWZ5} and,  of course, it covers GW as  a special case. However, the special case of the Gromov-Witten theory allows a somewhat  simpler approach. 


Given an exact sequence 
$$
{\bf E:}\ \ 0\rightarrow A\xrightarrow{\alpha}B\xrightarrow{\beta}C\xrightarrow{\gamma} D\rightarrow 0
$$
of finite dimensional vector spaces, we shall construct two associated natural isomorphisms 
\begin{align*}
\Phi:&=\Phi_{\bf E}:\, \Lambda^{\textrm{max}} A\otimes \Lambda^{\textrm{max}} D^\ast \rightarrow \Lambda^{\textrm{max}} B\otimes\Lambda^{\textrm{max}} C^\ast,\\
\Psi:&=\Psi_{\bf E}:\, \Lambda^{\textrm{max}} C\otimes \bigl(\Lambda^{\textrm{max}} A \oplus \Lambda^{\textrm{max}} D^\ast\bigr) \rightarrow \Lambda^{\textrm{max}} B.
\end{align*}

Let $\dim(A)=n$, $\dim(B)=m$, $\dim(C)=k$,  and $\dim(D)=l$. 
The exactness of ({\bf E}) implies the equality 
$$m-n= k-l.$$
\begin{definition}\label{lem_isom_phi_1}
The  isomorphism
$$
\Phi:=\Phi_{\bf E}\, :\Lambda^{\textrm{max}} A\otimes \Lambda^{\textrm{max}} D^\ast \rightarrow \Lambda^{\textrm{max}} B\otimes\Lambda^{\textrm{max}} C^\ast
$$
associated with the exact sequence $({\bf E})$  is constructed as follows. We fix a basis $d_1^\ast,\ldots ,d^\ast_l$ of $D^\ast$. If $A\neq \{0\}$, given $h\in \Lambda^{\textrm{max}} A\otimes \Lambda^{\textrm{max}} D^\ast$, we choose vectors $a_1,\ldots, a_n\in A$ such that 
$$
h=(a_1\wedge\ldots \wedge a_n)\otimes (d_1^\ast\wedge\ldots \wedge d_l^\ast).
$$
Next we choose  linearly independent vectors $b_1,\ldots ,b_{m-n}$  which are not in the image of the linear map $\alpha\colon   A\to B$ and define the vectors $c_i=\beta (b_i)$ in $C$,  for  $i=1,\ldots ,m-n$. Then $c_1,\ldots ,c_{m-n}$  
are linearly independent in $C$ and span the image of the linear map $\beta\colon  B\to C$. 
We take  dual vectors  $c_1^\ast,\ldots,c_{k-l}^\ast$ in $C^\ast$ so that the square matrix 
$(c_i^\ast(c_j))$ has determinant $1$.
The vectors 
$d_1^\ast\circ\gamma,\ldots ,d_l^\ast\circ\gamma, c_1^\ast,\ldots,c_{m-n}^\ast$
form  a basis in  $C^\ast$ and the map $\Phi$ is defined by 
$$
\Phi(h)= 
(\alpha (a_1)\wedge..\wedge \alpha (a_n)\wedge b_1\wedge..\wedge b_{m-n})\otimes (d_1^\ast\circ \gamma\wedge..\wedge d_l^\ast\circ \gamma\wedge c_1^\ast\wedge..\wedge c_{m-n}^\ast).
$$
If  $A=\{0\}$, we replace $ \alpha (a_1)\wedge\ldots \wedge \alpha (a_n)$ by the real number $r$  which replaces
$a_1\wedge\ldots \wedge a_n$, so that $h=r (d_1^\ast\wedge\ldots \wedge d_l^\ast)$ and then define 
$$\Phi(h)=r( b_1\wedge\ldots \wedge b_{m-n})\otimes (d_1^\ast\circ \gamma\wedge\ldots \wedge d_l^\ast\circ \gamma\wedge c_1^\ast\wedge\ldots \wedge c_{m-n}^\ast).$$
\end{definition}



The  definition of the isomorphism $\Phi_{\bf E}$ does  not depend on the choices involved,  apart from the two convention of the  order in which  we write the right-hand side of $\Phi (h)$.
The two conventions are that $b_1,\ldots ,b_{m-n}$ are listed after $\alpha (a_1),\ldots ,\alpha (a_n)$ and $c^\ast_1,\ldots, c^\ast_{m-n}$ are listed after $d_1^\ast\circ\gamma,\ldots ,d_l^\ast\circ \gamma$.  
Apart from these two conventions, the resulting definition does not depend on the choices involved, see Lemma \ref{very_new_lemma} below.


\begin{definition}\label{lem_isom_phi_2}
The natural isomorphism 
$$\Psi=\Psi_{\bf E}:
\Lambda^{\textrm{max}} C\otimes \bigl( \Lambda^{\textrm{max}}A \otimes 
\Lambda^{\textrm{max}}D^*\bigr)\to 
\Lambda^{\textrm{max}}B$$ 
is constructed as follows. Again we fix a basis 
$d_1^*,\ldots d^*_l\in D^*$. Then we choose non-vanishing elements $c_1^*,\ldots ,c^*_{m-n}\in C^*$, which do not vanish on the image of the map $\beta:B\to C$, such that the functionals  
$$(c_1',\ldots , c_k')=(d_1^*\circ \gamma,\ldots ,
d_l^*\circ \gamma, c_1^*,\ldots , c_{m-n}^*)$$
form a basis of the dual space $C^*$, recalling that 
$k=l+(m-n)$.  Then we choose vectors $b_1,\ldots ,b_{m-n}$ such that the matrix 
$(c_i^*(\beta(b_j))$ has determinant $1$. The functionals 
$(c_1',\ldots ,c_l')=(d_1^*\circ \gamma,\ldots ,
d_l^*\circ \gamma)$ vanish on $\beta(b_1), \ldots , \beta(b_{m-n})$. Then we choose the vectors $c_1,\ldots ,c_l\in C$ such that the matrix $(c_i'(c_j))$, where $i, j=1,\ldots ,l$, has determinant equal to $1$. Denoting by 
$$(c_1,\ldots ,c_k)=(c_1,\ldots ,c_l, \beta(b_1), \ldots , \beta(b_{m-n})$$
the basis of $C$ we have, by construction,
$$\det \bigl(c_i'(c_j)\bigr)_{1\leq i,j\leq k}=1.$$
Since we can choose the vectors $a_1,\ldots, a_n\in A$ arbitrarily, every vector 
$h\in \Lambda^{\textrm{max}}C\otimes \bigl(
 \Lambda^{\textrm{max}}A\otimes  \Lambda^{\textrm{max}}D^*)$ can be represented in the form 
 \begin{eqnarray}\label{must}
 h=(c_1\wedge \ldots \wedge c_k)\otimes (a_1\wedge \ldots \wedge a_n)\otimes (d_1^*\wedge \ldots \wedge d_l^*)
 \end{eqnarray}
 for a suitable choice of $a_1,\ldots ,a_n\in A$. Finally, the isomorphism $\Psi$ is defined by 
 $$\Psi(h)=(\alpha (a_1)\wedge \ldots \wedge \alpha (a_n))\wedge b_1\wedge \ldots \wedge b_{k-l}.$$
 The case $A=\{0\}$ is dealt with as in the previous Definition \ref{lem_isom_phi_1}.
 \end{definition}
An alternative definition of $\Psi_{\bf E}$ is given by  the composition
 $$
 \Lambda^{\textrm{max}}C\otimes (\Lambda^{\textrm{max}}\otimes\Lambda^{\textrm{max}} D^\ast)\xrightarrow{Id\otimes\Phi_{\bf E}} \Lambda^{\textrm{max}} C\otimes\Lambda^{\textrm{max}}B\otimes\Lambda^{\textrm{max}}C^\ast\rightarrow \Lambda^{\textrm{max}} B.
 $$
The last map is the  isomorphism 
 $$
 (c_1\wedge\ldots \wedge c_k)\otimes(b_1\wedge\ldots \wedge b_m) \otimes (c_1^\ast\wedge\ldots\wedge c_k^\ast)\mapsto  \det(c_j^\ast(c_i))\cdot (b_1\wedge\ldots \wedge b_m).
 $$
 To see the last assertion we start with the element $h$ in \eqref{must}. Writing 
 $$
 h= (c_1\wedge \ldots \wedge c_k)\otimes h', 
 $$
 we compute with $\Phi={\Phi}_{\bf E}$ and the vectors previously constructed 
 $$
 \Phi(h')=(\alpha (a_1)\wedge\ldots\wedge \alpha (a_n)\wedge b_1\wedge\ldots\wedge b_{m-n})\otimes (c_1'\wedge\ldots\wedge c_k').
  $$
  Finally,  we observe that $(c_1\wedge\ldots \wedge c_k)\otimes \Phi(h')$ is mapped by the natural isomorphism onto $(\alpha (a_1)\wedge\ldots\wedge \alpha (a_n)\wedge b_1\wedge\ldots\wedge b_{m-n})$. This  proves our assertion noting that $m-n=k-l$.
\begin{lemma}\label{very_new_lemma}
The definitions of the maps $\Phi=\Phi_{\bf E}$ and $\Psi=\Psi_E$ are independent  of the choices involved. Moreover, the maps $\Phi$ and $\Psi$ are isomorphisms.
\end{lemma}
\begin{proof}
In view of the previous discussion we only  need to consider  the map $\Phi$  and prove that it is well-defined  in the case $A\neq \{0\}$. 
Assume we have chosen  a basis $a_1,\ldots,a_n$ for $A$, a basis  $d_1^\ast,\ldots,d^\ast_l$ for $D^\ast$, and linearly independent vectors
$b_1,\ldots,b_{m-n}$ in $B$ which are not in the image of $\alpha$. With these choices fixed, we choose  $c_1^\ast,\ldots,c^\ast_{m-n}$ in $C^\ast$ such  that the matrix 
$(c_i^\ast(\beta(b_j))$ has determinant $1$.  Consider the vector $H$ given by
$$
(\alpha(a_1)\wedge\ldots\wedge\alpha(a_n)\wedge b_1\ldots\wedge b_{m-n})\otimes(d_1^\ast\circ \gamma\wedge\ldots\wedge d^\ast_l\circ\gamma\wedge c_1^\ast\wedge\ldots\wedge c^\ast_{m-n}).
$$
Assuming  we would have made a different choice for the vectors $c_1^\ast,\ldots,c_{m-n}^\ast$, say $e_1^\ast,\ldots,e^\ast_{m-n}$, we can write
$$
e^\ast_j = \sum_{i=1}^{m-n} \lambda_{ji} c_i^\ast + \Delta_j,
$$
where $\Delta_j$ is a linear combination of the vectors $d_1^\ast\circ\gamma,\ldots ,d_l^\ast\circ\gamma$.  Using 
$\gamma\circ\beta=0$, we conclude that 
$$
e^\ast_j(\beta(b_\tau))= \sum_{i=1}^{m-n} \lambda_{ji} c_i^\ast(\beta(b_\tau))
$$
for all $1\leq \tau\leq m-n$. Since by assumption $\det (e^\ast_j(\beta(b_\tau))=\det (e^\ast_j(\beta(b_\tau))=1$, the matrix $(\lambda_{ji})$ has determinant $1$. Therefore,  
$$
d_1^\ast\circ \gamma\wedge\ldots \wedge d^\ast_l\circ\gamma\wedge c_1^\ast\wedge\ldots \wedge c^\ast_{m-n}
=d_1^\ast\circ \gamma\wedge..\wedge d^\ast_l\circ\gamma\wedge e_1^\ast\wedge(e^\ast_j(\beta(b_\tau)) \wedge e^\ast_{m-n}.
$$
Consequently,  the vector $H$ does not depend on the choice of $c_1^\ast,\ldots,c_{m-n}^\ast$, which is the last choice in the construction. Next we show that the vector $H$ is independent of the choice of $b_1,\ldots ,b_{m-n}$. Assume that we have made a different choice for the vectors $b_1,\ldots, b_{m-n}$ which we again denote by  $e_1,\ldots, e_{m-n}$.  The vectors 
$e_1,\ldots, e_{m-n}$ do not belong to the image of the map $\alpha$ and 
$$
e_j =\sum_{i=1}^{m-n} \lambda_{ji} b_i +\Delta_j
$$
for all $1\leq j\leq m-n$ and where $\Delta_j$ is a vector in  the image of $\alpha$.  Denoting by  $c_1^\ast,\ldots ,c_{k-l}^\ast\in C^\ast$ the vectors associated with $b_1,\ldots ,b_{m-n}$ so that the matrix $(c_\tau (\beta (b_i))$ has determinant $1$,  we find, using $\beta\circ \alpha=0$,  that 
$$
c_\tau^\ast(\beta(e_j))=\sum_{i=1}^{m-n} \lambda_{ji} c_\tau^\ast(\beta(b_i)), 
$$
which implies
$$
\det(c^\ast_\tau\beta(e_j))= \det(\lambda_{ji}).
$$ 
Then, abbreviating $r=\det (\lambda_{ji})$,  we can take for the choice $e_1,\ldots, e_{m-n}$ the dual vectors
\begin{equation}\label{must1}
\frac{1}{r}c_1^\ast,c_2^\ast,\ldots ,c_{m-n}^\ast.
\end{equation}
With the choice above we observe that 
$$
r\cdot(\alpha(a_1)\wedge\ldots \wedge \alpha(a_n)\wedge b_1\ldots \wedge b_{m-n}=(\alpha(a_1)\wedge\ldots \wedge \alpha(a_n)\wedge b_1'\ldots \wedge b_{m-n}'
$$
and consequently, using that our new choice for the $c_i^\ast$ is \eqref{must1}, we conclude that the result does not depend on the the third choice
in our construction, namely the $b_i$, either. Finally,  we need to understand the dependency on the choice of $a_1,\ldots,a_n$ and $d_1^\ast,\ldots,d_l^\ast$.
If $a_1',\ldots ,a_n'$ is a second choice for $a_1,\ldots ,a_n$,  there is $r$ such  that
$$
\frac{1}{r}\cdot (a_1\wedge\ldots\wedge a_n) =a_1'\wedge\ldots \wedge a_n'.
$$
Similarly, if  $e_1^\ast,\ldots,e_l^\ast$ is a different choice for $d_1^\ast,\ldots ,d_l^\ast$,  there is $s$ such that 
$$
e_1^\ast\wedge\ldots \wedge e_l^\ast = s\cdot d_1^\ast\wedge\ldots \wedge d_l^\ast.
$$
Assuming that
$$
(a_1\wedge\ldots \wedge a_n)\otimes(d_1^\ast\wedge\ldots\wedge d_l^\ast)=(a_1'\wedge\ldots\wedge a_n')\otimes (e_1^\ast\wedge\ldots\wedge e_l^\ast)
$$
we infer that $r=s$. Therefore,  we conclude, abbreviating $e^\ast=e_1^\ast\wedge\ldots\wedge e_l^\ast$, $a=a_1\wedge\ldots \wedge a_n$, $a'=a_1'\wedge\ldots\wedge a_n'$,
and $d^\ast=d_1^\ast\wedge\ldots\wedge d_l^\ast$,  that the following holds with the obvious abbreviations
\begin{equation*}
\begin{split}
&(\alpha(a)\wedge b_1\wedge\ldots \wedge b_{m-n})\otimes(d^\ast\circ \gamma\wedge c_1^\ast\wedge\ldots\wedge c_{m-n}^\ast)\\
&\phantom{=}=(\alpha(a')\wedge b_1\wedge\ldots\wedge b_{m-n})\otimes(e^\ast\circ \gamma\wedge c_1^\ast\wedge..\wedge c_{m-n}^\ast).
\end{split}
\end{equation*}
This concludes the proof that the definition of $\Phi_{\bf E}$ is independent of the choices involved.
\end{proof}


 
The Definitions  \ref{lem_isom_phi_1} and \ref{lem_isom_phi_2} will be used in the following constructions. 

If $T:E\rightarrow F$ is  a %
linear Fredholm operator between Hilbert spaces, we 
denote by $\Pi_T$ the collection of all orthogonal  projections $P:F\rightarrow F$ satisfying 
\begin{itemize}
\item[(1)] $\text{dim}(F/R(P))<\infty$.
\item[(2)] $R(P\circ T)= R(P)$.
\end{itemize}
Here we denote by  $R(A)$  the range of the linear operator $A$.



We view the composition $P\circ T$ as an operator $E\rightarrow F$ so that $T$ and $P\circ T$ have the same index.
We introduce a partial ordering $\leq $ on $\Pi_T$ by defining  
$P\leq P'$ if $P=P'\circ P=P\circ P'$. The following holds.
\begin{lemma}
Let $T:E\rightarrow F$ be a Fredholm operator between Hilbert spaces. Assume that $P,P'\in\Pi_T$. Then there exists $Q\in\Pi_T$ with $Q\leq P$ and $Q\leq P'$.
\end{lemma}
\begin{proof}
We abbreviate  by $H$ the subspace $H=R(P)\cap R(P')$ of $F$. The subspace $H$ has finite codimension in $F$  Let $Q$ be the orthogonal projection onto $H$. Denoting by 
$A$ the orthogonal complement  of $H$ in $R(P)$ and by $B$  the orthogonal complement of $H$ in $R(P')$,  we obtain the orthogonal decompositions
$$
F=A\oplus H\oplus R(P)^\perp \ \text{and}\ F=B\oplus H\oplus R(P')^\perp.
$$
Accordingly we can write an element $f\in F$ as $f=a+h+z$ where $a\in A$, $h\in H$,  and $z\in R(P)^\perp$.  Then 
$$
Q(f)=PQ(f) =QP(f).
$$
Similarly, 
$$
Q=QP'=P'Q.
$$
Since $PT\colon E\rightarrow R(P)$ is surjective,  the same holds for $QT=QPT$. Hence  $R(Q)=R(QT)$ and $Q\in \Pi_T$, as claimed.
\end{proof}



Given $P\in \Pi_T$, we  consider the sequence
$$
{\bf (P)}\qquad 0\rightarrow \ker(T)\xrightarrow{j}\ker(PT)\xrightarrow{\Phi_T^P}F/R(P)\xrightarrow{\pi}\text{coker}(T)\rightarrow 0
$$
in which  $j$ is the inclusion map, and 
$\Phi^P_T(x) = T(x) +R(P)$, and  $\pi$ is the surjection  defined by $\pi(y+R(P))=(I-P)y+R(T)$.
\begin{lemma}\label{lem_seq_exact_1}
The sequence ${\bf (P)}$ is exact.
\end{lemma}
\begin{proof}
The inclusion $j$ is injective and $\Phi^P_T\circ j=0$. If $\Phi^P_T(x)=0$, where $PT(x)=0$, then  
$T(x)\in R(P)$. This  implies $T(x)=PT(x)=0$, so that $x$ is in the image of $j$. If $x\in \ker(PT)$ we see that
$\pi\circ \Phi^P_T(x)=\pi(Tx+R(P))=(I-P)T(x) +R(T)=T(x)+R(T)=R(T)$. Hence $\pi\circ \Phi^P_T=0$.
If $\pi(y+R(P))=0$ then by definition $(I-P)y+R(T)=R(T)$, which implies $(I-P)y\in R(T)$. Hence we find $(I-P)y=T(x)$
for some $x\in E$. Applying $P$ to both sides of this equation shows that $PT(x)=0$, and therefore $(I-P)y = (I-P)T(x)$. This  implies $\Phi^P_T(x) =(I-P)T(x)+R(P)=(I-P)y +R(P)=y+R(P)$.
Finally we note that $\pi$ is surjective. Indeed, given $y+R(T)$, choose $x\in E$ with $PT(x)=Py$. Then
$y+R(T)=y-T(x) +R(T)= (I-P)(y-T(x)) +R(T)$. Then we compute
$\pi(y-T(x)+R(P))= y-T(x)+R(T)=y+R(T)$ showing that $\pi$ is surjective. Hence the sequence is exact.

\end{proof}
We now assume that $P\leq Q$ so that $P=Q\circ P=P\circ Q$. Then $P\in \Pi_{QT}$ and one verifies as in Lemma \ref{lem_seq_exact_1} that the following sequences are exact.
\begin{gather*}
0\rightarrow \ker(T)\xrightarrow{j}\ker(QT)\xrightarrow{\Phi_T^Q}F/R(Q)\xrightarrow{\pi}\text{coker}(T)\rightarrow 0\\
0\rightarrow \ker(QT)\xrightarrow{j}\ker(PT)\xrightarrow{\Phi_{QT}^P}F/R(P)\xrightarrow{\pi}\text{coker}(QT)\rightarrow 0\\
0\rightarrow \ker(T)\xrightarrow{j}\ker(PT)\xrightarrow{\Phi_T^P}F/R(P)\xrightarrow{\pi}\text{coker}(T)\rightarrow 0.
\end{gather*}
In view of Definition \ref{def_determinant_1} of the determinant we deduce from Definition \ref{lem_isom_phi_1} and Lemma \ref{very_new_lemma} 
the following isomorphisms.
\begin{gather*}
\gamma_T^Q: \text{det}(T)\rightarrow \text{det}(QT)\\
\gamma_{QT}^P:\text{det}(QT)\rightarrow \text{det}(PT)\\
\gamma_{T}^P:\text{det}(T)\rightarrow\text{det}(PT).
\end{gather*}
\begin{lemma}\label{revision_lem_1}
If  $T:E\rightarrow F$ is a linear  Fredholm operator between Hilbert spaces and if the projections $P,Q\in\Pi_T$
satisfy  $P\leq Q$ we have the following relationship, 
$$
\gamma^P_{QT}\circ \gamma^Q_T=\gamma^P_T.
$$
\end{lemma}
\begin{proof}
We set  $K=\ker(T)$ and denote by $A\subset \ker(QT)$ the  orthogonal complement of $K$ in $ \ker(QT)$ and by $B$ the  orthogonal complement of $\ker(QT)$ in $\ker(PT)$.
Then we have the orthogonal decompositions 
$$
\ker(T)=K,\ \ker(QT)= K\oplus A,\ \text{and}\ \ker(PT) =K\oplus A\oplus B.
$$
Note that we have a canonical identification
$$
F/R(P) = F/R(Q)\oplus R(Q)/R(P).
$$
To see this we  note that every class in $F/R(P)$ has a unique representative $f+R(P)$ with $f\in R(P)^\perp$.
Then $f$ has a unique decomposition $f=q+p$ where  $q\in R(Q)^\perp $ and $p\in R(Q)\cap R(P)^\perp$. Then we  associate with 
 $f+R(P)$ the element $(q+R(Q),p+R(P))$. Consider the map $A\rightarrow F/R(Q)\colon a\mapsto T(a)+R(Q)$.
This map is injective and its image can be written as $L/R(Q)$. Then we can as before canonically  identify $F/R(Q)=F/L\oplus L/R(Q)$.
We introduce the following abbreviations $X=F/L$, $Y=L/R(Q)$, and $Z=R(Q)/R(P)$. 
We can identify the exact sequence associated with $T$ and $P$ with the exact sequence
$$
0\rightarrow K\xrightarrow{j} K\oplus A\oplus B\xrightarrow{\Phi}X\oplus Y\oplus Z\xrightarrow{\pi} F/R(T)\rightarrow  0.
$$
Here $j(k)=(k,0,0)$, $\Phi(k,a,b)=(0,T(a)+R(Q),QT(b)+R(P))$ and $\pi(g+L,f+R(Q),e+R(P))= (Id-Q)g+R(T)$. 
The maps $B\rightarrow Z: b\rightarrow QT(b)+R(P)$ and $A\rightarrow Y:a\rightarrow T(a)+R(Q)$ are bijections.
The exact sequence associated with  $T$ and $Q$
is then given by
$$
0\rightarrow K\xrightarrow{j'} K\oplus A \xrightarrow{\Phi'} X\oplus Y\xrightarrow{\pi'} F/R(T)\rightarrow 0.
$$
Here $j'(k)=(k,0)$, $\Phi'(k,a)=(0,T(a)+R(Q))$, and $\pi'(g+L,f+R(Q))=(Id-Q)g + R(T)$.  Finally the exact sequence associated with  $ QT$ and $P$ is given by
$$
0\rightarrow K\oplus A\xrightarrow{j''} K\oplus A\oplus B\xrightarrow{\Phi''} X\oplus Y \oplus Z\xrightarrow{\pi''} X\oplus Y\rightarrow 0,
$$
where $j''(k,a)=(k,a,0)$, $\Phi''(k,a,b)=(0,0,QT(b)+R(P))$ and $\pi''(g+L,f+R(Q),e+R(P))=(g+L, f+R(Q))$.
Consider first the sequence associated withe  $T$ and $Q$. Take a basis $k_1,\ldots,k_l$ for $K$ and a basis $d_1^\ast,\ldots,d_n^\ast$
for $(F/R(T))^\ast$. Applying $j'$ to the $k_i$,  we obtain
$$
\ov{k}_1=(k_1,0),\ldots,\ov{k}_l=(k_\ell,0)
$$
and pulling back by $\pi'$ the $d_j^\ast$,  we obtain
$$
\ov{x}_1^\ast = (x_1^\ast,0),\ldots, \ov{x}_n^\ast =(x_n^\ast,0).
$$
Using that $A\rightarrow Y:a\rightarrow T(a)+R(Q)$ is a bijection,  we take a basis $a_1,\ldots ,a_m$ for $A$ and a dual basis $y_1^\ast,\ldots,y^\ast_m$ for $Y^\ast$ associated with  the image basis of the $a_1,\ldots,a_m$. Then
$$
\det (y^\ast_j(T(a_i)+R(Q)))=1.
$$
Defining  $\ov{a}_j=(0,a_j)$ and $\ov{y}_j^\ast=(0,y_j^\ast)$, the vectors 
$$
\ov{k}_1,\ldots ,\ov{k}_l,\ov{a}_1,\ldots,\ov{a}_m
$$
for a basis for $K\oplus A$ and   the vectors  
$$
\ov{x}_1^\ast,\ldots,\ov{x}_n^\ast,\ov{y}_1^\ast,\ldots,\ov{y}_m^\ast
$$
form a basis
for $(X\oplus Y)^\ast$. We observe that these two bases provide the input data for the diagram associated with $QT$ and $P$. We also note that
the map $\Phi"$ induces the bijection $B\rightarrow Z:b\rightarrow QT(b)+R(P)$.  Hence after fixing a basis $b_1,\ldots,b_q$ for $B$
and a dual basis for $Z^\ast$ for the image basis we obtain a basis for $K\oplus A\oplus B$ and for $X\oplus Y\oplus Z$.
Wedging the vectors of each of these bases together and then taking the tensor product is the image in $\det(PT)$
by mapping $h=(k_1\wedge\ldots \wedge k_l)\otimes (x_1^\ast\wedge\ldots\wedge x_n^\ast)$ first under $\gamma_T^Q$ to an element
in $\det(QT)$ and then under $\gamma^P_{QT}$ to $\det(PT)$. Of course, we could have alternatively taken the exact sequence 
associated with $T$ and $P$ and started with $k_1,\ldots,k_l$ and $x_1^\ast,\ldots,x_n^\ast$ and then make the same choice of vectors
for $A$, $B$, $Y$, and $Z$. The result would be the same. This completes the proof.
\end{proof}



\subsection{The Line Bundle Structure on $\text{DET}(E,F)$}
We assume that $E$ and $F$ are two Hilbert spaces and   consider the open subset ${\mathcal Fred} (E, F)$ of 
${\mathcal L}(E, F)$ consisting of all linear Fredholm operators.  We  introduce  the line bundle $\text{DET}(E, F)$ by  
$$\text{DET}(E, F)=\bigcup_{T\in { \mathcal Fred}(E, F)}\{T\}\times \det (T).$$
Our aim in this section is to show that
$$
\text{DET}(E,F)\rightarrow {\mathcal Fred}(E,F)
$$
has in  a natural way the structure of topological line bundle. At this point $\text{DET}(E,F)$ is only a set which fibers over ${\mathcal Fred}(E,F)$
and where the fibers have natural structures as one-dimensional real vector spaces.

We define a collection of bijections possessing additional properties as follows.
We choose $T_0\in {\mathcal Fred}(E,F)$ and let $P$ be a projection in $\Pi_{T_0}$. Then we find $\varepsilon_0>0$ such  that
$R(PT)=R(P)=:H$ for all $T$ satisfying  $\norm{T-T_0}<\varepsilon_0$. We fix the orthogonal complement  $X$ of  $\ker(PT_0)$ in $E$ 
so that
$$
E=\ker(PT_0)\oplus X.
$$
We define $B_{\varepsilon}(T_0)=\{T\in {\mathcal L}(E,F)\,\vert \, \norm{T-T_0}<\varepsilon_0\}$ and consider the map
$$
\Gamma:B_{\varepsilon}(T_0)\times  \ker(PT_0)\oplus X\rightarrow H,\quad (T,y,x)\rightarrow PT(y+x).
$$
Replacing $\varepsilon_0$ by $\varepsilon_1\in (0,\varepsilon_0]$,  we may assume that 
$$
X\rightarrow H, \quad x\mapsto PT(y+x)
$$
is surjective for all $y\in \ker(PT_0)$ and  all $\norm{T-T_0}<\varepsilon_1$. This allows us to define a uniquely determined continuous map
$$
\Phi: B_{\varepsilon_1}(T_0)\times \ker(PT_0)\rightarrow X
$$
satisfying
$$
PT(y+\Phi(T,y))=0.
$$
For a fixed $T\in B_{\varepsilon_1}(T_0)$, the map $y\mapsto \Phi (T, y)$ is linear and  $\Phi(T_0,y)=0$ for all $y\in \ker(PT_0)$. 


Consider  the subset $\Theta$ of $\{T\in {\mathcal L}(E,F)\ |\ \norm{T-T_0}<\varepsilon_1\}\times E$
consisting of all pairs $(T,k)$ satisfying  $PT(k)=0$. Then $\Theta$ has an induced topology from the ambient space and the map
$$
\Phi:B_{\varepsilon_1}(T_0)\times \ker(PT_0)\rightarrow \Theta, \quad (T,y)\mapsto (T,y+\Phi(T,y))
$$
is a homeomorphism which is  linear in the fibers and whose  inverse is given by $(T,k)\rightarrow (T,Q_0k)$, where $Q_0$ is the projection onto $\ker(PT_0)$
along $X$. This shows the set $\Theta$ is a topological vector bundle in a natural way and we have given a trivialization. 
Trivially $\{T\ |\ \norm{T-T_0}<\varepsilon_1\}\times (F/H)^\ast$ is a smooth vector bundle. This immediately gives us the structure of a topological line bundle
$$
{\mathcal L}:=\bigcup_{\{T\ |\ \norm{T-T_0}<\varepsilon_1\}} \{T\}\times \det(PT)\rightarrow \{T\ |\ \norm{T-T_0}<\varepsilon_1\}.
$$
The collection of maps $\gamma_T^P:\det{T}\rightarrow \det(PT)$ defines a bijection 
$$
\text{DET}(E,F)|\{T\ |\ \norm{T-T_0}<\varepsilon_1\} \rightarrow {\mathcal L}
$$
which is linear on the fibers
and covers the identity. We equip $$\text{DET}(E,F)|\{T\ |\ \norm{T-T_0}<\varepsilon_1\}$$  with the unique structure of a topological line bundle
making the latter map a topological bundle isomorphism. Hence we have proved the following lemma.
\begin{lemma}
Given $T_0\in {\mathcal Fred}(E,F)$ and $P\in \Pi_{T_0}$, there exists  $\varepsilon>0$ such  that the following holds.
\begin{itemize}
\item[(i)] Every $T\in {\mathcal L}(E,F)$ satisfying  $\norm{T-T_0}<\varepsilon$ is Fredholm.
\item[(ii)] $P\in \Pi_{T}$ for all $T$ satisfying  $\norm{T-T_0}<\varepsilon$.
\item[(iii)] The set ${\mathcal L}_{T_0,P,\varepsilon}=\bigcup_{\{T\ |\ \norm{T-T_0}<\varepsilon\}} \{T\}\times \det(PT)$ has in a natural way the structure of a topological line bundle 
$$
{\mathcal L}_{T_0,P,\varepsilon}\rightarrow \{T\ |\ \norm{T-T_0}<\varepsilon\}.
$$
\item[(iv)] There exists a natural bijection associated with the $\gamma_T^P$ which is linear on the fibers and  which makes the following diagram commutative
$$
\begin{CD}
\bigcup_{\{T\ |\ \norm{T-T_0}<\varepsilon\}} \{T\}\times \det(T) @>\Phi_{T_0,P,\varepsilon}>> {\mathcal L}_{T_0,P,\varepsilon}\\
@VVV @VVV\\
\{T\ |\ \norm{T-T_0}<\varepsilon\} @= \{T\ |\ \norm{T-T_0}<\varepsilon\}
\end{CD}
$$
Here $\Phi_{T_0,P,\varepsilon}(T,h)=(T,\gamma_T^P(h))$.
\end{itemize}
\end{lemma}
Let $T_0\in {\mathcal Fred}(E,F)$ and $P,Q\in \Pi_{T_0}$ with $P\leq Q$. We find $\varepsilon>0$ so that every bounded linear operator
$T:E\rightarrow F$ with $\norm{T-T_0}<\varepsilon$ is Fredholm and $P,Q\in\Pi_{T}$.
Using the exact sequences 
$$
0\rightarrow\ker(QT)\xrightarrow{j}\ker(PT)\xrightarrow{\Phi^P_{QT}}F/R(P)\xrightarrow{\pi} F/R(Q)\rightarrow 0
$$
we obtain the family of maps
$$
\gamma^P_{QT}:\det(QT)\rightarrow \det(PT).
$$
Near $T_0$ we have the topological vector bundles coming from the families
$\{T\}\times \ker(PT)\rightarrow T$, $\{T\}\times \ker(QT)\rightarrow T$, and the trivial bundles
$\{T\}\times F/R(P)\rightarrow T$, and $\{T\}\times F/R(Q)\rightarrow T$, which fit well with the maps occurring in the exact sequence.
Hence the maps $\gamma^P_{QT}$ define a topological line bundle isomorphisms
$$
{\mathcal L}_{T_0,Q,\varepsilon}\rightarrow {\mathcal L}_{T_0,P,\varepsilon}.
$$
 Consider the transition map 
$$
\Phi_{T_1,Q_1,\varepsilon_1}\circ \Phi_{T_2,Q_2,\varepsilon_2}^{-1}:
{\mathcal L}_{T_2,Q_2,\varepsilon_2}|U\rightarrow 
{\mathcal L}_{T_1,Q_1,\varepsilon_1}|U
$$
where $U=\{T\ |\ \norm{T-T_1}<\varepsilon_1,\norm{T-T_2}<\varepsilon_2\}$. This map is a bijection and is  linear on the fibers. It suffices to show that the transition map is continuous. Let $T_3\in U$. Then $Q_1,Q_2\in \Pi_{T_3}$ and we pick $P\in \Pi_{T_3}$ satisfying
$P\leq Q_1$ and $P\leq Q_2$. We take $\varepsilon$ small enough so that $V:=\{T\ |\ \norm{T-T_3}<\varepsilon\}\subset U$
and consider
$$
\text{DET}(E,F)|V\xrightarrow{\Phi_{T_3,P,\varepsilon}} {\mathcal L}_{T_3,P,\varepsilon}.
$$
First of all we have  the following commutative diagram of bijections which are  linear in the fibers, 
$$
\begin{CD}
\text{DET}(E,F)|V @= \text{DET}(E,F)|V\\
@V \Phi_{T_2,P_2,\varepsilon_2} VV @V \Phi_{T_1,P_1,\varepsilon_1} VV \\
{\mathcal L}_{T_2,P_2,\varepsilon_2}|V @. {\mathcal L}_{T_1,P_1,\varepsilon_1}|V\\
@VVV   @VVV\\
{\mathcal L}_{T_3,Q,\varepsilon} @= {\mathcal L}_{T_3,Q,\varepsilon}
\end{CD}
$$
The bottom vertical arrows are topological bundle isomorphisms. The vertical compositions on the left and on the right are
the same map in view of Lemma \ref{revision_lem_1}. Hence the transition map $\Phi_{T_1,Q_1,\varepsilon_1}\circ \Phi_{T_2,Q_2,\varepsilon_2}^{-1}
$ over the set $V$ can  be written as the transition map associated with the two lower vertical arrows, but the latter is a topological bundle isomorphism.

Hence we have proved the following theorem.
\begin{theorem}
 $\text{DET}(E,F)$ has in a natural way the structure of a topological line bundle
over ${\mathcal Fred}(E,F)$.
\end{theorem}



\subsection{Orientations in the M-Polyfold Case}
Now we are ready to deal with the M-polyfold case. In the following we shall assume that our polyfolds and strong bundles
are modeled on sc-smooth retracts in sc-Hilbert spaces, so that the orientation discussion from the previous subsection is applicable.
A more general orientation discussion covering the Banach space case is contained in \cite{HWZ10,HWZ11}. 
Let $E\rightarrow X$ be a strong M-polyfold bundle and $f$ a sc-Fredholm section. Given a smooth point $x_0\in X$
we can construct near $x_0$ a local sc$^+$-section $s$ satisfying $s(x_0)=f(x_0)$. Taking any such section $s$, the linearization
of $f-s$ at $x_0$, denoted by 
$$
(f-s)'(x_0):T_{x_0}X\rightarrow E_{x_0}, 
$$
 is a well defined (linear) sc-Fredholm operator between sc-Hilbert spaces, see 
\cite{HWZ2,HWZ3}. Given two such sections $s_1$ and $s_2$ we deduce from $f-s_1 =f-s_2 + (s_2-s_1)$ and the property
$(s_2-s_1)(x_0)=0$, that the linearisations $(f-s_1)'(x_0)$ and $(f-s_2)'(x_0)$ differ by the linearisation $(s_2-s_1)'(0)$,
which is a linear sc$^+$-operator and therefore level-wise compact.  We recall from \cite{HWZ2} that sc-Fredholm operators stay
sc-Fredholm operators after a perturbation by  an sc$^+$-operator. 
\begin{definition} {\bf The set $\text{Lin}(f,x_0)$} consists of all linear sc-Fredholm operators
of the form $(f-s)'(x_0)+a$, where $s$ is a fixed   local sc$^+$-section satisfying $s(x_0)=f(x_0)$ and $a:T_{x_0}X\rightarrow E_{x_0}$ is any linear sc$^+$-operator. In a formula, 
$$
\text{Lin}(f,x_0)=\{ (f-s)'(x_0) + a\, \vert \, a\, \text{is an $\ssc^+$-operator}\}.
$$
We call $\text{Lin}(f,x_0)$ the set of linearisations of $f$ at the smooth point $x_0$. The definition of
$\text{Lin}(f,x_0)$ does not depend on the choice of the $\ssc^+$-section $s$ as along as $s(x_0)=f(x_0)$.
\end{definition}
The set  $\text{Lin}(f,x_0)$ is a convex set to which 
we shall refer as the family of linearisations of $f$ at $x_0$.
Every element in $\text{Lin}(f,x_0)$ is an sc-Fredholm operator. In particular,  viewing them
as operators
$$
T_{x_0}X\rightarrow E_{x_0},
$$
i.e. on level $0$, 
we obtain classical Fredholm operators between Hilbert spaces.  If $A_1$ and $A_2$ are two such operators, then $A_1-A_2$ is a compact operator, hence belonging to
the Banach space $K(T_{x_0}X,E_{x_0})$ of compact operators.  The space  $\text{Lin}(f,x_0)$ is a metric space  equipped with the metric 
$$
d(A_1,A_2)=\norm{A_1-A_2}_{{\mathcal L}(T_{x_0}X,E_{x_0})}.
$$
By the previous discussion we have for every
classical Fredholm operator $T$ its determinant $\text{det}(T)$ and conclude the following result.
\begin{proposition}
The set $\text{DET}(f,x_0)$, defined by
$$
\text{DET}(f,x_0)=\bigcup_{A\in \text{Lin}(f,x_0)} \{A\}\times \det(A), 
$$
has in a natural way the structure of a topological line bundle over $\text{Lin}(f,x_0)$.
\end{proposition}
In view of the 
continuous map $\text{Lin}(f,x_0)\rightarrow {\mathcal Fred}(T_{x_0}X,E_{x_0})$ , we  can view the line bundle above as the pull-back bundle
of the determinant bundle over the space of Fredholm operators.
Since the  base space $\text{Lin}(f,x_0)$ is contractible  our bundle is trivial
and has precisely two possible orientations. 
\begin{definition}
{\bf An orientation of the sc-Fredholm section}  $f$ of
the strong $M$-polyfold bundle  $E\rightarrow X$ at the smooth point $x_0$ is a choice of one of the possible two orientations of
$\text{DET}(f,x_0)$.
\end{definition}




We need the  notion of {\bf ``local continuation''} of the orientation. For the following constructions we shall assume the existence of an sc-smooth partitions of unity.  (This is only for convenience and not really necessary, see \cite{HWZ10} for the general argument.)


We start with an sc-Fredholm section $f$ of the strong bundle
$E\rightarrow X$ and write $E\rightarrow [0,1]\times X$ for the pull-back of $E$ via the projection map  $[0,1]\times X\rightarrow X$.
We shall always assume in the following that the M-polyfod $X$ has no boundary, i.e., $\partial X=\emptyset$. The more general argument in the boundary case  $\partial X\neq \emptyset$ will be given in 
\cite{HWZ10}. 

Following the constructions in \cite{HWZ3}, we 
consider   an sc-smooth path $\phi:[0,1]\rightarrow X$ connecting the smooth point $x_0=\phi(0)$ with the smooth point  $x_1=\phi(1)$.
Using a partition of unity argument the following two Lemmata are proved in \cite{HWZ3}.
\begin{lemma}\label{lem_graph_1}
There exists for the strong bundle $E\rightarrow [0,1]\times X$ an sc$^+$-section $s=s(t,x)$ which satisfies
$s(t,\phi(t))=f(\phi(t))$ for $t\in [0,1]$.  
\end{lemma}
The solution set,  consisting  of all $(t,x)\in [0,1]\times X$ solving the equation 
$f(x)-s(t,x)=0$, 
contains the graph of $\phi$.
\begin{lemma}  \label{lem_property_star}
There exist finitely many sc$^+$-sections $s_1,\ldots ,s_k$ of the bundle  $E\rightarrow [0,1]\times X$
such  that the sc-smooth Fredholm section $F$ of the bundle $E\rightarrow [0,1]\times {\mathbb R}^k\times X$,  defined by
$$
F(t,\lambda,x) = f(x)-s(t,x)-\sum_{i=1}^k \lambda_i\cdot s_i(t,x),
$$
has the following property $(\ast)$ at the points $(t,\phi(t))$, $t\in [0,1]$.
\begin{itemize}
\item[($\ast$)] For every $t\in [0,1]$,  the linearization of $F_t$ at the point $(0,\phi(t))$ is surjective.
\end{itemize}
Here $F_t:=F(t,\cdot ,\cdot )$ is the obvious section of $E\rightarrow {\mathbb R}^k\times X$.
\end{lemma}

The implicit function theorem  in  \cite{HWZ3} or \cite{HWZ10} implies that the solution set $\{F(t,\lambda,x)=0\}$  near
$\{(t,0,\phi(t))\ |\ t\in [0,1]\}$   is in a natural way a smooth manifold $M$. By the  property $(\ast)$,
M also
fibers over $[0,1],$
$$
p\colon M\rightarrow [0,1],\quad p(t,\lambda,x)\mapsto  t
$$
and  every fiber $M_t=p^{-1}(t)$ is a manifold as well.
Abbreviating by  $L_t:=T_{(t,0,\phi(t))}M_t$ the tangent space, the bundle  
$$
L=\bigcup_{t\in [0,1]} L_t
$$
is a smooth vector bundle over $[0,1]$ and   
$L_t$ is the kernel of the  linearisation $DF_t(0,\phi(t))$, denoted by $F_t'(0,\phi (t))$. There is the associated smooth line bundle
$$
\Lambda^{\textrm{max}}L\rightarrow [0,1].
$$
An orientation of any of the fibers $L_t$ (any of the lines  $\Lambda^{\textrm{max}}L_t$)  determines an orientation  of  all the other fibers.
It remains to relate these orientations to the orientations of $\det(  (f-s(t,\cdot ))'(\phi(t)) )$ for 
$t\in [0,1]$.
To this aim we introduce for fixed  $t$  the sequence 
\begin{equation}\label{eexact}
\begin{gathered}
0\rightarrow \ker( (f-s(t,\cdot ))'(\phi(t)) )\xrightarrow{j} \ker({F}_t'(0,\phi(t)))\xrightarrow{p}\\
\xrightarrow{p} {\mathbb R}^k\xrightarrow{c} E_{\phi(t)}/R((f-s(t,\cdot ))'(\phi(t)))\rightarrow 0.
\end{gathered}
\end{equation}
Here $j$ is the inclusion map and $p$ the projection onto the ${\mathbb R}^k$-factor. The map $c$ is defined
by 
$$
c(\lambda) =\left(\sum_{i=1}^k \lambda_is_i(t,\phi(t))\right)+ R((f-s(t,\cdot ))'(\phi(t))).
$$
\begin{lemma}\label{lem_exact_seq_2}
The sequence \eqref{eexact} is exact.
\end{lemma}
\begin{proof}
The inclusion map $j$ is injective and $p\circ j=0$. From  $p(\lambda,h)=0$ it follows that 
$\lambda=0$
so that $h\in \ker((f-s(t,\cdot ))'(\phi(t)))$. If $(\lambda,h)\in \ker(F_t'(0,\phi(t)))$,  then $\sum \lambda_is_i(t,\phi(t))$
belongs to the image of $(f-s(t,\cdot ))'(\phi(t))$ which implies $c\circ p=0$. It is also immediate that an
element $\lambda\in {\mathbb R}^k$ satisfying  $c(\lambda)=0$ implies that $\sum \lambda_is_i(t,\phi(t))$ belongs to the image
of $(f-s(t,\cdot ))'(\phi(t))$. This allows us to construct an element $(\lambda,h)\in \ker(F_t'(0,\phi(t)))$ satisfying  $p(\lambda,h)=\lambda$. 
Finally, it follows from the property $(\ast)$ in Lemma \ref{lem_property_star}  that the map $c$ is  surjective. 
The proof of Lemma 
\ref{lem_exact_seq_2} is complete.
\end{proof}

In view of the exactness of the sequence \eqref{eexact} we deduce from Definition
 \ref{lem_isom_phi_1}, for every $t\in [0,1]$,  a uniquely defined isomorphism.

$$
\Psi_t:\Lambda^{\textrm{max}}{\mathbb R}^k \otimes \det(f-s(t,.)'(\phi(t)))\rightarrow
\Lambda^{\textrm{max}} \ker({F}_t'(0,\phi(t))).
$$
There is a uniquely determined smooth structure on  the line bundle 
$$
\bigcup_{t\in [0,1]} \det((f-s(t,\cdot ))'(\phi(t)))\rightarrow [0,1]
$$
 such  that 
the maps $\Psi_t$, $t\in [0,1]$,  are smooth line bundle isomorphism.

The following lemma is proved in \cite{HWZ10}. 
\begin{lemma} The smooth structure on the line bundle  
$$
\bigcup_{t\in [0,1]} \det((f-s(t,\cdot ))'(\phi(t)))\rightarrow [0,1]
$$
 does not depend
on the choice of the  $\ssc^+$-sections $s_i(t,x)$ having the property $(\ast)$ of 
Lemma \ref{lem_property_star}.
\end{lemma}

By construction,  $(f-s(t,\cdot ))'(\phi(t))\in \text{Lin}(f,\phi(t))$. Using the above isomorphism 
$\Psi_t$ and
the standard orientations  for ${\mathbb R}^k$ the following holds true. If for one $t_0 \in [0,1]$ we have an orientation
$\mathfrak{o}_{\phi(t_0)}$ of  $\text{DET}(f,\phi(t_0))$, then we get an orientation of 
$\det((f,s(t_0,\cdot ))'(\phi(t_0)))$ which can be propagated via the determinant line  bundle to an orientation
$\mathfrak{o}_{\phi(t)}$ of  $\text{DET}(f,\phi(t))$ for every $t\in [0,1]$. 
 
 A priori,  the method of propagation of an orientation might still depend on the choice of the $\ssc^+$-section $s(t,x)$ satisfying  $s(t,\phi(t))=f(\phi(t))$.
That  this is not the case is proved in \cite{HWZ10}.  Moreover,  an sc-smooth map $\Phi:[0,1]\times [0,1]\rightarrow X$,
 satisfying $\Phi(s,i)=\Phi(0,i)$ for $i=0,1$ may be viewed as a homotopy between $\phi_i:=\Phi(i,.)$ for $i=0,1$.
 One can carry out the above constructions also in this case. The conclusion  is the following result.
 \begin{lemma}
 Given an sc-smooth path $\phi:[0,1]\rightarrow X$ connecting the smooth points $x_0$ and $x_1$,
 the propagation of an orientation of $\text{DET}(f,\phi(t))$ does not depend
 on the choices of the $\ssc^+$-sections $s(t,x)$ and $s_i(t, x)$.  Of course, it might depend on the path connecting $x_0$ and $x_1$.
However, if two smooth paths connect the same points and are sc-smoothly homotopic, then they 
 propagate the initial orientation to the same orientation at the end point.
 \end{lemma}
As before we assume also in the following that 
the M-polyfold $X$ admits sc-smooth partitions of unity. It comes handy for the constructions in \cite{HWZ3},  to which we  have refered  for the proofs of the Lemmata \ref{lem_graph_1} and \ref{lem_property_star} above.
As already pointed out, the  propagation of an orientation along a path  can be established without the requirement of the existence of an sc-smooth partition of unity, \cite{HWZ10}.

\begin{definition} Let $E\rightarrow X$ be a strong bundle over the M-polyfold $X$ without boundary and let $f$ be an sc-Fredholm section.  An {\bf orientation $\mathfrak{o}$ for $f$}  consists of a choice of orientation $\mathfrak{o}_x$ of $\text{DET}(f,x)$ at  every smooth point $x\in X$, such  that
along  every sc-smooth path $\phi:[0,1]\rightarrow X$,  the propagation of the orientation $\mathfrak{o}_{\phi(0)}$ 
is the orientation $\mathfrak{o}_{\phi(1)}$ of 
$\text{DET}(f,\phi (1))$.
\end{definition}
In general,  it is possible (not for Gromov-Witten)
that $\phi(t)=\phi(t')$ for some  $t\neq t'$ but  the associated orientations are opposite.

\begin{proposition}
Assume that $E\rightarrow X$ is a strong bundle over the M-polyfold $X$ and $f$ an {\bf oriented} proper sc-Fredholm section.
Suppose that for every solution $x\in f^{-1}(0)$ the linearization $f'(x)$ is onto. Then the solution set $M=f^{-1}(0)$ is a smooth compact
orientable manifold inheriting a natural orientation from the orientation $\mathfrak{o}$ of $f$.
\end{proposition}
\begin{proof}
From the implicit function theorem for sc-Fredholm section we deduce that $M$ is a smooth manifold,
which in addition is compact, since $f$ is proper. Then $T_xM =\ker(f'(x))$ for $x\in M$ and using that
$$
\Lambda^{max} T_xM\simeq \Lambda^{max} T_xM \otimes {\mathbb R} =\det(f'(x))
$$
we see that the orientation $\mathfrak{o}_x$  determines an orientation on the tangent space $T_xM$ which we also denote by  $\mathfrak{o}_x$.  Due to the property of propagation 
along paths,  the orientation of $T_yM$ for $y$ near $x\in M$ is precisely the orientation 
$\mathfrak{o}_y$.
\end{proof}

\subsection{Orientations in the Polyfold Case}\label{SS5.11}
In the case of a strong polyfold bundle $W\rightarrow Z$,  an sc-mooth Fredholm section $f$ is represented
by an sc-smooth section functor $F$ of a strong bundle 
$(E\rightarrow X, \mu)$
over the ep-groupoid $X$. 



We consider a morphism 
$\phi_0:x_0=s(\phi_0)\rightarrow y_0=t(\phi_0)$, denoting by $s$ and $t$ the source and  target maps from the morphism set of the ep-groupoid $X$ to its object set.
Associated with $\phi_0$ is the 
germ of an sc-diffeomorphism 
$\Phi=t\circ s^{-1}: {O}(x_0)\rightarrow {O}(y_0)$ between open neighborhoods. Its derivative at $x_0$ is, by definition,  the tangent map $T\phi_0:T_{x_0}X\rightarrow T_{y_0}X$. We denote by $\wh{\phi}_0:E_{x_0}\rightarrow E_{y_0}$ the lift of $\phi_0$,  viewed as a linear operator.  
More precisely,  $\wh{\phi}_0=\mu (\phi_0,\cdot ):E_{x_0}\rightarrow E_{y_0}$ where the sc-smooth strong bundle map $\mu\colon {\bf E}\to E$ satisfies the properties of Definition \ref{stbundleep}.

\begin{definition}
Consider an operator $L\in \text{Lin}(F,x_0)$ and let $\phi_0:x_0\rightarrow y_0$ be a morphism. The {\bf push forward
of $L$}, denoted by ${(\phi_0)}_\ast L$,  is the  linear sc-Fredholm operator belonging  to the set $\text{Lin}(F,y_0)$ defined by
\begin{equation}\label{po<po}
{(\phi_0)}_\ast L = \what{\phi}_0\circ L\circ {(T\phi_0)}^{-1}.
\end{equation}
If $\mathfrak{o}$ is an orientation of  $\det(L)$ defined by the vector $(h_1\wedge\ldots \wedge h_k)\otimes (h_1^\ast\wedge\ldots \wedge h_\ell^\ast)$, then the push-forward orientation ${(\phi_0)}_\ast\mathfrak{o}$ of  ${(\phi_0)}_\ast L$ is defined by the vector
$(T\phi_0(h_1)\wedge..\wedge T\phi_0(h_k))\otimes (h_1^\ast\circ \what{\phi}_0^{-1}\wedge\ldots \wedge h_\ell^\ast\circ \what{\phi}_0^{-1})$.
\end{definition}
It is easy to see  that (\ref{po<po}) defines an element in $\text{Lin}(F,y_0)$.
In view of the discussion in the previous subsection,   the proof of the following lemma is straightforward.
\begin{lemma}
If $\phi:x\rightarrow y$ is a morphism between smooth points, then
the map $L\rightarrow \phi_\ast(L) $ defines a topological isomorphism of line bundles
$$
\phi_\ast :\text{DET}(F,x)\rightarrow \text{DET}(F,y),
$$
via $(L,(h_1\wedge\ldots \wedge h_k)\otimes (h_1^\ast\wedge\ldots \wedge h_l^\ast))\rightarrow
(\phi_\ast L, (T\phi(h_1)\wedge\ldots \wedge T\phi(h_k))\otimes (h_1^\ast\circ \what{\phi}^{-1}\wedge\ldots \wedge h_l^\ast\circ \what{\phi}^{-1}))$. In particular,  if   $\mathfrak{o}$ is an orientation
of  $\text{DET}(F,x)$,  we obtain the  induced orientation $\phi_\ast\mathfrak{o}$ of $\text{DET}(F,y)$.
\end{lemma}
\begin{remark}
A particular case arises  if the morphism is an automorphisms $\phi:x\rightarrow x$ between the smooth points $x\in X$.  It gives
us a bundle automorphisms  of $\text{DET}(F,x)$.  In general, an automorphism can act in an orientation-preserving or an orientation-reversing
way. We shall denote the automorphism group of $x$ by $\text{Aut}(x)$. In the case that the automorphisms always act in an orientation-preserving way,  we  conclude  
$\phi_\ast\mathfrak{o}=\psi_\ast \mathfrak{o}$
for arbitrary morphisms $\phi,\psi:x\rightarrow y.$
\end{remark}


If $E\rightarrow X$ and $E'\rightarrow X'$ are two strong bundles over ep-groupoids, we let 
$\Gamma:E\rightarrow E'$ be a strong bundle equivalence covering the equivalence $\gamma:X\rightarrow X'$ in the sense of Definition 2.17 in \cite{HWZ3.5}. 
Let $F$ and $G$ be sc-Fredholm sections of these bundles satisfying  $\Gamma^\ast(G)=F$.
Then given  the smooth points $x\in X$  and  $y'=\gamma(x)$, we define  the  topological  isomorphism
$$
\text{Lin}(F,x)\rightarrow \text{Lin}(G,y),\quad  L\rightarrow \Gamma_\ast(L), 
$$
by
$$
\Gamma_\ast(L) = \Gamma_x \circ L\circ T\gamma(x)^{-1}.
$$
To verify that $\Gamma_\ast(L)$ is  well-defined, we  take a germ of a sc$^+$-section $u$ satisfying  $F(x)-u(x)=0$ and 
let $v$ be the push-forward germ.  Recalling that  a general element $L$ in the set $\text{Lin}(F,x)$  has the form 
$(F-u)'(x)+a$, where $a$ is an $\ssc^+$-operator, 
we compute
$$
\Gamma_\ast((F-u)'(x)+a) = (G-v)'(y) +\Gamma_\ast(a)=: (G-v)'(y) +b.
$$
The section  $b$ is also an $\ssc^+$-section, hence proving the claim.  


We can go one step further and obtain along the same lines an isomorphism 
$$
{(\Gamma_x)}_\ast:\text{DET}(F,x)\rightarrow \text{DET}(G,y)
$$
between topological line bundles.
\begin{lemma}
Assume that $E\rightarrow X$ and $E'\rightarrow X'$ are strong bundles over ep-groupoids coming with the sc-Fredholm sections $F$ and $G$. Also assume that $\Gamma:E\rightarrow E'$ is a strong bundle equivalence covering the equivalence  $\gamma:X\rightarrow X'$ of ep-groupoids
and satisfying  $\Gamma^\ast G=F$.  Then for every smooth $x\in X$ and $y=\gamma(x)$,  we have an induced
topological bundle isomorphism
$$
{(\Gamma_x)}_\ast: \text{DET}(F,x)\rightarrow \text{DET}(G,y)
$$
\end{lemma}
\begin{proof}
For $\gamma$ we have the tangent map $T\gamma(x):T_xX\rightarrow T_yX'$. Moreover,  $\Gamma$ gives us an sc-bundle isomorphism
$\Gamma_x:E_x\rightarrow E_y'$. We define
$$
{(\Gamma_x)}_\ast(L) = \Gamma_x \circ L \circ T\gamma(x)^{-1}.
$$
The vectors in $\det(L)$ are pushed forward by the usual coordinate change.
This completes the proof.
\end{proof}

\begin{definition}\label{definition_sc_fred_orient}
Let $E\rightarrow X$ be a strong bundle over an ep-groupoid.
Then an {\bf sc-Fredholm section  $F$ is  called orientable}  if  we can choose for every smooth point $x\in X$ an orientation $\mathfrak{o}_x$
of $\text{DET}(F,x)$ such  that the following holds.
\begin{itemize}
\item[(1)] For every smooth path $\varphi:[0,1]\rightarrow X$, the orientation $\mathfrak{o}_{\varphi(1)}$ is the continuation of $\mathfrak{o}_{\varphi(0)}$.
\item[(2)] For every morphism $\phi:x\rightarrow y$ between smooth points the push forward of $\mathfrak{o}_x$ is $\mathfrak{o}_y$.
\end{itemize}
An {\bf orientation of  the sc-Fredholm section $F$}  of $E\rightarrow X$ is given by a choice
of  an orientation $\mathfrak{o}_x$ of  $\text{DET}(F,x)$ for every smooth $x$
satisfying the above properties $(1)$ and $(2)$. We shall write $\mathfrak{o}$ for an orientation of $F$. The orientation $\mathfrak{o}$ associates with every smooth point $x\in X$ the orientation $\mathfrak{o}_x$ of the topological line bundle $\text{DET}(F,x)\rightarrow \text{Lin}(F,x)$.
\end{definition}


We now assume that  $\mathfrak{o}$  is an orientation of  the sc-Fredholm section $F$ of the strong bundle $E\rightarrow X$.
If $\Gamma:E\rightarrow E'$ is a strong bundle equivalence covering the equivalence $\gamma:X\rightarrow X'$, 
and if $G$ is an sc-Fredholm section of the strong bundle $E'\to X'$ satisfying $\Gamma^\ast G=F$, then there is an induced orientation $\Gamma_\ast \mathfrak{o}$ of the sc-Fredholm section  $G$. It is defined as follows. If  $y\in X'$,  we find $x\in X$ and a morphism $\phi:\gamma(x)\rightarrow y$. Since $F$ is orientable, 
the automorphism group $\text{Aut}(x)$  of $x$ acts in an orientation-preserving way on $\text{DET}(F,x)$. We have the topological 
bundle isomorphism ${(\Gamma_x)}_\ast :\text{DET}(F,x)\rightarrow \text{DET}(G,\gamma(x))$. The automorphism group $\text{Aut}(\gamma (x))$ of $\gamma(x)$ is isomorphic to $\text{Aut}(x)$ and acts also  in an orientation-preserving way. Due to the latter,  the push forward of the 
orientation via the morphism $\phi:\gamma(x)\rightarrow y$ to $\text{DET}(G,y)$ does not depend on the actual choice of the morphism $\phi$.
We also note that, conversely,  given an orientation of the sc-Fredholm section  $G$ we obtain an orientation of the section $F$.  Hence we have the operations
$$
\mathfrak{o}\rightarrow\Gamma_\ast \mathfrak{o}\ \ \text{and}\ \ \mathfrak{o}'\rightarrow\Gamma^\ast\mathfrak{o}'
$$
which associate to an orientation of $F$ an orientation of $G$ and, conversely,  to an orientation of $G$ an orientation of $F$.
These operations are mutually inverse.  

More generally,  if we have two sc-Fredholm sections $F$ and $G$ of the strong bundles $E\rightarrow X$ and $E'\rightarrow X'$, respectively,  and if $\mathfrak{A}:E\Longrightarrow E'$ is a generalized bundle isomorphism satisfying $\mathfrak{A}_\ast F=G$, then an orientation on either side determines an orientation on the other side.
This is an immediate consequence of the previous discussion and the definition of a generalized strong bundle isomorphism in Definition 2.20 of \cite{HWZ3.5}. 
Now,  we are ready for the following definition.


\begin{definition}
Let $f$ be an sc-Fredholm section of the strong polyfold bundle $W\rightarrow Z$.  We call $f$ {\bf orientable} provided
there exists a model $E\rightarrow X$ and an sc-smooth section functor $F$ representing $f$
which admits an orientation.  An {\bf orientation of $f$}  is by definition the  choice of an orientation of $F$ for a suitable model.
\end{definition}

The definition does not depend on the choice of the model because   the orientation of one model determines  orientations of every other model,   by means of a generalized strong bundle isomorphism. 

\begin{remark} We would like to point out that in SFT the orientability is sometimes obstructed due to automorphisms acting in an orientation-reversing way.  The algebraic constructions in SFT have to take this into consideration. 
In the case of Gromov-Witten theory the situation is more pleasant because there is even a natural orientation, called the complex orientation, which we shall discuss next.
\end{remark}

\section{The Canonical Orientation in Gromov-Witten Theory}\label{orientations}

We denote by $Z$ the space of stable curves into  to  a closed symplectic manifold $(Q,\omega)$. 
Having fixed a compatible almost complex structure $J$ on $Q$ we have the associated strong bundle
$W\rightarrow Z$ and the sc-smooth Cauchy-Riemann section $\ov{\partial}_J$.
  Our main result in this section is the following theorem.
\begin{theorem}\label{BINGO}
The Cauchy-Riemann section $\ov{\partial}_J$ of the strong bundle $W\rightarrow Z$ is orientable. Moreover it has a natural orientation, called the complex orientation.
\end{theorem} 
In order to briefly outline the strategy of the proof we recall that the models $F:X\rightarrow E$ are constructed from local models
 $F_\cg:\cg\rightarrow \what{\cg}$. We shall show that these local models have canonical orientations, called complex orientations. They 
are compatible with the morphisms in $M(\cg,\cg')$ and $M(\what{\cg},\what{\cg}')$, respectively.
From this Theorem \ref{BINGO} will then follow easily.

\subsection{A Basic Class of Linear Fredholm Operators}
By ${\mathcal J}={\mathcal J}(Q,\omega)$ we denote the contractible space of compatible smooth  almost complex structures on 
the closed symplectic manifold $(Q,\omega)$. We consider a closed smooth oriented   surface $S$ equipped with the finite set $M$ of ordered marked points.   By $\mathfrak{j}=\mathfrak{j}_{(S,M)}$ we denote the collection of smooth almost complex structures on $S$ which induce the given orientation. 



Next we consider the collection of all {\bf un-noded stable} maps $\alpha=(S,j,M,\emptyset,u)$, where $u:S\rightarrow Q$ is smooth and  $j\in \mathfrak{j}$.
 We associate with $\alpha$ the Hilbert space
$H^3(u^\ast TQ)$.  Given the  almost complex structure $J\in {\mathcal J}$ on $Q$, 
we denote by $\Omega^{0,1}_{j,J}$ the bundle over $S\times Q$, whose fiber over the point $(z,q)$ consists of all complex anti-linear maps $(T_zS,j)\rightarrow (T_qQ,J)$.  Whenever  we write $u^\ast\Omega^{0,1}_{j,J}$ for a smooth map $u:S\rightarrow Q$ we actually mean the pullback of the bundle $\Omega^{0,1}_{j,J}$  by the graph map $\text{gr}(u):S\rightarrow S\times Q$. 

\begin{definition} \label{<<<}
 {\bf The collection ${\mathcal F}(S,M)$}  consists of all linear Fredholm operators
\begin{equation}\label{999}
L: H^3(u^\ast TQ)\rightarrow H^2(u^\ast\Omega_{j,J})
\end{equation}
for  suitable $J\in {\mathcal J}$, $j\in \mathfrak{j}$,  and smooth un-noded stable maps $\alpha=(S,j,M,\emptyset, u)$, 
of the form
\begin{equation}\label{n<n}
L(\eta)= \nabla\eta +J(u)(\nabla\eta) j +A(\eta).
\end{equation}
Here the covariant derivative  $\nabla$,   associated with a  complex connection for $(TQ,J)\rightarrow Q$, satisfies $\nabla J=0$. Moreover $A$ is a compact operator. 


Fixing the Riemann surface $(S, j, M)$,  {\bf we  denote by 
${\mathcal F}_{\alpha}$} the collection of all Fredholm operators  
$L$  of the  form \eqref{n<n}, associated  with the stable map 
$\alpha=(S, j, M, \emptyset, u)$ and $J$ varying in ${\mathcal J}$.

\end{definition}
\begin{remark}
Note that among the operators in ${\mathcal F}(M,S)$ are linear sc-Fredholm operators if the spaces 
$H^3(u^\ast TQ)$ and $H^2(u^\ast\Omega_{j,J})$ are equipped with their sc-structure.
Although the sc-structure is important in orientation questions,  as shown in the previous subsection,
it will not be needed for a while, but  ultimately it will be incorporated.
\end{remark}

For fixed $u$, $J$, and $j$ the collection of all operators $L$ of the form  \eqref{999} and \eqref{n<n}  is  a convex space, which is contractible. 
Also the collections ${\mathcal J}$ and $\mathfrak{j}$ are contractible. This immediately implies the following lemma.
\begin{lemma}
The space of Fredholm operators of the form \eqref{999}  and \eqref{n<n}, where $u$ is fixed, equipped with the operator norm,  is contractible.
\end{lemma}

\begin{remark} Let us observe that a given $L$ in general can be written
in different ways. However, if 
$$
\nabla\eta +J(u)(\nabla\eta) j +A(\eta) =\nabla'\eta +J'(u)(\nabla'\eta) j' +A'(\eta) \quad  \text{for all $\eta$}
$$
we must always  have $J=J'$, and $j=j'$ because this  is  part of the principal symbol.  Note that the difference 
$\nabla-\nabla'$ is a compact operator.
\end{remark}
If  the operator $L\in {\mathcal F}(S,M)$ is  associated with the almost complex structures $J$ and $j$, we can turn the domain and codomain of $L$ into complex vector spaces by defining $i\eta:=J(u)\eta$ for the domain and $i\xi:=J(u)\circ \xi$ for the codomain.
The operator  $L$ is called complex linear if  $L(i\eta) = iL(\eta)$. This gives in certain cases an additional structure on $L$. Let us observe that if $L\in {\mathcal F}_\alpha$, as described in Definition \ref{<<<},  so is $L'$,  defined by
$$
L'(\eta)=  \nabla\eta +J(u)(\nabla\eta) j. 
$$
The  operator $L'$ is complex linear. This follows from  
$\nabla (J(u)\eta)=J(u)\nabla \eta$ which is implied by  $\nabla J=0$.

For fixed $(S,M)$,  we consider two operators
 $L_0\in {\mathcal F}_{\alpha_0}$ and $L_1\in {\mathcal F}_{\alpha_1}$ associated with the stable maps  $\alpha_i=(S,j_i,M,\emptyset, u_i)$,  and the almost complex structures $J_i$ and $j_i$ for $i=0,1$.
 If $u_0$  and $u_1$ smoothly homotopic by the homotopy $u^t$, $0\leq t\leq 1$, we can construct a smooth path $L_t$ in  ${\mathcal F}$ connecting 
 $L_0$ with $L_1$ of the form
$$
L_t = \nabla^t(\cdot ) +J^t(u^t)(\nabla^t(\cdot ))j^t +A^t(\cdot ).
$$
Here $J^t$ is a smooth path in ${\mathcal J}$ connecting $J_0$ with $J_1$ and $j^t$ is a smooth path in $\mathfrak{j}$ connecting $j_0$ with $j_1$.
The covariant derivatives $\nabla^t$ are associated with the tangent bundle $(TQ, J^t)\to Q$ and satisfy 
$\nabla^tJ^t=0$. The data indexed by $t$ on the right-hand side of $L_t$ depend smoothly on $t$. The domains  of the operators  $L_t$  form  a smooth Hilbert space bundle over $[0,1]$  having the  fiber $H^3({(u^t)}^\ast TQ)$ over $t$, 
whereas the codomains  form a smooth bundle over $[0,1]$. To the path $(L_t)_{0\leq t\leq 1}$ there belongs the determinant bundle having the fiber $\det (L_t)$ over $t\in [0,1]$. 
An orientation of $\det (L_0)$ determines
an orientation of $\det(L_1)$, called the orientation continued along the path $(L_t)_{0\leq t\leq 1}$. In the following  shall refer to $(L_t)$ as a
{\bf smooth path of operators in ${\mathcal F}(S,M)$}.

The fundamental result about the operators in ${\mathcal F}(S, M)$ is  the  following proposition.
\begin{proposition}\label{p<ppp}
For every Fredholm operator $L\in {\mathcal F}(S,M)$ there exists a  natural orientation $\mathfrak{o}_L$ of  $\det(L)$
characterized by the following two requirements.
\begin{itemize}
\item[(1)] Along  every smooth path $(L_t)_{0\leq t\leq 1}$ in ${\mathcal F}(S,M)$, the continuation of $\mathfrak{o}_{L_0}$ is the orientation $\mathfrak{o}_{L_1}$.
\item[(2)] If $L$ is complex linear,  then $\mathfrak{o}_L$ is defined by the vector 
$$
(e_1\wedge ie_1\ldots \wedge e_n\wedge  ie_n)\otimes (h_1^\ast\wedge ih^\ast_1\ldots \wedge h_k\wedge ih^\ast_k),
$$
where $e_1,\ldots \, e_n$ is a complex basis of  $\ker(L)$ and $h_1^\ast,\ldots, h_k^\ast$  is a complex basis of  $\text{coker}(L)^\ast$.
This orientation does not depend on choices involved and is called the {\bf complex orientation
of the (real) determinant of $L$}. 
\end{itemize}
\end{proposition}
\begin{proof}
We define an equivalence relation by calling two Fredholm operators in $F(S,M)$ equivalent if 
they can be connected by a smooth path of operators. 
In  an equivalence class $P$  we find a complex linear operator $L_0$  associated with 
$J_0$ and the smooth stable map $\alpha_0=(S,j_0,M,\emptyset,u_0)$, defined by
$$
L_0\eta  =\nabla\eta +J_0(u_0)(\nabla\eta) j_0. 
$$
The operator $L_0$  is complex linear since, by assumption,  $\nabla J=0$. We fix the complex orientation $\mathfrak{o}_{L_0}$.

If  $L_1\in P$ we take a smooth path $(L_t)$ of operators connecting $L_0$ with $L_1$ and  
 equip $\det(L_1)$ with the continuation of the already chosen orientation 
of $\det(L_0)$ along the  determinant bundle of the path.  A priori the orientation $\mathfrak{o}_{L_1}$ might depend on the choice of the path.
If we take another path,  the two paths together define a smooth loop $\theta\mapsto  L_\theta$, $\theta\in S^1$, 
of  the form
$$
L_\theta(\eta) =\nabla^\theta\eta +J(u^\theta)(\nabla^\theta\eta)j^\theta +A^\theta(\eta),
$$
where $\nabla^\theta J^\theta=0$. Our orientation is well-defined precisely if the determinant bundle $\det (L_\theta)$ over
$S^1$ is orientable.  In order to prove this, 
we homotope the family $\theta\mapsto  L_\theta$ to a family of the form
$$
L^0_\theta(\eta)=\nabla^\theta\eta +J(u^\theta)(\nabla^\theta\eta)j^\theta,
$$
consisting   of a complex linear operator over every fiber. This implies that the family $(L^0_\theta)$ over $S^1$
has an orientable determinant bundle. Hence the original loop is also orientable. A priori the definition of the orientation of the operators in $P$ might still depend on the choice of  the operator $L_0\in P$.
However, if $L_0'$ is a second complex linear operator in $P$, we connect $L_0$ with  $L_0'$ by a path of complex linear operators and see that the complex orientation for $L_0'$ is the one obtained from $L_0$ by propagation along the  path.
This proves that the definition of the orientation for the operators in $P$ is independent of all choices.
We carry out the process for all equivalence classes $P$ and the proof of Proposition \ref{p<ppp} is complete.
\end{proof}

\begin{definition}
The assignment $L\rightarrow \mathfrak{o}_L$ is called (in view of property (2) in Proposition \ref{p<ppp}) the {\bf complex orientation of  ${\mathcal F}(S,M)$},
and for each individual operator $L$, whether  complex linear or not, it is called the {\bf complex orientation of  $L$}.
We also refer interchangeably to $\mathfrak{o}_L$ as the complex orientation for $L$ or $\det(L)$.
\end{definition}


Next we describe  what happens under certain coordinate changes. We assume that the two smooth un-noded stable maps $\alpha=(S,j,M,\emptyset,u)$
and $\alpha'=(S',j',M',\emptyset, u')$ are isomorphic by the isomorphism 
$$
\phi:\alpha\rightarrow\alpha'.
$$

We shall define a map ${\mathcal F}_{\alpha}\rightarrow {\mathcal F}_{\alpha'}$ from ${\mathcal F}_{\alpha}\subset {\mathcal F}(S,M)$ to  ${\mathcal F}_{\alpha'}\subset {\mathcal F}(S',M')$.
Given  the Fredholm operator ${\bf L}$  in ${\mathcal F}_{\alpha}$,  we define ${\bf L}'=\phi_\ast{\bf L}\in 
{\mathcal F}_{\alpha'}$ by the formula
$$
{\bf L}'(\eta') := ({\bf L}(\eta'\circ\phi))T\phi^{-1}, \quad 
\eta'\in H^3((u')^*TQ).
$$
It is useful to recall that, by definition of an isomorphism, $u'(\phi (z))=u(z)$ for all $z\in S$, so that 
$\eta'\circ \phi\in H^3(u^*TQ).$
\begin{lemma}
If  ${\bf L}\in {\mathcal F}_{\alpha}$,  the push forward operator ${\bf L}'=\phi_\ast{\bf L}$ belongs to ${\mathcal F}_{\alpha'}$.
\end{lemma}
\begin{proof}
In order to verify  that the above definition of  ${\bf L}'$ has the required  form we shall use that, by definition of an
isomorphism, $T\phi (z)\cdot j(z)=j'(\phi (z))T\phi (z)$, $z\in S$, and compute, abbreviating  $\eta=\eta'\circ\phi$, 
\begin{equation*}
\begin{split}
{\bf L}'(\eta')&
({\bf L}(\eta'\circ \phi)) T\phi^{-1}\\
&=[\nabla\eta + J(u)(\nabla\eta)j + A(\eta)]T\phi^{-1}\\
&=[(\nabla\eta')T\phi +J(u'\circ\phi)((\nabla\eta')T\phi)j +A(\eta)]T\phi^{-1}\\
&=[(\nabla\eta')T\phi +J(u'\circ\phi)((\nabla\eta')T\phi)j +A'(\eta')T\phi]T\phi^{-1}\\
&=([\nabla\eta' +J(u')(\nabla\eta')j']T\phi)T\phi^{-1}+A'(\eta')\\
&=\nabla\eta' +J(u')(\nabla\eta')j' + A'(\eta').
\end{split}
\end{equation*}
\end{proof}
If the  orientation $\mathfrak{o}$ of ${\bf L}$ is defined by  the vector
$$
(h_1\wedge..\wedge h_k)\otimes(h_1^\ast\wedge\ldots \wedge h_l^\ast),
$$
then the associated orientation $\phi_{\ast}\mathfrak{o}$ of  $\phi_\ast {\bf L}$, called the {\bf orientation obtained by coordinate change},  is given by the
vector
$$
(h_1\circ\phi^{-1}\wedge\ldots \wedge h_k\circ\phi^{-1})\otimes ( h_1^\ast\circ  T\phi^{-1}\wedge\ldots \wedge h_l^\ast\circ T\phi^{-1}).
$$
In the case that ${\bf L}$ is complex linear the same is true for $\phi_\ast {\bf L}$ and the coordinate change 
maps the complex orientation to the complex one. Since the complex orientation for the operators in ${\mathcal F}_{\alpha}$
as well as in ${\mathcal F}_{\alpha'}$ enjoy the continuation along path property, it follows 
 by the same type of (homotopy) argument already used before,
  that $\phi_{\ast}\mathfrak{o}_{\bf L} = \mathfrak{o}_{\phi_\ast {\bf L}}$,
 i.e. the coordinate change maps the complex orientation to the complex orientation.
 Hence we have proved.
\begin{proposition}\label{m<0}
If $\phi:\alpha\rightarrow\alpha'$ is an isomorphism between un-noded smooth stable maps and ${\bf L}\in {\mathcal F}_\alpha$,
then the complex orientation $\mathfrak{o}_{\bf L}$ is mapped via $\phi$ to the complex orientation 
$\mathfrak{o}_{{\bf L}'}$ of the push-forward operator ${\bf L}':=\phi_\ast{\bf L}\in {\mathcal F}_{\alpha'}$.
\end{proposition}

\subsection{Modifications of the  Basic Class}
Up to now the stability of the stable map $\alpha$ did not play any role. However, this will change now. We fix $(S,M)$ in the definition of the space ${\mathcal F}(S, M)$. The following discussion will focus on operators which we might consider as finite-dimensional modifications of Fredholm operators. 



Our aim is to establish canonical orientations (again called the complex orientations) for these modified Fredholm operators and to study their behavior under 
coordinate changes which are more general than those considered so far. 

We recall that the stability of a smooth stable map 
$\alpha=(S, j, M, \emptyset, u)$ requires either that 
$(S,j,M)$ is a stable Riemann surface, or, if this is not the case, that the map $u$ satisfies $\int_S u^\ast\omega>0$.

\begin{definition}
A {\bf stab-set} $\Xi$ for the smooth stable map $\alpha=(S, j, M, \emptyset, u)$ is a finite subset $\Xi$  of $S\setminus M$ having the property, that for every $z\in \Xi$
the vector space  $R(Tu(z))$, i.e.,   the image of the tangent map $Tu(z)$,  is  a symplectic subspace of the tangent space $(T_{u(z)}Q, \omega(u(z)))$,  and the orientation induced by $\omega(u(z))$ is the same as the orientation  induced 
from $(T_zS,j)$ via the tangent map  $Tu(z)$.  
\end{definition}

An example  of a stab-set is the stabilization set of a smooth un-noded  stable map as introduced in Definition \ref{stab-f}. In contrast to the stabilization set, the stab-set is not required to have any properties  related to the automorphim group, and the Riemann surface $(S,j,M\cup\Xi)$ is also not required to be stable.
The empty stab-set is a possible stab-set. 

For every point $z\in \Xi$ we introduce the set ${\mathcal H}_z$ consisting of all linear 
subspaces of $T_{u(z)}Q$ of codimension $2$ which are transversal to $R(Tu(z))$.
The set ${\mathcal H}_z$ contains, for example, the symplectic complement of 
$R(Tu(z))$, defined by
$$R(Tu(z))^\omega=\{v\in T_{u(z)}Q\, \vert\, \text{$\omega (u(z))(v, w)=0$ for all $w\in R(Tu(z))$}\}.$$

By ${\mathcal H}$ we denote the collection of all $H={(H_z)}_{z\in\Xi}$ and $H_z\in {\mathcal H}_z$ for $z\in\Xi$.
\begin{definition}
Associated with $H$ is the subspace 
$$H^3_H(u^\ast TQ)\subset H^3(u^\ast TQ)$$
of finite codimension,  consisting of all sections $\eta$ satisfying  $\eta(z)\in H_z$ for $z\in\Xi$. 
\end{definition}

In the following we shall orient (in a coherent way) the Fredholm operators 
$$
L: H^3_H(u^\ast TQ)\rightarrow H^2(u^\ast \Omega^{0,1}_{j,J})
$$
of the  usual form 
$$
L(\eta)=\nabla\eta +J(u)(\nabla\eta)\cdot  j +A(\eta),
$$
where $A$ is a compact operator. We observe that these are the same operators as the ones studied before, but this time  restricted to  a subspace of finite codimension.  We denote this collection of Fredholm operators by
 ${\mathcal F}_{\alpha,\Xi}$.  In ${\mathcal F}_{\alpha,\Xi}$ we allow $J\in{\mathcal J}$ and $H\in {\mathcal H}$ to vary,
whereas $u$ and $j$ are fixed.
In the   case that $H$ has the property $J(u(z))H_z=H_z$ for all $z\in \Xi$,  the space $H^3_H(u^\ast TQ)$ has a complex structure 
 via $i\eta:=J(u)\eta$ so that  in this case  the operator $\eta\rightarrow \nabla\eta +J(u)(\nabla\eta) j $ is a complex linear operator if $\nabla J=0$.
 Hence we have complex linear operators in ${\mathcal F}_{\alpha,\Xi}$ and complex  orientations (for the real determinants).  
Since the space ${\mathcal J}$ of almost complex structures on the manifold $(Q, \omega)$ is contractible, and for fixed $\Xi$ the set ${\mathcal H}$ of constraints is contractible, the space ${\mathcal F}_{\alpha,\Xi}$ of Fredholm operators (for fixed $\alpha$) is contractible. Therefore, we can repeat the arguments in the proof of 
Proposition \ref{p<ppp} to obtain the following result.  
 
  \begin{proposition}
 There is for every $L\in {\mathcal F}_{\alpha,\Xi}$ a natural orientation $\mathfrak{o}_L$
 for $\det(L)$,  characterized by the following requirements.
 \begin{itemize}
 \item[(1)]  For every smooth path $(L_t)_{0\leq t\leq 1}$  in ${\mathcal F}_{\alpha,\Xi}$, the continuation of $\mathfrak{o}_{L_0}$ along the path is $\mathfrak{o}_{L_1}$. 
 \item[(2)] If $L$ is complex linear then $\mathfrak{o}_{L}$ is the complex orientation.
 \end{itemize}
 \end{proposition}
 
If the Fredholm operator $L$ in ${\mathcal F}_{\alpha,\Xi}$ belongs to  the constraints $H=(H_z)$ for $z\in \Xi$ and if $\phi:\alpha\rightarrow\alpha'$ is an isomorphism between the two smooth stable maps, which maps $\Xi$ to $\Xi'$, then the push-forward operator $L'=\phi_\ast L$ 
belongs to the space ${\mathcal F}_{\alpha',\Xi'}$ and satisfies the push-forward constraints $\phi_\ast H$ defined as follows.
 If $H=(H_z)$, $z\in \Xi$, then $\phi_\ast H=(H_{z'})$, $z'\in \Xi'$, is defined as $H_{z'}=H_{\phi (z)}=H_z$, so that  $H_{z'} \subset T_{u'(z')}Q=T_{u(z)}Q$, since, by definition of an isomorphism, 
 $u'(z')=u'(\phi (z))=u(z)$. Therefore, we have a well-defined push-forward of an orientation. Proceeding now as in the proof of 
 Proposition \ref{m<0}, considering  constraints which are $J$-invariant
and applying  the homotopy arguments from above, one  verifies  that the complex orientation $\mathfrak{o}_{\bf L}$ is pushed forward to  
the complex orientation $\mathfrak{o}_{\bf \phi_\ast L}$ and obtains the following proposition.
 
 \begin{proposition}\label{b<b}
 Given an isomorphism $\phi:\alpha\rightarrow \alpha'$ between two smooth un-noded stable maps,   and given stab-sets $\Xi$ and $\Xi'$ satisfying 
 $\phi(\Xi)=\Xi'$, the push-forward operation $\phi_\ast:{\mathcal F}_{\alpha,\Xi}\rightarrow {\mathcal F}_{\alpha',\Xi'}$
 maps the complex orientation $\mathfrak{o}_{\bf L}$ to the complex orientation  $\mathfrak{o}_{\phi_\ast{\bf L}}$.
 \end{proposition} 


Next we consider the relationship between operators in ${\mathcal F}(S,M)$ and ${\mathcal F}_{\alpha,\Xi}$.
If  $\alpha=(S,j,M,\emptyset,u)$ is,   as before,  a smooth un-noded stable map, we introduce  the following definition.
\begin{definition}
{\bf A stab-set pair $(\Xi,\Xi_0)$ for $\alpha$}  consists of two stab-sets $\Xi$ and $\Xi_0$ for $\alpha$ such  that $\Xi_0\subset \Xi$.
\end{definition}
We allow $\Xi_0=\emptyset$ and identify in this case the stab-set pair $(\Xi,\emptyset)$ with $\Xi$. Associated with  a stab-set pair we introduce the following distinguished  class of finite-dimensional subspaces of $H^3(u^\ast TQ)$. 

\begin{definition} Let $\alpha$ be a smooth unnoded  stable map as before and $(\Xi,\Xi_0)$ a stab-set pair.
A {\bf $(\Xi,\Xi_0)$-subspace associated with  $\alpha$} is
a finite-dimensional linear subspace
$N$ of $H^3(u^\ast TQ)$ having the following properties.
\begin{itemize}
\item[(1)] $\dim_{\mathbb R}(N)=2\cdot (\sharp\Xi-\sharp\Xi_0)$.
\item[(2)] If  $\eta\in N$,  then  $\eta(z)\in R(Tu(z))$ for all $z\in\Xi\setminus\Xi_0$ and $\eta(z)=0$ for $z\in\Xi_0$.
\item[(3)] The evaluation map $N\rightarrow \bigoplus_{z\in\Xi\setminus\Xi_0} R(Tu(z))$, $\eta\mapsto (\eta(z))_{z\in\Xi\setminus\Xi_0}$
is a linear isomorphism.
\end{itemize}
\end{definition}
{The $(\Xi,\Xi_0)$-subspace  $N$ inherits a natural orientation by the isomorphism  in (3).}

\begin{remark}
For a smooth stable map 
$\alpha=(S,j,M,\emptyset,u)$ and a stab-set $\Xi$ having the associated associated constraints $H$,  we consider the linear subspace $H^3_H(u^\ast TQ)$ of $H^3(u^\ast TQ)$. If $N$ is a $\Xi$-subspace  (where we have identified $\Xi$ with the stab-set $(\Xi, \emptyset)$, the map
$$
N\oplus H^3_H(u^\ast TQ)\rightarrow H^3(u^\ast TQ), \quad (v,\eta)\mapsto v+\eta
$$
is a topological linear isomorphism. 
We also note that,  given a stab-set pair $(\Xi,\Xi_0)$ and the constraints $H$ associated with  $\Xi$,  we can take 
a $\Xi_0$-subspace $N_0$ and a $(\Xi,\Xi_0)$-subspace $N_1$,  and obtain the linear topological isomorphism
$$
N_0\oplus N_1\oplus H^3_H(u^\ast TQ)\rightarrow H^3(u^\ast TQ)\quad (a,b,\eta)\rightarrow a+b+\eta.
$$
Similarly,  if $H_0$ is the subset of $\Xi_0$-constraints which is obtained by restricting the constraint $H$ of $\Xi$ to the subset  $\Xi_0\subset \Xi$, and if  $N_1$ is a $(\Xi,\Xi_0)$-subspace,  we obtain the linear topological isomorphism
$$
N_1\oplus H^3_H(u^\ast TQ)\rightarrow H^3_{H_0}(u^\ast TQ),\quad  (a,\eta )\mapsto a+\eta.
$$
\end{remark}

 By ${\mathcal S}_{\alpha,(\Xi,\Xi_0)}$  we denote the  collection of all $(\Xi,\Xi_0)$-subspaces of $H^3(u^\ast TQ)$.  Fixing a norm $\norm{\cdot}$  on $H^3(u^\ast TQ)$,  we equip ${\mathcal S}_{\alpha,(\Xi,\Xi_0)}$  with the metric defined  by  the Hausdorff distance of the unit-spheres in  the  $(\Xi,\Xi_0)$-subspaces.

\begin{lemma}\label{vvvv}
The topological space ${\mathcal S}_{\alpha,(\Xi,\Xi_0)}$ is contractible.
\end{lemma}
\begin{proof}
Every subset of a stab-set $\Xi$  is again a stab-set. In particular, if 
$z\in \Xi$, then the set $\{z\}$ is a stab-set and we associate it with a special two-dimensional subspace. We modify the element $\eta$ of the $\{z\}$-subspace by 
a local construction using  a  cut-off function to achieve that 
$\eta(z')=0$ for all $z'\in \Xi\setminus\{z\}$ and such that  the properties (1)-(3) hold true for the stab-set $\{z\}$.
If $\Xi_0\subset \Xi$, then the direct sum over all 
$z\in \Xi\setminus\Xi_0$ of the  subspaces constructed this way is a $(\Xi,\Xi_0)$-subspace possessing the properties (1)-(3).
This shows that there exist  $(\Xi,\Xi_0)$-subspaces.  

For every $z\in \Xi$  we fix an ordered basis $\{h_z, k_z\}$ of the symplectic vector space $R(Tu(z))$ satisfying 
$\omega (u(z))(h_z, k_z)>0$ which defines the same orientation as the orientation induced from $j$ on $T_zS$ via $Tu(z)$. In view of the properties (1)-(3), there exist in every 
$(\Xi,\Xi_0)$-subspace $N$, for every $z\in \Xi\setminus\Xi_0$, uniquely determined  vectors $\delta_z^N, \gamma_z^N\in N$ satisfying  $\delta_z^N(z)=h_z$, $\gamma_z^N(z)=k_z$
 and $\delta_z^N(z'),\gamma_z^N(z')=0$ for $z'\neq z$. If we fix a $(\Xi,\Xi_0)$-subspace $N_0$, there is,  for every $(\Xi\setminus \Xi_0)$-subspace,   a uniquely determined isomorphism, mapping $\delta^N_z$ and $\gamma_z^N$, respectively,
 to $\delta^{N_0}_z$ and $\gamma_z^{N_0}$, respectively,  for all $z\in \Xi\setminus\Xi_0$.
The map 
$$
\Gamma:[0,1]\times {\mathcal S}_{\alpha,(\Xi,\Xi_0)}\rightarrow {\mathcal S}_{\alpha,(\Xi,\Xi_0)}
$$
is defined by
$$
\Gamma(t,N) =\text{span}\{ (1-t)\delta_z^N +t\delta_z^{N_0}, (1-t)\gamma_z^N +t\gamma_z^{N_0}\ |\ z\in \Xi\setminus\Xi_0\}.
$$
In order to verify that for $t$ fixed  the vector space
$\Gamma(t,N)$ is a $(\Xi,\Xi_0)$-subspace we first observe that, by construction,  
$\dim \Gamma(t,N)\leq  2\cdot(\sharp\Xi-\sharp\Xi_0)$.
On the other hand, we conclude from 
$$
((1-t)\delta_z^N +t\delta_z^{N_0})(z)=h_z\quad \text{and}\quad  ((1-t)\delta_z^N +t\delta_z^{N_0})(z')=0,
$$
and 
$$
((1-t)\gamma_z^N +t\gamma_z^{N_0})(z)=k_z\quad \text{and}
\quad ((1-t)\gamma_z^N +t\gamma_z^{N_0})(z')=0,
$$
for $z\in\Xi\setminus\Xi_0$ and $z'\in\Xi_0$, that 
$\dim \Gamma(t,N)\leq  2\cdot(\sharp\Xi-\sharp\Xi_0)$ and the evaluation map 
$$ \Gamma(t,N)\to \oplus_{z\in \Xi\setminus \Xi_0}R(Tu(z)), \quad 
\eta\mapsto \bigl(\eta (z)\bigr)_{z\in \Xi\setminus \Xi_0}$$
is surjective.
Hence, $\dim \Gamma(t,N)=2\cdot(\sharp\Xi-\sharp\Xi_0)$ and $\Gamma(t,N)$ belongs indeed to the space ${\mathcal S}_{\alpha, \Xi,\Xi_0}$. We note that, in particular, 
$$
\delta^{\Gamma(t,N)}_z =(1-t)\delta_z^N +t\delta_z^{N_0}\quad  \text{and}\quad  \gamma^{\Gamma(t,N)}_z =(1-t)\gamma_z^N +t\gamma_z^{N_0}.
$$
In view of 
$\Gamma(0,N)=N$ and $\Gamma(1,N)=N_0$, the space 
${\mathcal S}_{\alpha, \Xi\setminus \Xi_0}$ is contractible.
\end{proof}


Let us recall  that $R(Tu(z))$ has a natural orientation given by the ordered basis $\{h_z, k_z\}$, which agrees with  the
orientation induced  from $(T_zS,j)$ by  $Tu(z)$.
Thus we obtain a natural orientation of  the vector space 
$ \bigoplus_{z\in\Xi\setminus\Xi_0} R(Tu(z))$.  This space is,  by definition,  the space
 of maps which associate with every point  $z\in\Xi\setminus\Xi_0$ a vector in $R(Tu(z))$.  Take a numbering $z_1,\ldots ,z_{\sharp(\Xi\setminus\Xi_0)}$ and take
 as a basis 
 $[z\rightarrow \delta_{z_1}(z)h_{z_1}],[z\rightarrow \delta_{z_1}(z)k_{z_1}],\ldots$. Here $\delta_{z_i}(z)=1$ if and only if  $z=z_i$ and otherwise its value is $0$.
 Then the associated orientation
 does not depend on the numbering of the points in $\Xi\setminus \Xi_0$. Using the canonical isomorphism from property (3), 
 \begin{equation}\label{o<?}
 N\rightarrow \bigoplus_{z\in\Xi\setminus\Xi_0} R(Tu(z)),\quad  \eta \mapsto  {(\eta (z))}_{z\in\Xi\setminus\Xi_0},
\end{equation}
 we see that every $(\Xi,\Xi_0)$-subspace $N$ inherits  a natural orientation for which  
 the map \eqref{o<?} is orientation-preserving.

 \begin{definition}
 Let $\alpha$ be a smooth un-noded stable map and $(\Xi,\Xi_0)$ a stab-set pair. The orientation
of the $(\Xi,\Xi_0)$-subspace $N$ of $H^3(u^\ast TQ)$,  for which  the linear isomorphism
 in (\ref{o<?}) is orientation preserving,  is called the {\bf natural orientation for the $(\Xi,\Xi_0)$-subspace $N$}.
 \end{definition}
 
 Note that  the proof of Lemma \ref{vvvv} proves also  the following useful lemma.
 \begin{lemma}
 Let $\alpha$ be a smooth un-noded stable map and $(\Xi,\Xi_0)$ a stab-pair.  If $N_0$ is a $\Xi_0$-subspace and
 $N_1$ a $(\Xi,\Xi_0)$-subspace, then $N=N_0\oplus N_1$ is a $\Xi$-subspace and the map
 $$
 N_0\oplus N_1\rightarrow N, \quad (a,b)\mapsto  a+b
 $$
 is orientation-preserving. (This is also true if we replace $N_0\oplus N_1$ by $N_1\oplus N_0$  since $N_0$ and $N_1$ are even-dimensional.)
 \end{lemma}

The  stab-set pair $(\Xi,\Xi_0)$ and the constraints $H$ for $\Xi$ induce the  set $H_0$ of constraints for $\Xi_0$. Given a $(\Xi,\Xi_0)$-subspace $N$ we have the topological isomorphism
$$
N\oplus H_{H}^3(u^\ast TQ)\rightarrow H^3_{H_0}(u^\ast TQ),\quad (v,\eta)\mapsto  v+\eta.
$$
We note that $N$ and $ H_{H}^3(u^\ast TQ)$ are linear subspaces of $H_{H_0}^3(u^\ast TQ)$.
Given the operator ${\bf L}\in {\mathcal F}_{\alpha,\Xi_0}$ we can define its restriction ${\bf L}'$ to 
$H_{H}^3(u^\ast TQ)$. If  $P:H^3_{H_0}(u^\ast TQ)\rightarrow H^3_{H_0}(u^\ast TQ)$ is  the projection onto
$H^3_{H}(u^\ast TQ)$ along $X$,  the composition 
 ${\bf L}\circ P$  is also an operator in ${\mathcal F}_{\alpha,\Xi_0}$, because 
${\bf L}\circ (Id-P)$ is a compact operator.

\begin{proposition}
We consider for a stab-pair $(\Xi,\Xi_0)$ and the constraints $H$ associated  with  $\Xi$ and the restriction  $H_0=H\vert \Xi_0$,   an operator ${\bf L}\in {\mathcal F}_{\alpha,\Xi_0}$ on 
$H^3_{H_0}(u^\ast TQ)$
and its restriction  ${\bf L}'$ to  $H^3_{H}(u^\ast TQ)$ as described above.  
We assume that the operators in ${\mathcal F}_{\alpha,\Xi}$ and ${\mathcal F}_{\alpha,\Xi_0}$ are equipped with the complex orientations. If the complex orientation of ${\bf L}'$ is defined by the vectors  by $(h_1\wedge\ldots \wedge h_k)\otimes (h_1^\ast\wedge\ldots\wedge h_l^\ast)$, then the complex orientation of ${\bf L}\circ P$ is given by
$(a_1\wedge\ldots\wedge a_{2\sharp(\Xi\setminus\Xi_0)}\wedge h_1\wedge\ldots\wedge h_k)\otimes (h_1^\ast\wedge\ldots\wedge h_l^\ast)$,
where $a_1\wedge\ldots\wedge a_{2\sharp(\Xi\setminus\Xi_0)}$ defines  the orientation of the 
$(\Xi, \Xi_0)$-subspace $N$.
\end{proposition}

\begin{proof}
By a homotopy argument we may assume that ${\bf L}$ is complex linear. For example,  we take the constraints
$(H_z)$ and $J$  satisfying  $J(u(z))H_z=H_z$ and $\nabla J=0$,  and ${\bf L}$ of the form 
$$
\eta\mapsto \nabla\eta+J(u)(\nabla\eta)j.
$$
In this case ${\bf L}'$ is also complex linear. Moreover, we can even assume,  in addition,  that $J(u(z))(R(Tu(z)))=R(Tu(z))$.
This implies that there is a $(\Xi,\Xi_0)$-subspace $N\in {\mathcal S}_{\alpha,(\Xi,\Xi_0)}$  which is complex linear.  Observe that the canonical orientation
on $N$ is the same as the complex orientation. In this situation the projection  $P$ is complex linear
and the homotopy
$$
[0,1]\ni t\mapsto {\bf L}\circ P + t {\bf L}\circ (\text{id}-P)\colon H^3_{H_0}(u^\ast TQ)\rightarrow H^2(u^\ast \Omega_{j,J})
$$
is a homotopy consisting of complex linear operators. Therefore,  the complex orientation of ${\bf L}$ corresponds to the 
complex orientation of ${\bf L}\circ P$. We note further that 
$$
{\bf L}\circ P | H^3_{H}(u^\ast TQ) ={\bf L}'\ \ \text{and}\ \  {\bf L}\circ P|X=0.
$$
Consequently,  $\ker({\bf L}\circ P)= N\oplus \ker({\bf L}')$ and $\ker({\bf L}')$ is a complex linear subspace,
whereas the cokernels are the same complex linear subspaces. This implies the desired result.
\end{proof}



\subsection{A Further Extension}
Next we extend the construction as follows.  We assume that $\alpha$ and $\Xi$ are  as before, and let  $E$ be a finite-dimensional oriented real vector space. In most of the applications $E$ will be a complex vector space, which we shall view as a real vector space equipped
with the orientation defined by the complex structure.
 By ${\mathcal F}_{\alpha,\Xi,E}$ we denote the collection of all operators
of the form
$$
E\oplus H^3_H(u^\ast TQ)\rightarrow H^2(u^\ast\Omega^{0,1}_{j,J}),\quad L(e,\eta)=\nabla\eta +J(u)(\nabla\eta) j +A(e,\eta),
$$
where $A$ is compact. Every 
$L\in {\mathcal F}_{\alpha,\Xi}$
 defines an operator $L_E$ in ${\mathcal F}_{\alpha,\Xi, E}$ by
$L_E(e,\eta)= L\eta$.  For fixed $\alpha$ and $E$,  two operators in ${\mathcal F}_{\alpha,\Xi,E}$ can be connected by a smooth path so that we can talk about continuation of an orientation. If $L\in {\mathcal F}_{\alpha,\Xi}$ and $\mathfrak{o}_L$
is the  orientation of  $\det(L)$ defined by the vector
$(k_1\wedge\ldots \wedge k_n)\otimes (h_1^\ast\wedge\ldots \wedge h_l^\ast)$, 
we obtain the orientation $\mathfrak{o}_{L_E}$ of  $\det(L_E)$ defined by the vector $(e_1\wedge\ldots \wedge e_{2m}\wedge k_1\wedge\ldots \wedge k_n)\otimes(h_1^\ast\wedge\ldots\wedge h_l^\ast)$,
where $e_1,\ldots ,e_{2m}$ is an oriented  basis for the even-dimensional oriented vector space $E$. The orientation $\mathfrak{o}_{L_E}$ only depends on $\mathfrak{o}_L$ and not on the choices involved in its construction.

\begin{proposition}
There is for every $\what{L}$ in ${\mathcal F}_{\alpha,\Xi,E}$ a natural orientation $\mathfrak{o}_{\what{L}}$
of $\det(\what{L})$ characterized by the following.
\begin{itemize}
\item[(1)] Along every smooth path $(\what{L}_t)_{0\leq t\leq 1}$ in ${\mathcal F}_{\alpha,\Xi,E}$, the continuation of $\mathfrak{o}_{\what{L}_0}$ 
is $\mathfrak{o}_{\what{L}_1}$.
\item[(2)] If $L\in {\mathcal F}_{\alpha,\Xi}$ then $\mathfrak{o}_{L_E}$ corresponds to the complex orientation
$\mathfrak{o}_L$ defined for $L\in {\mathcal F}_{\alpha,\Xi}$ via the above construction.
\end{itemize}
\end{proposition}
\begin{proof}
Having fixed an operator $\what{L}_0$ and  its orientation 
$\mathfrak{o}_{\what{L}_0}$,  we obtain an orientation $\mathfrak{o}_{\what{L}}$ 
for any other operator $\what{L}$ by continuation along a path connecting $\what{L}_0$ with  $\what{L}$.
The outcome does not depend on the choice of path since loops are contractible.  We now choose 
$\what{L}_0$ of the form 
$$
\what{L}_0(e,\eta)= \nabla\eta +J(u)(\nabla\eta)j,
$$
where the domain $H^3_H(u^\ast TQ)$ for $\eta$ is  complex. Then we have the distinguished
orientation for the complex operator $\eta\mapsto  \nabla\eta +J(u)(\nabla\eta)j$ and taking a complex basis for $E$
we define the  orientation $\mathfrak{o}_{L_E}$ as  described above the proposition.
Having fixed this orientation and proceeding as in the  previous proofs,  we obtain an orientation 
$\mathfrak{o}_{L}$  for every
$L\in {\mathcal F}_{\alpha,\Xi,E}$. We only need to show that it does not depend
on the specific choice of $L_0$.  But as already used before,  we can connect any two such choices
by an arc of operators in the same class.Therefore,  the propagation of the 
complex orientation is the complex orientation. This completes the proof. 
\end{proof}

It is useful to summarize our findings in this subsection.  Given a smooth stable un-noded $\alpha=(S,j,M,\emptyset,u)$,
 a stabset $\Xi$,  a collection of transversal constraints $H={(H_z)}_{z\in \Xi}$,  an oriented even-dimensional vector space $E$, 
 and a compatible almost complex structure $J$, we can consider the special operators on the  domain $E\oplus H^3_H(u^\ast TQ)$ into the  codomain $H^2(u^\ast\Omega_{j,J})$,  of the form
 $$
L(e,\eta)=\nabla\eta +J(u)(\nabla\eta)j+A(e,\eta).
 $$
 The determinants of these operators have a canonical orientation, called the complex orientation.
If  we change for a fixed stab-set $\Xi$,  any of the data $j$, $J$ or $H$,  the continuation of the complex orientation is the complex orientation.
We have also seen that the push-forward of such an operator by an isomorphism between smooth stable maps produces an operator in the same class
and that the push forward of its  complex orientation is the complex orientation.
In order to proof our main result about the orientations 
we need to  deal with  more general coordinate changes, which will be  done in the next subsection.

\begin{remark}\label{mm<0}
The obvious version of Proposition \ref{m<0} also holds.
\end{remark}

\subsection{General Coordinate Changes}

We consider the  stable un-noded marked Riemann surface $\beta=(S,j,M)$. In  the following it is not relevant  whether  $M$ is ordered, partially ordered or un-ordered.  The real dimension of the component of the Deligne-Mumford space containing the isomorphism class $[S,j,M]$ is equal to $d_\beta=6g(S)-6 + 2\sharp M$.
\begin{definition}\label{0-general}
An {\bf effective, oriented deformation germ for the stable marked surface $\beta=(S,j,M)$} consists of a real oriented vector space
$E$ of dimension $d_\beta$ and a smooth germ of deformations of $j$, 
$$
{\mathcal O}(E,0)\ni v\rightarrow j(v),
$$
satisfying  $j(0)=j$. Moreover, the Kodaira differential
$$
[Dj(0)]:E\rightarrow H^1(\alpha)
$$
is an orientation-preserving isomorphism, where the target $H^{1}(\alpha )$ carries the  orientation coming from its complex structure.
\end{definition}


We consider  tuples $(\alpha,\Xi,E)$ consisting of a smooth un-noded stable map $\alpha=(S,j,M,\emptyset, u)$, a stabilization set $\Xi$ and 
an oriented even-dimensional vector space $E$ of dimension 
$$
\dim_{\mathbb R}(E) = 6g(S)-6 + 2\sharp M+2\sharp\Xi.
$$
We would like to emphasize that $\Xi$ here is a stabilization in the original sense of Definition \ref{stab-f}. It is, in particular,  also a
stab-set.
Fix such a tuple and consider the set ${\mathcal H}$ of all associated linear constraints $H={(H_z)}_{z\in\Xi}$.
For fixed $z$ we can view the set of all associated linear subspaces  $H_z\subset T_zQ$ as an open subset of a Grassmannian. Consequently, 
this collection has in a natural way a smooth manifold structure. The collection ${\mathcal H}$ is a product of these manifolds
and therefore also a smooth manifold. We also recall that ${\mathcal H}$ is contractible. We obtain the  Hilbert space bundle ${\mathcal E}$ over ${\mathcal H}$ whose  fiber over the constraint $H$, ${\mathcal E}_H$,  is  the Hilbert space $H^3_H(u^\ast TQ)$ so that 
$$
{\mathcal E}_H:=H^3_H(u^\ast TQ).
$$


In the following we shall interpret the triples 
$$(\alpha,H,E)$$ 
as objects of a category. We recall that $\alpha$ is an un-noded smooth stable  map $\alpha=(S, j, M, \emptyset, u)$, the marked Riemann surface $(S, j, M)$ is equipped with the stabilization $\Xi$ and $H=(H_z)_{z\in \Xi}$ is an associated constraint. Moreover, $E$ is an oriented even dimensional vector space of real dimension $\dim_{\mathbb R}(E) = 6g(S)-6 + 2\sharp M+2\sharp\Xi$.

In order to define the morphisms of the category having as objects the triples $(\alpha,H,E)$, we take a second 
object $(\alpha',H',E')$ in which $\alpha'=(S', j', M', \emptyset, u')$ is a stable map with the 
stabilization $\Xi'$, the constraint $H'$, and the vector space $E'$. 
 The morphisms 
$$
(\alpha,H,E)\rightarrow (\alpha',H',E')
$$
of the category consists of pairs 
$(\phi,K)$ in which 
$$\phi:\alpha\rightarrow \alpha'$$
is an isomorphism of un-noded stable maps and  
$$K:E\oplus H^3_H(u^\ast TQ)\rightarrow E'\oplus  H^3_{H'}({(u')}^\ast TQ)$$ is a topological linear isomorphism
which is constructed as follows.    


We choose a smooth map $\Lambda_u$  defined on an open neighborhood of the zero-section in $u^\ast TQ$ with image in $Q$
and having the following properties.
\begin{itemize}
\item[(1)]  $\Lambda_u(z,0_{u(z)})=u(z)$ for $z\in S$.
\item[(2)] $T_{(z,0_{u(z)})}\Lambda_u:{( u^\ast TQ)}_z=T_{u(z)}Q\rightarrow T_{u(z)}Q$ is the identity map.
\end{itemize}

A typical example is $\Lambda_u=\exp_u$ where $\exp:TQ\rightarrow Q$ is the exponential map of a  Riemann metric on the manifold $Q$ and 
$\exp_u$  is the pull-pack defined by the smooth map by $u:S\to Q$.  For the second triple $(S', j', M')$ we choose an analogous map $\Lambda_{u'}'$ having the analogous properties. Next we choose 
an effective oriented deformation germ  $v\mapsto j(v)$ for $v\in E$ associated with the stable surface $(S,j,M\cup\Xi)$ and satisfying $j(0)=j$. Similarly we take another
effective oriented deformation germ  $v'\mapsto j'(v')$ on $E'$ for the stable surface $(S', j', M'\cup \Xi')$ satisfying $j'(0)=j'$. 

In view of Proposition \ref{imremark}, there are associated uniformizers 
\begin{align*}
\alpha (v, \eta)&=(S, j(v), M, \emptyset, \Lambda_u(\eta))\\
\intertext{and}
\alpha' (v', \eta')&=(S', j'(v'), M', \emptyset, \Lambda'_{u'}(\eta')),
\end{align*}
defined for $(v, \eta)$ near $(0, 0)$ in $E\oplus H^3_{H}(u^*TQ)$, respectively for 
$(v', \eta')$ near $(0, 0)$ in $E'\oplus H^3_{H'}((u')^*TQ)$. Theorem \ref{key-z} guarantees a unique germ 
$$f:(v, \eta)\mapsto (v', \eta')=f(v, \eta)$$
of an sc-diffeomorphism between the parameter spaces satisfying $f(0, 0)=(0, 0)$ and a smooth germ 
$$\phi_{(v,\eta)}:\alpha_{(v,\eta)}\rightarrow \alpha'_{f(v,\eta)}$$
of isomorphisms between the stable maps satisfying  $\phi_{(0,0)}=\phi$.

The topological linear isomorphism  $K$ is defined by
$$
K:=Df(0,0):E\oplus H^3_H(u^*TQ)\to 
E'\oplus H^3_{H'}((u')^*TQ).
$$

In  other words,  the morphisms in our category are pairs $(\phi,K)$ in which  $\phi:\alpha \to \alpha'$ is an isomorphism between stable maps and $K$ is the linearization of a coordinate change associated with  $\phi$. 


The identity morphisms of the category are given by  
$1_{(\alpha,H,E)}=(\text{id},\text{id})$ and if 
the morphisms can be composed, the multiplication of two morphisms is simply 
 $(\phi,K)\circ (\psi,K')=(\phi\circ\psi,K\circ K')$.  
\begin{definition}\label{GENERAL}
The morphism $(\phi, K):(\alpha, H, E)\to (\alpha', H', E')$ constructed above is called 
a {\bf  general linear coordinate change}.
\end{definition}
\begin{lemma}
Given $\alpha$, $\alpha'$, the isomorphism $\phi:\alpha\rightarrow \alpha'$, the constraints $H$ and $H'$,
 and the effective oriented germs $v\rightarrow j(v)$ and $v'\rightarrow j'(v')$,  the topological linear isomorphism
 $$
 K:E\oplus H^3_H(u^\ast TQ)\rightarrow E'\oplus H^3_{H'}({(u')}^\ast TQ)
 $$
 is uniquely determined by $\phi$ and the  differentials $Dj(0)$ and $Dj'(0)$. It does not depend on the choices
 of $\Lambda_u$ and $\Lambda_{u'}'$ as long as they have the stated properties.
 \end{lemma}
 \begin{proof}
  To see this we define $\Gamma_0=\phi^{-1}(\Xi')$. Since $u'\circ \phi =u$ we see that
$u$ intersects the nonlinear constraints associated with  $\Xi'$ at the points in $\Gamma_0$. If we deform $u$,  say to
$\Lambda_u(\eta)$,  the intersection set will be a small deformation $\Gamma=\Gamma_\eta$ of $\Gamma_0$.
For convenience we may assume that the points in $\Gamma_0$ are numbered and those in $\Gamma$ are numbered as well,
so that the $i$-th point in $\Gamma$ is the small deformation of the $i$-th point in $\Gamma_0$. Since $\Gamma_0$ is numbered
we obtain a numbering of $\Xi'$ via $\phi$.
Now there exists for given $v\in E$ near $0$ a unique $v'=v'(v,\Gamma)$
near $0\in E'$, and a unique  diffeomorphism $\phi_{v,\Gamma}$   near $\phi$,  which maps $\Gamma$ to $\Xi'$ preserving the numbering, but also
satisfies for the marked points $\phi_{(v,\Gamma)}(m_i)=m_i'$,  so that 
\begin{equation}\label{r<m}
j'(v'(v, \Gamma))\circ T\phi_{(v,\Gamma)} = T\phi_{(v,\Gamma)}\circ j(v).
\end{equation}
 This is proved by an implicit functions theorem in \cite{HWZ-DM}. Indeed,  following the argument there, $F(v,\Gamma,v', \phi_{(v,\Gamma)})=0$, where 
 $F$ is a first order elliptic differential operator in the fourth entry satisfying $F(0,\Gamma_0,0,\phi)=0$,  and for every small deformation $(v,\Gamma)$ of $(0,\Gamma_0)$ there is a unique solution $(v'(v, \Gamma),\phi_{(v,\Gamma)})$ near $(0,\phi)$. The linearization of $F$ with respect to the third and fourth variable
  at $(0,\phi)$ is an isomorphism. If we differentiate $F(v,\Gamma,v'(v,\Gamma),\phi_{(v,\Gamma)})=0$ with respect $(v,\Gamma)$ at $(0,\Gamma_0)$
  we obtain
  \begin{eqnarray*}
  0 &= &(D_{1,2}F)(0,\Gamma_0,0,\phi)(\delta v,\delta\Gamma)\\
  & +& (D_{3,4}F)(0,\Gamma_0,0,\phi)(Dv'(0,\Gamma_0)(\delta v,\delta\Gamma),(D\phi)_{(0,\Gamma_0)}(\delta v,\delta\Gamma)).
  \end{eqnarray*}
  The $D_{(3,4)}$-term is a linear isomorphism determining 
  $$
Dv'(0,\Gamma_0)(\delta v,\delta\Gamma),(D\phi)_{(0,\Gamma_0)}(\delta v,\delta\Gamma)).
  $$
  uniquely in terms of the $D_{(1,2)}$-term.  From (\ref{r<m}) it follows that it is uniquely determined in terms of $\phi$, $Dj(0)$ and $Dj'(0)$. 
  The linear isomorphism $K$ is the linearization of the following composition. For small $(v,\eta)$ we obtain a deformation $\Gamma_\eta$ of $\Gamma_0$
  where $\Gamma_\eta$ consists of the points $\gamma_i$ at which the map $\exp_u(\eta)$ intersects $H_{z_i'}'$. Then we consider the germ
  $$
  (v,\eta)\rightarrow (v,\Gamma_\eta,\Lambda_u(\eta))\rightarrow (v'(v,\Gamma_\eta),\eta'(v,\eta)),
  $$
  where $\eta'=\eta'(v,\eta)$ is defined by $\Lambda_{u'}'(\eta') \circ \phi_{(v,\Gamma_{\eta})} =\Lambda_u(\eta)$.
  From this expression we conclude  that $K$, the derivative at $(0,0)$,  is determined by the derivative of $\phi_{(v,\Gamma)}$ at $(0,\Gamma_0)$.
\end{proof}



We consider,  for two triplets $(\alpha,H,E)$ and $(\alpha',E',H')$ and a fixed isomorphism $\phi:\alpha\rightarrow \alpha'$,  the collection of all morphisms
$(\phi, K):(\alpha,H,E)\rightarrow (\alpha',H',E')$. We equip  this collection  with  a metric defining the distance
between $(\phi,K)$ and $(\phi,K')$  by  the 
 operator norm $\norm{K-K'}$. 
 
\begin{lemma}\label{i<<i}
For fixed triples $(\alpha,H,E)$ and $(\alpha',H',E')$  and fixed isomorphism  $\phi:\alpha\rightarrow \alpha'$, 
the collection of all morphisms of the form $(\phi,K):(\alpha,H,E)\rightarrow (\alpha',H',E')$ is a connected space.
\end{lemma}

\begin{proof}
Having $(H,E)$ and $(H',E')$ fixed,  the operator  $K$ depends only on $\phi$, and the differentials of $v\rightarrow j(v)$ and $v'\rightarrow j'(v')$ at $0$.
Given two deformations $j_1(v)$ and $j_2(v)$  of $j$ with effective Kodaira differentials at $v=0$, we find a smooth arc of germs of deformations
$(k_t)_{1\leq t\leq 2}$ connecting them such  that,  for $i=1,2$,   $k_i$ and $j_i$ have the same differentials and the Kodaira differentials are effective for all $t\in [1,2]$.
Using the deformation $t\mapsto  k_t$
and the analogous deformation $t\mapsto k_t'$,  we can construct a smooth family $(f_t, \phi_i)$ of germs 
of coordinate changes and the resulting arc $Df_t(0, 0)$ of derivatives at $(0,0)$ is a homotopy between the morphisms
associated with the morphisms   for  $ i=1,2$. This completes the proof.
\end{proof}
\begin{remark}In fact,  something more general is true due to the contractibility and therefore connectivity of ${\mathcal H}$ and ${\mathcal H}'$, respectively.
Namely,  given $\phi:\alpha\rightarrow \alpha'$,  the collection of all morphisms
$$
(\phi,K):(\alpha,H,E)\rightarrow (\alpha',H',E')
$$
where $H$ varies in ${\mathcal H}$ and $H'$ in ${\mathcal H}'$,  is connected.
\end{remark}
 \begin{lemma}
If  $(\phi,K):(\alpha,H,E)\rightarrow (\alpha',H',E')$ is  a morphism, and if 
the  the operator ${\bf L}:E\oplus H^3_H(u^\ast TQ)\rightarrow H^2(u^\ast\Omega_{j,J})$
belongs to the distinguished class ${\mathcal F}_{\alpha,\Xi,E}$, 
then the   operator ${\bf L}':E'\oplus H^3_{H'}(u^\ast TQ)\rightarrow H^2({(u)}^\ast\Omega_{j',J})$, 
defined by
$$
{\bf L}'(K(v,\eta))\circ T\phi = {\bf L}(v,\eta),
$$
 belongs to the class ${\mathcal F}_{\alpha',\Xi',E'}$.
 \end{lemma}
 \begin{remark}
 We shall call ${\bf L}'$ the {\bf push-forward}  of ${\bf L}$ and denote it by $(\phi,K)_\ast{\bf L}$. We can use $(\phi,K)$
 in the obvious way to push-forward an orientation $\mathfrak{o}$ of ${\bf L}$ to an orientation $(\phi,K)_\ast\mathfrak{o}$ of
 $(\phi,K)_\ast{\bf L}$.
 \end{remark}
 \begin{proof}
We recall that the morphism $(\phi,K)$ is obtained from a germ of an sc-diffeomorphism $f:(v, \eta)\to (v', \eta')=f(v, \eta)$ in the parameter space, satisfying $f(0, 0)=(0, 0)$,  together with a smooth germ $\phi_{(v, \eta)}:\alpha_{(v, \eta)}\rightarrow \alpha_{f(v, \eta)}'$ of isomorphism between stable maps satisfying  $\phi_{(0,0)}=\phi$.
Abbreviating the maps $\Lambda_u (\eta)=\wt{u}$ and $\Lambda'_{u'} (\eta')=\wt{u}'$ and recalling that $\wt{u}'\circ \phi_{(v,\eta)}=\wt{u}$ (by definition of an isomorphism between stable maps), we obtain, for suitable chosen $\ssc^+$-germs $s$ and $s'$ of sections, the identity 
\begin{equation*}
\begin{split}
\biggl(\dfrac{1}{2}\bigl[ &T\wt{u}'+J(\wt{u}')(T\wt{u}')j'(v')\bigr]-s'(v',\eta')\biggr)\circ T\phi_{(v, \eta)}\\
&= \dfrac{1}{2}\bigl[ T\wt{u}+J(\wt{u})\circ T\wt{u}\circ j(v)\bigr]-s(v,\eta).
\end{split}
\end{equation*}
 Recalling that $Df(0, 0)=K$, we set 
 $K(\delta v,\delta \eta)=(\delta v', \delta \eta')$ for $(\delta v,\delta \eta)\in E\oplus H^3_H(u^*TQ)$, and obtain at the point $(v, \eta)=(0, 0)$ the identity 
\begin{equation*}
\begin{split}
\biggl( \dfrac{1}{2}\bigl[&\nabla'(\delta \eta')+J(u')\nabla'(\delta \eta')\circ j' \bigr] +A'(\delta v', \delta\eta')\biggr)\circ T\phi\\
&=
 \dfrac{1}{2}\bigl[\nabla (\delta\eta)+J(u)\nabla(\delta \eta))j\bigr]+A(\delta v, \delta \eta).
 \end{split}
\end{equation*}
Therefore, 
$$
{\bf L}'\bigl(K(\delta v', \delta \eta')\bigr)\circ T\phi={\bf L}(\delta v, \delta \eta)
$$
and we see that ${\bf L}'$ belongs to the class ${\mathcal F}_{\alpha', \Xi', E'} $ of operators.
\end{proof}
The main result of this section is the following theorem.
\begin{theorem}\label{kkk<0}
Let $(\phi,K):(\alpha,H,E)\rightarrow (\alpha',H',E')$ be a morphism and ${\bf L}:E\oplus H^3_H(u^\ast TQ)\rightarrow H^2(u^\ast\Omega_{j,J})$ an operator in $ {\mathcal F}_{\alpha,\Xi,E}$.  Denote by ${\bf L}'=(\phi,K)_\ast{\bf L}:E'\oplus H^3_{H'}({(u')}^\ast TQ)\rightarrow H^2({(u')}^\ast\Omega_{j,J})$ the operator in ${\mathcal F}_{\alpha',\Xi',E'}$ which is the push-forward of ${\bf L}$.
 Then the push-forward of the complex orientation by $(\phi,K)$ is the complex orientation, i.e.
 $$
 (\phi,K)_{\ast}\mathfrak{o}_{\bf L} =\mathfrak{o}_{(\phi,K)_\ast{\bf L}}.
 $$
\end{theorem}
 We first prove the following special case of the theorem.

\begin{proposition}\label{ert<ll}   We consider  the smooth stable map 
$\alpha=(S,j,M,\emptyset,u)$  and let $\Xi$ and $\Xi_0$ be stabilizations  satisfying  $ \Xi_0\subset\Xi$.
Let $H_0$ be the constraints associated with $\Xi_0$ and $H$ the constraints associated with  $\Xi$. Let
$$
(\phi,K):(\alpha,H_0,E_0)\rightarrow (\alpha,H,E)
$$
be a morphism.  If ${\bf L}=(\phi,K)_\ast{\bf L}_0\in {\mathcal F}_{\alpha, \Xi,E}$ is the push-forward of  ${\bf L}_0\in {\mathcal F}_{\alpha, \Xi_0,E_0}$, 
then the push forward of the complex orientation 
$\mathfrak{o}_{\bf L_0}$ is the complex orientation $\mathfrak{o}_{\bf L}$, 
so that $$
(\phi,K)_\ast\mathfrak{o}_{{\bf L}_0} = \mathfrak{o}_{\bf L}.
$$
\end{proposition}
\begin{proof}
In order to verify the statement we are allowed, using a homotopy argument, to assume that $H_0$ is the restriction of $H$ to $\Xi_0$.
Again by a homotopy argument we also may take particular  deformations $v\mapsto  j_0(v)$ and $w\mapsto j(w)$. We can also change $J$ for the same reason, but we have to use the same structure
for both operators. Further we may assume that $\phi=\text{id}$. 

By the previous discussion,   being able to homotope problems and morphisms, it suffices to make a computation for well-chosen data. 
Consider $(S,j,M\cup\Xi_0)$. We take an effective orientation preserving germ 
$v\rightarrow j_0(v)$ defined on $E_0$ which, therefore, has a bijective, orientation-preserving  Kodaira differential at $v=0$. Moreover we assume  for small $v\in E_0$ that $j_0(v)=j$ near the points in $\Xi$.  Writing $\beta=(S,j,M\cup\Xi_0)$
and letting $\Gamma=\Xi\setminus\Xi_0$ we are going to apply the following lemma whose proof is based on a calculation of the Kodaira differential in \cite{HWZ-DM}.
\begin{lemma}\label{lem_Kodairs_diff}
Let $\beta=(S,j, M)$ be a stable marked Riemann surface  and let $\Gamma=\{z_1,\ldots, z_k\}$ be a collection of finitely many mutually different points not belonging to the set $M$ of marked points. We assume that $j_0(v)$ is an effective oriented deformation of $j$ defined for $v\in E_0$. We assume that $\phi_i:{\mathcal O}(T_{z_i}S, 0)\to S$ are germs of smooth embeddings satisfying 
$$\phi_i(0)=z_i\quad \text{and}\quad \dfrac{\partial \phi_i}{\partial w_i}(0)=\text{id}.$$
Define for small $w=(w_1,\ldots ,w_k)\in E_1$, where 
$$E_1=\bigoplus_{i=1}^kT_{z_i}S,$$
the deformation $\Gamma_w$ of $\Gamma$ by 
$\Gamma_w=\{\phi_1(w_1),\ldots ,\phi_k(w_k)\}.$ Finally, let 
$\Psi_w=\Psi (w, \cdot ):S\to S$ be a germ of smooth family of diffeomorphisms having compact supports near the points in $\Gamma$ and satisfying $\Psi_w(M)=M$ and $\Psi_w(\phi_i(w_i))=z_i$.  Moreover, $\Psi(0, z)=z$  for every $z\in S$ at $w=0$. Define for $(v, w)$ near $(0,0)\in E_0\oplus E_1$ the almost complex structure $j(v, w)$ on $S$ by $j(v, w)=\Psi^*_wj_0(v)$. Then the germ 
$$(v, w)\mapsto (S, j(v, w), M\cup \Gamma)$$
is an effective and orientation preserving deformation germ of $(S, j, M\cup \Gamma)$ on $(v, w)\in E=E_0\oplus E_1$.
\end{lemma}

We apply the lemma to the situation  in which the stable surface is $\beta=(S, j, M\cup \Xi_0)$ and 
$\Gamma$ is the set $\Gamma=\Xi\setminus \Xi_0=\{z_1,\ldots ,z_k\}$. From the lemma we obtain, using that $\Psi_w$ is the identity away from the points in $\Gamma$, for small $(v, w)\in E_0\oplus E_1$, the isomorphisms
$$\Psi_w:(S, j_0(w), M\cup \Xi_0\cup\Gamma_w)\to (S, j(v,w), M\cup \Xi)$$
between marked Riemann surfaces. In particular, 
$$T\Psi_w\circ j_0(v)=j(v, w)\circ T\Psi_w.$$
Moreover, 
\begin{equation}\label{eq_z_i}
\Psi_w(\phi_{i}(w_i))=z_i\quad  \text{for all $z_i\in\Xi\setminus\Xi_0$.}
\end{equation}
Taking the derivative of the map 
$w\mapsto \Psi_w(\phi_{i}(w))$ at the point $w=0$ in the direction 
$\delta w=(\delta w_1,\ldots,\delta w_k)\in \bigoplus_{i=1}^k T_{z_i}S$, and using that 
$\frac{\partial \phi_i}{\partial w_i}(0)=\text{id}$ and 
$\Psi (0, z)=z$ for all $z\in S$, we obtain the relation 
\begin{equation}\label{eq_z_i_1}
\sum_{s=1}^k\dfrac{\partial\Psi}{\partial w_s}(0, z_i)\delta w_s+\delta w_i=0
\end{equation}
for all $i=1,\ldots ,k$.

We  next consider  the germs 
\begin{gather*}
(v,\eta)\rightarrow (S,j_0(v),M,\emptyset,\Lambda_u(\eta))\\
(v,w,\xi)\rightarrow (S,j(v,w),M,\emptyset,\Lambda_u(\xi))
\end{gather*}
of good uniformizing families of stable maps. From Theorem \ref{key-z} we obtain a germ of an 
sc-smooth diffeomorphism in the parameter space
$$f:(v,\eta)\mapsto ((v, w), \xi)=f(v, \eta),$$
where $w=w(\eta)$ and $\xi =\xi (\eta)$ 
satisfy $w(0)=0$ and $\xi(0)=0$. The first aim is to compute the derivative $K=Df(0,0)$,
$$
Df(0,0)(\delta v,\delta \eta)=\biggl(\delta v, \dfrac{\partial w}{\partial \eta}(0)\delta \eta, \dfrac{\partial \xi}{\partial \eta}(0)\delta \eta \biggr).
$$
The diffeomorphism $f$ satisfies 
\begin{equation}\label{e<rr}
\Lambda_u(\eta) = (\Lambda_u(\xi (\eta)))\circ \Psi_{w(\eta)}.
\end{equation}
We recall from the proof of 
Theorem \ref{key-z}
that the map $w(\eta)$ is uniquely determined by the requirement 
$$\Lambda_u(\eta)(\phi_i(w_i(\eta))\in \Lambda_{u}(z_i, H_{z_i})$$
for $i=1,\ldots, k$, so that the  section 
$\Lambda_u(\eta)$ satisfies the constraints at the points $\phi_i(w_i(\eta))$. 
Taking the derivative of the maps 
$\eta\mapsto \Lambda_u(\eta)(\phi_i(w_i(\eta)))$ in the direction of $\delta\eta$ at the point $\eta=0$, 
we obtain, in view of $w_i(0)=0$ and $\phi_i(0)=z_i$, the relations 
\begin{equation*}\label{l<<L}
\delta\eta (z_i) + Tu(z_i)(\delta w_i) \in H_{z_i}, \quad i=1,\ldots, k,
\end{equation*}
where 
$$\delta w_i=\dfrac{\partial w_i}{\partial \eta}(0)\delta \eta\in T_{z_i}S.$$
Denoting by  $\pi_i:T_{u(z_i)}Q\rightarrow T_{u(z_i)}Q$ the projection onto $R(Tu(z_i))$, we conclude from  $\pi_i(H_{z_i})=0$ the equation 
\begin{equation}\label{u<u}
\delta w_i =\dfrac{\partial w_i}{\partial \eta}(0)\delta \eta = - Tu(z_i)^{-1}\pi_i (\delta\eta(z_i)).
\end{equation}
Differentiating the equation \eqref{e<rr} at the point $\eta=0$ in the direction of $\delta\eta$ and 
recalling that $\Psi(0, z)=z$ for all $z\in S$ and $\phi_i(w_i(0))=\phi_i(0)=z_i$,
we obtain, using \eqref{u<u}, the equation 
\begin{equation}\label{o<u}
\delta \eta (z) - Tu (z) \bigl(  \sum_{s=1}^k \frac{\partial\Psi}{\partial w_s}(0, z)\delta w_s\bigr) =\delta \xi (z)
\end{equation}
where, recalling that $\eta\mapsto \xi (\eta)$ satisfies $\xi(0)=0$, 
$$\delta \xi (z)=\biggl(\dfrac{\partial \xi}{\partial \eta}(0)\delta \eta\biggr)(z).$$
We denote the left hand side  of \eqref{o<u} by 
$P(\delta\eta)$,  so that \eqref{o<u}  becomes 
\begin{equation}\label{proj_eta}
P(\delta\eta) =\delta \xi.
\end{equation}
From $P(\delta\eta)(\zeta)=\delta \xi (\zeta)\in H_{\zeta}$ for all $\zeta\in \Xi$ we deduce that 
$\pi_i(P(\delta\eta)(z_j)=0$ for $j=1,\ldots ,k$, and conclude that 
$$P(P\delta\eta)=P(\delta\eta).$$
Hence $P$ is a bounded linear projection 
$$P:H^3_{H_0}(u^*TQ)\to H^3_{H_0}(u^*TQ).$$
Since $\frac{\partial \psi}{\partial w_i}(0, z)=0$ at the points $z$ away from $\Gamma=\{z_1,\ldots,z_k\}$,  the image of the operator $P$ is equal to 
$$P(H^3_{H_0}(u^*TQ))=H^3_{H}(u^*TQ).$$
Moreover, in view of \eqref{o<u} and \eqref{eq_z_i_1} and \eqref{u<u},
$$
[(Id-P)\delta\eta](z_i)= - Tu (z_i)\delta w_i=\pi_i\delta \eta (z_i).
$$
Consequently, the image of the projection 
$(Id-P)$,
$$N_1=(Id-P)(H^3_{H_0}(u^*TQ)),$$
is a $(\Xi,\Xi_0)$-subspace of  $H^3_{H_0} (u^*TQ)$ and we therefore obtain the topological direct sum 
$$
E_0\oplus H^3_{H_0}(u^\ast TQ) = E_0\oplus  N_1\oplus H^3_{H}(u^\ast TQ).
$$

Accordingly  we  decompose  $\delta v\oplus \delta \eta=\delta v\oplus \delta e\oplus\delta \xi$,  and  rewrite the linear isomorphism $K=Df(0, 0)$ in the form 
$$
K(\delta v,\delta e,\delta \xi) = (\delta v,\delta w (\delta e),\delta \xi),
$$
where $\delta w(\delta e)=(\delta w_1(\delta e),\ldots ,\delta w_k(\delta e))\in E_1$ is explicitly given  by 
$$\delta w_i(\delta e)=-Tu(z_i)^{-1}\pi_i(\delta e(z_i)).$$
The operator 
$$
{\bf L}_0(\delta v,\delta e,\delta \xi):= \nabla\xi +J(u)(\nabla\xi)j
$$ 
belongs to ${\mathcal F}_{\alpha, \Xi_0,E_0}$ and its complex orientation $\mathfrak{o}_{L_0}$ is obtained from the complex orientation of the operator $H^3_{H_0}(u^*TQ)\to H^2(u^*\Omega_{j, J})$ on the right hand side and the orientation of $E_0\oplus N_1$.

Since the map $(\delta v,\delta e)\mapsto (\delta v, \delta w)$ is orientation preserving, the orientation of the push-forward operator 
${\bf L}=(\text{id}, K)_\ast{\bf L}_0$ belonging to ${\mathcal F}_{\alpha, \Xi, E}$,  is the complex orientation. The proof of Lemma  
\ref{lem_Kodairs_diff} is complete. 

\end{proof}


Now we are in the position to prove Theorem \ref{kkk<0}.
\begin{proof}[Proof of Theorem \ref{kkk<0}]
We consider the morphism 
 $$
 (\phi,K):(\alpha,H,E)\rightarrow (\alpha',H',E')
 $$
which can be factored into the product
$$
(\alpha,H,E)\xrightarrow{(Id,L)}(\alpha,H^\ast,E')\xrightarrow{(\phi, L')}(\alpha',H',E').
$$
The second morphism is just the geometric pull-back of the data in $(\alpha',H',E')$ via the isomorphism $\phi:\alpha\rightarrow\alpha'$.
We already know from Proposition \ref{m<0} and Remark \ref{mm<0} that the geometric pull-pack and the  push-forward preserve the complex orientation. Therefore,  without loss of generality,  we may assume that
we are in the following situation
$$
(\alpha,H,E)\xrightarrow{(Id,K)} (\alpha,H',E').
$$
Then $\Xi,\Xi'\subset S$ and we define $\Xi''=\Xi\cup \Xi'$. We may assume,  by homotopy,  that the constraints over
$\Xi\cap \Xi'$ coincide. Associated  with $\Xi''$ we have the  constraints $H''$ satisfying $H''\vert \Xi=H$ and $H''\vert \Xi'=H'$. The associated
oriented vector space is denoted by $E''$. The above morphism factors as follows,
$$
(\alpha,H,E)\xrightarrow{(Id,L')}(\alpha,H'',E'')\xrightarrow{(Id,L'')} (\alpha,H',E').
$$
By applying Proposition \ref{ert<ll} to the first morphism and then to  the inverse of the second we see that  the complex orientation is preserved.
This implies the result we are aiming for and the proof of Theorem \ref{kkk<0} is complete.
\end{proof}



 
 The operators  in this subsection are not yet the operators we have to orient. However, they are very closely  related to the operators arising from the study of the Cauchy-Riemann  section $\ov{\partial}_J$ of the bundle $W\rightarrow Z$.
 




\subsection{Canonical Orientations for the CR-Operator}
Previously we have introduced a class of linear operators associated with the Cauchy-Riemann operator and have these operators  canonically oriented. In this subsection we relate them to the operators we actually have to orient
in order to turn the Cauchy-Riemann section  $(W\rightarrow Z,\ov{\partial}_J)$ into an oriented sc-Fredholm problem.

From Chapter \ref{four} and Chapter \ref{fredholm-section-z} we recall that the global models $E\rightarrow X$ and the  sections  $F$ representing the CR-section of $W\rightarrow Z$ are constructed from  local situations $F_\cg :\cg\rightarrow \what{\cg}$ in which  $F_\cg$ is represented
by an sc-Fredholm section ${\bf f}_\cg:{\mathcal O}\rightarrow\what{\mathcal O}$ such that the  diagram
$$
\begin{CD}
\cg @>F_\cg >> \what{\cg}\\
@VV \pi V    @VV\what{\pi} V\\
{\mathcal O}@>{\bf f}_\cg>> \what{\mathcal O}
\end{CD}
$$
commutes. 
Here $\pi$ and $\what{\pi}$ are the obvious projections from the graph to the domain. The  parameter spaces ${\mathcal O}$ are  open subsets
of splicing cores which are contractible sets. Later on, in the construction of the ep-groupoid $X$,  we take suitable open subsets of ${\mathcal O}$
such  that the collection ${\mathcal O}_\lambda$ will give on $Z$ a locally finite covering.  In any case, for the current discussion we may assume that the local section 
${\bf f}_\cg$ is defined on a  contractible set.  Therefore there are only two possible orientations
having the continuity property (over the smooth subset).  In view of  the above diagram the same is true for the section $F_\cg$. 

Let us refer to $F_\cg:\cg\rightarrow \what{\cg}$ as a {\bf local situation}.
We shall prove the following result.
\begin{theorem}\label{Maine<}
Every un-noded local situation $F_\cg:\cg\rightarrow \what{\cg}$ has a preferred orientation, called the complex orientation, which enjoys the continuation property along sc-smooth paths. In  other words,  we have for a smooth $x\in \cg$ a canonical orientation $\mathfrak{o}_x$ of $\text{DET}(F_\cg,x)$ so that continuation
along an sc-smooth path connecting two points relates the corresponding orientations. Moreover, the following holds. If 
$F_{\cg}:\cg\rightarrow \what{\cg}$ and $F_{\cg'}:\cg'\rightarrow \what{\cg}'$ are  two  un-noded local situations and if $\Phi:x\rightarrow x'$ is a morphism in $M(\cg,\cg')$ between two smooth points
with lift $\what{\Phi}$, then the associated push forward of the complex orientation is the complex orientation.
\end{theorem}



The proof of Theorem \ref{Maine<} will follow from Propositions \ref{prop_5.61} and \ref{A<A} below. 

We first construct the complex orientation for the local 
situations $F_\cg:\cg\rightarrow \what{\cg}$ built  on the un-noded stable map $\alpha=(S, j, M, \emptyset, u)$ using the notations of Chapter \ref{four} and Chapter \ref{fredholm-section-z}.  We take a good uniformizer 
$$q\rightarrow \alpha_q=(S,j(v),M,\emptyset,\exp_u(\eta)), \quad q=(v, \eta).$$
Note, there is no gluing parameter $a$! The section $\eta\in u^\ast TQ$ satisfies the constraints $\eta(z)\in H_z\equiv H_{u(z)}$ at the points $z\in \Xi$ of the stabilization set $\Xi$. The parameter $q=(v, \eta)$ varies in an open subset ${\mathcal O}$ of an sc-Banach space. We denote by 
$$\cg=\{(q, \alpha_q)\, \vert \, q\in {\mathcal O}\}$$
the graph of the uniformizing family and recall that  $\cg$ possesses the natural M-polyfold structure (in our case even an sc-manifold structure), which turns the projection $\pi:\cg\to \co$
into an sc-diffeomorphism. 

In order to recall also the strong bundle $\wh{\cg}$ over $\cg$ we consider the set $\wh{\co}=\{\wh{q}=(q, \xi)\}$ of pairs, in which $q\in \co$ and $\xi$ is a map 
$$
z\rightarrow [\xi(z):(T_zS,j)\rightarrow (T_{u(z)}Q,J)]
$$
into  complex anti-linear maps of class $H^{2,\delta_0}$ as introduced previously. The bundle $\wh{\co}\to \co$ is a strong bundle.  By 
$$\wh{\cg}=\{(\wh{q}, \wh{\alpha}_{\wh{q}}\, \vert \, \wh{q}\in \wh{\co}\}$$
we denote the graph of the lifted family $\wh{q}\mapsto  \wh{\alpha}_{\wh{q}}$, where $\wh{q}=(q, \xi)$. It is  defined by 
$$\wh{\alpha}_{\wh{q}} =(S,j(v),M,\emptyset,\exp_u(\eta),\Gamma(\exp_u(\eta),u)\circ\xi\circ\delta(v)). 
$$
Here the maps $\Gamma(\exp_u(\eta),u)$ and  $ \delta(v):(TS, j(v)\to (TS, j)$ are the complex linear maps introduced in Section \ref{polstrbundle}. As in the case of the sc-manifold $\cg$ above, the sc-smooth structure on $\wh{\cg}$ is defined by the requirement that the projction $\wh{\cg}\to \wh{\co}$ is an sc-diffeomorphism. 

Continuing with recollections, the section $F_{\cg}$ of the strong bundle $\wh{\cg}\to \cg$ representing the Cauchy-Riemann section is defined by 
\begin{equation}\label{eq_5_59} 
F_{\cg}(q, \alpha_q)=\bigr((q, {\bf f}(q)), \wh{\alpha}_{(q, {\bf f}(q))}\bigr).
\end{equation}
The section ${\bf f}$ of the bundle $\wh{\co}\to \co$ is  the anti-linear map ${\bf f }(q)$, defined at the point $q=(v, \eta)$ by the Cauchy-Riemann section as follows,
\begin{equation}\label{e<r}
\begin{split}
\Gamma(&\exp_u(\eta),u)\circ {\bf f}(q)\circ \delta(v)\\
& =\dfrac{1}{2}\bigl[ T(\exp_u(\eta)) + J(\exp_u(\eta))\circ (T(\exp_u(\eta)))\circ j(v)\bigr].
\end{split}
\end{equation}
It is clear that the linearizations of ${\bf f}$ are related to the linearizations of the Cauchy-Riemann section on the right-hand side of \eqref{e<r}. This will lead to the class of operators introduced in the previous subsection. 

Given a smooth point $q_0=(v_0, \eta_0)$,  we choose an $\ssc^+$-section ${\bf s}$ of $\wh{\co}\to \co$ satisfying ${\bf s}(q_0)={\bf f}(q_0)$ and define the section 
$s$ by 
\begin{equation*}
s(q)=\Gamma(\exp_u(\eta),u)\circ {\bf s}(q)\circ \delta(v), \quad q=(v, \eta).
\end{equation*}
From  \eqref{e<r} we deduce the identity for all $q=(v, \eta)\in \co$, 
\begin{equation}\label{eq_5.61}
\begin{split}
\Gamma(&\exp_u(\eta),u)\circ [{\bf f}(q)-{\bf s}(q)]\circ \delta (v)\\
&= \dfrac{1}{2}\bigl[ T(\exp_u(\eta)) + J(\exp_u(\eta))(T(\exp_u(\eta)))\circ j(v)\bigr]-s(q).
\end{split}
\end{equation}
Abbreviating the fiber derivative at smooth points $q=(v, \eta)$ by 
$\Phi_q(\delta\eta)=\nabla_2\exp_u(\eta)\delta \eta$, we obtain for  the linearization of the identity \eqref{eq_5.61} at the special smooth point $q_0=(v_0, \eta_0)\in \co$ in the direction of $\delta q=(\delta v, \delta \eta)$, recalling that ${\bf f}(q_0)={\bf s}(q_0)$, the identity 
\begin{equation}\label{bb2}
\begin{split}
\Gamma(&\exp_u(\eta_0),u)\circ ({\bf (f-s)}'(q_0)\delta q)\circ \delta(v)\\
& =\bigl[  \nabla (\Phi_{q_0}(\delta\eta)) + J(\exp_u(\eta_0))\nabla(\Phi_{q_0}(\delta \eta))\circ j(v_0)\bigr]\\
&\phantom{=}+A(\delta v,\Phi_{q_0}(\delta\eta))\\
&\equiv  {\bf L}_{q_0}(\delta v,\Phi_{q_0}(\delta\eta)).
\end{split}
\end{equation}
The covariant derivative $\nabla$ has already been used before. The operator  $ {\bf L}_{q_0}$ is defined by the formula 
\eqref{bb2} and belongs to the class of operators discussed in the previous subsection.

 Introducing the linear maps $\wt{\Phi}_{q_0}$ by 
$\wt{\Phi}_{q_0}(\delta v, \delta \eta)=(\delta v, \Phi_{q_0}(\delta \eta))$ and $\Theta_{q_0}(\gamma) =\Gamma(\exp_u(\eta_0),u)\circ \gamma \circ \delta(v_0)$, the equation \eqref{bb2}  
becomes 
\begin{equation}\label{o1}
\Theta_{q_0}\circ \bigl[({\bf f}-{\bf s})'(q_0)(\delta q)\bigr]= {\bf L}_{q_0} \circ \tilde{\Phi}_{q_0}(\delta q)
\end{equation}
where $\delta q=(\delta v, \delta\eta)$.

We now equip the Fredholm operator ${\bf L}_{q_0}$ with the 
the complex orientation from the previous subsection, which, using the coordinate change associated with $ \tilde{\Phi}_{q_0}$ and 
$\Theta_{q_0}$ defines the orientation of the Fredholm operator 
${\bf (f-s)}'(q_0)$.

To be explicit, the orientation $\mathfrak{o}$ of the operator 
$({\bf f}-{\bf s})'(q_0)$ defined by the vector $(h_1\wedge\ldots\wedge h_k)\otimes (h_1^\ast\wedge\ldots \wedge h_l^\ast)$ 
corresponds to the orientation $\mathfrak{o}'$ of ${\bf L}_{q_0}$ defined by the vector
$(\wt{\Phi}_{q_0}(h_1)\wedge\ldots\wedge\wt{\Phi}_{q_0}(h_k))\otimes(h_1^\ast\circ\Theta^{-1}_{q_0}\wedge\ldots\wedge h_l^\ast\circ\Theta^{-1}_{q_0})$.

As a consequence we obtain  an orientation for the section $F_\cg$ of the bundle $\wh{\cg}\to \cg$. The transformations used to transport the orientation 
from ${\bf L}_{q_0}$ to $({\bf f}-{\bf s})'(q_0)$ are level-wise smooth and the orientations for the  operators of type  
${\bf L}_{q_0}$ possess, as we already know, the continuation property along sc-smooth paths. This implies that the orientations of the linearizations at the section ${\bf f}$ at the 
 various smooth points have the continuation property along sc-smooth paths. So far we have proved the following result.

\begin{proposition}\label{prop_5.61}
Given a good uniformizing family $q\mapsto \alpha_q$ around an un-noded  stable map $\alpha$, and given the section $F_\cg$ of the associated strong bundle $\wh{\cg}\rightarrow \cg$, which  represents  the Cauchy-Riemann section,
there is at every smooth point  $(q, \alpha_q)$ a natural orientation of the determinants of the linearizations, called the the complex orientation.
It is the orientation corresponding at a smooth $(q,\alpha_q)$ via the identity \eqref{o1} to the complex orientation of the Cauchy-Riemann operator ${\bf L}_q$.
Since the coordinate change depends smoothly on $q$,  the complex orientation for $F_\cg$ has the continuation property along sc-smooth paths.
\end{proposition}



At this point we have constructed for the section $F_\cg$ of the strong bundle $\wh{\cg}\rightarrow \cg$, built on an un-noded stable map $\alpha$,
a canonical orientation called the {\bf complex orientation}. We shall call  the section $F_\cg:\cg\rightarrow \what{\cg}$ an {\bf un-noded local model} and,  if equipped 
with the complex orientation, we call it  a {\bf canonically oriented un-noded local model}. 

We  next prove the following statement  which relates the orientations between two such local models. 

\begin{proposition}\label{A<A}
Let  $F_\cg:\cg\rightarrow \wh{\cg}$ and $F_{\cg'}:\cg'\rightarrow \wh{\cg}'$ be  canonically oriented un-noded local models.
Let  $\Phi_0\colon  x_0\rightarrow x'_0$ be  an isomorphism between smooth points in $\cg$ resp. $\cg'$,  belonging to to the set $M(\cg,\cg')$ of morphisms. 
Then the push-forward ${(\Phi_0)}_\ast: \text{DET}(F_\cg,x_0)\rightarrow \text{DET}(F_{\cg'},x'_0)$ is orientation preserving. 
\end{proposition}
The proof requires some preparation.  We start with two  smooth un-noded stable maps $\alpha=(S,j,M,\emptyset,u)$ and $\beta=(S',j',M',\emptyset,u')$ having the associated good uniformizing 
families $q\mapsto \alpha_q$  on $q\in \co$ and $p\mapsto  \beta_p$ on $p\in \co'$. We denote the corresponding graphs by 
$\cg$ and $\cg'$.  By construction, the points $q=(v, \eta)\in \co$ belong to $E\oplus H^3_H(u^\ast TQ)$, where the subscript $H$ indicates
the constraints $\eta(z)\in H_{u(z)}$ for $z$  belonging to the  stabilization set $\Xi$. As usual we shall  abbreviate $H_z\equiv H_{u(z)}$. Analogously, the points $p=(w, \xi)\in \co'$ belong 
$E'\oplus H^3_{H'}((u')^\ast TQ)$ satisfying the constraints $H'$ associated with the stabilization set $\Xi'$.

We now assume that there exists an isomorphism 
$$\Phi_0=\bigl((q_0,\alpha_{q_0}), \phi_0, (p_0,\beta_{p_0})\bigr)\in M(\cg, \cg')$$
in the morphism set in which  
$\phi_0\colon \alpha_{q_0}\to \beta_{p_0}$ is an isomorphism between stable maps. 
We use the notation $q_0=(v_0, \eta_0)$ and $p_0=(w_0,\xi_0)$. By Theorem \ref{key-z} there is a germ of an sc-diffeomorphism $p=f(q)$ between the parameters satisfying $p_0=f(q_0)$, and a core-smooth family $q\mapsto  \phi_q$ of isomorphims  
$$
\phi_q:\alpha_q\rightarrow \beta_{f(q)}
$$
between the stable maps satisfying $\phi_{q_0}=\phi_0$.
Differentiating the sc-smooth map $f$  at  the distinguished point $q_0$ we obtain a topological linear isomorphism
\begin{equation}\label{eq_5.65}
\wt{K}=Df(q_0)\colon E\oplus H^3_H(u^\ast TQ)\rightarrow E'\oplus H^3_{H'}((u')^\ast TQ).
\end{equation}
Next we consider the second un-noded local model $F_{\cg'}\colon \cg'\to \wh{\cg}'$ representing the Cauchy-Riemann section and defined by 
$$F_{\cg'}(p, \beta_p)=\bigl((p, {\bf g}(p)), 
\wh{\beta}_{(p, {\bf g}(p))}\bigr),$$
where the section ${\bf g}$ of the bundle $\wh{\co}'\to \co'$ is defined, at $p=(w, \xi)$, by 
\begin{equation}\label{bb11_0}
\begin{split}
\Gamma'(&\exp_{u'}'(\xi),u')\circ ({\bf g}(p)\circ \delta'(w)\\
& =\dfrac{1}{2}\bigl[ T(\exp_{u'}'(\xi)) + J(\exp'_{u'}(\xi))(T(\exp_{u'}'(\xi)))\circ j'(w)\bigr].
\end{split}
\end{equation}
Using the notation $f(q)=(w(q), \xi (q))$ we conclude,  from the properties of the isomorphisms $\phi_q$, that 
$\exp_{u'}'(\xi(q))\circ \phi_q=\exp_u(\eta)$
where $q=(v,\eta)$, and hence 
$$T(\exp_{u'}'(\xi (q))) )\circ T\phi_q=T(\exp_u(\eta)).$$
Moreover, 
$j'(w(q))\circ T\phi_q=T\phi_q\circ j(v).$
Therefore, for all $q=(v, \eta)$,
\begin{equation*}
\begin{split}
\dfrac{1}{2}&\bigl[ T(\exp_{u'}'(\xi(q))) + J(\exp'_{u'}(\xi(q)))(T(\exp_{u'}'(\xi(q)))\circ j'(w(q))\bigr]\circ T\phi_q\\
&\phantom{==}=
\dfrac{1}{2}\bigl[ T(\exp_{u}(\eta)) + J(\exp_{u}(\eta))(T(\exp_{u}(\eta))\circ j(v)\bigr].
\end{split}
\end{equation*}
We obtain the following identity in $q=(a, \eta)$,
\begin{equation*}
[\Gamma'(\exp_{u'}'(\xi (q)),u')\circ {\bf g}(f(q))\circ \delta'(w(q))]\circ  T\phi_q=
\Gamma(\exp_u(\eta ),u)\circ {\bf (f}(q)\circ \delta(v).
\end{equation*}
Hence, for all $q\in \co$ near $q_0$, 
\begin{equation}\label{bb11}
\begin{split}
\bigl[ \Gamma'(&\exp_{u'}'(\xi (q)),u')\circ [{\bf g}(f(q))-{\bf t}(f(q))]\circ \delta'(w(q))\bigr]\circ T\phi_q\\
& = \Gamma(\exp_u(\eta),u)\circ [{\bf (f-s)}(q)\delta q ]\circ \delta(v),
\end{split}
\end{equation}
 where  the section ${\bf t}$ of $\wh{\co}'\to \co$ is defined by 
 $[\Gamma'(\exp_{u'}'(\xi(q)), u')\circ {\bf t}(f(q))\circ \delta'(w(q))]\circ T\phi_q=\Gamma(\exp_u (\eta), u)\circ {\bf s}(q)\circ \delta (v).$
 Differentiating the identity \eqref{bb11} in $q$ at the distinguished  point $q_0=(v_0, \eta_0)$ where $({\bf g}-{\bf t})(f(q_0))=0$ and $({\bf f}-{\bf s})(q_0)=0$, and recalling that $\phi_{q_0}=\phi_0$ and $f(q_0)=p_0$, we obtain the equation 
$$ \Theta'_{p_0}\circ ({\bf g-t})'(p_0)\circ  \wt{K}(\delta q)\circ T\phi_0 = \Theta_{q_0}\circ ({\bf f-s})'(q_0)\delta q,$$
where $\delta q=(\delta v, \delta \eta)$.
In view of the definition of the operator ${\bf L}_{q_0}$ in \eqref{bb2} and the analogous definition of ${\bf L}'_{p_0}$ for the above primed version, we find the equation
\begin{equation}\label{o101}
({\bf L}'_{p_0}\circ \wt{\Phi}'_{p_0}\circ \wt{K}(\delta q))\circ T\phi_0 = {\bf L}_{q_0}\circ\tilde{\Phi}_{q_0}(\delta q).
\end{equation}
Recalling the fiber derivatives 
$$\wt{\Phi}_{q_0}(\delta q)=(\delta v, \nabla_2\exp_u (\eta_0)\delta \eta),$$
where $q_0=(v_0, \eta_0)$ and $\delta q=(\delta v, \delta \eta)$, 
we introduce  the analogous primed version at $p_0=(w_o, \xi_0)$, defined by 
 $$\wt{\Phi}'_{p_0}(\delta p)=(\delta w, \nabla_2\exp'_u (\xi_0)\delta \xi)$$
for $\delta p=(\delta w, \delta \xi)$. We define a new set of constraints $H^0$ by $H^0_\zeta=\nabla_2\exp_u(\eta_0)(H_z)$ for $\zeta=\exp_u (\eta_0)(z)$ and $z\in \Xi$. These are the constraints for the map $u_0=\exp_u(\eta_0)$. Analogously we define the constraints ${H^0}'$ in the primed version for the map 
$u'_0=\exp_{u'}'(\xi_0)$. 
Then 
$$\wt{\Phi}_{q_0}:E\oplus H^3_H(u^*TQ)\to E\oplus H^3_{H^0}(u^*_0TQ)$$
is a topological isomorphism. 
Analogously, in the primed case,
$$\wt{\Phi}'_{q_0}:E'\oplus H^3_{H'}((u')^*TQ)\to E'\oplus H^3_{{H^0}'}((u')^*_0TQ)$$
is a topological isomorphism. The topological linear isomorphism $K$ is defined by requiring that the following diagram is commutative, 
$$
 \begin{CD}
E\oplus H^3_H(u^\ast TQ)@>\wt{K}>> E'\oplus H^3_{H'}({(u')}^\ast TQ)\\
@VV\tilde{\Phi}_{q_0} V    @VV\tilde{\Phi}'_{p_0}V\\
 E\oplus H_{H^0}^3(u_0^\ast TQ)@>K>> E'\oplus H^3_{H^{0'}}({(h_0)}^\ast TQ).
 \end{CD}
 $$
Here $\wt{K}=Df(q_0)$.  The equation \eqref{o101} can be rewritten in the form 
\begin{equation}\label{eq_5.68}
[{\bf L}_{p_0}'\circ K(\delta q)]\circ T\phi_{0} = {\bf L}_{q_0}(\delta q).
\end{equation}
In order to complete the proof of Proposition \ref{A<A} we use the following computation.
 \begin{lemma}\label{hofer}
 The topological linear isomorphism 
 $$
 K: E\oplus H_{H^0}^3(u_0^\ast TQ)\rightarrow E'\oplus H^3_{H^{0'}}({(h_0)}^\ast TQ)
 $$
together with the isomorphism $\phi_0:\alpha_{q_0}\to \beta_{p_0}$  is a general linear coordinate change  $(\phi_0,K)$ in the sense of Definition \ref{GENERAL}.
 \end{lemma}
 \begin{proof}%
By a change of coordinates we shall arrive at the setting of Definition \ref{GENERAL}. First we recall the sc-smooth parameter transformation $p=f(q)$. In detail, $p=(w, \xi)=(f_1(q), f_2(q))$ and 
 $q=(v, \eta)$. It satisfies, for all $q$ near $q_0$ the relations
 \begin{align*}
 \exp_{u'}'(\xi)\circ \phi_q &=\exp_u(\eta)\\
 T\phi_q\circ j(v)&=j'(w)\circ T\phi_q.
  \end{align*}
  Moreover, $\phi_q(m)=m'$ for all $m\in M$ and $\phi_{q_0}=\phi_0$. The constraints are $\eta(z)\in H_z$ and $\xi (z')\in H_{z'}'$ for all $z\in \Xi$ and $z'\in \Xi'$. We shall reformulate all these relations in the new coordinates 
 $(\wh{v},\wh{\eta})\in E\oplus H^3_{H^0}(u^\ast_0 TQ)$ and $(\wh{w},\wh{\xi})\in E'\oplus H^3_{H^{0'}}((u_0')^\ast TQ)$,
 where 
 $u_0=\exp_u (\eta_0)$ and $u_0'=\exp_{u'}' (\xi_0)$, defined by the formulae  
 {
 \begin{equation}\label{BUD}
\begin{aligned}
&\text{$v=v_0+\wh{v}$\quad\,\,   \text{and}\quad $\eta=\eta_0+\nabla_2\exp_u(\eta_0)^{-1}\wh{\eta} $}\\
&\text{$w=w_0+\wh{w}$\quad  \text{and}\quad $\xi=\xi_0+\nabla_2\exp'_{u'}(\xi_0)^{-1}\wh{\xi}$}.
\end{aligned}
\end{equation}
}
Correspondingly the almost complex structures become 
$\wh{j}(\wh{v})=j(v_0+\wh{v})$ and $\wh{j}'(\wh{w})=j'(w_0+\wh{w})=j'(w)$ so that 
$$\phi_0\colon (S, \wh{j}(0), M, \emptyset, u_0)\to 
(S', \wh{j}'(0), M', \emptyset, u_0')$$
is the isomorphism from before between the stable maps. We have the associated uniformizers, abbreviating
$\wh{q}=(\wh{v}, \wh{\eta})$ and $\wh{p}=(\wh{w}, \wh{\xi})$, 
 {
 \begin{align*}
\wh{q}\mapsto \wh{\alpha}_{\wh{q}}&=
 \bigl(S, \wh{j}(\wh{v}), M, \emptyset, \exp_u\bigl(\eta_0+\nabla_2\exp_u(\eta_0)^{-1}\wh{\eta}\ \bigr)\\
\wh{p}\mapsto \wh{\beta}_{\wh{p}}&=
 \bigl(S', \wh{j}'(\wh{w}), M', \emptyset, \exp'_{u'}\bigl(\xi_0+\nabla_2\exp_{u'}'(\xi_0)^{-1}\wh{\xi}\ \bigr).
 \end{align*}
}	 
The parameter transformation $f$ becomes, in the new coordinates, {$\wh{p}=(\wh{w}, \wh{\xi})=\wh{f}(\wh{q})$}, and looks in detail as follows,
{
\begin{align*}
\wh{w}&=f_1\bigl( v_0+\wh{v}, \eta_0+\nabla_2\exp_u(\eta_0)^{-1}\wh{\eta}\bigr)-w_0\\
\wh{\xi}&=\nabla_2\exp'_{u'}(\xi_0)\bigl[ f_2\bigl( v_0+\wh{v}, \eta_0+\nabla_2\exp_u(\eta_0)^{-1}\wh{\eta}\bigr)-\xi_0\bigr].
\end{align*}
}
The local sc-diffeomorphism $\wh{f}$  satisfies $\wh{f}(0)=0$.
Rewriting the smooth family $\phi_q=\phi_{(v,\eta)}$ of isomorphisms,  we introduce the map
 {
$$\wh{\phi}_{(\wh{v},\wh{\eta})} :=\phi_{(v_0+\wh{v},\eta_0+\nabla_2\exp_u(\eta_0)^{-1}\wh{\eta})}
$$
}
and obtain that $T\wh{\phi}_{\wh{q}}\circ \wh{j}(\wh{v})=
\wh{j}'(\wh{w})\circ T\wh{\phi}_{\wh{q}}$ and 
 {
$$\exp_{u'}'\bigl(\xi_0+\nabla_2\exp'_{u'}(\xi_0)^{-1}\wh{\xi}\ \bigr)\circ \wh{\phi}_{\wh{q}}=
\exp_{u}\bigl(\eta_0+\nabla_2\exp_{u}(\eta_0)^{-1}\wh{\eta}\bigr).
$$
}
Therefore, $\wh{\phi}_{\wh{q}}:\wh{\alpha}_{\wh{q}}\to 
\wh{\beta}_{\wh{f}(\wh{q})}$ is a smooth family of isomorphisms between stable maps, satisfying $\wh{\phi_0}=\phi_0$. By construction, the constraints become $\wh{\eta}(\zeta)\in H^0_\zeta$ where 
$\zeta=\exp_u (\eta_0)(z)$ for $z\in \Xi$ and $\wh{\xi}(\zeta')\in {H^0}'_{\zeta'}$ where $\zeta'=\exp_{u'}'(\xi_0)(z')$ and $z'\in \Xi'$.
Finally, a computation shows that 
$$\wt{\Phi}'_{p_0}=D\wh{f}(0)=Df(p_0)\circ \wt{\Phi}_{q_0}.$$
Consequently, $K=D\wh{f}(0)$ and we have verified our claim that the pair $(\phi_0, K)$ is indeed a morphism in the sense of 
Definition \ref{GENERAL}. 
 \end{proof}
 In view of Lemma \ref{hofer} and Theorem \ref{kkk<0}  the proof of Proposition \ref{A<A} is finished  \hfill  $\blacksquare$

With Proposition \ref{prop_5.61} and Proposition \ref{A<A} , the proof of Theorem \ref{Maine<} is complete.\hfill 
$\blacksquare$
 
So far we have considered only un-noded local models $\what{\cg}\rightarrow \cg$ with local sections $F_\cg$, where $\cg$ is  built  on families of un-noded stable maps on which the set of nodal pairs is empty. For these sections we have constructed a canonical orientation 
for $\text{DET}(F_\cg,x)$ at smooth points $x\in \cg$, called the complex orientation. It  enjoys the continuation property along smooth paths. Moreover, in view of Proposition \ref{A<A}  a morphism $\Phi\in M(\cg,\cg')$ between two un-noded models  pushes the complex  orientation forward to  the complex orientation.


In the next step we shall canonically orient the section  $F_\cg$ of a noded local  model $\wh{\cg}\to \cg$. We recall that $\cg$ is the graph 
$\cg=\{(q, \alpha_q)\, \vert \, q\in \co\}$ and the family $q\mapsto \alpha_q$ is now a noded uniformizing family where $q$ varies in the splicing core $\co$.  By construction, the splicing core $\co$ is connected and has the property that 
that every sc-smooth loop is contractible. 
Consequently, the section $F_\cg$ has two possible orientations possessing the continuation property along sc-smooth paths. We shall show that there is a canonical choice of one of the  two possible orientations. 
In order to do so we choose a smooth point $x_0=(q_0, \alpha_{q_0})\in \cg$ which  represents an un-noded map.  This can be done since
the un-noded elements are open and dense.

We shall use in the following  that the subset consisting of  the noded stable maps in $\cg$ behaves
as if it has ``codimension $2$''. Namely if $\phi:[0,1]\rightarrow {\mathcal G}$ is an sc-smooth path starting and ending at un-noded elements 
we can take a small deformation avoiding all noded elements. This is  true
because a complex gluing parameter associated with a node has real dimension $2$.  Similarly, if $\phi$ is an sc-smooth path starting at an un-noded element
and ending at a noded element, then it can be deformed to an sc-smooth  path $\psi$, where $\psi(1)$ is the original end point, $\psi(0)$ is the original starting point,
and $\psi(t)$ is un-noded for all $t\in [0,1)$.



 At the previously chosen un-noded element $x_0$ we construct the un-noded local model $\wh{\cg}'\to \cg'$ having the section $F_{\cg'}$. It is represented by the graph $\cg'=\{(p, \alpha'_p)\}$ and satisfies $(0, \alpha'_0)\equiv x_0'=(q_0, \alpha_{q_0})=x_0$. There exists an isomorphism $\Phi=(x_0,\text{id}, x_0')\in M(\cg, \cg')$. 


We are going to equip the orientation $\mathfrak{o}$ of $F_\cg$ with the orientation coming from the orientation $\mathfrak{o}_{x_0}$ by continuation along sc-smooth paths.  The orientation 
 $\mathfrak{o}_{x_0}$ is defined by the requirement that its push-forward $\Phi_\ast \mathfrak{o}_{x_0}$ by the coordinate change, is the complex orientation  $\mathfrak{o}_{x_0'}$ of 
 $x_0'\in \cg'$. This definition of the orientation 
  $\mathfrak{o}_{x_0}$ does not depend on the choice of $x_0'$. Indeed, assume that $x_0=x_0''\in \cg''$ and $x_0''=(p_0', \alpha''_{p_0'})$ belongs to a second such un-noded local model $\wh{\cg}''\to \cg''$ having the local section $F_{\cg''}$. Then we have the isomorphism $\Phi'=(x_0, \text{id}, x_0'')\in M(\cg, \cg'')$. By Proposition  \ref{A<A}, the isomorphism
$$\Phi'\circ \Phi^{-1}=(x_0',\text{id}, x_0'')\in M(\cg',\cg'')$$
preserves the complex orientation. Therefore,  
the orientation $\mathfrak{o}_{x_0}$ induced from the complex orientation $\mathfrak{o}_{x_0'}$ agrees with the orientation induced from the complex orientation $\mathfrak{o}_{x_0''}$. The construction is clearly locally stable. Using that the splicing core $\co$ is connected and every sc-smooth loop is contractible, we can, starting from our choice of the orientation of $\text{DET}(F_\cg,x_0)$, using the property of continuation  along smooth paths, orient the set $\text{DET}(F_\cg, x)$ at every smooth point $x\in \cg$. We call this orientation  $\mathfrak{o}$ temporarily the canonical orientation of $\cg$.

We still have to show for an isomorphism $\Phi=(x, \phi, x')\in M(\cg, \cg')$ that the push-forward of the canonical orientation $\mathfrak{o}_x$ is the canonical orientation $\mathfrak{o}_{x'}$, which, as we already know, holds true in the un-noded case. To verify this we take the local sc-diffeomorphism $\phi=t\circ s^{-1}:O(x)\to O(x')$ between the two open neighborhoods such that  the morphisms $\Phi_y=(y, \phi, \phi (y))\in M(\cg, \cg')$ are  associated isomorphisms  for all $y\in O(x)$. We take a smooth point $y_0\in O(x)$ representing an un-noded element and an sc-smooth path 
$\gamma:[0,1]\to O(x)\subset \cg$ connecting $y_0=\gamma (1)$ with $x=\gamma (0)$, such that $\gamma (\tau )$ is un-noded for $\tau\in (0,1]$. Then $\phi (\gamma (\tau))$ is an sc-smooth path connecting $\phi (\gamma (1))$ with $\phi (\gamma (0))=x'$, such that $\phi (\gamma (\tau))$ is un-noded for $\tau \in (0, 1]$. In view of Proposition  \ref{A<A}, the isomorphism 
$\Phi_{y_0}=(y_0, \phi, \phi (y_0))\in M(\cg, \cg')$ pushes the complex orientation $\mathfrak{o}_{y_0}$ to the complex orientation $\mathfrak{o}_{\phi (y_0)}$. Since the canonical orientation $\mathfrak{o}_x$ is obtained by continuation  
 along the path $\gamma$ from the complex orientation $\mathfrak{o}_{y_0}$  and similarly,  the orientationation $\mathfrak{o}_{x}$  is obtained by continuation along the path $\phi\circ \gamma$ from the complex orientation $\mathfrak{o}_{\phi (y_0)}$, we conclude, by continuity, that indeed the isomorphism $\Phi=(x, \phi, x')$ pushes the canonical orientation  $\mathfrak{o}_{x}$  to the canonical orientation  $\mathfrak{o}_{x'}$ as we wanted to show.
 
Now, for every local model $\wh{\cg}\to \cg$ having the section $F_\cg$, the determinant space 
 $\text{DET}(F_\cg, x)$ at a smooth point possesses a canonical orientation, now called {\bf complex orientation}. It has the continuation property along sc-smooth paths. Moreover, a morphism $\Phi=(x, \phi, x')\in M(\cg, \cg')$ between any two local models  connecting smooth points pushes the complex orientation forward to the complex orientation.
 

Finally we are ready to prove the main result.

\begin{proof}[Proof of Theorem \ref{BINGO}]
In order to complete our construction of the canonical orientation we recall that the models $(E\to X, F)$ for the Cauchy-Riemann section $(W\to Z, \ov{\partial}_J)$ are obtained by gluing the local models $(\wh{\cg}\to \cg, F_\cg)$ by means of isomorphisms together. 


At this point all local situations $F_\cg:\cg\rightarrow \what{\cg}$ are oriented with a canonical orientation, called the complex orientation. These orientations are compatible with the morphisms in $M(\cg,\cg')$ and $M(\wh{\cg},\wh{\cg}')$.  In the construction of a model 
$F:X\rightarrow E$ we take open subsets of the graphs $\cg$.  The thereby restricted local models are still oriented. 

It is clear that 
$X$ and $E$,  as disjoint unions of local models, possess a canonical orientation which is compatible with morphisms.

Moreover, if  $X$ and $X'$  are two models constructed  this way we take  the union of both families to obtain the third model $X''$ and two equivalences
$X\rightarrow X''$ and $X'\rightarrow X''$. The equivalences preserve the orientations of the sections of the corresponding strong bundles. 
Whatever model of this kind (it depends on the choice of the local models used),  the orientations are compatible. This implies that the  Cauchy-Riemann section $\ov{\partial}_J:Z\rightarrow W$ possesses  a canonical orientation.
The proof of Theorem \ref{BINGO} is complete.  
\end{proof}
We sketch in this article  a new theory, which we call {\sl
		Symplectic Field Theory } or SFT,  which provides an approach to
Gromov-Witten invariants of symplectic manifolds and their
Lagrangian submanifolds in the spirit of topological field theory,
and at the same time
serves as a rich source
of new invariants of contact manifolds and their Legendrian
submanifolds. Moreover, we  hope that the applications of  SFT
go far beyond this framework.\footnote{The research is   partially
	supported by the National Science Foundation.}

Despite its length, the current paper presents only a very sketchy
overview of  Symplectic Field Theory. It contains practically no proofs,
and in a few places where the proofs  are given
their role is    just to
illustrate the involved ideas,  rather than to give  complete rigorous
arguments.

The ideas, the algebraic formalism, and some of the applications
of this new theory were presented  and popularized
by the authors at several conferences
and seminars (e.g. \cite{Eliash-ICM}). As a result,
currently there exists a  significant
mathematical community which is in some form familiar with
the subject.
Moreover, there are
many mathematicians, including several former
and current students of the authors,
who are actively working  on foundational aspects
of the theory and its applications, and    even
published papers on this subject. Their results
show that already the simplest versions of the theory
have some remarkable corollaries (cf. \cite{Ustilovsky}).
We hope that   the present  paper will help
attracting even more people
to   SFT.

Of course, our ideas give just a small new twist
to many other active directions of research in
Mathematics and Physics
(Symplectic topology, Gromov-Witten invariants and quantum cohomology,
Floer homology theory, String theory,
just to mention few), pioneered by  V.I. Arnold,
C.~Conley-E.~Zehnder,
M.~Gromov, S.K. Donaldson, E.~Witten, A.~Floer,
M.~Kontsevich and others
(see \cite{Arnold-conjecture, Conley-Zehnder,
	Gromov-holomorphic, Donaldson-invariants, Floer, Ruan, Witten1, Witten2, Kontsevich-CP2,
	Konts-Manin}).
Many people independently contributed results and ideas,
which may be considered as  parts of  SFT.
Let us just mention here the work of  Yu.Chekanov
\cite{Chekanov},
K.Fukaya--K.Ono--Y.-G.Oh--H.Ohta  \cite{FKO3},
A.~Gathmann  \cite{Gathmann}, E.Ionel--T.Parker
\cite{Ionel-Parker, Ionel}  , Y.Ruan--A.-M.Li  \cite{Ruan-Li}.
It also  draws on  other results of   the  current authors
and their coauthors (see \cite{EHS, EH-3ball, Givental, Givental-Maslov,
	Givental-toric, Hofer-Weinstein, Hofer-Wysocki-Zehnder, AbbasHofer,
	HoferWysockiZehnder:94d, HoferWysockiZehnder:99}). The contact-geometric
ingredient of our work is greatly motivated by two
outstanding conjectures in contact geometry: Weinstein's conjecture about periodic
orbits of Reeb fields  \cite{Weinstein},
and  Arnold's chord conjecture \cite{Arnold-steps}.


Presently, we are working on a series of papers devoted
to the foundations,
applications,  and further development of  SFT.  Among the applications,
some of which are mentioned in this paper, are new invariants of contact manifolds
and Legendrian knots and links, new methods for computing Gromov-Witten invariants,
new restrictions on the topology of Lagrangian submanifolds, new non-squeezing type
theorems in contact geometry etc. We are expecting new links with the low-dimensional topology
and, possibly, Physics. It seems,
however,
that what we see at the moment is just a tip of an iceberg.
The main   body of Symplectic Field Theory  and its applications is yet to be discovered.

\bigskip
\noindent{\bf Guide for an impatient reader.}
The paper consists of two parts. The first part, except Section \ref{sec:Floer}
and the end of
Section \ref{sec:orientation},
contains some  necessary   background symplectic-geometric and analytic information.
An impatient reader can try to begin reading with Section
\ref{sec:Floer},and use
the rest of the first part for  the references.
The second part begins with its own introduction
(Section \ref{sec:informal})  where we present a very rough sketch of SFT. At the end of Section
\ref{sec:informal} we describe the plan of the remainder of the paper.

\bigskip
\noindent{\bf Acknowledgements.} The authors benefited a lot from discussions
with many mathematicians, and from the ideas which they corresponded to
us. We are especially grateful to C. Abbas,  P. Biran, F. Bourgeois, K. Cieliebak,
T. Coates, T. Ekholm, K. Fukaya, E. Getzler,
M. Hutchings, E.-N.
Ionel, V.M. Kharlamov,
K. Mohnke, L. Polterovich, D. Salamon, M. Schwarz, K. Wysocki and E. Zehnder.
A  part of the paper
was written,  when  the first author visited
RIMS at Kyoto University.
He wants  to thank  RIMS  and  K. Fukaya and K. Saito,
the organizers of a special program
in Geometry and String Theory,   for the  hospitality. He also thanks
T. Tsuboi and J.-L. Brylinski for organizing   cycle of lectures on  SFT at
the    University of
Tokyo and the Pennsylvania State University. The second author is thankful to
A. Kirillov, R. Donagi, and
the Department of Mathematics of the University
of Pennsylvania  for the possibility to present   SFT in a series of lectures.
The third author acknowledges the hospitality of   FIM at the ETH Z\"urich, where   some
of the work was
carried
out. Our special thanks to N.M. Mishachev for drawing the
pictures and to J. Sabloff for
the computer verification of the formula
(\ref{eq:CP2-final}).


\section{Symplectic  and analytic setup}


\subsection{Contact preliminaries}\label{sec:prelim}
A $1$-form $\a$ on a $(2n-1)$-dimensional manifold $V$
is called {\it contact} if the
restriction of $d\a$ to  the    $(2n-2)$-dimensional tangent
distribution $\xi =
	\{\a = 0\}$ is non-degenerate (and hence symplectic).
A  codimension $1$ tangent distribution $\xi$ on $V$ is called
a {\it contact structure} if
it can be locally (and in the co-orientable case globally) defined
by  the Pfaffian equation $\a
	= 0$ for some choice of a contact form $\a$.  The pair  $(V,\xi)$   is called
a {\it contact manifold}.  According to  Frobenius' theorem the contact
condition is a condition of maximal
non-integrability of the tangent hyperplane field $\xi$. In particular, all integral
submanifolds of $\xi$ have
dimension $\le n-1$. On the other hand, $(n-1)$-dimensional integral submanifolds, called
	{\it Legendrian}, always exist in abundance.    We will be dealing in this paper
only with co-orientable, and moreover co-oriented contact structures.
Any non-coorientable contact structure can be canonically double-covered
by a coorientable one.
If a contact form $\a$ is fixed then one can associate with it the {\it Reeb vector field}
$R_\a$, which is transversal
to the contact structure $\xi=\{\alpha=0\}$.
The field $R_\a$ is uniquely determined by the equations
$R_\a\hook d\a=0;\,\a(R_\a)=1\,.$   The flow of $R_\a$ preserves the contact form $\a$.

The  $2n$-dimensional manifold $M=(T(V)/\xi)^*  \setminus V$ ,  called the
	{\it symplectization} of $(V,\xi)$, carries a natural
symplectic structure $\omega$ induced by an embedding $M\to  T^*(V)$
which assigns to each linear form $T(V) / \xi \to \R$ the
corresponding form $T(V) \to T(V)/\xi \to \R$. A choice of a contact
form $\a$ (if $\xi$ is co-orientable) defines a splitting $M=V\times(\R\setminus 0)$. As     $\xi$ is
assumed  to be co-oriented  we can
pick
the positive half  $V\times\R_+$ of  $M$, and call it symplectization
as well.  The symplectic structure $\omega$ can be written in terms of this splitting as
$d(\tau\a), \tau>0$. It will be more convenient for us, however, to use additive notation
and write $\omega$ as $d(e^t\a),\,t\in\R$, on $M=V\times\R$.
Notice that the vector field $T=\frac{\p}{\p t}$ is conformally symplectic:
we have ${\cal L}_T\omega=\omega$, as well as ${\cal L}_T
	(e^t\a)=e^t\a$,
where ${\cal L}_T$ denotes the Lie derivative along the vector
field $T$.
All the notions of contact geometry can be formulated as the
corresponding symplectic notions, invariant or equivariant with
respect to this conformal action. For instance, any contact
diffeomorphism of $V$ lifts to an equivariant symplectomorphism of
$M$;  contact vector fields on $V$ (i.e. vector fields preserving
the contact structure) are   projections of $\R$-invariant
symplectic (and automatically Hamiltonian) vector fields on $M$;
Legendrian submanifolds in $M$ correspond to cylindrical (i.e.
invariant with respect to the $\R$-action) Lagrangian submanifolds
of $M$.

Notice that the Hamiltonian vector field on $V\times\R$, defined by the Hamiltonian function
$H=e^t$ is invariant under translations $t\mapsto t+c$, and projects to the Reeb vector field
$R_\alpha$ under the projection $V\times\R\to \R$.

The symplectization of a contact manifold is an example of a
symplectic manifold with {\it cylindrical} (or rather conical)
ends. We mean by that    a possibly non-compact symplectic
manifold $(W,\omega)$ with    ends of the form
$E^+=V^+\times[0,\infty)$ and  $E^-=V^-\times(-\infty,0]$, such
that  $V^\pm$ are compact manifolds, and
$\omega|_{V^\pm}=d(e^t\alpha^\pm)$, where $\a^\pm$ are  contact
forms on $V^\pm$. In other words,  the ends  $E^\pm$ of
$(W,\omega)$ are symplectomorphic, respectively,
to the positive or negative halves of the
symplectizations of    contact manifolds $(V^\pm,\xi^\pm=\{\a^\pm=0\})$.
We will consider   the splitting of the ends and the  the contact forms
$\a^\pm$ to be parts of the structure of a symplectic manifold with cylindrical ends.
We will also call
$(W,\omega)$ a {\it directed symplectic cobordism} between
the contact
manifolds $(V^+,\xi^+)$ and $(V^-,\xi^-)$, and denote it  by $\ora{V^-V^+}$.

Sometimes we will have to consider the compact part
$W^0=W\setminus(\Int E^+\cup\Int E^-)$ of a directed symplectic
cobordism $\ora{V^-V^+}$.  If it is not clear from the context we
will refer to $W^0$   as a {\it compact}, and to $W$ as a {\it
		completed} symplectic cobordism.

Let us point out that ``symplectic cobordism" {\it is not an
equivalence relation, but rather a partial order. }
Existence of a directed
symplectic cobordism $\ora{V^-V^+}$  does not imply
the existence of a directed symplectic cobordism   $\ora{V^+V^-}$,
even if one does not fix contact forms for the contact structures $\xi^\pm$. On the other
hand,
directed
symplectic cobordisms $\ora{V_0V_1}$ and $\ora{V_1V_2}$ can be glued, in an obvious
way, into a directed symplectic cobordism  $\ora{V_0V_2}=\ora{V_0V_1}
	\circledcirc\ora{V_1V_2}$.



Contact  structures have no local invariants. Moreover, any contact form is locally
isomorphic to the
form $\alpha_0= dz-\sum\limits_1^{n-1}y_idx_i$ (Darboux' normal form).
The contact structure $\xi_0$ on $\R^{2n-1}$ given by the form $\a_0$ is called {\it
		standard}.
The standard contact structure on $S^{2n-1}$ is formed by complex tangent hyperplanes to the
unit sphere in $\C^n$. The standard contact structure on $S^{2n-1}$
is isomorphic in the complement of a point to the standard contact structure  on
$\R^{2n-1}$.
According to a theorem of J. Gray (see \cite{Gray}) contact structures
on closed
manifolds   have  the following stability property:
{\it Given a family  $\xi_t$, $t\in[0,1]$, of contact  structures on  a closed manifold
$M$, there exists
an isotopy $f_t:M\to M$,
such that $df_t(\xi_0)=\xi_t; t\in [0,1]$.}
Notice that for contact {\it forms} the analogous statement is  wrong. For
instance,
the topology of the $1$-dimensional foliation determined by the  Reeb vector field $R_\a$
is very sensitive to deformations of the contact form $\a$.

The conformal class of the symplectic form $d\a|_\xi$ depends only on
the cooriented contact structure $\xi$ and not on the
choice of the contact form $\a$. In particular, one can associate with $\xi$
an almost complex structure $J:\xi\to\xi$, compatible with $d\a$
which means that $d\alpha(X,JY); X,Y\in\xi,$ is an Hermitian metric on $\xi$.
The space of   almost complex structures $J$ with this property is contractible, and hence
the choice of $J$ is homotopically canonical.
Thus a  co-oriented contact structure  $\xi$ defines on $M$ a {\it
		stable almost complex
		structure}
$\widetilde J=\widetilde J_\xi$,
i.e. a splitting of
the tangent bundle $T(V)$ into the Whitney sum of a complex bundle of (complex) dimension
$(n-1)$ and a trivial $1$-dimensional real bundle.
The existence of a
stable almost complex
structure  is  necessary for  the existence of a contact structure on $V$. If $V$
is open (see \cite {Gro-PDR}) or ${\mathrm {dim}}\,V=3$ (see \cite{Martinet,Lutz})
this property is also sufficient for  the existence of a contact structure in the
prescribed homotopy
class. It  is still unknown
whether this condition
is sufficient for  the existence of a contact structure on a closed manifold of dimension
$>3$. However,   a positive answer  to this question is extremely unlikely.
The homotopy class of $\widetilde J_\xi$, which we denote by
$[\xi]$ and call the {\it formal }homotopy class  of $\xi$,
serves as an
invariant of $\xi$.
For an open $V$ it is a complete invariant (see \cite {Gro-PDR})   up to   homotopy
of contact structures,
but not up to a contact diffeomorphism. For closed manifolds this is known to be false
in many, but not all dimensions. The theory discussed in this
paper serves as a rich source of contact invariants, both of
closed and open contact manifolds.

\subsection{Dynamics of Reeb vector fields}\label{sec:dynamics}

Let $(V,\xi)$ be a $(2n-1)$-dimensional manifold with  a
co-orientable contact structure with a fixed contact form $\alpha$.
For a generic choice of $\a$ there are only countably many periodic trajectories
of the
vector field $R_\a$.  Moreover, these trajectories can be assumed {\it non-degenerate}
in the sense  that the linearized Poincar\'e return map $A_\g$
along any  closed
trajectory $\g$, including multiples,
has no eigenvalues equal to $1$.  Let  us denote by $\Pc=\Pc_\a$
the set of  all periodic trajectories of $R_\a$, including multiples.
\footnote{As it is explained below in Section \ref{sec:orientation}
	the orientation issues require us to exclude certain multiple periodic orbits out
	of consideration. Namely, let us recall that real eigenvalues of symplectic matrices
	different from $\pm 1$ come in pairs $\lambda,\lambda^{-1}$.
	Let $\g\in \Pc$ be a simple periodic orbit and $A_\g$ its linearized Poincar\'e return map.
	If
	the total multiplicity of   eigenvalues of $A_\g$ from the interval
	$(-1,0)$ is odd, then we   exclude from $\Pc$ all even
	multiples of $\g$.}

The reason for a such choice
is discussed in Section \ref{sec:orientation} below. We will also fix a point
$m_\gamma$ on each {\it simple} orbit from $\Pc$.
Non-degenerate trajectories can be divided into {\it odd} and {\it even} depending
on the sign of the Lefshetz number ${\mathrm {det}}  (I- A_\g)$.
Namely, we call $\g$ odd if $  {\mathrm {det}}  (I-  A_\g)<0$, and even otherwise.
The parity of  a periodic orbit $\g$  agrees   with the parity of a certain
integer grading  which is defined   if certain additional choices are made, as
it is described below.

If $H_1(V)=0$
then for each $\g\in\Pc$ we can choose  and
fix a surface $F_{\g}$ spanning
the trajectory $\g$ in $V$.
We will allow the case $H_1(V)\neq 0$,
but will require in most of the paper that the torsion part is
trivial
\footnote{ The case when $H_1(V)$ has torsion elements is
	discussed in Section \ref{sec:torsion} below.}.
In this case   we choose a basis of $H_1(V)$,
represent    it by oriented curves ${C}_1,\dots,{C}_K$, and    choose
a symplectic trivialization of the bundle $\xi|_{{C}_i}$ for each chosen curve.
We recall that the bundle $\xi$ is endowed with the symplectic
form $d\alpha$ whose   conformal class depends only on $\xi$.
For  any periodic orbit $\gamma\in\Pc$
let us choose a surface $F_\gamma$ with $[\partial F_\gamma]=
	[\gamma]-\sum n_i[{C}_i]$.
The coefficients $n_i$ are uniquely defined because of our  assumption that $H_1(V)$
is
torsion-free.



The above choices enable us to define the {\it Conley-Zehnder
		index} $\CZ(\g)$ of  $\g$ as follows. Choose a homotopically
unique trivialization of the symplectic vector bundle $(\xi,d\a)$
over each trajectory $\g\in\Pc$ which extends to $\xi|_{F_{\g}}$
(and coincides with a chosen trivialization of $\xi|_{{C}_i}$
if ${C}_i$ is not homologically trivial). The linearized flow
of $R_\a$ along $\g$ defines then a path in the group
$Sp(2n-2,\R)$ of symplectic matrices, which begins at the unit
matrix and ends at a matrix with all eigenvalues different from
$1$. The Maslov index of this path (see \cite{Arnold-Maslov,
	Robbin-Salamon}) is, by  the definition, the Conley-Zehnder index
$\CZ(\g)$ of the trajectory $\g$. See also
\cite{HoferWysockiZehnder:94d}, Section 3, for an axiomatic
description of the Conley-Zehnder index using our normalization
conventions.

Notice that by changing the spanning surfaces for the trajectories
from $\Pc$ one can change Conley-Zehnder indices by  the value of
the cohomology class $2c_1(\xi)$, where $c_1(\xi)$ is the first
Chern class of the contact bundle $\xi$. In particular, ${\mathrm
			{mod}}\,2$ indices can be defined independently of any spanning
surfaces, and even in the case when $H_1(V)\neq 0$. In fact,
$$(-1)^{\CZ(\g)}=(-1)^{n-1}\sign \left({\mathrm
			{det}}(I-A_\gamma)\right).$$






\subsection{Splitting of a symplectic manifold along \\
	a contact submanifold}
\label{sec:splitting} Let $V$ be a hypersurface of contact type,
or in a different terminology, a symplectically convex
hypersurface  in a symplectic manifold $(W,\omega)$. This means
that $\omega$ is exact, $\omega=d\beta$, near $V$, and the
restriction $\alpha=\beta|_V$ is a contact form on $V$.
Equivalently, one can say that the conformally symplectic vector
field $X$, $\omega$-dual to $\beta$, is transversal to $V$. Let us
assume that $V$ divides $W,\, W=W_+\cup W_-$, where
the notation of the parts are chosen in such a way that   $X$
serves as an inward transversal for $W_+$, and an outward
transversal for $W_-$. The manifolds $W_\pm$ can be viewed as
compact directed symplectic cobordisms such that $W_-$ has only positive
contact boundary $(V,\alpha)$, while the same contact manifold
serves as a negative boundary of $W_+$.

Let $$(W_-^\infty,\omega_-^\infty)=(W_-,\omega)\cup\left(V\times[0,\infty),d(e^t\alpha)\right)$$ and
$$(W_+^\infty,\omega_+^\infty)=\left(V\times(-\infty,0],d(e^t\alpha)\right)\cup(W_+,\omega)$$
be the  completions, and
$$(W_-^\tau,\omega_-^\tau)=(W_-,\omega)\cup\left(V\times[0,\tau],d(e^t\alpha)\right)$$ and
$$(W_+^\tau,\omega_+^\tau)=\left(V\times[ -\tau,0],d(e^t\alpha)\right)\cup(W_+^0,\omega)$$
{\it partial completions} of
$W_\pm$. Let us observe that the symplectic manifolds
$$(W_-,e^{-\tau}\omega_-^\tau),\quad (V\times [-\tau,\tau],
	d(e^t\alpha))\quad\hbox{and}\quad (W_+,e^\tau\omega_+^\tau)$$ fit
together into a symplectic manifold $(W^\tau, \omega^\tau)$, so
that $W^0=W$. Hence when $\tau\to\infty$ the deformation
$(W^\tau,\omega^\tau)$ can be viewed as a decomposition of the
symplectic manifold $W=W^0$ into the union   of two completed
symplectic cobordisms  $W^\infty_+$ and $ W^\infty_-$ . We will
write $W=W_-\circledcirc W_+$ and also
$W^\infty=W_-^\infty\circledcirc W_+^\infty$.

\begin{figure}
	\centerline{\psfig{figure=sf3.eps,height=60mm}}
	\caption{\small Splitting of a closed symplectic manifold $W$
		into two completed symplectic cobordisms $W_-^\infty$ and $W^\infty_+$}
	\label{fig:splitting}
\end{figure}
Let us give here two important examples of the above
splitting construction.

\begin{example}\label{ex:cotangent}
	{\rm Suppose $L\subset W$ is a Lagrangian submanifold.
		Its neighborhood  is symplectomorphic to a
		neighborhood of the $0$-section  in the cotangent bundle
		$T^*(L)$. The boundary $V$ of an  appropriately chosen neighborhood
		has  contact type, and thus we can apply    along $V$
		the  above splitting construction. As the result we split
		$W$ into  $W_+^\infty$ symplectomorphic
		to $W\setminus L$, and $W_-^\infty$ symplectomorphic to $T^*(L)$.
	}
\end{example}
\begin{example}\label{ex:section}
	{\rm Let $M$ be a hyperplane section of a K\"ahler manifold
		$W$, or
		more generally a symplectic hyperplane section of a
		symplectic manifold
		$W$, in the sense of Donaldson (see \cite{Donaldson}). Then $M$ has a neighborhood
		with a contact boundary $V$. The affine part
		$W\setminus M$ is a Stein manifold in the K\"ahlerian case,
		and in any case
		has a structure of   a symplectic Weinstein
		manifold $\widetilde W$ (notice that the symplectic structure
		of $\widetilde W$ does not coincide with  the induced
		symplectic structure
		on $W\setminus M$ but contains $W\setminus M$ as an
		open symplectic
		submanifold).
		The Weinstein manifold $W\setminus M$ contains
		an isotropic  deformation retract  $\Delta$. The splitting of $W$ along $V$
		produces $W^\infty_-$ symplectomorphic to
		$\widetilde W,$ and $W^\infty_+$
		symplectomorphic to $W\setminus \Delta$.
		If $\Delta$ is a smooth Lagrangian submanifold, then
		we could get the same decomposition by
		splitting along the boundary of a tubular neighborhood
		of $L$, as in Example \ref{ex:cotangent}.  }
\end{example}

\subsection{Compatible almost complex structures}\label{sec:almost}

According to M. Gromov (see \cite{Gromov-holomorphic}) an almost
complex structure $J$ is called {\it tamed} by a  symplectic form
$\omega$ if $\omega$ is positive on complex lines. If, in
addition,  one adds the calibrating condition that $\omega$ is
$J$-invariant, then $J$ is   said {\it compatible} with $\omega$.
For symplectic manifolds with cylindrical ends one needs further
compatibility conditions at infinity, as it is described below.

At each positive, or negative end $\left(V\times\R_\pm,d(e^t\alpha
	)\right)$ we require   $J$ to be invariant with respect to
translations $t\mapsto t \pm c$, $c>0$ at least for sufficiently
large $t$. We also require   the contact structure
$\xi^\pm|_{V\times t}$ to be invariant under $J$, and define
$J\frac{\partial}{\partial t}=R_\alpha$, where
$R_\alpha$ is
the Reeb vector field (see \ref{sec:dynamics} above)
of the contact form $\alpha$. In the case when
$W=V\times\R$ is the symplectization of a manifold $V$, i.e. $W$ is    a
cylindrical manifold, we additionally  require   $J$ to be globally
invariant under all translations along the second factor.

To define a compatible almost complex structure $J$ in the above
Examples \ref{ex:cotangent} and \ref{ex:section}
one needs to specify a contact form $\alpha$ on the contact manifold
$V$. In the case of the boundary of a tubular neighborhood    of a Lagrangian
submanifold $L$ a natural choice of a contact form is provided by
a  Riemannian metric on $L$. The Reeb vector field for such a
form $\alpha$ generates on $V$ the geodesic flow of the metric.

When $V$ is the boundary of a neighborhood of a hyperplane section  $M$
then there exists another good choice of a contact form. It is
a $S^1$-invariant connection form $\a$ on the principal $S^1$-bundle
$V\to M$, whose curvature equals the symplectic form $\omega|_M$.
The contact manifold $(V,\xi=\{\a=0\})$ is called the {\it
		pre-quantization} of the symplectic  manifold $(M,\omega)$.
Orbits of the  Reeb field $R_\a$ are all closed and coincide
with the fibers of the fibration, or their multiples. Notice that though
the Reeb flow in
this case looks extremely nice and simple, all its  periodic orbits are
highly degenerate, see Section \ref{sec:Bott} below.
Notice that  the symplectization $W$  of $V$
can be viewed  as the total space of a complex  line bundle
$L$ associated with
the $S^1$-fibration $V\to M$ with the zero-section removed.
It is possible
and convenient to choose
$J$  compatible with the structure of this bundle,
and in such a way that the projection   $W\to M$
becomes holomorphic with respect to a certain almost
complex structure $J_M$ on $M$
compatible with $\omega$.


Let us describe now what the symplectic splitting
construction from  Section \ref{sec:splitting}
looks like from the point of view of  a compatible almost
complex structure.

First, we assume that the original almost complex structure
$J$ on $W$ is chosen in such a way
that     the contact structure $\xi=\{\alpha=0\}$ on $V$ consists
of complex tangencies to $V$, and that $JX=R_\alpha$, where
$X$ is a conformally symplectic vector field, $\omega$-dual
to $\alpha$, and $R_\alpha$ is the Reeb vector field of $\alpha$.
Next we define an almost complex structure
$J^\tau$ on $W^\tau=W_-\cup V\times[-\tau,\tau]\cup W_+$ by setting
$J^\tau|_{W_\pm}=J$ and requiring  $J^\tau$ to be independent
of $t\in[-\tau,\tau]$ on  $V\times[-\tau,\tau]$.
When $\tau\to\infty$  the almost complex structure
$J_-^\tau$ on
$W_-^\tau=W_- \cup V\times[-\tau,\tau]$   converges
to an almost complex
structure $ J^\infty_-$ on $W^\infty_- $ compatible   with
$\omega^\infty_-$, and  $J_+^\tau$ on
$W_+^\tau=V\times[-\tau,\tau]\cup W_+$   converges
to an almost complex
structure $ J^\infty_+$ on $W^\infty_+$ compatible   with
$\omega^\infty_+$.

\subsection{Holomorphic curves in symplectic
	cobordisms}\label{sec:holomorphic}


Let $(V,\alpha)$ be a contact manifold with a fixed contact form
and $(W=V\times\R,\omega=d(e^t\alpha))$ its symplectization. Let
us denote by $\pi_\R$ and $\pi_V$ the projections $W\to\R$ and $W\to
	V$, respectively. For a map $f:X\to W$ we write $ f_\R$ and $f_V$
instead of $\pi_\R\circ f$ and $\pi_V\circ f$.

Notice that given a trajectory $\gamma$ of the Reeb field
$R_\a$,
the cylinder $\R\times\gamma\subset W$ is a $J$-holomorphic curve.
Let us also observe that
\begin{proposition}\label{prop:positivity}
	For a $J$-holomorphic curve  $C\subset W$
	the restriction $d\a|_C$ is non-negative, and if $d\a|_C\equiv 0$
	then $C$ is a (part of a) cylinder $\R\times\gamma$ over a
	trajectory $\gamma$ of the Reeb field $R_\a$.
\end{proposition}

Given a $J$-holomorphic map $f$ of a punctured disk $D^2\setminus
	0\to W$ we say that  the map $f$ is {\it asymptotically
		cylindrical } over a periodic orbit $\g$ of the Reeb field
$R_\a$ at $+\infty$ (resp. at $-\infty$) if
$\mathop{\lim}\limits_{r\to 0} f_\R(re^{i\theta})=+\infty$ (resp.
$=-\infty$), and $\mathop{\lim}\limits_{r\to
		0}f_V(re^{i\theta})=\bar f(\theta)$, where the map $\bar
	f:[0,2\pi]\to V$ parameterizes the trajectory $\gamma$.

\bigskip

The almost complex manifold $(W,J)$ is bad from the point of view of
the theory of
holomorphic curves: it has a {\it pseudo-concave} end
$V\times(-\infty,0)$, or using Gromov's terminology its geometry
at this end is not bounded. However, it was shown in
\cite{Hofer-Weinstein} that   Gromov compactness theorem can be
modified to accommodate this situation, see Theorems
\ref{thm:comp1} and \ref{thm:comp2}
below. We will mention in this
section only the following fact related to compactness, which motivates the usage
of holomorphic curves asymptotically cylindrical over orbits from
$\Pc_\a$.
\begin{proposition}
	Suppose that all periodic orbits of the Reeb field $R_\alpha$ are
	non-degenerate.
	Let  $C$ be  a non-compact Riemann surface  without boundary and $f:C\to W$
	a proper $J$-holomorphic curve. Suppose that there
	exists a constant $K>0$ such that
	$\int\limits_{C}f^*d\a  < K$.
	Then
	$C$ is conformally equivalent to a compact Riemann surface $S_g$
	of genus $g$ with $s^++s^-$ punctures
	$$ x^+_1,\dots,
		x^+_{s^+},x^-_1\dots,x^-_{s^-}\in S_g,$$
	such that near the punctures ${\bx^+}=(x^+_1,\dots,x^+_{s^+})$
	the map
	$f$ is asymptotically cylindrical over periodic orbits
	${\Gamma^+}=\{\g^+_1,\dots,\g^+_{s^+}\}$ at $+\infty$, and near
	the punctures ${\bx^-}=\{x^-_1,\dots,x^-_{s^-}\}$ the map
	$f$ is asymptotically cylindrical over periodic orbits
	${\Gamma^-}=\{\g^-_1,\dots,\g^-_{s^-}\}$ at $-\infty$.
\end{proposition}


Thus holomorphic maps of punctured Riemann surfaces,
asymptotically cylindrical over periodic
orbits of the Reeb vector field $R_\alpha$, form a natural class of
holomorphic curves to consider in symplectizations
as well as  more general symplectic manifolds with cylindrical ends.  We
will define now moduli spaces of such curves.

Let $W =\ora{V^-V^+}$ be a (completed) directed cobordism,
$\alpha^\pm$    corresponding contact forms on $V^-$ and $V^+$,
$\Pc^\pm$  the sets of all
periodic orbits (including multiple ones) of the Reeb vector
fields
$R_{\alpha^\pm}$. We assume that $\alpha^\pm$ satisfies
the genericity assumptions from Section \ref{sec:dynamics}.
Choose a compatible almost complex  structure  $J$   on $W$.
Let $\Gamma^\pm$ be   ordered sets of trajectories from
$\Pc^\pm$ of cardinality $s^\pm$.
We also assume that every {\it simple} periodic orbit $\gamma$ from
$\Pc^\pm$ comes with a fixed marker
$m_\gamma\in\g$.

Let $S=S_g$ be a compact Riemann surface of genus $g$ with a conformal
structure $j$, with $s^+$ punctures $\bx^+=\{x^+_1,\dots,x^+_{s^+}\}$, called
positive,
$s^-$ punctures $\bx^-=\{x^-_1,\dots,x^-_{s^-}\}$, called negative, and
$r$ marked points $\by=\{y_1,\dots,y_r\}$.
We will also   fix an {\it asymptotic marker} at each
puncture. We mean by that  a ray originating at each
puncture.  Alternatively, if one
takes the cylinder $S^1\times[0,\infty)$ as a conformal model of
the punctured disk $D^2\setminus 0$ then an asymptotic marker
can be viewed as a point on the circle at infinity.
If a holomorphic map $f:D^2\setminus 0\to V^\pm\times\R_\pm$ is asymptotically
cylindrical over a periodic orbit $\g$,  we say that
a marker $\mu=\{\theta=\theta_0\}$
is mapped by $f$ to the
marker $m_\gamma\in\overline\gamma$, where $\overline\g$ is the simple
orbit which  underlines $\g$, if $\mathop{\lim}\limits_{r\to
		0}f_{V^\pm}(re^{i\theta_0})=m_\g$.
Let us recall (see Section \ref{sec:dynamics} above) that we
provided each periodic orbit from $\Pc^\pm$ with a ``capping"
surface. This surface bounds $\g\in\Pc^\pm$ in $V_\pm$ if $\g$ is
homologically trivial, or realizes a homology    between $\g$ and
the corresponding linear combination of  basic curves
${C}_i^\pm$. We will  continue to rule out torsion elements in
the first homology
(see the discussion of torsion in Section \ref{sec:torsion} below)   and choose
curves ${C}_k\subset W$ which represent a basis of
the image $H_1(V^-\cup V^+)\to H(W)$ and for each curve
${C}^\pm_i$ fix a surface $G^\pm_i$ which realizes a homology
in $W$
between ${C}^\pm_i$ and the corresponding linear combination of
curves ${C}_k$.
All the choices enable us to associate with a  relative
homology class $A'\in H_2(W,\Gamma^-\cup\Gamma^+)$,
$\Gamma^\pm\subset\Pc^\pm$,
an absolute integral  class
$A\in H_2(W)$, which we will view as an element of $H_2(W;\C)$.

Let us denote by $\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ the moduli
space of $(j,J)$-holomorphic curves
$S_g\setminus(\bx^-\cup\bx^+)\to W$ with $r$ marked points, which
are asymptotically cylindrical over the periodic orbit $\g^+_i$
from $\Gamma^+$ at    the positive end at the puncture $x^+_i$,
and asymptotically cylindrical over the periodic orbit $\g^-_i$
from $\Gamma^-$ at    the negative end  at the puncture $x^-_i$,
and which send asymptotic markers to the
markers on the
corresponding periodic orbits. The curves from
$\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ are additionally required to
satisfy a stability condition, discussed in the next section. We
write $\Mc^A_{g}(\Gamma^-,\Gamma^+;W,J)$ instead of
$\Mc^A_{g,0}(\Gamma^-,\Gamma^+;W,J)$, and
$\Mc^A_{g,r}(\Gamma^-,\Gamma^+)$ instead of
$\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ if   it is clear from the
context which target almost complex  manifold $(W,J)$ is
considered.

Notice, that we are not fixing $j$, and the configurations of
punctures, marked points  or asymptotic markers.
Two maps are called equivalent if they differ by a conformal map
$S_g\to S_g$ which preserves all punctures, marked points and
asymptotic markers.
When the manifold $W=V\times\R$ is cylindrical,
and hence the almost complex structure      $J$ is invariant under
translations along the second factor, then
all the moduli spaces $\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ inherit the $\R$-action.
We will denote the quotient moduli space  by
$\Mc^{A}_{g,r}(\Gamma^-,\Gamma^+;W,J)/\R$, and by
$\Mc^A_{g,r,s^-,s^+}(W,J)$ the union $\bigcup
	\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ taken over
all sets of periodic orbits $\Gamma^\pm\subset\Pc^\pm$   with the
prescribed numbers $s^\pm$ of elements.
We will also need to consider the moduli space of disconnected
curves of  Euler characteristic $2-2g$, denoted by
$\wt{\Mc}_{g,r}^A(\Gamma^-,\Gamma^+)$.








\subsection{Compactification of the moduli spaces
	$\Mc_{g,r}^A(\Gamma^-,\Gamma^+)$}\label{sec:compact}

To describe the compactification we need an appropriate notion of
a {\it stable holomorphic curve}.

Given a completed symplectic cobordism $W=\ora{V^-V^+}$ we first
define a {\it   stable curve of height $1$}, or a {\it $1$-story stable curve }
as a ``usual" stable curve in a sense of M. Kontsevich (see \cite{Kontsevich-CP2}),
i.e. a collection of of holomorphic curves $h_i:S_i\to
	W$  from  moduli spaces
$\Mc_{g_i,r}^A(\Gamma^-_i,\Gamma^+_i)$ for various genera $g_i$
which realize  homology classes
$A_i$, and collections of periodic orbits $\Gamma_i^\pm$, such
that certain pairs of marked points  (called special) on these
curves are required to be mapped to one point in $W$. The
stability condition means the absence of infinitesimal symmetries
of the moduli space. Let us point out, however, that in the case
when
$W$ is a cylindrical cobordism, and in particular the almost complex structure
$J$ is translationally invariant, we would need to consider along
with the above moduli space its quotient under the $\R$-action.
The stability for this new moduli space still means an absence of
infinitesimal deformations, but it translates into an additional restriction
on holomorphic curves.
Namely, in the first case the stability
condition means that each constant curve has, after   removal
of the marked points, a negative Euler characteristic. In the second
case it additionally requires  that when {\it all} connected
components of the curve are straight cylinders $\g\times\R,
	\g\in\Pc$ then  at least one of these cylinders should have a
marked point.

One can define an arithmetic genus $g$ of the
resulting curve, the total sets $\bx^\pm$ and $\by$ (equal to the
union of sets $\bx_i^\pm$ and $\by_i$ for the individual curves of
the collection), and the total  absolute  homology class  $A\in
	H_2(W )$ (see the discussion in Section \ref{sec:holomorphic}
above), realized by the union of all curves of the collection.

Moduli of stable curves of height $1$, denoted by
${}_1\Mc_{g,r}^A(\Gamma^-,\Gamma^+)$, form  a part of the
compactification of the moduli space
$\Mc_{g,r}^A(\Gamma^-,\Gamma^+)$.
However, unlike the case of  closed symplectic manifolds, the
stable curves of height $1$ are not   sufficient  to describe  the
compactification of the moduli space $\Mc_{g,r}^A(\Gamma^-,\Gamma^+)$.

A finite sequence  $(W_1,\dots, W_k)$ of symplectic manifolds with
cylindrical ends is called a {\it chain} if  the positive end of
$W_i$ matches with the negative end of $W_{i+1}$, $i=1,\dots,k-1$.
This means that all data, assigned to an end, i.e. a contact
form, marking of periodic orbits, and an almost complex structure,
are the same for the matching ends.

Let us first suppose that
none of the cobordisms  which form a chain $(W_1,\dots, W_k)$
is cylindrical.    Then
a {\it stable curve of height
		$k$}, or a $k$-story stable curve  in the
chain $(W_1,\dots, W_k)$ is a $k$-tuple
$f=(f_1,\dots,f_k)$, where $f_{
			i } \in
	{}_1\wt{\Mc}_{g_i,r_i}^{A_i}(\Gamma_{i}^-,\Gamma_{i}^+;W_i,J_i)$,
such that the  boundary data  of the curve $f_i$ at the positive end
match  the boundary data of $f_{i+1}$ on the negative one.
One
also needs to impose the following additional equivalence relation regarding
the asymptotic markers on multiple orbits.
Suppose that $\g $ is
a $k$-multiple periodic orbit, so that the holomorphic curve $f_i$ is
asymptotically cylindrical over $\g$ at the positive end at a puncture $x^+ $, and
$f_{i+1}$ is asymptotically cylindrical over $\g$ at  the negative end  at a puncture $x^-$.
There are $k$ possible  positions $\mu^+_1,\dots,\mu^+_k$
and $\mu^-_1,\dots,\mu^-_k$
of   asymptotic  markers at  each of the punctures $x^\pm$.
We assume here that the markers are numbered cyclically
with respect to the orientation defined by the Reeb vector field
at each of the punctures, and that the markers $\mu^+_1$ and
$\mu^-_1$ are chosen for the curves $f_i$ and
$f_{i+1}$.         Then we identify
$f=\{\dots,f_i,     f_{i+1},\dots\}$
with $(k-1)$ other stable curves of height $k$
obtained by simultaneous cyclic  shift of
the asymptotic markers at the punctures $x^+$ and $x^-$.

The curves $f_i$, which form  a $k$-story stable curve $f=(f_1,\dots,f_k)$ are called
	{\it floors},  or {\it levels} of $f$.
\medskip

If some of the cobordisms which form the chain   $(W_1,\dots, W_k)$, say $W_{i_1},\dots,W_{i_l}$,
are cylindrical  then we will assume that the corresponding floors
of a $k$-story curve in $W=(W_1,\dots,W_k)$ are defined {\it only
		up to translation.} In other words, if $W_i$ is cylindrical for some $i=1,\dots, k$
(i.e. $W_i=V_i\times\R$ and $J_i$ is translationally invariant) then
$f_i$ should be viewed as an element of
${}_1\wt{\Mc}_{g_i,r_i}^{A_i}(\Gamma_{i}^-,\Gamma_{i}^+;W_i,J_i)/\R$,
rather than ${}_1\wt{\Mc}_{g_i,r_i}^{A_i}(\Gamma_{i}^-,\Gamma_{i}^+;W_i,J_i)$.
It will be convenient for us, however, to introduce the following convention.
When speaking about stable holomorphic  curves  in chains which contain
cylindrical cobordisms, we will treat the corresponding floors as curves representing
their equivalence classes from
${}_1\wt{\Mc}_{g_i,r_i}^{A_i}(\Gamma_{i}^-,\Gamma_{i}^+;W_i,J_i)/\R$. Any statement about such
curves should be understood in the sense, that {\it there exist} representatives for
which the statement is true.


\bigskip
Let us define now the meaning of convergence of a
sequence of holomorphic curves to a stable curve of height $l$.
For $l=1$ this is   Gromov's standard  definition (see \cite{Gromov-holomorphic}). Namely, with
each stable curve
$h=\{S_i,h_i\}\in {}_1\Mc_{g,r}^A(\Gamma^-,\Gamma^+)$   of height $1$ we associate a nodal
surface $\widehat S$
obtained by identifying special pairs of marked points on $\coprod S_i$.  The maps $h_i$ fits together
to a continuous map $\widehat S\to W$ for which we will keep the notation
$h$.
Let us  consider
also a smooth surface $S$ obtained by smoothing the nodes
of $\widehat S$. There exist a partitioning of  $S$
by circles
into  open parts   diffeomorphic to  surfaces $S_i$    with removed special points, and a map
$g:S\to\widehat S$  which is a diffeomorphism from the complement $\tilde S$
of the dividing circles
in $S$ to the complement of  the double points
in $\hat  S$, and  which collapses the partitioning circles to
double points.
A sequence of holomorphic  $\varphi_l:(S,j_l)\to (W,J)$ is said to converge
to a stable curve
$h$
if
the sequence $\varphi_l|_{\tilde S}$ converges
to $h_i\circ g|_{\tilde S}$, and
$j_l$ converges to $g^*(j)$  uniformly on compact sets,
where $j$ is the conformal structure on the stable curve.
Of course, we also require  convergence of marked points and asymptotic markers.
A sequence of stable curves
$h^j=\{S^j_i,h^j_i\}_{i=1,\dots,k}\in {}_1\Mc_{g,r}^A(\Gamma^-,\Gamma^+), j=1,\dots,$  is said to converge
to a stable curve $h$, if $h$ can be presented as a collection
of stable curves $h_i$, $i=1,\dots, k$, such that  $h^j_i$ converges to $  h_i$ in the above
sense for each $i=1,\dots,k$.
\medskip

The convergence of
a sequence of smooth curves to a stable curve of height  $l>1$  is understood
in a similar sense.
Let us  assume here     for simplicity that $l=2$ and that the   floors
$f_{1} :     S_1\to W_1$ and $f_2 :
	S_2\to W_2$  of  a stable curve $f$ in a chain $(W_1,W_2)$
are smooth, i.e.
have no  special marked points.
As in the height $1$ case let us consider
\begin{description}
	\item{-} the smooth surface $S$
	      partitioned  according to the combinatorics of our stable curve
	      by circles into two open  (possibly disconnected) parts $U_1$ and $U_2$  diffeomorphic to
	      the punctured surfaces $S_1$
	      and $S_2$,
	\item{-} the surface
	      $\hat S$ with double points obtained by collapsing
	      these circles to points, and
	\item{-} the projection $g:S\to\hat S$.
\end{description}
Let $(W,J)=(W_1,J_1)\circledcirc (W_2,J_2)$
be the composition of (completed) directed symplectic    cobordisms $W_1$ and $W_2$
with compatible almost complex structures $J_1$ and $J_2$. This means that
\begin{description}
	\item{-}    there exists a contact    hypersurface $V\subset W$ which splits
	      $W$ into two cobordisms $W^0_1$ and $W^0_2$;
	\item{-} $W_1=W^0_1\cup V\times[0,\infty),\;W_2=V\times(-\infty,0]\cup W^0_2$;
	\item{-} $J|_{W^0_j}=J_1|_{W^0_j},\;\; j=1,2$;
	\item{-} $J_1$ and $J_2$ are translationally invariant at the ends
	      $V\times[0,\infty)$ and $(-\infty,0]\times V$.
\end{description}

We denote  by
$W^k $, $k=1,\dots,$ the quotient space of the disjoint union
$$W^0_1\coprod V\times[-k,k]\coprod W^0_2$$ obtained by identifying $V=\partial W^0_1$
with  and $V\times( -k)$ and $V=\partial W^0_2$
with  and $V\times k$,  and extend the   almost
complex  structures $J_1|_{W^0_1}$ and     $J_2|_{W^0_2}$
to the unique almost complex structure  $J^k$ on $W^k$ which is translationally
invariant on $V\times[-k,k]$. We also consider $W^k_1$ obtained
by gluing $W^0_1$ and $V\times[0,k]$ along $V=\partial
	S^0_1=V\times 0$,
and $W^k_2$ glued in a similar way from $V\times[-k,0]$ and $W^0_2$.
We have $W_j=\bigcup\limits_{k=0}^\infty
	W^k_j$, $j=1,2$. On the other hand, $W^k_1$ and $W^k_2$
can be viewed as submanifolds
of $W^k$.


\begin{definition}\label{def:convergence}
	{\rm
		Suppose that we are  given a sequence $j^k$
		of conformal structures on the surface $S$
		and a sequence  of  $1$-story $(j^k,J^k)$-holomorphic curves
		$f^k:S\to W^k$.
		We say that this sequence converges to a stable curve $f=(f_1,
			f_2)$
		of height   $2$
		in $(W_1,W_2)$ if     there     exist two sequences of domains
		$U_1^1\subset\dots \subset U_1^i\subset \dots\subset U_1$
		and $U_2^1\subset\dots \subset U_2^i\subset \dots\subset U_2$,
		such that
		\begin{description}
			\item{} $\bigcup\limits_{k=1}^\infty U^k_i=U_i,\; i=1,2$ ;
			\item{} $f^k(U^k_i)\subset W^k_i$ for $i=1,2,\;\;k=1,\dots$;
			\item{}  for $i=1,2$  the  holomorphic curves
			      $f^k|_{U^k_i}$ converges to $f_i\circ g: U_i\to W_i$,
			      and the conformal structures   $j^k|_{U^k_1}$ converge to $g^*{j_i} $
			      when $k\to\infty$
			      uniformly on
			      compact sets.
			      As in the case of stable curves of level $1$
			      we also require
			      convergence of marked points and asymptotic markers.
		\end{description} }
\end{definition}
Let us emphasize that  when some of the cobordisms  are cylindrical
then according to  the convention which we introduced above
one is allowed to compose  the corresponding curves  with translations to satisfy
the above definition.

\bigskip
Notice that if the  cobordism $W_2$ is cylindrical, i.e.
$W_2=V\times\R$ and $J_2$ is translationally invariant,
then $W_1\circledcirc W_2$ can be identified with $W_1$, and thus one can talk about
convergence of a sequence of curves
$f^k\in {}_1{\Mc}_{g,r}^{A}(\Gamma^-,\Gamma^+;W_,J_1)$
(where the almost complex structure
$J_1$ is fixed!)
to   a $2$-story curve $(f_1,f_2)$, where
$f_1 \in{}_1\wt{\Mc}_{g_1,r_1}^{A_1}(\Gamma^-,\Gamma;W_1,J_1)$,
$f_2\in{}_1\wt{\Mc}_{g_2,r_2}^{A_2}(\Gamma,\wt\Gamma^+;V\times\R,J_2)/\R$,
$g=g_1+g_2,\,r=r_1+r_2, A=A_1+A_2$, and $J_2$ is translationally invariant.
It is important to stress the point that the curve   $f_2$ is defined only up to translation.



\begin{theorem}\label{thm:comp1}
	Let $f_k\in {}_1\Mc_g^A(\Gamma^-,\Gamma^+)$, $k=1,\dots, $ be a
	sequence of stable holomorphic curves in
	a (complete)  directed symplectic cobordism $W$.
	Then there exists a chain of  directed symplectic
	cobordisms $$A_1,\dots, A_a,W,B_1,\dots,B_b,$$ where all
	cobordisms $A_i$ and $B_i$ are cylindrical,
	and a stable curve $f_\infty$ of height $a+b+1$ in this chain
	such that a subsequence of $ \{f_i\}$  converges to
	$f_\infty$. {\rm See Fig. \ref{fig:split1}}.
\end{theorem}

\begin{figure}
	\centerline{\psfig{figure=sf2.eps,height=100mm}}
	\caption{\small A possible splitting of a sequence of holomorphic curves in
		a completed symplectic cobordism}
	\label{fig:split1}
\end{figure}
\begin{figure}
	\centerline{\psfig{figure=sf4.eps,height=80mm}} \caption{\small A
		possible splitting of a sequence of holomorphic curve   when
		$J_k\to J_\infty$ } \label{fig:split2}
\end{figure}
\begin{theorem}\label{thm:comp2}
	Let $W$ be a completed directed symplectic cobordism,
	$V\subset W$ a contact hypersurface, and $J_k$    a
	sequence of compatible almost complex structures on $W$
	which realizes the splitting of $W$ along $V$ into two
	directed symplectic cobordisms $W_-^\infty$ and
	$W_+^\infty$
	{\rm (see Section \ref{sec:almost} above)}.
	Let $f_k$ be a sequence of stable $J_k$-holomorphic curves
	from $ {}_1\Mc_g^A(\Gamma^-,\Gamma^+;W,J_k)$. Then there exists a
	chain of directed symplectic cobordisms
	$$A_1,\dots,A_a,W_-,B_1,\dots,B_b,W_+,C_1,\dots,C_c$$  where
	all cobordisms $A_i, B_j, C_l$ are cylindrical, such that a
	subsequence of
	$\{f_i\}$   converges to a stable curve of height $a+b+c+2$
	in
	the chain $$A_1,\dots,A_a,W_-,B_1,\dots,B_b,W_+, C_1,\dots,
		C_c.$$ {\rm See Fig. \ref{fig:split2}. The reader
			may consult \cite{HoferWysockiZehnder:99}
			for the analysis of splitting $\C P^2$
			along the boundary of a tubular
			neighborhood
			of $\C P^1\subset\C P^2$.}
\end{theorem}

The definition of convergence can be extended in an obvious way to a sequences of stable curves
of height $l>1$. Namely, we say that a sequence of $l$-story curves
$f^k=(f^k_1,\dots,f^k_l)$, $k=1,\dots,\infty$, in a chain $(W_1,\dots,W_l)$ converge to a stable $L$-story,
$L=m_1+\dots+m_l$, curve  $f=(f_{11},\dots,,f_{1m_1},\dots,f_{l_1}\dots f_{lm_l}) $ in a chain
$$(W_{11},\dots,W_{1m_1},\dots,W_{l_1}\dots W_{lm_l})$$
if for each $i=1,\dots,l$  the cobordism $W_i$ splits into the composition
$$W_i=W_{i1}\circledcirc\dots\circledcirc W_{im_i}$$
and the sequence $f^k_i$, $k=1,\dots,\infty$, of stable curves of height $1$ converges
to the $m_i$-story curve $f_i=(f_{i1},\dots,f_{im_i})$ in the chain $(W_{i1},\dots, W_{im_i})$ in the sense of Definition
\ref{def:convergence}.
\bigskip

It is important to combine Theorems \ref{thm:comp1} and
\ref{thm:comp2} with the following
observation which is a
corollary of  Stokes' theorem combined with Proposition \ref{prop:positivity}.


\begin{proposition}\label{prop:one-end}
	A holomorphic curve in an exact
	directed symplectic cobordism
	(and in particular in a cylindrical one)
	must have at least one positive puncture.
\end{proposition}

In particular,  we have
\begin{corollary}\label{cor:pos-puncture}
	Let $f^n\in {\Mc}_0(W,J)$  be a sequence of rational holomorphic curves with  one positive, and possibly
	several negative punctures.
	Suppose that the sequence  converges to a stable
	curve $$F=\{g_1,\dots,g_a,f,h_1,\dots,h_b\}$$ of height $a+b+1$ in a chain
	$$A_1,\dots,A_a,W,B_1,\dots,B_b.$$ Then the  $W$-component   $f\in {\Mc}_0(W,J)$ of the stable curve
	$F$ has precisely
	one positive puncture as well.
\end{corollary}


\subsection{Dimension of the moduli spaces
$\Mc^A_{g,r}(\Gamma^-,\Gamma^+)$}
One has the following index formula for the corresponding
$\bar\partial$-problem which compute the dimension
of the moduli space $\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$ for a {\it
		generic}
choice of $J$.
\begin{proposition}

	\begin{equation}\label{eq:dim}
		\begin{split}
			 & {\mathrm {dim}}\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)
			=\sum\limits_1^{s^+}\CZ(\gamma^+_i)-
			\sum\limits_1^{s^-}\CZ(\gamma^-_k)                   \\
			 & +  (n-3)(2-2g-s^+-s^-)+2c_1(A)+2r,                \\
		\end{split}
	\end{equation}
	where
	$s^\pm$ are the cardinalities of the sets $\Gamma^\pm$, and $c_1\in
		H^2(W)$ is the first Chern class of the almost complex manifold
	$(W,J)$
\end{proposition}

Making the moduli spaces non-singular by picking
generic $J$ is needed for the purpose of curve counting but
does not always work properly. It is therefore crucial
that the moduli spaces of stable $J$-holomorphic
curves are non-singular {\em virtually}. This means that for {\em
		any} $J$ the moduli spaces, being generally speaking singular, can
be equipped with some canonical additional structure that make
them {\em function in the theory the same way as if they were
		orbifolds with boundary and had the dimension prescribed by the
		Fredholm index}. In particular, the moduli spaces come equipped
with rational fundamental cycles relative to the boundary (called
	{\em virtual fundamental cycles}) which admit pairing with
suitable de Rham cochains and allow us to use the Stokes
integration formula.



Technically the virtual smoothness is achieved by a
finite-dimensional reduction of the following picture: a singular
moduli space is the zero locus of a section defined by the
Cauchy-Riemann operator in a suitable orbi-bundle over a moduli
orbifold of stable $C^{\infty}$-maps. More general {\em virtual
		transverality} properties for families of
$J$'s also hold true
(cf. \cite{Fukaya-Ono, Fukaya-Ono2, Liu-Tian, Li-Tian, Ruan-virtual, Siebert, McDuff} at al.).
We
are reluctant to provide in this quite informal exposition
precise
formulations   because of numerous not entirely innocent
subtleties this would entail.  Fortunately, what we intend to say in the rest of this
paper does not depend much on the details we are omitting.


\bigskip


As it was explained in Section \ref{sec:compact} above the moduli
space $\Mc^A_{g,r}(\Gamma^-,\Gamma^+;W,J)$  can be compactified by
adding strata which consist of stable holomorphic curves of
different height.  This compactification looks quite similar to
the Gromov-Kontsevich compactification  of   moduli spaces of
holomorphic curves in a closed symplectic manifold  with a
compatible almost complex structure.
There is, however, a major difference. In the case of a closed
manifold   all the strata   which one needs to add to compactify the moduli space
of smooth holomorphic curves have (modulo virtual cycle complications) codimension
$\geq 2$. On the other hand  in our case  the  codimension one strata are
present {\it generically}. Thus in this case the boundary of the compactified moduli space,
rather than the moduli space  itself, carries  the fundamental
cycle.

In particular, this boundary
is tiled by codimension one
strata represented by stable curves $(f_-,f_+)$ of {\it height two}.
Each such a stratum can be described by the constraint matching
the positive ends of $f_-$ with the negative ends of $f_+$ in the
Cartesian product of the moduli spaces $\Mc_{\pm}$ corresponding to   the
curves
$f_{\pm}$  separately.
Proposition \ref{prop:boundary} below describes these top-dimensional boundary
strata more precisely
in two important for our purposes situations.
Let us point out that  \ref{prop:boundary} literally holds only under certain
transversality conditions.
Otherwise it should be understood only virtually.


\begin{proposition}\label{prop:boundary}
	\begin{description}
		\item{1.} Let $(W=V\times\R,J)$ be a cylindrical cobordism.
		      Then any
		      top-dimensional stratum  $\cS$ on the boundary  of the compactified moduli space
		      $\overline{\Mc^A_{g,r}(\Gamma^-, \Gamma^+;W,J)/\R}$ consists
		      of
		      stable curves  $(f_-,f_+)$   of height   two,
		      $f_\pm\in\Mc_\pm/\R$, where
		      $$\Mc_-=\wt\Mc^{A_-}_{g_-,r_-}(\Gamma^-,\Gamma;W,J)/\R ,
			      \quad \Mc_+=\wt\Mc^{A_+}_{g_+,r_+}(\Gamma,\Gamma^+;W,J)/\R ,$$
		      $g=g_-+g_+, \;r=r_-+r_+,\;A=A_-+A_+$,   $\Gamma=\{\g_1,\dots,\g_l\}\subset\Pc$.

		      All  but one
		      connected components  of  each of the curves $f_-$ and $f_+$
		      are trivial cylinders
		      (i.e.  have the form   $\g\times\R, \g\in\Pc$) without
		      marked points.
		\item{2.} Let $(W=\ora{V^-V^+},J)$  be any    cobordism,
		      and $(W_\pm,J_\pm)= (V^\pm\times\R,J_\pm)$
		      be the cylindrical cobordisms associated to its
		      boundary.
		      Then any  top-dimensional strata $\cS$ on the boundary  of the
		      compactified moduli space
		      $\overline{\Mc^A_{g,r}( \Gamma^-, \Gamma^+;W,J) }$ consists
		      of
		      stable curves  $(f_-,f_+)$   of height   two,
		      $f_\pm\in\Mc_\pm$, where either
		      $$\Mc_-=\wt\Mc^{A_-}_{g_-,r_-}(\Gamma^-,\Gamma;W_-,J_-)/\R,\;
			      \Mc_+=\wt\Mc^{A_+}_{ g_+,r_+}(\Gamma,\Gamma^+;W,J)\;\hbox{
				      and}\;
			      \Gamma\subset\Pc^-,$$ or
		      $$\Mc_+=\wt\Mc^{A_+}_{g_-,r_-}(\Gamma ,\Gamma^+;W_+,J_+)/\R,\;
			      \Mc_-=\wt\Mc^{A_-}_{g_-,r_-}(\Gamma^-,\Gamma;W,J ) \;\hbox{
				      and}\;
			      \Gamma\subset\Pc^+.$$
		      In both cases  we have  $$g=g_-+g_+,
			      \;r=r_-+r_+,\;\;\hbox{and}\;\;A=A_-+A_+.$$
		      The part of the stable curve
		      $(f_-,f_+)$ which is  contained in in  $W_\pm$ must have
		      precisely one non-cylindrical connected component, while there
		      are no restrictions on the number and the character of connected components or the
		      other part of the stable curve.
		\item{~~} In both cases the stratum
		      $\cS=\cS(\Gamma,g_-|g_+,r_-|r_+,A_-|A_+)$ is
		      diffeomorphic to a $\kappa$-multiple cover of the product
		      $\Mc_-\times\Mc_+$, where the multiplicity $\kappa$ is
		      determined by the multiplicities of periodic orbits from
		      $\Gamma$.
	\end{description}
\end{proposition}

Proposition \ref{prop:boundary} is not quite sufficient for our
purposes, as we also needs to know the structure of the boundary
of   moduli spaces of $1$-parametric families of holomorphic
curves. However, we are not  formulating the corresponding
statement in this paper, because it  is   intertwined  in a much more serious way
with
the virtual cycle techniques and terminology. An algebraic description
of this boundary is given in
Theorem
\ref{thm:SFT-chain}
below.



\bigskip


Let us consider some special cases of the formula (\ref{eq:dim}).
Suppose, for instance, that $W$ is the cotangent bundle of a manifold
$L$. Then $W$ is a symplectic manifold which has  only a positive
cylindrical end.
If $L$ is orientable then there is a canonical way to
define Conley-Zehnder indices. Namely, one takes any
trivialization along orbits, which is  tangent to vertical
Lagrangian fibers. The resulting index is independent of a
particular  trivialization. For this trivialization, and a choice
of a contact form corresponding to  a metric on $L$ we have
\begin{proposition}
	Periodic orbits of the Reeb flow are lifts of closed geodesics,
	and if $L$ is orientable their Conley-Zehnder indices   are equal
	to Morse indices of the corresponding geodesics and we have
	$${\mathrm {dim}}\Mc_g^A( \Gamma^+)= \sum\limits_i\Morse(\g^+_i)+ (n-3)(2-2g-s^+) .$$
\end{proposition}\label{prop:Morse-Zehnder}
Notice that for a metric on  $L$ of  non-positive curvature we have  $s^+>1$, because in this case
there are no
contractible geodesics. Moreover, if the metric has negative curvature then all geodesics
have  Morse
indices equal to $0$.  Hence, we get
\begin{corollary}\label{cor:isolated} In  the cotangent bundle of a  negatively curved
	manifold  of dimension $>2$ there  could be only isolated
	holomorphic curves. If, in addition, $n\neq 3$ then these curves are spheres
	with two positive punctures. Each of these curves is asymptotically
	cylindrical at punctures over   lifts of the same geodesic with
	opposite orientations.
\end{corollary}
Let us point out that the orientability is not required in
Corollary \ref{cor:isolated}. The corresponding result for a
non-orientable manifold  follows from \ref{prop:Morse-Zehnder}
applied to its orientable double  cover.

\subsubsection*{Absence of hyperbolic Lagrangian submanifolds  in uniruled manifolds}

As the first  application of the above compactness theorems let us
prove here the following theorem of C. Viterbo. Let us recall that
a  complex projective manifold $W$ is called uniruled, if there is a
rational holomorphic curve
through each point of $W$. For instance,  according to
Y. Myaoka--S. Mori
\cite{Mori-Miayoka}  and J. Kollar  \cite{Kollar}  Fano manifolds are uniruled.



\begin{theorem} {\rm (C. Viterbo, \cite{Viterbo})}
	Let $W$ be a uniruled manifold of complex dimension $>2$,  $\omega$ its K\"ahler
	sympletic form, and $L\subset W$ an embedded Lagrangian
	submanifold. Then $L$ does not admit a Riemannian metric of
	negative sectional  curvature.
\end{theorem}
\proof J. Kollar  \cite{Kollar}  and in a more general case Y.
Ruan   \cite{Ruan-virtual} proved  that there exists a homology
class $A\in H_2(W)$, such that for any almost complex structure
compatible with $\omega$ and any point $z\in W$ there exists
$f\in\Mc_{0,1}^A(W,J)$ with $f(y)=z$, where $y$ is the marked
point. Let us identify a neighborhood $U$ of $L$ in $W$ with  a
neighborhood of the zero-section in $ T^*(L)$. Suppose $L$ admits
a Riemannian metric of negative
curvature. We can assume that  $U$ is the round neighborhood of radius $1$ in
$T^*(L)$. Let us consider a sequence $J^m$ of almost complex structures
on $W$, which realizes the splitting along the contact  type hypersurface
$(V=\partial U,\alpha=pdq|_V)$.
(see Section \ref{sec:almost}). Then according to Example \ref{ex:cotangent}
$W$ splits into $W_-=T^*(L)$ and $W_+=W\setminus L$. The almost
complex structure $J_-$ on $T^*(L)$ is compatible at infinity  with the
contact $1$-form   $\alpha=pdq|_{V}$. According to Corollary
\ref{cor:isolated} for any choice $\Gamma=\{\g_1,\dots,\g_k\}$ and
any $g\geq 0$ the
moduli spaces $\Mc_g(\Gamma;W_-,J_-)$ are empty, or
$0$-dimensional. One the other hand, Theorem \ref{thm:comp2}
together with Ruan's theorem guarantee the existence of a
rational holomorphic curve  with punctures through every point
of $L$. This contradiction proves that
$L$ cannot admit a metric
of negative curvature.  \qed

\subsection{ Coherent orientation of the moduli spaces
	of holomorphic curves}\label{sec:orientation}


To get started with the algebraic formalism,
one first needs to orient moduli spaces
$\Mc(\Gamma^-,\Gamma^+)$ of holomorphic curves with punctures.
This problem is much easier in the case
of moduli spaces of closed holomorphic curves, because in that
case moduli spaces are even-dimensional and carry a canonical almost
complex structure (see Section \ref{sec:coherent-closed} below).
In our case we have to adapt the philosophy of {\it coherent orientations}
of the moduli spaces
borrowed from Floer homology theory (see \cite{Floer-Hofer}).
We sketch this approach in this section.


\subsubsection{Determinants}

In order to separate the problems of orientation and
transversality we are going to orient the determinant line bundles
of the linearized $\overline\partial$-operators, rather than  the moduli spaces themselves.

For a linear Fredholm operator $F:A\rightarrow
	B$ between Banach spaces we can define its determinant line
$\det(F)$ by $$ \det(F)= (\Lambda^{max} \Ker (F))\otimes
	(\Lambda^{max} \Coker (F))^{\ast}. $$ We note that for the trivial
vector space $\{0\}$ we have $\Lambda^{max}\{0\}= {\R}$.  An
orientation for $F$ is by definition an orientation for the line
$\det(F)$. In particular, given an isomorphism $F$ we can define a canonical
orientation given through the vector $1\otimes 1^{\ast}\in {\R
	}\otimes {\R}^{\ast}$.

Given a continuous family $F=\{F_y\}_{y\in Y}$ of Fredholm
operators, parameterized by a topological space $Y$,  the
determinants of operators $F_y$ form   a line bundle
$\det(F)\rightarrow Y$. The fact that this is a line bundle in a
natural way might be surprising since the dimensions of kernel and
cokernel vary in general. This is however a standard fact, see for
example \cite{Floer-Hofer}.

\subsubsection{Cauchy-Riemann Type Operators on Closed Riemann Surfaces}
\label{sec:coherent-closed} Let $(S,j)$ be a closed, not
necessarily connected Riemann surface and $E\rightarrow S$ a
complex vector bundle. Denote by $X_E\rightarrow S$ the complex
$n$-dimensional vector bundle whose fiber over $z\in S$ consists
of all complex ant-linear maps $$ \phi:T_zS\rightarrow E_z,\ z\in
	S,\ \hbox{i. e.}\ J\circ\phi+\phi\circ j=0, $$ where $J$ is the
complex structure on $E$. Fixing a connection $\nabla$ and a
smooth $a\in\hbox{Hom}_{\mathbb R}(E,X_E)$ we can define a
Cauchy-Riemann type operator $$L:C^{\infty}(E)\rightarrow
	C^{\infty}(X_E)$$ by the formula $$
	(Lh)(X)=\nabla_Xh+J\nabla_{jX}h +(ah)(X), $$ where $X$ is an
arbitrary vector field on $S$. Since the space of connections is
an affine space we  immediately see that the set ${\mathcal O}_E$
of all Cauchy-Riemann type operators on $E$ is convex. For a
proper functional analytic set-up, where we may chose H\"older or
Sobolev spaces, the operator $L$ is Fredholm. By elliptic
regularity theory the kernel and cokernel would be spanned always
by the same smooth functions, regardless which choice we have
made. The index of $L$ is given by the Riemann-Roch formula $$
	\hbox{ind}(L)= (1-g)  \hbox{dim}_{\mathbb R}(E) + 2 c(E), $$ where
$c(E)$ the first Chern number $c_1(E)(S)$ of $E$. Here we assume
$S$ to be a connected closed surface of genus $g=g(S)$.


Let   $\phi:(S,j)\rightarrow (T,i)$
be a biholomorphic map and $\Phi:E\rightarrow F$ a ${\mathbb
			C}$-vector bundle isomorphism covering $\phi$. Then $\Phi$ induces
an isomorphism $$ { \Phi}_{\ast}:{\mathcal O}_E\rightarrow
	{\mathcal O}_F $$ in the obvious way. The operators   $(E,L)$ and
$(F,K)$ are called isomorphic  if there exists ${
			\Phi}:E\rightarrow F$, so that ${\bf \Phi}_{\ast}(L)=K$. We will
denote by $[E,L]$ the equivalence class  of an operator  $(E,L)$
which consists of operators $(F,K)$, equivalent to $(E,L)$ under
isomorphisms, {\it isotopic to the identity}, and by $[[E,L]]$ the
equivalence class under the action of the full group of
isomorphisms. The moduli space of equivalence classes $[[E,L]]$
will be denoted by $\CR$, and the ``Teichmuller space" which
consists of classes $[E,L]$ will be denoted by $\wt{\CR}$. An
isomorphism $\Phi$ induces an isomorphism between the kernel
(cokernel) of $L$ and ${ \Phi}_{\ast}L$ for every $L\in {\mathcal
		O}_E$, and hence one can canonically associate the determinant
line to an isomorphism class, and thus define the {\it determinant
		line bundle} $\cV$ over the moduli space $\CR$.
Given an orientation $o$ for $L$ we obtain an induced
orientation ${ \Phi}_{\ast}(o)$.  Let us note the following
\begin{lemma}
	The bundle $\cV$ is orientable.
\end{lemma}
\proof The lift $\wt\cV$ of the bundle $\cV$ to the Teichmuller
space $\wt\CR$ is obviously orientable, because each connected
component of the space $\wt\CR$ is contractible. However, one
should check that an arbitrary isomorpism $\Phi:(E,L)\to (F,K)$
preserves the orientation. This follows from the following
observation. Any connected component of $\wt\CR$ contains an
isomorphism class of a complex linear operator $(E,L_0)$,  and any
two complex linear operators representing points in a given
component of $\wt\CR$ are homotopic in the class of complex linear
operators. The determinant of $(E,L_0)$ can be oriented
canonically by observing that its kernel and cokernel are complex
spaces.  Any isomorphism  maps a   complex linear operator to a
complex linear operator and preserves its complex orientation.
Hence, it preserves an orientation of the determinant line  of any
operator $(E,L)$.
\qed
\medskip

We will call an orientation of $\cV$ {\it complex} if it coincides
with    the complex orientation of   determinants   of complex
linear operators.


\bigskip

The  components of the space $\CR$ are
parameterized by the topological type of the underlying surface
$S$ and the isomorphism class of the bundle $E$.
It turns out that the complex orientation of $\cV$ satisfies three
	{\it coherency} Axioms A1--A3 which we formulate below.
They relate  orientations of $\cV$ over different components of
$\CR$.
Conversely, we will see that these axioms determine the
orientation uniquely up to a certain normalization.



Given $(E,L)$ and $(F,K)$ over surfaces $\Sigma_0$ and $\Sigma_1$
we define a {\it disjoint union}
$$ [E,L]\dot{\cup}[F,K] := [G,M]  $$ of $(E,L)$ and $(F,K)$ as a pair
$(G,M)$, where $G$ is a bundle over     the disjoint union
$\Sigma=\Sigma_0\coprod\Sigma_1$, so that $(G,M)|_{\Sigma_0}$ is
isomorphic to $(E,L)$ and $(G ,M)_{\Sigma_1}$  is isomorphic to
$(F,K)$. Clearly, the
isomorphism class of a disjoint union is uniquely determined by the classes
of $(E,L)$ and $(F,K)$.
Thus, we have a well-defined construction called {\it disjoint
		union}:
The determinant $\det\Sigma$ is canonically isomorphic to $\det
	L\otimes\det K$, and hence the orientations    $o_K$ and $o_L$
define
an orientation $o_K\otimes o_L$ of    $ \Sigma $.
Our first axiom  reads
\medskip

\noindent{\textsf{Axiom C1}}. For any disjoint union $
	[G,M]=[E,L]\dot{\cup}[F,K]$ the orientation $o_M$ equals
$o_K\otimes o_L$.
\bigskip



Given $(E,L)$ and $(F,K)$, where $E$ and $F$ are  bundles over $S$
of possibly different rank, we can define an operator $(E\oplus
	F,L\oplus K)$. There is a canonical map $$
	\hbox{det}(L)\otimes\hbox{det}(K)\rightarrow \hbox{det}(L\oplus
	K),
$$ and thus  given orientations $o_L$ and $o_K$ we obtain $o_L\oplus o_K$.


\bigskip
\noindent{\textsf{Axiom C2}}.$$o_{L\oplus K}=o_L\oplus o_K.$$
\bigskip

To formulate the third axiom, we need a construction, called {\it
		cutting and pasting}.

Let $(E,L)$ be given and assume that
$\gamma_1,\gamma_2:S^1\rightarrow S$ be real analytic embeddings
with mutually disjoint images. Assume that $\Phi:E|_{\gamma_1}
	\rightarrow E|_{\gamma_2}$ is a complex vector bundle isomorphism
covering $\sigma=\gamma_2\circ\gamma_{1}^{-1}$. The maps
$\gamma_1$ and $\gamma_2$   extends as holomorphic
embeddings $\bar{\gamma}_j:[-\varepsilon,\varepsilon]\times S^1
	\rightarrow S$ for a suitable small $\varepsilon>0$, so that the
images are still disjoint. Locally, near $\gamma_j$ we can
distinguish the left and the right side of $\gamma_j$. These sides
correspond to the left or the right part of the annulus
$[-\varepsilon,\varepsilon]\times S^1$. Cutting $S$ along the
curves $\gamma_j$ we obtain a compact Riemann surface $\bar{S}$
with boundary. Its boundary components are $\gamma_{j}^{\pm}$,
$j=1,2$, where $\gamma^{\pm}_{j}$ is canonically isomorphic to
$\gamma_j$. The vector bundle $E$ induces a vector bundle
$\bar{E}\rightarrow \bar{S}$. We define a space of smooth sections
$\Gamma_{\Delta}(\bar{E})$ as follows. It consists of all
smooth sections $\bar{h}$ with the property that $$
	\bar{h}|_{\gamma_{j}^{-} }= \bar{h}|_{\gamma_{j}^{+}}\ \hbox{for}\
	j=1,2. $$ Then $L$ induces an operator
$\bar{L}:\Gamma_{\Delta}(\bar{E}) \rightarrow
	\Gamma(X_{\bar{E}})$. The operators  $L$ and $\bar{L}$
have naturally isomorphic kernel and cokernel. So an orientation $o$ of $\hbox{det}(L)$
induces one of $\hbox{det}(\bar{L})$. The boundary condition
$\Delta$ can be written in the form
\begin{eqnarray*}
	\left[\begin{array}{cc} 1 & 0 \\ 0&1
		\end{array}\right]
	\cdot\left[\begin{array}{c}
			\Phi(\gamma_{1}(t)\bar{h}\circ\gamma_{1}^{-}(t) \\
			\bar{h}\circ\gamma_{2}^{-}(t)
		\end{array}\right]
	=\left[\begin{array}{c}
			\Phi(\gamma_1(t))\bar{h}\circ\gamma^{+}_{1}(t) \\
			\bar{h}\circ\gamma^{+}_{2}(t)
		\end{array}\right]
\end{eqnarray*}
We introduce a parameter depending boundary condition by
\begin{eqnarray*}
	\left[\begin{array}{cc} cos(\tau) & sin(\tau) \\ -sin(\tau)&cos(\tau)
		\end{array}\right]
	\cdot\left[\begin{array}{c}
			\Phi(\gamma_{1}(t)\bar{h}\circ\gamma_{1}^{-}(t) \\
			\bar{h}\circ\gamma_{2}^{-}(t)
		\end{array}\right]
	=\left[\begin{array}{c}
			\Phi(\gamma_1(t))\bar{h}\circ\gamma^{+}_{1}(t) \\
			\bar{h}\circ\gamma^{+}_{2}(t)
		\end{array}\right]
\end{eqnarray*}
for $\tau\in [0,\frac{\pi}{2}]$. For all these boundary conditions
$L$ induces an operator, which is again Fredholm of the same
index. For every $\tau$ we obtain a Cauchy-Riemann type operator
from $\Gamma_{\Delta_{\tau}}(\bar{E}) $ to $\Gamma(X_{\bar{E}})$.
Note that for a section $h$ satisfying the boundary condition
$\Delta_{\tau}$ the section $ih$ satisfies the same boundary condition.
On the other hand for
$\tau=\frac{\pi}{2}$ we obtain a Fredholm operator whose
kernel and cokernel naturally isomorphic to the kernel on cokernel of
a   Fredholm operator
on a new closed surface. Namely identify $\gamma^{+}_{1}$ with
$\gamma^{-}_{2}$ and $\gamma^{+}_{2}$ with $\gamma^{-}_{1}$. For
the bundle $\bar{E}$ we identify the part above $\gamma^{+}_{1}$
via $\Phi$ with the part over $\gamma_{2}^{-}$ and we identify the
part above $\gamma^{-}_{1}$ with $-\Phi$ to the part above
$\gamma^{+}_{2}$. The latter surface and bundle we denote by
$E_{\Phi}\rightarrow S_{\Phi}$ and the corresponding operator by
$L_{\Phi}$. Letting the parameter run we obtain starting with an
orientation $o$ for $L$ an orientation $o_{\Phi}$ for $L_{\Phi}$.
If $o$ is the complex orientation it is easily verfied that
$o_{\Phi}$ is the complex orientation as well. We  say that the operator
$L_{\Phi}$  is an operator obtained
from $L$ by cutting and pasting.  This operator $L_\Phi$ has the
same index as $L$,  and the component of $[L,\Phi]$ in $\wt\CR$
depends only the isotopy classes of the embeddings $\gamma_1$ and
$\gamma_2$.



\bigskip

\noindent{\textsf{Axiom C3}}. $$o_{L_\Phi}=o_\Phi\, .$$
\bigskip

Note that we have to require here that the parts of $L$ over the curves
$\gamma_1$ and $\gamma_2$ are isomorphic via the gluing data.
It is straightforward to check that
\begin{theorem}\label{thm:complex-coherent}
	The complex orientation of $\cV$ is coherent, i.e. it satisfies
	Axioms C1--C3.
\end{theorem}

Let us point out a simple
\begin{lemma}
	Let $(E,L)$ be  an isomorphism then the orientation by $1\otimes 1^{\ast}$
	of the $\det
		L={\mathbb R}\otimes {\mathbb R}^{\ast}$ defines the complex
	orientation of $\cV$ over the component of $[E,L]$.
\end{lemma}
The following
theorem gives the converse of Theorem \ref{thm:complex-coherent}.

\begin{theorem}\label{thm:coherent-complex}
	Suppose that a coherent orientation of $\cV$  coincides with
	the complex orientation for  the trivial line bundle over $S^2$
	and for
	the line bundle over $S^2$ with Chern number $1$. Then the
	orientation is complex.
\end{theorem}

\proof
Let us first observe that according to Theorem
\ref{thm:complex-coherent} the disjoint union, direct sum and
cutting and pasting procedures preserve the class of complex
orientations.  Consider the pair $(E_0,L_0)$, where  $E_0$
is the trivial bundle $ S^2\times {\mathbb C}\to S^2$ and $L_0$ is the
standard Cauchy-Riemann operator. Then the $\ind L_0=2$. Take
small loops around north pole and south pole on $S^2$ and
identify the trivial bundles over these loops. Now
apply the cutting and pasting procedure and Axiom C3 to obtain the
disjoint union of the trivial bundle over the torus and the
trivial bundle over $S^2$. Hence we can use Axiom C1 to obtain an
induced orientation for the Cauchy-Riemann operator on the trivial
bundle over $T^2$. Taking appropriate loops we obtain orientations
for all trivial line bundles over Riemann surfaces of arbitrary
genus. Using direct sums
and disjoint unions constructions, and applying Axioms C1 and C2  we see that  the orientation of
all trivial bundles
of arbitrary dimensions over Riemann surfaces of arbitrary genus
are complex. Let $E_1$ be the bundle over $S^2$ with Chern number
$1$.  Then we can use C3 to glue  two copies of $(E_1,L_1)$ to
obtain the complex orientation of the disjoint union of a Cauchy
Riemann operator on the trivial bundle and one on the bundle with
Chern number $2$. Now it is clear that  the given coherent
orientation has to  be complex over all components of the moduli space
$\CR$. \qed

In the next section we extend the coherent orientation from
Cauchy-Riemann type operators over closed surfaces to
a  special class of Cauchy-Riemann type
operators on Riemann surfaces with punctures.

\subsubsection{A special class of Cauchy-Riemann type
	operators on punctured Riemann surfaces}\label{sec:coherent-punct}

Let us view ${\mathbb C}^n$ as a real vector space equipped with
the Euclidean  inner product which is the real part of the
standard Hermitian inner product. We define a class of
self-adjoint operators as follows. Their domain in
$L^2(S^1,{\mathbb C}^n)$
is
$H^{1,2}(S^1,{\mathbb C}^n)$ of  Sobolev maps $h:S^1\rightarrow
	{\mathbb C}^n$.  The operators have the form
\begin{equation}\label{eq:asymptotic}
	(Ax)(t)=-i\frac{dx}{dt}-a(t)x,
\end{equation}
where $a(t)$ is a smooth loop of
real linear self-adjoint maps. We assume that $A$ is
non-degenerate in the sense that $Ah=0$ only has the trivial
solution, which just means that the time-one map $\psi(1)$ of the
Hamiltonian flow
\begin{equation}\label{eq:asympt-flow}
	\begin{split}
		\dot{\psi}(t)= & i a(t)\psi(t), \\
		\psi(0)=       & \Id            \\
	\end{split}
\end{equation}
has no eigenvalues equal  to $1$.
In particular, $A:H^{1,2}\rightarrow L^2$ is an
isomorphism.

Given a smooth vector bundle $E\rightarrow S^1$ we can define
$H^{1,2}(E)$ and $L^2(E)$ and a class of operators $B$ by
requiring that $A=\Phi B\Phi^{-1}$ for  an Hermitian
trivialization $\Phi$ of the bundle $E$.  We shall call such
operators {\it asymptotic}, for reasons which will become clear
later.

As it was defined in Section \ref{sec:holomorphic} above,
an asymptotically marked
punctured Riemann surface is a triplet $(S, \bx , \mu )$, where
$S=(S,j)$ is a closed Riemann surface,
$\bx =\{x _1,\dots,x _{s }\}$
is the set  of  punctures, some of them called positive, some
negative, and $\bmu=\{\mu_1,\dots,\mu_s\}$   is the set of
asymptotic markers, i.e. tangent rays,
or equivalently oriented
tangent lines at the punctures.

One can introduce near each puncture $x_k\in\bx$ a holomorphic
parameterization, i.e. a holomorphic map $h_k:D\to S$ of the unit
disk $D$ such that $h_k(0)=x_k$ and the asymptotic marker $\mu_k$
is tangent to the ray $h_k(r),\;r\geq 0$. We assume that the
coordinate neighborhoods $\cD_k=h_k(D)$ of all the punctures are
disjoint. Then we define $\sigma_k:{\mathbb R}^+\times
	S^1\rightarrow {\mathcal D}\setminus\{0\}$ by $$
	\sigma_k(s,t)=h_k(e^{\pm{2\pi(s+it)}}), $$ where the sign $-$ is
chosen if the  puncture $x_k$ is positive, and the sign $+$ for
the negative puncture. We will refer to $\sigma_k$ as holomorphic
polar coordinates adapted to $(x_k,\mu_k)$. Given two adapted
polar coordinate systems $\sigma $ and $\sigma'$ near the same
puncture $x\in\bx$
we observe that the transition map
(defined for $R$ large enough) $$ \sigma
	^{-1}\circ\sigma':[R,\infty)\times S^1 \rightarrow
	[0,\infty)\times S^1 $$ satisfies for every multi-index $\alpha$
$$ D^{\alpha}[\sigma^{-1}\circ\sigma'(s,t)-(c+s,t)] \rightarrow 0
$$ uniformly for $s\rightarrow\infty$, where $c$ is a suitable
constant. The main point is the fact that there is no phase shift
in the $t$-coordinate.

Given $(S, \bx , \mu )$ we associate to it a smooth surface
$\bar{S}$ with boundary compactifying the punctured Riemann
surface $S\setminus\bx$ by adjoining a circle for every puncture.
Each circle has a distinguished point $0\in S^1={\mathbb
	R}/{\mathbb Z}$. Namely for each   positive puncture we compactify
${\mathbb R}^+\times S^1$ to $[0,\infty]\times S^1$, where
$[0,\infty]$ has the smooth structure making the map $$
	[0,\infty]\rightarrow [0,1]:s\rightarrow s(1+s^2)^{-\frac{1}{2}},\
	\infty\rightarrow 1 $$ a diffeomorphism. We call
$S^{+}_{k}=\{\infty\}\times S^1$ the circle at infinity associated
to $(x_k,\mu_k)$. For negative punctures we compactify at
$-\infty$ in a similar way.

\begin{definition}
	A smooth complex vector bundle $E\rightarrow  (S, \bx , \mu )$ is
	a smooth vector bundle over $\hat{S}$ together with Hermitian
	trivializations $$ \Phi_k:E|_{S_{k}}\rightarrow S^1\times{\mathbb
			C}^n. $$ An isomorphism between two bundles $E$ and $F$ over
	surfaces $S$ and $T$ is a a complex vector bundle isomorphism
	$\Psi:E\to F$ which covers   a biholomorphic map
	$\phi:(S,j)\rightarrow (T,i)$, preserves punctures and the
	asymptotic markers  (their numbering and signs)  and respects the
	asymptotic trivializations.
\end{definition}

Define as in Section \ref{sec:coherent-closed} above   the bundle
$X_E\rightarrow \bar{S}$. Set $\dot{S}=S\setminus\Gamma$. We
introduce the Sobolev space $H^1(E)$ which  consists of all
sections $h$ of $E\rightarrow \dot{S}$ of class $H^{1,2}_{loc}$
with the following behavior  near   punctures.
Suppose, that $x$ is a positive puncture and   $\sigma$
is an adapted system of  holomorphic polar coordinates. Pick a
smooth   trivialization $\psi$ of $E\rightarrow \bar{S}$ over
$[0,\infty]\times S^1$ (in local coordinates) compatible with the
given asymptotic trivialization. Then the map $(s,t)\rightarrow
	\psi(s,t)h\circ\sigma(s,t)$ is assumed to belong to
$H^{1,2}({\mathbb R}^+\times S^1,{\mathbb C}^n)$. A similar
condition is required for   negative punctures. In a similar
way we define  the space $L^2(X_E)$. Observe that defacto we use
measures which are infinite on $\dot{S}$ and that the
neighborhoods of punctures look  like half-cylinders.

A Cauchy-Riemann type operator $L$ on $E$ has the form $$ (Lh)X =
	\nabla_Xh+J\nabla_{jX}h +(ah)X, $$ where $X$ is a vector field on
$S$.   We require, however a particular behaviour of $L$  near the
punctures. Namely, regarding   $E$ as a trivial bundle
$[0,\infty]\times \C^n$ with respect to the chosen polar
coordinates and trivialization near say a positive  puncture we
require that $$ (Lh)(  s,t )(\frac{\partial }{\partial s})
	=\frac{\partial h}{\partial s} - A(s)h, $$ where $A(s)\rightarrow
	A_{\infty}$ for an asymptotic operator $A_{\infty}$,   as  it was
previously introduced.
\begin{theorem}
	The operator $L$ is Fredholm.
\end{theorem}
The index of $L$ can be computed in terms of Maslov indices of
the asympotic operators (and, of course, the first Chern class of
$E$ and the topology of $S$).



Similar to the case of closed surfaces we define the notion of
isomorphic pairs $(E,L)$ and $(F,K)$, where we emphasize the
importance of the compatibility of the asymptotic trivializations,
define the moduli space $\CR_{\punct} \supset \CR_{\cl}$ and the
Teichmuller spaces $\wt\CR_{\punct} \supset\wt\CR_{\cl}$, and
extend the determinant line bundle $\cV$ to $\CR_{\punct}$ and
$\wt\cV$ to $\wt\CR_{\punct}$. The bundle $\wt\cV$ is orientable
by the same reason as in the
case of closed surfaces: each component of the space $\wt\CR_{\punct}$ is
contractible. However, unlike the closed case,  there is no
canonical (complex) orientation of $\wt\cV$. Still due to the
requirement
that
isomorphisms  preserves the end structure of the operators, one
can deduce the fact that even isotopically non-trivial isomorphisms
preserve the orientation of $\wt\cV$, which shows that the bundle
$\cV$ over $\CR_{\punct}$ is orientable.


Let us review now Axioms C1--C3 for the line bundle
$\cV$ over $\CR_\punct$. The formulation of Disjoint Union Axiom
C1
should be appended by the  following requirement. Let $(E,L)$ and $(F,K)$ be
operators
over the punctured
Riemann surfaces $(S,\bx=\{x_1,\dots,x_s\})$ and $(T,\by=\{y_1,\dots,y_t\})$, respectively.
Then $(E,L)\dot{\cup}(F,K)$ is an operator over the surface
$S\coprod T$ with the set of punctures ${\mathbf z}=\{x_1,\dots,x_s,y_1,\dots,y_t\}$.
The disjoint union operation is associative, but not necessarily
commutative (unlike the case of closed surfaces).
Axioms C2 and C3  we formulate without any changes compared to the closed case.
By a coherent orientation of the bundle $\cV$ over $\CR_{\punct}$
we will mean any orientation of $\cV$ which satisfies Axioms
C1--C3.

Take  the trivial (and globally trivialized) line bundle $E_0=
	\C\times\C$ over the 1-punctured  Riemann sphere $\C=\C P^1\setminus \infty$.
For any
admissible asymptotic operator $A$ we choose a Cauchy-Riemann
operator $L^\pm_A$ on $E_0$ which has $A$ as its asymptotics at $\infty$. The
superscript $\pm$ refers to the choice of $\infty$ as the positive
or negative puncture.
Note, that the   component  of $([E_0,L^\pm_A)$ in the  moduli spaces
$\CR$   is uniquely determined
by the  homotopy class $[A]$ of  the asymptotic operator $A$ in the space
of {\it non-degenerate} asymptotic operators.

The following theorem describes all possible coherent orientations
of  the line bundle $\cV$ over $\CR$.


\begin{theorem}\label{thm:coherent}
	Let us choose an  orientation $o^\pm_A$ of the operator
	$(E_0,L^\pm_A)$ for a representative $A$ of each homotopy class
	$[A]$ of non-degenerate  asymptotic operators. Then this choice
	extends to the unique coherent orientation of the bundle $\cV$
	over $\CR_{\punct}$, which coincide with the complex orientation
	over $\CR_{\cl}$.
\end{theorem}
Thus  there are infinitely many coherent orientations of $\cV$
over $\CR_{\punct}$ unlike the  case of closed surfaces, when there are
precisely four.

We sketch below  the proof of Theorem \ref{thm:coherent}.
First, similar to the case of closed surfaces, it is sufficient
to consider only operators on the trivial, and even globally
trivialized bundles.
Next take the disjoint union of
$(E_0,L^-_A)$ and $ (E_0,L^+_A)$, consider two circles $\g^\pm$ around the  punctures
in the two copies of $\C$ and apply the cutting/pasting
construction along these circles. As the result we get a disjoint
union of an operator $\wt L_A$ on the trivial line  bundle over the closed Riemann
sphere, and an operator $\overline L_A$ over  the cylinder $C=S^1\times\R$,
which we view as the Riemann sphere
with  two
punctures $x_1=\infty$ and $x_2=0$ and consider $x_1$ as a positive puncture
and $x_2$ as a negative one. The operator $\overline L_A$ has the
same asymptotic operator $A$ at both punctures.
Then Axioms C1 and C3 determine the orientation of $\overline
	L_A$, because for  the operator $\widetilde L_A$ we have chosen
the complex orientation. Notice that if one glue $L_A^\pm$ in the opposite order,
then we get an operator $\overline L_A'$ which has the reverse
numbering of the punctures.
The orientation of $\overline L_A'$  determined by the gluing  may be the same, or opposite as
for the operator $\overline L_A$, depending on the parity of the Conley-Zehnder
index of the asymptotic operator $A$.\footnote{
	The operator $\overline L_A$
	is homotopic to an isomorphism, and thus has a canonical
	orientation
	$1\otimes 1^{\ast}$. If we insist on that normalization, than
	our construction would determine the orientation of $L_A^-$ in
	terms of $L_A^+$.}


Consider now an arbitrary operator  $(E,L)$  acting on sections of a complex line bundle
$E$ over   a punctured
Riemann surface
$(S,\bx,\bmu)$ with $\bx=\{x_1,\dots,x_s\}$, $E=S\times\C^n$, and the  asymptotic operators
$A_1,\dots,A_s$ at the corresponding punctures. For each
$i=1,\dots,s$ consider an operator $(E_0,L_i=L_{A_i}^\pm)$, where
$E_0=\C\times\C^n$,  the sign $+$ is chosen if the puncture
$x_i$ is negative, and the sign $+$ is chosen  otherwise.
Using Axiom C1 we orient the operator $
	(E,L)\dot{\cup}(E_0,L_s)$, and then choosing circles around the
puncture $x_s$ and $\infty$ apply the cutting/pasting procedure.
As the result we get the disjoint union of an operator $L'$ over
the Riemann surface with punctures $(x_1,\dots,x_{s-1})$ and the
operator $\overline L_A$, or $\overline L_A'$ depending on
whether the puncture $x_s$ was negative, or positive. Hence
Axioms C1 and C3 determine the orientation of $L'$ in terms of the orientation
of $L$. Repeating the
procedure for the punctures $x_{s-1},\dots,x_1$ we express
the orientation of $L$ in terms of the complex
orientation of an operator over the closed surface.

It remains to observe that if $E$ is a trivial complex bundle of rank $r>1$,
then any asymptotic operator
$A$ can be deformed through non-degenerate asymptotic operators to an operator
$\widetilde A$ which is split into the direct
sum of asymptotic operators on the trivial complex line. Hence we can use the direct sum
axiom C2 to orient determinants of  operators  acting on bundles of arbitrary rank.
\bigskip

\subsubsection{Remark about  the coherent orientation for
	asymptotic  operators with symmetries}
Let $A$ be an asymptotic operator
given by the formula (\ref{eq:asymptotic}),
where the loop $a(t),\,t\in S^1=\R/\Z$, of symmetric matrices has a symmetry
$a(t+1/2)=a(t),\;t\in\R/\Z$. Let $L$ be a Cauchy-Riemann type
operator on a bundle $E\to S$, which has $A$ as its
asymptotic
operator at a puncture $x\in S$ with an asymptotic marker $\mu$.
Let $L'$ be an operator which differs from $L$ by
rotating by the angle $\pi$ the marker $\mu$ to a marker $\mu'$,
with the corresponding change of the trivialization near the
puncture.
Let $h:S\to S$ be  a diffeomorphism  which rotates
the polar coordinate
neighborhood $\cD$ of the punctures $x$ by $\pi$, and is fixed
outside a slightly larger neighborhood.
Then the operator $h_*L'$ has the same asymptotic data as $L$ and
the  isomorphism classes $[E,L]$ and $[E,h_*L']$ belongs to the
same component of the space $\wt\CR$. Given a coherent
orientation of $\cV$, do the orientations $o_L$ and $o_{h_*L}$
coincide? It turns out that
\begin{lemma}\label{lm:bad-orbits}
	Let $\Psi$ be the time-one map of the linear Hamiltonian flow $\psi(t)$,
	defined by the equation {\rm (\ref{eq:asympt-flow})}. The orientations
	$o_L$ and $o_{h_*L}$ coincide if and only if the number of  real eigenvalues  of  $\Psi$
	(counted with multiplicities)  from the interval $(-1,0)$ is
	even.
\end{lemma}
This lemma is the reason why we excluded certain periodic orbits
from $\Pc$ in Section \ref{sec:dynamics} above. See also Remarks
\ref{rem:bad-orbits1} and \ref{rem:bad-orbits2}.


\subsubsection{Coherent orientations of moduli spaces}
The moduli spaces of holomorphic curves which we need to orient are zero sets of nonlinear
Cauchy-Riemann type operators, whose linearizations are related to
operators of the kind we described (see below for more details).
In general, the moduli spaces are neither manifolds nor orbifolds,
due to the fact  that Fredholm sections cannot be made transversal
to the zero section by changing natural parameters like the almost
complex structure or the contact form. Such a transversality will
only be achievable by making abstract perturbations, leading to
virtual moduli spaces. Those virtual spaces will be the moduli
spaces which will provide us with the data for our constructions.
Nevertheless the Fredholm operators occurring in the description
of the virtual moduli spaces will only be compact perturbations of
the Cauchy-Riemann type operators, and hence the orientation scheme
for these virtual moduli spaces does not differ from the case of moduli spaces
of holomorphic curves.


A moduli space  $\Mc(\Gamma^+,\Gamma^-;W,J)$ of  holomorphic
curves in a directed symplectic cobordism $(W=\ora{V^-V^+},J)$ is
a fiber bundle over the corresponding moduli space of Riemann
surfaces. Its base is   a complex orbifold, and hence it is
canonically oriented, while the
fiber over a point $S$, where $S$ is a Riemann surface with a
fixed conformal structure
and positions
of punctures,  can be viewed as the space  solutions of the $\overline
	\partial_J$-equation.
If the  transversality is achieved than the  tangent bundle  of a
moduli space  $\Mc(\Gamma^+,\Gamma^-;W,J)$  arise as  the kernel of the linearized
surjective  operator $\overline\partial_J$.
The linearization  of $\overline
	\partial_J$
at a point $f\in \Mc(\Gamma^+,\Gamma^-;W,J)$
is a Fredholm operator in a suitable functional analytic setting.
This set-up involves Sobolev spaces with suitable asymptotic
weights derived from the non-degeneracy properties of the periodic
orbits. It is a crucial observation, again a corollary of the
behaviour near the punctures, that up to a compact perturbation,
the operator $L$ splits into two operators $L'$ and $L''$, where
$L'$ is   a complex linear operator acting on the complex line
bundle $T(S)$ of the Riemann surface $S$, and $L''$ is a
Cauchy-Riemann  type on the the bundle $E$, such that $T(S)\oplus
	E=f^*(TM)$. This operator is usually only real linear, but most
importantly it is of the kind we just described in our linear
theory.
The trivialization of $E$ near the punctures
is determined by the chosen in \ref{sec:holomorphic}
trivialization
of the contact structure near
periodic orbit of   the Reeb vector fields on $V^\pm$, and the
asymptotic operators are determined by the linearized Reeb flow
near the periodic orbits. We have $\det L=\det L'\otimes\det L''$.  But  $\det L'$ has a canonical complex
orientation, and   hence the orientation for $\det L$ is  determined by   the orientation of
$\det L''$. Therefore, a choice of
a coherent orientation of $\cV$ over $\CR$ determines in the
transversal case the orientation of  all the moduli spaces
$\Mc(\Gamma^+,\Gamma^-;W,J)$.










\subsection{First attempt of algebraization:
	Contact Floer homology}  \label{sec:Floer}
\subsubsection{Recollection of finite-dimensional Floer theory} \label{sec:Morse}
Let us  first recall   the basic steps in defining a Floer homology theory in the simplest case of a
Morse function $f$ on a finite-dimensional orientable closed manifold
$M$. We refer the reader
to  Floer's  original papers (see, for instance, \cite{Floer}), as well as an excellent exposition by D. Salamon  \cite{Salamon:Floer}
for the general theory.

First,  one forms a  graded complex $C(f,g)$ generated by
critical points  $c_1,
	\dots,c_N$ of      $f$, where the grading is given by the Morse index of critical points.
Next, we  choose a  generic Riemannian metric $g$ on $M$  which satisfy the Morse-Smale condition of transversality
of stable and unstable varieties
of critical points. This enables us to define  a differential $d=d_{f,g}:C(f,g)\to C(f,g)$ by counting  gradient trajectories
connecting critical points   of neighboring indices:
$$d(c_i)=\sum L_i^jc_j,$$ where the sum is taken
over all critical points $c_j$  with   $\ind c_j=\ind c_j-1$. The coefficient  $L_i^j$
is the {\it  algebraic number}  of    trajectories    connecting $c_i$ and $c_j$.
This means that the trajectories are counted
with signs.   In the finite-dimensional case the signs could  be determined
as follows. For each critical point we orient arbitrarily its stable manifold. Together with
the orientation of $M$ this allows us to orient  all unstable manifolds,
as well as the intersections
of stable and unstable ones.   If $\ind c_j=\ind c_i-1$ then
the stable manifold of $c_i$ and the unstable manifold
of $c_j$ intersect along finitely many trajectories which   we want to count,
and hence each of these trajectories
gets an orientation. Comparing this orientation with the one given by the direction of the gradient $\nabla f$ we can associate
with every trajectory a sign. \footnote{The generalization of this procedure to an infinite-dimensional
	case is not straightforward, because stable and unstable manifolds not only can become
	infinite-dimensional, but in most interesting cases cannot  be defined at all.  On the other hand,
	the moduli spaces of
	gradient trajectories connecting pairs of critical points  (which in the finite-dimensional case
	coincide with the intersection
	of stable and unstable manifolds of the critical points) are often defined, and one can use the coherent
	orientation scheme, similar to the one described in Section \ref{sec:orientation}
	above for the moduli spaces of holomorphic curves,
	to define their orientation.}

To show that $d^2=0$, which then  would allow us to define the homology group
$H_*(C(f,g),d)$, we proceed as follows.
Let us observe that  the coefficients $K_i^j$ in the expansion $d^2(c_i)=\sum K_i^jc_j$
count  the algebraic number of broken gradient trajectories  $(\d_{il},\d_{lj})$  passing through an intermidiate
critical point $c_l$, $l=1,\dots N$.
But each broken trajectory    $(\d_{il},\d_{lj})$, which connects critical points whose
indices differ by $2$, is a boundary point
of the $1$-dimensional manifold of smooth trajectories connecting $c_i$ and $c_j$. The  algebraic number of boundary points of a compact
$1$-dimensional  manifold is, of course, equal to $0$. Hence $K_i^j=0$, and thus $d^2=0$.


Next we want to show that the homology group $H_*(C(f,g),d)$ is  an invariant of the manifold $M$
(of course, in the case we consider it is just $H_*(M)$), i.e. it is independent of the choice of the function
$f$ and the Riemannian metric $g$.  The proof of the invariance consists of three steps.
\medskip

\noindent \textsf{Step 1.}
Let us show that given a homotopy  of functions $F=\{f_t\}_{t\in[0,1]}$,   and a homotopy  of Riemannian metrics
$G=\{g_t\}_{t\in[0,1]}$, one can define a homomorphism $\Phi=\Phi_{F,G}:C(f_1,g_1)\to C(f_0,g_0)$ which commutes with
the boundary homomorphisms $d_0=d_{f_0,g_0}$ and $d_1=d_{f_1,g_1}$, i.e.
\begin{equation}\label{eq:Morse-boundary}
	\Phi\circ d_1-d_0\circ\Phi=0\,.
\end{equation}
To construct $\Phi$ we consider the product
$W=M\times\R $ and, assuming that the homotopies $\{f_t\}$ and $\{g_t\}$ are
extended to all $t\in\R$  as independent  of $t$ on
$(-\infty,-1]\cup[1,\infty)$, we
define on $W$
a function, still denoted by $F$,
by the formula
\begin{equation*}
	F(x,t)=
	\begin{cases}
		f_0(x)+ct, & \;\;t\in (\infty,0) ; \\
		f_t(x)+ct, & \;\;t\in[0,1]\;\;  ;  \\
		f_1(x)+ct, & \;\;t\in(0,\infty) ,  \\
	\end{cases}
\end{equation*}
where the constant $c$ is chosen to ensure that $\frac{\partial
		F}{\partial t}>0$. Similarly, we use the family of Riemannian
metrics $g_t$
to define a metric $G$ on $W$  which is equal to $g_t$ on $M\times
	t$ for all $t\in\R$, and such that $\frac{\partial}{\partial t}$ is the unit vector field
orthogonal to the slices $M\times t,t\in\R$.
The gradient trajectories of $\nabla F$ converge to
critical points of $f_1$ at $+\infty$ , and  to the critical points
of $f_0$ at $-\infty$. For a generic choice of $G$ the moduli space of the
(unparameterized)
trajectories connecting two critical points, $c^1$ of $f_1$ and
$c^0 $ of $f_0$, is a compact $k$-manifold with boundary with corners,
where $k=\ind c^1-\ind c^0$. Hence,
similarly
to the above definition of the differential $d$, we can define a homomorphism
$\Phi:C(f_1,g_1)\to C(f_0,g_0)$ by  taking an algebraic count of gradient trajectories between
the critical point of $f_1$ and $f_0$ of the same Morse index,
i.e.
$\Phi(c^1_j)=\sum \wt L^i_jc^0_j$. The identity
(\ref{eq:Morse-boundary}) comes from the  description of the  boundary
of the $1$-dimensional moduli spaces of trajectories of $\nabla
	F$. Notice that the function $F$ has no critical points, and hence
a family of gradient trajectories cannot converge to a broken
trajectory in a usual sense. However, this can happen {\it at
		infinity}. Let us recall that the function $F$ and the metric $G$
are cylindrical outside of  $M\times[-1,1]$. Hence
away from a compact set  a gradient
trajectory of $F$  projects to a gradient
trajectory of $f_0$ or $f_1$. When  the projection, say at $+\infty$,
of a sequence  $\d_n:\R\to W$ of trajectories of $\nabla F$   converges  to
a broken trajectory  of    $\nabla f_1$ this can be interpreted as a
splitting at $+\infty$. This phenomenon is very similar to  the one  described
for the moduli spaces of holomorphic curves in Section
\ref{sec:compact}. Namely, there exist    gradient  trajectories $\d:\R\to W $  of $\nabla F$,
and $\d':\R\to M_1$ of $\nabla f_1$,  such that
\begin{description}
	\item{$-\;$} $\d_n\to\d$ uniformly on $(-\infty,C]$ for all $C$;
	\item{$-\;$} there exists a sequence $C_n\to+\infty$ such that
	      $\d'_n(t)=\d_n(t+C_n)$ converges to $(\d'(t),t)$ uniformly on all
	      subsets $[-C,\infty)$.
\end{description}

In this sense broken trajectories of the form $(\d,\d')$ and
$(\d'',\d)$, where $\d''$ is a   trajectory of $\nabla f_0$ form
the boundary of the $1$-dimensional moduli spaces of trajectories
of $\nabla F$ connecting critical points  $c^1$ of $f_1$ and
$c^0 $ of $f_0$  with $\ind c^1-\ind c^0=1$. Therefore the
algebraic number of these trajectories equals $0$. On the other hand,
this number is equal   to $\Phi\circ d_1-d_0\circ\Phi $  which yields
the identity (\ref{eq:Morse-boundary}).
\medskip

\noindent\textsf{Step 2.} Our next goal is to check that  if
$(F_u,G_u), u\in[0,1],$  is a homotopy of homotopies which is
constant outside of a compact subset of $W$, then
the homomorphisms $\Phi_0=\Phi_{F_0,G_0}$ and $\Phi_1=\Phi_{F_1,G_1}$ are related via the
chain homotopy formula
\begin{equation}\label{eq:Morse-chain}
	\Phi_1-\Phi_0=K\circ d_1+d_0\circ K,
\end{equation}
for a homomorphism $K:C(f_1,g_1)\to C(f_0,g_0)$. The space of all homotopies $(F,G)$
connecting given pairs $(f_0,g_0)$ and $(f_1,g_1)$ is contractible,
and hence (\ref{eq:Morse-chain}) implies
that the homomorphism $\Phi_*:H_*(C(f_1,g_1),d_1)\to
	H_*(C(f_0,g_0),d_0)$ is independent of the choice of a homotopy
$(F,G)$.

To prove (\ref{eq:Morse-chain}) one studies moduli spaces  of
gradient trajectories  of the whole $1$-parametric family of
functions $F_u$. For a generic choice of the homotopy one has
isolated critical values of the parameter $u$  when appear
	{\it handle-slides}, i.e. gradient connections between critical
points with the index difference $-1$.  By  counting these
trajectories
one can then define a
homomorphism $K:C(f_1,g_1)\to\C(f_0,g_0)$ in exactly the same way as the homomorphism $\Phi$
was  defined in Step 1
by counting   trajectories   with the index difference  $0$.

The identity (\ref{eq:Morse-chain}) expresses  the fact that the broken
trajectories  of the form $(\d,\d')$ and $(\d'',\d)$, where $\d$
is a handle-slide trajectory and $\d'$ is a trajectory of $\nabla
	f_1$, form the boundary of the moduli space  of   index $0$
trajectories in the family $(F_u,G_u)$. The difference in signs
in formulas (\ref{eq:Morse-boundary}) and (\ref{eq:Morse-chain})
is a reflection of the fact that the homomorphism $K$ raises the grading by
$1$, while $\Phi$ leaves it unchanged.





\medskip
\noindent\textsf{Step 3.} Finally we need to show that
\begin{equation}
	\label{eq:Morse-composition}
	(\Phi_{F,G})_*=(\Phi_{F',G'})_*\circ(\Phi_{F'',G''})_*,
\end{equation}
if
$(F,G)=\{f_t,g_t\}_{t\in[0,2]}$ is the composition of homotopies
$(F'',G'')=\{f''_t,g''_t\}_{t\in[0,1]}$ and
$(F',G')=\{f'_t,g'_t\}_{t\in[1,2]}$. To prove this we  view,
as in Step 1, the  homotopy $(F,G)$ as a function and a metric
on the cylinder $W=M\times\R$. Consider a deformation $(F_T,G_T)$ of $F,G$, by
cutting $W$ open along $M\times 1$ and inserting a cylinder
$M\times[0,T]$ of growing height $T$ with the function and the
metric independent of the coordinate $t$. When $T\to+\infty$
the gradient trajectories of $F_T$ with respect to $G_T$  split  in
a  sense, similar to  the one explained in Step 2,
\footnote{See
	also the discussion of  a similar phenomenon for the
	moduli spaces of holomorphic curves   in Section \ref{sec:compact}
	above.} into a ''broken trajectory"
$(\d'',\d')$, where $\d'$  (resp.  $\d"$) is a   trajectory of $\nabla_{G'}F'$
( resp. $\nabla_{G''}F''$).  Consider the $1$-dimensional moduli  space $\Mc$ of
trajectories  of $\nabla_{G_T}F_T, T\in[0,\infty),$ connecting a
fixed
critical point  $c=c^2$ of $f_2$  with an arbitrary critical point
$c^0 $ of $f_0$  with $\ind c-\ind c^0=1$. Then the boundary of
$\Mc$ consists of
\begin{description}
	\item{ a) } all the trajectories of
	      $\nabla_{G_0}F_0=\nabla_G F$ connecting $c^0$ and $c$; they are
	      given by the expression $\Phi(c)$;
	\item{ b) } all the broken trajectories $(\d'',\d')$ described
	      above, such that $\d''$ begins at $c^0$ and ends  at a critical point
	      $c^1$ of $f^1$ which is, necessarily, of the same Morse index as
	      $c^0$ and $c^2$, $\d'$ begins at $c^1$ and ends at
	      $c$; these broken trajectories are described by the
	      expression
	      $\Phi_{F',G'}\big(\Phi_{F'',G''}(c)\big)$;
	\item{ c) } broken trajectories defined according to Step 2 for the
	      $1$-dimensional family $F_T, T\in[0,\infty)$; they are described
	      by the expression $K(d_0(c))+d_2( K(c))$ for some homomorphism
	      $K:C(f_2,g_2)\to C(f_0,g_0)$.
\end{description}
Thus the sum (taken with appropriate signs) of the three
expressions defined in a)--c)  equals $0$, and thus we get
\begin{equation*}
	\Phi_{F',G'}\big(\Phi_{F'',G''}(c)\big)-\Phi(c )=K\circ d_0(c)+d_2\circ
	K(c),
\end{equation*}
i.e. the homomorphisms $\Phi$ and
$\Phi_{F',G'}\circ\Phi_{F'',G''}$ are chain homotopic, which
yields formula (\ref{eq:Morse-composition}).

We can finish now the proof that the homology group  $H_*(C(f,g),d)$
is independent of the choice of $f$ and $g$ as follows.
Given two pairs   $(f_0,g_0)$ and  $(f_1,g_1)$ we
first take any homotopy $(F,G)$  connecting  $(f_0,g_0)$ with  $(f_1,g_1)$, and also take  the
inverse homotopy $(\overline F,\overline G)$ connecting  $(f_1,g_1)$ with
$(f_0,g_0)$.
The composition $(\wt F,\wt G)$ of  the  homotopies $(F,G)$ and  $(\overline F,\overline G)$
connects  the pair $(f_0,g_0)$ with itself. According to Step 3
we have
$(\Phi_{\wt F,\wt G})_*=(\Phi_{F,G})_*\circ(\Phi_{\overline
		F,\overline
		G})_*$. On the other hand, we have  shown in Step 3  that the
homomorphism $(\Phi_{\wt F,\wt G})_*$ is independent of the
choice of a homotopy, connecting $(f_0,g_0)$ with itself, and
hence it equals the identity. Therefore, we conclude that $(\Phi_{F,G})_*$ is
surjective, while $ (\Phi_{\overline
		F,\overline
		G})_*$ is injective. Taking the composition of homotopies  $(\overline F,\overline G)$
and $(F,G)$ in the opposite order we prove that both
homomorphisms are bijective.
\bigskip

A. Floer  discovered  that the
finite-dimensional scheme  which we explained  in this section  works,
modulo some
analytic  complications, for several geometrically interesting functional on infinite-dimensional
spaces. For instance,
in the  symplectic Floer homology theory one deals with
critical points of the action functional. Its critical points are periodic orbits of
a Hamiltonian system, while for an appropriate choice of
a metric  and an almost complex structure the  gradient trajectories    can be interpreted
as holomorphic
cylinders   which connect these trajectories.
The role of broken trajectories is played here  by split holomorphic cylinders,
and    finite-dimensional  compactness theorems are replaced by  the  highly
non-trivial Gromov  compactness theorem for holomorphic curves.

In the  rest of this section we explore  the  Floer-theoretic approach for
the problem of defining invariants of contact manifolds. We will see that this approach
works only  in a very special and restrictive   situation. However, the  general
algebraic formalism of SFT, though quite different, has  a distinctive flavor    of
a Floer homology theory.



\subsubsection{Floer homology for the Action functional}
Let us make an attempt to define invariants of contact manifolds
in the spirit of Floer homology theory. Let $(V,\xi)$     be a contact manifold
with a fixed contact form $\alpha$ and an  almost complex structure
$J:\xi\to\xi$,   compatible
with the symplectic form $d\alpha|_\xi$.  Then $J$ and $d\alpha$
define a Riemannian metric on the vector bundle $\xi$
by the formula $g(X,Y)=d\alpha(X,JY)$ for any vectors $X,Y\in\xi$.
We extend $g$ to the whole tangent bundle $T(V)$ by declaring the vector field $R_\alpha$ to be the unit normal
field to $\xi$.  Consider the free loop space
$$\Lambda(V)=\{u:S^1=\R/\Z\to V\},$$
and define the {\it action functional}
\begin{equation}
	S:\Lambda(V)\to\R\quad\hbox{  by the formula}\quad
	S(\g) =\int\limits_\gamma \alpha .
\end{equation}
The least action principle tells us that the critical points of the functional $S$
are, up to parameterization,   the
periodic orbits of the Reeb field $R_\a$.


The metric $g$ on $T(V)$ defines a        metric on $\Lambda(V)$
and thus allows us to consider
gradient trajectories of the action functional connecting critical points of $V$.
The gradient direction $\nabla S(u)$, $u\in \Lambda(V)$, is given
by the vector field $J\pi( \frac{du}{dt})$, where $\pi:T(V)\to\xi$
is the projection along the Reeb direction, so that a gradient
trajectory $u(t,s),\,t\in\R/\Z,s\in\R,$ is given by the equation
\begin{equation}\label{eq:CR}
	\frac{\partial u}{\partial s}(t,s)=J\pi\big(\frac{\partial u}{\partial
			t}(t,s)\big)\,.
\end{equation}
Equation (\ref{eq:CR}) has a flavor of a Cauchy-Riemann equation.
We want to modify it into a genuine one.
Namely, consider the Cauchy-Riemann equation
\begin{equation*}
	\frac{\partial U}{\partial t}(t,s)=J\frac{\partial U}{\partial
		s}(t,s)
\end{equation*}
for $U(s,t)=   \big(u(s,t),\varphi(s,t)\big)\in V\times\R$.
It  can be rewritten
as a system
\begin{equation}\begin{split}\label{eq:CR2}
		\frac{\partial u}{\partial s}(t,s)       & =J\pi\big(\frac{\partial u}{\partial
		t}(t,s)\big)+\frac{\partial \varphi}{\partial t}(t,s)R_\a(u(t,s)                \\
		\frac{\partial \varphi}{\partial s}(s,t) & =-\big\langle\frac{\partial
		u}{\partial t}(t,s),R_\a(u(t,s))\big\rangle\,.                                  \\
	\end{split}
\end{equation}
Notice that $dS(\nabla S+\psi R_\a)\geq 0$ for any function $\psi(t,s)$.
Hence,
the first
equation of the system (\ref{eq:CR2})  can be viewed as the flow equation of the
gradient-like vector-field $\nabla S+\frac{\partial \varphi}{\partial
		t} R_\a$. Trajectories  of  this gradient like field   connecting critical points
$\gamma^-,\gamma^+$ of the action functional   correspond to
elements
of the moduli space  $\Mc_0(\gamma^-,\gamma^+;W,J)$, and
therefore the Floer homology philosophy (\cite{Floer}),
which we described above in the finite-dimensional
case, suggests the following construction.





Let us associate a variable $q_\gamma$ with every periodic orbit $\gamma\in\Pc_\a$
and assign to it the grading $$\deg{ q_\gamma}=\CZ(\gamma)+(n-3).$$
The choice of the   constant $n-3$ is not important
for purposes of this definition, but
it will become important for generalizations considered in the second
part of this paper.

Let  $A$ be  the group algebra $ \C\,[H_2(V)]$. We will fix a basis
$A_1,\dots, A_N$ of $H_2(V;\C\,)$ and identify each homology class $\sum d_iA_i$ with its {\it degree}
$d=(d_1,\dots, d_N)$. Thus  we can view the algebra $A$ as
the  algebra of  Laurent polynomials
of $N$ variables $z_1,\dots,z_N$ with complex coefficients, and write its elements
in the form $\sum a_dz^d,$ where $z^d=z_1^{d_1}\cdots
	z_N^{d_N}$. The variables $z_i$ are also considered graded,
$\deg\,z_i=-2c_1(A_i),\,i=1,\dots,N$.
Consider a complex $\fF$ generated by the (infinitely many) graded variables $q_\gamma$ with coefficients
in the graded algebra $A$,
and define  a differential $\partial: \fF\to\fF $ by the formula:
\begin{equation} \label{eq:Floer1}
	\partial q_\gamma= \sum\limits_{\g',d}\frac{n_{\gamma,\gamma',d}}{\kappa_{\g'}}z^d  q_{\gamma'},
\end{equation}
where $\kappa_{\gamma'}$ denotes the multiplicity of the orbit
$\gamma'$,
the sum is taken over all trajectories
$\g'\in\Pc_\a $ and $d=(d_1,\dots,d_N)$ with $$\CZ(\g')=\CZ(\g)+2\langle
	c_1,d\rangle-1,$$
and the coefficient $n_{\gamma,\gamma',d}$ counts
the algebraic number of components of the $0$-dimensional moduli space
$\Mc^d_0(\gamma',\gamma;W,J)/\R
$.\footnote{
	Let us recall that  according to our definition of the moduli
	space $\Mc^d_0(\gamma',\gamma;W,J)/\R
	$ the coefficient $n_{\gamma,\gamma',d}$ counts
	equivalence classes of holomorphic curves {\it with asymptotic
			markers}, and hence     each holomorphic cylinder connecting $\g$ and
	$\g'$ is counted $\kappa_\g\kappa_{\g'}$ times, unless the
	cylinder itself is
	multiply covered. The role of the denominators $\kappa_{\g'}$
	in formula (\ref{eq:Floer1}), as well in a similar
	formula (\ref{eq:Floer2}) below, is to correct this ``over-counting". }
Notice that the Liouville flow of the vector field  $\frac{\partial}{\partial t}$
defines  a $\R$-action on
the moduli spaces    $\Mc^d_0(\gamma',\gamma;W,J)$, which makes the
$1$-dimensional components of the moduli
spaces
canonically oriented.
Comparing this orientation
with the coherent orientation we produce  signs   which we use in the formula
(\ref{eq:Floer1}).

To simplify the  assumptions in the propositions which we formulate below
we will  assume for the rest of this section that $c_1|_{\pi_2(V)}=0$.
This assumption allows us to define for any
contractible periodic orbit $\g$ the Conley-Zehnder index
$\CZ_{\disk}(\g)$ computed with respect to {\it any disk}
$\Delta$ spanned by $\g$ in $V$. We denote
$\deg_{\disk}(\g)=\CZ_{\disk}(\g)+n-3$.

\begin{proposition}\label{prop:Floer1}
	If for a  contact form $\alpha$ the Reeb
	field $R_\alpha$ has no contractible periodic orbits $\g\in\Pc_\a$  with
	$\deg_{\disk}(\g)=1$, then
	$\partial^2=0$.
\end{proposition}

{\sl Sketch of the proof}. Similarly to the finite-dimensional
case considered in Section \ref{sec:Morse} above the identity
$\partial^2=0$ in Floer homology  is equivalent to the fact that
the codimension $1$ stratum of the compactified moduli spaces
$\Mc^d_0(\gamma',\gamma)$   consists of broken
trajectories, which in our case are represented by the height $2$
stable curves $(f_1,f_2)$, $f_1\in\Mc^{d'}_0(\gamma',\gamma'')/\R$, $f_2\in
	\Mc^{d''}_0(\gamma'',\gamma)/\R$, where $d=d'+d''$. However, in  the general case a sequence of
holomorphic cylinders in $\Mc^d_0(\gamma',\gamma)$ can split into curves
different from cylinders, as it is stated in Proposition \ref{prop:boundary} and  Corollary
\ref{cor:pos-puncture}. But
if this happens then the  first-floor curve
$f_1$ must have  a component which is conformally equivalent to $\C\,$ and
asymptotically cylindrical over a  contractible orbit at
$+\infty$. Moreover, if $(f_1,f_2)$ belongs to a top-dimensional
stratum of the boundary of the moduli space
$\Mc^d_0(\gamma',\gamma)$, then $\deg_{\disk}(\g)=1$, which
contradicts our assumption.

\begin{remark}\label{rem:bad-orbits1}{\rm
		Let us recall that we excluded from $\Pc$ certain ``bad" periodic
		orbits (see  the footnote in Section \ref{sec:dynamics}).
		However on the boundary of the moduli space
		$\Mc^d_0(\gamma',\gamma)$  there could be a stratum
		which consists of height $2$
		stable curves $(f_1,f_2)$, $f_1\in\Mc^{d'}_0(\gamma',\gamma'')$, $f_2\in
			\Mc^{d''}_0(\gamma'',\gamma')$, where the orbit $\gamma''$ is
		one of  the bad orbits which we excluded from $\Pc$. The
		orbit $\g''$ has even multiplicity $2k$, and hence on the boundary
		of   $\Mc^d_0(\gamma',\gamma)$ there are $2k$ strata which
		correspond
		to
		$2k$ different possible positions of the asymptotic marker at
		the punctures mapped to $\g''$. The Poincar\'e return map of the Reeb flow
		along the orbit $\g''$ has an odd number of eigenvalues in the interval $(-1,0)$,
		and hence  according to Lemma \ref{lm:bad-orbits}  the coherent orientation
		will automatically assign to these orbits opposite signs, which means that these strata
		will not contribute to the sum  (\ref{eq:Floer1}). This explains why the exclusion of bad orbits
		is {\em possible}. Remark \ref{rem:bad-orbits2} below explains why this
		exclusion is {\em necessary}.}
\end{remark}

Now we follow Steps 1--3 in Section \ref{sec:Morse} above to show the independence
of   the homology group   $$\oplus H_k(\fF ,\partial )= \Ker\partial /{\mathrm {Im}}\partial, $$
graded by the degree $k$,  of the choice of
a  nice contact form $\a$ and  a compatible almost complex
structure  $J$.

Suppose now that we have a  directed symplectic cobordism
$W=\ora{V^-V^+}$,  and $J$  is a compatible almost complex structure on $W$.
Suppose that the inclusions $V^\pm\hookrightarrow W$ induce
isomorphisms on $2$-dimensional homology.  Then we can define
a homomorphism $\Phi=\Phi_W:\fF^+\to\fF^-$ by the formula
\begin{equation}\label{eq:Floer2}
	\Phi( q_\gamma)= \sum\limits_{\g',d} \frac{1}{\kappa_{\gamma' }}n_{\gamma,\gamma',d}z^dq_{\gamma'},
\end{equation}
where the sum is taken over all trajectories $\g'\in\Pc^- $  and $d$
with
$\CZ(\g')=\CZ(\g)+2\langle c_1,d\rangle$, and
the coefficient $n_{\gamma,\gamma',d}$ counts
the algebraic number of points of the compact $0$-dimensional moduli space $\Mc^d_0(\gamma',\gamma;W,J)
$.
If the   condition on the second homology is not satisfied then the above construction
gives us only a correspondence, rather than
a homomorphism. See Section \ref{sec:composition}  for the discussion of a
more general case.

\begin{proposition}\label{prop:Floer2}
	Suppose that the contact forms   $\a^\pm$ associated to the
	ends satisfy the condition  $\deg_{\disk}(\g)\neq 0,1$ for any {\em contractible in $W$} periodic orbit
	$\g\in\Pc^\pm$. Then the homomorphism $\Phi_W$ commutes
	with $\partial $.
\end{proposition}
\begin{proposition}\label{prop:Floer3}
	Let $J_t,t\in[0,1] $, be a family of  almost complex structures compatible with
	the directed symplectic cobordism
	$W=\ora{V^-V^+}$. Suppose  that the forms   $\a^\pm$ associated to the
	ends satisfies the condition  $\deg_{\disk}(\g)\neq -1,0,1$ for any  {\em contractible in $W$} periodic orbit
	$\g\in\Pc^\pm$. Then the  homomorphisms
	$\Phi_0=\Phi_{W,J_0}$ and  $\Phi_1=\Phi_{W,J_1}$  are chain
	homotopic, i.e there exists a homomorphism $\Delta:\fF^+\to\fF^-$
	such that $\Phi_1-\Phi_0=\partial \Delta +\Delta\partial$.
\end{proposition}
\begin{proposition}\label{prop:Floer4}
	Given two cobordisms $W_1$ and $W_2$, and a compatible almost complex structure
	$J$ on the composition $W_1\circledcirc W_2$, the homomorphism
	$\Phi_{W_1\circledcirc W_2}$ is chain-homotopic to
	$\Phi_{W_1}\circ\Phi_{W_2}$.
\end{proposition}

Together with an obvious remark that for the cylindrical cobordism   $W_0$
the homomorphism $\Phi_{W_0}$ is the identity,
Propositions \ref{prop:Floer1}--\ref{prop:Floer3}
imply that if a contact structure $\xi$ on $V$ admits a {\it
		nice} contact form, i.e. a form without contractible periodic
orbits of index $-1,0$ and $1$, then the {\it contact homology
		group}
$$\oplus HC_k(V,\xi)=\oplus H_k(\fF ,\partial ) $$
is well defined and
independent of the choice of
a  nice contact form and  a compatible almost complex
structure
(however, if $H_2(V)\neq 0$ and/or $H_1(V)\neq0$ it depends on a
choice of spanning surfaces $F_\g$ and the  framing of the bundle
$\xi$ over basic loops).
Similarly to what was explained in the sketch of
the proof  Proposition
\ref{prop:Floer1} the  ``niceness" assumptions   guarantees
that the  top codimension strata   on the boundary of the involved
moduli spaces consist of height 2 cylindrical curves,
and thus         the proofs of Propositions  \ref{prop:Floer2}--\ref{prop:Floer4}
may precisely follow the standard scheme of the Floer
theory (see \cite{Floer, Salamon:Floer}).
\begin{remark}\label{rem:bad-orbits2}{\rm
		Similarly to what we explained in Remark \ref{rem:bad-orbits1} the
		coefficient $n_{\g,\g'}$ in the definition (\ref{eq:Floer2}) of
		$\Phi$ equals $0$ if at least one of the orbits $\g,\g'$ is ``bad''.
		Hence, in the presence of ``bad" orbits the
		homomorphism $\Phi$  could never be  equal to the  identity, even
		for the cylindrical cobordism. This explains why
		the exclusion of ``bad" periodic orbits is {\em necessary}.}
\end{remark}




Besides the degree (or Conley-Zehnder)  grading,
the contact homology group is graded by elements of $H_1(V)$, because
the boundary operator preserves the homology class of a periodic orbit.  We will denote the part of  $HC_*(V,\xi)$
which correspond to a class $a\in H_1(V)$ by $HC_*(V,\xi|a)$.
One can  similarly construct a contact homology group
$HC^{\contr}_*(V,\xi)$,
generated  only by contractible periodic orbits,  which is another invariant
of
the contact manifold $(V,\xi)$.

Contact structures which admit nice contact forms do exist, as it
is
illustrated by examples in Section \ref{ex:Floer}  below. However, the
condition of existence of a nice form is too restrictive. The
general case leads to an algebraic formalism developed in
Sections \ref{sec:af-contact}--\ref{sec:composition} below.

\subsubsection{Examples}\label{ex:Floer}



\noindent 1. \textsf { Contact homology of the standard contact sphere $S^{2n-1}$.}

Take the $1$-form $\alpha=\frac 12\sum (x_idy_i-y_idx_i)$,
which is a primitive of the standard symplectic structure
in $\R^{2n}$. Its restriction  to a generic  ellipsoid
$$S=\{\sum\frac{x_i^2+y_i^2}{a_i^2}=1\}$$ is a  nice contact form for the standard contact structure
$\xi$ on the sphere $S=S^{2n-1}$. The form $\alpha|_S$ has
precisely one periodic orbit for each  Conley-Zehnder index
$n +2i-1$ for $i=1,\dots,$. Hence the  contact homology group
$HC_*(S,\xi)$ has one generator in each  dimension $2i, i\geq n-1$.
See also the discussion in Section \ref{sec:Bott} below.
\medskip

\noindent 2. \textsf{ Contact homology of Brieskorn spheres.}

Ilya Ustilovsky  computed (\cite{Ustilovsky}) the
contact homology of certain Brieskorn spheres.

Let us  consider the Brieskorn manifold
\begin{equation*}
	\Sigma(p,\underbrace{2,\dots,2}_n)=
	\{z_0^p+\sum\limits_1^n  z_j^2=0\}\cap \{\sum\limits_0^n|z_j|^2=1\}\subset \C^{n+1}.
\end{equation*}
$\Sigma(p,\underbrace{2,\dots,2}_n)$ carries a
canonical contact structure  as a strictly pseudo-convex hypersurface in a complex manifold.

Suppose that $n=2m+1$ is odd, and $p\equiv 1\,\mod\,8.$
Under this assumption  $\Sigma(p,\underbrace{2,\dots,2}_n)$
is diffeomorphic to $S^{2n-1}$ (see \cite{Brieskorn}).
However, the following theorem of Ustilovsky implies that     the contact structures on
Brieskorn spheres
$\Sigma(p,\underbrace{2,\dots,2}_n)$ and $\Sigma(p',\underbrace{2,\dots,2}_n)$ are not isomorphic, unless $p=p'$.
This result should be confronted with a computation of Morita
(\cite{Morita} ), which implies
that  the formal homotopy class (see Section \ref{sec:prelim} above) of the contact structure on $\Sigma(p,\underbrace{2,\dots,2}_n)$
is   standard, provided $p\equiv 1\,\mod\, 2(2m!)$. Hence, Ustilovsky's theorem provides infinitely many non-isomorphic contact
structures on $S^{4m+1}$ in the standard formal homotopy class.

\begin{theorem} {\rm (I. Ustilovsky, \cite{Ustilovsky})}
	The contact homology $$HC_*\left(\Sigma(p,\underbrace{2,\dots,2}_n)\right)$$ is defined, and
	the dimension  $$c_k=\dim\,HC_k\left( \Sigma(p,\underbrace{2,\dots,2}_n)\right) $$
	is given by the formula
	\begin{equation*}
		c_k  =
		\begin{cases}
			0, & k \;\;\hbox {is odd or}\;\;k<2n-4,                            \\
			2, & k=2\left[ \frac{2N}{p}\right] +2(N+1)(n-2),\;\hbox{for  }\;\;
			N\geq 1,\,2N+1\notin p\Z,                                          \\
			1, & \hbox{in all other cases.}                                    \\
		\end{cases}
	\end{equation*}
\end{theorem}

\medskip

\noindent 3. \textsf{ Contact homology of boundaries
	of subcritical Stein manifolds.}

A co-oriented contact manifold $(V,\xi)$ is called Stein-fillable if it can be realized as a strictly pseudoconvex
boundary of a complex manifold $W$,
whose interior is Stein, and if the co-oriented contact structure $\xi$ coincides with the canonical contact structure
of a strictly pseudo-convex hypersurface.   We say that $(V,\xi)$ admits a
subcritical Stein filling if the corresponding Stein manifold $\Int W$ admits an exhausting plurisubharmonic function
without critical points of dimension $\dim_\C(W)$. If $\dim V>3$ then one can equivalently require
that $W$ deformation  retracts to   a CW-complex of dimension $<\dim_\C W$ (see \cite{Eliash-Stein}).

Mei-Lin Yau studied in her  PhD thesis \cite{MLYau} contact homology of contact manifolds
admitting a subcritical Stein filling.
Here is her result.
\begin{theorem}\label{prop:MLYau} {\rm (Mei-Lin Yau,  \cite{MLYau})}
	Let $(V,\xi)$ be a  contact manifold of dimension $2n-1$ which admits a subcritical Stein filling $W$.
	Suppose that $c_1(V)=0$ and $H_1(V)=0$. Let $c_1,\dots, c_k$ be generators of $H_*(W)$.
	Then  the contact homology $HC_*(V)$ is defined  and generated
	by elements
	$ q_{i,j}$ of  degree $\deg q_{i,j}= 2(n+i-2)-\dim c_j$, where  $j=1,\dots, k$, and
	$i\geq 1$.
\end{theorem}

\medskip

\noindent 4. \textsf{ Contact homology of $T^3$ and its coverings.}
\medskip

Set $\a_n=\cos 2\pi nz\,dx+\sin 2\pi nz\,dy$. This contact form descend
to the $3$-torus $T^3=\R^3/\Z^3$ and defines there a contact structure $\xi_n$.
The structure $\xi_1$ is  just the canonical contact structure on $T^3$ as the space
of co-oriented contact elements of $T^2$. The form  $\a_n$ for $n>1$  is
equal to the pull-back $\pi^*_n (\a_1)$, where $\pi_n:T^3\to T^3$
is the covering
$(x,y,z)\mapsto(x,y,nz)$. Notice that all structures $\xi_n$
are homotopic as plane field to the foliation $dz=0$.

\begin{theorem}\label{thm:T3}
	The contact homology group $HC_*(T^3,\xi_n|w)$, where $w$ is the homology class $(p,q,0)\in H_1(T^3)$,
	is isomorphic to $\Z^{2n}$.
\end{theorem}
In particular we get as a corollary a theorem of E. Giroux:
\begin{corollary} {\rm (E.  Giroux, \cite{Giroux})}
	The contact structures $\xi_n$, $n=1,\dots,$ are pairwise non-isomorphic.
\end{corollary}

The contact manifold $(T^3, \xi_1)$
is foliated by pre-Lagrangian
tori $L_{p,q}$, indexed by simple homology classes $ (p,q)\in H_1(T^2)$. Each torus
$L_{p,q}$ is foliated by  the $S^1$-family of lifts of
closed geodesics which represent the class $(p,q)$.
Thus for any given $ (p,q)\in H_1(T^2)$ (even when  $(p,q)$ have common divisors)
the set of closed orbits
in  $\Pc_{\a_1}$ which represent the class $(p,q,0)\in H_1(T^3)$
is  a circle $S_{p,q}$, and for any $n\geq 1$ the set of closed orbits
in  $\Pc_{\a_n}$ which represent the class $(p,q,0)\in H_1(T^3)$
consists of $n$ copies $S^1_{p,q},\dots,  S^n_{p,q}$ of such circles.
The forms $\a_n$ have no contractible periodic orbits, but of course, they
are degenerate. To compute the contact homology groups, one can   either work directly with these
degenerate forms, as it is explained in Section \ref{sec:Bott} below, and
show that  $HC_*(T^3,\xi_n|w)=H_*(\bigcup\limits_1^n S^i_{p,q})=\Z^{2n}$, or  first  perturb the form $\alpha_1$,
and respectively all its covering forms $\a_n= \pi_n^*(\a_1)$, in order to substitute each circle $S^i_{p,q}$
by two non-degenerate periodic orbits, and then show that the orbits from  each of these pairs  are connected by precisely
two holomorphic cylinders, which cancel each other in the formula for the boundary operator $\partial$.


\subsubsection {Relative contact homology and contact non-squeezing theorems}
\label{sec:squeezing}
Let us observe that  the  complex $(\fF,\partial)$  is filtrated
by the values of the action  functional $S$, $\fF=\mathop{\bigcup}\limits_{a\in\R}\fF^a$, where
the complex $\fF^a$
is generated  by variables $q_\gamma$ with $S(\g)\leq a$. The differential
$\partial$ respects this filtration, and hence descends to $\fF^b/\fF^a, a<b$.
Hence, one can define  the homology
$H_*^{(a,b]}(\fF,\partial)=H_*(\fF^b/\fF^a,\partial)$ in the window $(a,b]\subset\R$. Of
course, $H_*^{(a,b]}$ depends on a choice of a particular nice form
$\alpha$. If $\alpha>\beta$ then we  have a map $\Phi_*:H_*^{(a,b]}(\fF,\partial;\alpha)\to
	H_*^{(a,b]}(\fF,\partial;\beta)$. We write $H^a$ instead of $H^{(-\infty,a]}$.

Consider now a contact manifold $(V,\xi)$ which is
either closed, or satisfies
the following
	{\it pseudo-convexity}  condition at infinity.
A contact manifold $(V,\xi=\{\a=0\})$  with a fixed contact form $a$
is called pseudo-convex at infinity
if there exists a compatible almost complex structure
$J$ on the symplectization $V\times\R$ for which $V$ can be exhausted
by compact domains $V_i$ with smooth  pseudo-convex
boundary. A sufficient condition for pseudo-convexity is existence of
an exhaustion $V=\bigcup V_i$, such that for each $i=1,\dots, $
trajectories of the Reeb field
$R_\a|_{V_i}$ do not have interior tangency points with $\partial  V_i$.  For instance, for
the standard contact form  $\a=dz-\sum y_idx_i$
on $\R^{2n+1}$ the latter condition is satisfied for an exhaustion of $\R^{2n+1}$
by round balls, and  ence the standard contact form on $\R^{2n+1}$ is pseudo-convex at
infinity.




Our goal is to define  a relative contact homology group $HC_*(V,U,\xi)$
for a relatively compact open subset
$U\subset V$, so that  this group would be invariant    under a contact isotopy of $U$ in $V$.

Let us fix a contact form $\alpha$ on $V$  which satisfies the above pseudo-convexity
condition.
Let us denote by $\Fc_{U,\a}$ the set of  $C^\infty$-functions $f:V\to[0,\infty)$
which  are $\leq 1$ on   $U$,   and for which  the contact form
$f\alpha$ is nice and pseudo-convex at infinity.\footnote{ Of course, the set
	$\Fc_{U,\a}$ may be
	empty, because the niceness condition is very restrictive.
	In this case one needs to employ
	a more general construction from Section \ref{sec:3algebras}.}
Take a strictly increasing sequence
of functions
$f_i\in \Fc_{U,\a}$, such that
\begin{description}
	\item{a)}
	      $\max\limits_K f_i \mathop{\to}\limits_{i\to\infty}\infty$ for   each compact
	      set $K\subset (V\setminus
		      \overline{U})$;
	\item{b)} $f_i|_U \mathop{\to}\limits_{i\to\infty} 1$ uniformly on
	      compact sets.
\end{description}

\begin{proposition}\label{prop:rel-homol}
	The limit
	\begin{equation}
		HC_*(V,U,\xi)=\lim\limits_{a\to+\infty}
		\lim\limits_{\leftarrow}HC^a_*(V,f_i\alpha)
	\end{equation}
	is independent of $\alpha$,
	and
	thus it is  an invariant of  the contact pair $(V,U)$.
	A contact isotopy  $f_t:V\to V$ induces a  family of
	isomorphisms $(f_t)_*:H_*(V,U)\to H_*(V, f_t(U))$.
	An inclusion $i:U_1\mapsto U_2$ induces a homomorphism
	\begin{equation*}
		i_*: HC_*(V,U_1,\xi)\to HC_*(V,U_2,\xi).
	\end{equation*}
\end{proposition}



\bigskip

One of the most celebrated results in Symplectic topology is
Gromov's non-squeezing theorem which  states that one cannot
symplectically embed a  $2n$-ball of radius $1$ into
$\D^2_r\times\R^{2n-2}$ for $r<1$. Here $D^2_r$ denotes a
$2$-disk of radius $r$ and $\D^2_r\times\R^{2n-2}$ is endowed
with the product of standard symplectic structures.
Because of the conformal character of contact geometry one
cannot expect as strong non-squeezing results
for
contact manifolds: one can embed any domain in the standard
$\R^{2n-1}$ in an arbitrary small ball. However, it turns out
that it is not always possible  to realize a contact squeezing via a contact
isotopy inside a manifold with  a non-trivial first Betti number.

As an example, consider the $1$-jet bundle $$V=J^1(\R^n,S^1)=T^*(\R^n)\times S^1$$
of
$S^1$-valued functions with its standard contact structure $\xi$,
given by the contact form $\alpha=dz-\sum y_idx_i$, $(x,y)\in
	\R^{2n}=T^*(\R^{n}),\, z\in S^1 =\R/\Z$.
The contact form $\alpha$ satisfies the condition
of  pseudo-convexity   at infinity
and it is nice: the Reeb field equals $\frac{\partial}{\partial z}$,
and thus it has no contractible periodic orbits.
Let us consider the class $\cN$ of domains $\Omega\subset V$
which are images of the split domains $U\times S^1\subset V$
under a contact isotopy of $V$, where $U$ is connected.
For any $\Omega\in\cN$ the relative contact  homology
group $HC_*(V,\Omega)$ is  well defined
because   for any function $f:\R^{2n}\to\R$
the form $f(x,y)\alpha$ is nice.

Let us denote by $\cE_r(\Omega)$, $\Omega\in\cN$,
the space of contact embeddings $ D_r\times S^1\to
	\Omega\times   S^1$, contact
isotopic in $V$  to the inclusion
$$D_r\times S^1\hookrightarrow \R^{2n}\times S^1=V\,.$$
Notice, that for any two embeddings $f,g\in\cE_r(\Omega)$
there exists  a positive $\rho\leq r$, such that the
restrictions
$f|_{D_\rho\times S^1}$ and $g|_{D_\rho\times S^1}$
are isotopic       via a {\it contact} isotopy.



Given a  contact embedding $f\in\cE_r(\Omega)$
there is defined a homomorphism
\begin{equation*}
	f_*: HC_*(V,D_r\times S^1,\xi)\to HC_*(V,\Omega,\xi)\,.
\end{equation*}
Let us choose a
symplectic trivialization
of the contact bundle $\xi$ induced by the projection
$V\to\R^{2n}$. We will assume that indices of periodic orbits,
and hence the grading of contact homology groups,
are associated with this trivialization.

For each homology class $k\in \Z=H_1(D_r\times S^1)$ let us
consider the maximal $l=l(f,k)$ such that
$$\Ker\big( f_*|_{HC_l(V,D_r\times S^1,\xi|k)}\}\neq 0 ,,$$
and define an invariant $w_{\cont}(V,\Omega)$, called
the relative {\it
		contact width} by the formula
\begin{equation}
	w_{\cont}(V,\Omega)=\sup \limits_{k,r>0,f\in
		\cE_r(U)}\frac{2 k}{l(f,k)}\;.
\end{equation}


S.-S. Kim has computed $w_{\cont}(V,\Omega)$ for
certain domains $\Omega$. In particular,
she proved
\begin{proposition}\label{prop:Kim}
	\begin{eqnarray*}
		w_{\cont}(V,D^{2n}_r\times S^1)= \pi r^2;  \\
		w_{\cont}(V,D^2_r\times D^{2n-2}_R\times S^1) =\pi r^2,
	\end{eqnarray*}
	if $R\geq r$.
\end{proposition}
The contact width is clearly a monotone invariant, i.e.
$$ w_{\cont}(V,U_1\times S^1)\leq w_\cont(V,U_2\times S^1)$$
if $U_1\subset U_2$. Hence Proposition \ref{prop:Kim} implies

\begin{corollary}\label{cor:non-squeezing}
	Suppose that $r<\min(r',R).$ Then there is no  contact isotopy
	$f_t:D^{2n}_{r'}\times S^1\to V$ such that $f_0$
	is the inclusion, and
	$$f_1( D^{2n}_{r'}\times S^1)\subset D^2_{r}\times D_R^{2n-2}\times S^1 .$$
\end{corollary}




\begin{problem}  Suppose there exists a contact isotopy
$f_t:V=\R^{2n}\times S^1\to V$ with
$f_0=\Id$ and $f_1(U_1\times S^1)\subset U_2\times S^1$. Does
there exist
a Hamiltonian isotopy $g_t:\R^{2n}\to\R^{2n}$ such that
$g_0=\Id$ and $g_1(U_1)\subset U_2$?
\end{problem}
Notice that the converse is obviously true.

\section{Algebraic formalism}\label{sec:algebraic}

\subsection{Informal introduction}\label{sec:informal}

The Floer-theoretic formalism described in Section \ref{sec:Floer}
is applicable only to a very limited class
of contact manifolds. As it follows from Theorem \ref{thm:comp1}
the boundary of the moduli space   of holomorphic cylinders in the
symplectization may   consist of stable curves, different from broken
cylinders; for instance,  it may contain    height 2 stable curves
which consist  of a pair of pants on the upper level, and a copy
of $\C$ plus a trivial cylinder at the bottom one. Hence the
minimal class of holomorphic curves
in symplectizations which
has the property that the  stable curves  of height $>1$ on the boundary
of the corresponding moduli space  are made of curves from the same class,
must contain all  rational curves with one positive   and an arbitrary
number of  negative punctures.
The counting of curves  with one positive and arbitrary number of negative punctures
can still be interpreted as a differential, but this time defined
not on the {\it vector space} generated by    periodic trajectories but on the   graded {\it algebra}
which they
generate. Thus
this  leads to a straightforward generalization of the Floer type formalism considered
in    Section \ref{sec:Floer}
when instead of  the additive  Floer complex   $\fF$  generated by the
variables $q_\g$,
one considers a graded commutative algebra  $\fA$
generated by these variables, and when  instead of the  formula (\ref{eq:Floer1})
the differential  $\partial q_\g$ is defined
as a polynomial of  a higher degree, rather than a linear
expression as in the Floer homology case. Namely, we define
\begin{equation}\label{eq:d}
	\partial q_\g= \sum \frac{n_{\Gamma,I,d}}{k!\prod^k_1
		i_j!\kappa_{\g_j}^{i_j}}q_{\g_1}^{i_1}\dots q_{\g_k}^{i_k}z^d,
\end{equation}
where the sum is taken over all ordered
\footnote{The coefficient $\frac{1}{k!}$ is the price we pay
	for taking {\it ordered} sets of periodic orbits.} sets of
different periodic orbits $\Gamma=\{\g_1,\dots,\g_k\} $,   multi-indices
$d=(d_1,\dots, d_N)$ and $I=(i_1,\dots,i_k), i_j\geq 0, $
and where the coefficient $n_{\Gamma,I,d}$  counts
the algebraic number of elements of the moduli space
$$\Mc^d_0(\g; \underbrace{\g_1,\dots,\g_1}_{i_1},\dots,\underbrace{\g_k,\dots,\g_k}_{i_k})/\R,$$ if
this space is $0$-dimensional, and equals $0$ otherwise.
The differential $\partial$ extends to the algebra $\fF$ according
to the graded Leibnitz rule.
Roughly speaking, $\partial q_\g$ is a polynomial,
whose monomomials $q_{\g_1}\dots q_{\g_l}$ are in 1-1
correspondence with rigid, up to translation,   rational
holomorphic   curves with one positive  cylindrical end
over $\g$ and $l$ negative cylindrical ends over
trajectories $\g_1,\dots,\g_l$.


It turns out that the  quasi-isomorphism class
of the differential algebra $(\fA,\partial)$
is  independent of all extra choices (see Section \ref{sec:3algebras} below).
In particular, the {\it contact homology algebra} $ H_*(\fA,\partial)$
is an invariant of the contact manifold
$(M,\xi)$.

Having included into the picture the moduli spaces of rational
curves with one positive and several negative punctures, one may
wonder, what is the role of rational curves with an arbitrary
number of positive and negative punctures. One can try to
interpret the
counting of rational holomorphic curves with
fixed number of  positive and an arbitrary number of negative
punctures  as a sequence of bracket type  operations on the
algebra $\fA$. These operations  satisfy an infinite system of
indentities, which remind the formalism of homotopy Lie algebras.

However,  there is a more adequate algebraic formalism
for this picture. Let us associate   with  each periodic
orbit $\g$ two graded variables $p_\g$ and $q_\g$ of the
same parity (but   of
different integer grading, as we will see in Section
\ref{sec:correlators} below),
and consider an algebra $\fP$ of formal power series
$\sum f_\Gamma(q)p^\Gamma$, where $f_\Gamma(q)$
are polynomials of $q=\{q_\g\}$ with coefficients
in (a completion of) the group algebra  of $H_2(V)$.
It is useful to think about the algebra $\fP$ as the graded
Poisson
algebra of functions
on the     infinite-dimensional symplectic super-space $\bf{V}$ with the even
symplectic form $\sum\limits_{\g\in\Pc} {\kappa_\g}^{-1} dp_\g\wedge dq_\g$, or rather on
its formal analog along the $0$-section $\{p=\{p_\g\}=0\}$.
With each $0$-dimensional moduli space
$\Mc^d_0(\Gamma^-,\Gamma^+)/\R$, $$\Gamma^\pm=\{\underbrace{\g^\pm_1,\dots\g^\pm_1}_{i_1^\pm},\dots,\underbrace{\g^\pm_{s^\pm}\dots
		\g^\pm_{s^\pm}}_{i^\pm_{s^\pm}}\},$$
we associate a monomial
$$\frac{n_{\Gamma^-,\Gamma^+,d}}{s^-!s^+!(i_1^-)!\dots(i_{s^-}^-)!(i_1^+)!\dots(i_{s^+}^+)!}
	q_{\g^-}^{I^-}p_{\g^+}^{I^+}z^d,$$
where $q_{\g^-}^{I^-}=(q_{\g^-_{1}})^{i^-_{1}}\dots(q_{\g^-_{s^-}})^{i^-_{s^-}}$, $p_{\g^+}^{I^+}=(p_{\g^+_1})^{i^+_1}\cdots
	(p_{\g^+_{s^+}})^{i^+_{s^+}}$,  and $n_{\Gamma^-,\Gamma^+,d}$ is
the algebraic number of elements of the moduli
space     $\Mc^d_0(\Gamma^-,\Gamma^+)/\R$.

The sum of all these monomials over all $1$-dimensional moduli
spaces    $\Mc^d_0(\Gamma^-,\Gamma^+) $ for   all ordered sets
$\Gamma^-,\Gamma^+$ of periodic orbits
is  an {\it odd} element $\bh\in\fP$. All the operations on the
algebra $\fA$ which we mentioned above appear as the expansion
terms of $\bh$ with respect to $p$-variables. It turns out that
the   infinite system of  identities  for
operations on $\fA$, which we mentioned above, and which is
defined by counting holomorphic curves with  a
certain fixed number of positive punctures, can be encoded into a single
equation $\{\bh,\bh\}=0$. Then the differentiation with respect to
the Hamiltonian vector field, defined by the Hamiltonian $\bh$:
\begin{equation*}
	d^{\bh}(g)=\{\bh,g\},\;g\in\fP,
\end{equation*}
defines a differential $d=d^{\bh}:\fP\to\fP$, which satisfies the
equation $d^2=0$. Thus one can define the homology $H_*(\fP,d^{\bh})$
which inherits the structure of a graded Poisson algebra.


The identities, like  $d^2=0$ and $\partial^2=0$,
encode in algebraic terms information about the structure of the  top-dimensional strata on the boundary of
compactified moduli spaces of holomorphic curves,
as it is described in Proposition \ref{prop:boundary} above. For
instance, the codimension $1$ strata on the boundary of the moduli
space $\Mc^d_0(\Gamma^-,\Gamma^+)/\R$ consists of height two stable
rational curves $(f_1,f_2)$.  Each floor of
this curve  may be disconnected,
but  precisely one of its components differs from the straight cylinder.
Each   connected component of $f_1$  can be glued with a component of $f_1$ only
along one of their ends. One can easily see that the combinatorics  of  such gluing   precisely corresponds to
the Poisson bracket formalism and that the algebraic sum of the monomials associated to all
stable curves of height two equals $\{\bh,\bh\}$. On the other hand,
the algebraic number of such height 2 curves equals
$0$ because they form   the  boundary
of the a compactified  $1$-dimensional moduli space of holomorphic curves.
Hence we
get the identity $\{\bh,\bh\}=0$. The identity is
not tautological due to   the fact that $\bh$ is odd.   In view of the super-Jacobi identity
it is equivalent to the identity $(d^{\bh})^2=0$.


One can go further and include into the picture  moduli spaces of punctured holomorphic
curves
of higher genus.  Introducing a new variable, denoted $\hbar$, to keep track
of the genus, one can associate with each $0$-dimensional moduli
space
$\Mc^d_g(\Gamma^-,\Gamma^+)/\R$
a monomial  $$\frac{n_{\Gamma^-,\Gamma^+,d,g}}{s^-!s^+!(i_1^-)!\dots(i_{s^-}^-)!(i_1^+)!\dots(i_{s^+}^+)!}
	q_{\g^-}^{I^-}p_{\g^+}^{I^+}\hbar^{g-1}z^d,$$
and form a generating function $\bH=\hbar^{-1}\sum\limits_{g=0}^\infty\bH_g\hbar^{g}$
counting all rigid holomorphic curves of arbitrary
genus, whose term $\bH_0$ coincides with $\bh$.    Again,
the codimension $1$ strata of the boundary of the moduli spaces
$\Mc_g(\Gamma^-,\Gamma^+)$ consists of height 2 stable curves, but unlike the case of  rational
curves, two connected components
on different levels can be glued together along an arbitrary number of ends.
The combinatorics of such gluing
can be described by the formalism of algebra of higher order differential operators.
Fig. \ref{fig:combinatorics}
illustrates how the composition
of
differential operators can be interpreted via gluing of Riemann
surfaces with punctures. A letter $p_i$ in the picture represents a differential
operator
$\hbar\frac{\partial}{\partial q_i}$, and  a surface of genus $g$ with upper punctures
$p_{i_1},\dots,p_{i_k}$ and lower punctures $q_{j_1},\dots,q_{j_l}$ represents
a differential operator
$$\hbar^{g-1}q_{j_1}\dots q_{j_l}p_{i_1}\dots p_{i_k}=\hbar^{g-1}q_{j_1}\dots q_{j_l}
	\big(\hbar\frac{\partial}{\partial q_{i_1}}\big)
	\dots \big(\hbar\frac{\partial}{\partial q_{i_k}}\big).$$
Thus
we are led to consider $\bH$ as an element of the Weyl super-algebra
$\fW$. This algebra should be
viewed
as a quantization of the Poisson algebra $\fP$, so that the description of the boundary of the
moduli spaces is given by the equation $[\bH,\bH]=0$, where   $[\;,\;]$ denotes the commutator in $\fW$.
As in  the rational case, this  identity is equivalent
to the identity $D^2_{\bH}=0$  for the differential
$D^\bH(f)=[H,f]$.
Hence we can define the
homology algebra $H_*(\fW,D^{\bH})$, which   also turns out to be an invariant of the contact manifold
$(V,\xi)$. Similarly to the standard Gromov-Witten theory for closed
symplectic manifolds one can develop an even more general
formalism  by encoding in $\bH$ information about higher-dimensional moduli spaces
of holomorphic curves. This leads to a deformation of the differential
algebra $(\fW,D^{\bH})$ along the space of closed
forms on $V$. The corresponding family of homology algebras   is
then  parameterized by $H^*(V)$.


\begin{figure}
	\centerline{\psfig{figure=sf1.eps,height=170mm}} \caption{\small
		There are  four different way to glue the lower and upper surfaces
		on the picture along their matching ends, i.e. the ends denoted by $p$'s
		and $q$'s with the same index.  These 4 ways correspond to  4
		terms in the composition formula for differential operators:
		$(\hbar^{-1}p_1 p_2 p_3) \circ(\hbar^{-1}q_1 q_2 p_1)=p_1 p_3+
			\hbar^{-2} q_1 q_2 p_1^2 p_2 p_3 +
			\hbar^{-1}q_1 p_1^2 p_3+\hbar^{-1}q_2 p_1 p_2 p_3 \;.
		$  We  are ignoring here the sign issues and assuming all  the boundary components
		to be simple orbits.
	}
	\label{fig:combinatorics}
\end{figure}
After going that far it is natural to  make the above algebraic structure
for contact manifolds a part
of a formalism in the spirit of topological field theory, which we call
	{\it Symplectic Field Theory},
and which also includes the theory of Gromov-Witten invariants of closed manifolds.
To do that one considers moduli spaces of holomorphic curves with cylindrical ends
in directed symplectic cobordisms $W=\ora{V^-V^+}$. The generating function
counting rational holomorphic curves
in $W$ can be naturally written as a function  $\bff(q^-,p^+ )$ of $p^+$-variables
associated with the positive end $V^+$, and
$q^-$-variables associated with the negative end $V^-$ of the cobordism $W$.
It turns out that the Lagrangian submanifold
in $(-\mathbf{V}^-)\times\mathbf{V}^+$ generated by the function $\bff$
defines a {\it Lagrangian correspondence}
$  \mathbf{L}_W\subset(-\mathbf{V}^-)\times(\mathbf{V}^+) $
which transforms the Hamiltonian
functions $\bh^+$ and  $\bh^-$ to each other, i.e.
\begin{equation}\label{eq:HJ-informal}
	\left(\bh^-(p^-,q^-)-\bh^+(p^+,q^+)\right)|_{\mathbf{L}_W}=0,
\end{equation}
where
\begin{equation*}
	L_W=
	\begin{cases}
		q^+_{\g^+}= & \kappa_{\g^+}\frac{\partial \bff}{\partial p^+_{\g^+}}(q^-,p^+)); \\
		p^-_{\g^-}= & \kappa_{\g^-}\frac{\partial \bff}{\partial
		q^-_{\g^-}}(q^-,p^+)).                                                          \\
	\end{cases}
\end{equation*}
We recall that $\kappa_{\g^\pm}$ denotes the multiplicity of the orbit $\g^\pm$.

The composition of symplectic cobordisms produces
the composition of Lagrangian correspondences,
so that  if one  consider a ``Heegard splitting" of  a closed symplectic
manifold $W$ along a contact hypersurface $V$, then  the computation of Gromov-Witten invariants
of $W$ can be viewed
as a Lagrangian intersection problem in the   symplectic super-space
$\mathbf{V}$ associated to the contact manifold $V$.

After what was said it should not come as a surprise that in
the quantized picture Lagrangian correspondences
are being replaced by Fourier integral operators, and the
composition of correspondences by the convolution
of the corresponding operators.

We describe below the SFT-formalism with more details. We treat
contact manifolds in Section \ref{sec:af-contact} and  symplectic
cobordisms in Section \ref{sec:af-cobordism}. Section
\ref{sec:chain}  is devoted to  the   SFT-version of the  chain  homotopy statement
in Floer homology theory.   In Section  \ref{sec:composition}  we introduce the composition
formula for the SFT-invariants of symplectic cobordisms. In Section \ref{sec:contact-invariants}
we discuss    how the   introduced algebraic structures of contact manifolds
depend on extra choices.  Section \ref{sec:master}  is devoted
to a differential equation for the  potential $\bF$ of a directed symplectic
cobordism    with  a {\it non-empty } boundary.  Together with the gluing formula from Section
\ref{sec:composition} this  equation  provides an effective tool for  computing
Gromov-Witten invariants.
The remainder
of the paper has even  more sketchy character than the rest of
the paper.
Section \ref{sec:Legendrian}   is
devoted to invariants of Legendrian submanifolds via SFT. Section
\ref{sec:remarks} is devoted to various examples and possible
generalizations of  SFT. In particular, in Section
\ref{sec:Bott} we discuss   how  one can adapt the theory to
include an important for applications, though non-generic, case of
contact forms with continuous families of periodic orbits. In
Section \ref{sec:computing} we describe a  new recursive
procedure for computing rational  Gromov-Witten invariants of $\C
	P^n$. Finally, in Section \ref{sec:satellites} we  just touch the
wealth of other  invariants which exist in  Symplectic Field
Theory.

\subsection{Contact manifolds}\label{sec:af-contact}

\subsubsection{Evaluation maps}\label{sec:contact-eval}
Let $(V,\xi)$ be a contact manifold with a fixed contact form
$\alpha$, $(W=V\times\R,d(e^t\alpha))$ the symplectization of
$(V,\xi)$, and $J$  a compatible almost complex structure.  As in Section \ref{sec:holomorphic}
we denote  by $f_V$ and $f_\R$
the $V $- and $\R$-components of  a
$J$-holomorphic curve $f$ in $W$, and
by $\Mc_{g,r,s^-,s^+}(W,J)$ the  disjoint union
$$\bigcup\Mc_{g,r}^A(\Gamma^-, \Gamma^+),$$
which is taken over all $A\in H_2(V)$, and all
sets $ \Gamma^-,\Gamma^+\subset\Pc_\alpha$ of cardinalities $s^\pm$.

Let us view the set  $\Pc=\Pc_\a$ of periodic orbits of  the Reeb fields $ R_{\alpha }$ as a discrete topological space.
It naturally splits into the   disjoint
union
$$\coprod\limits_{k=1}^{\infty}\Pc _k,$$ of identical subspaces, where $\Pc_k$ is the space of
periodic orbits of
multiplicity $k$.

Consider now three sets of evaluation maps:
$$ev^0_i: \Mc_{g,r,s^-,s^+}/\R \to V,\;i=1,\dots,r,$$
$$ev^+_j:\Mc_{g,r,s^-,s^+ }/\R    \to \Pc ,\;j=1,\dots      ,s^+,$$
and
$$ev^-_k:\Mc_{g,r,s^-,s^+ }/\R    \to \Pc ,\;k=1,\dots      ,s^-,$$
where $ev_i^0$ is the  evaluation map $f_V(y_i)$
at the $i$-th marked point $y_i$, while
$ev^\pm_j$   are the evaluation maps
at asymptotic markers $\mu^{\bx^\pm}_j$.
More precise,
let
$$\overline{f}=(f,j,\bx^-,\bx^+,\by,\mu^{\bx^-},\mu^{\bx^+})\in
	\Mc_{g,r,s^-,s^+ },$$
and $f$ be asymptotically cylindrical over a
periodic orbit $\gamma^\pm_j\in \Pc $ at $\pm\infty$ at the
puncture   $x^\pm_j$. Then $ev_j^\pm(\overline{f})$ is a point of $
	\Pc $ representing the orbit $\g^\pm_j$ (comp. Section \ref{sec:Bott} below).

All the above evaluation maps can be combined into a map
$$ev:\Mc_{g,r,s^-,s^+ }/\R\to V^r\times (\Pc^-)^{s^-}\times (\Pc^+)^{s^+}\,,$$
which extends to the compactified moduli space
$\overline{\Mc_{g,r,s^-,s^+ }/\R}$.
\subsubsection{Correlators}\label{sec:correlators}
Now we are ready to define
correlators.
Given $r$    differential
forms $\theta_1,\dots,\theta_r$ on $V$ and $s^\pm$ ($0$-dimensional) cohomology classes $\alpha^\pm_1,\dots,
	\alpha^\pm_{s^\pm}\in H^*(\Pc )$  we define the    degree $-1$, or contact {\it
		correlator}
\begin{eqnarray}\up{-1}\langle\,\theta_1,\dots,\theta_r;\alpha^-_1,\dots,
	\alpha^-_{s^-};\alpha^+_1,\dots,
	\alpha^+_{s^+} \rangle^A_{g}=\\
	\nonumber \int\limits_{\overline{ {\Mc_{g,r,s^-,s^+ }^A}/\R}}ev^*(\theta_1\otimes\dots
	\otimes \theta_r\otimes\alpha^-_1\otimes\dots\otimes\alpha^-_{s^-}
	\otimes\alpha^+_1\otimes\dots\otimes\alpha^+_{s^+} ).
\end{eqnarray}

Usually we will assume that the forms $\theta_1,\dots,\theta_r$
are closed, but even in this case the above  correlator  depends
on the actual forms, and not just their cohomology classes,
because the domain of integration may have a boundary.  As we will see
below the
superscript $-1$ in $\up{-1}\langle\dots\rangle $ corresponds
to the grading of the generating function for these
correlators. It also refers to the
enumerative meaning of the correlators: they count
components of $1$-dimensional moduli spaces of holomorphic curves.
We will consider below also correlators $\up0\langle\dots\rangle $
and $\up1\langle\dots\rangle$, counting $0$-dimensional and
$-1$-dimensional (i.e. appearing in 1-dimensional families) moduli
spaces of holomorphic curves.


If we are given $K$ linearly independent differential forms
$\Theta_1,\dots,\Theta_K$,
then it is convenient
to introduce a ``general form" $t=\sum\limits_1^Kt_i\Theta_i$
from the space $L=L(\Theta_1,\dots,\Theta_K)$
generated by the  chosen forms, and view $t_i$ as graded variables
with  $\deg(t_i) =\deg(\Theta_i)-2$. In particular, all terms in
the sum $\sum\limits_1^Kt_i\Theta_i$ have even degrees.


Let us   consider two copies
$\Pc^+$ and $\Pc^-$ of the $0$-dimensional space
$\Pc$, one   associated with the positive end of $W$, the other with
the negative one. Cohomology classes  in $\Pc_+$ we will denote
by $p$, and in $\Pc_-$ by $q$, and will write
$$p=\sum_{\g\in\Pc}\frac{1}{\kappa_\g}p_\g[\g],\quad q=
	\sum_{\g\in\Pc}\frac{1}{\kappa_\g}q_\g[\g],$$
where   $\kappa_\g$ is
the multiplicity of $\g$, and the cohomology classes $[\g]$
form the canonical basis of $H^*(\Pc)$, dual to points in $\Pc$.
Of course, speaking about cohomology classes of a discrete space may sound
somewhat ridiculous. However, this point of view   is useful, especially
in preparation for a more general  case when
some periodic orbits may be degenerate and  thus the spaces  $\Pc^\pm$
need not to be  anymore discrete, see Section \ref{sec:Bott} below.
We will also fix a basis $A_1,\dots,A_N$ of
$H_2(V)$. The coordinate vector  $d=(d_1,\dots,d_N)$ of a class $A$
is called the degree.   Here $d_j$ are integers, while we   consider
$t,p,q $ as graded variables,
where the  degrees of the variables $p,q$ are   defined by the  formulas
$$\deg (p_\gamma )  =-\CZ(\gamma)+(n-3),\, $$
$$ \deg (q_\gamma )  =+\CZ(\gamma)+(n-3).$$
The choice
of grading,
somewhat strange at the first glance,  is explained by Proposition \ref{thm:finiteness-of-H} below.

The correlators
$$ \langle \underbrace{t,\dots,t}_r;\underbrace{q,\dots,q  }_{s^-}
	;\underbrace{p,\dots,p}_{s^+}\rangle^d_g$$ with  different
$r,d,g$ determine all the correlators involving forms from the
space $L$.


\subsubsection{Three differential algebras}\label{sec:3algebras}

Similar to the theory of Gromov-Witten invariants of   closed symplectic manifolds we
will organize all correlators
into a generating function, called {\it Hamiltonian},
$${\bH}=\frac{1}{\hbar}\sum\limits_{g=0}^\infty{\bH}_g\hbar^g,$$
where,
\begin{equation}
	{\bH}_g=\sum\limits_d\sum\limits_{r,s^\pm=0}^\infty\frac{1}{r!s^-!s^+!}
	\up{-1}\langle \underbrace{t,\dots,t}_r;\underbrace{q,\dots,q  }_{s^-}
	;\underbrace{p,\dots,p}_{s^+}\rangle^d_g z^d,
\end{equation}
and  $t=\sum_1^Kt_i\Theta_i$. We will assume throughout the paper,
that
all forms $\Theta_1,\dots,\Theta_K$ are closed (see,
however, Remarks \ref{rem:non-closed1} and \ref{rem:non-closed2}, and
Section \ref{sec:master} below).
The variables $\hbar$ and $z=(z_1,\dots,z_N)$ are also considered as graded
with $\deg \hbar= 2(n-3)$ and $\deg (z_i)=- 2c_1(A_i)$, where $c_1$ is the first
Chern class of  the almost complex structure $J$.



\begin{proposition} \label{thm:finiteness-of-H}
	\begin{description}
		\item{a)}  For each $g=0,\dots$  the series $\bH_g$
		      can be viewed as  formal power series in variables $p_\g$   with coefficients
		      which are   polynomials   of variables $q_\g$ and formal power series of $t_i$ \footnote{
			      In fact, $\bH_g$ depends polynomially on all variables $t_i$ of degree $\neq 0$.
			      The degree $0$ variables, i.e. the variables
			      associated with $2$-forms, enter into the constant part of $\bH_g$ (i.e.
			      the part describing constant holomorphic curves) polynomially, while
			      the non-constant part    of $\bH_g$ depends
			      polynomially on $e^{t_i}$. This fact is similar to the standard Gromov-Witten theory
			      and  will not discussed  in the present paper.}
		      with coefficients
		      in the group algebra $\C[H_2(V)]$
		      {\rm (which we identify with the algebra
				      of Laurent polynomials of $z$ with complex coefficients)};
		\item{b)} All terms of $\bH$  have degree $-1$;
		\item{c)} $\bH\big|_{p=0}=\bH_{\const}$, where
		      $$\bH_{\const}=\hbar^{-1}\sum\limits_{g,r=0}^\infty
			      \frac{1}{r!}\up{-1}
			      \langle\underbrace{t,\dots,t}_r\rangle^0_g\hbar^g$$
		      accounts for the contribution of constant holomorphic curves.
		      In particular, $\bH\big|_{p=0}$ is independent of $q$ and $z$.
	\end{description}
\end{proposition}
The polynomial dependence of $\bH_g$  on variables $q_\g$ and $z$   in a  geometric language just means that
the union $\overline{\Mc^d_g(\Gamma^+)}$, $\Gamma^+=\g_1\dots\g_{s^+}$,
of the  compactified moduli spaces of holomorphic curves  of a fixed genus of any degree
with prescribed
positive ends  $\g^+_1,\dots,  \g_{s^+}$
is compact, and in particular that there are only finitely many possibilities for the degrees
and the negative
ends of these curves.
This follows from the fact  that  for each curve $C\in \Mc_g(\Gamma^-,\Gamma^+)$ we have
\begin{equation}\label{eq:pos-ends}
	0\leq \int\limits_C d\alpha= \sum\limits_{\g_i\in\Gamma^+}\int\limits_{\g_i}\alpha-
	\sum\limits_{\g_j\in\Gamma^-}\int\limits_{\g_j}\alpha\leq
	\sum\limits_{\g_i\in\Gamma^+}\int\limits_{\g_i}\alpha,
\end{equation}
the fact   that there exists a constant $m>0$ such that $\int\limits_{\g}\a>m$ for
any periodic   orbit $\g\in\Pc_\a$ and Theorem \ref{thm:comp1}  above.
Proposition \ref{thm:finiteness-of-H}b)   follows from the formula
(\ref{eq:dim}) for the dimension of the moduli spaces of holomorphic curves, our degree
convention   and the fact that a correlator
$\up{-1}\langle\,\theta_1,\dots,\theta_r;\g^-_1,\dots,
	\g^-_{s^-};\g^+_1,\dots,
	\g^+_{s^+} \rangle^A_{g}$  may be different from $0$ only if the total dimension of the forms
$\theta_1,\dots\theta_r$ equals the dimension of the moduli  space   $\Mc^A_{g,r}( \g^-_1,\dots,
	\g^-_{s^-};\g^+_1,\dots,
	\g^+_{s^+})/\R $.
Proposition \ref{thm:finiteness-of-H}c) just means that every non-constant holomorphic curves should have at least
one positive end, which follows from   inequality  (\ref{eq:pos-ends}), or alternatively the
maximum principle for holomorphic curves.
\medskip

Let us consider the {\it Weyl super-algebra}
$\fW=\{\sum\limits_{\Gamma,g} f_{\Gamma,g }(q,t )p^\Gamma\hbar^g \}$,
where
$$\Gamma=(\g_1,\dots,\g_a),\gamma_i\in\Pc,\,a=1,\dots,\, p^{\Gamma}=p_{\g_1}\dots p_{\g_a},$$
and        $f_{\Gamma,g }(q,t)$ are polynomials of variables
$q_\gamma$ and formal power series of $t_i$\footnote{See the previous footnote.}. Proposition
\ref{thm:finiteness-of-H}a) states that $\bH\in\hbar^{-1}\fW$.

The product operation $F\circ G$ in $\fW$ is associative and satisfies the following commutation
relations: all variables
are super-commute (i.e. commute or anti-commute according to their grading), except
$p_\gamma$ and $q_\gamma$ which correspond to the same periodic orbit $\gamma$. For these pairs of variables
we have the following commutation relation:
\begin{equation}
	[p_\gamma,q_\gamma]=p_\g\circ q_\g-(-1)^{\deg p_\g\deg q_\g}q_\g\circ p_\g=
	{\kappa_\gamma}\hbar \,
\end{equation}
where $\kappa_\g$ is the multiplicity of the orbit $\g$.
The algebra $\fW$ can be represented as an  algebra of formal differential   operators  with respect
to
$q$-variables acting  {\it on the left} on the space of polynomials
$  f(q,z,\hbar) $, by setting
$$p_\g= {\kappa_\g}\hbar\ora{\frac{\partial}{\partial
			q_\g}}.$$
Alternatively by setting
$$q_\g={\kappa_\g}\hbar\ola{\frac{\partial}{\partial p_\g}}$$ we can
represent
$\fW$   as an algebra  of  polynomial differential operators  acting {\it on the right} on the algebra $\{\sum
	\limits_{\Gamma,g}f_{\Gamma,g}(q,z)\hbar^gp^\Gamma\}$ of formal power series
of $\hbar$ and the $p$-variables.

Notice that  the commutator $[F,G]$ of  two homogeneous elements $F,G\in\fW$
equals $F\circ G-(-1)^{\deg F\deg G}G\circ F$, and hence if $F\in\fW$ is an odd element (i.e. all its
summands are odd) then
$[F,F] =2F\circ F,$
and $[F,F]=0$ if $F$ is even. For any two elements
$F,G\in\fW$ the commutator $[F,G]$ belongs to the ideal
$\hbar\fW$.
According to Proposition \ref{thm:finiteness-of-H}   the Hamiltonian
$\bH$ can be viewed as an element of $\frac{1}{\hbar}\fW$, and hence
the above remark shows that for $F\in\fW$
we have $[\bH,F]\in\fW$.
\begin{theorem} \label{thm:HH}
	The Hamiltonian  $\bH$ satisfies the identity
	\begin{equation}\label{eq:HH}
		\bH\circ \bH=0.
	\end{equation}
\end{theorem}

This theorem (as well as Theorems
\ref{thm:SFT-cobordism}, \ref{thm:SFT-chain} and \ref{thm:SFT-composition}
below) follows from the description of the boundary of the
corresponding moduli spaces of holomorphic curves. As it was stated
in Proposition \ref{prop:boundary}
this boundary
is tiled by codimension one
strata represented by stable curves of height $2$, so that the
(virtual) fundamental cycles of the boundary of the compactified  moduli
spaces
can be
symbolically written as   $\partial [\Mc]=\kappa\sum [\Mc_{-}]\times [\Mc_{+}]$,
where $[\Mc_\pm]$ are chains represented by the corresponding moduli spaces and  where
the coefficient
$\kappa$ depends on multiplicities of orbits along which the two levels of the corresponding
stable curve are glued. Together
with the Stokes formula $\int\limits_{[\Mc]} d\omega = \int\limits_{\partial [\Mc]} \omega
$, and the fact that the integrand is a closed form, we obtain
identity
(\ref{eq:HH}).

\begin{remark}\label{rem:non-closed1}
	{\rm The same argument shows that when the forms $\Theta_i$
	generating the space $L$  are not necessarily closed
	we get the following  equation
	\begin{equation}\label{eq:non-closed1}
		d\bH+\frac12[\bH,\bH]=0,
	\end{equation}
	which
	generalizes (\ref{eq:HH}) and can be interpreted as the
	zero-curvature equation for the connection $d +[\bH,\cdot\,]$. We
	denote here by $d$ the de Rham differential, i.e.
	\begin{equation}
		\begin{split}
			d\bH & =d\Big(\sum\limits_{d,g}\sum\limits_{r,s^\pm=0}^\infty\frac{1}{r!s^-!s^+!}                                                  \\
			     & \quad \big\langle \underbrace{\sum\limits_1^Kt_i\Theta_i,\dots,\sum\limits_1^Kt_i\Theta_i}_r;\underbrace{q,\dots,q  }_{s^-}
			;\underbrace{p,\dots,p}_{s^+}\big\rangle^d_g
			z^d\hbar^{g-1}\Big)                                                                                                                \\
		\end{split}
	\end{equation}
	\begin{equation*}
		\begin{split}
			\;\; & =\sum\limits_{d,g}\mathop{\sum\limits_{s^\pm=0,}}\limits_{r=1}^\infty\frac{1}{(r-1)!s^-!s^+!} \\
			     & \quad \big\langle\sum\limits_1^K t_i
			d\Theta_i, \underbrace{\sum\limits_1^Kt_i\Theta_i,
				\dots,\sum\limits_1^Kt_i\Theta_i}_{r-1};\underbrace{q,\dots,q  }_{s^-}
			;\underbrace{p,\dots,p}_{s^+}\big\rangle^d_g
			z^d\hbar^{g-1}\,.                                                                                    \\
		\end{split}
	\end{equation*}
	}
\end{remark}
\bigskip

The identity $\bH\circ\bH=0$
is equivalent to $[\bH,\bH]=0$, because $\bH$ is an odd element.
Let  us  define the differential
$D=D^{\bH}:\fW\to\fW$
by the formula
\begin{equation}
	D^{\bH}(f)=[\bH,f]\quad\hbox{ for }\quad f\in\fW .
\end{equation}
Then Theorem \ref{thm:HH} translates into the identity $D ^2=0$. The differential
$D^{\bH}$ satisfies the Leibnitz rule, and thus
$(\fW,D )$
is a        differential Weyl (super-)algebra.
In particular, one can define the homology algebra $H_*(\fW,D)$,
which inherits  its multiplication operation from  the Weyl
algebra $\fW$.   The differential $D^{\bH}$ extends in an obvious way to the modules
$\hbar^{-k}\fW$, $k=1,\dots.$

\begin{example}\label{ex:circle}
	{\rm Let
		$V=S^1$. We have  in this case
		\begin{equation}\label{eq:circle}
			\bH=\hbar^{-1}\big(\frac{t_1t_0^2}{2}+ t_1\sum p_kq_k-\frac{t_1\hbar }{24}\big),
		\end{equation}
		where
		$ t=t_01+t_1d\phi$ is a general harmonic differential form on $S^1$,
		so that $\deg t_1=-1$,   $\deg t_0=-2$, $\deg\hbar=-4$ and  $\deg p_k,\deg q_k=-2$,
		which corresponds to the convention
		that the Maslov index of any path in the
		$1$-point group $Sp(0)$ equals 0.
		The term $t_1t_0^2/2=\int\limits_{S^1} t^{\wedge 3}/6$ is the contribution of the moduli
		space $S^1$ of constant maps $\C P^1\to \R\times S^1$ with $3$ marked points.
		The term $-\frac{t_1\hbar}{24}$ is accounted for
		the contribution of constant curves of genus $1$ (see
		\cite{Witten2}), and the term $t_1p_kq_k$ represents the
		contribution $t_1=\int\limits_{S^1} t$ of trivial curves of multiplicity
		$k$ with one marking. All other curves do not contribute to $\bH$
		for dimensional reasons and because $t_1^2=0$.

		Notice that if we organize all variables $p_k,q_k$   into
		formal Fourier series  (comp. \cite{Getzler})
		\begin{equation}
			u(x)= \sum\limits_{k=1}^\infty(p_ke^{ixk}+q_ke^{-ixk}),
		\end{equation}
		then the term accounting for
		the contribution of rational curves in the formula (\ref{eq:circle})
		takes the form
		\begin{equation}
			\frac{t_1}{4\pi }\int\limits_0^{2\pi} (t_0+   u(x)) ^2  \ dx,
		\end{equation}
		see further discussion of this $u$-formalism in Section \ref{sec:Bott} below.
	}
\end{example}


We will  associate now with $(\fW,D)$    two other differential algebras, $(\fP,d)$ and $(\fA,\partial)$, which can be viewed
as {\it semi-classical} and {\it classical} approximations of the Weyl  differential algebra.

Let us denote  by
\begin{description}
	\item{-} $\fP$ -- a graded Poisson algebra  of formal power series in variables
	      $p_\g $ with coefficients which are polynomials of $q_\g, z_j,
		      z_j^{-1}$, and formal power series of $t_i$,
	      \footnote{See the first footnote in Section \ref{sec:3algebras}.} and by
	\item{-} $\fA $ --  a graded commutative algebra generated by variables
	      $q=\{q_\g\}_{ \g\in\Pc}$   with coefficients in   the algebra
	      $\C[H_2(V)][[t]]$.
\end{description}
The Poisson bracket on $\fP$ is defined by the formula
\begin{equation}\label{eq:Poisson}
	\{h,g\}= \sum\limits_\g  {\kappa_\g}\left(\frac{\partial h}{\partial p_\g}
	\frac{\partial g}{\partial q_\g}-(-1)^{{\deg h}{\deg g}}
	\frac{\partial g}{\partial p_\g}\frac{\partial h}{\partial q_\g}
	\right)    ,
\end{equation}
assuming that $h$ and $g$ are {\it monomials}.
When computing partial derivatives, like $\frac{\partial h}{\partial q_\g}$,
one should remember that we are working in the super-commutative environment,
and in particular the operator $\frac{\partial }{\partial q_\g}$
has the same parity as  the variable $q_\g$.
\begin{remark}\label{rem:u-notation}
	{\rm
	Notice, that if  similarly to  Example \ref{ex:circle} above
	we organize the variables $p_k=p_{\g_k},q_k=q_{\g_k}$ corresponding to multiples
	of each simple periodic orbit $\g=\g_1$ into  a
	Fourier series
	$$u_\g=\sum\limits_{k=1}^\infty(p_ke^{ixk}+q_ke^{-ixk}),$$
	then the value of the Poisson tensor
	(\ref{eq:Poisson}) on covectors $\delta u,\delta v$ takes      the
	form
	\begin{equation}
		\label{eq:u-notation}
		\frac{1}{2\pi i}\int\limits_0^{2\pi}  (\d u)'\d vdx  \,.
	\end{equation}
	}
\end{remark}
\bigskip

In order to define differentials
on the algebras $\fA$ and $\fP$ let us  first     make
the following observation.
\begin{lemma} \label{lm:HH-Weyl}
	We have $$[\bH,\bH]=\frac{1}{\hbar}\{\bH_0,\bH_0\}+\dots\,,$$
	and for any $f=\frac{1}{\hbar}\sum f_g\hbar^g\in \frac{1}{\hbar}\fW$
	we have
	$$D^\bH(f) = \frac{1}{\hbar}\{\bH_0,f_0\}+\dots\,.$$ In
	particular, $\bH_0$ satisfies the equation
	$\{\bH_0,\bH_0\}=0.$
\end{lemma}

To cope with a growing number of indices we will rename $\bH_0$
into $\bh$.
Lemma \ref{lm:HH-Weyl} allows us to define the differential
$d=d^{\bh}:\fP\to\fP $ by the formula
\begin{equation}
	dg=\{\bh,g\} \quad\hbox{ for }\quad g\in\fP .
\end{equation}
Theorem \ref{thm:HH} then implies
\begin{proposition}\label{prop:dd-Poisson} We have
	$d^2=0$ and $d\{f,g\}=\{df,g\}+ (-1)^{\deg f}\{f,dg\}$ for any homogeneous element
	$f\in\fP$. In other words,   $(\fP,d)$ is a
	graded differential Poisson algebra with  unit.
\end{proposition}
Proposition \ref{prop:dd-Poisson}
enables us to define the homology $H_*(\fP,d)$ which inherits  from
$\fP$ the structure of a graded Poisson algebra with unit.

Let us recall that according to \ref{thm:finiteness-of-H}
$\bh|_{p=0}=\bh_{\const}$,
where $\bh_{\const}$ accounts for constant rational
holomorphic curves, and thus it is independent of $q$-variables.
In fact, $$\bh_{\const}(t)=\frac16\sum\limits_{i,j,k=1}^K c^{ijk}t_it_jt_k,$$
where $c^{ijk}=\int\limits_V\Theta_i\wedge\Theta_j\wedge\Theta_k$ are
the structural
coefficients of the cup-product.
Hence,  $$\bh=\bh_{\const}+\sum h_{\g }(q,t,z)p_\g   +\dots,$$
where $\dots$ denote terms at least quadratic in $p_\g$.  Thus
we have
\begin{equation}
	\{\bh,\bh\} = 2\sum\limits_{\g ,\g'\in\Pc }\kappa_{\g'}
	h_{\g'  }(q,t)\frac {\partial h_{\g  }}{\partial q_{\g'}}(q,t)p_{\g}+ o(p)=0\,.
\end{equation}
Therefore,
\begin{equation}\label{eq:d2}
	\sum\limits_{\g'  \in\Pc }\kappa_{\g'}
	h_{\g' }(q,t)\frac{\partial h_{\g  }}{\partial
		q_{\g'}}(q,t)=0
\end{equation}
for all $t$ and all $\g\in\Pc$.


Let us define a differential $\partial: \fA\to\fA$ by the
formula

\begin{equation}
	\partial f=\{\bh,f\}|_{\{p=0\}}=\sum\limits_{\g\in\Pc}\kappa_\g h_\g\frac{\partial
		f}{\partial q_\g}.
\end{equation}
Then the equation (\ref{eq:d2}) is equivalent to

\begin{proposition}\label{prop:zero-section}
	$\partial^2=0$, and hence $(\fA,\partial)$ is a graded
	commutative
	differential algebra with  unit.
\end{proposition}

The homology group $H_*(\fA,\partial)$
inherits the structure
of a graded commutative algebra with unit.

As it was already mentioned in Section \ref{sec:informal},
it is convenient to view the Poisson algebra $\fP$ as an algebra
of functions on an infinite-dimensional symplectic super-space $\bV$ with the even symplectic form
$\bo=\sum k_\g^{-1}dp_\g\wedge dq_\g$.
Then  the differential $d^\bh$ is   the  Hamiltonian  vector field on $\bV$ generated by the  Hamiltonian
function $\bh$. One should remember, however, that the $p$-variables are formal,
so all that we have is the infinite jet of the symplectic space
$\bV$ along the $0$-section.  The equation $\bh|_{p=0}=\bh_{\const}$ translates into
the fact that the vector field $d^\bh$
is tangent to the $0$-section, and the differential $\partial$ is just the restriction of this vector field
to the $0$-section.
The higher order terms in the expansion of $\bh$ with respect
to $p$-variables define a sequence  of (co-)homological operations on the algebra $\fA$.
\medskip

Notice  also that the differentials $D,d$ and $\partial  $ do not involve any differentiation
with respect to $t$. Hence the  differential algebras
$(\fW,D^{\bH})$, $(\fP,d^{\bh})$ and
$(\fA,\partial)$ can be viewed
as {\it families} of differential algebras, parameterized
by $t\in H^*(V)$, and in particular,
one can compute the homology at any fixed $t\in H^*(V)$.   We will
sometimes denote
the corresponding
algebras and their homology
groups with the subscript $t$, i.e.
$(\fW,D)_t$,  $H_*(\fP,d)_t,$ etc., and call them
	{\it specialization} at the point $t\in H^*(V)$.
We will also use the notation
$$H_*^{\SFT}(V,\xi|\,J,\a ),\;\;
	H_*^{\RSFT}(V,\xi|\,J,\a  ), \quad\hbox{and }\quad
	H_*^{\cont}(V,\xi|\,J,\a )$$
instead of
$H_*(\fW,\partial), H_*(\fP,\partial)$ and $H_*(\fA,\partial)$,
and
will usually omit the   extra data $J,\a$ from the notation:
as we will see in Section \ref{sec:composition} below all these
homology algebras are independent  of  $J,\a$ and other extra
choices, like
closed forms representing cohomology classes of $V$, a coherent orientation of the moduli spaces,
etc. The
abbreviation $\RSFT$ stands here for  {\it Rational Symplectic
		Field Theory}.
\begin{remark}\label{rem:grading}
	{\rm It is   important to observe that the algebras $\fW,\fP $ and
		$\fA$ have an additional grading by elements of $H_1(V)$ (comp. Section
		\ref{sec:Floer} above). This
		grading is also inherited by the corresponding homology algebras. However, this grading carries a
		non-trivial information only when we consider homology of algebras, specialized at points
		$t=\sum\limits_1^K t_i\Theta_i$ with  $t_i=0$ for at least some of the
		coordinates $t_i$ corresponding
		$1$-dimensional forms.  Otherwise
		all cycles in these algebras are graded by  the $0$-class from $H_1(V)$.}
\end{remark}

\subsection{  Symplectic cobordisms}\label{sec:af-cobordism}



\subsubsection{Evaluation maps and correlators}
\label{sec:sympl-eval}
Let us now repeat the constructions of the previous section for a
general directed symplectic cobordism $W=\ora{V^-V^+}$
between  two contact manifolds
$V^-$ and $V^+$ with fixed contact forms $\alpha^-$ and $\alpha^+$.
As in Section \ref{sec:contact-eval} we consider the sets $\Pc^\pm$
of periodic orbits of the Reeb fields $R^\pm=R_{\alpha^\pm}$ as   discrete topological spaces.

We denote by $\Mc^A_{g,r,s^-,s^+}( W,J)$ the  disjoint union
$$\bigcup\Mc_{g,r}^A(\Gamma^-, \Gamma^+;W,J),$$
where the union is taken over all sets $(\Gamma^-, \Gamma^+)$ of cardinality $(s^-,s^+) $, and
consider  three sets of evaluation maps:
$$ev^0_i: \Mc^A_{g,r,s^-,s^+}( W,J) \to W,\;i=1,\dots,r,$$
$$ev^\pm_j:\Mc^A_{g,r,s^-,s^+}(W,J)    \to \Pc^\pm,\;j=1,\dots      ,s^\pm,$$
where $ev_i^0$ is the  evaluation map $f (y_i)$ of
the map $f$  at the $i$-th marked point $y_i$, while
$ev^\pm_j$   are the evaluation maps
at asymptotic markers
$\mu^{\bx^\pm}_j$, i.e.
$ev_j^\pm(f)$ is a point of $
	\Pc^\pm$ representing the orbit $\g^\pm_j$, which contains the image of the
corresponding marker.
The evaluation maps $ev^0_i$ and $ev^\pm_j$ can be combined into a map
$$ev:\Mc^A_{g,r,s^-,s^+}(W,J)\to W^r\times (\Pc^+)^{s^+}\times (\Pc^-)^{s^-}\,.$$

Now we are ready to define   degree $0$, or symplectic
correlators.  We will have to consider on $W$ differential
forms, which do not necessarily have compact support, but
have,   however, {\it cylindrical ends}. We say that a
differential  form  $\theta$ on $W$ is said to have cylindrical ends
if it satisfies the following
condition:
\smallskip

\noindent there exists  $C>0$  such that
$$\theta|_{V^-\times(-\infty,-C)}=(\pi^-)^*(\theta^-)\quad\hbox{ and}\quad
	\theta|_{V^+\times(C,\infty)}=(\pi^+)^*(\theta^+),$$ where
$\theta^\pm$ are forms on $V^\pm$, and $\pi^\pm$ are the
projections of the corresponding ends to $V^{\pm}$.
We will denote the forms $\theta^\pm$ also by  $\restr^\pm(\theta)$, or $\theta|_{V^\pm}$.
In what follows we assume that all considered differential  forms on $W$ have   cylindrical ends.
\smallskip

Given $r$    differential
forms $\theta_1,\dots,\theta_r$ on $W$ and $s^\pm$   cohomology
classes $$\alpha^\pm_1,\dots, \alpha^\pm_{s^\pm}\in
	H^*(\Pc^\pm)=H^*_0(\Pc^\pm)$$  we define the degree $0$
correlator
\begin{eqnarray}
	\up{0}\langle\,\theta_1,\dots,\theta_r;\alpha^-_1,\dots,
	\alpha^-_{s^-};\alpha^+_1,\dots,
	\alpha^+_{s^+} \rangle^A_{g}= \hfill \\
	\nonumber  \int\limits_{\overline{\Mc_{g,r,s^-,s^+ }^A}}ev^*(\theta_1\otimes\dots
	\otimes \theta_r\otimes\alpha^-_1\otimes\dots\otimes\alpha^-_{s^-}
	\otimes\alpha^+_1\otimes\dots\otimes\alpha^+_{s^+} ).
\end{eqnarray}

Similar to
Section \ref{sec:contact-eval} above, we denote  the cohomology classes in
$H^*(\Pc^+)= H^0(\Pc^+)$
(resp. in   $H^*(\Pc^-) = H^0(\Pc^-)$) by
$p^+$ (resp.   $q^-$), and write $$p^+=\sum\limits_{\g\in\Pc^+}k_g^{-1}p^+_\g[\g]\quad
	\hbox{\big(resp.}\quad q^-=\sum\limits_{\g\in\Pc^-}k_g^{-1}q^-_\g[\g]\,\big).$$
We will also fix a basis $A_1,\dots,A_N$ of
$H_2(W)$ and denote
by $d=(d_1,\dots,d_N)$ the degree of $A$ in this basis.

Let us call a system of linearly independent
closed forms  $\theta_1,\dots,\theta_m $
on $W$ with cylindrical ends
	{\it basic}, if
\begin{equation}\label{eq:basic}
	\begin{split}
		 & \hbox{a) the image}\quad
		\restr^\pm(L(\theta_1,\dots,\theta_m ))                     \\
		 & \quad\hbox{ generates }\quad \im (H^*(W)\to H^*(V^\pm)); \\
		 & \hbox{b) the homomorphism}
		\quad \Ker\big((\restr^+\oplus \restr^-)|_L\big)\to
		H_{\mathrm{comp}}^*(W)                                      \\
		 & \quad\;\hbox {is bijective.}                             \\
	\end{split}
\end{equation}
Here we denote by $L(\theta_1,\dots,\theta_m )$ the subspace
generated by the forms $\theta_1,\dots,\theta_m $, and by
$H_{\mathrm{comp}}^*(W)$ the cohomology with compact support.
Equivalently, one can say that a basic system of forms consists
of a basis of $H^*(W)$ together with a basis of
$\Ker\big(H^*_{\comp}(W)\to H^*(W)\big)$.

A general point     $t\in L(\theta_1,\dots,\theta_m )$  we will
write in the form
$t=\sum\limits_1^mt_i\theta_i.$
The grading of the variables
$t,p^+,q^- $  is defined   as in Section
\ref{sec:correlators}:
\begin{equation}
	\begin{split}
		\deg(t_i) =         & \;\deg(\theta_i)-2;\,  \\
		\deg (p_\gamma^+) = & -\CZ(\gamma^+)+(n-3),  \\
		\deg (q_\gamma^-) = & \; \CZ(\gamma^-)+(n-3) \\
	\end{split}
\end{equation}






\subsubsection{Potentials of symplectic cobordisms}\label{sec:relative}
Let us now organize the  correlators
into a generating function, called the { \it potential} of the
symplectic
cobordism $(W=\ora{V^-V^+},J,\a^\pm)$
\begin{equation}\label{eq:GW-potential}     \begin{split}
		 & { { \bF}}=
			{  \bF}_{W,J,\alpha^\pm} =\frac1\hbar
		\sum\limits_{g=0}^\infty {\bF}_g\hbar^g,                                          \\
		 & \quad\hbox{  where }                                                           \\
		 & {\bF }_g=\sum\limits_d\sum\limits_{r  ,s^\pm=0}\frac{1}{r!s^+!s^-!}\up0\langle
		\underbrace{t,\dots,t}_r;
		\underbrace{q^-,\dots,q^-
		}_{s^-};\underbrace{p^+,\dots,p^+}_{s^+}
		\rangle^d_{g}z^d\,.                                                               \\
	\end{split}
\end{equation}

When $W$ is a closed symplectic manifold, then the potential $F$
is just the Gromov-Witten invariant of the symplectic manifold
$W$. However, if $W$ is not closed, then $F$ itself is not an
invariant. It depends on    particular forms
$\theta_i$, rather than their cohomology classes, on $J$, on a
coherent orientation, and several other choices. We will see,
however, that the {\it homotopy class} of $F$, which we define in
Section \ref{sec:chain} below, is independent of most of these
choices.
\medskip

In order to make sense out of the expression for
$\bF$ let us consider a graded commutative
algebra $ \fD=\fD({W,\a^\pm })$  which consists of
power series of the form
\begin{equation}
	\sum\limits_{\Gamma,d,g}\varphi_{\Gamma,d,g} (q^-,t ) z^d(p^+)^{\Gamma}\hbar^g,
\end{equation}
where $\varphi_{\Gamma,d,g}$ are polynomials
of $q_\g$, formal power series of variables
$t_i$,\footnote{See the first footnote in Section \ref{sec:3algebras}.}
and where $\Gamma$ and
$d$ satisfies the following Novikov type inequality:
\begin{equation}\label{eq:Novikov}
	[\omega](d)=\sum
	d_i\int\limits_{A_i}\omega>-\left|\Gamma\right|=-\sum\limits_{i=1}^k|\gamma_i|,
\end{equation}
where
$\Gamma=\{\g_1,\dots,\g_k\}$, and
$|\gamma_i|=\int\limits_{\gamma_i}\alpha^+$ is the period of the
periodic orbit $\g_i\in\Pc^+$, or equivalently its action. Recall
that $(p^+)^\Gamma=p^+_{\g_1}\dots p^+_{\g_k}$.



\begin{proposition}
	We have
	$$\bF_{W,J,\alpha^\pm}
		\in\frac1{\hbar}\fD({W,\alpha^\pm}).$$
\end{proposition}
Let us also consider a bigger algebra $\fD\fD$ which consists
of series
\begin{equation}
	\sum\limits_{\Gamma,d}\varphi_{\Gamma,d} (q^-,t,\hbar ) z^d(p^+)^{\Gamma},
\end{equation}
where $\varphi_{\Gamma,d}$ are polynomials of $q^-_\g$, formal power series of $t_i$ and formal {\it Laurent
		series}
of $\hbar$, while $\Gamma$ and $d$  still satisfy
condition
(\ref{eq:Novikov}).
For instance, for any element $f\in \hbar^{-1}\fD$ we have $e^f\in\fD\fD$.

The algebra $\fD\fD=\fD\fD(W,J,\alpha^\pm)$ has a structure
of a {\it left $D$-module} over the Weyl algebra
$\fW^-=\fW(V^-,J,\alpha^-)$, and of a {\it right $D$-module} over the Weyl algebra
$\fW^+=\fW(V^+,J,\alpha^+)$.
Indeed,  we first associate with an element
$$\Delta^-= \sum\limits_{\Gamma=\{\g_1,\dots,\g_m\},\Gamma',d,g }
	{\delta}^-_{\Gamma',\Gamma,d,g  }( t )
	(q^-)^{\Gamma'}(p^-)^{\Gamma}z^d\hbar^g\in\fW^-$$
a differential operator

\begin{equation}
	\sum\limits_{\Gamma=\{\g_1,\dots,\g_m\},\Gamma',d,g }
	{\delta}^-_{\Gamma,\Gamma',d,g }(t )
	(q^-)^{\Gamma'}{\hbar^{m+g}}\prod\limits_{i=1}^m
	\kappa_{\g_i}
	\overrightarrow{\frac{\partial}
	{\partial q^-_{\g_i}}}z^d,
\end{equation}
then  change   the coefficient ring via  the inclusion homomorphism
$H_2(V^-)\to
	H_2(W)$,  and finally lift functions
$ {\delta}^-_{\Gamma,\Gamma',d,g }(t )$ to the space of forms with cylindrical
ends on $W$ via the restriction map $t\mapsto t|_{V^-}$.
We will   denote  the resulting operator by
$\overrightarrow{\Delta^-}$. Similarly we associate with
$\Delta^+\in\fW^+$ an operator $ \overleftarrow{\Delta^+}$ by
first quantizing $q^+_\g\Rightarrow  \hbar
	\kappa_\g\overleftarrow{\frac{\partial}{\partial p^+_\g}}$  and then making an
appropriate change of the coefficient ring.
It is straightforward to verify that
for $f\in \fD$ we have $\overrightarrow{\Delta^-}f,\;f \overleftarrow{\Delta^+}\in \fD$,
and for $F\in\fD\fD$ we have
$\overrightarrow{\Delta^-}F,\; F\overleftarrow{\Delta^+}\in \fD\fD$.

\medskip

Let us denote the Hamiltonians (see Section \ref{sec:3algebras} above)  in
$\fW^\pm$ by $\bH^\pm$ and define a map
$D_W=D_W:\fD\fD\to\fD\fD$ by the formula

\begin{equation}\label{eq:DW}
	D_W(G)= \overrightarrow{
		\bH^-}G-(-1)^{\deg G}G\overleftarrow{\bH^+},\quad G\in\fD\fD,
\end{equation}
where we assume $G$ dimensionally homogeneous.
Clearly, Theorem \ref{thm:HH} implies that $D_W^2=0$. However, the differential algebra
$(\fD\fD,D_W)$ is too big
and instead of considering its homology we will define a differential on the algebra $\fD$,
or which is equivalent but more convenient, on the module $\hbar^{-1}\fD$.

For an {\it even} element $F\in\hbar^{-1}\fD$  let us define  a map
$D^F=T_FD_W:\hbar^{-1}\fD\to\hbar^{-1}\fD$
by the formula
\begin{equation} \label{eq:DF}
	D^F(g)=e^{-F}[D_W,g](e^F)=e^{-F}\big(D_W(ge^F)-(-1)^{\deg g}g D_W(e^F)\big),
	\quad g\in\hbar^{-1}\fD.
\end{equation}
The map    $T_FD_W$ is         the linearization of  the map
$\wt D_W:\hbar^{-1}\fD\to\hbar^{-1}\fD$,
defined by the formula $$\wt D_W(F)=e^{-F}D_W(e^F),\quad F\in\hbar^{-1}\fD\,.$$
at the point $ F\in\hbar^{-1}\fD$.  Notice that   if $D_W(e^F)=0$ then
$D^F(g)=e^{-F}D_W(ge^F)$.
Let us first state a purely algebraic
\begin{proposition} \label {prop:SFT-cobordism}
	Suppose that     for $F\in\hbar^{-1}\fD$ we have $D_W(e^F)=0$. Then
	\begin{description}
		\item{1.}   $(D^F)^2=0;$
		\item{2.}  The homology algebra         $H_*(\fD,D^{F})$
		      inherits the structure of a left module over the homology
		      algebra
		      $ H_*(\fW^-,D^-)$, and
		      the structure of a right module over the homology
		      algebra $ H_*(\fW^+,D^+)$;
		\item{3.} The homomorphisms
		      $F^\pm:  \fW^{\pm}  \to \fD $,
		      defined by  the formulas
		      \begin{equation} \label{eq:end-homomorphisms}
			      \begin{split}
				       & f\mapsto e^{-F}
				      \overrightarrow{f}e^{F},\,f\in\fW^-,\quad\hbox{and}       \\
				       & f\mapsto  e^{F} \overleftarrow{f}e^{-F},\,f\in\fW^+\,, \\
			      \end{split}
		      \end{equation}
		      commute with the  boundary maps of chain complexes, i.e.
		      $$F^\pm\circ D^\pm= D^{F}\circ F^\pm,$$ and thus induce
		      homomorphisms of homology
		      $$F^\pm_*:H_*(\fW^{\pm},D^\pm)
			      \to H_*(\fD,D^{F}),$$
		      as modules over $H_*(\fW^{\pm},D^\pm)$.
	\end{description}
\end{proposition}

\begin{theorem}\label{thm:SFT-cobordism}
	The   potential $ \bF\in\hbar^{-1}\fD$  defined  above by the formula
	(\ref{eq:GW-potential})
	satisfies the equation
	\begin{equation}\label{eq:SFT-cycle}
		D_We^{\bF}=0 ,
	\end{equation} and hence all conclusions of Proposition \ref{prop:SFT-cobordism}
	hold for $\bF$.
\end{theorem}

The appearance of $e^{\bF}$ in  equation
(\ref{eq:SFT-cycle}) has the following reason.
Similar to Theorem
\ref{thm:HH} above, equation (\ref{eq:SFT-cycle}) follows from the
description of codimension $1$ strata on the boundary of the
moduli space of holomorphic curves in the cobordism $W$, see
Proposition \ref{prop:boundary} above.   Notice
that $e^{\bF}$ is the generating function  counting possibly disconnected
holomorphic curves in $W$. Thus the identity
$$\overrightarrow{\bH^-} e^{\bF}- e^{\bF}\overleftarrow{\bH^+}=0$$
asserts, in agreement with Proposition \ref{prop:boundary},
that the  codimension $1$ strata on the  boundary of the moduli space
$\wt\Mc(W)$
of not necessarily connected curves
in $W$ correspond
to  stable
curves $(f_1,f_2)$ of height $2$, where one of the  curves $f_1,f_2$ belongs to $\wt\Mc(W)$,
while the second one
is contained in the symplectization of $V^\pm$  and has
precisely one component different from the   straight cylinder
over a periodic orbit from $\Pc^\pm$.


\medskip

\begin{remark}\label{rem:non-closed2}
	{\rm
		(Comp. Remark \ref{rem:non-closed1} above) The   potential
		$\bF$, extended to the space of all, not necessarily closed
		differential forms
		satisfies the   equation
		\begin{equation}\label{eq:non-closed2}
			d(e^\bF)=D_We^{\bF},
		\end{equation}
		where $d$ is the de Rham differential.
		This equation generalizes
		equation   (\ref{eq:SFT-cycle}).
	}
\end{remark}
Following the scheme of Section \ref{sec:3algebras} above we will associate
now with the cobordism $W$ two other left-right modules, one over
the
Poisson algebras $\fP^\pm$, and another over the graded differential
algebras $\fA^\pm$.

Consider the graded commutative algebra  $\fL=\fL({W,\a^\pm })$
of
power series of the form
\begin{equation}
	\sum\limits_{\Gamma,d}\varphi_{\Gamma,d} (q^-,t ) z^d(p^+)^{\Gamma},
\end{equation}
where $\varphi_{\Gamma,d}$ are polynomials of $q_\g^-$ and formal power seies of $t_i$, while $\Gamma$ and
$d$  satisfies the  above inequality (\ref{eq:Novikov}).
Let us also consider the larger graded commutative algebra
\begin{equation}\label{eq:fL}
	\widehat{\fL}=\{\sum\limits_{\Gamma^+,\Gamma^-,d}
	\varphi_{\Gamma^+,\Gamma^-,d} (q^-,q^+,t )
	z^d(p^+)^{\Gamma}(p^-)^{\Gamma'}\},
\end{equation}
where the Novikov condition (\ref{eq:Novikov}) is satisfied for both pairs
$(d,\Gamma)$ and $(d,\Gamma')$.
The algebra $\widehat{\fL}$
has a natural Poisson  bracket so that the homomorphisms
$f\mapsto \widehat{f}$,
where we  denote by $ \widehat{f}$
the image in $\widehat{\fL}$ of an element $f\in\fP^\pm$ under the
coefficient homomorphism, are Poisson homomorphisms.  We set
$\widehat{\bh}=\widehat{\bh^-}-\widehat{\bh^+}$, and   for any $f\in\fL$ denote
by $L_{f}$ the ``Lagrangian variety''
$$\{p^-_\g=\kappa_\g\frac{\partial
		\widehat{f}}{\partial q^-_\g}, q^+_\g=\kappa_\g\frac{\partial
		{\widehat f }}{\partial p^+_\g}\}. $$ Strictly speaking $L_f$ is
an ideal in the Poisson algebra $\widehat{L}$. However, it is
useful to think about $L_f$ as a Lagrangian variety in the
symplectic super-space $(\bV^-)\oplus\bV^+$ with the symplectic
form $$\sum \kappa^{-1}_{\g^-}dp^-_{\g^-}\wedge
	dq^-_{\g^-}+\kappa^{-1}_{\g^+}dq^+_{\g^+}\wedge dp^+_{\g^+}\,,$$
and with an appropriate change of the coefficient ring.

For any function $f\in\fL$, which satisfies the Hamilton-Jacobi
equation
\begin{equation}\label{eq:HJ1}
	\widehat\bh|_{L_f}=0
\end{equation}
the Hamiltonian vector
field defined by the Hamiltonian $\widehat{\bh}$ is tangent to
$L_{f}$, and hence
the differential $d^f:\fL\to\fL$, defined by the formula
$$d^f(g)=\{\widehat\bh,g\}|_{L_f}$$ has the following meaning: we identify
$\fL$ with the space of functions on $L_f$ and differentiate
them along the Hamiltonian vector field determined by $\widehat\bh$.

Here is an analog of Proposition \ref{prop:RSFT-cobordism}
for the algebra
$\fL$.
\begin{proposition}\label{prop:RSFT-cobordism}
	Suppose that    $\widehat\bh|_{L_f}=0$.
	Then
	\begin{description}
		\item{1.} $(d^f)^2=0;$
		\item{2.} The maps $f^\pm:\fP^\pm\to\fL$, defined by the
		      formula $g\mapsto {\widehat{g}}|_{L_{f}}$, are homomorphisms of
		      chain complexes, i.e. $$d^{f}\circ f^\pm=f^\pm\circ
			      d^\pm;$$
		\item{3.} If  $g_1,g_2\in\fP^\pm$ Poisson commute with $\bh^\pm$
		      or, in other words, if $g_1,g_2\in{\mathrm {Ker}}\,d^\pm$
		      then
		      \begin{equation*}
			      \{f^\pm(g_1),f^\pm(g_2)\}=f^\pm(\{g_1,g_2\}).
		      \end{equation*}
		      where the left-side Poisson bracket is taken  in the algebra $\widehat{\fL}$.
	\end{description}
\end{proposition}
Let us recall that $\bF=\bF_W\in\fD$ has the form
$\bF=\hbar^{-1}\sum\limits_{g=0}^\infty\bF_g\hbar^g$.
Again, to simplify the notation we will write $\bff $ instead of
$\bF_0$.
The following theorem is the reduction of Theorem
\ref{thm:SFT-cobordism} to the level of rational Gromov-Witten theory.
\begin{theorem}\label{thm:RSFT-cobordism}
	The series $\bff(q^-,p^+,t)$ belongs to the algebra $\fL$ and satisfies
	the  equation
	\begin{equation}\label{eq:Lagr}
		\widehat{\bh}|_{L_{\bff}}=0.
	\end{equation}
\end{theorem}
In particular, all statements of  the above Proposition
\ref{prop:RSFT-cobordism} hold for $\bff$, and  this allows
us    to   define    the homology
\begin{equation*}
	{}_{\bff}H^{\RSFT}_*(W|J,\a^\pm)=H_*(\fL,d^{\bff}).
\end{equation*}
The chain maps $\bff^{\pm}$ induce homomorphism of Poisson homology
algebras
\begin{equation}
	(\bff^\pm)_*:H^{\RSFT}_*(V^\pm|J,\a^\pm)=H_*(\fP^\pm,d^\pm)\to
	{}_{\bff}H^{\RSFT}_*(W|J,\a^\pm)\,.
\end{equation}

\bigskip
For the rest of this section we assume that $W$ is a  rational
homology
cobordism, i.e. the restriction maps $$H^*(V^-;\R)\leftarrow
	H^*(W;\R)\rightarrow H^*(V^+,\R)$$ are isomorphisms.  Equivalently,
this means that
the inclusions $V^\pm\to W$ induce isomorphisms of rational
homology groups.


The potential $\bff\in\fL$ which we defined above can be written in the
form
\begin{equation}
	\bff=\sum\limits_i\sum\limits_{|\Gamma^+|=i}f_{\Gamma}^i(q^-,t)(p^+)^{\Gamma^+}.
\end{equation}
Notice that the assumption that $W$
is a homology cobordism implies
that $f^0(q^-,t)$ is independent of $q^-$.
Let us now define a homomorphism
$\bPsi : \fA^+\to \fA^-$
by the formula
\begin{equation}
	\bPsi (q^+_{\g } )=f^1_{ \g }(q^-,t)\in\fA^-
\end{equation}
on the generators $q^+_\g,\g\in\Pc^+$,
of the algebra $\fA^+$ and then   extend by
linearity.

\begin{theorem}   The homomorphism
	$\bPsi : \fA^+\to \fA^-$ commutes with the boundary operators
	$\partial^\pm$, i.e. $\partial^-\circ\bPsi =\bPsi
		\circ\partial^+$, and in particular defines a homomorphism of
	homology algebras
	\begin{equation*}
		(\bPsi )_*:H_*(\fA^+,\partial^+)\to H_*(\fA^-,\partial^-).
	\end{equation*}
\end{theorem}

Without the assumption that $W$ is a homology cobordism
one gets only a correspondence between the algebras $\fA^+$ and $\fA^-$, similar to the
``semi-classical" case considered above.

\subsection{Chain homotopy}\label{sec:chain}
Let $W=\ora{V^-V^+}$ be a directed symplectic cobordism with fixed
contact forms $\a^\pm$ on $V^\pm$. We will discuss in this section
how the function $\bF=\bF_{W,J,\a^\pm}(p^+,q^-,t)$ and other
associated structures change when one replaces  $J$ with another
compatible almost complex structure $J'$ and replaces $t$ with a
form $t'=t+d\theta$ where $\theta$ has   compact support in $W$.

Let us begin with some algebraic preliminaries. Two series
$F_0,F_1\in\hbar^{-1}\fD$ are called {\it homotopic}, if they can
be included into  a family $F_s\in\hbar^{-1}\fD,\,s\in[0,1]$,
which satisfies the following differential equation
\begin{equation} \label{eq:homotopy}
	\frac{d F_s}{ds }=
	e^{-F_s}
	\left(\ora{[\bH^-,K_s]}e^{F_s}+
	e^{F_s}\overleftarrow{[
		K_s,\bH^+]}\right),\,\,s\in[0,1],
\end{equation}
for a family $K_s\in\hbar^{-1}\fD$.
Here  $[\bH^-,K_s]$ and $[K_s ,\bH^+]$ are commutators in the
algebra $\hbar^{-1}\widehat{\fD}$, defined similar to
$\widehat{\fL}$ in (\ref{eq:fL}) above, i.e.
\begin{equation}
	\widehat{\fD}=\{\sum\limits_{\Gamma^+,\Gamma^-,d,g}
	f_{\Gamma^+,\Gamma^-,d} (q^-,q^+,t )
	z^d\hbar^g(p^+)^{\Gamma^+}(p^-)^{\Gamma^-}\},
\end{equation}
where the Novikov condition (\ref{eq:Novikov}) is satisfied for
both pairs $(d,\Gamma^+)$ and $(d,\Gamma^-)$.
In other words, we view $K_s$ as an operator on
$\hbar^{-1}\fD$, acting by the multiplication
by the series $K_s$,
and  view $\bH^-$ and $ \bH^+  $
as left and right differential operators.


Notice that the family $ K_s\in\hbar^{-1}\fD, s\in [0,1],$
defines a flow $\Phi^s=\Phi_K^s: \fD\fD\to\fD \fD$,
by a differential equation
\begin{equation} \label{eq:chain-flow}
	\frac{d \Phi^s(G) }{ds }=\cK_s\big(\Phi^s(G)\big),
\end{equation}
where we set
\begin{equation*}
	\cK_s(G)=\left(\ora{[\bH^-,K_s]}G+
	G\overleftarrow{[ K_s,\bH^+]}\right),\,\,s\in[0,1].
\end{equation*}
The linear operators $\Phi^s$ preserve  the ``submanifold" $\fE=e^{
	\hbar^{-1}\fD_{\even}}$, where $\fD_\even$ is the even part of
$\fD$, and we have $$\Phi^s(e^{F_0})=e^{F_s},$$ where
the family $F_s$ satisfies the equation (\ref{eq:homotopy}).

The tangent space to $\fE$ at a point $e^F$, $F\in \hbar^{-1}\fD_\even$, consists of
series $fe^F$, $f\in\hbar^{-1}\fD_\even$, and thus it is naturally parameterized by
$\hbar^{-1}\fD_\even$. With respect to this parameterization  the
differential  of the flow $\Phi^s|_\fE$ defines a family of maps
$  T_F^s:\hbar^{-1}\fD_\even\to\hbar^{-1}\fD_\even$, $F\in \hbar^{-1}\fD_\even$, by the formula
\begin{equation}\label{eq:lin-flow}
	T_F^s(f)=e^{-F_s}\Phi^s(fe^F),\;\;\hbox{ where
	}\;\;F_s=\Phi^s(F);
\end{equation}
We extend   $T_F^s$ to the whole
$\hbar^{-1}\fD$ by the same formula
(\ref{eq:lin-flow}).
Let us list some properties of the flows $\Phi^s$ and $T^s_F$
\begin{proposition}\label{prop:SFT-chain}
	Suppose that    for an  element  $F\in\hbar^{-1}\fD_\even$ we
	have $$D_W(e^F)=\ora{\bH^-}e^F -e^F\ola{\bH^+}=0.$$
	Then
	\begin{description}
		\item{1.}
		      The   flow  $T^s_F :\hbar^{-1}\fD\to\hbar^{-1}\fD$
		      satisfies the equation
		      \begin{equation}
			      T_F^s\circ D^{F}=D^{F_s}\circ T_F^s.
		      \end{equation}
		      for all $s\in[0,1].$
		      In particular,    $D_W(F_s)=0$  for all $s\in[0,1]$, and $T_F^s$
		      defines a family of isomorphisms
		      $ H_*(\fD,D^{F})\to
			      H_*(\fD,D^{F_s})$.
		\item{2.} The homology class
		      $[e^{F_s}]\in H_*(\fD \fD,D_W)$ is independent of  $s$.
		\item{3.} The diagram
		      \bigskip\bigskip

		      \centerline{$ \mathop{\fD\qquad}\limits_{\;
					      \; \nwarrow \, F^\pm}
				      \mathop{\longrightarrow}\limits^{T_F^s}
				      \mathop{\fD}\limits_{\nearrow \, F_s^\pm}$}

		      \centerline{$\fW^\pm$}

		      homotopically commutes, i.e. there exist operators
		      $A_s^\pm:\fW^\pm\to\fD$,
		      such that
		      \begin{equation}\label{eq:SFT-diagram}
			      (T_F^s)^{-1}\circ F_s^\pm- F^\pm=D^{F}\circ A_s^\pm+ A_s^\pm\circ
			      D^\pm\,.
		      \end{equation}
		      In particular,
		      this diagram commutes on the level of homology algebras.
	\end{description}
\end{proposition}
The proof of this proposition is a  straightforward computation by
differentiating  the corresponding equations.
To illustrate the argument, let us   verify
(\ref{eq:SFT-diagram})
in \ref{prop:SFT-chain}.

Take, for instance, $f\in\fW^-$ and
set
\begin{equation*}
	\begin{split}
		G_s(f)= & (T_F^s)^{-1}(e^{-F_s}\ora fe^{F_s}))-e^{-F}\ora fe^F \\&=
		e^{-F}(\Phi^s)^{-1}\left(\ora fe^{F_s}\right)-e^{-F}\ora fe^F. \\
	\end{split}
\end{equation*}



Then we have $G_0(f)=0 $ and

\begin{equation*}
	\begin{split}
		\frac{dG_s(f)}{ds}
		 & = -e^{-F}\left((\Phi^s)^{-1}
		(  \cK_s \ora{f}  e^{F_s }  )\right)
		+  e^{-F}
		(\Phi^s)^{-1}\left(
		\overrightarrow{f} \cK_s\left( e^{F_s }\right)\right)
		\\
		 & =           e^{-F}(\Phi^s)^{-1}\left(
		\left[\cK_s,\overrightarrow{f}\right]
		e^{F} \right).                           \\
	\end{split}
\end{equation*}
Now remember that $\cK_s=[\widehat{\bH}  ,K_s]$,
where
$\widehat{\bH}=\overrightarrow{\bH^-}-\overleftarrow
	{\bH^+ }$, and using the Jacobi identity we get
\begin{equation*}
	\begin{split}
		\frac{dG_s(f)}{ds}
		 & =  e^{-F} (\Phi^s)^{-1}\left(
		\left[[\widehat{\bH}  ,K_s],
		\overrightarrow{f}\right]
		e^{F_s}\right)                   \\
		 & =
		e^{-F}(\Phi^s)^{-1}\left(
		\left[[K,\overrightarrow{f}],
		\widehat{\bH}  \right]
		e^{F_s }  \right)                \\
		 & +
		e^{-F} (\Phi^s)^{-1}\left(
		\left[[\overrightarrow{f},
			\widehat{\bH}  ],K_s\right]
		e^{F_s } \right).                \\
	\end{split}
\end{equation*}
Let us define now a linear operator
$B_s:\hbar^{-1}\fW_-\to\hbar^{-1}\fD $ by the formula
\begin{equation}
	B_s(g)=   e^{-F}(\Phi^s)^{-1}\left(
	\overrightarrow{[g,K_s] }
	e^{F_s}\right).
\end{equation}
for $g\in \hbar^{-1}\fW_-$.
Recall that
$D_W(e^F)=\widehat{\bH}e^{F}=0$, and observe that
$\widehat{\bH}$ commutes with
$\cK_s=[\widehat{\bH},K_s]$ because $\widehat{\bH}\circ
	\widehat{\bH}=0$.  We also have
$[\widehat{\bH},f]= D^-f$ for
$f\in\hbar^{-1}\fW_-$.
Hence
$ \frac{dG_s(f)}{ds}$ can be rewritten as
\begin{equation}\label{eq:derivative}
	\frac{dG_s(f)}{ds}= D^{F}(B_s(f))    +
	B_s(D^-(f))
\end{equation}

Finally we integrate $B_s$ into the required linear operator
$A^-:\hbar^{-1}\fW^-\to\hbar^{-1}\fD$:
\begin{equation}
	A_s^-(g)=\int\limits_0^s B_s(g)ds,
	\quad\hbox{for}\quad g\in\hbar^{-1}\fW^-.
\end{equation}

In view of   equation
(\ref{eq:derivative})
we get
\begin{equation}
	(\Phi^s)^{-1}\circ(F^s)^- -(F)^-=D^F\circ A_s^-+
	A_s^-\circ D^-\,.
\end{equation}
\qed

\bigskip
Let us consider now a generic family $J^\tau$, $\tau\in[0,1]$,     of
compatible almost complex structures on $W$ connecting $J^0=J$
with $J^1=J'$. We  assume that the deformation $J^\tau$ is
fixed outside of a compact subset of $W$.

\medskip
Set
\begin{equation}
	\Mc_{g,r,s^+,s^-}(W,\{J^\tau\}) =\bigcup\limits_{\tau\in[0,1]}
	\Mc_{g,r,s^+,s^-}(W,J^\tau).
\end{equation}

The evaluation maps   defined for each $\tau$ can be
combined into the evaluation map
\begin{equation}
	ev:\Mc_{g,r,s^+,s^-}(W,\{J^\tau\})\to
	(W\times I)^r\times\left(\Pc^-\right)^{s^-}\times\left(\Pc^+\right)^{s^+}.
\end{equation}


Consider  closed forms
$\widehat {\theta}_1,\dots \widehat{\theta}_r$    on
$W\times I$, such that
$\widehat{\theta}_i=\wt{\theta}_i+d\beta_i$, $i=1,\dots, r$, where
$\wt{\theta}_i$ is the pull-back of  a form $\theta_i$ on $W$
with cylindrical ends, and
$\beta_i$ has   compact support in $W\times \Int I$.



Similarly to correlators  of degree $-1$ and $0$
(see \ref{sec:correlators} and \ref{sec:sympl-eval})
we  can define correlators of degree $1$, or
$1$-parametric correlators by the formula
\begin{eqnarray}
	\up1\langle\widehat {\theta}_1,\dots \widehat{\theta}_r\,;\theta^-_1,\dots,
	\theta^-_{s^-};\theta^+_1,\dots,
	\theta^+_{s^+} \rangle^A_{ g}  =
	\int\limits_{\overline{\Mc_{g,r,s^+,s^-}(W,\{J^\tau\})} }\\
	\nonumber   ev^*(\widehat{\theta}_1\otimes\dots
	\otimes \widehat{\theta}_r
	\otimes\theta^-_1\otimes\dots\otimes\theta^-_{s^-}
	\otimes\theta^+_1\otimes\dots\otimes\theta^+_{s^+} ),
\end{eqnarray}
for a homology class $A\in H_2(W)$, and cohomology
classes $$\theta^\pm_i\in H^*(\Pc^\pm),\; i=1,\dots,s^\pm.$$



Consider a closed form $T=\widetilde{t}+d\beta$,
where  the notation $\wt t$ and $\beta$
have the same meaning as
above, i.e. $\wt t$ is the pull-back of a form $t$
on $W$ with cylindrical ends, and $\beta$ has
compact support in $ W\times\Int I$.
We can organize the correlators
$$\up1\langle T,\dots,T\,; q^-,\dots,q^-,p^+,\dots, p^+\rangle^A_{
	g}$$
into a generating function
$\bK=\frac 1{\hbar}\sum\limits_{g=0}^\infty\bK_g\hbar^g\in\frac 1{\hbar}\fD$, defined
by the formula
\begin{equation}
	\bK=\sum\limits_d\sum\limits_{g,r
		,s^\pm=0}^\infty
	\frac{1}{r!s^+!s^-!}\up1\langle \underbrace{T,\dots,T}_r;
	\underbrace{q^-,\dots,q^-
	}_{s^-};\underbrace{p^+,\dots,p^+}_{s^+}\rangle^d_{ g}\hbar^gz^d\,
\end{equation}


\medskip
Let us define an operator $\cK:\fD\fD\to\fD\fD$
by the formula
\begin{equation}
	\cK(G)=  \overrightarrow{ [\bH^+,\bK]}G +G
	\overleftarrow{[\bK ,\bH^-]},\; G\in\fD\fD .
\end{equation}

Similar to Theorems \ref{thm:HH} and \ref{thm:SFT-cobordism}
the next theorem  can be viewed
as an algebraic    description of the boundary of the compactified
moduli
space        $\overline{\Mc_{g,r,s^+,s^-}(W,\{J^\tau\})}$.
\begin{theorem}\label{thm:SFT-chain}
	For a generic family $J_\tau,\tau\in[0,1]$, of compatible almost complex
	structures on $W$ we have
	\begin{equation}\label{eq:SFT-chain}
		e^{\bF^1}= e^{\cK }(e^{\bF^0}),
	\end{equation}
	where
	$\bF^0=\bF_{W,J_0}(T|_{W\times 0}),\,\bF^1 =\bF_{W,J_1}(T|_{W\times 1}),$ and
	$\cK=\cK(T).$
\end{theorem}
Notice that if we define $\bF^s$,
$s\in [0,1]$, by the formula
\begin{equation}
	e^{\bF^s}= e^{s\cK }(e^{\bF^0}),
\end{equation}
then the flow $\Phi^s(F)=F^s$   satisfies the differential
equation (\ref{eq:chain-flow})
with $K(s)\equiv \bK$. Hence $\bPhi^0$ and $\bPhi^1$
are homotopic, and therefore
Theorem
\ref{thm:SFT-chain} and
Proposition \ref{prop:SFT-chain} imply
\begin{corollary}\label{cor:SFT-chain}
	\begin{description}
		\item{1.} The homology class $[e^{\bF}]\in H_*(\fD
			      \fD,D_W)$ is
		      independent of the choice of a compatible almost complex structure
		      $J$ on $W$ and of the choice of
		      $t\,{\mathrm {mod}}\left(d\left(\Omega_{\mathrm
						      {comp}}(W)\right)\right)$, where $ {\Omega}_{\mathrm
					      {comp}}(W)$ is the space of forms with compact support.
		\item{2.} For a generic compatible deformation $J^\tau$, $\tau\in[0,1]$,
		      the isomorphism  $T :\fD\to\fD$
		      defined by the formula
		      \begin{equation}
			      T (f)= e^{-\bF_1}
			      e^{\cK}(fe^{\bF^0 } )
		      \end{equation}
		      satisfies the equation
		      \begin{equation}
			      T \circ D^{\bF^0}=D^{\bF^1}\circ T  ,
		      \end{equation}
		      and thus defines an isomorphism
		      $ H_*(\fD,D^{\bF^0})\to
			      H_*(\fD,D^{\bF^1})$.
		\item{3.} The diagram
		      \bigskip\bigskip

		      \centerline{$ \mathop{\fD\qquad}\limits_{\;
					      \; \nwarrow \, \left(\bF^0\right)^\pm}
				      \mathop{\longrightarrow}\limits^{T }
				      \mathop{\fD}\limits_{\nearrow \, \left(\bF^1\right)^\pm}$}

		      \centerline{$\fW^\pm$}

		      homotopically commutes, i.e. there exist operators
		      $A^\pm:\fW^\pm\to\fD$,
		      such that
		      \begin{equation}
			      T^{-1} \circ\left(\bF^1\right)^\pm-
			      \left(\bF^0\right)^\pm=D^{\bF^0}\circ A^\pm+
			      A^\pm\circ D^\pm\,.
		      \end{equation}
	\end{description}
\end{corollary}

\bigskip
Consider now the equivalence relation for
rational   potentials.

Two series
$ f_0,f_1\in\fL$ are called {\it homotopic}
if there exist families
$f_s, k_s\in\fL$, $s\in[0,1]$, so that the family
$f_s$ connects $f_0$ and $f_1$ and satisfies
the following Hamilton-Jacobi differential
equation
\begin{equation}\label{eq:HJ}
	\frac{\partial f_s( p^+,q^-,t)}{\partial s}=
	\bG(p^+,\frac{\partial f_s ( p^+,q^-,t)}
		{\partial p^+},
	\frac{\partial f_s ( p^+,q^-,t)}
		{\partial q^-} ,q^-),
\end{equation}
where
\begin{eqnarray}
	\nonumber \bG(p^+,q^+,p^-,q^-,t)=\{\bh^+-\bh^-,k_s\}=\\
	\sum\limits_{
		\g^+\in\Pc^+,\g^-\in\Pc^-} \kappa_{\g^-}\frac{\partial \bh^-(p^-,q^-,t)}
	{\partial p^-_{\g^-}}
	\frac {\partial k_s( p^+,q^-,t)}{\partial  q^-_{\g^-}}+\\
	\nonumber \kappa_{\g^+}\frac{\partial k_s( p^+,q^-,t)}{
	\partial  p^+_{\g^+}}\frac {\partial \bh^+(p^+,q^+,t)}
	{\partial q^+_{\g^+}} \,.
\end{eqnarray}
Here $\kappa_\g$ denotes, as usual,  the multiplicity of
$\g$.


We can view  the correspondence
\begin{equation*}
	f ( p^+,q^-,t)\mapsto f_s( p^+,q^-,t),
\end{equation*}
where $f_s$ is the solution of
the above equation (\ref{eq:HJ}) with the initial data
$f_0=f$,
as a non-linear operator $ S^s:\fL\to\fL$.
Let us denote by
$T^s_f $ the linearization of $ S^s$ at a point
$f$.
The next proposition is a rational version of Proposition
\ref{prop:SFT-chain}. It can be either deduced from
\ref{prop:SFT-chain}, or similarly  proven by    differentiation
with respect to the parameter $s$.
Denote by $\cS$ the subspace of $\fL$ which consists of solutions of
the Hamilton-Jacobi equation
(\ref{eq:HJ1}), i.e.
\begin{equation*}
	\widehat\bh|_{L_f}=0,\quad\hbox{  where}\quad
	L_f=\{p^-_\g=\kappa_\g\frac{\partial
		{f}}{\partial q^-_\g}, q^+_\g=\kappa_\g\frac{\partial
		{  f }}{\partial p^+_\g}\}.
\end{equation*}


\begin{proposition}\label{prop:RSFT-chain}
	\begin{description}
		\item{1.} The subspace  $\cS\subset\fL$ is invariant
		      under the flow $S^s$.
		\item{2.}   For $f\in \cS$
		      the isomorphism  $T^s_f:\fL\to\fL$
		      satisfies the equation
		      \begin{equation}
			      T^s_f\circ d^{f }=d^{S^s(f)}\circ T^s,
		      \end{equation}
		      and thus defines an isomorphism
		      $H_*(\fL,d^{f})\to
			      H^*(\fL,d^{S^s(f)} )$.
		\item{3.}  For $f\in\cS$ the diagram
		      \bigskip\bigskip

		      \centerline{$ \mathop{\fL\qquad}\limits_{\;
					      \; \nwarrow \, \left(f\right)^\pm}
				      \mathop{\longrightarrow}\limits^{T^s_f}
				      \mathop{\fL}\limits_{\nearrow \, \left(S^s(f)\right)^\pm}$}

		      \centerline{$\fP^\pm\;$}

		      \bigskip

		      homotopically commutes.
	\end{description}
\end{proposition}

Theorem     \ref{thm:SFT-chain} reduces on the level of
rational curves
to the following

\begin{theorem}\label{thm:RSFT-chain}
	Let $\bF^0$, $\bF^1$ and $\bK$ be as in Theorem
	\ref{thm:SFT-chain}. Set $\bff^0=\bF^0_0,\;\bff^1=\bF^1_0,\;
		\bk=\bK_0.$ Then
	$\bff_0$ and $\bff_1$ are homotopic, i.e. they can be included into a family
	$\bff_s,\,s\in [0,1]$, such that the Hamilton-Jacobi equation
	(\ref{eq:HJ}) holds with $f_s=\bff_s$ and  $k_s\equiv\bk$.
\end{theorem}

Hence, Proposition \ref{prop:RSFT-chain} implies
\begin{corollary}\label{cor:RSFT-chain}
	For a generic compatible deformation $J_s$,
	$s\in[0,1]$, we have
	\begin{description}
		\item{1.}
		      The operator  $S^1:\fL\to\fL$ defines an automorphism of
		      the space  of solutions of (\ref{eq:HJ1});
		\item{2.} The linearization $T^1 =T^1_{\bff^0}$ of $S^1$ at the point
		      $\bff_0$ satisfies the
		      equation
		      \begin{equation}
			      T^1\circ d^{\bff^0}=d^{\bff^1}\circ T^1,
		      \end{equation}
		      and thus defines an isomorphism
		      $H_*(\fL,d^{\bff^0})\to
			      H^*(\fL,d^{\bff^1})$.
		\item{2.} The diagram
		      \bigskip\bigskip

		      \centerline{$ \mathop{\fL\qquad}\limits_{\;
					      \; \nwarrow \, \left(\bff^0\right)^\pm}
				      \mathop{\longrightarrow}\limits^{T^1}
				      \mathop{\fL}\limits_{\nearrow \, \left(\bff^1\right)^\pm}$}

		      \centerline{$\fP^\pm$}

		      \bigskip

		      homotopically commutes.
	\end{description}
\end{corollary}


To formulate the ``classical level'' corollary of Theorem
\ref{thm:RSFT-chain}
we assume, as usual, that $W$ is a homology cobordism.
\begin{theorem}\label{thm:classical-chain}
	The homomorphisms  $\Psi^1_{J_0} ,\Psi^1_{J_1}: \fA^+\to\fA^-$ associated
	to two compatible almost complex structures $J_0$ and $J_1$ are
	homotopic, i.e. there exists a map $\Delta:\fA^+\to\fA^-$ such
	that
	$$\Psi^1_{J_1} -\Psi^1_{J_1} =\partial^-\circ\Delta+\Delta\circ\partial^+.$$
\end{theorem}
The map $\Delta$ can be
expressed through the function
$\bk\in\fL$. However, unlike the case of usual Floer homology
theory, $\Delta$ and $\bk$ are related via a first order non-linear PDE
(which can be deduced from the equation (\ref{eq:HJ})),
and thus  one cannot write a general explicit formula  relating
$\Delta$ and $\bk$.


\subsection{Composition of cobordisms}\label{sec:composition}
In this section we   study the behavior of
potentials and associated algebraic structures under
the operation of composition of directed symplectic cobordisms.

Let    us recall (see Section \ref{sec:splitting}) that   given
a dividing contact type hypersurface $V$ in a
directed symplectic cobordism $W=\ora{V^-V^+}$ one can split $W$
into a composition $W=W_-\circledcirc W_+$ of cobordisms $W_-=\ora{V^-V}$ and
$W_+=\ora{VV^+}$. From the point of view of an almost
complex structure        the process of splitting consists of deforming
an original almost complex structure $J=J^0$ to an
almost complex structure $J^\infty$, such that the restrictions
$J_\pm=J^\infty|_{W_\pm}$   are compatible  with the structure
of (completed) directed symplectic cobordisms $W_\pm$.

Conversely,  directed symplectic cobordisms
$W_-=\ora{V^-V}$ and
$W_+=\ora{VV^+}$ with matching data
on the common boundary    can be glued into
a cobordism         $W=\ora{V^-V^+}$ in the following sense:
there exists a family  $J^\tau$ of almost complex structures
on $W$ which in the limit  splits $W$ into the
composition of cobordisms $W_-=\ora{V^-V}$ and
$W_+=\ora{VV^+}$.



\bigskip
In order to write the formula relating   the potentials
of $W$ and $W_\pm$ we  first need to make more explicit the
relation  between $2$-dimensional homology classes realized  by
holomorphic curves in $W_\pm$ and $W$. We will keep
assuming that there are no torsion
elements in $H_1$.
Let us recall (see Sections \ref{sec:dynamics} and
\ref{sec:holomorphic} above) that  we have chosen curves ${C}^i_-\subset
	W_-,i=1,\dots, m_-,\;\;{C}^j_+\subset W_+,j=1,\dots,m_+,$
and ${C}^k
	\subset W,k=1,\dots m,$ which represent bases of first homology of
the respective cobordisms. We also have chosen
for every periodic orbit $\g\in
	\Pc_\a$ of the Reeb field $R_\a$ on $V$ a surface
$F^\g_\pm$ realizing homology in $W_\pm$ between $\g$ and a linear
combination of basic curves ${C}^i_\pm$.
For our current purposes we have to make one extra choice: for
each curve $ {C}^i_\pm$ we choose a surface $S^i_\pm$ which
realizes homology in $W$ between ${C}^i_\pm$ and the
corresponding linear combination of the curves ${C}^1,\dots,
	{C}^m$.
All the choices enable us to associate with every orbit
$\g\in\Pc_\a$ a homology class $C^\g$ which is realized by the chain
$$F^\g_+-F^\g_-+\sum\limits_1^{m_+} n^+_jS^j_+-\sum\limits_1^{m_-}
	n^-_iS^i_-\,,$$
where $\partial F^\g_\pm=[\gamma]-\sum\limits_1^{m_\pm}
	n^{\pm}_j{C}^j_\pm$. We will denote by $d^\g$ the degree of
$C^\g$, i.e. the string of its coordinates in the
chosen basis
$A_1,\dots,A_N\in H_2(W)$.



Let us define an operation
\begin{equation}
	\star:\fD\fD_-\otimes \fD\fD_+ \to \fD\fD,
\end{equation}
where   $\fD\fD_\pm=\fD\fD_{W_\pm}$ and
$\fD\fD= \fD\fD_{W} $.
For
$F=\sum\limits_{\Gamma} f_{\Gamma}(t^-,q^-,\hbar,z^-)
	p^{\Gamma}\in\fD\fD_-$ and
$
	G=\sum\limits_{\Gamma^+} g_{\Gamma^+}
	(t^+,q ,\hbar,z^+)(p^+)^{\Gamma^+} \in\fD\fD_+$ we set
\begin{equation}
	\begin{split}
		 & F  {\star} G(t,q^-,p^+,\hbar,z)=               \\
		 & \Big(
		\sum\limits_{\Gamma }\wt f_\Gamma(t,q^-,\hbar,z)
		\hbar^s  \prod\limits_{i=1}^s
		\kappa_{\g_{i }}z^{d^{\g_i}}
		\overrightarrow{\frac{\partial}{\partial
				q_{\g_i}}}
		\sum\limits_{\Gamma^+} \wt g_{\Gamma^+}
		(t,q ,\hbar,z)(p^+)^{\Gamma^+}\Big)\Big|_{q=0}\,. \\
	\end{split}
\end{equation}
Here we denote by $\wt f_\Gamma$ and $\wt
	g_{\Gamma^+}$ the images
of $ f_\Gamma$ and $ g_{\Gamma^+}$ under the coefficient
homomorphisms $H_2(W_\pm)\to H_2(W)$.
Let us explain what happens with the
variables $t$ and $z$ in more details.  Let
$A_1^\pm,\dots, A^\pm_{N^\pm},$
and
$A_1,\dots, A_{N},$
be   the chosen bases in     $H_2(W_\pm)$ and $ H_2(W)$.
Then we have $$i^\pm_*(A^\pm_k)=\sum\limits_{j=1}^{N^\pm}n^\pm_{kj} A_j,$$
where $k=1,\dots, N$,  $(n^\pm_{kj})$ are integer matrices,
and $i^\pm:W_\pm\to W$ the inclusion maps.

We have
\begin{equation*}\begin{split}
		 & f_{\Gamma}(t^-,q^-,\hbar,z^-)
		= \sum\limits_{d=(d_1,\dots, d_{N^-})}f_{\Gamma,d}(t^-,q^-,\hbar)(z_1^-)^{d_1}\dots
		(z_{N^-}^-)^{d_{N^-}},           \\
		 & g_{\Gamma^+}
		(t^+,q ,\hbar,z^+) = \sum\limits_{d=(d_1,\dots, d_{N^+})}g_{\Gamma^+,d}(t^+,q,\hbar)(z_1^+)^{d_1}\dots
		(z_{N^+}^+)^{d_{N^+}}  ,         \\
	\end{split}
\end{equation*} where
we denote by $z_\pm$ the ``$z$-variables" in $W_\pm$.
Then
\begin{equation*}
	\begin{split}
		 & \wt f_\Gamma(t,q^-,\hbar,z)=
		\sum\limits_{d=(d_1,\dots,d_{N_-})} \wt f_{\Gamma,d}(t|_{W_-},q^-,\hbar)z_1^{M_1^-}
		\dots z_N^{M^-_{N}},              \\
		 & \wt g_{\Gamma^+}(t,q,\hbar,z)=
		\sum\limits_{d=(d_1,\dots,d_{N_+})} \wt g_{\Gamma^+,d}(t|_{W_+},q^-,\hbar)z_1^{M_1^+}
		\dots z_N^{M^+_{N}},              \\
	\end{split}
\end{equation*}
where $M^\pm_j=   \sum\limits_{k=1}^{N^\pm}  n^\pm_{kj}d_k$, $j=1,\dots,N$.

\bigskip
Let us  observe
\begin{lemma}\label{lm:star}
	\begin{description}
		\item{1.} The operation $\star$ is associative.
		\item{2.}   For $F\in\hbar^{-1 }\fD_-,G\in\hbar^{-1 }\fD_+$ there exists a unique function $H\in \hbar^{-1 }\fD$,
		      such that
		      $$
			      e^H=e^F\star e^G.
		      $$
	\end{description}
\end{lemma}
We will denote this $H$ by $F\lozenge G$, so that we have
$e^{F\lozenge G}=e^F\star e^G$.
We will also consider the maps
$$\lozenge G:\hbar^{-1}\fD_-\to \hbar^{-1}\fD,\;\;\lozenge
	G(F)=F\lozenge G,\,F\in\fD_-,$$
and
$$F\lozenge:\hbar^{-1}\fD_+\to \hbar^{-1}\fD,\;\;F\lozenge
	(G)=F\lozenge G,\,G\in\fD_+,$$
and for even $F,G$ their linearizations:
\begin{equation*}
	\begin{split}
		 & T_F(\lozenge G):\hbar^{-1}\fD_-\to \hbar^{-1}\fD,   \\
		 & T_F(\lozenge G)(f)=\frac{d\big(F+\varepsilon
			f)\lozenge G\big)}{d\varepsilon}\big|_{\varepsilon=0}=e^{-F\lozenge
		G}\big((fe^F)\star e^G\big),\;\; f\in\hbar^{-1} \fD_-, \\
	\end{split}
\end{equation*}
and
\begin{equation*}
	\begin{split}
		 & T_G(F\lozenge  ):\hbar^{-1}\fD_+\to \hbar^{-1}\fD,        \\
		 & T_G(F\lozenge  )(g)=\frac{d\big(F \lozenge (G+\varepsilon
			g)\big)}{d\varepsilon}\big|_{\varepsilon=0}=e^{-F\lozenge
		G}\big( e^F \star (ge^G)\big),\;\; g\in\hbar^{-1} \fD_+,     \\
	\end{split}
\end{equation*}

Let us first formulate an algebraic
\begin{proposition}\label{prop:SFT-composition}
	Suppose that $F\in \hbar^{-1}\fD_-$ and $G\in \hbar^{-1}\fD_+$ are
	even elements, which
	satisfy the equations
	$$D_{W_-}(e^F)=\overrightarrow{\bH^-}e^F-e^F\overleftarrow{\bH}=0$$  and $$D_{W_+}(e^G)=
		\overrightarrow{\bH}e^F-e^F\overleftarrow{\bH^+}=0,$$
	where $\bH^\pm=\bH_{V^\pm},\,\bH=\bH_V$.
	Then we have
	\begin{description}
		\item{1.} $D_W(e^{F\lozenge G})=\ora{\bH^-}\, e^{F\lozenge G}-e^{F\lozenge
			      G}\,\ola{\bH^+}=0$.
		\item{2.} The homomorphisms
		      $ T_G(F\lozenge  ):\hbar^{-1}\fD_+\to \hbar^{-1}\fD$ and
		      $T_F(\lozenge G):\hbar^{-1}\fD_-\to \hbar^{-1}\fD$ satisfy
		      the equations $$T_G(F\lozenge  )\circ
			      D^{G}=D^{F\lozenge G}\circ T_G(F\lozenge )$$ and $$T_F(
			      \lozenge G )\circ D^{F}=D^{F\lozenge G}\circ T_F(
			      \lozenge G),$$ and in particular they define homomorphisms
		      of the corresponding homology algebras:
		      $$ \left( T_G(F\lozenge  )\right)_*:H_*( \fD_+,D^G)\to H_*(  \fD,D^
			      {F\lozenge G})$$ and
		      $$ \left( T_F( \lozenge G  )\right)_*:H_*( \fD_-,D^G)\to H_*(  \fD,D^
			      {F\lozenge G}).$$
		\item{3.} $$ T_F( \lozenge G)\circ F^-   =
			      (F \lozenge G)^-$$ and $$  T_G( F\lozenge)
			      \circ G^+= (F \lozenge G)^+.$$
		\item{4.}
		      Suppose we are given three cobordisms $W_1,W_2,W_3$ with matching ends
		      so that we can  form  the  composition
		      $W_{123}=W_1\circledcirc W_2 \circledcirc W_3$, and series
		      $F_i\in\hbar^{-1}\fD_i=\hbar^{-1}\fD_{W_i},\,i=1,2,3$, such that
		      $D_{W_i}e^{F_i}=0$, $i=1,2,3$.
		      Then
		      \begin{equation}
			      T_{F_1\lozenge F_2}(\lozenge F_3)\circ T_{F_1}(\lozenge
			      F_2)=T_{F_1}(\lozenge (F_2\lozenge F_3)).
		      \end{equation}
	\end{description}
\end{proposition}
The proof of this proposition is immediate from the definition of
the corresponding operations. For instance, to prove
\ref{prop:SFT-composition}.1 we write
\begin{equation*}
	\begin{split}
		\ora{\bH^-}\,\big(e^{F\lozenge G}\big)-\big(e^{F\lozenge
		G}\big)\,\ola{\bH^+} & =\ora{\bH^-}\,e^F\star e^G -e^F\star e^G\ola
		{\bH^+}                                                                                \\
		                     & =\left(\ora{\bH^-}\,e^F\right)\star e^G -e^F\star\left( e^G\ola
		{\bH^+}\right)                                                                         \\
		                     & =\left(e^F\,\ola{\bH}\right)\star e^G
		-e^F\star\left( \ora{\bH}e^G\right).                                                   \\
	\end{split}
\end{equation*}
To finish the argument
let us consider a cylindrical cobordism $W_0=V\times\R,$
take the function
$I=\sum \kappa_\g^{-1}p_\g q_\g$. Taking into account associativity
of $\star$ (see \ref{lm:star}) we have
\begin{equation}
	\ora {f}e^G=(fe^I)\star e^G,\quad\hbox{and}\quad
	e^F\ola{f}=e^F\star (fe^I)\,.
\end{equation}
Hence, we have
\begin{equation*}
	\begin{split}
		 & \left(e^F\,\ola{\bH}\right)\star e^G
		-e^F\star\left( \ora{\bH}e^G\right)                            \\
		 & =e^F\star(\bH e^I)\star e^G-  e^F\star(\bH e^I)\star e^G=0. \\
	\end{split}
\end{equation*}
\bigskip

Any cohomology class from $H^*(W)$
can be represented by a form $t$ which splits into the sum of forms
$t_\pm$  with cylindrical ends on $W_\pm$,
so that we have $t_\pm|_{V}=t_V$.
Let us define now a series
$\bF^\infty\in\hbar^{-1}\fD$
by the formula
\begin{equation}\label{eq:SFT-gluing}
	{\bF^\infty(q^-,p^+,t)}=  {\bF_-(q^-,p,t_-)}
	\lozenge
	{\bF_+(q,p^+,t_+)} ,
\end{equation}
where $p,q$      are variable associated to the space $H^*(\Pc)$
of   periodic orbits of the Reeb vector field
$R_\a$ of the contact form $\alpha$ on $V$.

The following theorem is the main claim of this section, and
similar to Theorems \ref{thm:HH} and \ref{thm:SFT-cobordism}
and \ref{thm:SFT-chain} it  is a statement about the
boundary of an appropriate moduli space of holomorphic curves.
This time we deal with limits of $J^s$-holomorphic curves
in $W$ when $s\to\infty$,
i.e. when the family $J^s$ realizes the splitting
of $W$ into the composition $W_-\circledcirc W_+$,
see Theorem \ref{thm:comp2} above.


\begin{theorem}\label{thm:SFT-composition}
	The element $\bF^\infty$ is homotopic to the
	potential
	$\bF=\bF_{W,J ,\a^\pm} $
	for any generic  compatible almost complex structure $J$ on $W$.
\end{theorem}
\bigskip
Let us now describe the above results on the level of rational potentials.
Let  $W_-=\ora{V^-V }$, $W_+=\ora{VV^+}$ and
$W=W_-\circledcirc W_+=\ora{V^-V^+}$ be as above. Set
$\bh^\pm=\bh_{V^\pm},\bh=\bh_V$,
$\widehat\bh_-=\bh^- -\bh$, $\widehat\bh_+=\bh  -\bh^+$,
$\widehat\bh=\bh^+-\bh^-$,
$\fL_\pm=\fL_{W_{\pm}}$ and $ \fL=\fL_W$.

The operation
$\lozenge:\hbar^{-1}\fD_-\times\hbar^{-1}\fD_+\to\hbar^{-1}\fD$ defined above reduces on the
rational level to the
operation $$\sharp:\fL_-\times\fL_+\to\fL,$$ defined as follows.
For $ f_\pm\in\fL_\pm$ we set
\begin{equation}
	f_-\sharp f_+(q^-,p^+)=\big(f_-(q^-,p)+f_+(q,p^+)
	-\sum_{\g\in\Pc}\kappa_\g^{-1}z^{-d_{\g}}q_\g p_\g\big)\big|_{L},
\end{equation}
where
\begin{equation*}
	L=
	\begin{cases}
		q_\g= & \kappa_\g z^{d_\g}\frac{\partial f_-}{\partial p_\g}; \\
		p_\g= & \kappa_\g z^{d_\g}\frac{\partial f_+}{\partial q_\g}. \\
	\end{cases}
\end{equation*}
Notice that given series $$F_-=\hbar^{-1}\sum\limits_0^\infty
	(F_-)_g\hbar^g\in\hbar^{-1}\fD^-\quad\hbox{ and}\quad
	F_+=\hbar^{-1}\sum\limits_0^\infty (F_+)_g\hbar^g\in\hbar^{-1}\fD^+$$  with
$F_-\lozenge F_+= \hbar^{-1}\sum\limits_0^\infty (F_-\lozenge
	F_+)_g\hbar^g\in\hbar^{-1}\fD $ then  $$(F_-\lozenge F_+)_0=(F_-)_0\sharp
	(F_+)_0.$$
We will also consider the operations
\begin{equation*}
	\begin{split}
		 & \sharp f_+:\fL_-\to\fL,\;\; \sharp f_+(f_-)=f_-\sharp
		f_+\;\;\hbox{and}\;\;
		\sharp f_-:\fL_+\to\fL,\;\; \sharp f_-(f_+)=f_-\sharp
		f_+,                                                     \\
	\end{split}
\end{equation*}
and their linearizations
\begin{equation*}
	\begin{split}
		 & T_{f_-}(\sharp f_+):\fL_-\to\fL,\;\; T_{f_-}(\sharp f_+)(g)=
		(g|_{L_+})\sharp f_+
		\quad\hbox{and}                                                          \\
		 & T_{f_+}(\sharp f_-):\fL_+\to\fL,\;\; T_{f_+}(\sharp f_-)(g)=f_-\sharp
		(g|_{L_-})\,.                                                            \\
	\end{split}
\end{equation*}
Here we view $g|_{L_+}$ (resp. $g|_{L_-}$) as an element of
$\fL_+$  which depends on variables $q^-$ as parameters (resp. an element of
$\fL_-$, which depends on $p^+$ as parameters).
We have the following rational version
of Theorem \ref{prop:SFT-composition}.
\begin{proposition}\label{prop:RSFT-composition}
	Suppose that even elements $f_\pm\in\fL_\pm=\fL_{W_{\pm}}$ satisfy
	equation (\ref{eq:HJ1}), i.e.
	\begin{equation*}
		\widehat\bh_\pm|_{L_{f_\pm}}= 0 ,
	\end{equation*}
	where
	\begin{equation*}
		L_{f_-}=
		\begin{cases}
			q_\g       & =k_\g\frac{\partial f_-}{\partial p_\g};\;\;\g\in\Pc                     \\
			p^-_{\g^-} & =\kappa_{\g^-}\frac{\partial f_-}{\partial q^-_{\g^-}},\;\;\g^-\in\Pc^-, \\
		\end{cases}
	\end{equation*}
	and
	\begin{equation*}
		L_{f_+}=
		\begin{cases}
			p_\g       & =k_\g\frac{\partial f_+}{\partial q_\g};\;\;\g\in\Pc                     \\
			q^+_{\g^+} & =\kappa_{\g^+}\frac{\partial f_+}{\partial p^+_{\g^+}},\;\;\g^+\in\Pc^+. \\
		\end{cases}
	\end{equation*}
	Then
	\begin{description}
		\item{1.} The function $f_-\sharp f_+$ satisfies the Hamilton-Jacobi
		      equation
		      $$\widehat\bh_{L|_{f_-\sharp f_+}}=0;$$
		\item{2.} The homomorphisms $T_{f_-}(\sharp f_+):\fL_-\to\fL$ and
		      $T_{f_+}( f_-\sharp):\fL_+\to\fL$ satisfy the equations
		      \begin{equation*}
			      \begin{split}
				      T_{f_-}(\sharp f_+)\circ d^{f_-}= & d^{f_-\sharp f_+}\circ T_{f_-}(\sharp
				      f_+),                                                                     \\
				      T_{f_+}( f_-\sharp)\circ d^{f_+}= & d^{f_-\sharp f_+}\circ T_{f_+}(\sharp
				      f_-)\,,                                                                   \\
			      \end{split}
		      \end{equation*}
		      and hence define homomorphisms of the corresponding
		      homology algebras:
		      \begin{equation*}
			      \begin{split}
				      \big(T_{f_-}(\sharp f_+)\big)_*: & H_*(\fL_-,d^{f_-})\to H_*(\fL,d^{f_-\sharp f_+}), \\
				      \big(T_{f_+}(f_-\sharp )\big)_*: & H_*(\fL_-,d^{f_-})\to H_*(\fL,d^{f_-\sharp f_+}); \\
			      \end{split}
		      \end{equation*}
		\item{3.}
		      \begin{equation*}
			      \begin{split}
				      T_{f_-}(\sharp f_+)\circ (f_-)^-= & (
				      f_-\sharp f_+)^-\,,                   \\
				      T_{f_+}(\sharp f_-)\circ (f_+)^-= & (
				      f_-\sharp f_+)^+
				      \,;                                   \\
			      \end{split}
		      \end{equation*}
		\item{4.}
		      Suppose we are given three cobordisms $W_1,W_2,W_3$ with matching ends
		      so that we can  form  the  composition
		      $W_{123}=W_1\circledcirc W_2 \circledcirc W_3$, and series
		      $f_i\in\hbar^{-1}\fL_i= \fL_{W_i}$  which satisfy
		      Hamilton-Jacobi equations
		      $\widehat{\bh}_{W_i}|_{L_{f_i}}=0,\,i=1,2,3$.
		      Then
		      \begin{equation*}
			      T_{f_2}(\sharp f_3)\circ T_{f_1}(\sharp
			      f_2)=T_{f_1}(\sharp (f_2\sharp f_3)).
		      \end{equation*}
	\end{description}
\end{proposition}

Let $t$ be a closed form on $W$ which is split into two forms $t_\pm$ on $W_\pm$ with
cylindrical ends. Set $\bff_\pm=\bff_{W_\pm}$ and
\begin{equation}
	\bff^\infty(q^-,p^+,t)=\bff_-(q^-,p,t_-)\sharp \bff_+(q,p^+,t_+).
\end{equation}
Alternatively $\bff^\infty$ can be defined as
the first term  in the expansion
$\bF^\infty=\hbar^{-1}\sum\limits_0^\infty\bF^\infty_g\hbar^g$.
The following theorem is a rational analog, and a direct
corollary of Theorem \ref{thm:SFT-composition}.
\begin{theorem}
	\label{thm:RSFT-composition}
	The series $\bff^\infty(q^-,p^+,t)$  and  $\bff_{W,J}(q,p,t)$
	are  homotopic  for any generic  compatible almost complex structure
	$J$ on $W$.
\end{theorem}

Coming down to the   ``classical" level, let us assume that
$W,W_-$ and $W_+$ are homology cobordisms (see \ref{sec:3algebras}
above). Thus there are   defined  the homomorphisms  $\bPsi  :\fA^+\to\fA^-$,
$\bPsi_+ :\fA^+\to\fA $ and $\bPsi_- :\fA \to\fA^-$,
see Section \ref{sec:relative} above. Set
$\bPsi_\infty=\bPsi_+\circ\bPsi_-$.
Then we have
\begin{theorem}\label{thm:classical-composition}
	For any generic compatible almost complex structure $J$ on $W$
	homomorphisms
	$\bPsi_1=\bPsi_J,\bPsi_\infty:\fA^+\to\fA^-$ are chain
	homotopic.
\end{theorem}

\subsection{Invariants of contact
	manifolds}\label{sec:contact-invariants}



Theorem \ref{thm:SFT-composition}  allows us to define
SFT-invariants of contact manifolds.
Let $(V,\xi)$ be a contact manifold,  and
$\alpha^+$ and $\alpha^-$
two contact forms for $\xi$,
such that $\alpha^+>\alpha^-$, i.e.
$\alpha^+=f\alpha^-$, for a  function $f>1$.
Then for an appropriately chosen function $\zeta:V\times\R\to(0,\infty)$
the form
$\omega=d(\zeta\alpha^-)$ on $W=V\times\R$ is symplectic, and
$(W,\omega)$ is a directed symplectic cobordism between $(V,\alpha^-)$
and $(V,\alpha^+)$.  Let  $t^\pm$ be two cohomologous forms on $V$, and $t$ be a  closed
form  on $W$ with cylindrical ends which restricts to $t^\pm$ on $V^\pm$.
Suppose we are also given almost complex structures $J^\pm$ on $V$,
compatible with $\alpha^\pm$, which
are extended to  a compatible almost complex structure $J$ on $W$.
We will call a  directed symplectic cobordism  $(W,J,t)$,
chosen in the  above way, a {\it concordance} between
the data on its boundary. Notice, that concordance becomes   an
equivalence relation if we identify contact forms proportional
with a constant factor. A concordance $(W,J,t)$ is called {\it
		trivial} if  $W=V\times\R$, the almost complex structure
$J$ is translationally  invariant, and
$t$ is the pull-back of a form $t_+$ under the projection $W\to
	V$.


Let us denote, as usual,   by $(\fW^\pm,D^\pm)$  the differential Weyl algebras
associated to the data at the
ends of the cobordism $W$, by $(\fD,D_W)$ the $D$-module
$\fD(W,J,\a^\pm)$,  by $\bF\in\fW$
the    potential of the cobordism $W$, and by
$\bF^\pm:(\fW^\pm,D^\pm)\to(\fD,D_W)$ the
corresponding homomorphisms
of differential algebras defined in (\ref{eq:end-homomorphisms}).

\begin{theorem}\label{thm:SFT-invariance}
	For any concordance $(W,J,t)$ the  homomorphisms $$\bF^\pm:(\fW^\pm,d^\pm)\to(\fD,D_W)$$
	are quasi-isomorphisms
	of differential algebras. In particular, the homology algebras
	$H_*(\fW^-,D^-)$ and
	$H_*(\fW^+,D^+)$ are isomorphic.
\end{theorem}

\noindent\proof We will prove   \ref{thm:SFT-invariance}  in three
steps.

\noindent Step 1. Let us begin with the trivial concordance $(W ,J
	,t  )$. In this case $\fD$ can be identified with $\fW^\pm$ and we
have $\bF(q,p,t)=\hbar^{-1}\sum\kappa_\g^{-1}q_\g p_\g$. Hence
\begin{equation*}
	\bF^-(f)=e^{-\bF}\ora{f}e^{\bF}=
	f=e^{-\bF}\left(
	e^{\bF}\ola{f}\right)=\bF^+(f).
\end{equation*}

\noindent Step 2. If we add now to $t$ a form $d\theta$, where
$\theta$ has a compact support, and change $J$ in a compact part
of $W$ then according to Theorem \ref{thm:SFT-chain}
the potential $\bF_{W,J}(t+d\theta)$ remains the same
up to homotopy, and hence Corollary \ref{cor:SFT-chain} implies
that the homomorphisms  $\bF^\pm_*$   induced on homology remain
unchanged.



\noindent Step 3. Now assume that $(W,J,t)=(W^1,J^1,t^1)$ is a general
concordance. Consider the reversed concordance $(W^2,J^2,t^2)$, so
that the compositions $$(W^{12}=W^1\circledcirc W^2,J^{12}=J^1\circledcirc
	J^2,t^{12}=
	t_1\circledcirc t_2)$$ and
$$(W^{21}=W^2\circledcirc W^1,J^{21}=J^2\circledcirc J^1,t^{21}=
	t_2\circledcirc t_1)$$ of concordances $(W^1 ,J^1 ,t^1 )$
and $(W^2 ,J^2 ,t^2 )$   are   as in Step 2.
Then according to Theorem
\ref{thm:SFT-composition}
$\bF_{W^{12},J^{12}}( t^{12})$ is homotopic to
$$\bF_{W^1,J^1}(t^1)\lozenge\bF_{W^2,J^2}(t^2)=
	\bF^1\lozenge\bF^2$$ and
$\bF^{21}=\bF_{W^{21},J^{21}}( t^{21})$ is homotopic to
$$\bF_{W^2,J^2}(t^2)\lozenge\bF_{W^1,J^1}(t^1)=\bF^2\lozenge\bF^1.$$ Hence
Proposition \ref{prop:SFT-composition}
implies
\begin{equation*}
	\Id=\left(\bF_{W^1\circledcirc W^2 }\right)^-_*
	=\left(T_{\bF^1}(\lozenge\bF^2) \right)_*\circ (\bF^1)^-_*
\end{equation*}
and
\begin{equation*}
	\begin{split}
		 & \Id= \left(T_{\bF^1}\left(\lozenge(\bF^2\lozenge\bF^1) \right)
		\right)_*                                                         \\
		 & = \left(T_{\bF^1\lozenge\bF^2}(\lozenge \bF^1)\right)_*
		\circ \left(T_{\bF^1} (\lozenge  \bF^2)\right)_* .                \\
	\end{split}
\end{equation*}
Hence
$\left(T_{\bF^1}(\lozenge\bF^2) \right)_*$,  $\;(\bF^1)^-_*$,
and similarly    $(\bF_1)^+_* $
are isomorphisms. \qed

\bigskip


The following rational and classical analogs of Theorem
\ref{thm:SFT-invariance}
can be either deduced directly from Theorem
\ref{thm:SFT-invariance}, or alternatively can be proven similarly
to \ref{thm:SFT-invariance}  using \ref{thm:RSFT-chain} (resp. \ref{thm:classical-chain}) and
\ref{thm:RSFT-composition} (resp. \ref{thm:classical-composition}).

\begin{theorem}\label{thm:RSFT-invariance}
	For any concordance $(W,J,t)$ the  homomorphisms $$\bff^\pm:(\fP^\pm,D^\pm)\to(\fL,D_W)$$
	are quasi-isomorphisms
	of differential algebras. In particular,  Poisson homology
	algebras $H_*(\fP^\pm,d^\pm)$  are isomorphic.
\end{theorem}



\begin{theorem}\label{cor:classical-invariance}
	For any concordance $(W,J,t)$ the  homomorphism  $$\bPsi:(\fA^+,\partial^+)\to
		(\fA^-,\partial^-)$$
	is a quasi-isomorphism
	of differential algebras.
\end{theorem}
\bigskip

The definition of the differential algebras $(\fW,D),\;(\fP,d)$ and $(\fA,\partial)$
depends on the choice
of a coherent orientation (see Section \ref{sec:orientation}), and
of spanning surfaces and framings
of periodic orbits
(see Section \ref{sec:dynamics}).
As it is stated in Theorem \ref{thm:coherent}  a coherent orientation
is determined by a choice of asymptotic operators associated
with each periodic orbit $\g$. Let $\bH'$ be the new  Hamiltonian which
one gets by changing the orientation of the asymptotic operator
associated with a fixed  periodic orbit $\g $. One can then check that the
change of variables  $(p_\g, q_\g)\mapsto(-p_\g,-q_\g)$ is an
isomorphism  between the differential algebras $(\fW,D^{\bH})$ and
$(\fW,D^{\bH'})$.
Different choices for spanning   surfaces and framings of periodic orbits do not affect
$\mod\;2$ grading but change the integer grading of the
differential algebras.

\begin{remark}\label{rem:other-choices}
	{\rm
		An accurate introduction of  virtual cycle techniques
		would reveal that even more choices should be made.   However,  an independence
		of  all these extra choices can be also established following the scheme of this section.
	}
\end{remark}

\subsection{A differential equation for potentials of symplectic cobordisms} \label{sec:master}

In this section we describe  differential equations for
the  potentials $\bF_W$ and $\bff_W$ of a  directed symplectic
cobordism with a non-empty boundary. These equations completely
determine  the potentials, and
in
combination with gluing Theorems  \ref{thm:SFT-composition}  and
\ref{thm:RSFT-composition} they provide in many cases   an effective
recursive
procedure for computing     potentials $\bF_W$ and $\bff_W$,
and even  Gromov-Witten invariants of closed symplectic manifolds  $W$
(see some examples in Section \ref{sec:computing} below).

\bigskip
Let us assume for simplicity that $W$ has only a positive end
$E^+=V\times(0,\infty)$, and choose a basic system
$\Delta_1,\dots,\Delta_k$, $\Theta_1,\dots,\Theta_m$ of closed
forms so that the   following conditions are satisfied:
\begin{description}
	\item{a)} $\Delta_1,\dots,\Delta_k$ form a basis of $H^*(W)$, and the restrictions
	      $\delta_i=\Delta_i|_V$, $i=1,\dots,l$ for $l\leq k$ form a basis
	      of    $\im\big(H^*(W)\to H^*(V)\big)$;
	\item{b)}  $\Theta_1,\dots,\Theta_m$ are compactly
	      supported and    represent a basis of
	      $\Ker\big(H^*_{\comp}(W)\to H^*(W)\big)$,
	\item{c)} there exist  forms $\theta_1,\dots,\theta_m$ on $V$ and
	      a compactly supported $1$-form $\rho$ on $(0,+\infty)$, such that
	      $\Theta_j=e_*\big(\rho\wedge \pi^*(\theta_j)\big),\;j=1,\dots, m$, where

	      $\pi$ is the projection $E=V\times(0,\infty)\to V$ and $e:E\hookrightarrow W$ is the inclusion.
	      In  other words, $\Theta_j$ equals $\rho\wedge \pi^*(\theta_j)$
	      viewed as a form on $W$.
\end{description}
\medskip

\begin{theorem}\label{thm:SFT-master}
	Let $\bH=\bH_{V,\a,J}$ be the Hamiltonian associated with the
	contcat manifold $V$.
	Set $$\bH^j(t_1,\dots,t_l,q,p)=\Big(
		\frac{\partial \bH}{\partial s_j}(\sum\limits_{i=1}^l
			t_i\delta_i+s_j\theta_j,q,p)\Big)\Big|_{s_j=0}
		,\;j=1,\dots m,$$
	$$\bF^0(t_1,\dots,t_k, p)=\bF_{W,J}(\sum
		t_i\Delta_i,p),$$
	and define
	$\bF(t_1,\dots,t_k,\tau_1,\dots,\tau_m, p)$
	by the formula
	\begin{equation}
		e^{\bF(t_1,\dots,t_k,\tau_1,\dots,\tau_m,
		p)}=e^{\bF^0(t_1,\dots,t_k,p)}
		\overleftarrow\bG(t_1,\dots,t_l,\tau_1,\dots,\tau_m,p),
	\end{equation}  where we denote by
	$\overleftarrow\bG$ the operator obtained from
	\begin{equation}
		\bG(t_1,\dots,t_l,\tau_1,\dots,\tau_m,q,p)
		= e^{\tau_m\bH^m(t_1,\dots,t_l,q,p)}\dots
		e^{\tau_1\bH^1(t_1,\dots,t_l,q,p)}
	\end{equation}
	by quantizing   $q_\g=\kappa_\g
		\hbar\overleftarrow{\frac{\partial }{\partial
				p_\g}}$.
	Then  $\bF(t_1,\dots,t_k,\tau_1,\dots,\tau_m, p)$  is
	homotopic to  $$\bF_{W,J}(\sum\limits_{i=1}^k
		t_i\Delta_i+\sum\limits_{r=1}^m\tau_r\Theta_r,p).$$
\end{theorem}
\proof
Set  $$T^j(s)={\bF_{W,J}(\sum
	t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+s\tau_j\Theta_j,p) }.$$
We have $$T^j(1)=T^{j+1}(0)\quad\hbox{
		for}\;\;j=1,\dots,m-1 ,     $$
$$
	T^m(1)= {\bF_{W,J}(\sum\limits_{i=1}^k
	t_i\Delta_i+\sum\limits_{r=1}^m\tau_r\Theta_r,p)},$$
and
$$T^1(0)={\bF_{W,J}(\sum
t_i\Delta_i,p) }={\bF^0(t_1,\dots,t_k, p)}.$$
Let $S^j\in\hbar^{-1}\fD$ be defined from the equation
$$e^{S^j}=e^{T^j(0)}e^{\tau_j\ola{\bH^j(t_1,\dots,t_l,q,p)} }.$$
It is enough to prove that
$  T^j(1)$ is homotopic    to $S^j$ for $j=1,\dots,m$.
We have
\begin{equation*}
	\begin{split}
		 & \frac{\partial e^{T^j(s)}}{\partial s}=
		\frac{\partial T^j(s)}{\partial s} e^{T^j(s)}     \\
		 & =  e^{T^j(s)}\sum\limits_d\sum\limits_{g,u  ,v
			=0}^\infty     \frac{1}{u!v ! }
		\up0\langle \tau_j\Theta_j,
		\underbrace{\sum\limits_{i=1}^k
			t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+s\tau_j\Theta_j}_u;
		\underbrace{p ,\dots,p }_{v }
		\rangle^d_{g}z^d \hbar^{g-1}.                     \\
	\end{split}
\end{equation*}
The compactly supported form $\Theta_j$ is exact in $W$,
$$\Theta_j=d\wt\Theta_j,$$
where $\wt\Theta_j$ is closed at infinity, has a cylindrical    end,
and $\wt\Theta_j|_V=\theta_j$.
Hence,
\begin{equation*}
	\frac{\partial T^j(s)}{\partial s}  =
	\ \sum\limits_d\sum\limits_{g,u  ,v =0}^\infty
	\frac{1}{u!v !}
	\up0\langle \tau_jd\wt \Theta_j,
	\underbrace{\sum\limits_{i=1}^k
		t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+s\Theta_j}_u;
	\underbrace{p ,\dots,p }_{v }
	\rangle^d_{g}z^d \hbar^{g-1}
\end{equation*}
\begin{equation*}
	\begin{split}
		 & = d\big( \sum\limits_d\sum\limits_{g,u  ,v=0}^\infty  \frac{1}{u!v
			!}
		\up0\langle \tau_j\wt \Theta_j,
		\underbrace{\sum\limits_{i=1}^k
			t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+s\tau_j\Theta_j}_u;
		\underbrace{p ,\dots,p }_{v }
		\rangle^d_{g}z^d \hbar^{g-1}\big)                                     \\
		 & = \frac{\partial}{\partial u}
		\Big( d\big( \sum
		\limits_d\sum\limits_{g,u  ,v=0}  \frac{1}{u!v!}                      \\
		 & \up0\langle
			\underbrace{\sum\limits_{i=1}^k
				t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+s\tau_j\Theta_j
				+u\tau_j\wt \Theta_j}_u;
			\underbrace{p ,\dots,p }_{v}
		\rangle^d_{g}z^d \hbar^{g-1}\big)\Big)\Big|_{u=0}                     \\
		 & =  \frac{\partial}{\partial u}\Big( d\big(
			\bF_{W,J}(\sum\limits_{i=1}^k
				t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+
				s\tau_j\Theta_j+u\tau_j\wt \Theta_j,p)\big)\Big)\Big|_{u=0} ,
	\end{split}
\end{equation*}
where $d$ denotes the de Rham differential.
Using  equation (\ref{eq:non-closed2}) we get
\begin{equation*}
	\begin{split}
		 & d\big(
		\bF_{W,J}(\sum\limits_{i=1}^k
			t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+
		s\tau_j\Theta_j+u\tau_j\wt \Theta_j,p)\big) =                                 \\
		 & e^{-\bF_{W,J}}\big( e^{\bF_{W,J}}\ola\bH(\sum\limits_{i=1}^l t_i\Delta_i +
		u\tau_j\theta_j,p) \big),                                                     \\
	\end{split}
\end{equation*}
and hence
\begin{equation*}
	\begin{split}
		 & \frac{\partial T^j(s)}{\partial s}=
		\frac{\partial}{\partial u}\Big( e^{-\bF_{W,J}}
		\big( e^{T^j(s)}\ola\bH(\sum\limits_{i=1}^l t_i\Delta_i +
		u\tau_j\theta_j,q,p) \big)\Big)\Big|_{u=0}                                  \\
		 & = \tau_j e^{-T^j(s)}\Big(-\bF^j  (t_1,\dots,t_k,\tau_1,\dots,\tau_j,s,p)
		\big(e^{T^j(s) }\ola\bH(\sum\limits_{i=1}^l t_i\Delta_i ,q,p)\big)          \\
		 & + \big( e^{T^j(s)} \bF^j  (t_1,\dots,t_k,\tau_1,\dots,\tau_j,s,p)\big)
		\ola\bH(\sum\limits_{i=1}^l t_i\Delta_i ,q,p)                               \\
		 & +e^{T^j(s)}
		\ola\bH^j(t_1,\dots,t_l,q,p)\Big) =
		\tau_j e^{-T^j(s)}\Big(\big( e^{T^j(s)} [\bF^j , \ola\bH]
		+e^{T^j(s)}
		\ola\bH^j\Big),                                                             \\
	\end{split}
\end{equation*}
where
\begin{equation*}
	\begin{split}
		 & \bF^j  (t_1,\dots,t_k,\tau_1,\dots,\tau_j,s,p) \\
		 & =\frac{ \partial   }{\partial u} \big(
		\bF(\sum
			t_i\Delta_i+\sum\limits_{r=1}^{j-1}\tau_r\Theta_r+
			s\tau_j\Theta_j+u\wt\Theta_j,p)\big)\big|_{u=0}
	\end{split}
\end{equation*}
and
$$\bH^j( t_1,\dots,t_l,q,p)=   \frac
	{ \partial   }{\partial u} \big(
	\bH(\sum t_i\Delta_i +
		u\theta_j,q,p)   \big)\big|_{u=0}\,.$$
Therefore,
\begin{equation*}
	\frac{\partial e^{T^j(s)}}{\partial s}=  e^{T^j(s)}
	\frac{\partial T^j(s)}{\partial s}
	=\tau_je^{T^j(s)}\big([\bF^j , \ola\bH]+\ola\bH^j\big)\,.
\end{equation*}

Let us define now a family
$U^j(s)\in \hbar^{-1}\fD,s\in [0,1]$
by the formula
\begin{equation}
	e^{U^j(s)}=e^{T^j(s)}e^{(1-s)\tau_j\ola
	{\bH^j}(t_1,\dots,t_l,q,p)}\,.
\end{equation}
Then $U^j(s)$ is a homotopy
between $S^j$ and $T^j(1)$. Indeed,   we have
$U^j(0)=S^j$ and $U^j(1)=T^j(1)$.
On the other hand we get an equation
\begin{equation*}
	\frac {\partial e^{U^j(s)}}{\partial s} =\tau_je^{U^j(s)}
	\big(-\ola\bH^j+ [\bF^j
		, \ola\bH]+\ola\bH^j\big) =e^{U^j(s)}[\tau_j\bF^j , \ola\bH]\;,
\end{equation*}
which is the definition of homotopy (see Section
\ref{sec:chain} above).\qed

\bigskip




We formulate now a version of Theorem \ref{thm:SFT-master} for
rational potentials.

Set $$\bh^j(t_1,\dots,t_l,q,p)=\frac{\partial \bh}{\partial
		s_j}(\sum t_i\delta_i+s_j\theta_j,q,p) ,\;j=1,\dots m,$$ and for
any $\bgg\in \fL$ we denote by $L_{\bgg}$ the Lagrangian variety of
$\bV$, defined by the equation
\begin{equation}
	L_\bgg=\{q_\g= \kappa_\g\frac{\partial\bgg}
	{\partial p_\g}\}.
\end{equation}
\begin{theorem}\label{thm:RSFT-master}
	Let $\bff(t_1,\dots,t_k,\tau_1,\dots,\tau_m, p)$
	be the solution of the   Hamilton-Jacobi equation
	\begin{equation} \label{eq:RSFT-master}
		\frac{\partial \bff}{\partial \tau_j} (t_1,\dots,t_k,
		\tau_1,\dots,\tau_m)=
		\bh^j(t_0,\dots,t_l,q,p)|_{L_{\bff}}
	\end{equation}
	with the initial condition
	$$\bff|_{\tau_j=0}=\bff_{W,J}(\sum
		t_i\Delta_i+\sum\limits_{r\neq j}\tau_r\Theta_r,p).$$
	Then $$\bff(t_1,\dots,t_k,\tau_1,\dots,\tau_m, p)$$ is
	homotopic to $$\bff_{W,J}(\sum
		t_i\Delta_i+\sum\limits_{r=1}^m\tau_r\Theta_r,p).$$
\end{theorem}


\subsection{Invariants    of Legendrian
	knots}\label{sec:Legendrian}
Symplectic Field Theory can be extended to include Gromov-Witten
invariants of pairs $(W,L)$, where $L$ is a Lagrangian
submanifold of a symplectic manifold $W$.   The corresponding relative object is a
pair $(W,L)$, where $W=\ora {V^-V^+}$ is a directed symplectic cobordism between
contact manifolds $(V^\pm,\a^\pm)$, and $L$ is a Lagrangian cobordism between Legendrian
submanifolds $\Lambda^\pm\subset V^\pm$.  More precisely, we assume that Lagrangian submanifold
$L$ is cylindrical at infinity over $\Lambda^\pm$, i.e. there exists $C>0$, such that
$\;L\cap V^-\times (-\infty, -C]=\Lambda^-\times (-\infty, -C]\;$ and
$\; L\cap V^+\times (C,\infty]=
	\Lambda^+\times (C,\infty]\;$.
In other words, we require $L$
to coincide at infinity with  symplectizations
of Legendrian submanifolds $\Lambda^\pm$.

The moduli space of holomorphic curves to be considered in this case
consists of  equivalence classes of     holomorphic curves   with boundary which can have
punctures of two types,
interior  and at the boundary.  The boundaries of holomorphic curves
are required to be mapped to the Lagrangian submanifold $L$,   the holomorphic  curves
should be cylindrical over periodic orbits from $\Pc^\pm$ at interior punctures,
while at boundary punctures
we require them to be asymptotically cylindrical over Reeb chords connecting points  of the Legendrian submanifolds
$\Lambda^\pm\subset V^\pm$.  A  more precise definition is given below.
The algebraic structure arising from the stratification of boundaries of these moduli spaces is more complicated
than in the closed case. First of all, unlike the interior punctures the    punctures
at the boundary are cyclically ordered, which leads to associative, rather than graded commutative algebras.
Second, the ``usual" cusp degenerations of curves with boundary
at boundary points (see \cite{Gromov-holomorphic}) has
in this case codimension
$1$, rather than $2$ as in the  closed case, and hence the  combinatorics of such
degenerations  should also be a part of the
algebraic formalism.

We will sketch in this paper only the simplest of three cases of SFT, namely the ``classical case",
which corresponds to the theory of moduli spaces of holomorphic
disks with only $1$ positive puncture at the boundary.
\bigskip

Let $(V,\xi=\{\a=0\})$ be a contact  manifold with a fixed
contact form $\a$, $W=V\times \R$ its symplectization
with a compatible almost complex structure $J$,
$\Lambda\subset V$ a  compact Legendrian submanifold,
and $L=\Lambda\times\R\subset W$ the symplectization of $\Lambda$, i.e.
the corresponding Lagrangian cylinder in $W$.   We  assume that all periodic orbits
of  the Reeb   vector field $R_\a$ are non-degenerate
and fix a marker
on every periodic orbit. We also consider the set $\Cc$   of Reeb chords
connecting points on $\Lambda$, and impose an extra
non-degeneracy condition along the   chords from $\Cc$
by requiring that the linearized flow of $R_\a$  along
a chord   $c\in\Cc$  connecting points $a,b\in\Lambda$
sends  the tangent  space $T_a(\Lambda)$ to
a space transversal to $T_b(\Lambda)$.
We also require that none of
the chords from $\Cc$ be a part of an orbit from
$\Pc$.
Under these assumptions, the set $\Cc$ is finite: $\Cc=\{c_1,\dots,c_m\}$.

We will restrict the consideration to the case when
\begin{equation}
	\pi_1(V)=0,\; \pi_2(V,\Lambda)=0,\quad\hbox{ and}\quad w_2(\Lambda)=0.
\end{equation}
First two assumptions are    technical and can be removed (comp. Section \ref{sec:dynamics} above).
However, the third one
is essential for orientability of the involved moduli spaces of holomorphic curves. Moreover, the invariants
we define depends on a particular choice of a spin-structure on $\Lambda$.
\footnote{We thank K. Fukaya for pointing this out.}

As in  Section \ref{sec:dynamics} we choose capping surfaces $F_\g$ for $\g\in\Pc$, and  for each chord
$c\in \Cc$ we  also choose   a surface $G_c$
which is bounded by  a curve
$c\cup\delta_c, $ where $\delta_c\subset \Lambda$.
The choice of  surfaces $F_\g,\,\g\in\Pc,$  allows us to define
Conley-Zehnder indices of  periodic orbits
(see Section \ref{sec:dynamics} above). Similarly, surfaces $G_c$ enable us to define
	{\it Maslov indices} $\mu(c) ,\,c\in\Cc$.   Namely,  let us consider a Lagrangian subbundle of $\xi|_{\partial G_c}$,
which consists of  the Lagrangian sub-bundle
$T\Lambda|_{ \delta_c}\subset \xi|_{\delta_c}$ over $\delta_c$, together with
the family  of Lagrangian  planes  $T_u\subset \xi_u,u\in c$, which are images of $T_a(\Lambda)$ under the linearized flow of
the Reeb field $R_\a$.  Choose a symplectic trivialization of $\xi|_{ \partial G_c}$ which extends
to $G_c$.   With respect to this trivialization the above sub-bundle can be viewed
as a path of Lagrangian planes in a
symplectic vector space.  The Maslov index of such path
is defined as in \cite{Robbin-Salamon}.

\medskip
Consider a unit disk
$D\subset\C$ with punctures $$\left(\{z^+,z_1^-,\dots,z_\sigma^-\}\cup\{x^-_1,\dots, x^-_s\}\right),$$
where  $\bz=\{z^+,z_1^-,\dots,z_\sigma^-\}$, $0\leq\sigma\leq m$,
is  a   counter-clockwise ordered set of punctures on $\partial D$,
and  $\bx=\{x^-_1,\dots, x^-_s\}$ is an ordered set of interior punctures.
As usual  we provide  interior punctures with asymptotic markers.

Let us denote by
$\Mc^A(\{c_{i_1},\dots,c_{i_\sigma}\},\{\g_1,\dots,\g_s\},c_i;W,\Lambda,J)$
the moduli space of
$J$-holomorphic maps
\begin{equation*}
	(D\setminus \left(\bz\cup\bx\right),
	\partial\left(D\setminus \left(\bz\cup\bx\right)\right) \to (W,L),
\end{equation*}
which
are asymptotically cylindrical at    the negative end over the periodic orbit $\g^-_{k}$
at the puncture $x^-_{i_k}$, and over the chord $c_{i_k}$ at the puncture $z_k$,
asymptotically cylindrical at    the positive  end over the chord $c_i$
at the puncture $z^+$, and which send
asymptotic markers of interior punctures to
the  markers on the  corresponding
periodic orbits.

Two maps are called equivalent if they differ by a conformal map
$D\to D$ which preserves all punctures, marked points and     asymptotic markers.
Each moduli space  $\Mc^A(c_i,\{c_{i_1},\dots,c_{i_\sigma}\},\{\g_1,\dots,\g_s\};W,\Lambda,J)$ is invariant under
translations  $V\times\R\to V\times\R$ along the factor  $\R$, and we
denote the corresponding quotient moduli space  by
$$\Mc^A(c_i,\{c_{i_1},\dots,c_{i_\sigma}\},\{\g_1,\dots,\g_s\};W,\Lambda,J)/\R\;.$$

Let $(\fA,\partial)=(\fA(V,\alpha),\partial_J)$ be the graded commutative differential algebra
defined in Section
\ref{sec:3algebras} above, or rather its specialization at the point $0$.
Consider a graded  associative  algebra $\fK=\fK(V,\Lambda,\alpha)$ generated
by elements $c_i\in \Cc$ with coefficients in the algebra $\fA$.
We define a differential $\partial_{\Lambda}=\partial_{\Lambda,J}$
on $\fK$ first on the generators $c_i$ by the formula
\begin{equation}\label{eq:d-leg}
	\partial_{\Lambda}(c_i)=
	\sum \frac{n_{\Gamma,I,d}}
	{k!\prod_1^k \kappa_{\g_j}^{i_j}i_j!}
	c_{j_1}\dots c_{j_\sigma}
	q_{\g_1}^{i_1}\dots q_{\g_k}^{i_k}z^d,
\end{equation}
where the sum is taken over all $d\in H_2(V)$, all ordered sets of
different periodic orbits $\Gamma=\{\g_1,\dots,\g_k\} $,
all multi-indices  $J=(j_1,\dots,j_\sigma),\,1\leq j_i\leq m$,
and $I=(i_1,\dots,i_k)$, $i_j\geq 0, $ and where the coefficient
$n_{\Gamma,I,d}$  counts the algebraic number of elements of the
moduli space $$\Mc^d\big(c_i,\{c_{j_1},\dots,c_{j_\sigma}\},
	\{\underbrace{\g_1,\dots,\g_1}_{i_1},\dots,
	\underbrace{\g_k,\dots,\g_k}_{i_k}\}\big)/\R,$$ if this space is
$0$-dimensional, and equals $0$ otherwise. The differential
extends to the whole  algebra $\fK$ by the graded Leibnitz rule.
However, it does not treat coefficients as constants: we have
$\partial_\Lambda(q_\g)=\partial(q_\gamma)$, where  $\partial$ is
the differential defined on the algebra $\fA$.

Then we have
\begin{proposition}
	$$  \partial_{\Lambda}^2=0.$$
\end{proposition}
Given a family   of contact forms $\Lambda_\tau,
	\alpha_\tau,
	J_\tau\;\tau\in[0,1]$
of Legendrian submanifolds, contact forms, and compatible almost complex structures one can define, similar to the  case of closed
contact manifolds (see Sections \ref{sec:relative}  and Section \ref{sec:chain} above)
a   homomorphism of differential algebras
$$\Psi_S:\fK(V, \Lambda_0,\alpha_0)\to\fK(V, \Lambda_1,\alpha_1),$$
which is independent up to homotopy of the choice of a connecting
homotopy.
Composition of homotopies generates composition of homomorphisms, and hence one conclude
\begin{proposition}
	The quasi-isomorphism type of the differential algebra
	$$(\fK(V,\Lambda,\alpha),\partial_{\Lambda,J})$$ depends only on the contact structure $\xi$
	and the Legendrian isotopy class of $\Lambda$. The
		{\em Legendrian contact homology} algebra
	$H_*(\fK,\partial_\Lambda)$ has a structure of a module over
	the contact homology algebra
	$H^\cont_*(V,\xi)=H_*(\fA,d)$, and it is an invariant of the Legendrian knot (or link) $\Lambda$.
\end{proposition}


The theory looks especially simple when the contact structure $\xi$ on
$V$ admits a contact form $\alpha$ such that the Reeb vector
field $R_\a$ has no closed periodic orbits. If, in addition
the space of trajectories is a  manifold $M$ (e.g. when
$V=J^1(N)=T^*(N)\times\R$ with a contact form $dz+pdq$), then
$W$ is automatically symplectic, and the projection $\pi:W\to V$ sends the Legendrian submanifold
$\Lambda\subset V$ to an immersed {\it Lagrangian} submanifold
$L\looparrowright M$ with transverse self-intersection points. These points
correspond to Reeb chords  $c_i$
connecting points on $\Lambda$.
Hence,  the algebra $\fK$ in this case is just a free associative
algebra, generated over $\C$ (or $\C$) by the
self-intersection points of $L$. It is possible
to choose a compatible  almost complex structures
$J$ on  the symplectization  $W=V\times\R$ and  $J_M$ on $M$
to make
the projection $W\to M$ holomorphic (comp. Section \ref{sec:Bott} below). Then  punctured
holomorphic disks in $W$  from moduli spaces
$\Mc^A(c_i,\{c_{i_1},\dots,c_{i_\sigma}\} ;W,\Lambda,J)$
project to $J_M$-holomorphic disks in $M$ with boundary in the
immersed Lagrangian  manifold $L$. Conversely, one can
check that each such disk  lifts to a disk from  the
corresponding moduli space $\Mc^A(c_i,\{c_{i_1},\dots,c_{i_\sigma}\}
	;W,\Lambda,J)$, uniquely, up to translation along
the $\R$-factor in $W=V\times\R$. This is especially useful when $\dim M=2$.  In
this case $L$ is an immersed curve, and the holomorphic disks
are precisely immersed, or branched disks with their boundaries in $L$.
Moreover, branched disks are never rigid, because the branching
point may vary. Hence, the  differential
$\partial:\fK\to\fK$ can be defined in this case in a pure
combinatorial way, just   summing the terms  corresponding
to  all  appropriate immersed disks whose boundary consists of arcs of $L$, and
which are locally convex near their corner.

Yu. Chekanov independently realized  (see \cite{Chekanov}) this program  for
Legendrian links in the standard contact $\R^3$.
He was also  motivated by the  hypothetical description of the
compactification of the  moduli spaces of holomorphic discs,
but has chosen to prove the  invariance of the quasi-isomorphism type
of the differential algebra $(\fK,\partial)$ in a pure
combinatorial way.  In fact, he proved   a potentially stronger    form  of equivalence
of
differential algebras of isotopic Legendrian links,
which
he called     stable tamed isomorphism.  Stable
tame
isomorphism implies quasi-isomorphism, but we do not know
whether it is indeed stronger. Let also note that
Chekanov considered a   $\Z_2$-version of the theory.
In some examples it works better
the  $\Q$-version, which is provided by our formalism.
J. Etnyre--J. Sabloff (\cite{Etnyre-Sabloff}) and L. Ng (\cite{Ng}) worked out
the combinatorial
meaning of signs dictated by the coherent orientation
theory (see Section \ref{sec:orientation} above), and proved
invariance of the
stable tame type of the differential algebra $(\fK,\partial)$
{\it defined over $ \Z$}. Note that Chekanov's paper \cite{Chekanov}
also contains   examples  which show that the  stable  tame
$\Z_2$-isomorphism type do distinguish some Legendrian knots,
which could not be  previously distinguished.




Similar to the absolute case of SFT, one can define   further invariants of Legendrian
submanifolds by including in the formalism higher-dimensional moduli spaces. For instance,  by introducing
marked points on the boundary
of the disk
one gets a non-commutative deformation of Legendrian  contact homology
along the homology of Legendrian
manifolds. This is useful, in particular, to define invariants of
Legendrian links with ordered components.
However, the full-scale generalization of Symplectic Field Theory  to
directed symplectic-Lagrangian cobordisms between pairs
of contact manifolds and their Legendrian submanifolds, which would formalize
information  about moduli spaces of   holomorphic curves of arbitrary genus and arbitrary number
of positive and negative punctures, is not straightforward due to existence of different type
of codimension $1$ components on the boundary of the corresponding moduli spaces.
We will discuss this theory
in one of our future papers.




\subsection{Remarks, examples, and further algebraic constructions in
	SFT}\label{sec:remarks}
\subsubsection{Dealing with torsion elements in $H_1$} \label{sec:torsion}
Let us discuss grading issues for a contact manifold
$(V,\xi=\{\a=0\})$ in the case when
the torsion part  of $H_1(V)$ is
non-trivial. As we will see it is impossible to assign in a coherent way
an integer grading to torsion elements and still keep the property
that the Hamiltonian $\bH$ has total grading $-1$.  We will
deal with this problem by assigning to some elements fractional
degrees, and thus obtain a rational grading, incompatible with the
canonical $\Z_2$-grading. In fact the
term ``grading" is  misleading in this case, and more appropriately one
should talk about
an Euler vector field with rational coefficients.

Let us split  $H_1(V)$ as $T\oplus F$, where $T$  and $F$ are   the
torsion and free parts, respectively. As in Section \ref{sec:dynamics}
above let us  choose curves ${C}_1,\dots,{C}_k$ representing a basis
of $F$, fix a trivialization of the bundles $\xi_{{C}_i}$,
for any periodic orbit $\g\in\Pc_\a$ with $[\g]\in F$ choose a
surface $F_\g$ which realizes the homology between $[\g]$ and a
linear combinations $\sum n_i [{C}_i] $, and trivialize the
bundle $\xi|_\g$ accordingly.
For any other  periodic orbit $\g$ let $\g_l$ be its smallest multiple which
belong to  $F$. In particular, the bundle $\xi_{\g_l}$ is
already trivialized by a framing $f$. The problem is that in general there is no
framing over $\g$ which would produce $f$ over $\g_l$. Choose then
an arbitrary framing $g$  over $\g$ and denote by $g_l$ the
resulting framing over $\g_l$.  Let
$2m(g_l,f)\in\pi_1(Sp(2n-2,\R))=\Z$ be the Maslov class of the
framing $g_l$ with respect to $f$. The Conley-Zehnder indices of
$\g_l$ with respect to these two gradings are then
related  by the formula
\begin{equation*}
	\CZ(\g|f)=\CZ(\g|g_l)+2m(g_l,f).
\end{equation*}
We then assign to $\g$ the fractional  degree
\begin{equation}
	\deg \g=\CZ(\g|g)-\frac{2m(g_l,f)}{l}\,.
\end{equation}
With this modification SFT can be extended to the case of contact
manifolds with no restrictions on $H_1$. However, the price we pay
is that this grading, even if integer, may not be compatible with
the universal $\Z_2$-grading which determines the sign rules.



\subsubsection{Morse-Bott formalism}\label{sec:Bott}


Our assumption that all periodic orbits from $\Pc_\a$ for the
considered contact forms $\a$
are non-degenerate, though generic,  but is very inconvenient for
computations: in many interesting examples periodic orbits
come in continuous families. Sometimes  the  Reeb
flow is periodic, and it sounds quite stupid to destroy this beautiful
symmetry.

In fact the above formalism can be adapted to this ``Morse-Bott"
case. We sketch below how this could be done   for the periodic
Reeb flow of an $S^1$-invariant form of a
pre-quantization space.
We consider below only the ``semi-classical" case which concerns
moduli spaces of rational holomorphic curves.



Let $(M,\omega)$ be a symplectic manifold  of dimension $2n-2$
with  an integral cohomology class $[\omega]\in H^2(M)$. We will assume for simplicity
that $H_1(M)=0$.
The
pre-quantization space $V$ is a circle bundle over $M$ with
first Chern class equal to $[\omega]$. The fibration $\pi:V\to M$
admits a   $S^1$-connection form $\alpha$ whose curvature is
$\omega$. It   defines a $S^1$-invariant contact structure  $\xi$
on $V$, transversal to the fibers  of the fibration. The Reeb flow
of $R_\a$ is periodic, so all its trajectories
are closed and coincide with the fibers of the fibration $\pi$, or their multiples.


The fiber of the fibration $V$ is a torsion element
in $H_1(V)$, and if $l$ is the greatest divisor of the class $[\omega]$ then
the  $l$-multiple of the fiber is homological to $0$.


Consider the cylindrical cobordism  (the symplectization)
$W=V\times\R$ with an almost
complex structure $J$ compatible with $\alpha$
and denote by $\Mc_{0,r}(s|W,J,\a)$ the moduli  space of rational
holomorphic curves in $W$ with $s$ punctures and $r$ marked points.
Near punctures the curves are required to be  asymptotically
cylindrical over some fibers of $V$, or their multiples.
However, we do not specify to which particular fiber they are
being asymptotic, or whether this fiber is
considered
on the positive, or negative end of $W$. We
do not equip   curves from $\Mc_{0,r}(s|W,J,\a)$
with asymptotic markers of punctures, because   we  cannot
fix  in a continuous way  points on each simple periodic orbit,
as we did in the non-degenerate case.

As it was already mentioned in Section \ref{sec:almost} above,
$W$ can be viewed  as the total space of the complex  line bundle  $L$ associated with
the $S^1$-fibration $V\to M$, with the zero-section removed, and
the almost complex structure $J$ can be chosen
compatible with the structure of this bundle, so that the projection   $W\to M$
becomes holomorphic with respect to a certain almost complex structure $J_M$ on $M$
compatible with $\omega$.
Then automatically the   bundle induced over  any holomorphic curve in the base
has a structure of a holomorphic line bundle.
With this choice of $J$ each holomorphic curve   $f\in \Mc_{0,r}(s|W,J,\a)$ projects
to a $J_M$-holomorphic sphere $\overline{f}:
	\C P^1\to M$,   and  can be viewed as a meromorphic section of the   induced
bundle $(\overline{f})^*L$ over $\C P^1$.  This bundle is ample, and hence  poles of its
sections
correspond to   the  {\it negative} ends of $f$, while zeroes  correspond to  the positive ones.
Notice that although  the moduli spaces
$\Mc_{0,r}(s|W,J,\a)$ can be identified with the moduli spaces
of closed  holomorphic curves in a $\C P^1$-bundle over $M$
with prescribed tangencies to two divisors,
their compactifications are different, and in particular the
compactification of the first moduli space may have codimension one strata
on its boundary.



The correspondence $f\mapsto\overline{f}$ define a fibration
$$\pr:\Mc_{0,r}(s|W,J,\a)/\R\to \Mc_{0,r+s}(M,J_M).$$
The fiber $\pr^{-1}(\overline{f})$ is   the
union of  (an infinite number of) disjoint circles, which are indexed by
sequences of integers $(k_1,\dots,k_{s+r})$ with $\sum k_i=d_0
	=\int\limits_{A}\omega$,
where $A\in H_2(M)$ is the homology class realized by $\overline{f}$,
and where  there are precisely
$s$  non-zero coefficients  $k_i$.

Let us  consider two copies $\Pc^\pm$ of  the space $\Pc=\Pc_\a$ of periodic orbits,
as we need to differentiate
between positive and negative ends of holomorphic curves. We will write $\ddot{\Pc}=\Pc^+\cup\Pc^-$
and define  the   evaluation maps:
\begin{equation}
	ev_0:\Mc_{0,r}(s|W,J,\a)/\R\to V^{\times r}\;\; \hbox{ and}\;\;
	ev^+_-:\Mc_{0,r}(s|W,J,\a/\R)\to\ddot{\Pc}^{\times s}\,.
\end{equation}

Here $ev^+_-$ associates with each puncture the corresponding
point of $\ddot\Pc$.
The space $\Pc^\pm$  can be presented as
$    \coprod\limits_{k=1}^{\infty}\Pc^\pm_k, $
where each $\Pc^\pm_k$ is a copy   of $M$, associated
with $k$-multiple orbits.

We will denote forms on $\Pc^+$ by $p$, on $\Pc^-$ by $q$,
denote by $p_k, q_k$ their restrictions to $\Pc_k^\pm$, and organize them
into   Fourier series
$u=\sum\limits_{k=1}^\infty(p_ke^{ikx}+q_ke^{-ikx})$. If we are given a
basis of $H^*(M)$ represented by forms $\Delta_1,\dots,\Delta_a$
we will consider only forms from the space generated by this
basis, and write $p_k=\sum\limits_{i=1}^a p_{k,i}\Delta_i,
	q_k=\sum\limits_{i=1}^a q_{k,i}\Delta_i$ and denote by
$u_i$ the  $\Delta_i$-component of $u$, i.e.
$$u_i=\sum\limits_{k=1}^\infty(p_{k,i}e^{ikx}+q_{k,i}e^{-ikx})\;\;\hbox{
		and}\;\;
	u=\sum\limits_1^a u_i\Delta_i.$$


Given a  closed form $t$ on $V$ and  a class $A\in H_2(V)$
we define the correlator
\begin{equation}
	\begin{split}
		 & \up{-1}\langle
		\underbrace{t,\dots,t}_r; \underbrace{u,\dots,u}_s\rangle^A_{0} =               \\
		 & \int\limits_{\overline{\Mc^A_{0,r}(s|W,J,\a)/\R} } ev_0^*\big(t\otimes \dots
		\otimes t\big)\wedge (ev^+_-)^*\big(u \otimes\dots
		\otimes u\big) \bigg{|}_{x=0}.                                                  \\
	\end{split}
\end{equation}

Let us  choose a basis $A_0,\dots, A_N$ in
$H_2(M)$ in such a way that $\int\limits_{A_0}\omega=l>0$ and
$\int\limits_{A_i}\omega= 0$ for $i=1,\dots, N$.
Then the classes $A_i,i\geq 1 ,$ lift to classes $\wt{A}_i\in H_2(V)$  which
under the assumption $H_1(M)=0$ form
a basis of $
	H_2(V)$. The   degree
$d=(d_1,\dots,d_N )$ of a class
$A\in H_2(V)$ is a vector of its coordinates in this basis.


To associate an absolute   homology
class with a holomorphic curve
we  pick   the $l$-multiple (recall that   $l$ denotes the greatest divisor of $\omega$)
of the fiber   $\g$ over a point $x\in M$
and
choose a lift of the surface representing the class
$A_0$ with $\int\limits_{A_0}\omega =l$ as a spanning surface
$F_\g$. Any other $m$-multiple of  $\g$ we will cap with the chain
$\frac ml[F_\g]$. However, to fix a spanning surface
for a    fiber over any other point $y\in  M$  or
its multiples, one needs to make some extra choices, for instance   fix
a path connecting $x$ and $y$. The condition $H_1(M)=0$ guarantees
independence of the homology class of the resulting surface of
the choice of this connecting path.  Notice that   with this choice,
the degree of $f\in \Mc_{0,r}(s|W,J,\a)/\R$  equals $(d_1,\dots,d_N)$, if the degree of its projection
$\pr(f)\in\Mc_{0,r+s}(M,J_m)$ is equal to $(d_0,d_1,\dots,d_N)$.


In this notation the rational Hamiltonian $\bh=\bh_{V,J,\a }$ is defined
by the formula
\begin{equation}
	\bh(t,u)=\sum\limits_{d}\sum\limits_{r,s=0}^\infty\frac{1}{r!s!}
	\up {-1} \langle \underbrace{t,\dots,t}_r;\underbrace{u,\dots,u  }_{s}
	\rangle_{0}^{d }  z^d.
\end{equation}

Suppose that a basis of $H^*(M)$, represented by
closed forms   $\Delta_1,\dots,\Delta_a$, is  chosen in such
a way that   for $b\leq
	a$  the system forms $\wt{\Delta}_j=\pi^*(\Delta_j),\,j=1,\dots,b$, generate
the image $\pi^*(H^*(M))\subset H^*(V)$, and the forms
$\wt{\Theta}_1,\dots,\wt{\Theta}_c$,
complete  it
to a basis of $H^*(V)$.
We will denote  (graded) coordinates in the space generated by the forms
$\wt{\Delta}_j,\,j=1,\dots, b$ and
$\wt{\Theta}_1,\dots,\wt{\Theta}_c$ by
$ (t,\tau)=(t_1,\dots,t_b,\tau_1,\dots, \tau_c)$.


As usual, the Hamiltonian $\bh$ is viewed as an element  of  a  graded
commutative Poisson
algebra $\fP$,
which consists of formal power series of coordinates of vectors $p_k$
and  $T=(t,\tau)=
	(t_1,\dots,t_b,\tau_1,\dots,\tau_c)$
with coefficients
which are polynomials of coordinates of vectors $q_k=(q_{k,1},\dots,q_{k,a})$.
The coefficients of these polynomials
belong to a certain completion (see condition (\ref{eq:Novikov}) above) of the group algebra
of $H_2(V)$.
All  the variables $p_{k,i},q_{k,i}$  have in this case
the same parity as forms $\Delta_i$, the parity of variables $t_i$ and $\tau_j$ is the same as the  degree of
the corresponding
forms $\wt \Delta_i$ and $\wt\Theta_j$.
If $l=1$, i.e. when $H_1(V)=0$, then  the integer grading of variables which corresponds
to the   choice of capping surfaces described above  is defined
as follows:
\begin{equation}\label{eq:dim-Bott}
	\begin{split}
		\deg t_i     & =\deg \wt{\Delta}_i-2; \\
		\deg \tau_i  & =\deg\wt{\Theta}_i-2;  \\
		\deg q_{k,i} & =\deg\Delta_i-2+2ck;   \\
		\deg p_{k,i} & =\deg\Delta_i-2-2ck;   \\
		\deg z_i     & ==2c_1(A_i)            \\
	\end{split}
\end{equation}
where $c=c_1(A_0)$.
As it was explained in Section \ref{sec:torsion}  if $l>1$ one can only define fractional degrees, given by the above
formulas (\ref{eq:dim-Bott}) with $c=\frac{c_1(A_0)}{l}$.

The following proposition is useful for applications (see below the discussion
of Biran-Cieliebak conjecture about subcritical symplectic mainfolds).
It follows from the fact that all the  moduli spaces
$\Mc_{g,r}(s|W,J,\a)$ which we defined above  are even-dimensional.

\begin{proposition}\label{prop:even-dim}
	Let $(V,\xi)$ be the contact pre-quantization space for a
	symplectic manifold $(M,\omega)$. Then all contact homology algebras
	$$H_*^{\SFT}(V,\xi)\big|_{t=0},H_*^{\RSFT}(V,\xi)\big|_{t=0},H_*^{\cont}(V,\xi)\big|_{t=0}$$
	specialized  at $0\in H^*(V)$
	are
	free graded, respectively  Weyl, Poisson, or commutative algebras,
	generated by  elements
	$$p_{k,i},q_{k,i},\;\;i=1,\dots,a,\;k=1,\dots\,.$$ In particular, the parts of all these homology
	algebras graded by the homology class $w\in H_1(V)$ ({\rm see \ref{rem:grading} above})
	are   non-trivial.
\end{proposition}

The Poisson tensor on $\fP$  is determined in the ``$u$-notation" by
the  following generalization of the   formula
(\ref{eq:u-notation}):
\begin{equation}\label{eq:u-vector}
	\frac{1}{2\pi i}\int\limits_0^{2\pi}\langle(\delta u)',\delta
	v\rangle dx,
\end{equation}
where $\langle\;,\;\rangle$ denotes Poincar\'e pairing
on cohomology $H^*(M)$,  which is given in the basis $\Delta_1,\dots, \Delta_a$ by the matrix
$$\eta_{ij}=\langle\Delta_i,\Delta_j\rangle=\int\limits_M\Delta_i\wedge\Delta_j.$$
The Poisson tensor  can be written in
$(p,q)$-coordinates as
\begin{equation*}
	\sum\limits_{k=1}^\infty k\sum\limits_{i,j=1}^{a }\eta_{ij}\frac{\partial}{\partial
		p_{k,i}}\wedge\frac{\partial}{\partial
		q_{k,j}}\,.
\end{equation*}
It can be shown that the  above Hamiltonian $\bh$
satisfies the identity $\{\bh,\bh\}=0,$  and  that the differential
Poisson algebra $(\fP,d^{\bh})$ is quasi-isomorphic to the
corresponding  differential Poisson algebra defined  in Section
\ref{sec:3algebras} for any non-degenerate contact form for the
same contact structure  $\xi$ on $V$.
\bigskip

The following formula (\ref{eq:Bourg}), which sometimes allows to compute
the Hamiltonian $\bh$  of $V$
in terms of the Gromov-Witten invariant $\bff=\bff_{M,J_M}$ of $M$, emerged   in a discussion  of
the authors with T. Coates and  F. Bourgeois.

\begin{proposition}\label{prop:Coates}
	Set
	$$
		\bh^{j}_{W,J}(t,q,p,z)=\frac{\partial\bh}
		{\partial\tau_j}(\sum\limits_1^b
		t_i\wt\Delta_i+\tau_j\wt\Theta_j,q,p,z)
		\big|_{\tau_j=0}\;,
	$$
	and
	$$\widehat\bff^j(t,z)=\frac{\partial\bff}{\partial s}\big(
		\sum\limits_1^a t_i\Delta_i +s\pi_*\wt\Theta_j,z\big)\big|_{s=0}
		\,,$$
	for $j=1,\dots,c$
	(comp. Theorem \ref{thm:RSFT-master}).
	Then   we have
	\begin{equation}
		\label{eq:Bourg}
		\begin{split}
			 & \bh^j_{W,J}(t_1,\dots,t_b,q,p,z) \\&
			=\frac{1}{2\pi }\int\limits_0^{2\pi}
			\widehat\bff^j(t_1+u_1(x),\dots,t_b+u_b(x), u_{b+1}(x),\dots,u_a(x),\tilde z)dx
		\end{split}
	\end{equation}
	where $z=(z_1,\dots,z_N)$,
	$\tilde z=(e^{-ilx},z_1,\dots,z_N)$ and
	$l$ is the greatest divisor of $\omega$.
\end{proposition}
To prove    (\ref{eq:Bourg}) one just observes that
the correlator
\begin{equation*}
	\up{-1}\langle
	\wt \Delta_{j_1},\dots,\wt\Delta_{j_r},\wt\Theta_j;
	u_{i_1}\Delta_{i_i},\dots,u_{i_v}\Delta_v\rangle^d_{0}
\end{equation*}
equals  the Fourier coefficient with $e^{ilx}$ of
the       correlator
\begin{equation*}
	\up{0}\langle
	{\Delta_{j_1},\dots,\Delta_{j_r},\pi_*\wt\Theta_j}, {
	u_{i_1}\Delta_{i_i},\dots,u_{i_v}\Delta_v}\rangle^{\tilde
		d}_{0}\,.
\end{equation*}

Notice that if $\wt\Theta_j$ is an odd form, then
$$\bh(\sum\limits_1^b
	t_i\wt\Delta_i+\tau_j\wt\Theta_j,q,p,\tilde z)=
	\tau_j\bh^j(t,q,p,z),$$
because all terms of $\bh$ must contain $\tau_j$.
In particular,
for $M=\C P^{n-1}$  the manifold $V$ is a rational homology sphere, and thus
a volume form $\Theta$  on $S^{2n-1}$
generates the odd part
of $H^*(V;\R)$.
Hence, the formula
(\ref{eq:Bourg}) completely determines $\bh$.
Namely, let
$\bff(t,z)$ be the Gromov-Witten invariant of $\C P^{n-1}$,
and let $\Delta_{2i},i=0,\dots,n-1$, be closed forms generating
$H^*(\C P^{n-1})$, so that $\Delta_{2n-2}=\pi_*(\wt\Theta)$.
Set $\wt\Delta_0=\pi^*(\Delta_0)$
and $$\widehat\bff(t,z)=\widehat\bff^{2n-2}(t,z)=\frac{\partial\bff(t,z)}{\partial t_{2n-2}}.$$

Then we have
\begin{equation}\label{eq:Bourg2}
	\bh(t_0\wt\Delta_0+\tau\Theta,q,p) =
	\frac{\tau}{2\pi } \int\limits_0^{2\pi}
	{\widehat\bff}( t_0\Delta_0+u, e^{-ix})  dx .
\end{equation}


Let us consider some applications of the formula (\ref{eq:Bourg2}).





\bigskip

\noindent\textsf {Contact homology of the standard contact $3$-sphere}
\medskip

Let $\pi:V=S^3\to M=\C P^1$ be the Hopf
fibration. $V$ is the pre-quantization space for $(S^2,\omega)$ with
$\int\limits_{S^2}\omega=1$. The $0$-form $\Delta_0=1$ and
the  symplectic  $2$-form $\Delta_2=\omega$
generate $H^*(M)$, the $0$-form
$\wt{\Delta}_0=\pi^*(\Delta_0)$ and the volume form $\wt{\Theta}_3$
with $\pi_*(\wt{\Theta}_3)=\Delta_2$ on $S^3$ generate $H^*(S^3)$.
Thus we have  functional variables
\begin{equation*}
	u_j(w)=\sum\limits_{k=1}^\infty \left(p_{k,j}e^{ikx}+q_{k,j}e^{-ikx}\right),
\end{equation*}
associated  to the classes $\Delta_j,\; j=0,2,$ and variables $t_0$ and $\tau$
associated to $\wt{\Delta}_0$ and $\wt{\Theta}_3$. According to (\ref{eq:dim-Bott}) we have
\begin{equation*}
	\begin{split}
		 & \deg q_{k,0}=-2+4k,\quad \deg q_{k,2}= 4k,
		\quad\deg p_{k,0}=-2-4k,                      \\
		 & \quad\deg p_{k,2}=- 4k,\quad
		\deg t_0=-2,\quad\deg \tau=1.                 \\
	\end{split}
\end{equation*}
The  potential $\bff$ for $M=\C P^1$ can be written, as it well known (see
also Section \ref{sec:computing} below),
as
\begin{equation}\label{eq:CP2}
	\bff=\frac{t_0^2t_2}{2} +e^{t_2}z,
\end{equation}
and hence
\begin{equation*}
	\widehat\bff=\frac{t_0^2}{2} +e^{t_2}z,
\end{equation*}
Thus applying (\ref{eq:Bourg}) we get the following expression for the rational Hamiltonian
$\bh$ for $S^3$:
\begin{equation}\label{eq:3-sphere}
	\begin{split}
		\bh & =\frac{\tau}{2\pi i}\int\limits_0^{2\pi} \left(\frac{(t_0+u_0)^2}{2}+
		e^{u_2-ix}\right)dx = \tau\Big(\frac{t_0^2}{2}+\sum\limits_{k\geq 1} q_{k,0}p_{k,0} \\
		    & +\sum\limits_{t,s\geq 0}\mathop{\mathop{\sum
				\limits_{i_1,\dots,i_s\geq 0}}\limits_{j_1,\dots j_t\geq 0}}
		\limits_{\sum\limits_1^s li_l-\sum\limits_1^tmj_m=1}\frac{q_{1,2}^{i_1}\dots
			q_{s,2}^{i_s}p_{1,2}^{j_1}\dots p_{t,2}^{i_t}}{i_1!\dots i_s!j_1!\dots
		j_t!}\Big)\,.                                                                       \\
	\end{split}
\end{equation}


Let us use (\ref{eq:3-sphere})
to compute the contact homology algebra $$H^{\cont}_*(S^3,\xi_0)=H_*(\fA(S^3,J,\alpha),\partial).$$
The part of $\bh$  linear in the $p$-variables has the form
\begin{equation*}
	\tau\sum\limits_1^\infty\left( p_{k,0}q_{k,0}+ p_{k,2}h_k(q_{1,2},\dots,q_{k-1,2})\right)\;,
\end{equation*}
so that the differential $\partial :\fA\to\fA$
is given by the formulas
\begin{equation*}
	\partial q_{k,2}=k\tau q_{k,0},\quad \partial q_{k,0}=k\tau h_k(q_{1,2},\dots,q_{k-1,2})\;.
\end{equation*}
Here are
few first polynomials $h_k$:
\begin{equation*}
	\begin{split}
		h_1= & 1,                                         \\
		h_2= & q_{1,2},                                   \\
		h_3= & q_{2,2}+\frac12q_{1,2}^2,                  \\
		h_4= & q_{3,2}+  q_{2,2}q_{1,2}+\frac16q_{1,2}^3. \\
	\end{split}
\end{equation*}
Notice that $\im\partial$ coincides with the ideal $I(\tau)$
generated by $\tau$. Hence,  the homology algebra
$H_*(\fA,\partial)$  specialized over a point $t=(t_0,0)$ is a
free graded commutative algebra $ \fA_0$ generated by variables
$q_{k,0},q_{k,2},\;k=1,\dots,$  and in particular it has one
generator in each even dimension. On the other hand, over any
point $t=(t_0,\tau)$ with  $\tau\neq 0$ the algebra
$H_*(\fA,\partial)$ is isomorphic to a  proper subalgebra $\fA_1$
of $ \fA_0$. It       has its first non-trivial generator $g_1=
	q_{1,2}-\frac12 q_{1,0}^2 $ in dimension $4$.
\bigskip

\begin{remark}\label{rem:lens-space}
	{\rm The contact homology of the Lens space $V=L(l,1)$ which is
	the pre-quantization space for $(S^2,\omega)$ with
	$\int\limits_{S^2}\omega=l$ can be computed similarly.
	The variables   $p_{k,0}, q_{k,0}, p_{k,2}, q_{k,2}, t_0 $ and $\tau$ have the same
	$\Z_2$-grading, as in the case of $S_3$, i.e. all of them, except  $\tau$ are even.
	However, the grading assigned by the Euler field to $p_{k,0}, q_{k,0}, p_{k,2}, q_{k,2}$
	is fractional in this case
	and given by formulas
	\begin{equation*}
		\begin{split}
			 & \deg q_{k,0}=-2+\frac{4k}{l},\quad \deg q_{k,2}= \frac{4k}{l},
			\quad\deg p_{k,0}=-2-\frac{4k}{l},                                \\
			 & \quad\deg q_{k,0}=- \frac{4k}{l} .                             \\
		\end{split}
	\end{equation*}

	The formula for $\bh$ takes the form
	\begin{equation}\label{eq:lens-space}
		\bh=\frac{\tau}{2\pi i}\int\limits_0^{2\pi} \left(\frac{(t_0+u_0)^2}{2}+
		e^{u_2-ilx}\right)dx
	\end{equation}

	We will not carry on here the computation of the contact homology  of
	the Lens space $L(l,1)$, and only note, that  as in the case of
	$S^3$
	the homology algebra $H_*(\fA,\partial)$  specialized over a point $t=0$ is a free
	graded commutative algebra $ \fA_0$ generated by variables
	$q_{k,0},q_{k,2},\;k=1,\dots,$
	and over any  point $t \neq 0$  the
	algebra $H_*(\fA,\partial)$ is isomorphic to a  proper subalgebra $\fA_1$ of $ \fA_0$.
	In particular, {\it over any point the contact homology algebra $H_*(\fA,\partial)$
			has no odd elements}.}
\end{remark}
\noindent\textsf{ Distinguishing contact structures on
	pre-quantizations spaces}
\medskip

Formula (\ref{eq:Bourg}) can be used
for distinguishing contact structures on pre-quantization
spaces
of certain symplectic manifolds, which have different
Gromov-Witten invariants.
Here is an example.
\begin{proposition} \label{prop:Barlow}
	Let $(M_1,\omega_1)$
	and $(M_2,\omega_2,J_2)$ be two
	symplectic $4$-manifolds with  integral
	cohomology classes of their symplectic forms.
	Suppose that for compatible
	almost complex structures $J_1$ on $M_1$ and $J_2$
	on $M_2$ there are no non-constant  $J_1$-holomorphic spheres
	in
	$ M_1 $,
	while $M_2$ contains an embedded
	$J_2$-holomorphic $(-1)$-sphere $S$.
	Then  the pre-quantization spaces $(V_1,\xi_1)$ and $(V_2,\xi_2)$
	are not contactomorphic.
	\footnote{
		Yongbin Ruan proved in \cite{Ruan-virtual}
		that under the assumptions of Proposition \ref{prop:Barlow}   the
		symplectic manifolds $(M_1,\omega_1)\times \C P^1$ and
		$(M_2,\omega_2)\times \C P^1$ are not symplectomorphic
		(and  not even deformationally equivalent), despite   the fact
		that    for a certain choice of $M_1$ and $M_2$
		(e.g. $M_1$ is the Barlow surface and $M_2=\C P^2\#8\overline{\C P^2}$), and for
		appropriate symplectic forms $\omega_1$ and $\omega_2$
		the underlying manifolds $V_1$ and $V_2$ are diffeomorphic. }
\end{proposition}
\begin{remark}
	{\rm Even when the manifolds $M_1$ and $M_2$ are homeomorphic,
		the prequantization spaces $V_1$ and $V_2$ are not diffeomorphic
		(even not homotopy equivalent!)  for most choices   of symplectic forms
		$\omega_1$ and $\omega_2$, and hence the statement of the theorem is trivial in these
		cases. However, one can show that
		for homeomorphic $M_1$ and $M_2$ the
		symplectic forms can always be deformed in the class of symplectic forms compatible with
		the chosen almost complex structures $J_1$ and $J_2$, in order
		to make $V_1$ and $V_2$ diffeomorphic.}
\end{remark}
To prove Proposition \ref{prop:Barlow}   we will ahow that
the ``classical"   contact homology algebras
$H^{\cont}_*(V_1,\xi_1) $ and $H^{\cont}_*(V_2,\xi_2) $ are not isomorphic.

Let  $S_0=S,S_1,\dots, S_m$ be the exceptional $J_2$-holomorphic
spheres in $M_2$. Then the cohomology classes $ S^*_0,\dots,
	S^*_m,[\omega]$ are linearly independent, where  we denote by
$S^*_i$ the cohomology class Poincar\'e-dual to $[S_i]\in
	H_2(M_2)$. Hence there exists a class $X\in H^2(M_2)$, such that
\begin{equation}
	XS^*_0=1, \;X[\omega]=0,\;\;\hbox{and}\;\;XS^*_i=0\;\;\hbox{for}\;\; 1\geq i\geq m.
\end{equation}
Then the  potential $\bff_{M_2,J_2}(tX)$
coincides with $$\bff_{S,J_2|_S}(tX|_{S})=e^tz.$$
Let us choose a basis of closed forms $\Delta_i, i=0,\dots,a$,
generating
generating $H^*(M_2)$, so that one of the forms, say $\Delta_1$
represents the class $X$. The form $\Delta_1$ then
lifts to a  form $\wt \Delta_1$ such that
$\pi_*\wt \Delta_1=\Delta_1$.
According to the formula
(\ref{eq:Bourg2}) we have
\begin{equation}
	\bh_V( \tau_1\wt\Delta_1,u)= \frac{\tau_1}{2\pi } \int\limits_0^{2\pi}
	e^{u_1-ilx} dx ,
\end{equation}
where $u=\sum\limits_0^au_j\Delta_j,\,u_j=\sum\limits_1^\infty
	(p_{k,j}e^{ikx}+q_{k,j}e^{-ikx}),\;l=\int\limits_{S}\omega.$

Hence, the contact homology algebra $H^{\cont}_*(M_2,\xi_2)$,
specialized     at the point $\tau\wt\Delta$ for $\tau\neq 0$
is isomorphic to the contact homology algebra of the  standard
contact
Lens space $L(l,1)=\pi^{-1}(S)\subset V$, specialized    at the volume
form $\tau\wt\Delta|_{L(l,1)}$. It follows then from  Remark \ref{rem:lens-space}
that $H^{\cont}_*(V_2,\xi_2)$,
specialized     at any point  has
no odd elements.   On the other hand, for any $2$-dimensional
cohomology class $t\in H_2(M_1)$ we have
$\bff_{M_1,J_1}(t)=0$, and hence for any $3$-form
$\wt\Delta$ on $V_1$,
the formula (\ref{eq:Bourg2}) implies that the Hamiltonian
$\bh_{V_1} (\wt\Delta, u )$ vanishes as well, and  therefore
the contact homology algebra  $H^{\cont}_*(M_1,\xi_1)$,
specialized     at the point $\tau\wt\Delta,\tau\neq 0$
is a free graded commutative algebra generated by the odd variable
$\tau$, and even variables $p'_{k,j},q'_{k,j }$, which correspond
to even dimensional generators of $H^*(M_1)$. Hence the contact
manifolds $(M_1,\xi_1)$ and $(M_2,\xi_2)$ are not isomorphic. \qed



\bigskip

\noindent\textsf{ Subcritical symplectic manifolds}
\medskip

The content of this example is a result of our discussion
with P. Biran and K. Cieliebak.

In \cite{Donaldson} S. Donaldson  generalized  the Kodaira embedding theorem by
proving that for any closed  symplectic manifold $(W,\omega)$
with an integral cohomology class of the symplectic form there
exists an integer $l>0$ such that the homology class dual to $l[\omega]$
can be represented by an embedded symplectic hypersurface $W_0$.
In fact, S. Donaldson proved a stronger result, which  together
with
an improvement by  Biran-Cieliebak   asserts that for a sufficiently large $l$
the hypersurface $W_0$ can be chosen in such a way that in the complement
$W\setminus W_0$ there exists a vector field $X$ with the following properties:
\begin{description}
	\item{} $L_X\omega=-\omega$, where $L_X$ denotes the Lie derivative
	      along $X$; in other words, $X$ is conformally symplectic and   contracting;
	\item{}  $X$ is forward integrable;
	\item{} $X$ is gradient-like for a Morse function $\phi:W\setminus W_0\to \R_+$,
	      which coincides with $-\log\dist^2$ near $W$, where $\dist(x)$ is the     distance
	      function from a point $x$ to $W_0$ with respect to some Riemannian metric.
\end{description}

The vector field $X$ retracts $W\setminus W_0$ to the Morse complex $K$
of the function $\phi$,
which is automatically isotropic for the symplectic form $\omega$
(see  \cite{Eliash-Gromov-convex}), and, in particular, $\dim K\leq n$.
Biran-Cieliebak call the pair $(W,W_0)$ {\it subcritical}
if $\dim K<n$.
They constructed  in \cite{Biran-Cieliebak}
several interesting  examples of subcritical pairs, and conjectured
that {\it if $(W,W_0)$ is subcritical, then $l=1$}.
We sketch below  the proof of this conjecture.

First, let us observe that the contact structure $\xi$, defined by
the contact form $\a=
	X\hook\omega$ on the boundary  $V$ of a  small tubular neighborhood of
$W_0$, is equivalent to the contact structure which is defined on $V$ as the
pre-quantization space   of the symplectic manifold
$(W_0,l\omega)$. On the other hand, the condition, that the pair
$(W,W_0)$ is sub-critical implies that the contact manifold $(V,\xi)$
is itself  subcritical in the sense of Examlpe \ref{ex:Floer}.4 above,
i.e. it is  isomorphic to the strictly pseudo-convex
boundary  of a sub-critical Stein (or Weinstein) manifold with its canonical complex structure.
Let us recall (see \ref{rem:grading} above) that all SFT-objects, in particular Floer contact
homology $HC_*(V,\xi)$ and the contact homology algebra $H^{\cont}_*(V,\xi)$ are
graded by elements of $H_1(V)$.
Using  arguments  as in  the theorem of Mei-Lin Yau (see \ref{prop:MLYau} above) one can show
that all  non-trivial elements
in  the
contact homology algebra $H^{\cont}_*(V,\xi)$ of a subcritical contact manifold
$(V,\xi)$ may correspond only to $0\in H_1(V)$.
On the other hand,
it follows from Proposition \ref{prop:even-dim} above that $H^{\cont}_*(V,\xi)$ specialized at $0\in H^*(V)$ has
non-trivial elements which correspond to the homology class of       the fiber in
$H_1(V)$. Therefore, $l=1$.

\subsubsection{Computing  rational Gromov-Witten
	invariants of $\C P^n$}\label{sec:computing}
We will  show  in this section how SFT  can be used for computing      rational
Gromov-Witten invariants of $\C P^n$. Our method differs from
traditional ways (see \cite{Kontsevich-CP2,Fulton-Pand,Graber-Pand,Vakil,Ruan-Tian})   for this computation.
We will be simultaneously computing the rational potential of $\C^n$ and the rational
Gromov-Witten invariant of $\C P^n$ by a recursion
using Theorem \ref{thm:RSFT-master}

Let us choose basic forms in $\C^n$ as in the previous section,
i.e $\Delta =1$, and $\Theta$ is a volume form with  compact
support in $C^n\setminus 0=S^{2n-1}\times(0,\infty)$
with $\int\limits_{\C^n}\Theta =1$. We denote by $\delta$ the restriction of
$\Delta$ to $S^{2n-1}$.
We also assume that $\Theta$ splits into a product $\hat\theta\wedge\rho$, where $\hat\theta$
is pull-back of a unit volume form $\theta$ on $S^{2n-1}$, and $\rho$ is a
compactly supported form in $(0,\infty)$.
Set
\begin{equation}
	\begin{split}
		\bh^1(t_0,q,p)) & =\frac{\partial \bh}{\partial
		\tau}(t_0\delta+\tau\theta,q,p)|_{\tau=0}       \\ &=\frac{1}{2\pi
		}\int\limits_0^{2\pi}\widehat\bff_{\C P^{n-1}}(t_0+u_0(x),u_2,\dots,
		u_{2n-2},e^{-ix})dx,                            \\
	\end{split}
\end{equation}
where  $$\widehat\bff_{\C P^{n-1}}(t_0,\dots,t_{2n-2},z)=
	\frac{\partial\bff_{\C P^{n-1}}}{\partial t_{2n-2}}(t_0,\dots,t_{2n-2},z),$$
$\bff_{\C P^{n-1}}(t_0,\dots,t_{2n-2},z)$ is the rational
Gromov-Witten invariant  of $\C P^{n-1}$, and
$$u_{2j}(x)=\sum\limits_1^\infty
	p_{k,2j}\,e^{ikx}+q_{k,2j}\,e^{-ikx}.$$ Then the equation
(\ref{eq:RSFT-master}), which determines $
	\bff(t_0,t_{2n},p)=\bff_{\C^n}(t_0\Delta+t_{2n}\Theta,p)$ takes
the form
\begin{equation}\label{eq:Cn}
	\frac{\partial\bff}{\partial t_{2n}}(t_0,t_{2n},p) =\frac{1}{2\pi
	}\int\limits_0^{2\pi} \widehat\bff_{\C P^{n-1}}(t_0+u_0(x),u_2,\dots,
	u_{2n-2},e^{-ix})dx\big|_{L_\bff},
\end{equation}
where $$L_{\bff}=\{q_{k,2j}=k\frac{\partial \bff}{\partial
		p_{k,2n-2j-2}}(t_0,t_{2n},p)\}.$$
Together with the initial data
\begin{equation}
	\bff(t_0,0,p)=
	\begin{cases}
		p_{1,0}, & \hbox{if}\;\;n=1; \\
		0,       & \hbox {otherwise} \\
	\end{cases}
\end{equation}
the equation (\ref{eq:Cn}) provides a recursive procedure for
computing coefficients $f_j(t_0,p)$ of the expansion
$$\bff(t_0,t_{2n},p)=\sum\limits_0^\infty f_j(t_0,p)t_{2n}^j.$$

For instance for $n=1$ we have (see Example \ref{ex:circle})
$\bh^1=\frac{t_0^2}{2}+\sum\limits_1^\infty p_kq_k$, where we
write
$p_k,q_k$ instead of $p_{k,0},q_{k,0}$, and hence the equation
(\ref{eq:Cn}) takes the form
\begin{equation}
	\frac{\partial\bff}{\partial t_{2 }}(t_0,t_{2 },p)=\frac{t_0^2}{2}
	+ \sum\limits_0^\infty k p_k\frac{\partial\bff}{\partial
		p_k}(t_0,t_{2 },p)
\end{equation}
with the initial data $\bff(t_0,0,p)=p_1$. This linear first order
PDE is straightforward to solve, and we get $$\bff(t_0,t_{2
	},p)=\frac{t_2t_0^2}{2}+e^{t_2}p_1.$$
\bigskip

For $n=2$ the Hamiltonian $\bh$ is given by the formula
(\ref{eq:3-sphere}), and we have
$$\bh(t_0,\tau,p)=\tau\bh^1(t_0,p).$$ Thus the equation for the
potential of $\C^2$ has the form
\begin{equation}\label{eq:C2}
	\begin{split}
		 & \frac{\partial\bff}{\partial t_{4}}(t_0,t_{4},p)
		=\frac{t_0^2}{2}+\sum\limits_{k\geq 1}k
		\frac{\partial\bff}{\partial p_{k,2}}p_{k,0}        \\
		 & +\sum\limits_{t,s\geq 0}\mathop{\mathop{\sum
				\limits_{i_1,\dots,i_s\geq 0}}\limits_{j_1,\dots j_t\geq 0}}
		\limits_{\sum\limits_1^s li_l-\sum\limits_1^tmj_m=1} \frac{ \left(
		\frac{\partial\bff} {\partial p_{1,0}}\right)^{i_1}\dots
		\left(s \frac{\partial\bff}{\partial p_{s,0}}\right)^{i_s}p_{1,2}^{j_1}\dots
		p_{t,2}^{i_t}}{i_1!\dots i_s!j_1!\dots
		j_t!};                                              \\
		 & \bff(t_0,0,p)=0\,.                               \\
	\end{split}
\end{equation}
Hence, we get
\begin{equation}
	\begin{split}
		\bff(t_0,t_4,p)= & t_4(\frac{t_0^2}{2}+p_{1,2})+\frac{t_4^2}{2!}p_{1,0}+
		\frac{t_4^3}{3!}(p_{2,2}+\frac12 p_{1,2}^2)                              \\
		                 & +\frac{t_4^4}{4!}(2p_{2,0}+p_{1,2}p_{1,0})+\dots\;.
	\end{split}
\end{equation}

To compute $\bff_{\C^n}$ for $n>2$ we need to know $\bff_{\C
		P^{n-1}}$. So to complete the recursion we will explain now how to
express the rational Gromov-Witten invariant $\bff_{ \C P^{n-1}}$
through $\bff_{\C^n}$.

\bigskip
First of all we split, as it is described in Example
\ref{ex:section}
above, $\C P^n$ along the boundary of a tubular neighborhood
of $\C P^{n-1}\subset \C P^n$ into two completed symplectic
cobordism $W_1=\C^n$ and $W_2=\C P^{n }\setminus {x}$, where we
introduce on $W_2$ a complex structure of the holomorphic line
bundle over $\C P^{n-1}$ determined by the hyperplane section $\C
	P^{n-2}\subset\C P^{n-1}$. We will denote by $\bff_1$ and $\bff_2$
the potentials for $W_1$ and $W_2$, respectively.

Let $\Delta_0,\dots,\Delta_{2 n-2}$ be closed forms representing
the standard basis of $H^*(\C P^{n-1})$. We will keep the same
notation for the pull-backs of these forms to $W_2$. Let
$\Delta_{2n}$ be  a closed $2n$-form with a compact support, which
generates $$\Ker\big(H^*_{\comp}(W_2)\to H^*(W_2)\big).$$
We are interested
in the potential
$\bff_2(t_0,\dots,t_{2n},q)=\bff_2(\sum\limits_{i=1}^{n }
	t_{2i}\Delta_{2i},q)$. First of all notice that by dimensional
reasons the moduli spaces of holomorphic curves which project  to
non-constant curves in $\C P^{n-1}$ do not contribute to the
potential $$\bff_2(t_0,\dots,t_{2n-2},0,q),$$ and hence we have
\begin{equation}
	\bff_2(\sum\limits_{i=1}^{n-1} t_{2i}\Delta_{2i},q)= z\sum
	\limits_{i=0}^{n-1}q_{1,2i} \mathop{\sum\limits_{(s_1,\dots,s_{n-1})}}\limits_{  \sum
		s_j(j-1)=n-i-1}\prod\limits_{j=1}^{n-1}\frac{t_{2j}^{s_j}}{s_j!}\;.
\end{equation}
In particular, for $n=2$ we get
\begin{equation*}
	\bff_2(t_0\Delta_0+t_2\Delta_2,q)=ze^t_2q_{1,2}
\end{equation*}
One can recover $\bff_2(t_0,\dots,t_{2n},q)$ for $t_{2n}\neq 0$
using the equation (\ref{eq:RSFT-master}), as we did it above for
$W_1=\C^n$. However, for the purpose of our  computation of
Gromov-Witten invariant $\bff_{\C P^n}$ this is not necessary, as
we can proceed as follows.

Notice that the above chosen  forms
$\Delta_2, \Delta_{2n-2}$ extend to $\ CP^n$. On the other hand, we
will choose a  volume form $\Delta_{2n}$ on $\C P^n$ to be
supported in the affine part, so that the restriction $\Delta_{2n}|_{\C^n}$
coincides with the form $\Theta$ introduced above. Then Theorem
(\ref{thm:RSFT-composition}) implies that
\begin{equation}\label{eq:CPn}
	\begin{split}
		 & \bff_{\C P^n}(\sum\limits_{i=1}^{n } t_{2i}\Delta_{2i})=      \\
		 & \big(\bff_1(t_0,t_{2n},p)+
		\bff_2(t_0,\dots,t_{2n-2},0,q)-\sum\limits_{i+j=n-1}
		\sum\limits_1^\infty \frac1{k} p_{k,2i}q_{k,2j}\big)\big|_L\;\;, \\
	\end{split}
\end{equation}
where
\begin{equation}\label{eq:Lag-CPn}
	L=
	\begin{cases}
		p_{1,2i}= & z  \mathop{\sum\limits_{(s_1,\dots,s_{n-1})}}\limits_{
			\sum
		s_j(j-1)=i}\prod\limits_{j=1}^{n-1}\frac{t_{2j}^{s_j}}{s_j!}\;;    \\
		p_{k,2i}= & 0,\;\;\hbox{if}\;\; k>1\;;                             \\
		q_{k,2i}= & k\frac{\partial\bff_1}{\partial
		p_{k,2(n-i-1)}}(t_0,t_{2n}, p)\,.                                  \\
	\end{cases}
\end{equation}

Plugging expressions from (\ref{eq:Lag-CPn}) into equation
(\ref{eq:CPn}) we get
\begin{equation}\label{eq:CPn-Cn}
	\bff_{\C
		P^n}(t_0,\dots,t_{2n})=\bff_{\C^n}(t_0,t_{2n},p)\big|_{L_1}\;,
\end{equation}
where
\begin{equation*}
	L_1=
	\begin{cases} p_{1,2i} & = z  \mathop{\sum\limits_{(s_1,\dots,s_{n-1})}}\limits_{
	              \sum
              s_j(j-1)=i}\prod\limits_{j=1}^{n-1}\frac{t_{2j}^{s_j}}{s_j!}\;;     \\
              p_{k,2i} & =0\;\;\hbox{if}\;\;
              k>1\,.                                                              \\
	\end{cases}
\end{equation*}
Indeed, two last terms in the formula (\ref{eq:CPn}) cancel each
other (as it always happens when $\bff_2$ is linear with respect
to $q$-variables).
For instance, for $n=1$ we get
\begin{equation}
	\bff_1(t_0,t_2,p)=\big(\frac{t_0^2t_2
	}2+e^{t_2}p_1\big)\big|_{p_1=z}=\frac{t_0^2t_2}2+e^{t_2}z\,.
\end{equation}


For $n=2$ we have
\begin{equation}
	L_1=
	\begin{cases}
		p_{1,0} & = ze^{t_2}\,;                              \\
		p_{k,i} & = 0,\quad\hbox{ for all other}\quad k,i\,, \\
	\end{cases}
\end{equation}
and hence
\begin{equation}\label{eq:CP2-final}
	\bff_{\C P^2}(t_0,t_2,t_4)=\bff_{\C^n}(t_0,t_4,
	ze^{t_2},0,\dots)\,.
\end{equation}


\begin{remark} {\rm The method which we used  above
		for computing of the rational
		potential of $\C P^n$, when  applied to an arbitrary
		symplectic manifold $W$,   allows us to express
		$\bff_W$ through the potential of the affine part $W\setminus
			M$.
		The latter computation seems tractable when  the Weinstein manifold
		$W\setminus M$ is
		subcritical (see Section \ref{sec:splitting} above), i.e. when
		its isotropic skeleton does not have Lagrangian cells.
		On the other hand, when Lagrangian cells are present
		this problem is related to central questions of Symplectic
		topology.}
\end{remark}



\subsubsection{Satellites}\label{sec:satellites}
Let $(V,\xi=\{\a=0\})$ be a  contact manifold, $(W
	= V\times \R, d(e^t\a))$  its symplectization, and   $J$   a
compatible translation-invariant almost complex structure on $W$.
In this section  we will show that the
homological Poisson super-algebra $H_*(\fP ,  d^{\bh}  )$ comes equipped with some
additional structures, rather unfamiliar in abstract Poisson
geometry. Namely, the counting  of genus $g$ curves with a fixed
complex structure and with a fixed configuration of $n$ points
gives rise to an odd $n$-linear totally symmetric poly-form
$\bh^{g,n}$ on the Poisson super-space $\bV$ underlying $\fP $. The
poly-form descends well to the homology and thus yields another
invariant of the contact structure which we call the genus-$g$
$n$-point {\em satellite} of the Poisson structure.

Let us denote by
$\overline{\cM_{g,m}(V)/\R}$   the compactified moduli space of stable connected
$J$-holomorphic curves in $W$ which are characterized by the
arithmetical genus $g$ and by the total number $m$ of punctures and
marked points numbered somehow by the indices $1,...,m$ (see Section \ref{sec:compact} above). We
emphasize that the moduli space in question contains equivalence
classes of all such curves, and in particular, may have infinitely
many connected components corresponding to different homotopy
types of curves in $W$ and different numbering of the $m$
markings. Let $\DM_{g,n}$ be the Deligne-Mumford compactification
of the moduli space of genus $g$ Riemann surfaces with $n$ marked
points. For any $g,n$ with $2g-2+n >0$ and $l\geq 0$ there is a
natural {\em contraction map} $\ct :\overline{\cM_{g,n+l}(V)/\R}\to \DM_{g,n}$
defined by forgetting the map to $W$ and the last $l$ markings
followed by the contraction of those components of the curve which
have become unstable.  Given a differential form
$\tau$ on $\DM_{g,n}$ we will denote by $\ct^*\gt$ its  pull-back
to $\overline{\cM_{g,m}(V)/\R}$.

Let $u =(p,q,t)$ denote a point in $\bV$, that is $p,q$ and $t$ are
(closed) differential forms on $\cP^{-},\cP^{+}$ and $V$
respectively. We will denote $\ev_i^*{u}, \ i=1,...,m$, the
pull-back by the evaluation map $$\ev_i: \overline{\cM_{g,m}(V)/\R}\to
	(\cP^{-}\cup \cP^{+}\cup V)$$ at the $i$-th marking. Let us emphasize the point that we
are
treating here  the marked points and punctures on equal footing.

Let $\gd u\in \bV$ be a tangent vector to $\bV$ at a point $u\in \bV$.
We introduce the formal function
\begin{equation}
	\bh^{g,n}_{\gt}:=\frac{1}{n!}
	\sum_{l=0}^{\infty}\frac{1}{l!}\int\limits_{\overline{\cM_{g,n+l}(V)/\R }}\
	\ct^*{\gt}\w \ev_1^*\gd u\w...\w\ev^*_n\gd
	u\w\ev_{n+1}^*u\w...\w\ev_{n+l}^*u .
\end{equation}
It is a super-symmetric  $n$-linear
form in $\gd u$ with coefficients depending on the application
point $u$.

Let $d^{\bh}(f)$ denote the Lie derivative of a tensor field $f$
along the odd Hamiltonian
vector field $d^{\bh}$ on $\bV$ with the Hamilton function $\bh$.

\begin{proposition}
	Let $\gt $ be a top degree form on $\DM_{g,n}$. Then
	$d^{\bh}(\bh_{\gt}^{g,n})=0$. If the top degree form $\gt=d\a$ is exact
	then $\bh^{\gt}_{g,n}=d^{\bh}( \bh^{\a}_{g,n})$. In particular, the
	tensor field $\bh^{g,n}_{\gt}$ descends to the homology    algebra
	$H_*(\fP, \p)$ into a satellite which depends only on the total
	volume of $\gt$.
\end{proposition}

This follows from the Stokes formula applied to
$\bh^{d\gt}_{g,n}=0$ and respectively  to $\bh^{d\a}_{g,n}$.
Codimension $1$ boundary strata of the moduli space $\cM_{g,m}(V)/\R$
are formed by  stable curves of height $2$. Most of the strata do not contribute to
the Stokes formula since they are mapped by the contraction map to
complex codimension $1$ strata of the Deligne-Mumford space
$\DM_{g,n}$, where $\gt$ and   $\a$ restrict to $0$ for
dimensional reasons. Exceptions to this rule occur only if one of
the two curves which form the stable curve is to be contracted. It is therefore a
sphere with  glued to the other level of the stable curve along at precisely
one end, and which have at most one marked points or ends with the index $\leq n$,
and with any
number of ends or marked points with indices $>n$. Contributions
of such curves to the Stokes formula is expressed bi-linearly via
the $1$-st or $2$-nd derivatives of the Hamilton function $\bh$
and the satellite. It is easy to see that the whole expression is
interpreted correctly as the  Lie derivative of the tensor field
$\bh^{\gt}_{g,n}$ along the Hamiltonian vector field $d^{\bh}$. \qed


\medskip

We will assume further on that $\gt $ is normalized to the total
volume $1$ and will often drop it from the notation for the
satellite $\bh^{g,n}$.

\medskip

Let us consider now a directed symplectic  cobordism
$W=\ora{V_-V_+}$ between two contact boundaries $V_{\pm}$. Then we
have the Hamilton function $\widehat\bh
	=\bh^{+}-\bh^{-}$ and the satellites
$\widehat\bh^{g,n}=\big(\bh^{g,n}\big)^+-
	\big(\bh^{g,n}\big)^-$ defined  as elements of
the algebra $\widehat \fL$, which in the case when the cobordism
is a concordance just equal to the tensor product of the Poisson
algebras $\fP_{\pm}$. Also, we have the potential $\bff
	(p_{-},q_{+},t) $ counting rational $J$-holomorphic curves in $W$
which defines a Lagrangian correspondence between $\fP^{\pm}$
invariant under the vector field $ d^{\widehat{\bh}}$ with the Hamilton function
$\widehat\bh$. Finally, using the moduli spaces $\cM_{g,m}(W)$ of
$J$-holomorphic curves in the cobordism, we can introduce the
satellites $\bff^{g,n}_{\gt}$ as symmetric $n$-forms on the space
$(p_{-},q_{+},t)$-space parameterizing the Lagrangian
correspondence. Then the arguments similar to the above proof of
the proposition, but applied this time to $\bff^{g,n}_{d\gt}=0$,
show that {\em the restriction of $\widehat\bh_{\gt}^{g,n}$ to the
		Lagrangian correspondence defined by $\bff$ coincides with the Lie
		derivative of $\bff^{g,n}_{\gt}$ along the vector field $d^{\widehat\bh}$
		restricted to the Lagrangian correspondence}
(comp. Theorem \ref{thm:RSFT-cobordism} above).
In this sense the
Lagrangian correspondences defined by symplectic cobordisms
preserve the satellite structures defined by $\big(\bh^{g,n}\big)^{\pm}$ on
the homology $H_*(\fP_{\pm},d^{\bh^{\pm}})$. In particular, {\em the
satellite structures of a contact manifold $V$ on the homology
$H_*(\fP,d^{\bh})$ depend only on the contact structure.}

\medskip

The following discussion is the first steps in the study of the
geometric structure defined by the satellites.

Let $\bh^{g,n}_{\a_1,...,\a_n}$ denote components of the satellite
tensors on $\fP$. Using the Poisson tensor $\pi^{\mu\nu}$ we can
couple two satellites with respect to some indices:
$$\bh^{g',n'+1}_{...\mu}\pi^{\mu\nu}\bh^{g'',n''+1}_{\nu ...}.$$
Similarly, we can couple two indices in $\bh^{g-1,n+2}$ with two
indices in the $2$-nd differential $\gd^2\bh $ of the Hamilton
function $\bh$.

\begin{proposition} If $g=g'+g''>0$ then the
	coupling of $\bh^{g',n'}$ and $\bh^{g'',n''}$ is a Lie derivative
	along $\p$ and thus vanishes in the homology $H_*(\fP ,\p )$.
	Similarly, the coupling of $\bh^{g-1,n+2}$ with $\gd^2\bh$
	vanishes in the homology $H_*(\fP,\p)$. \end{proposition}

The proof is based on some famous but non-trivial property of the
spaces $\DM_{g,n}$ with $g>0$ to have complex codimension one
strata homologically independent. Such strata correspond to
different ways of cutting a $(g,n)$-surface along one circle and
can be identified either with $\DM_{g',n'+1}\times
	\DM_{g'',n''+1}$ where $g'+g''=g, n'+n''=n$ or with
$\DM_{g-1,n+2}$. The independence property implies that a volume
form $\gt$ on the stratum, say  $\gt'\otimes\gt''$ in the first
case, can be obtained as the restriction of a closed codegree two
form $\go$ on $\DM_{g,n}$ which have exact (or even zero, for
suitable choices of $\gt$) restrictions to all other
codimension-$1$ strata in $\DM_{g,n}$. Applying the Stokes formula
to $0=\bh^{g,n}_{d\go}$ we find that the coupling of
$\bh^{g',n'+1}_{\gt'}$ and $\bh^{\gt'',n''+1}_{\gt''}$ (or --- in
the second case --- of $\bh^{g-1,n+2}_{\gt}$ and $\gd^2\bh$)
equals $d^{\bh}( \bh^{g,n}_{\go})$.

\medskip

\begin{remark} {\em
		To the contrary, coupling $\bh^{0,3}$ with itself via one index is
		not, in general, a $d^{\bh}$-derivative, but instead the following
		triple sum is:
		\begin{equation*}
			\begin{split}
				 & \bh^{0,3}_{\a\gb\mu}\pi^{\mu\nu}\bh^{0,3}_{\nu\g\d}+
				(-1)^{(\deg{\a}+\deg{\gb})\deg{\g}}
				\bh^{0,3}_{\g\a\mu}\pi^{\mu\nu}\bh^{0,3}_{\nu\gb\d}+    \\
				 & (-1)^{\deg{\a}(\deg{\gb}+\deg{\g})}
				\bh^{0,3}_{\gb\g\mu}\pi^{\mu\nu}\bh^{0,3}_{\nu\a\d} \equiv 0
				\, .                                                    \\
			\end{split}
		\end{equation*}
		This follows from the property of the $3$ boundary strata in
		$\DM_{0,4}$ to represent the same homology class (use the Stokes
		formula for $\go =1$). In fact $\bh^{0,3}$ coincides with the
		$3$-rd differential $\gd^3\bh /6$ of the Hamilton function, and
		the above Jacobi-like identity can be derived by $4$
		differentiations of $\{ \bh ,\bh \}=0$ in $\a,\gb,\g,\d$. One can
		interpret the integrability property $(d^{\bh})^2=0$ of the odd vector
		field $d^{\bh}$ on $\bV$ as a homotopy Lie super-algebra structure on
		$\Pi \bV^*$, the dual space with changed parity. The identity in
		question corresponds to the Jacobi identity for the remnant Lie
		super-algebra structure in homology. }
\end{remark}


It is sometimes convenient to extend the definition of genus $0$
satellites to unstable values of $n$ by $\bh^{0,n}=\gd^n\bh /n!$
for $n=0,1,2$. Also, one can define the function $\bh^{1,0}$ at
least locally as a potential for $\bh^{1,1}$, using the following

\begin{proposition} The differential $1$-form $\bh^{1,1}$ is closed.
\end{proposition}

Indeed, the partial derivatives $\gd_{\mu}\bh^{1,1}_{\nu}$ and
$\gd_{\nu}\bh^{1,1}_{\mu}$ are identified with the satellites
$(\bh^{1,2}_{\go})_{\mu\nu}$ corresponding to the $2$-form $\go $
on $\DM_{1,2}$ pulled-back from $\DM_{1,1}$ by forgetting the
$1$-st and respectively the $2$-nd marked point. But the two maps
$\DM_{1,2}\to \DM_{1,1}$ coincide.

\medskip

It would be interesting to study other general properties of
satellites which may depend on more sophisticated geometry of
Deligne-Mumford compactifications. For instance, what can be said
about Poisson brackets among the functions $\bh^{g,0}$?

\medskip

We complete the section with the computation of the satellites in the
example $V=S^1$. Let $t=t_01+t_1d\phi $ denote the general
harmonic form on $S^1$, $\gd t=\gt_0 1+\gd t_1\d\phi $,
$u(x)=t_0+\sum p_ke^{ikx}+ q_ke^{-ikx}$, $\gd u = \gd t_0+\sum \gd
	p_ke^{ikx}+\gd q_k e^{-ikx}$.

\begin{proposition}
	For $2g-2+n \geq 0$ we have
	\[ \bh^{g,n+1}\ =\ \frac{\gd t_1}{2\pi\ n!}\int\limits_0^{2\pi} \ (u_{xx})^g \
		(\gd u)^n \ dx .\]
\end{proposition}

Let us begin with the remark that the formula does not (and
cannot) contain $t=t_0+t_1\phi$ because $\deg t < 2$, and
therefore pushing forward from $\cM_{g,m+1}(V)/\R \to
	\cM_{g,m}(V)/\R$ by forgetting the corresponding marked point
would send $t$ to $0$. Exceptions to this rule could occur only if
$\cM_{g,m}(V)$ were ill-defined, that is only in the case of
constant maps with "unstable" indices, $2g-2+m\leq 0$, which has
no effect on the satellites with "stable" indices. On the other
hand the factor $\d t_1$ is (and must be) present in the formula
since the dimension of the moduli spaces is odd. With this
information in mind, the enumerative question equivalent to
computation of the satellites can be described as follows. On a
Riemann surface $\Sigma$ of genus $g$, we are given a divisor $D$
of $n$ distinct points with (possibly zero) multiplicities
$m_1,...,m_n$. We have to count the divisors $l_1P_1+...+l_gP_g$
which in the sum with $D$ form the divisor of a rational function.
(In particular, the degree $\sum m_i+\sum l_j$ of the total
divisor must vanish.)   The answer to this question is equal to
the degree of the Abel-Jacobi map $\Sigma^g\to J_{\Sigma}$ defined
by integration of holomorphic differentials
$\vec{\go}=(\go_1,...,\go_g)$ on $\Sigma$ as
\[ (P_1,...,P_g)\mapsto l_1\int^{P_1}\vec{\go}+...+l_g \int^{P_g}\vec{\go}
	.\] When the multiplicities $(l_1,...,l_g)=(1,...,1)$, the degree
equals $g!$ (it is well-known that $S^g\Sigma^g\to J_{\Sigma}$ is
a bi-rational isomorphism). For arbitrary $(l_1,...l_g)$ the
Abel-Jacobi map has the Jacobi matrix $[l_j \go_i (P_j)]$. Thus
the degree equals $l_1^2...l_g^2 g!$. Taking these answers as the
coefficients in the generating function on the variables $t_0,
	p_l, q_{-l}$ corresponding to $l=0,l>0$ and $l<0$ we arrive at the
factor $u_{xx}^g$. The other factor $(\gd u)^n/n!$ is similarly
accountable for all possible choices of multiplicities
$m_1,...,m_n$ in the divisor $D$. The contour integration of the
product couples the choices with $m_1+...+m_n+l_1+...+l_g = 0$.
